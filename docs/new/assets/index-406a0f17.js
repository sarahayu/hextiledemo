function tL(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var W9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function B2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Q9(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var nL={exports:{}},dr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mm=Symbol.for("react.element"),q9=Symbol.for("react.portal"),Z9=Symbol.for("react.fragment"),Y9=Symbol.for("react.strict_mode"),X9=Symbol.for("react.profiler"),K9=Symbol.for("react.provider"),J9=Symbol.for("react.context"),eU=Symbol.for("react.forward_ref"),tU=Symbol.for("react.suspense"),nU=Symbol.for("react.memo"),rU=Symbol.for("react.lazy"),iC=Symbol.iterator;function iU(t){return t===null||typeof t!="object"?null:(t=iC&&t[iC]||t["@@iterator"],typeof t=="function"?t:null)}var rL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},iL=Object.assign,sL={};function Id(t,e,n){this.props=t,this.context=e,this.refs=sL,this.updater=n||rL}Id.prototype.isReactComponent={};Id.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Id.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function oL(){}oL.prototype=Id.prototype;function QE(t,e,n){this.props=t,this.context=e,this.refs=sL,this.updater=n||rL}var qE=QE.prototype=new oL;qE.constructor=QE;iL(qE,Id.prototype);qE.isPureReactComponent=!0;var sC=Array.isArray,aL=Object.prototype.hasOwnProperty,ZE={current:null},lL={key:!0,ref:!0,__self:!0,__source:!0};function AL(t,e,n){var r,i={},s=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(s=""+e.key),e)aL.call(e,r)&&!lL.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var p=Array(o),v=0;v<o;v++)p[v]=arguments[v+2];i.children=p}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:mm,type:t,key:s,ref:l,props:i,_owner:ZE.current}}function sU(t,e){return{$$typeof:mm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function YE(t){return typeof t=="object"&&t!==null&&t.$$typeof===mm}function oU(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var oC=/\/+/g;function Cx(t,e){return typeof t=="object"&&t!==null&&t.key!=null?oU(""+t.key):e.toString(36)}function my(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case mm:case q9:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+Cx(l,0):r,sC(i)?(n="",t!=null&&(n=t.replace(oC,"$&/")+"/"),my(i,e,n,"",function(v){return v})):i!=null&&(YE(i)&&(i=sU(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(oC,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",sC(t))for(var o=0;o<t.length;o++){s=t[o];var p=r+Cx(s,o);l+=my(s,e,n,p,i)}else if(p=iU(t),typeof p=="function")for(t=p.call(t),o=0;!(s=t.next()).done;)s=s.value,p=r+Cx(s,o++),l+=my(s,e,n,p,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function f1(t,e,n){if(t==null)return t;var r=[],i=0;return my(t,r,"","",function(s){return e.call(n,s,i++)}),r}function aU(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Vo={current:null},yy={transition:null},lU={ReactCurrentDispatcher:Vo,ReactCurrentBatchConfig:yy,ReactCurrentOwner:ZE};dr.Children={map:f1,forEach:function(t,e,n){f1(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return f1(t,function(){e++}),e},toArray:function(t){return f1(t,function(e){return e})||[]},only:function(t){if(!YE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};dr.Component=Id;dr.Fragment=Z9;dr.Profiler=X9;dr.PureComponent=QE;dr.StrictMode=Y9;dr.Suspense=tU;dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lU;dr.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=iL({},t.props),i=t.key,s=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,l=ZE.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(p in e)aL.call(e,p)&&!lL.hasOwnProperty(p)&&(r[p]=e[p]===void 0&&o!==void 0?o[p]:e[p])}var p=arguments.length-2;if(p===1)r.children=n;else if(1<p){o=Array(p);for(var v=0;v<p;v++)o[v]=arguments[v+2];r.children=o}return{$$typeof:mm,type:t.type,key:i,ref:s,props:r,_owner:l}};dr.createContext=function(t){return t={$$typeof:J9,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:K9,_context:t},t.Consumer=t};dr.createElement=AL;dr.createFactory=function(t){var e=AL.bind(null,t);return e.type=t,e};dr.createRef=function(){return{current:null}};dr.forwardRef=function(t){return{$$typeof:eU,render:t}};dr.isValidElement=YE;dr.lazy=function(t){return{$$typeof:rU,_payload:{_status:-1,_result:t},_init:aU}};dr.memo=function(t,e){return{$$typeof:nU,type:t,compare:e===void 0?null:e}};dr.startTransition=function(t){var e=yy.transition;yy.transition={};try{t()}finally{yy.transition=e}};dr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};dr.useCallback=function(t,e){return Vo.current.useCallback(t,e)};dr.useContext=function(t){return Vo.current.useContext(t)};dr.useDebugValue=function(){};dr.useDeferredValue=function(t){return Vo.current.useDeferredValue(t)};dr.useEffect=function(t,e){return Vo.current.useEffect(t,e)};dr.useId=function(){return Vo.current.useId()};dr.useImperativeHandle=function(t,e,n){return Vo.current.useImperativeHandle(t,e,n)};dr.useInsertionEffect=function(t,e){return Vo.current.useInsertionEffect(t,e)};dr.useLayoutEffect=function(t,e){return Vo.current.useLayoutEffect(t,e)};dr.useMemo=function(t,e){return Vo.current.useMemo(t,e)};dr.useReducer=function(t,e,n){return Vo.current.useReducer(t,e,n)};dr.useRef=function(t){return Vo.current.useRef(t)};dr.useState=function(t){return Vo.current.useState(t)};dr.useSyncExternalStore=function(t,e,n){return Vo.current.useSyncExternalStore(t,e,n)};dr.useTransition=function(){return Vo.current.useTransition()};dr.version="18.2.0";nL.exports=dr;var Ue=nL.exports;const rt=B2(Ue),AU=tL({__proto__:null,default:rt},[Ue]);var uL={exports:{}},$a={},cL={exports:{}},hL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_t,Tt){var Jt=_t.length;_t.push(Tt);e:for(;0<Jt;){var In=Jt-1>>>1,Tn=_t[In];if(0<i(Tn,Tt))_t[In]=Tt,_t[Jt]=Tn,Jt=In;else break e}}function n(_t){return _t.length===0?null:_t[0]}function r(_t){if(_t.length===0)return null;var Tt=_t[0],Jt=_t.pop();if(Jt!==Tt){_t[0]=Jt;e:for(var In=0,Tn=_t.length,kr=Tn>>>1;In<kr;){var er=2*(In+1)-1,or=_t[er],hr=er+1,Un=_t[hr];if(0>i(or,Jt))hr<Tn&&0>i(Un,or)?(_t[In]=Un,_t[hr]=Jt,In=hr):(_t[In]=or,_t[er]=Jt,In=er);else if(hr<Tn&&0>i(Un,Jt))_t[In]=Un,_t[hr]=Jt,In=hr;else break e}}return Tt}function i(_t,Tt){var Jt=_t.sortIndex-Tt.sortIndex;return Jt!==0?Jt:_t.id-Tt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var p=[],v=[],S=1,M=null,k=3,F=!1,H=!1,j=!1,ie=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function se(_t){for(var Tt=n(v);Tt!==null;){if(Tt.callback===null)r(v);else if(Tt.startTime<=_t)r(v),Tt.sortIndex=Tt.expirationTime,e(p,Tt);else break;Tt=n(v)}}function ce(_t){if(j=!1,se(_t),!H)if(n(p)!==null)H=!0,Et(me);else{var Tt=n(v);Tt!==null&&un(ce,Tt.startTime-_t)}}function me(_t,Tt){H=!1,j&&(j=!1,Y(Qe),Qe=-1),F=!0;var Jt=k;try{for(se(Tt),M=n(p);M!==null&&(!(M.expirationTime>Tt)||_t&&!Fe());){var In=M.callback;if(typeof In=="function"){M.callback=null,k=M.priorityLevel;var Tn=In(M.expirationTime<=Tt);Tt=t.unstable_now(),typeof Tn=="function"?M.callback=Tn:M===n(p)&&r(p),se(Tt)}else r(p);M=n(p)}if(M!==null)var kr=!0;else{var er=n(v);er!==null&&un(ce,er.startTime-Tt),kr=!1}return kr}finally{M=null,k=Jt,F=!1}}var Ee=!1,He=null,Qe=-1,Ye=5,nt=-1;function Fe(){return!(t.unstable_now()-nt<Ye)}function tt(){if(He!==null){var _t=t.unstable_now();nt=_t;var Tt=!0;try{Tt=He(!0,_t)}finally{Tt?Ze():(Ee=!1,He=null)}}else Ee=!1}var Ze;if(typeof J=="function")Ze=function(){J(tt)};else if(typeof MessageChannel<"u"){var pt=new MessageChannel,Yt=pt.port2;pt.port1.onmessage=tt,Ze=function(){Yt.postMessage(null)}}else Ze=function(){ie(tt,0)};function Et(_t){He=_t,Ee||(Ee=!0,Ze())}function un(_t,Tt){Qe=ie(function(){_t(t.unstable_now())},Tt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_t){_t.callback=null},t.unstable_continueExecution=function(){H||F||(H=!0,Et(me))},t.unstable_forceFrameRate=function(_t){0>_t||125<_t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ye=0<_t?Math.floor(1e3/_t):5},t.unstable_getCurrentPriorityLevel=function(){return k},t.unstable_getFirstCallbackNode=function(){return n(p)},t.unstable_next=function(_t){switch(k){case 1:case 2:case 3:var Tt=3;break;default:Tt=k}var Jt=k;k=Tt;try{return _t()}finally{k=Jt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_t,Tt){switch(_t){case 1:case 2:case 3:case 4:case 5:break;default:_t=3}var Jt=k;k=_t;try{return Tt()}finally{k=Jt}},t.unstable_scheduleCallback=function(_t,Tt,Jt){var In=t.unstable_now();switch(typeof Jt=="object"&&Jt!==null?(Jt=Jt.delay,Jt=typeof Jt=="number"&&0<Jt?In+Jt:In):Jt=In,_t){case 1:var Tn=-1;break;case 2:Tn=250;break;case 5:Tn=1073741823;break;case 4:Tn=1e4;break;default:Tn=5e3}return Tn=Jt+Tn,_t={id:S++,callback:Tt,priorityLevel:_t,startTime:Jt,expirationTime:Tn,sortIndex:-1},Jt>In?(_t.sortIndex=Jt,e(v,_t),n(p)===null&&_t===n(v)&&(j?(Y(Qe),Qe=-1):j=!0,un(ce,Jt-In))):(_t.sortIndex=Tn,e(p,_t),H||F||(H=!0,Et(me))),_t},t.unstable_shouldYield=Fe,t.unstable_wrapCallback=function(_t){var Tt=k;return function(){var Jt=k;k=Tt;try{return _t.apply(this,arguments)}finally{k=Jt}}}})(hL);cL.exports=hL;var uU=cL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fL=Ue,Ga=uU;function Bt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dL=new Set,Eg={};function Tf(t,e){od(t,e),od(t+"Capture",e)}function od(t,e){for(Eg[t]=e,t=0;t<e.length;t++)dL.add(e[t])}var Xu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tb=Object.prototype.hasOwnProperty,cU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,aC={},lC={};function hU(t){return Tb.call(lC,t)?!0:Tb.call(aC,t)?!1:cU.test(t)?lC[t]=!0:(aC[t]=!0,!1)}function fU(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function dU(t,e,n,r){if(e===null||typeof e>"u"||fU(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Go(t,e,n,r,i,s,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=l}var Fs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Fs[t]=new Go(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Fs[e]=new Go(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Fs[t]=new Go(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Fs[t]=new Go(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Fs[t]=new Go(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Fs[t]=new Go(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Fs[t]=new Go(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Fs[t]=new Go(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Fs[t]=new Go(t,5,!1,t.toLowerCase(),null,!1,!1)});var XE=/[\-:]([a-z])/g;function KE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(XE,KE);Fs[e]=new Go(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(XE,KE);Fs[e]=new Go(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(XE,KE);Fs[e]=new Go(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Fs[t]=new Go(t,1,!1,t.toLowerCase(),null,!1,!1)});Fs.xlinkHref=new Go("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Fs[t]=new Go(t,1,!1,t.toLowerCase(),null,!0,!0)});function JE(t,e,n,r){var i=Fs.hasOwnProperty(e)?Fs[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(dU(e,n,i,r)&&(n=null),r||i===null?hU(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var fc=fL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d1=Symbol.for("react.element"),p0=Symbol.for("react.portal"),g0=Symbol.for("react.fragment"),eT=Symbol.for("react.strict_mode"),Sb=Symbol.for("react.profiler"),pL=Symbol.for("react.provider"),gL=Symbol.for("react.context"),tT=Symbol.for("react.forward_ref"),Cb=Symbol.for("react.suspense"),Mb=Symbol.for("react.suspense_list"),nT=Symbol.for("react.memo"),Gc=Symbol.for("react.lazy"),mL=Symbol.for("react.offscreen"),AC=Symbol.iterator;function up(t){return t===null||typeof t!="object"?null:(t=AC&&t[AC]||t["@@iterator"],typeof t=="function"?t:null)}var wi=Object.assign,Mx;function Gp(t){if(Mx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Mx=e&&e[1]||""}return`
`+Mx+t}var Px=!1;function kx(t,e){if(!t||Px)return"";Px=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(v){var r=v}Reflect.construct(t,[],e)}else{try{e.call()}catch(v){r=v}t.call(e.prototype)}else{try{throw Error()}catch(v){r=v}t()}}catch(v){if(v&&r&&typeof v.stack=="string"){for(var i=v.stack.split(`
`),s=r.stack.split(`
`),l=i.length-1,o=s.length-1;1<=l&&0<=o&&i[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==s[o]){var p=`
`+i[l].replace(" at new "," at ");return t.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",t.displayName)),p}while(1<=l&&0<=o);break}}}finally{Px=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Gp(t):""}function pU(t){switch(t.tag){case 5:return Gp(t.type);case 16:return Gp("Lazy");case 13:return Gp("Suspense");case 19:return Gp("SuspenseList");case 0:case 2:case 15:return t=kx(t.type,!1),t;case 11:return t=kx(t.type.render,!1),t;case 1:return t=kx(t.type,!0),t;default:return""}}function Pb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case g0:return"Fragment";case p0:return"Portal";case Sb:return"Profiler";case eT:return"StrictMode";case Cb:return"Suspense";case Mb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gL:return(t.displayName||"Context")+".Consumer";case pL:return(t._context.displayName||"Context")+".Provider";case tT:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case nT:return e=t.displayName||null,e!==null?e:Pb(t.type)||"Memo";case Gc:e=t._payload,t=t._init;try{return Pb(t(e))}catch{}}return null}function gU(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pb(e);case 8:return e===eT?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function fh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function yL(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function mU(t){var e=yL(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,s.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function p1(t){t._valueTracker||(t._valueTracker=mU(t))}function _L(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=yL(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function n_(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function kb(t,e){var n=e.checked;return wi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function uC(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=fh(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function vL(t,e){e=e.checked,e!=null&&JE(t,"checked",e,!1)}function Ib(t,e){vL(t,e);var n=fh(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Lb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Lb(t,e.type,fh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function cC(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Lb(t,e,n){(e!=="number"||n_(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var $p=Array.isArray;function $0(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+fh(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Db(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Bt(91));return wi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function hC(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Bt(92));if($p(n)){if(1<n.length)throw Error(Bt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:fh(n)}}function xL(t,e){var n=fh(e.value),r=fh(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function fC(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function wL(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?wL(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var g1,bL=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(g1=g1||document.createElement("div"),g1.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=g1.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Tg(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var rg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yU=["Webkit","ms","Moz","O"];Object.keys(rg).forEach(function(t){yU.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),rg[e]=rg[t]})});function EL(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||rg.hasOwnProperty(t)&&rg[t]?(""+e).trim():e+"px"}function TL(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=EL(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var _U=wi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bb(t,e){if(e){if(_U[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Bt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Bt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Bt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Bt(62))}}function zb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ob=null;function rT(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fb=null,j0=null,H0=null;function dC(t){if(t=vm(t)){if(typeof Fb!="function")throw Error(Bt(280));var e=t.stateNode;e&&(e=U2(e),Fb(t.stateNode,t.type,e))}}function SL(t){j0?H0?H0.push(t):H0=[t]:j0=t}function CL(){if(j0){var t=j0,e=H0;if(H0=j0=null,dC(t),e)for(t=0;t<e.length;t++)dC(e[t])}}function ML(t,e){return t(e)}function PL(){}var Ix=!1;function kL(t,e,n){if(Ix)return t(e,n);Ix=!0;try{return ML(t,e,n)}finally{Ix=!1,(j0!==null||H0!==null)&&(PL(),CL())}}function Sg(t,e){var n=t.stateNode;if(n===null)return null;var r=U2(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Bt(231,e,typeof n));return n}var Nb=!1;if(Xu)try{var cp={};Object.defineProperty(cp,"passive",{get:function(){Nb=!0}}),window.addEventListener("test",cp,cp),window.removeEventListener("test",cp,cp)}catch{Nb=!1}function vU(t,e,n,r,i,s,l,o,p){var v=Array.prototype.slice.call(arguments,3);try{e.apply(n,v)}catch(S){this.onError(S)}}var ig=!1,r_=null,i_=!1,Ub=null,xU={onError:function(t){ig=!0,r_=t}};function wU(t,e,n,r,i,s,l,o,p){ig=!1,r_=null,vU.apply(xU,arguments)}function bU(t,e,n,r,i,s,l,o,p){if(wU.apply(this,arguments),ig){if(ig){var v=r_;ig=!1,r_=null}else throw Error(Bt(198));i_||(i_=!0,Ub=v)}}function Sf(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function IL(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function pC(t){if(Sf(t)!==t)throw Error(Bt(188))}function EU(t){var e=t.alternate;if(!e){if(e=Sf(t),e===null)throw Error(Bt(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return pC(i),t;if(s===r)return pC(i),e;s=s.sibling}throw Error(Bt(188))}if(n.return!==r.return)n=i,r=s;else{for(var l=!1,o=i.child;o;){if(o===n){l=!0,n=i,r=s;break}if(o===r){l=!0,r=i,n=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===n){l=!0,n=s,r=i;break}if(o===r){l=!0,r=s,n=i;break}o=o.sibling}if(!l)throw Error(Bt(189))}}if(n.alternate!==r)throw Error(Bt(190))}if(n.tag!==3)throw Error(Bt(188));return n.stateNode.current===n?t:e}function LL(t){return t=EU(t),t!==null?DL(t):null}function DL(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=DL(t);if(e!==null)return e;t=t.sibling}return null}var RL=Ga.unstable_scheduleCallback,gC=Ga.unstable_cancelCallback,TU=Ga.unstable_shouldYield,SU=Ga.unstable_requestPaint,Fi=Ga.unstable_now,CU=Ga.unstable_getCurrentPriorityLevel,iT=Ga.unstable_ImmediatePriority,BL=Ga.unstable_UserBlockingPriority,s_=Ga.unstable_NormalPriority,MU=Ga.unstable_LowPriority,zL=Ga.unstable_IdlePriority,z2=null,qA=null;function PU(t){if(qA&&typeof qA.onCommitFiberRoot=="function")try{qA.onCommitFiberRoot(z2,t,void 0,(t.current.flags&128)===128)}catch{}}var AA=Math.clz32?Math.clz32:LU,kU=Math.log,IU=Math.LN2;function LU(t){return t>>>=0,t===0?32:31-(kU(t)/IU|0)|0}var m1=64,y1=4194304;function jp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function o_(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,l=n&268435455;if(l!==0){var o=l&~i;o!==0?r=jp(o):(s&=l,s!==0&&(r=jp(s)))}else l=n&~i,l!==0?r=jp(l):s!==0&&(r=jp(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-AA(e),i=1<<n,r|=t[n],e&=~i;return r}function DU(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RU(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-AA(s),o=1<<l,p=i[l];p===-1?(!(o&n)||o&r)&&(i[l]=DU(o,e)):p<=e&&(t.expiredLanes|=o),s&=~o}}function Vb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function OL(){var t=m1;return m1<<=1,!(m1&4194240)&&(m1=64),t}function Lx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ym(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-AA(e),t[e]=n}function BU(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-AA(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function sT(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-AA(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Or=0;function FL(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var NL,oT,UL,VL,GL,Gb=!1,_1=[],th=null,nh=null,rh=null,Cg=new Map,Mg=new Map,Hc=[],zU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mC(t,e){switch(t){case"focusin":case"focusout":th=null;break;case"dragenter":case"dragleave":nh=null;break;case"mouseover":case"mouseout":rh=null;break;case"pointerover":case"pointerout":Cg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mg.delete(e.pointerId)}}function hp(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=vm(e),e!==null&&oT(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function OU(t,e,n,r,i){switch(e){case"focusin":return th=hp(th,t,e,n,r,i),!0;case"dragenter":return nh=hp(nh,t,e,n,r,i),!0;case"mouseover":return rh=hp(rh,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Cg.set(s,hp(Cg.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Mg.set(s,hp(Mg.get(s)||null,t,e,n,r,i)),!0}return!1}function $L(t){var e=Wh(t.target);if(e!==null){var n=Sf(e);if(n!==null){if(e=n.tag,e===13){if(e=IL(n),e!==null){t.blockedOn=e,GL(t.priority,function(){UL(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _y(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=$b(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ob=r,n.target.dispatchEvent(r),Ob=null}else return e=vm(n),e!==null&&oT(e),t.blockedOn=n,!1;e.shift()}return!0}function yC(t,e,n){_y(t)&&n.delete(e)}function FU(){Gb=!1,th!==null&&_y(th)&&(th=null),nh!==null&&_y(nh)&&(nh=null),rh!==null&&_y(rh)&&(rh=null),Cg.forEach(yC),Mg.forEach(yC)}function fp(t,e){t.blockedOn===e&&(t.blockedOn=null,Gb||(Gb=!0,Ga.unstable_scheduleCallback(Ga.unstable_NormalPriority,FU)))}function Pg(t){function e(i){return fp(i,t)}if(0<_1.length){fp(_1[0],t);for(var n=1;n<_1.length;n++){var r=_1[n];r.blockedOn===t&&(r.blockedOn=null)}}for(th!==null&&fp(th,t),nh!==null&&fp(nh,t),rh!==null&&fp(rh,t),Cg.forEach(e),Mg.forEach(e),n=0;n<Hc.length;n++)r=Hc[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Hc.length&&(n=Hc[0],n.blockedOn===null);)$L(n),n.blockedOn===null&&Hc.shift()}var W0=fc.ReactCurrentBatchConfig,a_=!0;function NU(t,e,n,r){var i=Or,s=W0.transition;W0.transition=null;try{Or=1,aT(t,e,n,r)}finally{Or=i,W0.transition=s}}function UU(t,e,n,r){var i=Or,s=W0.transition;W0.transition=null;try{Or=4,aT(t,e,n,r)}finally{Or=i,W0.transition=s}}function aT(t,e,n,r){if(a_){var i=$b(t,e,n,r);if(i===null)Gx(t,e,r,l_,n),mC(t,r);else if(OU(i,t,e,n,r))r.stopPropagation();else if(mC(t,r),e&4&&-1<zU.indexOf(t)){for(;i!==null;){var s=vm(i);if(s!==null&&NL(s),s=$b(t,e,n,r),s===null&&Gx(t,e,r,l_,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Gx(t,e,r,null,n)}}var l_=null;function $b(t,e,n,r){if(l_=null,t=rT(r),t=Wh(t),t!==null)if(e=Sf(t),e===null)t=null;else if(n=e.tag,n===13){if(t=IL(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return l_=t,null}function jL(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(CU()){case iT:return 1;case BL:return 4;case s_:case MU:return 16;case zL:return 536870912;default:return 16}default:return 16}}var qc=null,lT=null,vy=null;function HL(){if(vy)return vy;var t,e=lT,n=e.length,r,i="value"in qc?qc.value:qc.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===i[s-r];r++);return vy=i.slice(t,1<r?1-r:void 0)}function xy(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function v1(){return!0}function _C(){return!1}function ja(t){function e(n,r,i,s,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?v1:_C,this.isPropagationStopped=_C,this}return wi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=v1)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=v1)},persist:function(){},isPersistent:v1}),e}var Ld={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},AT=ja(Ld),_m=wi({},Ld,{view:0,detail:0}),VU=ja(_m),Dx,Rx,dp,O2=wi({},_m,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uT,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==dp&&(dp&&t.type==="mousemove"?(Dx=t.screenX-dp.screenX,Rx=t.screenY-dp.screenY):Rx=Dx=0,dp=t),Dx)},movementY:function(t){return"movementY"in t?t.movementY:Rx}}),vC=ja(O2),GU=wi({},O2,{dataTransfer:0}),$U=ja(GU),jU=wi({},_m,{relatedTarget:0}),Bx=ja(jU),HU=wi({},Ld,{animationName:0,elapsedTime:0,pseudoElement:0}),WU=ja(HU),QU=wi({},Ld,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),qU=ja(QU),ZU=wi({},Ld,{data:0}),xC=ja(ZU),YU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},XU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function JU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=KU[t])?!!e[t]:!1}function uT(){return JU}var eV=wi({},_m,{key:function(t){if(t.key){var e=YU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=xy(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?XU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uT,charCode:function(t){return t.type==="keypress"?xy(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xy(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),tV=ja(eV),nV=wi({},O2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wC=ja(nV),rV=wi({},_m,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uT}),iV=ja(rV),sV=wi({},Ld,{propertyName:0,elapsedTime:0,pseudoElement:0}),oV=ja(sV),aV=wi({},O2,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),lV=ja(aV),AV=[9,13,27,32],cT=Xu&&"CompositionEvent"in window,sg=null;Xu&&"documentMode"in document&&(sg=document.documentMode);var uV=Xu&&"TextEvent"in window&&!sg,WL=Xu&&(!cT||sg&&8<sg&&11>=sg),bC=String.fromCharCode(32),EC=!1;function QL(t,e){switch(t){case"keyup":return AV.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var m0=!1;function cV(t,e){switch(t){case"compositionend":return qL(e);case"keypress":return e.which!==32?null:(EC=!0,bC);case"textInput":return t=e.data,t===bC&&EC?null:t;default:return null}}function hV(t,e){if(m0)return t==="compositionend"||!cT&&QL(t,e)?(t=HL(),vy=lT=qc=null,m0=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return WL&&e.locale!=="ko"?null:e.data;default:return null}}var fV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function TC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!fV[t.type]:e==="textarea"}function ZL(t,e,n,r){SL(r),e=A_(e,"onChange"),0<e.length&&(n=new AT("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var og=null,kg=null;function dV(t){oD(t,0)}function F2(t){var e=v0(t);if(_L(e))return t}function pV(t,e){if(t==="change")return e}var YL=!1;if(Xu){var zx;if(Xu){var Ox="oninput"in document;if(!Ox){var SC=document.createElement("div");SC.setAttribute("oninput","return;"),Ox=typeof SC.oninput=="function"}zx=Ox}else zx=!1;YL=zx&&(!document.documentMode||9<document.documentMode)}function CC(){og&&(og.detachEvent("onpropertychange",XL),kg=og=null)}function XL(t){if(t.propertyName==="value"&&F2(kg)){var e=[];ZL(e,kg,t,rT(t)),kL(dV,e)}}function gV(t,e,n){t==="focusin"?(CC(),og=e,kg=n,og.attachEvent("onpropertychange",XL)):t==="focusout"&&CC()}function mV(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return F2(kg)}function yV(t,e){if(t==="click")return F2(e)}function _V(t,e){if(t==="input"||t==="change")return F2(e)}function vV(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hA=typeof Object.is=="function"?Object.is:vV;function Ig(t,e){if(hA(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Tb.call(e,i)||!hA(t[i],e[i]))return!1}return!0}function MC(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function PC(t,e){var n=MC(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=MC(n)}}function KL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?KL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function JL(){for(var t=window,e=n_();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=n_(t.document)}return e}function hT(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function xV(t){var e=JL(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&KL(n.ownerDocument.documentElement,n)){if(r!==null&&hT(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=PC(n,s);var l=PC(n,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var wV=Xu&&"documentMode"in document&&11>=document.documentMode,y0=null,jb=null,ag=null,Hb=!1;function kC(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Hb||y0==null||y0!==n_(r)||(r=y0,"selectionStart"in r&&hT(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ag&&Ig(ag,r)||(ag=r,r=A_(jb,"onSelect"),0<r.length&&(e=new AT("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=y0)))}function x1(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var _0={animationend:x1("Animation","AnimationEnd"),animationiteration:x1("Animation","AnimationIteration"),animationstart:x1("Animation","AnimationStart"),transitionend:x1("Transition","TransitionEnd")},Fx={},eD={};Xu&&(eD=document.createElement("div").style,"AnimationEvent"in window||(delete _0.animationend.animation,delete _0.animationiteration.animation,delete _0.animationstart.animation),"TransitionEvent"in window||delete _0.transitionend.transition);function N2(t){if(Fx[t])return Fx[t];if(!_0[t])return t;var e=_0[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in eD)return Fx[t]=e[n];return t}var tD=N2("animationend"),nD=N2("animationiteration"),rD=N2("animationstart"),iD=N2("transitionend"),sD=new Map,IC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xh(t,e){sD.set(t,e),Tf(e,[t])}for(var Nx=0;Nx<IC.length;Nx++){var Ux=IC[Nx],bV=Ux.toLowerCase(),EV=Ux[0].toUpperCase()+Ux.slice(1);xh(bV,"on"+EV)}xh(tD,"onAnimationEnd");xh(nD,"onAnimationIteration");xh(rD,"onAnimationStart");xh("dblclick","onDoubleClick");xh("focusin","onFocus");xh("focusout","onBlur");xh(iD,"onTransitionEnd");od("onMouseEnter",["mouseout","mouseover"]);od("onMouseLeave",["mouseout","mouseover"]);od("onPointerEnter",["pointerout","pointerover"]);od("onPointerLeave",["pointerout","pointerover"]);Tf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),TV=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hp));function LC(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,bU(r,e,void 0,t),t.currentTarget=null}function oD(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var l=r.length-1;0<=l;l--){var o=r[l],p=o.instance,v=o.currentTarget;if(o=o.listener,p!==s&&i.isPropagationStopped())break e;LC(i,o,v),s=p}else for(l=0;l<r.length;l++){if(o=r[l],p=o.instance,v=o.currentTarget,o=o.listener,p!==s&&i.isPropagationStopped())break e;LC(i,o,v),s=p}}}if(i_)throw t=Ub,i_=!1,Ub=null,t}function Ai(t,e){var n=e[Yb];n===void 0&&(n=e[Yb]=new Set);var r=t+"__bubble";n.has(r)||(aD(e,t,2,!1),n.add(r))}function Vx(t,e,n){var r=0;e&&(r|=4),aD(n,t,r,e)}var w1="_reactListening"+Math.random().toString(36).slice(2);function Lg(t){if(!t[w1]){t[w1]=!0,dL.forEach(function(n){n!=="selectionchange"&&(TV.has(n)||Vx(n,!1,t),Vx(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[w1]||(e[w1]=!0,Vx("selectionchange",!1,e))}}function aD(t,e,n,r){switch(jL(e)){case 1:var i=NU;break;case 4:i=UU;break;default:i=aT}n=i.bind(null,e,n,t),i=void 0,!Nb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Gx(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var p=l.tag;if((p===3||p===4)&&(p=l.stateNode.containerInfo,p===i||p.nodeType===8&&p.parentNode===i))return;l=l.return}for(;o!==null;){if(l=Wh(o),l===null)return;if(p=l.tag,p===5||p===6){r=s=l;continue e}o=o.parentNode}}r=r.return}kL(function(){var v=s,S=rT(n),M=[];e:{var k=sD.get(t);if(k!==void 0){var F=AT,H=t;switch(t){case"keypress":if(xy(n)===0)break e;case"keydown":case"keyup":F=tV;break;case"focusin":H="focus",F=Bx;break;case"focusout":H="blur",F=Bx;break;case"beforeblur":case"afterblur":F=Bx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":F=vC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":F=$U;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":F=iV;break;case tD:case nD:case rD:F=WU;break;case iD:F=oV;break;case"scroll":F=VU;break;case"wheel":F=lV;break;case"copy":case"cut":case"paste":F=qU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":F=wC}var j=(e&4)!==0,ie=!j&&t==="scroll",Y=j?k!==null?k+"Capture":null:k;j=[];for(var J=v,se;J!==null;){se=J;var ce=se.stateNode;if(se.tag===5&&ce!==null&&(se=ce,Y!==null&&(ce=Sg(J,Y),ce!=null&&j.push(Dg(J,ce,se)))),ie)break;J=J.return}0<j.length&&(k=new F(k,H,null,n,S),M.push({event:k,listeners:j}))}}if(!(e&7)){e:{if(k=t==="mouseover"||t==="pointerover",F=t==="mouseout"||t==="pointerout",k&&n!==Ob&&(H=n.relatedTarget||n.fromElement)&&(Wh(H)||H[Ku]))break e;if((F||k)&&(k=S.window===S?S:(k=S.ownerDocument)?k.defaultView||k.parentWindow:window,F?(H=n.relatedTarget||n.toElement,F=v,H=H?Wh(H):null,H!==null&&(ie=Sf(H),H!==ie||H.tag!==5&&H.tag!==6)&&(H=null)):(F=null,H=v),F!==H)){if(j=vC,ce="onMouseLeave",Y="onMouseEnter",J="mouse",(t==="pointerout"||t==="pointerover")&&(j=wC,ce="onPointerLeave",Y="onPointerEnter",J="pointer"),ie=F==null?k:v0(F),se=H==null?k:v0(H),k=new j(ce,J+"leave",F,n,S),k.target=ie,k.relatedTarget=se,ce=null,Wh(S)===v&&(j=new j(Y,J+"enter",H,n,S),j.target=se,j.relatedTarget=ie,ce=j),ie=ce,F&&H)t:{for(j=F,Y=H,J=0,se=j;se;se=Jf(se))J++;for(se=0,ce=Y;ce;ce=Jf(ce))se++;for(;0<J-se;)j=Jf(j),J--;for(;0<se-J;)Y=Jf(Y),se--;for(;J--;){if(j===Y||Y!==null&&j===Y.alternate)break t;j=Jf(j),Y=Jf(Y)}j=null}else j=null;F!==null&&DC(M,k,F,j,!1),H!==null&&ie!==null&&DC(M,ie,H,j,!0)}}e:{if(k=v?v0(v):window,F=k.nodeName&&k.nodeName.toLowerCase(),F==="select"||F==="input"&&k.type==="file")var me=pV;else if(TC(k))if(YL)me=_V;else{me=mV;var Ee=gV}else(F=k.nodeName)&&F.toLowerCase()==="input"&&(k.type==="checkbox"||k.type==="radio")&&(me=yV);if(me&&(me=me(t,v))){ZL(M,me,n,S);break e}Ee&&Ee(t,k,v),t==="focusout"&&(Ee=k._wrapperState)&&Ee.controlled&&k.type==="number"&&Lb(k,"number",k.value)}switch(Ee=v?v0(v):window,t){case"focusin":(TC(Ee)||Ee.contentEditable==="true")&&(y0=Ee,jb=v,ag=null);break;case"focusout":ag=jb=y0=null;break;case"mousedown":Hb=!0;break;case"contextmenu":case"mouseup":case"dragend":Hb=!1,kC(M,n,S);break;case"selectionchange":if(wV)break;case"keydown":case"keyup":kC(M,n,S)}var He;if(cT)e:{switch(t){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else m0?QL(t,n)&&(Qe="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(Qe="onCompositionStart");Qe&&(WL&&n.locale!=="ko"&&(m0||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&m0&&(He=HL()):(qc=S,lT="value"in qc?qc.value:qc.textContent,m0=!0)),Ee=A_(v,Qe),0<Ee.length&&(Qe=new xC(Qe,t,null,n,S),M.push({event:Qe,listeners:Ee}),He?Qe.data=He:(He=qL(n),He!==null&&(Qe.data=He)))),(He=uV?cV(t,n):hV(t,n))&&(v=A_(v,"onBeforeInput"),0<v.length&&(S=new xC("onBeforeInput","beforeinput",null,n,S),M.push({event:S,listeners:v}),S.data=He))}oD(M,e)})}function Dg(t,e,n){return{instance:t,listener:e,currentTarget:n}}function A_(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Sg(t,n),s!=null&&r.unshift(Dg(t,s,i)),s=Sg(t,e),s!=null&&r.push(Dg(t,s,i))),t=t.return}return r}function Jf(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function DC(t,e,n,r,i){for(var s=e._reactName,l=[];n!==null&&n!==r;){var o=n,p=o.alternate,v=o.stateNode;if(p!==null&&p===r)break;o.tag===5&&v!==null&&(o=v,i?(p=Sg(n,s),p!=null&&l.unshift(Dg(n,p,o))):i||(p=Sg(n,s),p!=null&&l.push(Dg(n,p,o)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var SV=/\r\n?/g,CV=/\u0000|\uFFFD/g;function RC(t){return(typeof t=="string"?t:""+t).replace(SV,`
`).replace(CV,"")}function b1(t,e,n){if(e=RC(e),RC(t)!==e&&n)throw Error(Bt(425))}function u_(){}var Wb=null,Qb=null;function qb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Zb=typeof setTimeout=="function"?setTimeout:void 0,MV=typeof clearTimeout=="function"?clearTimeout:void 0,BC=typeof Promise=="function"?Promise:void 0,PV=typeof queueMicrotask=="function"?queueMicrotask:typeof BC<"u"?function(t){return BC.resolve(null).then(t).catch(kV)}:Zb;function kV(t){setTimeout(function(){throw t})}function $x(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Pg(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Pg(e)}function ih(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function zC(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Dd=Math.random().toString(36).slice(2),$A="__reactFiber$"+Dd,Rg="__reactProps$"+Dd,Ku="__reactContainer$"+Dd,Yb="__reactEvents$"+Dd,IV="__reactListeners$"+Dd,LV="__reactHandles$"+Dd;function Wh(t){var e=t[$A];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ku]||n[$A]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=zC(t);t!==null;){if(n=t[$A])return n;t=zC(t)}return e}t=n,n=t.parentNode}return null}function vm(t){return t=t[$A]||t[Ku],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function v0(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Bt(33))}function U2(t){return t[Rg]||null}var Xb=[],x0=-1;function wh(t){return{current:t}}function ui(t){0>x0||(t.current=Xb[x0],Xb[x0]=null,x0--)}function ni(t,e){x0++,Xb[x0]=t.current,t.current=e}var dh={},go=wh(dh),la=wh(!1),nf=dh;function ad(t,e){var n=t.type.contextTypes;if(!n)return dh;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Aa(t){return t=t.childContextTypes,t!=null}function c_(){ui(la),ui(go)}function OC(t,e,n){if(go.current!==dh)throw Error(Bt(168));ni(go,e),ni(la,n)}function lD(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Bt(108,gU(t)||"Unknown",i));return wi({},n,r)}function h_(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||dh,nf=go.current,ni(go,t),ni(la,la.current),!0}function FC(t,e,n){var r=t.stateNode;if(!r)throw Error(Bt(169));n?(t=lD(t,e,nf),r.__reactInternalMemoizedMergedChildContext=t,ui(la),ui(go),ni(go,t)):ui(la),ni(la,n)}var Ou=null,V2=!1,jx=!1;function AD(t){Ou===null?Ou=[t]:Ou.push(t)}function DV(t){V2=!0,AD(t)}function bh(){if(!jx&&Ou!==null){jx=!0;var t=0,e=Or;try{var n=Ou;for(Or=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ou=null,V2=!1}catch(i){throw Ou!==null&&(Ou=Ou.slice(t+1)),RL(iT,bh),i}finally{Or=e,jx=!1}}return null}var w0=[],b0=0,f_=null,d_=0,pl=[],gl=0,rf=null,Uu=1,Vu="";function Vh(t,e){w0[b0++]=d_,w0[b0++]=f_,f_=t,d_=e}function uD(t,e,n){pl[gl++]=Uu,pl[gl++]=Vu,pl[gl++]=rf,rf=t;var r=Uu;t=Vu;var i=32-AA(r)-1;r&=~(1<<i),n+=1;var s=32-AA(e)+i;if(30<s){var l=i-i%5;s=(r&(1<<l)-1).toString(32),r>>=l,i-=l,Uu=1<<32-AA(e)+i|n<<i|r,Vu=s+t}else Uu=1<<s|n<<i|r,Vu=t}function fT(t){t.return!==null&&(Vh(t,1),uD(t,1,0))}function dT(t){for(;t===f_;)f_=w0[--b0],w0[b0]=null,d_=w0[--b0],w0[b0]=null;for(;t===rf;)rf=pl[--gl],pl[gl]=null,Vu=pl[--gl],pl[gl]=null,Uu=pl[--gl],pl[gl]=null}var Ua=null,Oa=null,gi=!1,eA=null;function cD(t,e){var n=ml(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function NC(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ua=t,Oa=ih(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ua=t,Oa=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=rf!==null?{id:Uu,overflow:Vu}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ml(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ua=t,Oa=null,!0):!1;default:return!1}}function Kb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Jb(t){if(gi){var e=Oa;if(e){var n=e;if(!NC(t,e)){if(Kb(t))throw Error(Bt(418));e=ih(n.nextSibling);var r=Ua;e&&NC(t,e)?cD(r,n):(t.flags=t.flags&-4097|2,gi=!1,Ua=t)}}else{if(Kb(t))throw Error(Bt(418));t.flags=t.flags&-4097|2,gi=!1,Ua=t}}}function UC(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ua=t}function E1(t){if(t!==Ua)return!1;if(!gi)return UC(t),gi=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!qb(t.type,t.memoizedProps)),e&&(e=Oa)){if(Kb(t))throw hD(),Error(Bt(418));for(;e;)cD(t,e),e=ih(e.nextSibling)}if(UC(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Bt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Oa=ih(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Oa=null}}else Oa=Ua?ih(t.stateNode.nextSibling):null;return!0}function hD(){for(var t=Oa;t;)t=ih(t.nextSibling)}function ld(){Oa=Ua=null,gi=!1}function pT(t){eA===null?eA=[t]:eA.push(t)}var RV=fc.ReactCurrentBatchConfig;function Kl(t,e){if(t&&t.defaultProps){e=wi({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var p_=wh(null),g_=null,E0=null,gT=null;function mT(){gT=E0=g_=null}function yT(t){var e=p_.current;ui(p_),t._currentValue=e}function e3(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Q0(t,e){g_=t,gT=E0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(aa=!0),t.firstContext=null)}function Sl(t){var e=t._currentValue;if(gT!==t)if(t={context:t,memoizedValue:e,next:null},E0===null){if(g_===null)throw Error(Bt(308));E0=t,g_.dependencies={lanes:0,firstContext:t}}else E0=E0.next=t;return e}var Qh=null;function _T(t){Qh===null?Qh=[t]:Qh.push(t)}function fD(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,_T(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ju(t,r)}function Ju(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var $c=!1;function vT(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dD(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wu(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function sh(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Tr&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ju(t,n)}return i=r.interleaved,i===null?(e.next=e,_T(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ju(t,n)}function wy(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sT(t,n)}}function VC(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=l:s=s.next=l,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function m_(t,e,n,r){var i=t.updateQueue;$c=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var p=o,v=p.next;p.next=null,l===null?s=v:l.next=v,l=p;var S=t.alternate;S!==null&&(S=S.updateQueue,o=S.lastBaseUpdate,o!==l&&(o===null?S.firstBaseUpdate=v:o.next=v,S.lastBaseUpdate=p))}if(s!==null){var M=i.baseState;l=0,S=v=p=null,o=s;do{var k=o.lane,F=o.eventTime;if((r&k)===k){S!==null&&(S=S.next={eventTime:F,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var H=t,j=o;switch(k=e,F=n,j.tag){case 1:if(H=j.payload,typeof H=="function"){M=H.call(F,M,k);break e}M=H;break e;case 3:H.flags=H.flags&-65537|128;case 0:if(H=j.payload,k=typeof H=="function"?H.call(F,M,k):H,k==null)break e;M=wi({},M,k);break e;case 2:$c=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,k=i.effects,k===null?i.effects=[o]:k.push(o))}else F={eventTime:F,lane:k,tag:o.tag,payload:o.payload,callback:o.callback,next:null},S===null?(v=S=F,p=M):S=S.next=F,l|=k;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;k=o,o=k.next,k.next=null,i.lastBaseUpdate=k,i.shared.pending=null}}while(1);if(S===null&&(p=M),i.baseState=p,i.firstBaseUpdate=v,i.lastBaseUpdate=S,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);of|=l,t.lanes=l,t.memoizedState=M}}function GC(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Bt(191,i));i.call(r)}}}var pD=new fL.Component().refs;function t3(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:wi({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var G2={isMounted:function(t){return(t=t._reactInternals)?Sf(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=No(),i=ah(t),s=Wu(r,i);s.payload=e,n!=null&&(s.callback=n),e=sh(t,s,i),e!==null&&(uA(e,t,i,r),wy(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=No(),i=ah(t),s=Wu(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=sh(t,s,i),e!==null&&(uA(e,t,i,r),wy(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=No(),r=ah(t),i=Wu(n,r);i.tag=2,e!=null&&(i.callback=e),e=sh(t,i,r),e!==null&&(uA(e,t,r,n),wy(e,t,r))}};function $C(t,e,n,r,i,s,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,l):e.prototype&&e.prototype.isPureReactComponent?!Ig(n,r)||!Ig(i,s):!0}function gD(t,e,n){var r=!1,i=dh,s=e.contextType;return typeof s=="object"&&s!==null?s=Sl(s):(i=Aa(e)?nf:go.current,r=e.contextTypes,s=(r=r!=null)?ad(t,i):dh),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=G2,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function jC(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&G2.enqueueReplaceState(e,e.state,null)}function n3(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=pD,vT(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Sl(s):(s=Aa(e)?nf:go.current,i.context=ad(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(t3(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&G2.enqueueReplaceState(i,i.state,null),m_(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function pp(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Bt(309));var r=n.stateNode}if(!r)throw Error(Bt(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(l){var o=i.refs;o===pD&&(o=i.refs={}),l===null?delete o[s]:o[s]=l},e._stringRef=s,e)}if(typeof t!="string")throw Error(Bt(284));if(!n._owner)throw Error(Bt(290,t))}return t}function T1(t,e){throw t=Object.prototype.toString.call(e),Error(Bt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function HC(t){var e=t._init;return e(t._payload)}function mD(t){function e(Y,J){if(t){var se=Y.deletions;se===null?(Y.deletions=[J],Y.flags|=16):se.push(J)}}function n(Y,J){if(!t)return null;for(;J!==null;)e(Y,J),J=J.sibling;return null}function r(Y,J){for(Y=new Map;J!==null;)J.key!==null?Y.set(J.key,J):Y.set(J.index,J),J=J.sibling;return Y}function i(Y,J){return Y=lh(Y,J),Y.index=0,Y.sibling=null,Y}function s(Y,J,se){return Y.index=se,t?(se=Y.alternate,se!==null?(se=se.index,se<J?(Y.flags|=2,J):se):(Y.flags|=2,J)):(Y.flags|=1048576,J)}function l(Y){return t&&Y.alternate===null&&(Y.flags|=2),Y}function o(Y,J,se,ce){return J===null||J.tag!==6?(J=Xx(se,Y.mode,ce),J.return=Y,J):(J=i(J,se),J.return=Y,J)}function p(Y,J,se,ce){var me=se.type;return me===g0?S(Y,J,se.props.children,ce,se.key):J!==null&&(J.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Gc&&HC(me)===J.type)?(ce=i(J,se.props),ce.ref=pp(Y,J,se),ce.return=Y,ce):(ce=My(se.type,se.key,se.props,null,Y.mode,ce),ce.ref=pp(Y,J,se),ce.return=Y,ce)}function v(Y,J,se,ce){return J===null||J.tag!==4||J.stateNode.containerInfo!==se.containerInfo||J.stateNode.implementation!==se.implementation?(J=Kx(se,Y.mode,ce),J.return=Y,J):(J=i(J,se.children||[]),J.return=Y,J)}function S(Y,J,se,ce,me){return J===null||J.tag!==7?(J=Kh(se,Y.mode,ce,me),J.return=Y,J):(J=i(J,se),J.return=Y,J)}function M(Y,J,se){if(typeof J=="string"&&J!==""||typeof J=="number")return J=Xx(""+J,Y.mode,se),J.return=Y,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case d1:return se=My(J.type,J.key,J.props,null,Y.mode,se),se.ref=pp(Y,null,J),se.return=Y,se;case p0:return J=Kx(J,Y.mode,se),J.return=Y,J;case Gc:var ce=J._init;return M(Y,ce(J._payload),se)}if($p(J)||up(J))return J=Kh(J,Y.mode,se,null),J.return=Y,J;T1(Y,J)}return null}function k(Y,J,se,ce){var me=J!==null?J.key:null;if(typeof se=="string"&&se!==""||typeof se=="number")return me!==null?null:o(Y,J,""+se,ce);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case d1:return se.key===me?p(Y,J,se,ce):null;case p0:return se.key===me?v(Y,J,se,ce):null;case Gc:return me=se._init,k(Y,J,me(se._payload),ce)}if($p(se)||up(se))return me!==null?null:S(Y,J,se,ce,null);T1(Y,se)}return null}function F(Y,J,se,ce,me){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return Y=Y.get(se)||null,o(J,Y,""+ce,me);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case d1:return Y=Y.get(ce.key===null?se:ce.key)||null,p(J,Y,ce,me);case p0:return Y=Y.get(ce.key===null?se:ce.key)||null,v(J,Y,ce,me);case Gc:var Ee=ce._init;return F(Y,J,se,Ee(ce._payload),me)}if($p(ce)||up(ce))return Y=Y.get(se)||null,S(J,Y,ce,me,null);T1(J,ce)}return null}function H(Y,J,se,ce){for(var me=null,Ee=null,He=J,Qe=J=0,Ye=null;He!==null&&Qe<se.length;Qe++){He.index>Qe?(Ye=He,He=null):Ye=He.sibling;var nt=k(Y,He,se[Qe],ce);if(nt===null){He===null&&(He=Ye);break}t&&He&&nt.alternate===null&&e(Y,He),J=s(nt,J,Qe),Ee===null?me=nt:Ee.sibling=nt,Ee=nt,He=Ye}if(Qe===se.length)return n(Y,He),gi&&Vh(Y,Qe),me;if(He===null){for(;Qe<se.length;Qe++)He=M(Y,se[Qe],ce),He!==null&&(J=s(He,J,Qe),Ee===null?me=He:Ee.sibling=He,Ee=He);return gi&&Vh(Y,Qe),me}for(He=r(Y,He);Qe<se.length;Qe++)Ye=F(He,Y,Qe,se[Qe],ce),Ye!==null&&(t&&Ye.alternate!==null&&He.delete(Ye.key===null?Qe:Ye.key),J=s(Ye,J,Qe),Ee===null?me=Ye:Ee.sibling=Ye,Ee=Ye);return t&&He.forEach(function(Fe){return e(Y,Fe)}),gi&&Vh(Y,Qe),me}function j(Y,J,se,ce){var me=up(se);if(typeof me!="function")throw Error(Bt(150));if(se=me.call(se),se==null)throw Error(Bt(151));for(var Ee=me=null,He=J,Qe=J=0,Ye=null,nt=se.next();He!==null&&!nt.done;Qe++,nt=se.next()){He.index>Qe?(Ye=He,He=null):Ye=He.sibling;var Fe=k(Y,He,nt.value,ce);if(Fe===null){He===null&&(He=Ye);break}t&&He&&Fe.alternate===null&&e(Y,He),J=s(Fe,J,Qe),Ee===null?me=Fe:Ee.sibling=Fe,Ee=Fe,He=Ye}if(nt.done)return n(Y,He),gi&&Vh(Y,Qe),me;if(He===null){for(;!nt.done;Qe++,nt=se.next())nt=M(Y,nt.value,ce),nt!==null&&(J=s(nt,J,Qe),Ee===null?me=nt:Ee.sibling=nt,Ee=nt);return gi&&Vh(Y,Qe),me}for(He=r(Y,He);!nt.done;Qe++,nt=se.next())nt=F(He,Y,Qe,nt.value,ce),nt!==null&&(t&&nt.alternate!==null&&He.delete(nt.key===null?Qe:nt.key),J=s(nt,J,Qe),Ee===null?me=nt:Ee.sibling=nt,Ee=nt);return t&&He.forEach(function(tt){return e(Y,tt)}),gi&&Vh(Y,Qe),me}function ie(Y,J,se,ce){if(typeof se=="object"&&se!==null&&se.type===g0&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case d1:e:{for(var me=se.key,Ee=J;Ee!==null;){if(Ee.key===me){if(me=se.type,me===g0){if(Ee.tag===7){n(Y,Ee.sibling),J=i(Ee,se.props.children),J.return=Y,Y=J;break e}}else if(Ee.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Gc&&HC(me)===Ee.type){n(Y,Ee.sibling),J=i(Ee,se.props),J.ref=pp(Y,Ee,se),J.return=Y,Y=J;break e}n(Y,Ee);break}else e(Y,Ee);Ee=Ee.sibling}se.type===g0?(J=Kh(se.props.children,Y.mode,ce,se.key),J.return=Y,Y=J):(ce=My(se.type,se.key,se.props,null,Y.mode,ce),ce.ref=pp(Y,J,se),ce.return=Y,Y=ce)}return l(Y);case p0:e:{for(Ee=se.key;J!==null;){if(J.key===Ee)if(J.tag===4&&J.stateNode.containerInfo===se.containerInfo&&J.stateNode.implementation===se.implementation){n(Y,J.sibling),J=i(J,se.children||[]),J.return=Y,Y=J;break e}else{n(Y,J);break}else e(Y,J);J=J.sibling}J=Kx(se,Y.mode,ce),J.return=Y,Y=J}return l(Y);case Gc:return Ee=se._init,ie(Y,J,Ee(se._payload),ce)}if($p(se))return H(Y,J,se,ce);if(up(se))return j(Y,J,se,ce);T1(Y,se)}return typeof se=="string"&&se!==""||typeof se=="number"?(se=""+se,J!==null&&J.tag===6?(n(Y,J.sibling),J=i(J,se),J.return=Y,Y=J):(n(Y,J),J=Xx(se,Y.mode,ce),J.return=Y,Y=J),l(Y)):n(Y,J)}return ie}var Ad=mD(!0),yD=mD(!1),xm={},ZA=wh(xm),Bg=wh(xm),zg=wh(xm);function qh(t){if(t===xm)throw Error(Bt(174));return t}function xT(t,e){switch(ni(zg,e),ni(Bg,t),ni(ZA,xm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Rb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Rb(e,t)}ui(ZA),ni(ZA,e)}function ud(){ui(ZA),ui(Bg),ui(zg)}function _D(t){qh(zg.current);var e=qh(ZA.current),n=Rb(e,t.type);e!==n&&(ni(Bg,t),ni(ZA,n))}function wT(t){Bg.current===t&&(ui(ZA),ui(Bg))}var _i=wh(0);function y_(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Hx=[];function bT(){for(var t=0;t<Hx.length;t++)Hx[t]._workInProgressVersionPrimary=null;Hx.length=0}var by=fc.ReactCurrentDispatcher,Wx=fc.ReactCurrentBatchConfig,sf=0,xi=null,rs=null,vs=null,__=!1,lg=!1,Og=0,BV=0;function to(){throw Error(Bt(321))}function ET(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!hA(t[n],e[n]))return!1;return!0}function TT(t,e,n,r,i,s){if(sf=s,xi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,by.current=t===null||t.memoizedState===null?NV:UV,t=n(r,i),lg){s=0;do{if(lg=!1,Og=0,25<=s)throw Error(Bt(301));s+=1,vs=rs=null,e.updateQueue=null,by.current=VV,t=n(r,i)}while(lg)}if(by.current=v_,e=rs!==null&&rs.next!==null,sf=0,vs=rs=xi=null,__=!1,e)throw Error(Bt(300));return t}function ST(){var t=Og!==0;return Og=0,t}function GA(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vs===null?xi.memoizedState=vs=t:vs=vs.next=t,vs}function Cl(){if(rs===null){var t=xi.alternate;t=t!==null?t.memoizedState:null}else t=rs.next;var e=vs===null?xi.memoizedState:vs.next;if(e!==null)vs=e,rs=t;else{if(t===null)throw Error(Bt(310));rs=t,t={memoizedState:rs.memoizedState,baseState:rs.baseState,baseQueue:rs.baseQueue,queue:rs.queue,next:null},vs===null?xi.memoizedState=vs=t:vs=vs.next=t}return vs}function Fg(t,e){return typeof e=="function"?e(t):e}function Qx(t){var e=Cl(),n=e.queue;if(n===null)throw Error(Bt(311));n.lastRenderedReducer=t;var r=rs,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=l=null,p=null,v=s;do{var S=v.lane;if((sf&S)===S)p!==null&&(p=p.next={lane:0,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null}),r=v.hasEagerState?v.eagerState:t(r,v.action);else{var M={lane:S,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null};p===null?(o=p=M,l=r):p=p.next=M,xi.lanes|=S,of|=S}v=v.next}while(v!==null&&v!==s);p===null?l=r:p.next=o,hA(r,e.memoizedState)||(aa=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=p,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,xi.lanes|=s,of|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function qx(t){var e=Cl(),n=e.queue;if(n===null)throw Error(Bt(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do s=t(s,l.action),l=l.next;while(l!==i);hA(s,e.memoizedState)||(aa=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function vD(){}function xD(t,e){var n=xi,r=Cl(),i=e(),s=!hA(r.memoizedState,i);if(s&&(r.memoizedState=i,aa=!0),r=r.queue,CT(ED.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||vs!==null&&vs.memoizedState.tag&1){if(n.flags|=2048,Ng(9,bD.bind(null,n,r,i,e),void 0,null),ws===null)throw Error(Bt(349));sf&30||wD(n,e,i)}return i}function wD(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=xi.updateQueue,e===null?(e={lastEffect:null,stores:null},xi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function bD(t,e,n,r){e.value=n,e.getSnapshot=r,TD(e)&&SD(t)}function ED(t,e,n){return n(function(){TD(e)&&SD(t)})}function TD(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!hA(t,n)}catch{return!0}}function SD(t){var e=Ju(t,1);e!==null&&uA(e,t,1,-1)}function WC(t){var e=GA();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fg,lastRenderedState:t},e.queue=t,t=t.dispatch=FV.bind(null,xi,t),[e.memoizedState,t]}function Ng(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=xi.updateQueue,e===null?(e={lastEffect:null,stores:null},xi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function CD(){return Cl().memoizedState}function Ey(t,e,n,r){var i=GA();xi.flags|=t,i.memoizedState=Ng(1|e,n,void 0,r===void 0?null:r)}function $2(t,e,n,r){var i=Cl();r=r===void 0?null:r;var s=void 0;if(rs!==null){var l=rs.memoizedState;if(s=l.destroy,r!==null&&ET(r,l.deps)){i.memoizedState=Ng(e,n,s,r);return}}xi.flags|=t,i.memoizedState=Ng(1|e,n,s,r)}function QC(t,e){return Ey(8390656,8,t,e)}function CT(t,e){return $2(2048,8,t,e)}function MD(t,e){return $2(4,2,t,e)}function PD(t,e){return $2(4,4,t,e)}function kD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function ID(t,e,n){return n=n!=null?n.concat([t]):null,$2(4,4,kD.bind(null,e,t),n)}function MT(){}function LD(t,e){var n=Cl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ET(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function DD(t,e){var n=Cl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ET(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function RD(t,e,n){return sf&21?(hA(n,e)||(n=OL(),xi.lanes|=n,of|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,aa=!0),t.memoizedState=n)}function zV(t,e){var n=Or;Or=n!==0&&4>n?n:4,t(!0);var r=Wx.transition;Wx.transition={};try{t(!1),e()}finally{Or=n,Wx.transition=r}}function BD(){return Cl().memoizedState}function OV(t,e,n){var r=ah(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},zD(t))OD(e,n);else if(n=fD(t,e,n,r),n!==null){var i=No();uA(n,t,r,i),FD(n,e,r)}}function FV(t,e,n){var r=ah(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(zD(t))OD(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var l=e.lastRenderedState,o=s(l,n);if(i.hasEagerState=!0,i.eagerState=o,hA(o,l)){var p=e.interleaved;p===null?(i.next=i,_T(e)):(i.next=p.next,p.next=i),e.interleaved=i;return}}catch{}finally{}n=fD(t,e,i,r),n!==null&&(i=No(),uA(n,t,r,i),FD(n,e,r))}}function zD(t){var e=t.alternate;return t===xi||e!==null&&e===xi}function OD(t,e){lg=__=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function FD(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,sT(t,n)}}var v_={readContext:Sl,useCallback:to,useContext:to,useEffect:to,useImperativeHandle:to,useInsertionEffect:to,useLayoutEffect:to,useMemo:to,useReducer:to,useRef:to,useState:to,useDebugValue:to,useDeferredValue:to,useTransition:to,useMutableSource:to,useSyncExternalStore:to,useId:to,unstable_isNewReconciler:!1},NV={readContext:Sl,useCallback:function(t,e){return GA().memoizedState=[t,e===void 0?null:e],t},useContext:Sl,useEffect:QC,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ey(4194308,4,kD.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ey(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ey(4,2,t,e)},useMemo:function(t,e){var n=GA();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=GA();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=OV.bind(null,xi,t),[r.memoizedState,t]},useRef:function(t){var e=GA();return t={current:t},e.memoizedState=t},useState:WC,useDebugValue:MT,useDeferredValue:function(t){return GA().memoizedState=t},useTransition:function(){var t=WC(!1),e=t[0];return t=zV.bind(null,t[1]),GA().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=xi,i=GA();if(gi){if(n===void 0)throw Error(Bt(407));n=n()}else{if(n=e(),ws===null)throw Error(Bt(349));sf&30||wD(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,QC(ED.bind(null,r,s,t),[t]),r.flags|=2048,Ng(9,bD.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=GA(),e=ws.identifierPrefix;if(gi){var n=Vu,r=Uu;n=(r&~(1<<32-AA(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Og++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=BV++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},UV={readContext:Sl,useCallback:LD,useContext:Sl,useEffect:CT,useImperativeHandle:ID,useInsertionEffect:MD,useLayoutEffect:PD,useMemo:DD,useReducer:Qx,useRef:CD,useState:function(){return Qx(Fg)},useDebugValue:MT,useDeferredValue:function(t){var e=Cl();return RD(e,rs.memoizedState,t)},useTransition:function(){var t=Qx(Fg)[0],e=Cl().memoizedState;return[t,e]},useMutableSource:vD,useSyncExternalStore:xD,useId:BD,unstable_isNewReconciler:!1},VV={readContext:Sl,useCallback:LD,useContext:Sl,useEffect:CT,useImperativeHandle:ID,useInsertionEffect:MD,useLayoutEffect:PD,useMemo:DD,useReducer:qx,useRef:CD,useState:function(){return qx(Fg)},useDebugValue:MT,useDeferredValue:function(t){var e=Cl();return rs===null?e.memoizedState=t:RD(e,rs.memoizedState,t)},useTransition:function(){var t=qx(Fg)[0],e=Cl().memoizedState;return[t,e]},useMutableSource:vD,useSyncExternalStore:xD,useId:BD,unstable_isNewReconciler:!1};function cd(t,e){try{var n="",r=e;do n+=pU(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Zx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function r3(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var GV=typeof WeakMap=="function"?WeakMap:Map;function ND(t,e,n){n=Wu(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){w_||(w_=!0,f3=r),r3(t,e)},n}function UD(t,e,n){n=Wu(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){r3(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){r3(t,e),typeof r!="function"&&(oh===null?oh=new Set([this]):oh.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function qC(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new GV;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=nG.bind(null,t,e,n),e.then(t,t))}function ZC(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function YC(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Wu(-1,1),e.tag=2,sh(n,e,1))),n.lanes|=1),t)}var $V=fc.ReactCurrentOwner,aa=!1;function Do(t,e,n,r){e.child=t===null?yD(e,null,n,r):Ad(e,t.child,n,r)}function XC(t,e,n,r,i){n=n.render;var s=e.ref;return Q0(e,i),r=TT(t,e,n,r,s,i),n=ST(),t!==null&&!aa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ec(t,e,i)):(gi&&n&&fT(e),e.flags|=1,Do(t,e,r,i),e.child)}function KC(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!zT(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,VD(t,e,s,r,i)):(t=My(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var l=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ig,n(l,r)&&t.ref===e.ref)return ec(t,e,i)}return e.flags|=1,t=lh(s,r),t.ref=e.ref,t.return=e,e.child=t}function VD(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Ig(s,r)&&t.ref===e.ref)if(aa=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(aa=!0);else return e.lanes=t.lanes,ec(t,e,i)}return i3(t,e,n,r,i)}function GD(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ni(S0,Ra),Ra|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ni(S0,Ra),Ra|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ni(S0,Ra),Ra|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ni(S0,Ra),Ra|=r;return Do(t,e,i,n),e.child}function $D(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function i3(t,e,n,r,i){var s=Aa(n)?nf:go.current;return s=ad(e,s),Q0(e,i),n=TT(t,e,n,r,s,i),r=ST(),t!==null&&!aa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ec(t,e,i)):(gi&&r&&fT(e),e.flags|=1,Do(t,e,n,i),e.child)}function JC(t,e,n,r,i){if(Aa(n)){var s=!0;h_(e)}else s=!1;if(Q0(e,i),e.stateNode===null)Ty(t,e),gD(e,n,r),n3(e,n,r,i),r=!0;else if(t===null){var l=e.stateNode,o=e.memoizedProps;l.props=o;var p=l.context,v=n.contextType;typeof v=="object"&&v!==null?v=Sl(v):(v=Aa(n)?nf:go.current,v=ad(e,v));var S=n.getDerivedStateFromProps,M=typeof S=="function"||typeof l.getSnapshotBeforeUpdate=="function";M||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==r||p!==v)&&jC(e,l,r,v),$c=!1;var k=e.memoizedState;l.state=k,m_(e,r,l,i),p=e.memoizedState,o!==r||k!==p||la.current||$c?(typeof S=="function"&&(t3(e,n,S,r),p=e.memoizedState),(o=$c||$C(e,n,o,r,k,p,v))?(M||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=p),l.props=r,l.state=p,l.context=v,r=o):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,dD(t,e),o=e.memoizedProps,v=e.type===e.elementType?o:Kl(e.type,o),l.props=v,M=e.pendingProps,k=l.context,p=n.contextType,typeof p=="object"&&p!==null?p=Sl(p):(p=Aa(n)?nf:go.current,p=ad(e,p));var F=n.getDerivedStateFromProps;(S=typeof F=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==M||k!==p)&&jC(e,l,r,p),$c=!1,k=e.memoizedState,l.state=k,m_(e,r,l,i);var H=e.memoizedState;o!==M||k!==H||la.current||$c?(typeof F=="function"&&(t3(e,n,F,r),H=e.memoizedState),(v=$c||$C(e,n,v,r,k,H,p)||!1)?(S||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,H,p),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,H,p)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=H),l.props=r,l.state=H,l.context=p,r=v):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=1024),r=!1)}return s3(t,e,n,r,s,i)}function s3(t,e,n,r,i,s){$D(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&FC(e,n,!1),ec(t,e,s);r=e.stateNode,$V.current=e;var o=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=Ad(e,t.child,null,s),e.child=Ad(e,null,o,s)):Do(t,e,o,s),e.memoizedState=r.state,i&&FC(e,n,!0),e.child}function jD(t){var e=t.stateNode;e.pendingContext?OC(t,e.pendingContext,e.pendingContext!==e.context):e.context&&OC(t,e.context,!1),xT(t,e.containerInfo)}function eM(t,e,n,r,i){return ld(),pT(i),e.flags|=256,Do(t,e,n,r),e.child}var o3={dehydrated:null,treeContext:null,retryLane:0};function a3(t){return{baseLanes:t,cachePool:null,transitions:null}}function HD(t,e,n){var r=e.pendingProps,i=_i.current,s=!1,l=(e.flags&128)!==0,o;if((o=l)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ni(_i,i&1),t===null)return Jb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=W2(l,r,0,null),t=Kh(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=a3(n),e.memoizedState=o3,t):PT(e,l));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return jV(t,e,l,r,o,i,n);if(s){s=r.fallback,l=e.mode,i=t.child,o=i.sibling;var p={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=p,e.deletions=null):(r=lh(i,p),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=lh(o,s):(s=Kh(s,l,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=t.child.memoizedState,l=l===null?a3(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=o3,r}return s=t.child,t=s.sibling,r=lh(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function PT(t,e){return e=W2({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function S1(t,e,n,r){return r!==null&&pT(r),Ad(e,t.child,null,n),t=PT(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function jV(t,e,n,r,i,s,l){if(n)return e.flags&256?(e.flags&=-257,r=Zx(Error(Bt(422))),S1(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=W2({mode:"visible",children:r.children},i,0,null),s=Kh(s,i,l,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ad(e,t.child,null,l),e.child.memoizedState=a3(l),e.memoizedState=o3,s);if(!(e.mode&1))return S1(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(Bt(419)),r=Zx(s,r,void 0),S1(t,e,l,r)}if(o=(l&t.childLanes)!==0,aa||o){if(r=ws,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ju(t,i),uA(r,t,i,-1))}return BT(),r=Zx(Error(Bt(421))),S1(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=rG.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Oa=ih(i.nextSibling),Ua=e,gi=!0,eA=null,t!==null&&(pl[gl++]=Uu,pl[gl++]=Vu,pl[gl++]=rf,Uu=t.id,Vu=t.overflow,rf=e),e=PT(e,r.children),e.flags|=4096,e)}function tM(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),e3(t.return,e,n)}function Yx(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function WD(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Do(t,e,r.children,n),r=_i.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&tM(t,n,e);else if(t.tag===19)tM(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ni(_i,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&y_(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Yx(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&y_(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Yx(e,!0,n,null,s);break;case"together":Yx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ty(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ec(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),of|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Bt(153));if(e.child!==null){for(t=e.child,n=lh(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=lh(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function HV(t,e,n){switch(e.tag){case 3:jD(e),ld();break;case 5:_D(e);break;case 1:Aa(e.type)&&h_(e);break;case 4:xT(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ni(p_,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ni(_i,_i.current&1),e.flags|=128,null):n&e.child.childLanes?HD(t,e,n):(ni(_i,_i.current&1),t=ec(t,e,n),t!==null?t.sibling:null);ni(_i,_i.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return WD(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ni(_i,_i.current),r)break;return null;case 22:case 23:return e.lanes=0,GD(t,e,n)}return ec(t,e,n)}var QD,l3,qD,ZD;QD=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};l3=function(){};qD=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,qh(ZA.current);var s=null;switch(n){case"input":i=kb(t,i),r=kb(t,r),s=[];break;case"select":i=wi({},i,{value:void 0}),r=wi({},r,{value:void 0}),s=[];break;case"textarea":i=Db(t,i),r=Db(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=u_)}Bb(n,r);var l;n=null;for(v in i)if(!r.hasOwnProperty(v)&&i.hasOwnProperty(v)&&i[v]!=null)if(v==="style"){var o=i[v];for(l in o)o.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else v!=="dangerouslySetInnerHTML"&&v!=="children"&&v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(Eg.hasOwnProperty(v)?s||(s=[]):(s=s||[]).push(v,null));for(v in r){var p=r[v];if(o=i?.[v],r.hasOwnProperty(v)&&p!==o&&(p!=null||o!=null))if(v==="style")if(o){for(l in o)!o.hasOwnProperty(l)||p&&p.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in p)p.hasOwnProperty(l)&&o[l]!==p[l]&&(n||(n={}),n[l]=p[l])}else n||(s||(s=[]),s.push(v,n)),n=p;else v==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,o=o?o.__html:void 0,p!=null&&o!==p&&(s=s||[]).push(v,p)):v==="children"?typeof p!="string"&&typeof p!="number"||(s=s||[]).push(v,""+p):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&(Eg.hasOwnProperty(v)?(p!=null&&v==="onScroll"&&Ai("scroll",t),s||o===p||(s=[])):(s=s||[]).push(v,p))}n&&(s=s||[]).push("style",n);var v=s;(e.updateQueue=v)&&(e.flags|=4)}};ZD=function(t,e,n,r){n!==r&&(e.flags|=4)};function gp(t,e){if(!gi)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function no(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function WV(t,e,n){var r=e.pendingProps;switch(dT(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return no(e),null;case 1:return Aa(e.type)&&c_(),no(e),null;case 3:return r=e.stateNode,ud(),ui(la),ui(go),bT(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(E1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,eA!==null&&(g3(eA),eA=null))),l3(t,e),no(e),null;case 5:wT(e);var i=qh(zg.current);if(n=e.type,t!==null&&e.stateNode!=null)qD(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Bt(166));return no(e),null}if(t=qh(ZA.current),E1(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[$A]=e,r[Rg]=s,t=(e.mode&1)!==0,n){case"dialog":Ai("cancel",r),Ai("close",r);break;case"iframe":case"object":case"embed":Ai("load",r);break;case"video":case"audio":for(i=0;i<Hp.length;i++)Ai(Hp[i],r);break;case"source":Ai("error",r);break;case"img":case"image":case"link":Ai("error",r),Ai("load",r);break;case"details":Ai("toggle",r);break;case"input":uC(r,s),Ai("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ai("invalid",r);break;case"textarea":hC(r,s),Ai("invalid",r)}Bb(n,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&b1(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&b1(r.textContent,o,t),i=["children",""+o]):Eg.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Ai("scroll",r)}switch(n){case"input":p1(r),cC(r,s,!0);break;case"textarea":p1(r),fC(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=u_)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=wL(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[$A]=e,t[Rg]=r,QD(t,e,!1,!1),e.stateNode=t;e:{switch(l=zb(n,r),n){case"dialog":Ai("cancel",t),Ai("close",t),i=r;break;case"iframe":case"object":case"embed":Ai("load",t),i=r;break;case"video":case"audio":for(i=0;i<Hp.length;i++)Ai(Hp[i],t);i=r;break;case"source":Ai("error",t),i=r;break;case"img":case"image":case"link":Ai("error",t),Ai("load",t),i=r;break;case"details":Ai("toggle",t),i=r;break;case"input":uC(t,r),i=kb(t,r),Ai("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=wi({},r,{value:void 0}),Ai("invalid",t);break;case"textarea":hC(t,r),i=Db(t,r),Ai("invalid",t);break;default:i=r}Bb(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var p=o[s];s==="style"?TL(t,p):s==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&bL(t,p)):s==="children"?typeof p=="string"?(n!=="textarea"||p!=="")&&Tg(t,p):typeof p=="number"&&Tg(t,""+p):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Eg.hasOwnProperty(s)?p!=null&&s==="onScroll"&&Ai("scroll",t):p!=null&&JE(t,s,p,l))}switch(n){case"input":p1(t),cC(t,r,!1);break;case"textarea":p1(t),fC(t);break;case"option":r.value!=null&&t.setAttribute("value",""+fh(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?$0(t,!!r.multiple,s,!1):r.defaultValue!=null&&$0(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=u_)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return no(e),null;case 6:if(t&&e.stateNode!=null)ZD(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Bt(166));if(n=qh(zg.current),qh(ZA.current),E1(e)){if(r=e.stateNode,n=e.memoizedProps,r[$A]=e,(s=r.nodeValue!==n)&&(t=Ua,t!==null))switch(t.tag){case 3:b1(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&b1(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$A]=e,e.stateNode=r}return no(e),null;case 13:if(ui(_i),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(gi&&Oa!==null&&e.mode&1&&!(e.flags&128))hD(),ld(),e.flags|=98560,s=!1;else if(s=E1(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Bt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Bt(317));s[$A]=e}else ld(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;no(e),s=!1}else eA!==null&&(g3(eA),eA=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||_i.current&1?is===0&&(is=3):BT())),e.updateQueue!==null&&(e.flags|=4),no(e),null);case 4:return ud(),l3(t,e),t===null&&Lg(e.stateNode.containerInfo),no(e),null;case 10:return yT(e.type._context),no(e),null;case 17:return Aa(e.type)&&c_(),no(e),null;case 19:if(ui(_i),s=e.memoizedState,s===null)return no(e),null;if(r=(e.flags&128)!==0,l=s.rendering,l===null)if(r)gp(s,!1);else{if(is!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=y_(t),l!==null){for(e.flags|=128,gp(s,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ni(_i,_i.current&1|2),e.child}t=t.sibling}s.tail!==null&&Fi()>hd&&(e.flags|=128,r=!0,gp(s,!1),e.lanes=4194304)}else{if(!r)if(t=y_(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),gp(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!gi)return no(e),null}else 2*Fi()-s.renderingStartTime>hd&&n!==1073741824&&(e.flags|=128,r=!0,gp(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(n=s.last,n!==null?n.sibling=l:e.child=l,s.last=l)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Fi(),e.sibling=null,n=_i.current,ni(_i,r?n&1|2:n&1),e):(no(e),null);case 22:case 23:return RT(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ra&1073741824&&(no(e),e.subtreeFlags&6&&(e.flags|=8192)):no(e),null;case 24:return null;case 25:return null}throw Error(Bt(156,e.tag))}function QV(t,e){switch(dT(e),e.tag){case 1:return Aa(e.type)&&c_(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ud(),ui(la),ui(go),bT(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return wT(e),null;case 13:if(ui(_i),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Bt(340));ld()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ui(_i),null;case 4:return ud(),null;case 10:return yT(e.type._context),null;case 22:case 23:return RT(),null;case 24:return null;default:return null}}var C1=!1,ho=!1,qV=typeof WeakSet=="function"?WeakSet:Set,hn=null;function T0(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Pi(t,e,r)}else n.current=null}function A3(t,e,n){try{n()}catch(r){Pi(t,e,r)}}var nM=!1;function ZV(t,e){if(Wb=a_,t=JL(),hT(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var l=0,o=-1,p=-1,v=0,S=0,M=t,k=null;t:for(;;){for(var F;M!==n||i!==0&&M.nodeType!==3||(o=l+i),M!==s||r!==0&&M.nodeType!==3||(p=l+r),M.nodeType===3&&(l+=M.nodeValue.length),(F=M.firstChild)!==null;)k=M,M=F;for(;;){if(M===t)break t;if(k===n&&++v===i&&(o=l),k===s&&++S===r&&(p=l),(F=M.nextSibling)!==null)break;M=k,k=M.parentNode}M=F}n=o===-1||p===-1?null:{start:o,end:p}}else n=null}n=n||{start:0,end:0}}else n=null;for(Qb={focusedElem:t,selectionRange:n},a_=!1,hn=e;hn!==null;)if(e=hn,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,hn=t;else for(;hn!==null;){e=hn;try{var H=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(H!==null){var j=H.memoizedProps,ie=H.memoizedState,Y=e.stateNode,J=Y.getSnapshotBeforeUpdate(e.elementType===e.type?j:Kl(e.type,j),ie);Y.__reactInternalSnapshotBeforeUpdate=J}break;case 3:var se=e.stateNode.containerInfo;se.nodeType===1?se.textContent="":se.nodeType===9&&se.documentElement&&se.removeChild(se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Bt(163))}}catch(ce){Pi(e,e.return,ce)}if(t=e.sibling,t!==null){t.return=e.return,hn=t;break}hn=e.return}return H=nM,nM=!1,H}function Ag(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&A3(e,n,s)}i=i.next}while(i!==r)}}function j2(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function u3(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function YD(t){var e=t.alternate;e!==null&&(t.alternate=null,YD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$A],delete e[Rg],delete e[Yb],delete e[IV],delete e[LV])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function XD(t){return t.tag===5||t.tag===3||t.tag===4}function rM(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||XD(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function c3(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=u_));else if(r!==4&&(t=t.child,t!==null))for(c3(t,e,n),t=t.sibling;t!==null;)c3(t,e,n),t=t.sibling}function h3(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(h3(t,e,n),t=t.sibling;t!==null;)h3(t,e,n),t=t.sibling}var Rs=null,Jl=!1;function Dc(t,e,n){for(n=n.child;n!==null;)KD(t,e,n),n=n.sibling}function KD(t,e,n){if(qA&&typeof qA.onCommitFiberUnmount=="function")try{qA.onCommitFiberUnmount(z2,n)}catch{}switch(n.tag){case 5:ho||T0(n,e);case 6:var r=Rs,i=Jl;Rs=null,Dc(t,e,n),Rs=r,Jl=i,Rs!==null&&(Jl?(t=Rs,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Rs.removeChild(n.stateNode));break;case 18:Rs!==null&&(Jl?(t=Rs,n=n.stateNode,t.nodeType===8?$x(t.parentNode,n):t.nodeType===1&&$x(t,n),Pg(t)):$x(Rs,n.stateNode));break;case 4:r=Rs,i=Jl,Rs=n.stateNode.containerInfo,Jl=!0,Dc(t,e,n),Rs=r,Jl=i;break;case 0:case 11:case 14:case 15:if(!ho&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&A3(n,e,l),i=i.next}while(i!==r)}Dc(t,e,n);break;case 1:if(!ho&&(T0(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Pi(n,e,o)}Dc(t,e,n);break;case 21:Dc(t,e,n);break;case 22:n.mode&1?(ho=(r=ho)||n.memoizedState!==null,Dc(t,e,n),ho=r):Dc(t,e,n);break;default:Dc(t,e,n)}}function iM(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new qV),e.forEach(function(r){var i=iG.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Xl(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,l=e,o=l;e:for(;o!==null;){switch(o.tag){case 5:Rs=o.stateNode,Jl=!1;break e;case 3:Rs=o.stateNode.containerInfo,Jl=!0;break e;case 4:Rs=o.stateNode.containerInfo,Jl=!0;break e}o=o.return}if(Rs===null)throw Error(Bt(160));KD(s,l,i),Rs=null,Jl=!1;var p=i.alternate;p!==null&&(p.return=null),i.return=null}catch(v){Pi(i,e,v)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)JD(e,t),e=e.sibling}function JD(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xl(e,t),DA(t),r&4){try{Ag(3,t,t.return),j2(3,t)}catch(j){Pi(t,t.return,j)}try{Ag(5,t,t.return)}catch(j){Pi(t,t.return,j)}}break;case 1:Xl(e,t),DA(t),r&512&&n!==null&&T0(n,n.return);break;case 5:if(Xl(e,t),DA(t),r&512&&n!==null&&T0(n,n.return),t.flags&32){var i=t.stateNode;try{Tg(i,"")}catch(j){Pi(t,t.return,j)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,l=n!==null?n.memoizedProps:s,o=t.type,p=t.updateQueue;if(t.updateQueue=null,p!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&vL(i,s),zb(o,l);var v=zb(o,s);for(l=0;l<p.length;l+=2){var S=p[l],M=p[l+1];S==="style"?TL(i,M):S==="dangerouslySetInnerHTML"?bL(i,M):S==="children"?Tg(i,M):JE(i,S,M,v)}switch(o){case"input":Ib(i,s);break;case"textarea":xL(i,s);break;case"select":var k=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var F=s.value;F!=null?$0(i,!!s.multiple,F,!1):k!==!!s.multiple&&(s.defaultValue!=null?$0(i,!!s.multiple,s.defaultValue,!0):$0(i,!!s.multiple,s.multiple?[]:"",!1))}i[Rg]=s}catch(j){Pi(t,t.return,j)}}break;case 6:if(Xl(e,t),DA(t),r&4){if(t.stateNode===null)throw Error(Bt(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(j){Pi(t,t.return,j)}}break;case 3:if(Xl(e,t),DA(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Pg(e.containerInfo)}catch(j){Pi(t,t.return,j)}break;case 4:Xl(e,t),DA(t);break;case 13:Xl(e,t),DA(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(LT=Fi())),r&4&&iM(t);break;case 22:if(S=n!==null&&n.memoizedState!==null,t.mode&1?(ho=(v=ho)||S,Xl(e,t),ho=v):Xl(e,t),DA(t),r&8192){if(v=t.memoizedState!==null,(t.stateNode.isHidden=v)&&!S&&t.mode&1)for(hn=t,S=t.child;S!==null;){for(M=hn=S;hn!==null;){switch(k=hn,F=k.child,k.tag){case 0:case 11:case 14:case 15:Ag(4,k,k.return);break;case 1:T0(k,k.return);var H=k.stateNode;if(typeof H.componentWillUnmount=="function"){r=k,n=k.return;try{e=r,H.props=e.memoizedProps,H.state=e.memoizedState,H.componentWillUnmount()}catch(j){Pi(r,n,j)}}break;case 5:T0(k,k.return);break;case 22:if(k.memoizedState!==null){oM(M);continue}}F!==null?(F.return=k,hn=F):oM(M)}S=S.sibling}e:for(S=null,M=t;;){if(M.tag===5){if(S===null){S=M;try{i=M.stateNode,v?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=M.stateNode,p=M.memoizedProps.style,l=p!=null&&p.hasOwnProperty("display")?p.display:null,o.style.display=EL("display",l))}catch(j){Pi(t,t.return,j)}}}else if(M.tag===6){if(S===null)try{M.stateNode.nodeValue=v?"":M.memoizedProps}catch(j){Pi(t,t.return,j)}}else if((M.tag!==22&&M.tag!==23||M.memoizedState===null||M===t)&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===t)break e;for(;M.sibling===null;){if(M.return===null||M.return===t)break e;S===M&&(S=null),M=M.return}S===M&&(S=null),M.sibling.return=M.return,M=M.sibling}}break;case 19:Xl(e,t),DA(t),r&4&&iM(t);break;case 21:break;default:Xl(e,t),DA(t)}}function DA(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(XD(n)){var r=n;break e}n=n.return}throw Error(Bt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Tg(i,""),r.flags&=-33);var s=rM(t);h3(t,s,i);break;case 3:case 4:var l=r.stateNode.containerInfo,o=rM(t);c3(t,o,l);break;default:throw Error(Bt(161))}}catch(p){Pi(t,t.return,p)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function YV(t,e,n){hn=t,eR(t)}function eR(t,e,n){for(var r=(t.mode&1)!==0;hn!==null;){var i=hn,s=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||C1;if(!l){var o=i.alternate,p=o!==null&&o.memoizedState!==null||ho;o=C1;var v=ho;if(C1=l,(ho=p)&&!v)for(hn=i;hn!==null;)l=hn,p=l.child,l.tag===22&&l.memoizedState!==null?aM(i):p!==null?(p.return=l,hn=p):aM(i);for(;s!==null;)hn=s,eR(s),s=s.sibling;hn=i,C1=o,ho=v}sM(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,hn=s):sM(t)}}function sM(t){for(;hn!==null;){var e=hn;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ho||j2(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ho)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Kl(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&GC(e,s,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}GC(e,l,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var p=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&n.focus();break;case"img":p.src&&(n.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var v=e.alternate;if(v!==null){var S=v.memoizedState;if(S!==null){var M=S.dehydrated;M!==null&&Pg(M)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Bt(163))}ho||e.flags&512&&u3(e)}catch(k){Pi(e,e.return,k)}}if(e===t){hn=null;break}if(n=e.sibling,n!==null){n.return=e.return,hn=n;break}hn=e.return}}function oM(t){for(;hn!==null;){var e=hn;if(e===t){hn=null;break}var n=e.sibling;if(n!==null){n.return=e.return,hn=n;break}hn=e.return}}function aM(t){for(;hn!==null;){var e=hn;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{j2(4,e)}catch(p){Pi(e,n,p)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(p){Pi(e,i,p)}}var s=e.return;try{u3(e)}catch(p){Pi(e,s,p)}break;case 5:var l=e.return;try{u3(e)}catch(p){Pi(e,l,p)}}}catch(p){Pi(e,e.return,p)}if(e===t){hn=null;break}var o=e.sibling;if(o!==null){o.return=e.return,hn=o;break}hn=e.return}}var XV=Math.ceil,x_=fc.ReactCurrentDispatcher,kT=fc.ReactCurrentOwner,_l=fc.ReactCurrentBatchConfig,Tr=0,ws=null,Yi=null,Os=0,Ra=0,S0=wh(0),is=0,Ug=null,of=0,H2=0,IT=0,ug=null,ia=null,LT=0,hd=1/0,zu=null,w_=!1,f3=null,oh=null,M1=!1,Zc=null,b_=0,cg=0,d3=null,Sy=-1,Cy=0;function No(){return Tr&6?Fi():Sy!==-1?Sy:Sy=Fi()}function ah(t){return t.mode&1?Tr&2&&Os!==0?Os&-Os:RV.transition!==null?(Cy===0&&(Cy=OL()),Cy):(t=Or,t!==0||(t=window.event,t=t===void 0?16:jL(t.type)),t):1}function uA(t,e,n,r){if(50<cg)throw cg=0,d3=null,Error(Bt(185));ym(t,n,r),(!(Tr&2)||t!==ws)&&(t===ws&&(!(Tr&2)&&(H2|=n),is===4&&Wc(t,Os)),ua(t,r),n===1&&Tr===0&&!(e.mode&1)&&(hd=Fi()+500,V2&&bh()))}function ua(t,e){var n=t.callbackNode;RU(t,e);var r=o_(t,t===ws?Os:0);if(r===0)n!==null&&gC(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&gC(n),e===1)t.tag===0?DV(lM.bind(null,t)):AD(lM.bind(null,t)),PV(function(){!(Tr&6)&&bh()}),n=null;else{switch(FL(r)){case 1:n=iT;break;case 4:n=BL;break;case 16:n=s_;break;case 536870912:n=zL;break;default:n=s_}n=lR(n,tR.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function tR(t,e){if(Sy=-1,Cy=0,Tr&6)throw Error(Bt(327));var n=t.callbackNode;if(q0()&&t.callbackNode!==n)return null;var r=o_(t,t===ws?Os:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=E_(t,r);else{e=r;var i=Tr;Tr|=2;var s=rR();(ws!==t||Os!==e)&&(zu=null,hd=Fi()+500,Xh(t,e));do try{eG();break}catch(o){nR(t,o)}while(1);mT(),x_.current=s,Tr=i,Yi!==null?e=0:(ws=null,Os=0,e=is)}if(e!==0){if(e===2&&(i=Vb(t),i!==0&&(r=i,e=p3(t,i))),e===1)throw n=Ug,Xh(t,0),Wc(t,r),ua(t,Fi()),n;if(e===6)Wc(t,r);else{if(i=t.current.alternate,!(r&30)&&!KV(i)&&(e=E_(t,r),e===2&&(s=Vb(t),s!==0&&(r=s,e=p3(t,s))),e===1))throw n=Ug,Xh(t,0),Wc(t,r),ua(t,Fi()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Bt(345));case 2:Gh(t,ia,zu);break;case 3:if(Wc(t,r),(r&130023424)===r&&(e=LT+500-Fi(),10<e)){if(o_(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){No(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Zb(Gh.bind(null,t,ia,zu),e);break}Gh(t,ia,zu);break;case 4:if(Wc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-AA(r);s=1<<l,l=e[l],l>i&&(i=l),r&=~s}if(r=i,r=Fi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*XV(r/1960))-r,10<r){t.timeoutHandle=Zb(Gh.bind(null,t,ia,zu),r);break}Gh(t,ia,zu);break;case 5:Gh(t,ia,zu);break;default:throw Error(Bt(329))}}}return ua(t,Fi()),t.callbackNode===n?tR.bind(null,t):null}function p3(t,e){var n=ug;return t.current.memoizedState.isDehydrated&&(Xh(t,e).flags|=256),t=E_(t,e),t!==2&&(e=ia,ia=n,e!==null&&g3(e)),t}function g3(t){ia===null?ia=t:ia.push.apply(ia,t)}function KV(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!hA(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Wc(t,e){for(e&=~IT,e&=~H2,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-AA(e),r=1<<n;t[n]=-1,e&=~r}}function lM(t){if(Tr&6)throw Error(Bt(327));q0();var e=o_(t,0);if(!(e&1))return ua(t,Fi()),null;var n=E_(t,e);if(t.tag!==0&&n===2){var r=Vb(t);r!==0&&(e=r,n=p3(t,r))}if(n===1)throw n=Ug,Xh(t,0),Wc(t,e),ua(t,Fi()),n;if(n===6)throw Error(Bt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Gh(t,ia,zu),ua(t,Fi()),null}function DT(t,e){var n=Tr;Tr|=1;try{return t(e)}finally{Tr=n,Tr===0&&(hd=Fi()+500,V2&&bh())}}function af(t){Zc!==null&&Zc.tag===0&&!(Tr&6)&&q0();var e=Tr;Tr|=1;var n=_l.transition,r=Or;try{if(_l.transition=null,Or=1,t)return t()}finally{Or=r,_l.transition=n,Tr=e,!(Tr&6)&&bh()}}function RT(){Ra=S0.current,ui(S0)}function Xh(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,MV(n)),Yi!==null)for(n=Yi.return;n!==null;){var r=n;switch(dT(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&c_();break;case 3:ud(),ui(la),ui(go),bT();break;case 5:wT(r);break;case 4:ud();break;case 13:ui(_i);break;case 19:ui(_i);break;case 10:yT(r.type._context);break;case 22:case 23:RT()}n=n.return}if(ws=t,Yi=t=lh(t.current,null),Os=Ra=e,is=0,Ug=null,IT=H2=of=0,ia=ug=null,Qh!==null){for(e=0;e<Qh.length;e++)if(n=Qh[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var l=s.next;s.next=i,r.next=l}n.pending=r}Qh=null}return t}function nR(t,e){do{var n=Yi;try{if(mT(),by.current=v_,__){for(var r=xi.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}__=!1}if(sf=0,vs=rs=xi=null,lg=!1,Og=0,kT.current=null,n===null||n.return===null){is=1,Ug=e,Yi=null;break}e:{var s=t,l=n.return,o=n,p=e;if(e=Os,o.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var v=p,S=o,M=S.tag;if(!(S.mode&1)&&(M===0||M===11||M===15)){var k=S.alternate;k?(S.updateQueue=k.updateQueue,S.memoizedState=k.memoizedState,S.lanes=k.lanes):(S.updateQueue=null,S.memoizedState=null)}var F=ZC(l);if(F!==null){F.flags&=-257,YC(F,l,o,s,e),F.mode&1&&qC(s,v,e),e=F,p=v;var H=e.updateQueue;if(H===null){var j=new Set;j.add(p),e.updateQueue=j}else H.add(p);break e}else{if(!(e&1)){qC(s,v,e),BT();break e}p=Error(Bt(426))}}else if(gi&&o.mode&1){var ie=ZC(l);if(ie!==null){!(ie.flags&65536)&&(ie.flags|=256),YC(ie,l,o,s,e),pT(cd(p,o));break e}}s=p=cd(p,o),is!==4&&(is=2),ug===null?ug=[s]:ug.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var Y=ND(s,p,e);VC(s,Y);break e;case 1:o=p;var J=s.type,se=s.stateNode;if(!(s.flags&128)&&(typeof J.getDerivedStateFromError=="function"||se!==null&&typeof se.componentDidCatch=="function"&&(oh===null||!oh.has(se)))){s.flags|=65536,e&=-e,s.lanes|=e;var ce=UD(s,o,e);VC(s,ce);break e}}s=s.return}while(s!==null)}sR(n)}catch(me){e=me,Yi===n&&n!==null&&(Yi=n=n.return);continue}break}while(1)}function rR(){var t=x_.current;return x_.current=v_,t===null?v_:t}function BT(){(is===0||is===3||is===2)&&(is=4),ws===null||!(of&268435455)&&!(H2&268435455)||Wc(ws,Os)}function E_(t,e){var n=Tr;Tr|=2;var r=rR();(ws!==t||Os!==e)&&(zu=null,Xh(t,e));do try{JV();break}catch(i){nR(t,i)}while(1);if(mT(),Tr=n,x_.current=r,Yi!==null)throw Error(Bt(261));return ws=null,Os=0,is}function JV(){for(;Yi!==null;)iR(Yi)}function eG(){for(;Yi!==null&&!TU();)iR(Yi)}function iR(t){var e=aR(t.alternate,t,Ra);t.memoizedProps=t.pendingProps,e===null?sR(t):Yi=e,kT.current=null}function sR(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=QV(n,e),n!==null){n.flags&=32767,Yi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{is=6,Yi=null;return}}else if(n=WV(n,e,Ra),n!==null){Yi=n;return}if(e=e.sibling,e!==null){Yi=e;return}Yi=e=t}while(e!==null);is===0&&(is=5)}function Gh(t,e,n){var r=Or,i=_l.transition;try{_l.transition=null,Or=1,tG(t,e,n,r)}finally{_l.transition=i,Or=r}return null}function tG(t,e,n,r){do q0();while(Zc!==null);if(Tr&6)throw Error(Bt(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Bt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(BU(t,s),t===ws&&(Yi=ws=null,Os=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||M1||(M1=!0,lR(s_,function(){return q0(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=_l.transition,_l.transition=null;var l=Or;Or=1;var o=Tr;Tr|=4,kT.current=null,ZV(t,n),JD(n,t),xV(Qb),a_=!!Wb,Qb=Wb=null,t.current=n,YV(n),SU(),Tr=o,Or=l,_l.transition=s}else t.current=n;if(M1&&(M1=!1,Zc=t,b_=i),s=t.pendingLanes,s===0&&(oh=null),PU(n.stateNode),ua(t,Fi()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(w_)throw w_=!1,t=f3,f3=null,t;return b_&1&&t.tag!==0&&q0(),s=t.pendingLanes,s&1?t===d3?cg++:(cg=0,d3=t):cg=0,bh(),null}function q0(){if(Zc!==null){var t=FL(b_),e=_l.transition,n=Or;try{if(_l.transition=null,Or=16>t?16:t,Zc===null)var r=!1;else{if(t=Zc,Zc=null,b_=0,Tr&6)throw Error(Bt(331));var i=Tr;for(Tr|=4,hn=t.current;hn!==null;){var s=hn,l=s.child;if(hn.flags&16){var o=s.deletions;if(o!==null){for(var p=0;p<o.length;p++){var v=o[p];for(hn=v;hn!==null;){var S=hn;switch(S.tag){case 0:case 11:case 15:Ag(8,S,s)}var M=S.child;if(M!==null)M.return=S,hn=M;else for(;hn!==null;){S=hn;var k=S.sibling,F=S.return;if(YD(S),S===v){hn=null;break}if(k!==null){k.return=F,hn=k;break}hn=F}}}var H=s.alternate;if(H!==null){var j=H.child;if(j!==null){H.child=null;do{var ie=j.sibling;j.sibling=null,j=ie}while(j!==null)}}hn=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,hn=l;else e:for(;hn!==null;){if(s=hn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ag(9,s,s.return)}var Y=s.sibling;if(Y!==null){Y.return=s.return,hn=Y;break e}hn=s.return}}var J=t.current;for(hn=J;hn!==null;){l=hn;var se=l.child;if(l.subtreeFlags&2064&&se!==null)se.return=l,hn=se;else e:for(l=J;hn!==null;){if(o=hn,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:j2(9,o)}}catch(me){Pi(o,o.return,me)}if(o===l){hn=null;break e}var ce=o.sibling;if(ce!==null){ce.return=o.return,hn=ce;break e}hn=o.return}}if(Tr=i,bh(),qA&&typeof qA.onPostCommitFiberRoot=="function")try{qA.onPostCommitFiberRoot(z2,t)}catch{}r=!0}return r}finally{Or=n,_l.transition=e}}return!1}function AM(t,e,n){e=cd(n,e),e=ND(t,e,1),t=sh(t,e,1),e=No(),t!==null&&(ym(t,1,e),ua(t,e))}function Pi(t,e,n){if(t.tag===3)AM(t,t,n);else for(;e!==null;){if(e.tag===3){AM(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(oh===null||!oh.has(r))){t=cd(n,t),t=UD(e,t,1),e=sh(e,t,1),t=No(),e!==null&&(ym(e,1,t),ua(e,t));break}}e=e.return}}function nG(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=No(),t.pingedLanes|=t.suspendedLanes&n,ws===t&&(Os&n)===n&&(is===4||is===3&&(Os&130023424)===Os&&500>Fi()-LT?Xh(t,0):IT|=n),ua(t,e)}function oR(t,e){e===0&&(t.mode&1?(e=y1,y1<<=1,!(y1&130023424)&&(y1=4194304)):e=1);var n=No();t=Ju(t,e),t!==null&&(ym(t,e,n),ua(t,n))}function rG(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),oR(t,n)}function iG(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Bt(314))}r!==null&&r.delete(e),oR(t,n)}var aR;aR=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||la.current)aa=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return aa=!1,HV(t,e,n);aa=!!(t.flags&131072)}else aa=!1,gi&&e.flags&1048576&&uD(e,d_,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ty(t,e),t=e.pendingProps;var i=ad(e,go.current);Q0(e,n),i=TT(null,e,r,t,i,n);var s=ST();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Aa(r)?(s=!0,h_(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,vT(e),i.updater=G2,e.stateNode=i,i._reactInternals=e,n3(e,r,t,n),e=s3(null,e,r,!0,s,n)):(e.tag=0,gi&&s&&fT(e),Do(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ty(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=oG(r),t=Kl(r,t),i){case 0:e=i3(null,e,r,t,n);break e;case 1:e=JC(null,e,r,t,n);break e;case 11:e=XC(null,e,r,t,n);break e;case 14:e=KC(null,e,r,Kl(r.type,t),n);break e}throw Error(Bt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),i3(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),JC(t,e,r,i,n);case 3:e:{if(jD(e),t===null)throw Error(Bt(387));r=e.pendingProps,s=e.memoizedState,i=s.element,dD(t,e),m_(e,r,null,n);var l=e.memoizedState;if(r=l.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=cd(Error(Bt(423)),e),e=eM(t,e,r,n,i);break e}else if(r!==i){i=cd(Error(Bt(424)),e),e=eM(t,e,r,n,i);break e}else for(Oa=ih(e.stateNode.containerInfo.firstChild),Ua=e,gi=!0,eA=null,n=yD(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ld(),r===i){e=ec(t,e,n);break e}Do(t,e,r,n)}e=e.child}return e;case 5:return _D(e),t===null&&Jb(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,l=i.children,qb(r,i)?l=null:s!==null&&qb(r,s)&&(e.flags|=32),$D(t,e),Do(t,e,l,n),e.child;case 6:return t===null&&Jb(e),null;case 13:return HD(t,e,n);case 4:return xT(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ad(e,null,r,n):Do(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),XC(t,e,r,i,n);case 7:return Do(t,e,e.pendingProps,n),e.child;case 8:return Do(t,e,e.pendingProps.children,n),e.child;case 12:return Do(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,l=i.value,ni(p_,r._currentValue),r._currentValue=l,s!==null)if(hA(s.value,l)){if(s.children===i.children&&!la.current){e=ec(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var p=o.firstContext;p!==null;){if(p.context===r){if(s.tag===1){p=Wu(-1,n&-n),p.tag=2;var v=s.updateQueue;if(v!==null){v=v.shared;var S=v.pending;S===null?p.next=p:(p.next=S.next,S.next=p),v.pending=p}}s.lanes|=n,p=s.alternate,p!==null&&(p.lanes|=n),e3(s.return,n,e),o.lanes|=n;break}p=p.next}}else if(s.tag===10)l=s.type===e.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(Bt(341));l.lanes|=n,o=l.alternate,o!==null&&(o.lanes|=n),e3(l,n,e),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Do(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Q0(e,n),i=Sl(i),r=r(i),e.flags|=1,Do(t,e,r,n),e.child;case 14:return r=e.type,i=Kl(r,e.pendingProps),i=Kl(r.type,i),KC(t,e,r,i,n);case 15:return VD(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Kl(r,i),Ty(t,e),e.tag=1,Aa(r)?(t=!0,h_(e)):t=!1,Q0(e,n),gD(e,r,i),n3(e,r,i,n),s3(null,e,r,!0,t,n);case 19:return WD(t,e,n);case 22:return GD(t,e,n)}throw Error(Bt(156,e.tag))};function lR(t,e){return RL(t,e)}function sG(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ml(t,e,n,r){return new sG(t,e,n,r)}function zT(t){return t=t.prototype,!(!t||!t.isReactComponent)}function oG(t){if(typeof t=="function")return zT(t)?1:0;if(t!=null){if(t=t.$$typeof,t===tT)return 11;if(t===nT)return 14}return 2}function lh(t,e){var n=t.alternate;return n===null?(n=ml(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function My(t,e,n,r,i,s){var l=2;if(r=t,typeof t=="function")zT(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case g0:return Kh(n.children,i,s,e);case eT:l=8,i|=8;break;case Sb:return t=ml(12,n,e,i|2),t.elementType=Sb,t.lanes=s,t;case Cb:return t=ml(13,n,e,i),t.elementType=Cb,t.lanes=s,t;case Mb:return t=ml(19,n,e,i),t.elementType=Mb,t.lanes=s,t;case mL:return W2(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pL:l=10;break e;case gL:l=9;break e;case tT:l=11;break e;case nT:l=14;break e;case Gc:l=16,r=null;break e}throw Error(Bt(130,t==null?t:typeof t,""))}return e=ml(l,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Kh(t,e,n,r){return t=ml(7,t,r,e),t.lanes=n,t}function W2(t,e,n,r){return t=ml(22,t,r,e),t.elementType=mL,t.lanes=n,t.stateNode={isHidden:!1},t}function Xx(t,e,n){return t=ml(6,t,null,e),t.lanes=n,t}function Kx(t,e,n){return e=ml(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function aG(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lx(0),this.expirationTimes=Lx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lx(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function OT(t,e,n,r,i,s,l,o,p){return t=new aG(t,e,n,o,p),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ml(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vT(s),t}function lG(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p0,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function AR(t){if(!t)return dh;t=t._reactInternals;e:{if(Sf(t)!==t||t.tag!==1)throw Error(Bt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Aa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Bt(171))}if(t.tag===1){var n=t.type;if(Aa(n))return lD(t,n,e)}return e}function uR(t,e,n,r,i,s,l,o,p){return t=OT(n,r,!0,t,i,s,l,o,p),t.context=AR(null),n=t.current,r=No(),i=ah(n),s=Wu(r,i),s.callback=e??null,sh(n,s,i),t.current.lanes=i,ym(t,i,r),ua(t,r),t}function Q2(t,e,n,r){var i=e.current,s=No(),l=ah(i);return n=AR(n),e.context===null?e.context=n:e.pendingContext=n,e=Wu(s,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=sh(i,e,l),t!==null&&(uA(t,i,l,s),wy(t,i,l)),l}function T_(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function uM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function FT(t,e){uM(t,e),(t=t.alternate)&&uM(t,e)}function AG(){return null}var cR=typeof reportError=="function"?reportError:function(t){console.error(t)};function NT(t){this._internalRoot=t}q2.prototype.render=NT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Bt(409));Q2(t,e,null,null)};q2.prototype.unmount=NT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;af(function(){Q2(null,t,null,null)}),e[Ku]=null}};function q2(t){this._internalRoot=t}q2.prototype.unstable_scheduleHydration=function(t){if(t){var e=VL();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hc.length&&e!==0&&e<Hc[n].priority;n++);Hc.splice(n,0,t),n===0&&$L(t)}};function UT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Z2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function cM(){}function uG(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var v=T_(l);s.call(v)}}var l=uR(e,r,t,0,null,!1,!1,"",cM);return t._reactRootContainer=l,t[Ku]=l.current,Lg(t.nodeType===8?t.parentNode:t),af(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var v=T_(p);o.call(v)}}var p=OT(t,0,!1,null,null,!1,!1,"",cM);return t._reactRootContainer=p,t[Ku]=p.current,Lg(t.nodeType===8?t.parentNode:t),af(function(){Q2(e,p,n,r)}),p}function Y2(t,e,n,r,i){var s=n._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var o=i;i=function(){var p=T_(l);o.call(p)}}Q2(e,l,t,i)}else l=uG(n,e,t,i,r);return T_(l)}NL=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=jp(e.pendingLanes);n!==0&&(sT(e,n|1),ua(e,Fi()),!(Tr&6)&&(hd=Fi()+500,bh()))}break;case 13:af(function(){var r=Ju(t,1);if(r!==null){var i=No();uA(r,t,1,i)}}),FT(t,1)}};oT=function(t){if(t.tag===13){var e=Ju(t,134217728);if(e!==null){var n=No();uA(e,t,134217728,n)}FT(t,134217728)}};UL=function(t){if(t.tag===13){var e=ah(t),n=Ju(t,e);if(n!==null){var r=No();uA(n,t,e,r)}FT(t,e)}};VL=function(){return Or};GL=function(t,e){var n=Or;try{return Or=t,e()}finally{Or=n}};Fb=function(t,e,n){switch(e){case"input":if(Ib(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=U2(r);if(!i)throw Error(Bt(90));_L(r),Ib(r,i)}}}break;case"textarea":xL(t,n);break;case"select":e=n.value,e!=null&&$0(t,!!n.multiple,e,!1)}};ML=DT;PL=af;var cG={usingClientEntryPoint:!1,Events:[vm,v0,U2,SL,CL,DT]},mp={findFiberByHostInstance:Wh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},hG={bundleType:mp.bundleType,version:mp.version,rendererPackageName:mp.rendererPackageName,rendererConfig:mp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=LL(t),t===null?null:t.stateNode},findFiberByHostInstance:mp.findFiberByHostInstance||AG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var P1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!P1.isDisabled&&P1.supportsFiber)try{z2=P1.inject(hG),qA=P1}catch{}}$a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cG;$a.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!UT(e))throw Error(Bt(200));return lG(t,e,null,n)};$a.createRoot=function(t,e){if(!UT(t))throw Error(Bt(299));var n=!1,r="",i=cR;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=OT(t,1,!1,null,null,n,!1,r,i),t[Ku]=e.current,Lg(t.nodeType===8?t.parentNode:t),new NT(e)};$a.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Bt(188)):(t=Object.keys(t).join(","),Error(Bt(268,t)));return t=LL(e),t=t===null?null:t.stateNode,t};$a.flushSync=function(t){return af(t)};$a.hydrate=function(t,e,n){if(!Z2(e))throw Error(Bt(200));return Y2(null,t,e,!0,n)};$a.hydrateRoot=function(t,e,n){if(!UT(t))throw Error(Bt(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",l=cR;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=uR(e,null,t,1,n??null,i,!1,s,l),t[Ku]=e.current,Lg(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new q2(e)};$a.render=function(t,e,n){if(!Z2(e))throw Error(Bt(200));return Y2(null,t,e,!1,n)};$a.unmountComponentAtNode=function(t){if(!Z2(t))throw Error(Bt(40));return t._reactRootContainer?(af(function(){Y2(null,null,t,!1,function(){t._reactRootContainer=null,t[Ku]=null})}),!0):!1};$a.unstable_batchedUpdates=DT;$a.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Z2(n))throw Error(Bt(200));if(t==null||t._reactInternals===void 0)throw Error(Bt(38));return Y2(t,e,n,!1,r)};$a.version="18.2.0-next-9e3b772b8-20220608";function hR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hR)}catch(t){console.error(t)}}hR(),uL.exports=$a;var VT=uL.exports,fR,hM=VT;fR=hM.createRoot,hM.hydrateRoot;/**
 * @remix-run/router v1.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vg(){return Vg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Vg.apply(this,arguments)}var Yc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Yc||(Yc={}));const fM="popstate";function fG(t){t===void 0&&(t={});function e(i,s){let{pathname:l="/",search:o="",hash:p=""}=Cf(i.location.hash.substr(1));return!l.startsWith("/")&&!l.startsWith(".")&&(l="/"+l),m3("",{pathname:l,search:o,hash:p},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let l=i.document.querySelector("base"),o="";if(l&&l.getAttribute("href")){let p=i.location.href,v=p.indexOf("#");o=v===-1?p:p.slice(0,v)}return o+"#"+(typeof s=="string"?s:S_(s))}function r(i,s){X2(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return pG(e,n,r,t)}function Xi(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function X2(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function dG(){return Math.random().toString(36).substr(2,8)}function dM(t,e){return{usr:t.state,key:t.key,idx:e}}function m3(t,e,n,r){return n===void 0&&(n=null),Vg({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Cf(e):e,{state:n,key:e&&e.key||r||dG()})}function S_(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Cf(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function pG(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,l=i.history,o=Yc.Pop,p=null,v=S();v==null&&(v=0,l.replaceState(Vg({},l.state,{idx:v}),""));function S(){return(l.state||{idx:null}).idx}function M(){o=Yc.Pop;let ie=S(),Y=ie==null?null:ie-v;v=ie,p&&p({action:o,location:j.location,delta:Y})}function k(ie,Y){o=Yc.Push;let J=m3(j.location,ie,Y);n&&n(J,ie),v=S()+1;let se=dM(J,v),ce=j.createHref(J);try{l.pushState(se,"",ce)}catch(me){if(me instanceof DOMException&&me.name==="DataCloneError")throw me;i.location.assign(ce)}s&&p&&p({action:o,location:j.location,delta:1})}function F(ie,Y){o=Yc.Replace;let J=m3(j.location,ie,Y);n&&n(J,ie),v=S();let se=dM(J,v),ce=j.createHref(J);l.replaceState(se,"",ce),s&&p&&p({action:o,location:j.location,delta:0})}function H(ie){let Y=i.location.origin!=="null"?i.location.origin:i.location.href,J=typeof ie=="string"?ie:S_(ie);return Xi(Y,"No window.location.(origin|href) available to create URL for href: "+J),new URL(J,Y)}let j={get action(){return o},get location(){return t(i,l)},listen(ie){if(p)throw new Error("A history only accepts one active listener");return i.addEventListener(fM,M),p=ie,()=>{i.removeEventListener(fM,M),p=null}},createHref(ie){return e(i,ie)},createURL:H,encodeLocation(ie){let Y=H(ie);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:k,replace:F,go(ie){return l.go(ie)}};return j}var pM;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(pM||(pM={}));function gG(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Cf(e):e,i=GT(r.pathname||"/",n);if(i==null)return null;let s=dR(t);mG(s);let l=null;for(let o=0;l==null&&o<s.length;++o)l=SG(s[o],PG(i));return l}function dR(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,l,o)=>{let p={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};p.relativePath.startsWith("/")&&(Xi(p.relativePath.startsWith(r),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(r.length));let v=Ah([r,p.relativePath]),S=n.concat(p);s.children&&s.children.length>0&&(Xi(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),dR(s.children,e,S,v)),!(s.path==null&&!s.index)&&e.push({path:v,score:EG(v,s.index),routesMeta:S})};return t.forEach((s,l)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,l);else for(let p of pR(s.path))i(s,l,p)}),e}function pR(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let l=pR(r.join("/")),o=[];return o.push(...l.map(p=>p===""?s:[s,p].join("/"))),i&&o.push(...l),o.map(p=>t.startsWith("/")&&p===""?"/":p)}function mG(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:TG(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const yG=/^:[\w-]+$/,_G=3,vG=2,xG=1,wG=10,bG=-2,gM=t=>t==="*";function EG(t,e){let n=t.split("/"),r=n.length;return n.some(gM)&&(r+=bG),e&&(r+=vG),n.filter(i=>!gM(i)).reduce((i,s)=>i+(yG.test(s)?_G:s===""?xG:wG),r)}function TG(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function SG(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let l=0;l<n.length;++l){let o=n[l],p=l===n.length-1,v=i==="/"?e:e.slice(i.length)||"/",S=CG({path:o.relativePath,caseSensitive:o.caseSensitive,end:p},v);if(!S)return null;Object.assign(r,S.params);let M=o.route;s.push({params:r,pathname:Ah([i,S.pathname]),pathnameBase:RG(Ah([i,S.pathnameBase])),route:M}),S.pathnameBase!=="/"&&(i=Ah([i,S.pathnameBase]))}return s}function CG(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=MG(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],l=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((v,S,M)=>{let{paramName:k,isOptional:F}=S;if(k==="*"){let j=o[M]||"";l=s.slice(0,s.length-j.length).replace(/(.)\/+$/,"$1")}const H=o[M];return F&&!H?v[k]=void 0:v[k]=kG(H||"",k),v},{}),pathname:s,pathnameBase:l,pattern:t}}function MG(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),X2(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,p)=>(r.push({paramName:o,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function PG(t){try{return decodeURI(t)}catch(e){return X2(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function kG(t,e){try{return decodeURIComponent(t)}catch(n){return X2(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function GT(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function IG(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Cf(t):t;return{pathname:n?n.startsWith("/")?n:LG(n,e):e,search:BG(r),hash:zG(i)}}function LG(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Jx(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function DG(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function gR(t,e){let n=DG(t);return e?n.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function mR(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Cf(t):(i=Vg({},t),Xi(!i.pathname||!i.pathname.includes("?"),Jx("?","pathname","search",i)),Xi(!i.pathname||!i.pathname.includes("#"),Jx("#","pathname","hash",i)),Xi(!i.search||!i.search.includes("#"),Jx("#","search","hash",i)));let s=t===""||i.pathname==="",l=s?"/":i.pathname,o;if(l==null)o=n;else{let M=e.length-1;if(!r&&l.startsWith("..")){let k=l.split("/");for(;k[0]==="..";)k.shift(),M-=1;i.pathname=k.join("/")}o=M>=0?e[M]:"/"}let p=IG(i,o),v=l&&l!=="/"&&l.endsWith("/"),S=(s||l===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(v||S)&&(p.pathname+="/"),p}const Ah=t=>t.join("/").replace(/\/\/+/g,"/"),RG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),BG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,zG=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function OG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const yR=["post","put","patch","delete"];new Set(yR);const FG=["get",...yR];new Set(FG);/**
 * React Router v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gg(){return Gg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gg.apply(this,arguments)}const $T=Ue.createContext(null),NG=Ue.createContext(null),Mf=Ue.createContext(null),K2=Ue.createContext(null),Pf=Ue.createContext({outlet:null,matches:[],isDataRoute:!1}),_R=Ue.createContext(null);function UG(t,e){let{relative:n}=e===void 0?{}:e;wm()||Xi(!1);let{basename:r,navigator:i}=Ue.useContext(Mf),{hash:s,pathname:l,search:o}=xR(t,{relative:n}),p=l;return r!=="/"&&(p=l==="/"?r:Ah([r,l])),i.createHref({pathname:p,search:o,hash:s})}function wm(){return Ue.useContext(K2)!=null}function J2(){return wm()||Xi(!1),Ue.useContext(K2).location}function vR(t){Ue.useContext(Mf).static||Ue.useLayoutEffect(t)}function VG(){let{isDataRoute:t}=Ue.useContext(Pf);return t?e$():GG()}function GG(){wm()||Xi(!1);let t=Ue.useContext($T),{basename:e,future:n,navigator:r}=Ue.useContext(Mf),{matches:i}=Ue.useContext(Pf),{pathname:s}=J2(),l=JSON.stringify(gR(i,n.v7_relativeSplatPath)),o=Ue.useRef(!1);return vR(()=>{o.current=!0}),Ue.useCallback(function(v,S){if(S===void 0&&(S={}),!o.current)return;if(typeof v=="number"){r.go(v);return}let M=mR(v,JSON.parse(l),s,S.relative==="path");t==null&&e!=="/"&&(M.pathname=M.pathname==="/"?e:Ah([e,M.pathname])),(S.replace?r.replace:r.push)(M,S.state,S)},[e,r,l,s,t])}function xR(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=Ue.useContext(Mf),{matches:i}=Ue.useContext(Pf),{pathname:s}=J2(),l=JSON.stringify(gR(i,r.v7_relativeSplatPath));return Ue.useMemo(()=>mR(t,JSON.parse(l),s,n==="path"),[t,l,s,n])}function $G(t,e){return jG(t,e)}function jG(t,e,n,r){wm()||Xi(!1);let{navigator:i}=Ue.useContext(Mf),{matches:s}=Ue.useContext(Pf),l=s[s.length-1],o=l?l.params:{};l&&l.pathname;let p=l?l.pathnameBase:"/";l&&l.route;let v=J2(),S;if(e){var M;let ie=typeof e=="string"?Cf(e):e;p==="/"||(M=ie.pathname)!=null&&M.startsWith(p)||Xi(!1),S=ie}else S=v;let k=S.pathname||"/",F=p==="/"?k:k.slice(p.length)||"/",H=gG(t,{pathname:F}),j=ZG(H&&H.map(ie=>Object.assign({},ie,{params:Object.assign({},o,ie.params),pathname:Ah([p,i.encodeLocation?i.encodeLocation(ie.pathname).pathname:ie.pathname]),pathnameBase:ie.pathnameBase==="/"?p:Ah([p,i.encodeLocation?i.encodeLocation(ie.pathnameBase).pathname:ie.pathnameBase])})),s,n,r);return e&&j?Ue.createElement(K2.Provider,{value:{location:Gg({pathname:"/",search:"",hash:"",state:null,key:"default"},S),navigationType:Yc.Pop}},j):j}function HG(){let t=JG(),e=OG(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return Ue.createElement(Ue.Fragment,null,Ue.createElement("h2",null,"Unexpected Application Error!"),Ue.createElement("h3",{style:{fontStyle:"italic"}},e),n?Ue.createElement("pre",{style:i},n):null,s)}const WG=Ue.createElement(HG,null);class QG extends Ue.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?Ue.createElement(Pf.Provider,{value:this.props.routeContext},Ue.createElement(_R.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function qG(t){let{routeContext:e,match:n,children:r}=t,i=Ue.useContext($T);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),Ue.createElement(Pf.Provider,{value:e},r)}function ZG(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let l=t,o=(i=n)==null?void 0:i.errors;if(o!=null){let S=l.findIndex(M=>M.route.id&&o?.[M.route.id]);S>=0||Xi(!1),l=l.slice(0,Math.min(l.length,S+1))}let p=!1,v=-1;if(n&&r&&r.v7_partialHydration)for(let S=0;S<l.length;S++){let M=l[S];if((M.route.HydrateFallback||M.route.hydrateFallbackElement)&&(v=S),M.route.id){let{loaderData:k,errors:F}=n,H=M.route.loader&&k[M.route.id]===void 0&&(!F||F[M.route.id]===void 0);if(M.route.lazy||H){p=!0,v>=0?l=l.slice(0,v+1):l=[l[0]];break}}}return l.reduceRight((S,M,k)=>{let F,H=!1,j=null,ie=null;n&&(F=o&&M.route.id?o[M.route.id]:void 0,j=M.route.errorElement||WG,p&&(v<0&&k===0?(t$("route-fallback",!1),H=!0,ie=null):v===k&&(H=!0,ie=M.route.hydrateFallbackElement||null)));let Y=e.concat(l.slice(0,k+1)),J=()=>{let se;return F?se=j:H?se=ie:M.route.Component?se=Ue.createElement(M.route.Component,null):M.route.element?se=M.route.element:se=S,Ue.createElement(qG,{match:M,routeContext:{outlet:S,matches:Y,isDataRoute:n!=null},children:se})};return n&&(M.route.ErrorBoundary||M.route.errorElement||k===0)?Ue.createElement(QG,{location:n.location,revalidation:n.revalidation,component:j,error:F,children:J(),routeContext:{outlet:null,matches:Y,isDataRoute:!0}}):J()},null)}var wR=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(wR||{}),C_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(C_||{});function YG(t){let e=Ue.useContext($T);return e||Xi(!1),e}function XG(t){let e=Ue.useContext(NG);return e||Xi(!1),e}function KG(t){let e=Ue.useContext(Pf);return e||Xi(!1),e}function bR(t){let e=KG(),n=e.matches[e.matches.length-1];return n.route.id||Xi(!1),n.route.id}function JG(){var t;let e=Ue.useContext(_R),n=XG(C_.UseRouteError),r=bR(C_.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function e$(){let{router:t}=YG(wR.UseNavigateStable),e=bR(C_.UseNavigateStable),n=Ue.useRef(!1);return vR(()=>{n.current=!0}),Ue.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Gg({fromRouteId:e},s)))},[t,e])}const mM={};function t$(t,e,n){!e&&!mM[t]&&(mM[t]=!0)}function NA(t){Xi(!1)}function n$(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Yc.Pop,navigator:s,static:l=!1,future:o}=t;wm()&&Xi(!1);let p=e.replace(/^\/*/,"/"),v=Ue.useMemo(()=>({basename:p,navigator:s,static:l,future:Gg({v7_relativeSplatPath:!1},o)}),[p,o,s,l]);typeof r=="string"&&(r=Cf(r));let{pathname:S="/",search:M="",hash:k="",state:F=null,key:H="default"}=r,j=Ue.useMemo(()=>{let ie=GT(S,p);return ie==null?null:{location:{pathname:ie,search:M,hash:k,state:F,key:H},navigationType:i}},[p,S,M,k,F,H,i]);return j==null?null:Ue.createElement(Mf.Provider,{value:v},Ue.createElement(K2.Provider,{children:n,value:j}))}function r$(t){let{children:e,location:n}=t;return $G(y3(e),n)}new Promise(()=>{});function y3(t,e){e===void 0&&(e=[]);let n=[];return Ue.Children.forEach(t,(r,i)=>{if(!Ue.isValidElement(r))return;let s=[...e,i];if(r.type===Ue.Fragment){n.push.apply(n,y3(r.props.children,s));return}r.type!==NA&&Xi(!1),!r.props.index||!r.props.children||Xi(!1);let l={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=y3(r.props.children,s)),n.push(l)}),n}/**
 * React Router DOM v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _3(){return _3=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_3.apply(this,arguments)}function i$(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function s$(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function o$(t,e){return t.button===0&&(!e||e==="_self")&&!s$(t)}const a$=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],l$="6";try{window.__reactRouterVersion=l$}catch{}const A$="startTransition",yM=AU[A$];function u$(t){let{basename:e,children:n,future:r,window:i}=t,s=Ue.useRef();s.current==null&&(s.current=fG({window:i,v5Compat:!0}));let l=s.current,[o,p]=Ue.useState({action:l.action,location:l.location}),{v7_startTransition:v}=r||{},S=Ue.useCallback(M=>{v&&yM?yM(()=>p(M)):p(M)},[p,v]);return Ue.useLayoutEffect(()=>l.listen(S),[l,S]),Ue.createElement(n$,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:l,future:r})}const c$=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",h$=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Rh=Ue.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:l,state:o,target:p,to:v,preventScrollReset:S,unstable_viewTransition:M}=e,k=i$(e,a$),{basename:F}=Ue.useContext(Mf),H,j=!1;if(typeof v=="string"&&h$.test(v)&&(H=v,c$))try{let se=new URL(window.location.href),ce=v.startsWith("//")?new URL(se.protocol+v):new URL(v),me=GT(ce.pathname,F);ce.origin===se.origin&&me!=null?v=me+ce.search+ce.hash:j=!0}catch{}let ie=UG(v,{relative:i}),Y=f$(v,{replace:l,state:o,target:p,preventScrollReset:S,relative:i,unstable_viewTransition:M});function J(se){r&&r(se),se.defaultPrevented||Y(se)}return Ue.createElement("a",_3({},k,{href:H||ie,onClick:j||s?r:J,ref:n,target:p}))});var _M;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(_M||(_M={}));var vM;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(vM||(vM={}));function f$(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:l,unstable_viewTransition:o}=e===void 0?{}:e,p=VG(),v=J2(),S=xR(t,{relative:l});return Ue.useCallback(M=>{if(o$(M,n)){M.preventDefault();let k=r!==void 0?r:S_(v)===S_(S);p(t,{replace:k,state:i,preventScrollReset:s,relative:l,unstable_viewTransition:o})}},[v,p,S,r,i,n,t,s,l,o])}function Py(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function d$(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function jT(t){let e,n,r;t.length!==2?(e=Py,n=(o,p)=>Py(t(o),p),r=(o,p)=>t(o)-p):(e=t===Py||t===d$?t:p$,n=t,r=t);function i(o,p,v=0,S=o.length){if(v<S){if(e(p,p)!==0)return S;do{const M=v+S>>>1;n(o[M],p)<0?v=M+1:S=M}while(v<S)}return v}function s(o,p,v=0,S=o.length){if(v<S){if(e(p,p)!==0)return S;do{const M=v+S>>>1;n(o[M],p)<=0?v=M+1:S=M}while(v<S)}return v}function l(o,p,v=0,S=o.length){const M=i(o,p,v,S-1);return M>v&&r(o[M-1],p)>-r(o[M],p)?M-1:M}return{left:i,center:l,right:s}}function p$(){return 0}function g$(t){return t===null?NaN:+t}const m$=jT(Py),y$=m$.right;jT(g$).center;const ER=y$;function Rc(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}class xM extends Map{constructor(e,n=x$){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(wM(this,e))}has(e){return super.has(wM(this,e))}set(e,n){return super.set(_$(this,e),n)}delete(e){return super.delete(v$(this,e))}}function wM({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function _$({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function v$({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function x$(t){return t!==null&&typeof t=="object"?t.valueOf():t}const w$=Math.sqrt(50),b$=Math.sqrt(10),E$=Math.sqrt(2);function M_(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),l=s>=w$?10:s>=b$?5:s>=E$?2:1;let o,p,v;return i<0?(v=Math.pow(10,-i)/l,o=Math.round(t*v),p=Math.round(e*v),o/v<t&&++o,p/v>e&&--p,v=-v):(v=Math.pow(10,i)*l,o=Math.round(t/v),p=Math.round(e/v),o*v<t&&++o,p*v>e&&--p),p<o&&.5<=n&&n<2?M_(t,e,n*2):[o,p,v]}function T$(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,l]=r?M_(e,t,n):M_(t,e,n);if(!(s>=i))return[];const o=s-i+1,p=new Array(o);if(r)if(l<0)for(let v=0;v<o;++v)p[v]=(s-v)/-l;else for(let v=0;v<o;++v)p[v]=(s-v)*l;else if(l<0)for(let v=0;v<o;++v)p[v]=(i+v)/-l;else for(let v=0;v<o;++v)p[v]=(i+v)*l;return p}function v3(t,e,n){return e=+e,t=+t,n=+n,M_(t,e,n)[2]}function x3(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?v3(e,t,n):v3(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function S$(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function ph(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}function C$(t){return t}var ew=1,ky=2,bM=3,Wp=4,EM=1e-6;function M$(t){return"translate("+t+",0)"}function P$(t){return"translate(0,"+t+")"}function k$(t){return e=>+t(e)}function I$(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function L$(){return!this.__axis}function TR(t,e){var n=[],r=null,i=null,s=6,l=6,o=3,p=typeof window<"u"&&window.devicePixelRatio>1?0:.5,v=t===ew||t===Wp?-1:1,S=t===Wp||t===ky?"x":"y",M=t===ew||t===bM?M$:P$;function k(F){var H=r??(e.ticks?e.ticks.apply(e,n):e.domain()),j=i??(e.tickFormat?e.tickFormat.apply(e,n):C$),ie=Math.max(s,0)+o,Y=e.range(),J=+Y[0]+p,se=+Y[Y.length-1]+p,ce=(e.bandwidth?I$:k$)(e.copy(),p),me=F.selection?F.selection():F,Ee=me.selectAll(".domain").data([null]),He=me.selectAll(".tick").data(H,e).order(),Qe=He.exit(),Ye=He.enter().append("g").attr("class","tick"),nt=He.select("line"),Fe=He.select("text");Ee=Ee.merge(Ee.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),He=He.merge(Ye),nt=nt.merge(Ye.append("line").attr("stroke","currentColor").attr(S+"2",v*s)),Fe=Fe.merge(Ye.append("text").attr("fill","currentColor").attr(S,v*ie).attr("dy",t===ew?"0em":t===bM?"0.71em":"0.32em")),F!==me&&(Ee=Ee.transition(F),He=He.transition(F),nt=nt.transition(F),Fe=Fe.transition(F),Qe=Qe.transition(F).attr("opacity",EM).attr("transform",function(tt){return isFinite(tt=ce(tt))?M(tt+p):this.getAttribute("transform")}),Ye.attr("opacity",EM).attr("transform",function(tt){var Ze=this.parentNode.__axis;return M((Ze&&isFinite(Ze=Ze(tt))?Ze:ce(tt))+p)})),Qe.remove(),Ee.attr("d",t===Wp||t===ky?l?"M"+v*l+","+J+"H"+p+"V"+se+"H"+v*l:"M"+p+","+J+"V"+se:l?"M"+J+","+v*l+"V"+p+"H"+se+"V"+v*l:"M"+J+","+p+"H"+se),He.attr("opacity",1).attr("transform",function(tt){return M(ce(tt)+p)}),nt.attr(S+"2",v*s),Fe.attr(S,v*ie).text(j),me.filter(L$).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===ky?"start":t===Wp?"end":"middle"),me.each(function(){this.__axis=ce})}return k.scale=function(F){return arguments.length?(e=F,k):e},k.ticks=function(){return n=Array.from(arguments),k},k.tickArguments=function(F){return arguments.length?(n=F==null?[]:Array.from(F),k):n.slice()},k.tickValues=function(F){return arguments.length?(r=F==null?null:Array.from(F),k):r&&r.slice()},k.tickFormat=function(F){return arguments.length?(i=F,k):i},k.tickSize=function(F){return arguments.length?(s=l=+F,k):s},k.tickSizeInner=function(F){return arguments.length?(s=+F,k):s},k.tickSizeOuter=function(F){return arguments.length?(l=+F,k):l},k.tickPadding=function(F){return arguments.length?(o=+F,k):o},k.offset=function(F){return arguments.length?(p=+F,k):p},k}function lf(t){return TR(ky,t)}function fd(t){return TR(Wp,t)}var D$={value:()=>{}};function SR(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Iy(n)}function Iy(t){this._=t}function R$(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Iy.prototype=SR.prototype={constructor:Iy,on:function(t,e){var n=this._,r=R$(t+"",n),i,s=-1,l=r.length;if(arguments.length<2){for(;++s<l;)if((i=(t=r[s]).type)&&(i=B$(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<l;)if(i=(t=r[s]).type)n[i]=TM(n[i],t.name,e);else if(e==null)for(i in n)n[i]=TM(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Iy(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function B$(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function TM(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=D$,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var w3="http://www.w3.org/1999/xhtml";const SM={svg:"http://www.w3.org/2000/svg",xhtml:w3,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ev(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),SM.hasOwnProperty(e)?{space:SM[e],local:t}:t}function z$(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===w3&&e.documentElement.namespaceURI===w3?e.createElement(t):e.createElementNS(n,t)}}function O$(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function CR(t){var e=ev(t);return(e.local?O$:z$)(e)}function F$(){}function HT(t){return t==null?F$:function(){return this.querySelector(t)}}function N$(t){typeof t!="function"&&(t=HT(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=new Array(l),p,v,S=0;S<l;++S)(p=s[S])&&(v=t.call(p,p.__data__,S,s))&&("__data__"in p&&(v.__data__=p.__data__),o[S]=v);return new Uo(r,this._parents)}function MR(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function U$(){return[]}function PR(t){return t==null?U$:function(){return this.querySelectorAll(t)}}function V$(t){return function(){return MR(t.apply(this,arguments))}}function G$(t){typeof t=="function"?t=V$(t):t=PR(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var l=e[s],o=l.length,p,v=0;v<o;++v)(p=l[v])&&(r.push(t.call(p,p.__data__,v,l)),i.push(p));return new Uo(r,i)}function kR(t){return function(){return this.matches(t)}}function IR(t){return function(e){return e.matches(t)}}var $$=Array.prototype.find;function j$(t){return function(){return $$.call(this.children,t)}}function H$(){return this.firstElementChild}function W$(t){return this.select(t==null?H$:j$(typeof t=="function"?t:IR(t)))}var Q$=Array.prototype.filter;function q$(){return Array.from(this.children)}function Z$(t){return function(){return Q$.call(this.children,t)}}function Y$(t){return this.selectAll(t==null?q$:Z$(typeof t=="function"?t:IR(t)))}function X$(t){typeof t!="function"&&(t=kR(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,v=0;v<l;++v)(p=s[v])&&t.call(p,p.__data__,v,s)&&o.push(p);return new Uo(r,this._parents)}function LR(t){return new Array(t.length)}function K$(){return new Uo(this._enter||this._groups.map(LR),this._parents)}function P_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}P_.prototype={constructor:P_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function J$(t){return function(){return t}}function ej(t,e,n,r,i,s){for(var l=0,o,p=e.length,v=s.length;l<v;++l)(o=e[l])?(o.__data__=s[l],r[l]=o):n[l]=new P_(t,s[l]);for(;l<p;++l)(o=e[l])&&(i[l]=o)}function tj(t,e,n,r,i,s,l){var o,p,v=new Map,S=e.length,M=s.length,k=new Array(S),F;for(o=0;o<S;++o)(p=e[o])&&(k[o]=F=l.call(p,p.__data__,o,e)+"",v.has(F)?i[o]=p:v.set(F,p));for(o=0;o<M;++o)F=l.call(t,s[o],o,s)+"",(p=v.get(F))?(r[o]=p,p.__data__=s[o],v.delete(F)):n[o]=new P_(t,s[o]);for(o=0;o<S;++o)(p=e[o])&&v.get(k[o])===p&&(i[o]=p)}function nj(t){return t.__data__}function rj(t,e){if(!arguments.length)return Array.from(this,nj);var n=e?tj:ej,r=this._parents,i=this._groups;typeof t!="function"&&(t=J$(t));for(var s=i.length,l=new Array(s),o=new Array(s),p=new Array(s),v=0;v<s;++v){var S=r[v],M=i[v],k=M.length,F=ij(t.call(S,S&&S.__data__,v,r)),H=F.length,j=o[v]=new Array(H),ie=l[v]=new Array(H),Y=p[v]=new Array(k);n(S,M,j,ie,Y,F,e);for(var J=0,se=0,ce,me;J<H;++J)if(ce=j[J]){for(J>=se&&(se=J+1);!(me=ie[se])&&++se<H;);ce._next=me||null}}return l=new Uo(l,r),l._enter=o,l._exit=p,l}function ij(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function sj(){return new Uo(this._exit||this._groups.map(LR),this._parents)}function oj(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function aj(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,l=Math.min(i,s),o=new Array(i),p=0;p<l;++p)for(var v=n[p],S=r[p],M=v.length,k=o[p]=new Array(M),F,H=0;H<M;++H)(F=v[H]||S[H])&&(k[H]=F);for(;p<i;++p)o[p]=n[p];return new Uo(o,this._parents)}function lj(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],l;--i>=0;)(l=r[i])&&(s&&l.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(l,s),s=l);return this}function Aj(t){t||(t=uj);function e(M,k){return M&&k?t(M.__data__,k.__data__):!M-!k}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var l=n[s],o=l.length,p=i[s]=new Array(o),v,S=0;S<o;++S)(v=l[S])&&(p[S]=v);p.sort(e)}return new Uo(i,this._parents).order()}function uj(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function cj(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function hj(){return Array.from(this)}function fj(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var l=r[i];if(l)return l}return null}function dj(){let t=0;for(const e of this)++t;return t}function pj(){return!this.node()}function gj(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,l=i.length,o;s<l;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this}function mj(t){return function(){this.removeAttribute(t)}}function yj(t){return function(){this.removeAttributeNS(t.space,t.local)}}function _j(t,e){return function(){this.setAttribute(t,e)}}function vj(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function xj(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function wj(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function bj(t,e){var n=ev(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?yj:mj:typeof e=="function"?n.local?wj:xj:n.local?vj:_j)(n,e))}function DR(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ej(t){return function(){this.style.removeProperty(t)}}function Tj(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Sj(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Cj(t,e,n){return arguments.length>1?this.each((e==null?Ej:typeof e=="function"?Sj:Tj)(t,e,n??"")):dd(this.node(),t)}function dd(t,e){return t.style.getPropertyValue(e)||DR(t).getComputedStyle(t,null).getPropertyValue(e)}function Mj(t){return function(){delete this[t]}}function Pj(t,e){return function(){this[t]=e}}function kj(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Ij(t,e){return arguments.length>1?this.each((e==null?Mj:typeof e=="function"?kj:Pj)(t,e)):this.node()[t]}function RR(t){return t.trim().split(/^|\s+/)}function WT(t){return t.classList||new BR(t)}function BR(t){this._node=t,this._names=RR(t.getAttribute("class")||"")}BR.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function zR(t,e){for(var n=WT(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function OR(t,e){for(var n=WT(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Lj(t){return function(){zR(this,t)}}function Dj(t){return function(){OR(this,t)}}function Rj(t,e){return function(){(e.apply(this,arguments)?zR:OR)(this,t)}}function Bj(t,e){var n=RR(t+"");if(arguments.length<2){for(var r=WT(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Rj:e?Lj:Dj)(n,e))}function zj(){this.textContent=""}function Oj(t){return function(){this.textContent=t}}function Fj(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Nj(t){return arguments.length?this.each(t==null?zj:(typeof t=="function"?Fj:Oj)(t)):this.node().textContent}function Uj(){this.innerHTML=""}function Vj(t){return function(){this.innerHTML=t}}function Gj(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function $j(t){return arguments.length?this.each(t==null?Uj:(typeof t=="function"?Gj:Vj)(t)):this.node().innerHTML}function jj(){this.nextSibling&&this.parentNode.appendChild(this)}function Hj(){return this.each(jj)}function Wj(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Qj(){return this.each(Wj)}function qj(t){var e=typeof t=="function"?t:CR(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Zj(){return null}function Yj(t,e){var n=typeof t=="function"?t:CR(t),r=e==null?Zj:typeof e=="function"?e:HT(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Xj(){var t=this.parentNode;t&&t.removeChild(this)}function Kj(){return this.each(Xj)}function Jj(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function eH(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function tH(t){return this.select(t?eH:Jj)}function nH(t){return arguments.length?this.property("__data__",t):this.node().__data__}function rH(t){return function(e){t.call(this,e,this.__data__)}}function iH(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function sH(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function oH(t,e,n){return function(){var r=this.__on,i,s=rH(e);if(r){for(var l=0,o=r.length;l<o;++l)if((i=r[l]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function aH(t,e,n){var r=iH(t+""),i,s=r.length,l;if(arguments.length<2){var o=this.node().__on;if(o){for(var p=0,v=o.length,S;p<v;++p)for(i=0,S=o[p];i<s;++i)if((l=r[i]).type===S.type&&l.name===S.name)return S.value}return}for(o=e?oH:sH,i=0;i<s;++i)this.each(o(r[i],e,n));return this}function FR(t,e,n){var r=DR(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function lH(t,e){return function(){return FR(this,t,e)}}function AH(t,e){return function(){return FR(this,t,e.apply(this,arguments))}}function uH(t,e){return this.each((typeof e=="function"?AH:lH)(t,e))}function*cH(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,l;i<s;++i)(l=r[i])&&(yield l)}var QT=[null];function Uo(t,e){this._groups=t,this._parents=e}function bm(){return new Uo([[document.documentElement]],QT)}function hH(){return this}Uo.prototype=bm.prototype={constructor:Uo,select:N$,selectAll:G$,selectChild:W$,selectChildren:Y$,filter:X$,data:rj,enter:K$,exit:sj,join:oj,merge:aj,selection:hH,order:lj,sort:Aj,call:cj,nodes:hj,node:fj,size:dj,empty:pj,each:gj,attr:bj,style:Cj,property:Ij,classed:Bj,text:Nj,html:$j,raise:Hj,lower:Qj,append:qj,insert:Yj,remove:Kj,clone:tH,datum:nH,on:aH,dispatch:uH,[Symbol.iterator]:cH};function Gr(t){return typeof t=="string"?new Uo([[document.querySelector(t)]],[document.documentElement]):new Uo([[t]],QT)}function Ui(t){return typeof t=="string"?new Uo([document.querySelectorAll(t)],[document.documentElement]):new Uo([MR(t)],QT)}function Em(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function tv(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function kf(){}var $g=.7,k_=1/$g,Z0="\\s*([+-]?\\d+)\\s*",jg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",YA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",fH=/^#([0-9a-f]{3,8})$/,dH=new RegExp(`^rgb\\(${Z0},${Z0},${Z0}\\)$`),pH=new RegExp(`^rgb\\(${YA},${YA},${YA}\\)$`),gH=new RegExp(`^rgba\\(${Z0},${Z0},${Z0},${jg}\\)$`),mH=new RegExp(`^rgba\\(${YA},${YA},${YA},${jg}\\)$`),yH=new RegExp(`^hsl\\(${jg},${YA},${YA}\\)$`),_H=new RegExp(`^hsla\\(${jg},${YA},${YA},${jg}\\)$`),CM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Em(kf,Af,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:MM,formatHex:MM,formatHex8:vH,formatHsl:xH,formatRgb:PM,toString:PM});function MM(){return this.rgb().formatHex()}function vH(){return this.rgb().formatHex8()}function xH(){return UR(this).formatHsl()}function PM(){return this.rgb().formatRgb()}function Af(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=fH.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?kM(e):n===3?new po(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?k1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?k1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=dH.exec(t))?new po(e[1],e[2],e[3],1):(e=pH.exec(t))?new po(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=gH.exec(t))?k1(e[1],e[2],e[3],e[4]):(e=mH.exec(t))?k1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=yH.exec(t))?DM(e[1],e[2]/100,e[3]/100,1):(e=_H.exec(t))?DM(e[1],e[2]/100,e[3]/100,e[4]):CM.hasOwnProperty(t)?kM(CM[t]):t==="transparent"?new po(NaN,NaN,NaN,0):null}function kM(t){return new po(t>>16&255,t>>8&255,t&255,1)}function k1(t,e,n,r){return r<=0&&(t=e=n=NaN),new po(t,e,n,r)}function NR(t){return t instanceof kf||(t=Af(t)),t?(t=t.rgb(),new po(t.r,t.g,t.b,t.opacity)):new po}function uf(t,e,n,r){return arguments.length===1?NR(t):new po(t,e,n,r??1)}function po(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Em(po,uf,tv(kf,{brighter(t){return t=t==null?k_:Math.pow(k_,t),new po(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?$g:Math.pow($g,t),new po(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new po(Jh(this.r),Jh(this.g),Jh(this.b),I_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:IM,formatHex:IM,formatHex8:wH,formatRgb:LM,toString:LM}));function IM(){return`#${Zh(this.r)}${Zh(this.g)}${Zh(this.b)}`}function wH(){return`#${Zh(this.r)}${Zh(this.g)}${Zh(this.b)}${Zh((isNaN(this.opacity)?1:this.opacity)*255)}`}function LM(){const t=I_(this.opacity);return`${t===1?"rgb(":"rgba("}${Jh(this.r)}, ${Jh(this.g)}, ${Jh(this.b)}${t===1?")":`, ${t})`}`}function I_(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Jh(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Zh(t){return t=Jh(t),(t<16?"0":"")+t.toString(16)}function DM(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nA(t,e,n,r)}function UR(t){if(t instanceof nA)return new nA(t.h,t.s,t.l,t.opacity);if(t instanceof kf||(t=Af(t)),!t)return new nA;if(t instanceof nA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,p=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=p<.5?s+i:2-s-i,l*=60):o=p>0&&p<1?0:l,new nA(l,o,p,t.opacity)}function bH(t,e,n,r){return arguments.length===1?UR(t):new nA(t,e,n,r??1)}function nA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Em(nA,bH,tv(kf,{brighter(t){return t=t==null?k_:Math.pow(k_,t),new nA(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?$g:Math.pow($g,t),new nA(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new po(tw(t>=240?t-240:t+120,i,r),tw(t,i,r),tw(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new nA(RM(this.h),I1(this.s),I1(this.l),I_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=I_(this.opacity);return`${t===1?"hsl(":"hsla("}${RM(this.h)}, ${I1(this.s)*100}%, ${I1(this.l)*100}%${t===1?")":`, ${t})`}`}}));function RM(t){return t=(t||0)%360,t<0?t+360:t}function I1(t){return Math.max(0,Math.min(1,t||0))}function tw(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const EH=Math.PI/180,TH=180/Math.PI,L_=18,VR=.96422,GR=1,$R=.82521,jR=4/29,Y0=6/29,HR=3*Y0*Y0,SH=Y0*Y0*Y0;function WR(t){if(t instanceof XA)return new XA(t.l,t.a,t.b,t.opacity);if(t instanceof QA)return qR(t);t instanceof po||(t=NR(t));var e=sw(t.r),n=sw(t.g),r=sw(t.b),i=nw((.2225045*e+.7168786*n+.0606169*r)/GR),s,l;return e===n&&n===r?s=l=i:(s=nw((.4360747*e+.3850649*n+.1430804*r)/VR),l=nw((.0139322*e+.0971045*n+.7141733*r)/$R)),new XA(116*i-16,500*(s-i),200*(i-l),t.opacity)}function CH(t,e,n,r){return arguments.length===1?WR(t):new XA(t,e,n,r??1)}function XA(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}Em(XA,CH,tv(kf,{brighter(t){return new XA(this.l+L_*(t??1),this.a,this.b,this.opacity)},darker(t){return new XA(this.l-L_*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=VR*rw(e),t=GR*rw(t),n=$R*rw(n),new po(iw(3.1338561*e-1.6168667*t-.4906146*n),iw(-.9787684*e+1.9161415*t+.033454*n),iw(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function nw(t){return t>SH?Math.pow(t,1/3):t/HR+jR}function rw(t){return t>Y0?t*t*t:HR*(t-jR)}function iw(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function sw(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function QR(t){if(t instanceof QA)return new QA(t.h,t.c,t.l,t.opacity);if(t instanceof XA||(t=WR(t)),t.a===0&&t.b===0)return new QA(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*TH;return new QA(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function BM(t,e,n,r){return arguments.length===1?QR(t):new QA(n,e,t,r??1)}function MH(t,e,n,r){return arguments.length===1?QR(t):new QA(t,e,n,r??1)}function QA(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function qR(t){if(isNaN(t.h))return new XA(t.l,0,0,t.opacity);var e=t.h*EH;return new XA(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Em(QA,MH,tv(kf,{brighter(t){return new QA(this.h,this.c,this.l+L_*(t??1),this.opacity)},darker(t){return new QA(this.h,this.c,this.l-L_*(t??1),this.opacity)},rgb(){return qR(this).rgb()}}));function PH(t,e,n,r,i){var s=t*t,l=s*t;return((1-3*t+3*s-l)*e+(4-6*s+3*l)*n+(1+3*t+3*s-3*l)*r+l*i)/6}function kH(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],s=t[r+1],l=r>0?t[r-1]:2*i-s,o=r<e-1?t[r+2]:2*s-i;return PH((n-r/e)*e,l,i,s,o)}}const qT=t=>()=>t;function IH(t,e){return function(n){return t+n*e}}function LH(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function DH(t){return(t=+t)==1?ZR:function(e,n){return n-e?LH(e,n,t):qT(isNaN(e)?n:e)}}function ZR(t,e){var n=e-t;return n?IH(t,n):qT(isNaN(t)?e:t)}const D_=function t(e){var n=DH(e);function r(i,s){var l=n((i=uf(i)).r,(s=uf(s)).r),o=n(i.g,s.g),p=n(i.b,s.b),v=ZR(i.opacity,s.opacity);return function(S){return i.r=l(S),i.g=o(S),i.b=p(S),i.opacity=v(S),i+""}}return r.gamma=t,r}(1);function RH(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),s=new Array(n),l,o;for(l=0;l<n;++l)o=uf(e[l]),r[l]=o.r||0,i[l]=o.g||0,s[l]=o.b||0;return r=t(r),i=t(i),s=t(s),o.opacity=1,function(p){return o.r=r(p),o.g=i(p),o.b=s(p),o+""}}}var YR=RH(kH);function BH(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function zH(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function OH(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),l;for(l=0;l<r;++l)i[l]=ZT(t[l],e[l]);for(;l<n;++l)s[l]=e[l];return function(o){for(l=0;l<r;++l)s[l]=i[l](o);return s}}function FH(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function tA(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function NH(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=ZT(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var b3=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ow=new RegExp(b3.source,"g");function UH(t){return function(){return t}}function VH(t){return function(e){return t(e)+""}}function XR(t,e){var n=b3.lastIndex=ow.lastIndex=0,r,i,s,l=-1,o=[],p=[];for(t=t+"",e=e+"";(r=b3.exec(t))&&(i=ow.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,p.push({i:l,x:tA(r,i)})),n=ow.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?p[0]?VH(p[0].x):UH(e):(e=p.length,function(v){for(var S=0,M;S<e;++S)o[(M=p[S]).i]=M.x(v);return o.join("")})}function ZT(t,e){var n=typeof e,r;return e==null||n==="boolean"?qT(e):(n==="number"?tA:n==="string"?(r=Af(e))?(e=r,D_):XR:e instanceof Af?D_:e instanceof Date?FH:zH(e)?BH:Array.isArray(e)?OH:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?NH:tA)(t,e)}function GH(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var zM=180/Math.PI,E3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function KR(t,e,n,r,i,s){var l,o,p;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(p=t*n+e*r)&&(n-=t*p,r-=e*p),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,p/=o),t*r<e*n&&(t=-t,e=-e,p=-p,l=-l),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*zM,skewX:Math.atan(p)*zM,scaleX:l,scaleY:o}}var L1;function $H(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?E3:KR(e.a,e.b,e.c,e.d,e.e,e.f)}function jH(t){return t==null||(L1||(L1=document.createElementNS("http://www.w3.org/2000/svg","g")),L1.setAttribute("transform",t),!(t=L1.transform.baseVal.consolidate()))?E3:(t=t.matrix,KR(t.a,t.b,t.c,t.d,t.e,t.f))}function JR(t,e,n,r){function i(v){return v.length?v.pop()+" ":""}function s(v,S,M,k,F,H){if(v!==M||S!==k){var j=F.push("translate(",null,e,null,n);H.push({i:j-4,x:tA(v,M)},{i:j-2,x:tA(S,k)})}else(M||k)&&F.push("translate("+M+e+k+n)}function l(v,S,M,k){v!==S?(v-S>180?S+=360:S-v>180&&(v+=360),k.push({i:M.push(i(M)+"rotate(",null,r)-2,x:tA(v,S)})):S&&M.push(i(M)+"rotate("+S+r)}function o(v,S,M,k){v!==S?k.push({i:M.push(i(M)+"skewX(",null,r)-2,x:tA(v,S)}):S&&M.push(i(M)+"skewX("+S+r)}function p(v,S,M,k,F,H){if(v!==M||S!==k){var j=F.push(i(F)+"scale(",null,",",null,")");H.push({i:j-4,x:tA(v,M)},{i:j-2,x:tA(S,k)})}else(M!==1||k!==1)&&F.push(i(F)+"scale("+M+","+k+")")}return function(v,S){var M=[],k=[];return v=t(v),S=t(S),s(v.translateX,v.translateY,S.translateX,S.translateY,M,k),l(v.rotate,S.rotate,M,k),o(v.skewX,S.skewX,M,k),p(v.scaleX,v.scaleY,S.scaleX,S.scaleY,M,k),v=S=null,function(F){for(var H=-1,j=k.length,ie;++H<j;)M[(ie=k[H]).i]=ie.x(F);return M.join("")}}}var HH=JR($H,"px, ","px)","deg)"),WH=JR(jH,", ",")",")");function OM(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}var pd=0,Qp=0,yp=0,eB=1e3,R_,qp,B_=0,cf=0,nv=0,Hg=typeof performance=="object"&&performance.now?performance:Date,tB=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function YT(){return cf||(tB(QH),cf=Hg.now()+nv)}function QH(){cf=0}function z_(){this._call=this._time=this._next=null}z_.prototype=nB.prototype={constructor:z_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?YT():+n)+(e==null?0:+e),!this._next&&qp!==this&&(qp?qp._next=this:R_=this,qp=this),this._call=t,this._time=n,T3()},stop:function(){this._call&&(this._call=null,this._time=1/0,T3())}};function nB(t,e,n){var r=new z_;return r.restart(t,e,n),r}function qH(){YT(),++pd;for(var t=R_,e;t;)(e=cf-t._time)>=0&&t._call.call(void 0,e),t=t._next;--pd}function FM(){cf=(B_=Hg.now())+nv,pd=Qp=0;try{qH()}finally{pd=0,YH(),cf=0}}function ZH(){var t=Hg.now(),e=t-B_;e>eB&&(nv-=e,B_=t)}function YH(){for(var t,e=R_,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:R_=n);qp=t,T3(r)}function T3(t){if(!pd){Qp&&(Qp=clearTimeout(Qp));var e=t-cf;e>24?(t<1/0&&(Qp=setTimeout(FM,t-Hg.now()-nv)),yp&&(yp=clearInterval(yp))):(yp||(B_=Hg.now(),yp=setInterval(ZH,eB)),pd=1,tB(FM))}}function NM(t,e,n){var r=new z_;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var XH=SR("start","end","cancel","interrupt"),KH=[],rB=0,UM=1,S3=2,Ly=3,VM=4,C3=5,Dy=6;function rv(t,e,n,r,i,s){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;JH(t,n,{name:e,index:r,group:i,on:XH,tween:KH,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:rB})}function XT(t,e){var n=gA(t,e);if(n.state>rB)throw new Error("too late; already scheduled");return n}function ru(t,e){var n=gA(t,e);if(n.state>Ly)throw new Error("too late; already running");return n}function gA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function JH(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=nB(s,0,n.time);function s(v){n.state=UM,n.timer.restart(l,n.delay,n.time),n.delay<=v&&l(v-n.delay)}function l(v){var S,M,k,F;if(n.state!==UM)return p();for(S in r)if(F=r[S],F.name===n.name){if(F.state===Ly)return NM(l);F.state===VM?(F.state=Dy,F.timer.stop(),F.on.call("interrupt",t,t.__data__,F.index,F.group),delete r[S]):+S<e&&(F.state=Dy,F.timer.stop(),F.on.call("cancel",t,t.__data__,F.index,F.group),delete r[S])}if(NM(function(){n.state===Ly&&(n.state=VM,n.timer.restart(o,n.delay,n.time),o(v))}),n.state=S3,n.on.call("start",t,t.__data__,n.index,n.group),n.state===S3){for(n.state=Ly,i=new Array(k=n.tween.length),S=0,M=-1;S<k;++S)(F=n.tween[S].value.call(t,t.__data__,n.index,n.group))&&(i[++M]=F);i.length=M+1}}function o(v){for(var S=v<n.duration?n.ease.call(null,v/n.duration):(n.timer.restart(p),n.state=C3,1),M=-1,k=i.length;++M<k;)i[M].call(t,S);n.state===C3&&(n.on.call("end",t,t.__data__,n.index,n.group),p())}function p(){n.state=Dy,n.timer.stop(),delete r[e];for(var v in r)return;delete t.__transition}}function eW(t,e){var n=t.__transition,r,i,s=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){s=!1;continue}i=r.state>S3&&r.state<C3,r.state=Dy,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}s&&delete t.__transition}}function tW(t){return this.each(function(){eW(this,t)})}function nW(t,e){var n,r;return function(){var i=ru(this,t),s=i.tween;if(s!==n){r=n=s;for(var l=0,o=r.length;l<o;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function rW(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=ru(this,t),l=s.tween;if(l!==r){i=(r=l).slice();for(var o={name:e,value:n},p=0,v=i.length;p<v;++p)if(i[p].name===e){i[p]=o;break}p===v&&i.push(o)}s.tween=i}}function iW(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=gA(this.node(),n).tween,i=0,s=r.length,l;i<s;++i)if((l=r[i]).name===t)return l.value;return null}return this.each((e==null?nW:rW)(n,t,e))}function KT(t,e,n){var r=t._id;return t.each(function(){var i=ru(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return gA(i,r).value[e]}}function iB(t,e){var n;return(typeof e=="number"?tA:e instanceof Af?D_:(n=Af(e))?(e=n,D_):XR)(t,e)}function sW(t){return function(){this.removeAttribute(t)}}function oW(t){return function(){this.removeAttributeNS(t.space,t.local)}}function aW(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttribute(t);return l===i?null:l===r?s:s=e(r=l,n)}}function lW(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttributeNS(t.space,t.local);return l===i?null:l===r?s:s=e(r=l,n)}}function AW(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttribute(t):(l=this.getAttribute(t),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function uW(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function cW(t,e){var n=ev(t),r=n==="transform"?WH:iB;return this.attrTween(t,typeof e=="function"?(n.local?uW:AW)(n,r,KT(this,"attr."+t,e)):e==null?(n.local?oW:sW)(n):(n.local?lW:aW)(n,r,e))}function hW(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function fW(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function dW(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&fW(t,s)),n}return i._value=e,i}function pW(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&hW(t,s)),n}return i._value=e,i}function gW(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=ev(t);return this.tween(n,(r.local?dW:pW)(r,e))}function mW(t,e){return function(){XT(this,t).delay=+e.apply(this,arguments)}}function yW(t,e){return e=+e,function(){XT(this,t).delay=e}}function _W(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?mW:yW)(e,t)):gA(this.node(),e).delay}function vW(t,e){return function(){ru(this,t).duration=+e.apply(this,arguments)}}function xW(t,e){return e=+e,function(){ru(this,t).duration=e}}function wW(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?vW:xW)(e,t)):gA(this.node(),e).duration}function bW(t,e){if(typeof e!="function")throw new Error;return function(){ru(this,t).ease=e}}function EW(t){var e=this._id;return arguments.length?this.each(bW(e,t)):gA(this.node(),e).ease}function TW(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ru(this,t).ease=n}}function SW(t){if(typeof t!="function")throw new Error;return this.each(TW(this._id,t))}function CW(t){typeof t!="function"&&(t=kR(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,v=0;v<l;++v)(p=s[v])&&t.call(p,p.__data__,v,s)&&o.push(p);return new tc(r,this._parents,this._name,this._id)}function MW(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),l=new Array(r),o=0;o<s;++o)for(var p=e[o],v=n[o],S=p.length,M=l[o]=new Array(S),k,F=0;F<S;++F)(k=p[F]||v[F])&&(M[F]=k);for(;o<r;++o)l[o]=e[o];return new tc(l,this._parents,this._name,this._id)}function PW(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function kW(t,e,n){var r,i,s=PW(e)?XT:ru;return function(){var l=s(this,t),o=l.on;o!==r&&(i=(r=o).copy()).on(e,n),l.on=i}}function IW(t,e){var n=this._id;return arguments.length<2?gA(this.node(),n).on.on(t):this.each(kW(n,t,e))}function LW(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function DW(){return this.on("end.remove",LW(this._id))}function RW(t){var e=this._name,n=this._id;typeof t!="function"&&(t=HT(t));for(var r=this._groups,i=r.length,s=new Array(i),l=0;l<i;++l)for(var o=r[l],p=o.length,v=s[l]=new Array(p),S,M,k=0;k<p;++k)(S=o[k])&&(M=t.call(S,S.__data__,k,o))&&("__data__"in S&&(M.__data__=S.__data__),v[k]=M,rv(v[k],e,n,k,v,gA(S,n)));return new tc(s,this._parents,e,n)}function BW(t){var e=this._name,n=this._id;typeof t!="function"&&(t=PR(t));for(var r=this._groups,i=r.length,s=[],l=[],o=0;o<i;++o)for(var p=r[o],v=p.length,S,M=0;M<v;++M)if(S=p[M]){for(var k=t.call(S,S.__data__,M,p),F,H=gA(S,n),j=0,ie=k.length;j<ie;++j)(F=k[j])&&rv(F,e,n,j,k,H);s.push(k),l.push(S)}return new tc(s,l,e,n)}var zW=bm.prototype.constructor;function OW(){return new zW(this._groups,this._parents)}function FW(t,e){var n,r,i;return function(){var s=dd(this,t),l=(this.style.removeProperty(t),dd(this,t));return s===l?null:s===n&&l===r?i:i=e(n=s,r=l)}}function sB(t){return function(){this.style.removeProperty(t)}}function NW(t,e,n){var r,i=n+"",s;return function(){var l=dd(this,t);return l===i?null:l===r?s:s=e(r=l,n)}}function UW(t,e,n){var r,i,s;return function(){var l=dd(this,t),o=n(this),p=o+"";return o==null&&(p=o=(this.style.removeProperty(t),dd(this,t))),l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o))}}function VW(t,e){var n,r,i,s="style."+e,l="end."+s,o;return function(){var p=ru(this,t),v=p.on,S=p.value[s]==null?o||(o=sB(e)):void 0;(v!==n||i!==S)&&(r=(n=v).copy()).on(l,i=S),p.on=r}}function GW(t,e,n){var r=(t+="")=="transform"?HH:iB;return e==null?this.styleTween(t,FW(t,r)).on("end.style."+t,sB(t)):typeof e=="function"?this.styleTween(t,UW(t,r,KT(this,"style."+t,e))).each(VW(this._id,t)):this.styleTween(t,NW(t,r,e),n).on("end.style."+t,null)}function $W(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function jW(t,e,n){var r,i;function s(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&$W(t,l,n)),r}return s._value=e,s}function HW(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,jW(t,e,n??""))}function WW(t){return function(){this.textContent=t}}function QW(t){return function(){var e=t(this);this.textContent=e??""}}function qW(t){return this.tween("text",typeof t=="function"?QW(KT(this,"text",t)):WW(t==null?"":t+""))}function ZW(t){return function(e){this.textContent=t.call(this,e)}}function YW(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&ZW(i)),e}return r._value=t,r}function XW(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,YW(t))}function KW(){for(var t=this._name,e=this._id,n=oB(),r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,v=0;v<o;++v)if(p=l[v]){var S=gA(p,e);rv(p,t,n,v,l,{time:S.time+S.delay+S.duration,delay:0,duration:S.duration,ease:S.ease})}return new tc(r,this._parents,t,n)}function JW(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,l){var o={value:l},p={value:function(){--i===0&&s()}};n.each(function(){var v=ru(this,r),S=v.on;S!==t&&(e=(t=S).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(p)),v.on=e}),i===0&&s()})}var eQ=0;function tc(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function oB(){return++eQ}var Lu=bm.prototype;tc.prototype={constructor:tc,select:RW,selectAll:BW,selectChild:Lu.selectChild,selectChildren:Lu.selectChildren,filter:CW,merge:MW,selection:OW,transition:KW,call:Lu.call,nodes:Lu.nodes,node:Lu.node,size:Lu.size,empty:Lu.empty,each:Lu.each,on:IW,attr:cW,attrTween:gW,style:GW,styleTween:HW,text:qW,textTween:XW,remove:DW,tween:iW,delay:_W,duration:wW,ease:EW,easeVarying:SW,end:JW,[Symbol.iterator]:Lu[Symbol.iterator]};function tQ(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var nQ={time:null,delay:0,duration:250,ease:tQ};function rQ(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function iQ(t){var e,n;t instanceof tc?(e=t._id,t=t._name):(e=oB(),(n=nQ).time=YT(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,v=0;v<o;++v)(p=l[v])&&rv(p,t,e,v,l,n||rQ(p,e));return new tc(r,this._parents,t,e)}bm.prototype.interrupt=tW;bm.prototype.transition=iQ;const M3=Math.PI,P3=2*M3,$h=1e-6,sQ=P3-$h;function aB(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function oQ(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return aB;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let aQ=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?aB:oQ(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,l){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+l}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let l=this._x1,o=this._y1,p=r-e,v=i-n,S=l-e,M=o-n,k=S*S+M*M;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(k>$h)if(!(Math.abs(M*p-v*S)>$h)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let F=r-l,H=i-o,j=p*p+v*v,ie=F*F+H*H,Y=Math.sqrt(j),J=Math.sqrt(k),se=s*Math.tan((M3-Math.acos((j+k-ie)/(2*Y*J)))/2),ce=se/J,me=se/Y;Math.abs(ce-1)>$h&&this._append`L${e+ce*S},${n+ce*M}`,this._append`A${s},${s},0,0,${+(M*F>S*H)},${this._x1=e+me*p},${this._y1=n+me*v}`}}arc(e,n,r,i,s,l){if(e=+e,n=+n,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),p=r*Math.sin(i),v=e+o,S=n+p,M=1^l,k=l?i-s:s-i;this._x1===null?this._append`M${v},${S}`:(Math.abs(this._x1-v)>$h||Math.abs(this._y1-S)>$h)&&this._append`L${v},${S}`,r&&(k<0&&(k=k%P3+P3),k>sQ?this._append`A${r},${r},0,1,${M},${e-o},${n-p}A${r},${r},0,1,${M},${this._x1=v},${this._y1=S}`:k>$h&&this._append`A${r},${r},0,${+(k>=M3)},${M},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};const Qu=11102230246251565e-32,ro=134217729,lQ=(3+8*Qu)*Qu;function aw(t,e,n,r,i){let s,l,o,p,v=e[0],S=r[0],M=0,k=0;S>v==S>-v?(s=v,v=e[++M]):(s=S,S=r[++k]);let F=0;if(M<t&&k<n)for(S>v==S>-v?(l=v+s,o=s-(l-v),v=e[++M]):(l=S+s,o=s-(l-S),S=r[++k]),s=l,o!==0&&(i[F++]=o);M<t&&k<n;)S>v==S>-v?(l=s+v,p=l-s,o=s-(l-p)+(v-p),v=e[++M]):(l=s+S,p=l-s,o=s-(l-p)+(S-p),S=r[++k]),s=l,o!==0&&(i[F++]=o);for(;M<t;)l=s+v,p=l-s,o=s-(l-p)+(v-p),v=e[++M],s=l,o!==0&&(i[F++]=o);for(;k<n;)l=s+S,p=l-s,o=s-(l-p)+(S-p),S=r[++k],s=l,o!==0&&(i[F++]=o);return(s!==0||F===0)&&(i[F++]=s),F}function AQ(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function Tm(t){return new Float64Array(t)}const uQ=(3+16*Qu)*Qu,cQ=(2+12*Qu)*Qu,hQ=(9+64*Qu)*Qu*Qu,e0=Tm(4),GM=Tm(8),$M=Tm(12),jM=Tm(16),Io=Tm(4);function fQ(t,e,n,r,i,s,l){let o,p,v,S,M,k,F,H,j,ie,Y,J,se,ce,me,Ee,He,Qe;const Ye=t-i,nt=n-i,Fe=e-s,tt=r-s;ce=Ye*tt,k=ro*Ye,F=k-(k-Ye),H=Ye-F,k=ro*tt,j=k-(k-tt),ie=tt-j,me=H*ie-(ce-F*j-H*j-F*ie),Ee=Fe*nt,k=ro*Fe,F=k-(k-Fe),H=Fe-F,k=ro*nt,j=k-(k-nt),ie=nt-j,He=H*ie-(Ee-F*j-H*j-F*ie),Y=me-He,M=me-Y,e0[0]=me-(Y+M)+(M-He),J=ce+Y,M=J-ce,se=ce-(J-M)+(Y-M),Y=se-Ee,M=se-Y,e0[1]=se-(Y+M)+(M-Ee),Qe=J+Y,M=Qe-J,e0[2]=J-(Qe-M)+(Y-M),e0[3]=Qe;let Ze=AQ(4,e0),pt=cQ*l;if(Ze>=pt||-Ze>=pt||(M=t-Ye,o=t-(Ye+M)+(M-i),M=n-nt,v=n-(nt+M)+(M-i),M=e-Fe,p=e-(Fe+M)+(M-s),M=r-tt,S=r-(tt+M)+(M-s),o===0&&p===0&&v===0&&S===0)||(pt=hQ*l+lQ*Math.abs(Ze),Ze+=Ye*S+tt*o-(Fe*v+nt*p),Ze>=pt||-Ze>=pt))return Ze;ce=o*tt,k=ro*o,F=k-(k-o),H=o-F,k=ro*tt,j=k-(k-tt),ie=tt-j,me=H*ie-(ce-F*j-H*j-F*ie),Ee=p*nt,k=ro*p,F=k-(k-p),H=p-F,k=ro*nt,j=k-(k-nt),ie=nt-j,He=H*ie-(Ee-F*j-H*j-F*ie),Y=me-He,M=me-Y,Io[0]=me-(Y+M)+(M-He),J=ce+Y,M=J-ce,se=ce-(J-M)+(Y-M),Y=se-Ee,M=se-Y,Io[1]=se-(Y+M)+(M-Ee),Qe=J+Y,M=Qe-J,Io[2]=J-(Qe-M)+(Y-M),Io[3]=Qe;const Yt=aw(4,e0,4,Io,GM);ce=Ye*S,k=ro*Ye,F=k-(k-Ye),H=Ye-F,k=ro*S,j=k-(k-S),ie=S-j,me=H*ie-(ce-F*j-H*j-F*ie),Ee=Fe*v,k=ro*Fe,F=k-(k-Fe),H=Fe-F,k=ro*v,j=k-(k-v),ie=v-j,He=H*ie-(Ee-F*j-H*j-F*ie),Y=me-He,M=me-Y,Io[0]=me-(Y+M)+(M-He),J=ce+Y,M=J-ce,se=ce-(J-M)+(Y-M),Y=se-Ee,M=se-Y,Io[1]=se-(Y+M)+(M-Ee),Qe=J+Y,M=Qe-J,Io[2]=J-(Qe-M)+(Y-M),Io[3]=Qe;const Et=aw(Yt,GM,4,Io,$M);ce=o*S,k=ro*o,F=k-(k-o),H=o-F,k=ro*S,j=k-(k-S),ie=S-j,me=H*ie-(ce-F*j-H*j-F*ie),Ee=p*v,k=ro*p,F=k-(k-p),H=p-F,k=ro*v,j=k-(k-v),ie=v-j,He=H*ie-(Ee-F*j-H*j-F*ie),Y=me-He,M=me-Y,Io[0]=me-(Y+M)+(M-He),J=ce+Y,M=J-ce,se=ce-(J-M)+(Y-M),Y=se-Ee,M=se-Y,Io[1]=se-(Y+M)+(M-Ee),Qe=J+Y,M=Qe-J,Io[2]=J-(Qe-M)+(Y-M),Io[3]=Qe;const un=aw(Et,$M,4,Io,jM);return jM[un-1]}function dQ(t,e,n,r,i,s){const l=(e-s)*(n-i),o=(t-i)*(r-s),p=l-o,v=Math.abs(l+o);return Math.abs(p)>=uQ*v?p:-fQ(t,e,n,r,i,s,v)}function pQ(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function O_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function gd(t){return t=O_(Math.abs(t)),t?t[1]:NaN}function gQ(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],p=0;i>0&&o>0&&(p+o+1>r&&(o=Math.max(1,r-p)),s.push(n.substring(i-=o,i+o)),!((p+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function mQ(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var yQ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function F_(t){if(!(e=yQ.exec(t)))throw new Error("invalid format: "+t);var e;return new JT({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}F_.prototype=JT.prototype;function JT(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}JT.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _Q(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var lB;function vQ(t,e){var n=O_(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(lB=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+O_(t,Math.max(0,e+s-1))[0]}function HM(t,e){var n=O_(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const WM={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:pQ,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>HM(t*100,e),r:HM,s:vQ,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function QM(t){return t}var qM=Array.prototype.map,ZM=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function xQ(t){var e=t.grouping===void 0||t.thousands===void 0?QM:gQ(qM.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?QM:mQ(qM.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function v(M){M=F_(M);var k=M.fill,F=M.align,H=M.sign,j=M.symbol,ie=M.zero,Y=M.width,J=M.comma,se=M.precision,ce=M.trim,me=M.type;me==="n"?(J=!0,me="g"):WM[me]||(se===void 0&&(se=12),ce=!0,me="g"),(ie||k==="0"&&F==="=")&&(ie=!0,k="0",F="=");var Ee=j==="$"?n:j==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",He=j==="$"?r:/[%p]/.test(me)?l:"",Qe=WM[me],Ye=/[defgprs%]/.test(me);se=se===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function nt(Fe){var tt=Ee,Ze=He,pt,Yt,Et;if(me==="c")Ze=Qe(Fe)+Ze,Fe="";else{Fe=+Fe;var un=Fe<0||1/Fe<0;if(Fe=isNaN(Fe)?p:Qe(Math.abs(Fe),se),ce&&(Fe=_Q(Fe)),un&&+Fe==0&&H!=="+"&&(un=!1),tt=(un?H==="("?H:o:H==="-"||H==="("?"":H)+tt,Ze=(me==="s"?ZM[8+lB/3]:"")+Ze+(un&&H==="("?")":""),Ye){for(pt=-1,Yt=Fe.length;++pt<Yt;)if(Et=Fe.charCodeAt(pt),48>Et||Et>57){Ze=(Et===46?i+Fe.slice(pt+1):Fe.slice(pt))+Ze,Fe=Fe.slice(0,pt);break}}}J&&!ie&&(Fe=e(Fe,1/0));var _t=tt.length+Fe.length+Ze.length,Tt=_t<Y?new Array(Y-_t+1).join(k):"";switch(J&&ie&&(Fe=e(Tt+Fe,Tt.length?Y-Ze.length:1/0),Tt=""),F){case"<":Fe=tt+Fe+Ze+Tt;break;case"=":Fe=tt+Tt+Fe+Ze;break;case"^":Fe=Tt.slice(0,_t=Tt.length>>1)+tt+Fe+Ze+Tt.slice(_t);break;default:Fe=Tt+tt+Fe+Ze;break}return s(Fe)}return nt.toString=function(){return M+""},nt}function S(M,k){var F=v((M=F_(M),M.type="f",M)),H=Math.max(-8,Math.min(8,Math.floor(gd(k)/3)))*3,j=Math.pow(10,-H),ie=ZM[8+H/3];return function(Y){return F(j*Y)+ie}}return{format:v,formatPrefix:S}}var D1,_r,AB;wQ({thousands:",",grouping:[3],currency:["$",""]});function wQ(t){return D1=xQ(t),_r=D1.format,AB=D1.formatPrefix,D1}function bQ(t){return Math.max(0,-gd(Math.abs(t)))}function EQ(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(gd(e)/3)))*3-gd(Math.abs(t)))}function TQ(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,gd(e)-gd(t))+1}function Sm(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const YM=Symbol("implicit");function uB(){var t=new xM,e=[],n=[],r=YM;function i(s){let l=t.get(s);if(l===void 0){if(r!==YM)return r;t.set(s,l=e.push(s)-1)}return n[l%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new xM;for(const l of s)t.has(l)||t.set(l,e.push(l)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return uB(e,n).unknown(r)},Sm.apply(i,arguments),i}function cB(){var t=uB().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,s,l,o=!1,p=0,v=0,S=.5;delete t.unknown;function M(){var k=e().length,F=i<r,H=F?i:r,j=F?r:i;s=(j-H)/Math.max(1,k-p+v*2),o&&(s=Math.floor(s)),H+=(j-H-s*(k-p))*S,l=s*(1-p),o&&(H=Math.round(H),l=Math.round(l));var ie=ph(k).map(function(Y){return H+s*Y});return n(F?ie.reverse():ie)}return t.domain=function(k){return arguments.length?(e(k),M()):e()},t.range=function(k){return arguments.length?([r,i]=k,r=+r,i=+i,M()):[r,i]},t.rangeRound=function(k){return[r,i]=k,r=+r,i=+i,o=!0,M()},t.bandwidth=function(){return l},t.step=function(){return s},t.round=function(k){return arguments.length?(o=!!k,M()):o},t.padding=function(k){return arguments.length?(p=Math.min(1,v=+k),M()):p},t.paddingInner=function(k){return arguments.length?(p=Math.min(1,k),M()):p},t.paddingOuter=function(k){return arguments.length?(v=+k,M()):v},t.align=function(k){return arguments.length?(S=Math.max(0,Math.min(1,k)),M()):S},t.copy=function(){return cB(e(),[r,i]).round(o).paddingInner(p).paddingOuter(v).align(S)},Sm.apply(M(),arguments)}function hB(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return hB(e())},t}function Fa(){return hB(cB.apply(null,arguments).paddingInner(1))}function SQ(t){return function(){return t}}function CQ(t){return+t}var XM=[0,1];function C0(t){return t}function k3(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:SQ(isNaN(e)?NaN:.5)}function MQ(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function PQ(t,e,n){var r=t[0],i=t[1],s=e[0],l=e[1];return i<r?(r=k3(i,r),s=n(l,s)):(r=k3(r,i),s=n(s,l)),function(o){return s(r(o))}}function kQ(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=k3(t[l],t[l+1]),s[l]=n(e[l],e[l+1]);return function(o){var p=ER(t,o,1,r)-1;return s[p](i[p](o))}}function fB(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function IQ(){var t=XM,e=XM,n=ZT,r,i,s,l=C0,o,p,v;function S(){var k=Math.min(t.length,e.length);return l!==C0&&(l=MQ(t[0],t[k-1])),o=k>2?kQ:PQ,p=v=null,M}function M(k){return k==null||isNaN(k=+k)?s:(p||(p=o(t.map(r),e,n)))(r(l(k)))}return M.invert=function(k){return l(i((v||(v=o(e,t.map(r),tA)))(k)))},M.domain=function(k){return arguments.length?(t=Array.from(k,CQ),S()):t.slice()},M.range=function(k){return arguments.length?(e=Array.from(k),S()):e.slice()},M.rangeRound=function(k){return e=Array.from(k),n=GH,S()},M.clamp=function(k){return arguments.length?(l=k?!0:C0,S()):l!==C0},M.interpolate=function(k){return arguments.length?(n=k,S()):n},M.unknown=function(k){return arguments.length?(s=k,M):s},function(k,F){return r=k,i=F,S()}}function dB(){return IQ()(C0,C0)}function LQ(t,e,n,r){var i=x3(t,e,n),s;switch(r=F_(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=EQ(i,l))&&(r.precision=s),AB(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=TQ(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=bQ(i))&&(r.precision=s-(r.type==="%")*2);break}}return _r(r)}function pB(t){var e=t.domain;return t.ticks=function(n){var r=e();return T$(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return LQ(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,l=r[i],o=r[s],p,v,S=10;for(o<l&&(v=l,l=o,o=v,v=i,i=s,s=v);S-- >0;){if(v=v3(l,o,n),v===p)return r[i]=l,r[s]=o,e(r);if(v>0)l=Math.floor(l/v)*v,o=Math.ceil(o/v)*v;else if(v<0)l=Math.ceil(l*v)/v,o=Math.floor(o*v)/v;else break;p=v}return t},t}function ur(){var t=dB();return t.copy=function(){return fB(t,ur())},Sm.apply(t,arguments),pB(t)}function DQ(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],s=t[r],l;return s<i&&(l=n,n=r,r=l,l=i,i=s,s=l),t[n]=e.floor(i),t[r]=e.ceil(s),t}function ss(){var t=0,e=1,n=1,r=[.5],i=[0,1],s;function l(p){return p!=null&&p<=p?i[ER(r,p,0,n)]:s}function o(){var p=-1;for(r=new Array(n);++p<n;)r[p]=((p+1)*e-(p-n)*t)/(n+1);return l}return l.domain=function(p){return arguments.length?([t,e]=p,t=+t,e=+e,o()):[t,e]},l.range=function(p){return arguments.length?(n=(i=Array.from(p)).length-1,o()):i.slice()},l.invertExtent=function(p){var v=i.indexOf(p);return v<0?[NaN,NaN]:v<1?[t,r[0]]:v>=n?[r[n-1],e]:[r[v-1],r[v]]},l.unknown=function(p){return arguments.length&&(s=p),l},l.thresholds=function(){return r.slice()},l.copy=function(){return ss().domain([t,e]).range(i).unknown(s)},Sm.apply(pB(l),arguments)}const lw=new Date,Aw=new Date;function as(t,e,n,r){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const l=i(s),o=i.ceil(s);return s-l<o-s?l:o},i.offset=(s,l)=>(e(s=new Date(+s),l==null?1:Math.floor(l)),s),i.range=(s,l,o)=>{const p=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<l)||!(o>0))return p;let v;do p.push(v=new Date(+s)),e(s,o),t(s);while(v<s&&s<l);return p},i.filter=s=>as(l=>{if(l>=l)for(;t(l),!s(l);)l.setTime(l-1)},(l,o)=>{if(l>=l)if(o<0)for(;++o<=0;)for(;e(l,-1),!s(l););else for(;--o>=0;)for(;e(l,1),!s(l););}),n&&(i.count=(s,l)=>(lw.setTime(+s),Aw.setTime(+l),t(lw),t(Aw),Math.floor(n(lw,Aw))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?l=>r(l)%s===0:l=>i.count(0,l)%s===0):i)),i}const N_=as(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);N_.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?as(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):N_);N_.range;const Gu=1e3,yl=Gu*60,$u=yl*60,nc=$u*24,eS=nc*7,KM=nc*30,uw=nc*365,M0=as(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Gu)},(t,e)=>(e-t)/Gu,t=>t.getUTCSeconds());M0.range;const tS=as(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Gu)},(t,e)=>{t.setTime(+t+e*yl)},(t,e)=>(e-t)/yl,t=>t.getMinutes());tS.range;const RQ=as(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*yl)},(t,e)=>(e-t)/yl,t=>t.getUTCMinutes());RQ.range;const nS=as(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Gu-t.getMinutes()*yl)},(t,e)=>{t.setTime(+t+e*$u)},(t,e)=>(e-t)/$u,t=>t.getHours());nS.range;const BQ=as(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*$u)},(t,e)=>(e-t)/$u,t=>t.getUTCHours());BQ.range;const Cm=as(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*yl)/nc,t=>t.getDate()-1);Cm.range;const rS=as(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/nc,t=>t.getUTCDate()-1);rS.range;const zQ=as(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/nc,t=>Math.floor(t/nc));zQ.range;function If(t){return as(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*yl)/eS)}const iv=If(0),U_=If(1),OQ=If(2),FQ=If(3),md=If(4),NQ=If(5),UQ=If(6);iv.range;U_.range;OQ.range;FQ.range;md.range;NQ.range;UQ.range;function Lf(t){return as(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/eS)}const gB=Lf(0),V_=Lf(1),VQ=Lf(2),GQ=Lf(3),yd=Lf(4),$Q=Lf(5),jQ=Lf(6);gB.range;V_.range;VQ.range;GQ.range;yd.range;$Q.range;jQ.range;const iS=as(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());iS.range;const HQ=as(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());HQ.range;const rc=as(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());rc.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:as(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});rc.range;const hf=as(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());hf.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:as(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});hf.range;function WQ(t,e,n,r,i,s){const l=[[M0,1,Gu],[M0,5,5*Gu],[M0,15,15*Gu],[M0,30,30*Gu],[s,1,yl],[s,5,5*yl],[s,15,15*yl],[s,30,30*yl],[i,1,$u],[i,3,3*$u],[i,6,6*$u],[i,12,12*$u],[r,1,nc],[r,2,2*nc],[n,1,eS],[e,1,KM],[e,3,3*KM],[t,1,uw]];function o(v,S,M){const k=S<v;k&&([v,S]=[S,v]);const F=M&&typeof M.range=="function"?M:p(v,S,M),H=F?F.range(v,+S+1):[];return k?H.reverse():H}function p(v,S,M){const k=Math.abs(S-v)/M,F=jT(([,,ie])=>ie).right(l,k);if(F===l.length)return t.every(x3(v/uw,S/uw,M));if(F===0)return N_.every(Math.max(x3(v,S,M),1));const[H,j]=l[k/l[F-1][2]<l[F][2]/k?F-1:F];return H.every(j)}return[o,p]}const[QQ,qQ]=WQ(rc,iS,iv,Cm,nS,tS);function cw(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function hw(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function _p(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function ZQ(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,l=t.shortDays,o=t.months,p=t.shortMonths,v=vp(i),S=xp(i),M=vp(s),k=xp(s),F=vp(l),H=xp(l),j=vp(o),ie=xp(o),Y=vp(p),J=xp(p),se={a:un,A:_t,b:Tt,B:Jt,c:null,d:iP,e:iP,f:yq,g:Mq,G:kq,H:pq,I:gq,j:mq,L:mB,m:_q,M:vq,p:In,q:Tn,Q:aP,s:lP,S:xq,u:wq,U:bq,V:Eq,w:Tq,W:Sq,x:null,X:null,y:Cq,Y:Pq,Z:Iq,"%":oP},ce={a:kr,A:er,b:or,B:hr,c:null,d:sP,e:sP,f:Bq,g:Hq,G:Qq,H:Lq,I:Dq,j:Rq,L:_B,m:zq,M:Oq,p:Un,q:Cr,Q:aP,s:lP,S:Fq,u:Nq,U:Uq,V:Vq,w:Gq,W:$q,x:null,X:null,y:jq,Y:Wq,Z:qq,"%":oP},me={a:nt,A:Fe,b:tt,B:Ze,c:pt,d:nP,e:nP,f:cq,g:tP,G:eP,H:rP,I:rP,j:aq,L:uq,m:oq,M:lq,p:Ye,q:sq,Q:fq,s:dq,S:Aq,u:eq,U:tq,V:nq,w:JQ,W:rq,x:Yt,X:Et,y:tP,Y:eP,Z:iq,"%":hq};se.x=Ee(n,se),se.X=Ee(r,se),se.c=Ee(e,se),ce.x=Ee(n,ce),ce.X=Ee(r,ce),ce.c=Ee(e,ce);function Ee(wt,rn){return function(Mn){var xt=[],tr=-1,Hn=0,xr=wt.length,lr,nr,ri;for(Mn instanceof Date||(Mn=new Date(+Mn));++tr<xr;)wt.charCodeAt(tr)===37&&(xt.push(wt.slice(Hn,tr)),(nr=JM[lr=wt.charAt(++tr)])!=null?lr=wt.charAt(++tr):nr=lr==="e"?" ":"0",(ri=rn[lr])&&(lr=ri(Mn,nr)),xt.push(lr),Hn=tr+1);return xt.push(wt.slice(Hn,tr)),xt.join("")}}function He(wt,rn){return function(Mn){var xt=_p(1900,void 0,1),tr=Qe(xt,wt,Mn+="",0),Hn,xr;if(tr!=Mn.length)return null;if("Q"in xt)return new Date(xt.Q);if("s"in xt)return new Date(xt.s*1e3+("L"in xt?xt.L:0));if(rn&&!("Z"in xt)&&(xt.Z=0),"p"in xt&&(xt.H=xt.H%12+xt.p*12),xt.m===void 0&&(xt.m="q"in xt?xt.q:0),"V"in xt){if(xt.V<1||xt.V>53)return null;"w"in xt||(xt.w=1),"Z"in xt?(Hn=hw(_p(xt.y,0,1)),xr=Hn.getUTCDay(),Hn=xr>4||xr===0?V_.ceil(Hn):V_(Hn),Hn=rS.offset(Hn,(xt.V-1)*7),xt.y=Hn.getUTCFullYear(),xt.m=Hn.getUTCMonth(),xt.d=Hn.getUTCDate()+(xt.w+6)%7):(Hn=cw(_p(xt.y,0,1)),xr=Hn.getDay(),Hn=xr>4||xr===0?U_.ceil(Hn):U_(Hn),Hn=Cm.offset(Hn,(xt.V-1)*7),xt.y=Hn.getFullYear(),xt.m=Hn.getMonth(),xt.d=Hn.getDate()+(xt.w+6)%7)}else("W"in xt||"U"in xt)&&("w"in xt||(xt.w="u"in xt?xt.u%7:"W"in xt?1:0),xr="Z"in xt?hw(_p(xt.y,0,1)).getUTCDay():cw(_p(xt.y,0,1)).getDay(),xt.m=0,xt.d="W"in xt?(xt.w+6)%7+xt.W*7-(xr+5)%7:xt.w+xt.U*7-(xr+6)%7);return"Z"in xt?(xt.H+=xt.Z/100|0,xt.M+=xt.Z%100,hw(xt)):cw(xt)}}function Qe(wt,rn,Mn,xt){for(var tr=0,Hn=rn.length,xr=Mn.length,lr,nr;tr<Hn;){if(xt>=xr)return-1;if(lr=rn.charCodeAt(tr++),lr===37){if(lr=rn.charAt(tr++),nr=me[lr in JM?rn.charAt(tr++):lr],!nr||(xt=nr(wt,Mn,xt))<0)return-1}else if(lr!=Mn.charCodeAt(xt++))return-1}return xt}function Ye(wt,rn,Mn){var xt=v.exec(rn.slice(Mn));return xt?(wt.p=S.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function nt(wt,rn,Mn){var xt=F.exec(rn.slice(Mn));return xt?(wt.w=H.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function Fe(wt,rn,Mn){var xt=M.exec(rn.slice(Mn));return xt?(wt.w=k.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function tt(wt,rn,Mn){var xt=Y.exec(rn.slice(Mn));return xt?(wt.m=J.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function Ze(wt,rn,Mn){var xt=j.exec(rn.slice(Mn));return xt?(wt.m=ie.get(xt[0].toLowerCase()),Mn+xt[0].length):-1}function pt(wt,rn,Mn){return Qe(wt,e,rn,Mn)}function Yt(wt,rn,Mn){return Qe(wt,n,rn,Mn)}function Et(wt,rn,Mn){return Qe(wt,r,rn,Mn)}function un(wt){return l[wt.getDay()]}function _t(wt){return s[wt.getDay()]}function Tt(wt){return p[wt.getMonth()]}function Jt(wt){return o[wt.getMonth()]}function In(wt){return i[+(wt.getHours()>=12)]}function Tn(wt){return 1+~~(wt.getMonth()/3)}function kr(wt){return l[wt.getUTCDay()]}function er(wt){return s[wt.getUTCDay()]}function or(wt){return p[wt.getUTCMonth()]}function hr(wt){return o[wt.getUTCMonth()]}function Un(wt){return i[+(wt.getUTCHours()>=12)]}function Cr(wt){return 1+~~(wt.getUTCMonth()/3)}return{format:function(wt){var rn=Ee(wt+="",se);return rn.toString=function(){return wt},rn},parse:function(wt){var rn=He(wt+="",!1);return rn.toString=function(){return wt},rn},utcFormat:function(wt){var rn=Ee(wt+="",ce);return rn.toString=function(){return wt},rn},utcParse:function(wt){var rn=He(wt+="",!0);return rn.toString=function(){return wt},rn}}}var JM={"-":"",_:" ",0:"0"},Es=/^\s*\d+/,YQ=/^%/,XQ=/[\\^$*+?|[\]().{}]/g;function Pr(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function KQ(t){return t.replace(XQ,"\\$&")}function vp(t){return new RegExp("^(?:"+t.map(KQ).join("|")+")","i")}function xp(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function JQ(t,e,n){var r=Es.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function eq(t,e,n){var r=Es.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function tq(t,e,n){var r=Es.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function nq(t,e,n){var r=Es.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function rq(t,e,n){var r=Es.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function eP(t,e,n){var r=Es.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function tP(t,e,n){var r=Es.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function iq(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function sq(t,e,n){var r=Es.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function oq(t,e,n){var r=Es.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function nP(t,e,n){var r=Es.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function aq(t,e,n){var r=Es.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function rP(t,e,n){var r=Es.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function lq(t,e,n){var r=Es.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Aq(t,e,n){var r=Es.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function uq(t,e,n){var r=Es.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function cq(t,e,n){var r=Es.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function hq(t,e,n){var r=YQ.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function fq(t,e,n){var r=Es.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function dq(t,e,n){var r=Es.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function iP(t,e){return Pr(t.getDate(),e,2)}function pq(t,e){return Pr(t.getHours(),e,2)}function gq(t,e){return Pr(t.getHours()%12||12,e,2)}function mq(t,e){return Pr(1+Cm.count(rc(t),t),e,3)}function mB(t,e){return Pr(t.getMilliseconds(),e,3)}function yq(t,e){return mB(t,e)+"000"}function _q(t,e){return Pr(t.getMonth()+1,e,2)}function vq(t,e){return Pr(t.getMinutes(),e,2)}function xq(t,e){return Pr(t.getSeconds(),e,2)}function wq(t){var e=t.getDay();return e===0?7:e}function bq(t,e){return Pr(iv.count(rc(t)-1,t),e,2)}function yB(t){var e=t.getDay();return e>=4||e===0?md(t):md.ceil(t)}function Eq(t,e){return t=yB(t),Pr(md.count(rc(t),t)+(rc(t).getDay()===4),e,2)}function Tq(t){return t.getDay()}function Sq(t,e){return Pr(U_.count(rc(t)-1,t),e,2)}function Cq(t,e){return Pr(t.getFullYear()%100,e,2)}function Mq(t,e){return t=yB(t),Pr(t.getFullYear()%100,e,2)}function Pq(t,e){return Pr(t.getFullYear()%1e4,e,4)}function kq(t,e){var n=t.getDay();return t=n>=4||n===0?md(t):md.ceil(t),Pr(t.getFullYear()%1e4,e,4)}function Iq(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Pr(e/60|0,"0",2)+Pr(e%60,"0",2)}function sP(t,e){return Pr(t.getUTCDate(),e,2)}function Lq(t,e){return Pr(t.getUTCHours(),e,2)}function Dq(t,e){return Pr(t.getUTCHours()%12||12,e,2)}function Rq(t,e){return Pr(1+rS.count(hf(t),t),e,3)}function _B(t,e){return Pr(t.getUTCMilliseconds(),e,3)}function Bq(t,e){return _B(t,e)+"000"}function zq(t,e){return Pr(t.getUTCMonth()+1,e,2)}function Oq(t,e){return Pr(t.getUTCMinutes(),e,2)}function Fq(t,e){return Pr(t.getUTCSeconds(),e,2)}function Nq(t){var e=t.getUTCDay();return e===0?7:e}function Uq(t,e){return Pr(gB.count(hf(t)-1,t),e,2)}function vB(t){var e=t.getUTCDay();return e>=4||e===0?yd(t):yd.ceil(t)}function Vq(t,e){return t=vB(t),Pr(yd.count(hf(t),t)+(hf(t).getUTCDay()===4),e,2)}function Gq(t){return t.getUTCDay()}function $q(t,e){return Pr(V_.count(hf(t)-1,t),e,2)}function jq(t,e){return Pr(t.getUTCFullYear()%100,e,2)}function Hq(t,e){return t=vB(t),Pr(t.getUTCFullYear()%100,e,2)}function Wq(t,e){return Pr(t.getUTCFullYear()%1e4,e,4)}function Qq(t,e){var n=t.getUTCDay();return t=n>=4||n===0?yd(t):yd.ceil(t),Pr(t.getUTCFullYear()%1e4,e,4)}function qq(){return"+0000"}function oP(){return"%"}function aP(t){return+t}function lP(t){return Math.floor(+t/1e3)}var t0,xB;Zq({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Zq(t){return t0=ZQ(t),xB=t0.format,t0.parse,t0.utcFormat,t0.utcParse,t0}function Yq(t){return new Date(t)}function Xq(t){return t instanceof Date?+t:+new Date(+t)}function wB(t,e,n,r,i,s,l,o,p,v){var S=dB(),M=S.invert,k=S.domain,F=v(".%L"),H=v(":%S"),j=v("%I:%M"),ie=v("%I %p"),Y=v("%a %d"),J=v("%b %d"),se=v("%B"),ce=v("%Y");function me(Ee){return(p(Ee)<Ee?F:o(Ee)<Ee?H:l(Ee)<Ee?j:s(Ee)<Ee?ie:r(Ee)<Ee?i(Ee)<Ee?Y:J:n(Ee)<Ee?se:ce)(Ee)}return S.invert=function(Ee){return new Date(M(Ee))},S.domain=function(Ee){return arguments.length?k(Array.from(Ee,Xq)):k().map(Yq)},S.ticks=function(Ee){var He=k();return t(He[0],He[He.length-1],Ee??10)},S.tickFormat=function(Ee,He){return He==null?me:v(He)},S.nice=function(Ee){var He=k();return(!Ee||typeof Ee.range!="function")&&(Ee=e(He[0],He[He.length-1],Ee??10)),Ee?k(DQ(He,Ee)):S},S.copy=function(){return fB(S,wB(t,e,n,r,i,s,l,o,p,v))},S}function Kq(){return Sm.apply(wB(QQ,qQ,rc,iS,iv,Cm,nS,tS,M0,xB).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Df(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const Rf=t=>YR(t[t.length-1]);var Jq=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Df);const eZ=Rf(Jq);var tZ=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Df);const nZ=Rf(tZ);var rZ=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Df);const iZ=Rf(rZ);var sZ=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Df);const bB=Rf(sZ);var oZ=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Df);const aZ=Rf(oZ);var lZ=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Df);const AP=Rf(lZ);var AZ=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Df);const fw=Rf(AZ);function ra(t){return function(){return t}}const uP=Math.abs,io=Math.atan2,Bh=Math.cos,uZ=Math.max,dw=Math.min,RA=Math.sin,P0=Math.sqrt,lo=1e-12,Wg=Math.PI,G_=Wg/2,cZ=2*Wg;function hZ(t){return t>1?0:t<-1?Wg:Math.acos(t)}function cP(t){return t>=1?G_:t<=-1?-G_:Math.asin(t)}function EB(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new aQ(e)}function fZ(t){return t.innerRadius}function dZ(t){return t.outerRadius}function pZ(t){return t.startAngle}function gZ(t){return t.endAngle}function mZ(t){return t&&t.padAngle}function yZ(t,e,n,r,i,s,l,o){var p=n-t,v=r-e,S=l-i,M=o-s,k=M*p-S*v;if(!(k*k<lo))return k=(S*(e-s)-M*(t-i))/k,[t+k*p,e+k*v]}function R1(t,e,n,r,i,s,l){var o=t-n,p=e-r,v=(l?s:-s)/P0(o*o+p*p),S=v*p,M=-v*o,k=t+S,F=e+M,H=n+S,j=r+M,ie=(k+H)/2,Y=(F+j)/2,J=H-k,se=j-F,ce=J*J+se*se,me=i-s,Ee=k*j-H*F,He=(se<0?-1:1)*P0(uZ(0,me*me*ce-Ee*Ee)),Qe=(Ee*se-J*He)/ce,Ye=(-Ee*J-se*He)/ce,nt=(Ee*se+J*He)/ce,Fe=(-Ee*J+se*He)/ce,tt=Qe-ie,Ze=Ye-Y,pt=nt-ie,Yt=Fe-Y;return tt*tt+Ze*Ze>pt*pt+Yt*Yt&&(Qe=nt,Ye=Fe),{cx:Qe,cy:Ye,x01:-S,y01:-M,x11:Qe*(i/me-1),y11:Ye*(i/me-1)}}function $_(){var t=fZ,e=dZ,n=ra(0),r=null,i=pZ,s=gZ,l=mZ,o=null,p=EB(v);function v(){var S,M,k=+t.apply(this,arguments),F=+e.apply(this,arguments),H=i.apply(this,arguments)-G_,j=s.apply(this,arguments)-G_,ie=uP(j-H),Y=j>H;if(o||(o=S=p()),F<k&&(M=F,F=k,k=M),!(F>lo))o.moveTo(0,0);else if(ie>cZ-lo)o.moveTo(F*Bh(H),F*RA(H)),o.arc(0,0,F,H,j,!Y),k>lo&&(o.moveTo(k*Bh(j),k*RA(j)),o.arc(0,0,k,j,H,Y));else{var J=H,se=j,ce=H,me=j,Ee=ie,He=ie,Qe=l.apply(this,arguments)/2,Ye=Qe>lo&&(r?+r.apply(this,arguments):P0(k*k+F*F)),nt=dw(uP(F-k)/2,+n.apply(this,arguments)),Fe=nt,tt=nt,Ze,pt;if(Ye>lo){var Yt=cP(Ye/k*RA(Qe)),Et=cP(Ye/F*RA(Qe));(Ee-=Yt*2)>lo?(Yt*=Y?1:-1,ce+=Yt,me-=Yt):(Ee=0,ce=me=(H+j)/2),(He-=Et*2)>lo?(Et*=Y?1:-1,J+=Et,se-=Et):(He=0,J=se=(H+j)/2)}var un=F*Bh(J),_t=F*RA(J),Tt=k*Bh(me),Jt=k*RA(me);if(nt>lo){var In=F*Bh(se),Tn=F*RA(se),kr=k*Bh(ce),er=k*RA(ce),or;if(ie<Wg)if(or=yZ(un,_t,kr,er,In,Tn,Tt,Jt)){var hr=un-or[0],Un=_t-or[1],Cr=In-or[0],wt=Tn-or[1],rn=1/RA(hZ((hr*Cr+Un*wt)/(P0(hr*hr+Un*Un)*P0(Cr*Cr+wt*wt)))/2),Mn=P0(or[0]*or[0]+or[1]*or[1]);Fe=dw(nt,(k-Mn)/(rn-1)),tt=dw(nt,(F-Mn)/(rn+1))}else Fe=tt=0}He>lo?tt>lo?(Ze=R1(kr,er,un,_t,F,tt,Y),pt=R1(In,Tn,Tt,Jt,F,tt,Y),o.moveTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),tt<nt?o.arc(Ze.cx,Ze.cy,tt,io(Ze.y01,Ze.x01),io(pt.y01,pt.x01),!Y):(o.arc(Ze.cx,Ze.cy,tt,io(Ze.y01,Ze.x01),io(Ze.y11,Ze.x11),!Y),o.arc(0,0,F,io(Ze.cy+Ze.y11,Ze.cx+Ze.x11),io(pt.cy+pt.y11,pt.cx+pt.x11),!Y),o.arc(pt.cx,pt.cy,tt,io(pt.y11,pt.x11),io(pt.y01,pt.x01),!Y))):(o.moveTo(un,_t),o.arc(0,0,F,J,se,!Y)):o.moveTo(un,_t),!(k>lo)||!(Ee>lo)?o.lineTo(Tt,Jt):Fe>lo?(Ze=R1(Tt,Jt,In,Tn,k,-Fe,Y),pt=R1(un,_t,kr,er,k,-Fe,Y),o.lineTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),Fe<nt?o.arc(Ze.cx,Ze.cy,Fe,io(Ze.y01,Ze.x01),io(pt.y01,pt.x01),!Y):(o.arc(Ze.cx,Ze.cy,Fe,io(Ze.y01,Ze.x01),io(Ze.y11,Ze.x11),!Y),o.arc(0,0,k,io(Ze.cy+Ze.y11,Ze.cx+Ze.x11),io(pt.cy+pt.y11,pt.cx+pt.x11),Y),o.arc(pt.cx,pt.cy,Fe,io(pt.y11,pt.x11),io(pt.y01,pt.x01),!Y))):o.arc(0,0,k,me,ce,Y)}if(o.closePath(),S)return o=null,S+""||null}return v.centroid=function(){var S=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,M=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-Wg/2;return[Bh(M)*S,RA(M)*S]},v.innerRadius=function(S){return arguments.length?(t=typeof S=="function"?S:ra(+S),v):t},v.outerRadius=function(S){return arguments.length?(e=typeof S=="function"?S:ra(+S),v):e},v.cornerRadius=function(S){return arguments.length?(n=typeof S=="function"?S:ra(+S),v):n},v.padRadius=function(S){return arguments.length?(r=S==null?null:typeof S=="function"?S:ra(+S),v):r},v.startAngle=function(S){return arguments.length?(i=typeof S=="function"?S:ra(+S),v):i},v.endAngle=function(S){return arguments.length?(s=typeof S=="function"?S:ra(+S),v):s},v.padAngle=function(S){return arguments.length?(l=typeof S=="function"?S:ra(+S),v):l},v.context=function(S){return arguments.length?(o=S??null,v):o},v}function _Z(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function TB(t){this._context=t}TB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function SB(t){return new TB(t)}function vZ(t){return t[0]}function xZ(t){return t[1]}function j_(t,e){var n=ra(!0),r=null,i=SB,s=null,l=EB(o);t=typeof t=="function"?t:t===void 0?vZ:ra(t),e=typeof e=="function"?e:e===void 0?xZ:ra(e);function o(p){var v,S=(p=_Z(p)).length,M,k=!1,F;for(r==null&&(s=i(F=l())),v=0;v<=S;++v)!(v<S&&n(M=p[v],v,p))===k&&((k=!k)?s.lineStart():s.lineEnd()),k&&s.point(+t(M,v,p),+e(M,v,p));if(F)return s=null,F+""||null}return o.x=function(p){return arguments.length?(t=typeof p=="function"?p:ra(+p),o):t},o.y=function(p){return arguments.length?(e=typeof p=="function"?p:ra(+p),o):e},o.defined=function(p){return arguments.length?(n=typeof p=="function"?p:ra(!!p),o):n},o.curve=function(p){return arguments.length?(i=p,r!=null&&(s=i(r)),o):i},o.context=function(p){return arguments.length?(p==null?r=s=null:s=i(r=p),o):r},o}var wZ=MB(SB);function CB(t){this._curve=t}CB.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function MB(t){function e(n){return new CB(t(n))}return e._curve=t,e}function bZ(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(MB(n)):e()._curve},t}function hP(){return bZ(j_().curve(wZ))}function fP(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function sS(t,e){this._context=t,this._k=(1-e)/6}sS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:fP(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:fP(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(r){return new sS(r,e)}return n.tension=function(r){return t(+r)},n})(0);function EZ(t,e,n){var r=t._x1,i=t._y1,s=t._x2,l=t._y2;if(t._l01_a>lo){var o=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,p=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*o-t._x0*t._l12_2a+t._x2*t._l01_2a)/p,i=(i*o-t._y0*t._l12_2a+t._y2*t._l01_2a)/p}if(t._l23_a>lo){var v=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,S=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*v+t._x1*t._l23_2a-e*t._l12_2a)/S,l=(l*v+t._y1*t._l23_2a-n*t._l12_2a)/S}t._context.bezierCurveTo(r,i,s,l,t._x2,t._y2)}function PB(t,e){this._context=t,this._alpha=e}PB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:EZ(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const dP=function t(e){function n(r){return e?new PB(r,e):new sS(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function Zp(t,e,n){this.k=t,this.x=e,this.y=n}Zp.prototype={constructor:Zp,scale:function(t){return t===1?this:new Zp(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Zp(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Zp.prototype;var Vi=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(K){return e.locateFile?e.locateFile(K,i):i+K}var l;typeof document<"u"&&document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",l=function(Q,te,fe){var a=new XMLHttpRequest;a.open("GET",Q,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status==200||a.status==0&&a.response){te(a.response);return}var Le=Rr(Q);if(Le){te(Le.buffer);return}fe()},a.onerror=fe,a.send(null)};var o=e.print||console.log.bind(console),p=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var v=0,S=function(K){v=K},M=function(){return v},k=8;function F(K,Q,te,fe){switch(te=te||"i8",te.charAt(te.length-1)==="*"&&(te="i32"),te){case"i1":tt[K>>0]=Q;break;case"i8":tt[K>>0]=Q;break;case"i16":pt[K>>1]=Q;break;case"i32":Yt[K>>2]=Q;break;case"i64":Ii=[Q>>>0,(jr=Q,+tr(jr)>=1?jr>0?(lr(+xr(jr/4294967296),4294967295)|0)>>>0:~~+Hn((jr-+(~~jr>>>0))/4294967296)>>>0:0)],Yt[K>>2]=Ii[0],Yt[K+4>>2]=Ii[1];break;case"float":Et[K>>2]=Q;break;case"double":un[K>>3]=Q;break;default:Nr("invalid type for setValue: "+te)}}function H(K,Q,te){switch(Q=Q||"i8",Q.charAt(Q.length-1)==="*"&&(Q="i32"),Q){case"i1":return tt[K>>0];case"i8":return tt[K>>0];case"i16":return pt[K>>1];case"i32":return Yt[K>>2];case"i64":return Yt[K>>2];case"float":return Et[K>>2];case"double":return un[K>>3];default:Nr("invalid type for getValue: "+Q)}return null}var j=!1;function ie(K,Q){K||Nr("Assertion failed: "+Q)}function Y(K){var Q=e["_"+K];return ie(Q,"Cannot call unknown function "+K+", make sure it is exported"),Q}function J(K,Q,te,fe,a){var G={string:function(dt){var Dt=0;if(dt!=null&&dt!==0){var Rt=(dt.length<<2)+1;Dt=Vs(Rt),Qe(dt,Dt,Rt)}return Dt},array:function(dt){var Dt=Vs(dt.length);return Ye(dt,Dt),Dt}};function Le(dt){return Q==="string"?Ee(dt):Q==="boolean"?!!dt:dt}var ke=Y(K),Pe=[],Ie=0;if(fe)for(var qe=0;qe<fe.length;qe++){var At=G[te[qe]];At?(Ie===0&&(Ie=ci()),Pe[qe]=At(fe[qe])):Pe[qe]=fe[qe]}var We=ke.apply(null,Pe);return We=Le(We),Ie!==0&&Fr(Ie),We}function se(K,Q,te,fe){te=te||[];var a=te.every(function(Le){return Le==="number"}),G=Q!=="string";return G&&a&&!fe?Y(K):function(){return J(K,Q,te,arguments)}}var ce=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function me(K,Q,te){for(var fe=Q+te,a=Q;K[a]&&!(a>=fe);)++a;if(a-Q>16&&K.subarray&&ce)return ce.decode(K.subarray(Q,a));for(var G="";Q<a;){var Le=K[Q++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var ke=K[Q++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|ke);continue}var Pe=K[Q++]&63;if((Le&240)==224?Le=(Le&15)<<12|ke<<6|Pe:Le=(Le&7)<<18|ke<<12|Pe<<6|K[Q++]&63,Le<65536)G+=String.fromCharCode(Le);else{var Ie=Le-65536;G+=String.fromCharCode(55296|Ie>>10,56320|Ie&1023)}}return G}function Ee(K,Q){return K?me(Ze,K,Q):""}function He(K,Q,te,fe){if(!(fe>0))return 0;for(var a=te,G=te+fe-1,Le=0;Le<K.length;++Le){var ke=K.charCodeAt(Le);if(ke>=55296&&ke<=57343){var Pe=K.charCodeAt(++Le);ke=65536+((ke&1023)<<10)|Pe&1023}if(ke<=127){if(te>=G)break;Q[te++]=ke}else if(ke<=2047){if(te+1>=G)break;Q[te++]=192|ke>>6,Q[te++]=128|ke&63}else if(ke<=65535){if(te+2>=G)break;Q[te++]=224|ke>>12,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}else{if(te+3>=G)break;Q[te++]=240|ke>>18,Q[te++]=128|ke>>12&63,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}}return Q[te]=0,te-a}function Qe(K,Q,te){return He(K,Ze,Q,te)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Ye(K,Q){tt.set(K,Q)}function nt(K,Q){return K%Q>0&&(K+=Q-K%Q),K}var Fe,tt,Ze,pt,Yt,Et,un;function _t(K){Fe=K,e.HEAP8=tt=new Int8Array(K),e.HEAP16=pt=new Int16Array(K),e.HEAP32=Yt=new Int32Array(K),e.HEAPU8=Ze=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Et=new Float32Array(K),e.HEAPF64=un=new Float64Array(K)}var Tt=5267040,Jt=24128,In=e.TOTAL_MEMORY||33554432;e.buffer?Fe=e.buffer:Fe=new ArrayBuffer(In),In=Fe.byteLength,_t(Fe),Yt[Jt>>2]=Tt;function Tn(K){for(;K.length>0;){var Q=K.shift();if(typeof Q=="function"){Q();continue}var te=Q.func;typeof te=="number"?Q.arg===void 0?e.dynCall_v(te):e.dynCall_vi(te,Q.arg):te(Q.arg===void 0?null:Q.arg)}}var kr=[],er=[],or=[],hr=[];function Un(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Mn(e.preRun.shift());Tn(kr)}function Cr(){Tn(er)}function wt(){Tn(or)}function rn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)xt(e.postRun.shift());Tn(hr)}function Mn(K){kr.unshift(K)}function xt(K){hr.unshift(K)}var tr=Math.abs,Hn=Math.ceil,xr=Math.floor,lr=Math.min,nr=0,ri=null;function Vn(K){nr++,e.monitorRunDependencies&&e.monitorRunDependencies(nr)}function ki(K){if(nr--,e.monitorRunDependencies&&e.monitorRunDependencies(nr),nr==0&&ri){var Q=ri;ri=null,Q()}}e.preloadedImages={},e.preloadedAudios={};var Qn=null,Gi="data:application/octet-stream;base64,";function yo(K){return String.prototype.startsWith?K.startsWith(Gi):K.indexOf(Gi)===0}var jr,Ii;Qn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var $o=24144;function ls(K){return K}function ht(K){var Q=/\b__Z[\w\d_]+/g;return K.replace(Q,function(te){var fe=te;return te===fe?te:fe+" ["+te+"]"})}function It(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(Q){K=Q}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Us(){var K=It();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ht(K)}function bi(K,Q,te,fe){Nr("Assertion failed: "+Ee(K)+", at: "+[Q?Ee(Q):"unknown filename",te,fe?Ee(fe):"unknown function"])}function Bn(){return tt.length}function $i(K,Q,te){Ze.set(Ze.subarray(Q,Q+te),K)}function Li(K){return e.___errno_location&&(Yt[e.___errno_location()>>2]=K),K}function Di(K){Nr("OOM")}function As(K){try{var Q=new ArrayBuffer(K);return Q.byteLength!=K?void 0:(new Int8Array(Q).set(tt),Zr(Q),_t(Q),1)}catch{}}function Lt(K){var Q=Bn(),te=16777216,fe=2147483648-te;if(K>fe)return!1;for(var a=16777216,G=Math.max(Q,a);G<K;)G<=536870912?G=nt(2*G,te):G=Math.min(nt((3*G+2147483648)/4,te),fe);var Le=As(G);return!!Le}var Sn=typeof atob=="function"?atob:function(K){var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",te="",fe,a,G,Le,ke,Pe,Ie,qe=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=Q.indexOf(K.charAt(qe++)),ke=Q.indexOf(K.charAt(qe++)),Pe=Q.indexOf(K.charAt(qe++)),Ie=Q.indexOf(K.charAt(qe++)),fe=Le<<2|ke>>4,a=(ke&15)<<4|Pe>>2,G=(Pe&3)<<6|Ie,te=te+String.fromCharCode(fe),Pe!==64&&(te=te+String.fromCharCode(a)),Ie!==64&&(te=te+String.fromCharCode(G));while(qe<K.length);return te};function bn(K){try{for(var Q=Sn(K),te=new Uint8Array(Q.length),fe=0;fe<Q.length;++fe)te[fe]=Q.charCodeAt(fe);return te}catch{throw new Error("Converting base64 string to bytes failed.")}}function Rr(K){if(yo(K))return bn(K.slice(Gi.length))}var Ts={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},yn={a:Nr,b:S,c:M,d:bi,e:Li,f:Bn,g:$i,h:Lt,i:Di,j:ls,k:ht,l:As,m:It,n:Us,o:$o,p:Jt},Xe=function(K,Q,te){"almost asm";var fe=new K.Int8Array(te),a=new K.Int32Array(te);new K.Uint8Array(te),new K.Float32Array(te);var G=new K.Float64Array(te),Le=Q.o|0,ke=Q.p|0,Pe=K.Math.floor,Ie=K.Math.abs,qe=K.Math.sqrt,At=K.Math.pow,We=K.Math.cos,dt=K.Math.sin,Dt=K.Math.tan,Rt=K.Math.acos,sn=K.Math.asin,jt=K.Math.atan,pn=K.Math.atan2,qt=K.Math.ceil,an=K.Math.imul,xn=K.Math.min,Ft=K.Math.max,Oe=K.Math.clz32,Mt=Q.b,Ce=Q.c,cn=Q.d,hi=Q.e,rr=Q.f,pa=Q.g,De=Q.h,Ha=Q.i,we=24160;function jo(y){return fe=new Int8Array(y),a=new Int32Array(y),G=new Float64Array(y),te=y,!0}function Ss(y){y=y|0;var m=0;return m=we,we=we+y|0,we=we+15&-16,m|0}function Wa(){return we|0}function Qa(y){y=y|0,we=y}function ga(y,m){y=y|0,we=y}function Ml(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;return(y|0)<0?(m=2,m|0):(y|0)>13780509?(m=nl(15,m)|0,m|0):(x=((y|0)<0)<<31>>31,I=V(y|0,x|0,3,0)|0,E=Ce()|0,x=d(y|0,x|0,1,0)|0,x=V(I|0,E|0,x|0,Ce()|0)|0,x=d(x|0,Ce()|0,1,0)|0,y=Ce()|0,a[m>>2]=x,a[m+4>>2]=y,m=0,m|0)}function ma(y,m,x,E){return y=y|0,m=m|0,x=x|0,E=E|0,ii(y,m,x,E,0)|0}function ii(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0;if(q=we,we=we+16|0,O=q,!(ge(y,m,x,E,I)|0))return E=0,we=q,E|0;do if((x|0)>=0){if((x|0)>13780509){if(R=nl(15,O)|0,R|0)break;U=O,O=a[U>>2]|0,U=a[U+4>>2]|0}else R=((x|0)<0)<<31>>31,ee=V(x|0,R|0,3,0)|0,U=Ce()|0,R=d(x|0,R|0,1,0)|0,R=V(ee|0,U|0,R|0,Ce()|0)|0,R=d(R|0,Ce()|0,1,0)|0,U=Ce()|0,a[O>>2]=R,a[O+4>>2]=U,O=R;if(Se(E|0,0,O<<3|0)|0,I|0){Se(I|0,0,O<<2|0)|0,R=Te(y,m,x,E,I,O,U,0)|0;break}R=h(O,4)|0,R?(ee=Te(y,m,x,E,R,O,U,0)|0,A(R),R=ee):R=13}else R=2;while(0);return ee=R,we=q,ee|0}function ge(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0;if(Ke=we,we=we+16|0,je=Ke,Be=Ke+8|0,Re=je,a[Re>>2]=y,a[Re+4>>2]=m,(x|0)<0)return Be=2,we=Ke,Be|0;if(R=E,a[R>>2]=y,a[R+4>>2]=m,R=(I|0)!=0,R&&(a[I>>2]=0),gr(y,m)|0)return Be=9,we=Ke,Be|0;a[Be>>2]=0;e:do if((x|0)>=1)if(R)for(le=1,ee=0,de=0,Re=1,R=y;;){if(!(ee|de)){if(R=Ne(R,m,4,Be,je)|0,R|0)break e;if(m=je,R=a[m>>2]|0,m=a[m+4>>2]|0,gr(R,m)|0){R=9;break e}}if(R=Ne(R,m,a[22384+(de<<2)>>2]|0,Be,je)|0,R|0)break e;if(m=je,R=a[m>>2]|0,m=a[m+4>>2]|0,y=E+(le<<3)|0,a[y>>2]=R,a[y+4>>2]=m,a[I+(le<<2)>>2]=Re,y=ee+1|0,O=(y|0)==(Re|0),U=de+1|0,q=(U|0)==6,gr(R,m)|0){R=9;break e}if(Re=Re+(q&O&1)|0,(Re|0)>(x|0)){R=0;break}else le=le+1|0,ee=O?0:y,de=O?q?0:U:de}else for(le=1,ee=0,de=0,Re=1,R=y;;){if(!(ee|de)){if(R=Ne(R,m,4,Be,je)|0,R|0)break e;if(m=je,R=a[m>>2]|0,m=a[m+4>>2]|0,gr(R,m)|0){R=9;break e}}if(R=Ne(R,m,a[22384+(de<<2)>>2]|0,Be,je)|0,R|0)break e;if(m=je,R=a[m>>2]|0,m=a[m+4>>2]|0,y=E+(le<<3)|0,a[y>>2]=R,a[y+4>>2]=m,y=ee+1|0,O=(y|0)==(Re|0),U=de+1|0,q=(U|0)==6,gr(R,m)|0){R=9;break e}if(Re=Re+(q&O&1)|0,(Re|0)>(x|0)){R=0;break}else le=le+1|0,ee=O?0:y,de=O?q?0:U:de}else R=0;while(0);return Be=R,we=Ke,Be|0}function Te(y,m,x,E,I,R,O,U){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0,O=O|0,U=U|0;var q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0;if(Ke=we,we=we+16|0,je=Ke+8|0,Be=Ke,q=X(y|0,m|0,R|0,O|0)|0,le=Ce()|0,de=E+(q<<3)|0,ft=de,ct=a[ft>>2]|0,ft=a[ft+4>>2]|0,ee=(ct|0)==(y|0)&(ft|0)==(m|0),!((ct|0)==0&(ft|0)==0|ee))do q=d(q|0,le|0,1,0)|0,q=W(q|0,Ce()|0,R|0,O|0)|0,le=Ce()|0,de=E+(q<<3)|0,ct=de,ft=a[ct>>2]|0,ct=a[ct+4>>2]|0,ee=(ft|0)==(y|0)&(ct|0)==(m|0);while(!((ft|0)==0&(ct|0)==0|ee));if(q=I+(q<<2)|0,ee&&(a[q>>2]|0)<=(U|0)||(ct=de,a[ct>>2]=y,a[ct+4>>2]=m,a[q>>2]=U,(U|0)>=(x|0)))return ct=0,we=Ke,ct|0;switch(ee=U+1|0,a[je>>2]=0,q=Ne(y,m,2,je,Be)|0,q|0){case 9:{Re=9;break}case 0:{q=Be,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q||(Re=9);break}}e:do if((Re|0)==9){switch(a[je>>2]=0,q=Ne(y,m,3,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}switch(a[je>>2]=0,q=Ne(y,m,1,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}switch(a[je>>2]=0,q=Ne(y,m,5,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}switch(a[je>>2]=0,q=Ne(y,m,4,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}switch(a[je>>2]=0,q=Ne(y,m,6,je,Be)|0,q|0){case 9:break;case 0:{if(q=Be,q=Te(a[q>>2]|0,a[q+4>>2]|0,x,E,I,R,O,ee)|0,q|0)break e;break}default:break e}return ct=0,we=Ke,ct|0}while(0);return ct=q,we=Ke,ct|0}function Ne(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0;if(x>>>0>6)return I=1,I|0;if(de=(a[E>>2]|0)%6|0,a[E>>2]=de,(de|0)>0){R=0;do x=xo(x)|0,R=R+1|0;while((R|0)<(a[E>>2]|0))}if(de=ne(y|0,m|0,45)|0,Ce()|0,le=de&127,le>>>0>121)return I=5,I|0;q=oi(y,m)|0,R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15;e:do if(!R)ee=8;else{for(;;){if(O=(15-R|0)*3|0,U=ne(y|0,m|0,O|0)|0,Ce()|0,U=U&7,(U|0)==7){m=5;break}if(Be=(Ei(R)|0)==0,R=R+-1|0,Re=ue(7,0,O|0)|0,m=m&~(Ce()|0),je=ue(a[(Be?432:16)+(U*28|0)+(x<<2)>>2]|0,0,O|0)|0,O=Ce()|0,x=a[(Be?640:224)+(U*28|0)+(x<<2)>>2]|0,y=je|y&~Re,m=O|m,!x){x=0;break e}if(!R){ee=8;break e}}return m|0}while(0);(ee|0)==8&&(Be=a[848+(le*28|0)+(x<<2)>>2]|0,je=ue(Be|0,0,45)|0,y=je|y,m=Ce()|0|m&-1040385,x=a[4272+(le*28|0)+(x<<2)>>2]|0,(Be&127|0)==127&&(Be=ue(a[848+(le*28|0)+20>>2]|0,0,45)|0,m=Ce()|0|m&-1040385,x=a[4272+(le*28|0)+20>>2]|0,y=Hs(Be|y,m)|0,m=Ce()|0,a[E>>2]=(a[E>>2]|0)+1)),U=ne(y|0,m|0,45)|0,Ce()|0,U=U&127;e:do if(Gn(U)|0){t:do if((oi(y,m)|0)==1){if((le|0)!=(U|0))if(bA(U,a[7696+(le*28|0)>>2]|0)|0){y=PA(y,m)|0,O=1,m=Ce()|0;break}else cn(23313,22416,436,22424);switch(q|0){case 3:{y=Hs(y,m)|0,m=Ce()|0,a[E>>2]=(a[E>>2]|0)+1,O=0;break t}case 5:{y=PA(y,m)|0,m=Ce()|0,a[E>>2]=(a[E>>2]|0)+5,O=0;break t}case 0:return Be=9,Be|0;default:return Be=1,Be|0}}else O=0;while(0);if((x|0)>0){R=0;do y=pu(y,m)|0,m=Ce()|0,R=R+1|0;while((R|0)!=(x|0))}if((le|0)!=(U|0)){if(!(vA(U)|0)){if((O|0)!=0|(oi(y,m)|0)!=5)break;a[E>>2]=(a[E>>2]|0)+1;break}switch(de&127){case 8:case 118:break e}(oi(y,m)|0)!=3&&(a[E>>2]=(a[E>>2]|0)+1)}}else if((x|0)>0){R=0;do y=Hs(y,m)|0,m=Ce()|0,R=R+1|0;while((R|0)!=(x|0))}while(0);return a[E>>2]=((a[E>>2]|0)+x|0)%6|0,Be=I,a[Be>>2]=y,a[Be+4>>2]=m,Be=0,Be|0}function lt(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0;for(U=we,we=we+16|0,R=U,O=U+8|0,I=(gr(y,m)|0)==0,I=I?1:2;;){if(a[O>>2]=0,ee=(Ne(y,m,I,O,R)|0)==0,q=R,ee&((a[q>>2]|0)==(x|0)?(a[q+4>>2]|0)==(E|0):0)){y=4;break}if(I=I+1|0,I>>>0>=7){I=7,y=4;break}}return(y|0)==4?(we=U,I|0):0}function bt(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0;if(Be=we,we=we+16|0,Re=Be,je=Be+8|0,de=Re,a[de>>2]=y,a[de+4>>2]=m,!x)return je=E,a[je>>2]=y,a[je+4>>2]=m,je=0,we=Be,je|0;a[je>>2]=0;e:do if(gr(y,m)|0)y=9;else{if(R=(x|0)>0,R){I=0,de=y;do{if(y=Ne(de,m,4,je,Re)|0,y|0)break e;if(m=Re,de=a[m>>2]|0,m=a[m+4>>2]|0,I=I+1|0,gr(de,m)|0){y=9;break e}}while((I|0)<(x|0));if(le=E,a[le>>2]=de,a[le+4>>2]=m,le=x+-1|0,R){ee=0,y=1;do{if(I=22384+(ee<<2)|0,(ee|0)==5)for(O=a[I>>2]|0,R=0,I=y;;){if(y=Re,y=Ne(a[y>>2]|0,a[y+4>>2]|0,O,je,Re)|0,y|0)break e;if((R|0)!=(le|0))if(q=Re,U=a[q>>2]|0,q=a[q+4>>2]|0,y=E+(I<<3)|0,a[y>>2]=U,a[y+4>>2]=q,!(gr(U,q)|0))y=I+1|0;else{y=9;break e}else y=I;if(R=R+1|0,(R|0)>=(x|0))break;I=y}else for(O=Re,q=a[I>>2]|0,U=0,I=y,R=a[O>>2]|0,O=a[O+4>>2]|0;;){if(y=Ne(R,O,q,je,Re)|0,y|0)break e;if(O=Re,R=a[O>>2]|0,O=a[O+4>>2]|0,y=E+(I<<3)|0,a[y>>2]=R,a[y+4>>2]=O,y=I+1|0,gr(R,O)|0){y=9;break e}if(U=U+1|0,(U|0)>=(x|0))break;I=y}ee=ee+1|0}while(ee>>>0<6);y=Re,O=de,I=a[y>>2]|0,R=m,y=a[y+4>>2]|0}else O=de,I=de,R=m,y=m}else O=E,a[O>>2]=y,a[O+4>>2]=m,O=y,I=y,R=m,y=m;y=(O|0)==(I|0)&(R|0)==(y|0)?0:9}while(0);return je=y,we=Be,je|0}function Qt(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0;if(U=we,we=we+48|0,I=U+16|0,R=U+8|0,O=U,x|0)return O=15,we=U,O|0;if(ee=y,q=a[ee+4>>2]|0,x=R,a[x>>2]=a[ee>>2],a[x+4>>2]=q,To(R,I),m=gc(I,m,O)|0,!m){if(x=a[R>>2]|0,R=a[y+8>>2]|0,(R|0)>0){I=a[y+12>>2]|0,m=0;do x=(a[I+(m<<3)>>2]|0)+x|0,m=m+1|0;while((m|0)<(R|0))}m=O,I=a[m>>2]|0,m=a[m+4>>2]|0,R=((x|0)<0)<<31>>31,(m|0)<(R|0)|(m|0)==(R|0)&I>>>0<x>>>0?(m=O,a[m>>2]=x,a[m+4>>2]=R,m=R):x=I,q=d(x|0,m|0,12,0)|0,ee=Ce()|0,m=O,a[m>>2]=q,a[m+4>>2]=ee,m=E,a[m>>2]=q,a[m+4>>2]=ee,m=0}return ee=m,we=U,ee|0}function Ln(y,m,x,E,I,R,O){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0,O=O|0;var U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,gt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,ar=0,kn=0,Er=0,Kr=0,ol=0;if(ar=we,we=we+64|0,mn=ar+48|0,_n=ar+32|0,En=ar+24|0,Gt=ar+8|0,zt=ar,q=a[y>>2]|0,(q|0)<=0)return Dn=0,we=ar,Dn|0;for(gt=y+4|0,vt=mn+8|0,Pn=_n+8|0,wn=Gt+8|0,U=0,ot=0;;){ee=a[gt>>2]|0,st=ee+(ot<<4)|0,a[mn>>2]=a[st>>2],a[mn+4>>2]=a[st+4>>2],a[mn+8>>2]=a[st+8>>2],a[mn+12>>2]=a[st+12>>2],(ot|0)==(q+-1|0)?(a[_n>>2]=a[ee>>2],a[_n+4>>2]=a[ee+4>>2],a[_n+8>>2]=a[ee+8>>2],a[_n+12>>2]=a[ee+12>>2]):(st=ee+(ot+1<<4)|0,a[_n>>2]=a[st>>2],a[_n+4>>2]=a[st+4>>2],a[_n+8>>2]=a[st+8>>2],a[_n+12>>2]=a[st+12>>2]),q=Il(mn,_n,E,En)|0;e:do if(q)ee=0,U=q;else if(ee=En,q=a[ee>>2]|0,ee=a[ee+4>>2]|0,(ee|0)>0|(ee|0)==0&q>>>0>0){ct=0,st=0;t:for(;;){if(ol=+G[mn>>3],ft=w(q|0,ee|0,ct|0,st|0)|0,Kr=+(ft>>>0)+4294967296*+(Ce()|0),kn=+(q>>>0)+4294967296*+(ee|0),Er=+(ct>>>0)+4294967296*+(st|0),G[Gt>>3]=ol*Kr/kn+ +G[_n>>3]*Er/kn,G[wn>>3]=+G[vt>>3]*Kr/kn+ +G[Pn>>3]*Er/kn,q=hs(Gt,E,zt)|0,q|0){U=q;break}ft=zt,Ke=a[ft>>2]|0,ft=a[ft+4>>2]|0,Re=X(Ke|0,ft|0,m|0,x|0)|0,le=Ce()|0,q=O+(Re<<3)|0,de=q,ee=a[de>>2]|0,de=a[de+4>>2]|0;n:do if((ee|0)==0&(de|0)==0)Je=q,Dn=16;else for(je=0,Be=0;;){if((je|0)>(x|0)|(je|0)==(x|0)&Be>>>0>m>>>0){U=1;break t}if((ee|0)==(Ke|0)&(de|0)==(ft|0))break n;if(q=d(Re|0,le|0,1,0)|0,Re=W(q|0,Ce()|0,m|0,x|0)|0,le=Ce()|0,Be=d(Be|0,je|0,1,0)|0,je=Ce()|0,q=O+(Re<<3)|0,de=q,ee=a[de>>2]|0,de=a[de+4>>2]|0,(ee|0)==0&(de|0)==0){Je=q,Dn=16;break}}while(0);if((Dn|0)==16&&(Dn=0,!((Ke|0)==0&(ft|0)==0))&&(Be=Je,a[Be>>2]=Ke,a[Be+4>>2]=ft,Be=R+(a[I>>2]<<3)|0,a[Be>>2]=Ke,a[Be+4>>2]=ft,Be=I,Be=d(a[Be>>2]|0,a[Be+4>>2]|0,1,0)|0,Ke=Ce()|0,ft=I,a[ft>>2]=Be,a[ft+4>>2]=Ke),ct=d(ct|0,st|0,1,0)|0,st=Ce()|0,ee=En,q=a[ee>>2]|0,ee=a[ee+4>>2]|0,!((ee|0)>(st|0)|(ee|0)==(st|0)&q>>>0>ct>>>0)){ee=1;break e}}ee=0}else ee=1;while(0);if(ot=ot+1|0,!ee){Dn=21;break}if(q=a[y>>2]|0,(ot|0)>=(q|0)){U=0,Dn=21;break}}return(Dn|0)==21?(we=ar,U|0):0}function Dr(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,gt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,ar=0,kn=0,Er=0,Kr=0;if(Kr=we,we=we+112|0,Dn=Kr+80|0,q=Kr+72|0,ar=Kr,kn=Kr+56|0,x|0)return Er=15,we=Kr,Er|0;if(ee=y+8|0,Er=_((a[ee>>2]<<5)+32|0)|0,!Er)return Er=13,we=Kr,Er|0;if(wu(y,Er),_n=y,En=a[_n+4>>2]|0,x=q,a[x>>2]=a[_n>>2],a[x+4>>2]=En,To(q,Dn),x=gc(Dn,m,ar)|0,x)_n=0,En=0;else{if(x=a[q>>2]|0,R=a[ee>>2]|0,(R|0)>0){O=a[y+12>>2]|0,I=0;do x=(a[O+(I<<3)>>2]|0)+x|0,I=I+1|0;while((I|0)!=(R|0));I=x}else I=x;x=ar,R=a[x>>2]|0,x=a[x+4>>2]|0,O=((I|0)<0)<<31>>31,(x|0)<(O|0)|(x|0)==(O|0)&R>>>0<I>>>0?(x=ar,a[x>>2]=I,a[x+4>>2]=O,x=O):I=R,_n=d(I|0,x|0,12,0)|0,En=Ce()|0,x=ar,a[x>>2]=_n,a[x+4>>2]=En,x=0}if(x|0)return A(Er),Er=x,we=Kr,Er|0;if(I=h(_n,8)|0,!I)return A(Er),Er=13,we=Kr,Er|0;if(U=h(_n,8)|0,!U)return A(Er),A(I),Er=13,we=Kr,Er|0;wn=Dn,a[wn>>2]=0,a[wn+4>>2]=0,wn=y,mn=a[wn+4>>2]|0,x=q,a[x>>2]=a[wn>>2],a[x+4>>2]=mn,x=Ln(q,_n,En,m,Dn,I,U)|0;e:do if(x)A(I),A(U),A(Er);else{t:do if((a[ee>>2]|0)>0){for(O=y+12|0,R=0;x=Ln((a[O>>2]|0)+(R<<3)|0,_n,En,m,Dn,I,U)|0,R=R+1|0,!(x|0);)if((R|0)>=(a[ee>>2]|0))break t;A(I),A(U),A(Er);break e}while(0);(En|0)>0|(En|0)==0&_n>>>0>0&&Se(U|0,0,_n<<3|0)|0,mn=Dn,wn=a[mn+4>>2]|0;t:do if((wn|0)>0|(wn|0)==0&(a[mn>>2]|0)>>>0>0){gt=I,vt=U,Pn=I,wn=U,mn=I,x=I,Je=I,Gt=U,zt=U,I=U;n:for(;;){for(ft=0,ct=0,st=0,ot=0,R=0,O=0;;){U=ar,q=U+56|0;do a[U>>2]=0,U=U+4|0;while((U|0)<(q|0));if(m=gt+(ft<<3)|0,ee=a[m>>2]|0,m=a[m+4>>2]|0,ge(ee,m,1,ar,0)|0){U=ar,q=U+56|0;do a[U>>2]=0,U=U+4|0;while((U|0)<(q|0));U=h(7,4)|0,U|0&&(Te(ee,m,1,ar,U,7,0,0)|0,A(U))}for(Ke=0;;){Be=ar+(Ke<<3)|0,je=a[Be>>2]|0,Be=a[Be+4>>2]|0;r:do if((je|0)==0&(Be|0)==0)U=R,q=O;else{if(le=X(je|0,Be|0,_n|0,En|0)|0,ee=Ce()|0,U=E+(le<<3)|0,m=U,q=a[m>>2]|0,m=a[m+4>>2]|0,!((q|0)==0&(m|0)==0)){de=0,Re=0;do{if((de|0)>(En|0)|(de|0)==(En|0)&Re>>>0>_n>>>0)break n;if((q|0)==(je|0)&(m|0)==(Be|0)){U=R,q=O;break r}U=d(le|0,ee|0,1,0)|0,le=W(U|0,Ce()|0,_n|0,En|0)|0,ee=Ce()|0,Re=d(Re|0,de|0,1,0)|0,de=Ce()|0,U=E+(le<<3)|0,m=U,q=a[m>>2]|0,m=a[m+4>>2]|0}while(!((q|0)==0&(m|0)==0))}(je|0)==0&(Be|0)==0?(U=R,q=O):(bo(je,Be,kn)|0,Sa(y,Er,kn)|0&&(Re=d(R|0,O|0,1,0)|0,O=Ce()|0,de=U,a[de>>2]=je,a[de+4>>2]=Be,R=vt+(R<<3)|0,a[R>>2]=je,a[R+4>>2]=Be,R=Re),U=R,q=O)}while(0);if(Ke=Ke+1|0,Ke>>>0>=7)break;R=U,O=q}if(ft=d(ft|0,ct|0,1,0)|0,ct=Ce()|0,st=d(st|0,ot|0,1,0)|0,ot=Ce()|0,O=Dn,R=a[O>>2]|0,O=a[O+4>>2]|0,(ot|0)<(O|0)|(ot|0)==(O|0)&st>>>0<R>>>0)R=U,O=q;else break}if((O|0)>0|(O|0)==0&R>>>0>0){R=0,O=0;do ot=gt+(R<<3)|0,a[ot>>2]=0,a[ot+4>>2]=0,R=d(R|0,O|0,1,0)|0,O=Ce()|0,ot=Dn,st=a[ot+4>>2]|0;while((O|0)<(st|0)|((O|0)==(st|0)?R>>>0<(a[ot>>2]|0)>>>0:0))}if(ot=Dn,a[ot>>2]=U,a[ot+4>>2]=q,(q|0)>0|(q|0)==0&U>>>0>0)Ke=I,ft=zt,ct=mn,st=Gt,ot=vt,I=Je,zt=x,Gt=Pn,Je=Ke,x=ft,mn=wn,wn=ct,Pn=st,vt=gt,gt=ot;else break t}A(Pn),A(wn),A(Er),x=1;break e}else x=U;while(0);A(Er),A(I),A(x),x=0}while(0);return Er=x,we=Kr,Er|0}function en(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(le=we,we=we+176|0,q=le,(m|0)<1)return Zs(x,0,0),ee=0,we=le,ee|0;for(U=y,U=ne(a[U>>2]|0,a[U+4>>2]|0,52)|0,Ce()|0,Zs(x,(m|0)>6?m:6,U&15),U=0;E=y+(U<<3)|0,E=mi(a[E>>2]|0,a[E+4>>2]|0,q)|0,!(E|0);){if(E=a[q>>2]|0,(E|0)>0){O=0;do R=q+8+(O<<4)|0,O=O+1|0,E=q+8+(((O|0)%(E|0)|0)<<4)|0,I=Wr(x,E,R)|0,I?Ct(x,I)|0:Pt(x,R,E)|0,E=a[q>>2]|0;while((O|0)<(E|0))}if(U=U+1|0,(U|0)>=(m|0)){E=0,ee=13;break}}return(ee|0)==13?(we=le,E|0):(Ps(x),ee=E,we=le,ee|0)}function Br(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;if(R=we,we=we+32|0,E=R,I=R+16|0,y=en(y,m,I)|0,y|0)return x=y,we=R,x|0;if(a[x>>2]=0,a[x+4>>2]=0,a[x+8>>2]=0,y=Ys(I)|0,y|0)do{m=Vt(x)|0;do kA(m,y)|0,O=y+16|0,a[E>>2]=a[O>>2],a[E+4>>2]=a[O+4>>2],a[E+8>>2]=a[O+8>>2],a[E+12>>2]=a[O+12>>2],Ct(I,y)|0,y=sl(I,E)|0;while(y|0);y=Ys(I)|0}while(y|0);return Ps(I),y=IA(x)|0,y?($l(x),O=y,we=R,O|0):(O=0,we=R,O|0)}function Gn(y){return y=y|0,y>>>0>121?(y=0,y|0):(y=a[7696+(y*28|0)+16>>2]|0,y|0)}function vA(y){return y=y|0,(y|0)==4|(y|0)==117|0}function xA(y){return y=y|0,a[11120+((a[y>>2]|0)*216|0)+((a[y+4>>2]|0)*72|0)+((a[y+8>>2]|0)*24|0)+(a[y+12>>2]<<3)>>2]|0}function wA(y){return y=y|0,a[11120+((a[y>>2]|0)*216|0)+((a[y+4>>2]|0)*72|0)+((a[y+8>>2]|0)*24|0)+(a[y+12>>2]<<3)+4>>2]|0}function iu(y,m){y=y|0,m=m|0,y=7696+(y*28|0)|0,a[m>>2]=a[y>>2],a[m+4>>2]=a[y+4>>2],a[m+8>>2]=a[y+8>>2],a[m+12>>2]=a[y+12>>2]}function su(y,m){y=y|0,m=m|0;var x=0,E=0;if(m>>>0>20)return m=-1,m|0;do if((a[11120+(m*216|0)>>2]|0)!=(y|0))if((a[11120+(m*216|0)+8>>2]|0)!=(y|0))if((a[11120+(m*216|0)+16>>2]|0)!=(y|0))if((a[11120+(m*216|0)+24>>2]|0)!=(y|0))if((a[11120+(m*216|0)+32>>2]|0)!=(y|0))if((a[11120+(m*216|0)+40>>2]|0)!=(y|0))if((a[11120+(m*216|0)+48>>2]|0)!=(y|0))if((a[11120+(m*216|0)+56>>2]|0)!=(y|0))if((a[11120+(m*216|0)+64>>2]|0)!=(y|0))if((a[11120+(m*216|0)+72>>2]|0)!=(y|0))if((a[11120+(m*216|0)+80>>2]|0)!=(y|0))if((a[11120+(m*216|0)+88>>2]|0)!=(y|0))if((a[11120+(m*216|0)+96>>2]|0)!=(y|0))if((a[11120+(m*216|0)+104>>2]|0)!=(y|0))if((a[11120+(m*216|0)+112>>2]|0)!=(y|0))if((a[11120+(m*216|0)+120>>2]|0)!=(y|0))if((a[11120+(m*216|0)+128>>2]|0)!=(y|0))if((a[11120+(m*216|0)+136>>2]|0)==(y|0))y=2,x=1,E=2;else{if((a[11120+(m*216|0)+144>>2]|0)==(y|0)){y=0,x=2,E=0;break}if((a[11120+(m*216|0)+152>>2]|0)==(y|0)){y=0,x=2,E=1;break}if((a[11120+(m*216|0)+160>>2]|0)==(y|0)){y=0,x=2,E=2;break}if((a[11120+(m*216|0)+168>>2]|0)==(y|0)){y=1,x=2,E=0;break}if((a[11120+(m*216|0)+176>>2]|0)==(y|0)){y=1,x=2,E=1;break}if((a[11120+(m*216|0)+184>>2]|0)==(y|0)){y=1,x=2,E=2;break}if((a[11120+(m*216|0)+192>>2]|0)==(y|0)){y=2,x=2,E=0;break}if((a[11120+(m*216|0)+200>>2]|0)==(y|0)){y=2,x=2,E=1;break}if((a[11120+(m*216|0)+208>>2]|0)==(y|0)){y=2,x=2,E=2;break}else y=-1;return y|0}else y=2,x=1,E=1;else y=2,x=1,E=0;else y=1,x=1,E=2;else y=1,x=1,E=1;else y=1,x=1,E=0;else y=0,x=1,E=2;else y=0,x=1,E=1;else y=0,x=1,E=0;else y=2,x=0,E=2;else y=2,x=0,E=1;else y=2,x=0,E=0;else y=1,x=0,E=2;else y=1,x=0,E=1;else y=1,x=0,E=0;else y=0,x=0,E=2;else y=0,x=0,E=1;else y=0,x=0,E=0;while(0);return m=a[11120+(m*216|0)+(x*72|0)+(y*24|0)+(E<<3)+4>>2]|0,m|0}function bA(y,m){return y=y|0,m=m|0,(a[7696+(y*28|0)+20>>2]|0)==(m|0)?(m=1,m|0):(m=(a[7696+(y*28|0)+24>>2]|0)==(m|0),m|0)}function Pl(y,m){return y=y|0,m=m|0,a[848+(y*28|0)+(m<<2)>>2]|0}function kl(y,m){return y=y|0,m=m|0,(a[848+(y*28|0)>>2]|0)==(m|0)?(m=0,m|0):(a[848+(y*28|0)+4>>2]|0)==(m|0)?(m=1,m|0):(a[848+(y*28|0)+8>>2]|0)==(m|0)?(m=2,m|0):(a[848+(y*28|0)+12>>2]|0)==(m|0)?(m=3,m|0):(a[848+(y*28|0)+16>>2]|0)==(m|0)?(m=4,m|0):(a[848+(y*28|0)+20>>2]|0)==(m|0)?(m=5,m|0):((a[848+(y*28|0)+24>>2]|0)==(m|0)?6:7)|0}function EA(){return 122}function TA(y){y=y|0;var m=0,x=0,E=0;m=0;do ue(m|0,0,45)|0,E=Ce()|0|134225919,x=y+(m<<3)|0,a[x>>2]=-1,a[x+4>>2]=E,m=m+1|0;while((m|0)!=122);return 0}function Xn(y){return y=y|0,+G[y+16>>3]<+G[y+24>>3]|0}function ou(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;return x=+G[m>>3],!(x>=+G[y+8>>3])||!(x<=+G[y>>3])?(m=0,m|0):(E=+G[y+16>>3],x=+G[y+24>>3],I=+G[m+8>>3],m=I>=x,y=I<=E&1,E<x?m&&(y=1):m||(y=0),m=(y|0)!=0,m|0)}function gc(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0;Be=we,we=we+288|0,le=Be+264|0,de=Be+96|0,ee=Be,U=ee,q=U+96|0;do a[U>>2]=0,U=U+4|0;while((U|0)<(q|0));return m=Ws(m,ee)|0,m|0?(je=m,we=Be,je|0):(q=ee,ee=a[q>>2]|0,q=a[q+4>>2]|0,bo(ee,q,le)|0,mi(ee,q,de)|0,O=+Vl(le,de+8|0),G[le>>3]=+G[y>>3],q=le+8|0,G[q>>3]=+G[y+16>>3],G[de>>3]=+G[y+8>>3],ee=de+8|0,G[ee>>3]=+G[y+24>>3],I=+Vl(le,de),ft=+G[q>>3]-+G[ee>>3],R=+Ie(+ft),Ke=+G[le>>3]-+G[de>>3],E=+Ie(+Ke),!(ft==0|Ke==0)&&(ft=+be(+R,+E),ft=+qt(+(I*I/+Me(+(ft/+Me(+R,+E)),3)/(O*(O*2.59807621135)*.8))),G[Le>>3]=ft,Re=~~ft>>>0,je=+Ie(ft)>=1?ft>0?~~+xn(+Pe(ft/4294967296),4294967295)>>>0:~~+qt((ft-+(~~ft>>>0))/4294967296)>>>0:0,(a[Le+4>>2]&2146435072|0)!=2146435072)?(de=(Re|0)==0&(je|0)==0,m=x,a[m>>2]=de?1:Re,a[m+4>>2]=de?0:je,m=0):m=1,je=m,we=Be,je|0)}function Il(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0;ee=we,we=we+288|0,O=ee+264|0,U=ee+96|0,q=ee,I=q,R=I+96|0;do a[I>>2]=0,I=I+4|0;while((I|0)<(R|0));return x=Ws(x,q)|0,x|0?(E=x,we=ee,E|0):(x=q,I=a[x>>2]|0,x=a[x+4>>2]|0,bo(I,x,O)|0,mi(I,x,U)|0,le=+Vl(O,U+8|0),le=+qt(+(+Vl(y,m)/(le*2))),G[Le>>3]=le,x=~~le>>>0,I=+Ie(le)>=1?le>0?~~+xn(+Pe(le/4294967296),4294967295)>>>0:~~+qt((le-+(~~le>>>0))/4294967296)>>>0:0,(a[Le+4>>2]&2146435072|0)==2146435072?(E=1,we=ee,E|0):(q=(x|0)==0&(I|0)==0,a[E>>2]=q?1:x,a[E+4>>2]=q?0:I,E=0,we=ee,E|0))}function Yr(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0,a[y>>2]=m,a[y+4>>2]=x,a[y+8>>2]=E}function Ho(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0;de=m+8|0,a[de>>2]=0,q=+G[y>>3],O=+Ie(+q),ee=+G[y+8>>3],U=+Ie(+ee)/.8660254037844386,O=O+U*.5,x=~~O,y=~~U,O=O-+(x|0),U=U-+(y|0);do if(O<.5)if(O<.3333333333333333)if(a[m>>2]=x,U<(O+1)*.5){a[m+4>>2]=y;break}else{y=y+1|0,a[m+4>>2]=y;break}else if(Re=1-O,y=(!(U<Re)&1)+y|0,a[m+4>>2]=y,Re<=U&U<O*2){x=x+1|0,a[m>>2]=x;break}else{a[m>>2]=x;break}else{if(!(O<.6666666666666666))if(x=x+1|0,a[m>>2]=x,U<O*.5){a[m+4>>2]=y;break}else{y=y+1|0,a[m+4>>2]=y;break}if(U<1-O){if(a[m+4>>2]=y,O*2+-1<U){a[m>>2]=x;break}}else y=y+1|0,a[m+4>>2]=y;x=x+1|0,a[m>>2]=x}while(0);do if(q<0)if(y&1){le=(y+1|0)/2|0,le=w(x|0,((x|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,x=~~(+(x|0)-((+(le>>>0)+4294967296*+(Ce()|0))*2+1)),a[m>>2]=x;break}else{le=(y|0)/2|0,le=w(x|0,((x|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,x=~~(+(x|0)-(+(le>>>0)+4294967296*+(Ce()|0))*2),a[m>>2]=x;break}while(0);le=m+4|0,ee<0&&(x=x-((y<<1|1|0)/2|0)|0,a[m>>2]=x,y=0-y|0,a[le>>2]=y),E=y-x|0,(x|0)<0?(I=0-x|0,a[le>>2]=E,a[de>>2]=I,a[m>>2]=0,y=E,x=0):I=0,(y|0)<0&&(x=x-y|0,a[m>>2]=x,I=I-y|0,a[de>>2]=I,a[le>>2]=0,y=0),R=x-I|0,E=y-I|0,(I|0)<0&&(a[m>>2]=R,a[le>>2]=E,a[de>>2]=0,y=E,x=R,I=0),E=(y|0)<(x|0)?y:x,E=(I|0)<(E|0)?I:E,!((E|0)<=0)&&(a[m>>2]=x-E,a[le>>2]=y-E,a[de>>2]=I-E)}function zn(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0;m=a[y>>2]|0,O=y+4|0,x=a[O>>2]|0,(m|0)<0&&(x=x-m|0,a[O>>2]=x,R=y+8|0,a[R>>2]=(a[R>>2]|0)-m,a[y>>2]=0,m=0),(x|0)<0?(m=m-x|0,a[y>>2]=m,R=y+8|0,I=(a[R>>2]|0)-x|0,a[R>>2]=I,a[O>>2]=0,x=0):(I=y+8|0,R=I,I=a[I>>2]|0),(I|0)<0&&(m=m-I|0,a[y>>2]=m,x=x-I|0,a[O>>2]=x,a[R>>2]=0,I=0),E=(x|0)<(m|0)?x:m,E=(I|0)<(E|0)?I:E,!((E|0)<=0)&&(a[y>>2]=m-E,a[O>>2]=x-E,a[R>>2]=I-E)}function Cs(y,m){y=y|0,m=m|0;var x=0,E=0;E=a[y+8>>2]|0,x=+((a[y+4>>2]|0)-E|0),G[m>>3]=+((a[y>>2]|0)-E|0)-x*.5,G[m+8>>3]=x*.8660254037844386}function si(y,m,x){y=y|0,m=m|0,x=x|0,a[x>>2]=(a[m>>2]|0)+(a[y>>2]|0),a[x+4>>2]=(a[m+4>>2]|0)+(a[y+4>>2]|0),a[x+8>>2]=(a[m+8>>2]|0)+(a[y+8>>2]|0)}function _o(y,m,x){y=y|0,m=m|0,x=x|0,a[x>>2]=(a[y>>2]|0)-(a[m>>2]|0),a[x+4>>2]=(a[y+4>>2]|0)-(a[m+4>>2]|0),a[x+8>>2]=(a[y+8>>2]|0)-(a[m+8>>2]|0)}function Ll(y,m){y=y|0,m=m|0;var x=0,E=0;x=an(a[y>>2]|0,m)|0,a[y>>2]=x,x=y+4|0,E=an(a[x>>2]|0,m)|0,a[x>>2]=E,y=y+8|0,m=an(a[y>>2]|0,m)|0,a[y>>2]=m}function Wo(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=a[y>>2]|0,U=(O|0)<0,E=(a[y+4>>2]|0)-(U?O:0)|0,R=(E|0)<0,I=(R?0-E|0:0)+((a[y+8>>2]|0)-(U?O:0))|0,x=(I|0)<0,y=x?0:I,m=(R?0:E)-(x?I:0)|0,I=(U?0:O)-(R?E:0)-(x?I:0)|0,x=(m|0)<(I|0)?m:I,x=(y|0)<(x|0)?y:x,E=(x|0)>0,y=y-(E?x:0)|0,m=m-(E?x:0)|0;e:do switch(I-(E?x:0)|0){case 0:switch(m|0){case 0:return U=y|0?(y|0)==1?1:7:0,U|0;case 1:return U=y|0?(y|0)==1?3:7:2,U|0;default:break e}case 1:switch(m|0){case 0:return U=y|0?(y|0)==1?5:7:4,U|0;case 1:{if(!y)y=6;else break e;return y|0}default:break e}}while(0);return U=7,U|0}function ya(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=y+8|0,I=a[O>>2]|0,R=(a[y>>2]|0)-I|0,U=y+4|0,I=(a[U>>2]|0)-I|0;do if(R>>>0>715827881|I>>>0>715827881){if(x=(R|0)>0,x){if((2147483647-R|0)<(R|0)||(2147483647-(R<<1)|0)<(R|0))return U=1,U|0}else if((-2147483648-R|0)>(R|0)||(-2147483648-(R<<1)|0)>(R|0))return U=1,U|0;if(m=R*3|0,(I|0)>0){if((2147483647-I|0)<(I|0))return U=1,U|0}else if((-2147483648-I|0)>(I|0))return U=1,U|0;if(E=I<<1,(R|0)>-1){if((m|-2147483648|0)>=(I|0))return U=1,U|0}else if((m^-2147483648|0)<(I|0))return U=1,U|0;if(x){if((2147483647-R|0)<(E|0))m=1;else{x=E;break}return m|0}else{if((-2147483648-R|0)>(E|0))m=1;else{x=E;break}return m|0}}else x=I<<1,m=R*3|0;while(0);E=c(+(m-I|0)/7)|0,a[y>>2]=E,I=c(+(x+R|0)/7)|0,a[U>>2]=I,a[O>>2]=0,x=(I|0)<(E|0),m=x?E:I,x=x?I:E;do if((x|0)<0){if((m|0)>0){if((m|-2147483648|0)<(x|0)&((x|0)!=-2147483648&(2147483647-m|0)>=(x|0)))break;cn(23313,22444,355,22455)}if((x|0)==-2147483648|(-2147483648-m|0)>(x|0)&&cn(23313,22444,355,22455),(m|0)>-1){if((m|-2147483648|0)<(x|0))break;cn(23313,22444,355,22455)}else{if((m^-2147483648|0)>=(x|0))break;cn(23313,22444,355,22455)}}while(0);return m=I-E|0,(E|0)<0?(x=0-E|0,a[U>>2]=m,a[O>>2]=x,a[y>>2]=0,E=0):(m=I,x=0),(m|0)<0&&(E=E-m|0,a[y>>2]=E,x=x-m|0,a[O>>2]=x,a[U>>2]=0,m=0),R=E-x|0,I=m-x|0,(x|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,m=I,I=R,x=0):I=E,E=(m|0)<(I|0)?m:I,E=(x|0)<(E|0)?x:E,(E|0)<=0?(U=0,U|0):(a[y>>2]=I-E,a[U>>2]=m-E,a[O>>2]=x-E,U=0,U|0)}function vo(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=y+8|0,I=a[O>>2]|0,R=(a[y>>2]|0)-I|0,U=y+4|0,I=(a[U>>2]|0)-I|0;do if(R>>>0>715827881|I>>>0>715827881){if(x=(R|0)>0,x){if((2147483647-R|0)<(R|0))return U=1,U|0}else if((-2147483648-R|0)>(R|0))return U=1,U|0;if(m=R<<1,(I|0)>0){if((2147483647-I|0)<(I|0)||(2147483647-(I<<1)|0)<(I|0))return U=1,U|0}else if((-2147483648-I|0)>(I|0)||(-2147483648-(I<<1)|0)>(I|0))return U=1,U|0;if(E=I*3|0,x){if((2147483647-m|0)<(I|0))return U=1,U|0}else if((-2147483648-m|0)>(I|0))return U=1,U|0;if((I|0)>-1){if((E|-2147483648|0)<(R|0)){x=E;break}else m=1;return m|0}else{if((E^-2147483648|0)<(R|0))m=1;else{x=E;break}return m|0}}else x=I*3|0,m=R<<1;while(0);E=c(+(m+I|0)/7)|0,a[y>>2]=E,I=c(+(x-R|0)/7)|0,a[U>>2]=I,a[O>>2]=0,x=(I|0)<(E|0),m=x?E:I,x=x?I:E;do if((x|0)<0){if((m|0)>0){if((m|-2147483648|0)<(x|0)&((x|0)!=-2147483648&(2147483647-m|0)>=(x|0)))break;cn(23313,22444,404,22469)}if((x|0)==-2147483648|(-2147483648-m|0)>(x|0)&&cn(23313,22444,404,22469),(m|0)>-1){if((m|-2147483648|0)<(x|0))break;cn(23313,22444,404,22469)}else{if((m^-2147483648|0)>=(x|0))break;cn(23313,22444,404,22469)}}while(0);return m=I-E|0,(E|0)<0?(x=0-E|0,a[U>>2]=m,a[O>>2]=x,a[y>>2]=0,E=0):(m=I,x=0),(m|0)<0&&(E=E-m|0,a[y>>2]=E,x=x-m|0,a[O>>2]=x,a[U>>2]=0,m=0),R=E-x|0,I=m-x|0,(x|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,m=I,I=R,x=0):I=E,E=(m|0)<(I|0)?m:I,E=(x|0)<(E|0)?x:E,(E|0)<=0?(U=0,U|0):(a[y>>2]=I-E,a[U>>2]=m-E,a[O>>2]=x-E,U=0,U|0)}function SA(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=y+8|0,x=a[O>>2]|0,m=(a[y>>2]|0)-x|0,U=y+4|0,x=(a[U>>2]|0)-x|0,E=c(+((m*3|0)-x|0)/7)|0,a[y>>2]=E,m=c(+((x<<1)+m|0)/7)|0,a[U>>2]=m,a[O>>2]=0,x=m-E|0,(E|0)<0?(R=0-E|0,a[U>>2]=x,a[O>>2]=R,a[y>>2]=0,m=x,E=0,x=R):x=0,(m|0)<0&&(E=E-m|0,a[y>>2]=E,x=x-m|0,a[O>>2]=x,a[U>>2]=0,m=0),R=E-x|0,I=m-x|0,(x|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,m=I,I=R,x=0):I=E,E=(m|0)<(I|0)?m:I,E=(x|0)<(E|0)?x:E,!((E|0)<=0)&&(a[y>>2]=I-E,a[U>>2]=m-E,a[O>>2]=x-E)}function qa(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;O=y+8|0,x=a[O>>2]|0,m=(a[y>>2]|0)-x|0,U=y+4|0,x=(a[U>>2]|0)-x|0,E=c(+((m<<1)+x|0)/7)|0,a[y>>2]=E,m=c(+((x*3|0)-m|0)/7)|0,a[U>>2]=m,a[O>>2]=0,x=m-E|0,(E|0)<0?(R=0-E|0,a[U>>2]=x,a[O>>2]=R,a[y>>2]=0,m=x,E=0,x=R):x=0,(m|0)<0&&(E=E-m|0,a[y>>2]=E,x=x-m|0,a[O>>2]=x,a[U>>2]=0,m=0),R=E-x|0,I=m-x|0,(x|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,m=I,I=R,x=0):I=E,E=(m|0)<(I|0)?m:I,E=(x|0)<(E|0)?x:E,!((E|0)<=0)&&(a[y>>2]=I-E,a[U>>2]=m-E,a[O>>2]=x-E)}function Qo(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;m=a[y>>2]|0,O=y+4|0,x=a[O>>2]|0,U=y+8|0,E=a[U>>2]|0,I=x+(m*3|0)|0,a[y>>2]=I,x=E+(x*3|0)|0,a[O>>2]=x,m=(E*3|0)+m|0,a[U>>2]=m,E=x-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=E,a[U>>2]=m,a[y>>2]=0,x=E,E=0):E=I,(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=I,a[U>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[O>>2]=I-x,a[U>>2]=m-x)}function Wi(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;I=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,U=y+8|0,x=a[U>>2]|0,E=(m*3|0)+I|0,I=x+(I*3|0)|0,a[y>>2]=I,a[O>>2]=E,m=(x*3|0)+m|0,a[U>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=x,a[U>>2]=m,a[y>>2]=0,I=0):x=E,(x|0)<0&&(I=I-x|0,a[y>>2]=I,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=I-m|0,E=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=E,a[U>>2]=0,I=R,m=0):E=x,x=(E|0)<(I|0)?E:I,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=I-x,a[O>>2]=E-x,a[U>>2]=m-x)}function Qi(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0;(m+-1|0)>>>0>=6||(I=(a[15440+(m*12|0)>>2]|0)+(a[y>>2]|0)|0,a[y>>2]=I,U=y+4|0,E=(a[15440+(m*12|0)+4>>2]|0)+(a[U>>2]|0)|0,a[U>>2]=E,O=y+8|0,m=(a[15440+(m*12|0)+8>>2]|0)+(a[O>>2]|0)|0,a[O>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[U>>2]=x,a[O>>2]=m,a[y>>2]=0,E=0):(x=E,E=I),(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[O>>2]=m,a[U>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[U>>2]=I,a[O>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[U>>2]=I-x,a[O>>2]=m-x))}function au(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;I=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,U=y+8|0,x=a[U>>2]|0,E=m+I|0,I=x+I|0,a[y>>2]=I,a[O>>2]=E,m=x+m|0,a[U>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=x,a[U>>2]=m,a[y>>2]=0,E=0):(x=E,E=I),(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=I,a[U>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[O>>2]=I-x,a[U>>2]=m-x)}function Dl(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;m=a[y>>2]|0,O=y+4|0,E=a[O>>2]|0,U=y+8|0,x=a[U>>2]|0,I=E+m|0,a[y>>2]=I,E=x+E|0,a[O>>2]=E,m=x+m|0,a[U>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=x,a[U>>2]=m,a[y>>2]=0,E=0):(x=E,E=I),(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=I,a[U>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[O>>2]=I-x,a[U>>2]=m-x)}function xo(y){switch(y=y|0,y|0){case 1:{y=5;break}case 5:{y=4;break}case 4:{y=6;break}case 6:{y=2;break}case 2:{y=3;break}case 3:{y=1;break}}return y|0}function qo(y){switch(y=y|0,y|0){case 1:{y=3;break}case 3:{y=2;break}case 2:{y=6;break}case 6:{y=4;break}case 4:{y=5;break}case 5:{y=1;break}}return y|0}function mc(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;m=a[y>>2]|0,O=y+4|0,x=a[O>>2]|0,U=y+8|0,E=a[U>>2]|0,I=x+(m<<1)|0,a[y>>2]=I,x=E+(x<<1)|0,a[O>>2]=x,m=(E<<1)+m|0,a[U>>2]=m,E=x-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=E,a[U>>2]=m,a[y>>2]=0,x=E,E=0):E=I,(x|0)<0&&(E=E-x|0,a[y>>2]=E,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=E-m|0,I=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=I,a[U>>2]=0,E=R,m=0):I=x,x=(I|0)<(E|0)?I:E,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=E-x,a[O>>2]=I-x,a[U>>2]=m-x)}function lu(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;I=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,U=y+8|0,x=a[U>>2]|0,E=(m<<1)+I|0,I=x+(I<<1)|0,a[y>>2]=I,a[O>>2]=E,m=(x<<1)+m|0,a[U>>2]=m,x=E-I|0,(I|0)<0?(m=m-I|0,a[O>>2]=x,a[U>>2]=m,a[y>>2]=0,I=0):x=E,(x|0)<0&&(I=I-x|0,a[y>>2]=I,m=m-x|0,a[U>>2]=m,a[O>>2]=0,x=0),R=I-m|0,E=x-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=E,a[U>>2]=0,I=R,m=0):E=x,x=(E|0)<(I|0)?E:I,x=(m|0)<(x|0)?m:x,!((x|0)<=0)&&(a[y>>2]=I-x,a[O>>2]=E-x,a[U>>2]=m-x)}function Rl(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0;return O=(a[y>>2]|0)-(a[m>>2]|0)|0,U=(O|0)<0,E=(a[y+4>>2]|0)-(a[m+4>>2]|0)-(U?O:0)|0,R=(E|0)<0,I=(U?0-O|0:0)+(a[y+8>>2]|0)-(a[m+8>>2]|0)+(R?0-E|0:0)|0,y=(I|0)<0,m=y?0:I,x=(R?0:E)-(y?I:0)|0,I=(U?0:O)-(R?E:0)-(y?I:0)|0,y=(x|0)<(I|0)?x:I,y=(m|0)<(y|0)?m:y,E=(y|0)>0,m=m-(E?y:0)|0,x=x-(E?y:0)|0,y=I-(E?y:0)|0,y=(y|0)>-1?y:0-y|0,x=(x|0)>-1?x:0-x|0,m=(m|0)>-1?m:0-m|0,m=(x|0)>(m|0)?x:m,((y|0)>(m|0)?y:m)|0}function CA(y,m){y=y|0,m=m|0;var x=0;x=a[y+8>>2]|0,a[m>>2]=(a[y>>2]|0)-x,a[m+4>>2]=(a[y+4>>2]|0)-x}function Au(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0;E=a[y>>2]|0,a[m>>2]=E,I=a[y+4>>2]|0,O=m+4|0,a[O>>2]=I,U=m+8|0,a[U>>2]=0,x=(I|0)<(E|0),y=x?E:I,x=x?I:E;do if((x|0)<0){if((y|0)>0){if((y|-2147483648|0)<(x|0)&((x|0)!=-2147483648&(2147483647-y|0)>=(x|0)))break;return y=1,y|0}if((x|0)==-2147483648|(-2147483648-y|0)>(x|0))return m=1,m|0;if((y|0)>-1){if((y|-2147483648|0)<(x|0))break;return y=1,y|0}else{if((y^-2147483648|0)<(x|0))y=1;else break;return y|0}}while(0);return y=I-E|0,(E|0)<0?(x=0-E|0,a[O>>2]=y,a[U>>2]=x,a[m>>2]=0,E=0):(y=I,x=0),(y|0)<0&&(E=E-y|0,a[m>>2]=E,x=x-y|0,a[U>>2]=x,a[O>>2]=0,y=0),R=E-x|0,I=y-x|0,(x|0)<0?(a[m>>2]=R,a[O>>2]=I,a[U>>2]=0,y=I,I=R,x=0):I=E,E=(y|0)<(I|0)?y:I,E=(x|0)<(E|0)?x:E,(E|0)<=0?(m=0,m|0):(a[m>>2]=I-E,a[O>>2]=y-E,a[U>>2]=x-E,m=0,m|0)}function Zo(y){y=y|0;var m=0,x=0,E=0,I=0;m=y+8|0,I=a[m>>2]|0,x=I-(a[y>>2]|0)|0,a[y>>2]=x,E=y+4|0,y=(a[E>>2]|0)-I|0,a[E>>2]=y,a[m>>2]=0-(y+x)}function Za(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;x=a[y>>2]|0,m=0-x|0,a[y>>2]=m,O=y+8|0,a[O>>2]=0,U=y+4|0,E=a[U>>2]|0,I=E+x|0,(x|0)>0?(a[U>>2]=I,a[O>>2]=x,a[y>>2]=0,m=0,E=I):x=0,(E|0)<0?(R=m-E|0,a[y>>2]=R,x=x-E|0,a[O>>2]=x,a[U>>2]=0,I=R-x|0,m=0-x|0,(x|0)<0?(a[y>>2]=I,a[U>>2]=m,a[O>>2]=0,E=m,x=0):(E=0,I=R)):I=m,m=(E|0)<(I|0)?E:I,m=(x|0)<(m|0)?x:m,!((m|0)<=0)&&(a[y>>2]=I-m,a[U>>2]=E-m,a[O>>2]=x-m)}function uu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0;if(de=we,we=we+64|0,le=de,U=de+56|0,!(!0&(m&2013265920|0)==134217728&(!0&(E&2013265920|0)==134217728)))return I=5,we=de,I|0;if((y|0)==(x|0)&(m|0)==(E|0))return a[I>>2]=0,I=0,we=de,I|0;if(O=ne(y|0,m|0,52)|0,Ce()|0,O=O&15,ee=ne(x|0,E|0,52)|0,Ce()|0,(O|0)!=(ee&15|0))return I=12,we=de,I|0;if(R=O+-1|0,O>>>0>1){Ol(y,m,R,le)|0,Ol(x,E,R,U)|0,ee=le,q=a[ee>>2]|0,ee=a[ee+4>>2]|0;e:do if((q|0)==(a[U>>2]|0)&&(ee|0)==(a[U+4>>2]|0)){O=(O^15)*3|0,R=ne(y|0,m|0,O|0)|0,Ce()|0,R=R&7,O=ne(x|0,E|0,O|0)|0,Ce()|0,O=O&7;do if((R|0)==0|(O|0)==0)a[I>>2]=1,R=0;else if((R|0)==7)R=5;else{if((R|0)==1|(O|0)==1&&gr(q,ee)|0){R=5;break}if((a[15536+(R<<2)>>2]|0)!=(O|0)&&(a[15568+(R<<2)>>2]|0)!=(O|0))break e;a[I>>2]=1,R=0}while(0);return I=R,we=de,I|0}while(0)}R=le,O=R+56|0;do a[R>>2]=0,R=R+4|0;while((R|0)<(O|0));return ma(y,m,1,le)|0,m=le,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0))&&(m=le+8|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+16|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+24|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+32|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+40|0,!((a[m>>2]|0)==(x|0)&&(a[m+4>>2]|0)==(E|0)))?(R=le+48|0,R=((a[R>>2]|0)==(x|0)?(a[R+4>>2]|0)==(E|0):0)&1):R=1,a[I>>2]=R,I=0,we=de,I|0}function cu(y,m,x,E,I){return y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,x=lt(y,m,x,E)|0,(x|0)==7?(I=11,I|0):(E=ue(x|0,0,56)|0,m=m&-2130706433|(Ce()|0)|268435456,a[I>>2]=y|E,a[I+4>>2]=m,I=0,I|0)}function wo(y,m,x){return y=y|0,m=m|0,x=x|0,!0&(m&2013265920|0)==268435456?(a[x>>2]=y,a[x+4>>2]=m&-2130706433|134217728,x=0,x|0):(x=6,x|0)}function _a(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;return I=we,we=we+16|0,E=I,a[E>>2]=0,!0&(m&2013265920|0)==268435456?(R=ne(y|0,m|0,56)|0,Ce()|0,E=Ne(y,m&-2130706433|134217728,R&7,E,x)|0,we=I,E|0):(E=6,we=I,E|0)}function hu(y,m){y=y|0,m=m|0;var x=0;switch(x=ne(y|0,m|0,56)|0,Ce()|0,x&7){case 0:case 7:return x=0,x|0}return x=m&-2130706433|134217728,!(!0&(m&2013265920|0)==268435456)||!0&(m&117440512|0)==16777216&(gr(y,x)|0)!=0?(x=0,x|0):(x=xa(y,x)|0,x|0)}function va(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;return I=we,we=we+16|0,E=I,!0&(m&2013265920|0)==268435456?(R=m&-2130706433|134217728,O=x,a[O>>2]=y,a[O+4>>2]=R,a[E>>2]=0,m=ne(y|0,m|0,56)|0,Ce()|0,E=Ne(y,R,m&7,E,x+8|0)|0,we=I,E|0):(E=6,we=I,E|0)}function fr(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;return I=(gr(y,m)|0)==0,m=m&-2130706433,E=x,a[E>>2]=I?y:0,a[E+4>>2]=I?m|285212672:0,E=x+8|0,a[E>>2]=y,a[E+4>>2]=m|301989888,E=x+16|0,a[E>>2]=y,a[E+4>>2]=m|318767104,E=x+24|0,a[E>>2]=y,a[E+4>>2]=m|335544320,E=x+32|0,a[E>>2]=y,a[E+4>>2]=m|352321536,x=x+40|0,a[x>>2]=y,a[x+4>>2]=m|369098752,0}function $s(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;return O=we,we=we+16|0,I=O,R=m&-2130706433|134217728,!0&(m&2013265920|0)==268435456?(E=ne(y|0,m|0,56)|0,Ce()|0,E=Xt(y,R,E&7)|0,(E|0)==-1?(a[x>>2]=0,R=6,we=O,R|0):(Ki(y,R,I)|0&&cn(23313,22484,282,22499),m=ne(y|0,m|0,52)|0,Ce()|0,m=m&15,gr(y,R)|0?Yo(I,m,E,2,x):fu(I,m,E,2,x),R=0,we=O,R|0)):(R=6,we=O,R|0)}function $n(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;E=we,we=we+16|0,I=E,qn(y,m,x,I),Ho(I,x+4|0),we=E}function qn(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0;if(U=we,we=we+16|0,q=U,br(y,x,q),R=+Rt(+(1-+G[q>>3]*.5)),R<1e-16){a[E>>2]=0,a[E+4>>2]=0,a[E+8>>2]=0,a[E+12>>2]=0,we=U;return}if(q=a[x>>2]|0,I=+G[15920+(q*24|0)>>3],I=+ai(I-+ai(+bc(15600+(q<<4)|0,y))),Ei(m)|0?O=+ai(I+-.3334731722518321):O=I,I=+Dt(+R)/.381966011250105,(m|0)>0){y=0;do I=I*2.6457513110645907,y=y+1|0;while((y|0)!=(m|0))}R=+We(+O)*I,G[E>>3]=R,O=+dt(+O)*I,G[E+8>>3]=O,we=U}function br(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if(R=we,we=we+32|0,I=R,Wl(y,I),a[m>>2]=0,G[x>>3]=5,E=+mr(16400,I),E<+G[x>>3]&&(a[m>>2]=0,G[x>>3]=E),E=+mr(16424,I),E<+G[x>>3]&&(a[m>>2]=1,G[x>>3]=E),E=+mr(16448,I),E<+G[x>>3]&&(a[m>>2]=2,G[x>>3]=E),E=+mr(16472,I),E<+G[x>>3]&&(a[m>>2]=3,G[x>>3]=E),E=+mr(16496,I),E<+G[x>>3]&&(a[m>>2]=4,G[x>>3]=E),E=+mr(16520,I),E<+G[x>>3]&&(a[m>>2]=5,G[x>>3]=E),E=+mr(16544,I),E<+G[x>>3]&&(a[m>>2]=6,G[x>>3]=E),E=+mr(16568,I),E<+G[x>>3]&&(a[m>>2]=7,G[x>>3]=E),E=+mr(16592,I),E<+G[x>>3]&&(a[m>>2]=8,G[x>>3]=E),E=+mr(16616,I),E<+G[x>>3]&&(a[m>>2]=9,G[x>>3]=E),E=+mr(16640,I),E<+G[x>>3]&&(a[m>>2]=10,G[x>>3]=E),E=+mr(16664,I),E<+G[x>>3]&&(a[m>>2]=11,G[x>>3]=E),E=+mr(16688,I),E<+G[x>>3]&&(a[m>>2]=12,G[x>>3]=E),E=+mr(16712,I),E<+G[x>>3]&&(a[m>>2]=13,G[x>>3]=E),E=+mr(16736,I),E<+G[x>>3]&&(a[m>>2]=14,G[x>>3]=E),E=+mr(16760,I),E<+G[x>>3]&&(a[m>>2]=15,G[x>>3]=E),E=+mr(16784,I),E<+G[x>>3]&&(a[m>>2]=16,G[x>>3]=E),E=+mr(16808,I),E<+G[x>>3]&&(a[m>>2]=17,G[x>>3]=E),E=+mr(16832,I),E<+G[x>>3]&&(a[m>>2]=18,G[x>>3]=E),E=+mr(16856,I),!(E<+G[x>>3])){we=R;return}a[m>>2]=19,G[x>>3]=E,we=R}function pr(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0;if(R=+Sc(y),R<1e-16){m=15600+(m<<4)|0,a[I>>2]=a[m>>2],a[I+4>>2]=a[m+4>>2],a[I+8>>2]=a[m+8>>2],a[I+12>>2]=a[m+12>>2];return}if(O=+pn(+ +G[y+8>>3],+ +G[y>>3]),(x|0)>0){y=0;do R=R/2.6457513110645907,y=y+1|0;while((y|0)!=(x|0))}E?(R=R/3,x=(Ei(x)|0)==0,R=+jt(+((x?R:R/2.6457513110645907)*.381966011250105))):(R=+jt(+(R*.381966011250105)),Ei(x)|0&&(O=+ai(O+.3334731722518321))),Eo(15600+(m<<4)|0,+ai(+G[15920+(m*24|0)>>3]-O),R,I)}function Bl(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;E=we,we=we+16|0,I=E,Cs(y+4|0,I),pr(I,a[y>>2]|0,m,0,x),we=E}function Yo(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,gt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,ar=0,kn=0;if(Dn=we,we=we+272|0,R=Dn+256|0,st=Dn+240|0,mn=Dn,_n=Dn+224|0,En=Dn+208|0,ot=Dn+176|0,Je=Dn+160|0,Gt=Dn+192|0,zt=Dn+144|0,gt=Dn+128|0,vt=Dn+112|0,Pn=Dn+96|0,wn=Dn+80|0,a[R>>2]=m,a[st>>2]=a[y>>2],a[st+4>>2]=a[y+4>>2],a[st+8>>2]=a[y+8>>2],a[st+12>>2]=a[y+12>>2],yc(st,R,mn),a[I>>2]=0,st=E+x+((E|0)==5&1)|0,(st|0)<=(x|0)){we=Dn;return}q=a[R>>2]|0,ee=_n+4|0,le=ot+4|0,de=x+5|0,Re=16880+(q<<2)|0,je=16960+(q<<2)|0,Be=gt+8|0,Ke=vt+8|0,ft=Pn+8|0,ct=En+4|0,U=x;e:for(;;){O=mn+(((U|0)%5|0)<<4)|0,a[En>>2]=a[O>>2],a[En+4>>2]=a[O+4>>2],a[En+8>>2]=a[O+8>>2],a[En+12>>2]=a[O+12>>2];do;while((Ya(En,q,0,1)|0)==2);if((U|0)>(x|0)&(Ei(m)|0)!=0){if(a[ot>>2]=a[En>>2],a[ot+4>>2]=a[En+4>>2],a[ot+8>>2]=a[En+8>>2],a[ot+12>>2]=a[En+12>>2],Cs(ee,Je),E=a[ot>>2]|0,R=a[17040+(E*80|0)+(a[_n>>2]<<2)>>2]|0,a[ot>>2]=a[18640+(E*80|0)+(R*20|0)>>2],O=a[18640+(E*80|0)+(R*20|0)+16>>2]|0,(O|0)>0){y=0;do au(le),y=y+1|0;while((y|0)<(O|0))}switch(O=18640+(E*80|0)+(R*20|0)+4|0,a[Gt>>2]=a[O>>2],a[Gt+4>>2]=a[O+4>>2],a[Gt+8>>2]=a[O+8>>2],Ll(Gt,(a[Re>>2]|0)*3|0),si(le,Gt,le),zn(le),Cs(le,zt),ar=+(a[je>>2]|0),G[gt>>3]=ar*3,G[Be>>3]=0,kn=ar*-1.5,G[vt>>3]=kn,G[Ke>>3]=ar*2.598076211353316,G[Pn>>3]=kn,G[ft>>3]=ar*-2.598076211353316,a[17040+((a[ot>>2]|0)*80|0)+(a[En>>2]<<2)>>2]|0){case 1:{y=vt,E=gt;break}case 3:{y=Pn,E=vt;break}case 2:{y=gt,E=Pn;break}default:{y=12;break e}}Eu(Je,zt,E,y,wn),pr(wn,a[ot>>2]|0,q,1,I+8+(a[I>>2]<<4)|0),a[I>>2]=(a[I>>2]|0)+1}if((U|0)<(de|0)&&(Cs(ct,ot),pr(ot,a[En>>2]|0,q,1,I+8+(a[I>>2]<<4)|0),a[I>>2]=(a[I>>2]|0)+1),a[_n>>2]=a[En>>2],a[_n+4>>2]=a[En+4>>2],a[_n+8>>2]=a[En+8>>2],a[_n+12>>2]=a[En+12>>2],U=U+1|0,(U|0)>=(st|0)){y=3;break}}if((y|0)==3){we=Dn;return}else(y|0)==12&&cn(22522,22569,571,22579)}function yc(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0;q=we,we=we+128|0,E=q+64|0,I=q,R=E,O=20240,U=R+60|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(U|0));R=I,O=20304,U=R+60|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(U|0));U=(Ei(a[m>>2]|0)|0)==0,E=U?E:I,I=y+4|0,mc(I),lu(I),Ei(a[m>>2]|0)|0&&(Wi(I),a[m>>2]=(a[m>>2]|0)+1),a[x>>2]=a[y>>2],m=x+4|0,si(I,E,m),zn(m),a[x+16>>2]=a[y>>2],m=x+20|0,si(I,E+12|0,m),zn(m),a[x+32>>2]=a[y>>2],m=x+36|0,si(I,E+24|0,m),zn(m),a[x+48>>2]=a[y>>2],m=x+52|0,si(I,E+36|0,m),zn(m),a[x+64>>2]=a[y>>2],x=x+68|0,si(I,E+48|0,x),zn(x),we=q}function Ya(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0;if(Be=we,we=we+32|0,Re=Be+12|0,U=Be,je=y+4|0,de=a[16960+(m<<2)>>2]|0,le=(E|0)!=0,de=le?de*3|0:de,I=a[je>>2]|0,ee=y+8|0,O=a[ee>>2]|0,le){if(R=y+12|0,E=a[R>>2]|0,I=O+I+E|0,(I|0)==(de|0))return je=1,we=Be,je|0;q=R}else q=y+12|0,E=a[q>>2]|0,I=O+I+E|0;if((I|0)<=(de|0))return je=0,we=Be,je|0;do if((E|0)>0){if(E=a[y>>2]|0,(O|0)>0){R=18640+(E*80|0)+60|0,E=y;break}E=18640+(E*80|0)+40|0,x?(Yr(Re,de,0,0),_o(je,Re,U),Dl(U),si(U,Re,je),R=E,E=y):(R=E,E=y)}else R=18640+((a[y>>2]|0)*80|0)+20|0,E=y;while(0);if(a[E>>2]=a[R>>2],I=R+16|0,(a[I>>2]|0)>0){E=0;do au(je),E=E+1|0;while((E|0)<(a[I>>2]|0))}return y=R+4|0,a[Re>>2]=a[y>>2],a[Re+4>>2]=a[y+4>>2],a[Re+8>>2]=a[y+8>>2],m=a[16880+(m<<2)>>2]|0,Ll(Re,le?m*3|0:m),si(je,Re,je),zn(je),le?E=((a[ee>>2]|0)+(a[je>>2]|0)+(a[q>>2]|0)|0)==(de|0)?1:2:E=2,je=E,we=Be,je|0}function _c(y,m){y=y|0,m=m|0;var x=0;do x=Ya(y,m,0,1)|0;while((x|0)==2);return x|0}function fu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,gt=0,vt=0,Pn=0,wn=0,mn=0;if(Pn=we,we=we+240|0,R=Pn+224|0,Gt=Pn+208|0,zt=Pn,gt=Pn+192|0,vt=Pn+176|0,ft=Pn+160|0,ct=Pn+144|0,st=Pn+128|0,ot=Pn+112|0,Je=Pn+96|0,a[R>>2]=m,a[Gt>>2]=a[y>>2],a[Gt+4>>2]=a[y+4>>2],a[Gt+8>>2]=a[y+8>>2],a[Gt+12>>2]=a[y+12>>2],js(Gt,R,zt),a[I>>2]=0,Ke=E+x+((E|0)==6&1)|0,(Ke|0)<=(x|0)){we=Pn;return}q=a[R>>2]|0,ee=x+6|0,le=16960+(q<<2)|0,de=ct+8|0,Re=st+8|0,je=ot+8|0,Be=gt+4|0,O=0,U=x,E=-1;e:for(;;){if(R=(U|0)%6|0,y=zt+(R<<4)|0,a[gt>>2]=a[y>>2],a[gt+4>>2]=a[y+4>>2],a[gt+8>>2]=a[y+8>>2],a[gt+12>>2]=a[y+12>>2],y=O,O=Ya(gt,q,0,1)|0,(U|0)>(x|0)&(Ei(m)|0)!=0&&(y|0)!=1&&(a[gt>>2]|0)!=(E|0)){switch(Cs(zt+(((R+5|0)%6|0)<<4)+4|0,vt),Cs(zt+(R<<4)+4|0,ft),wn=+(a[le>>2]|0),G[ct>>3]=wn*3,G[de>>3]=0,mn=wn*-1.5,G[st>>3]=mn,G[Re>>3]=wn*2.598076211353316,G[ot>>3]=mn,G[je>>3]=wn*-2.598076211353316,R=a[Gt>>2]|0,a[17040+(R*80|0)+(((E|0)==(R|0)?a[gt>>2]|0:E)<<2)>>2]|0){case 1:{y=st,E=ct;break}case 3:{y=ot,E=st;break}case 2:{y=ct,E=ot;break}default:{y=8;break e}}Eu(vt,ft,E,y,Je),!(Cc(vt,Je)|0)&&!(Cc(ft,Je)|0)&&(pr(Je,a[Gt>>2]|0,q,1,I+8+(a[I>>2]<<4)|0),a[I>>2]=(a[I>>2]|0)+1)}if((U|0)<(ee|0)&&(Cs(Be,vt),pr(vt,a[gt>>2]|0,q,1,I+8+(a[I>>2]<<4)|0),a[I>>2]=(a[I>>2]|0)+1),U=U+1|0,(U|0)>=(Ke|0)){y=3;break}else E=a[gt>>2]|0}if((y|0)==3){we=Pn;return}else(y|0)==8&&cn(22606,22569,736,22651)}function js(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0;q=we,we=we+160|0,E=q+80|0,I=q,R=E,O=20368,U=R+72|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(U|0));R=I,O=20448,U=R+72|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(U|0));U=(Ei(a[m>>2]|0)|0)==0,E=U?E:I,I=y+4|0,mc(I),lu(I),Ei(a[m>>2]|0)|0&&(Wi(I),a[m>>2]=(a[m>>2]|0)+1),a[x>>2]=a[y>>2],m=x+4|0,si(I,E,m),zn(m),a[x+16>>2]=a[y>>2],m=x+20|0,si(I,E+12|0,m),zn(m),a[x+32>>2]=a[y>>2],m=x+36|0,si(I,E+24|0,m),zn(m),a[x+48>>2]=a[y>>2],m=x+52|0,si(I,E+36|0,m),zn(m),a[x+64>>2]=a[y>>2],m=x+68|0,si(I,E+48|0,m),zn(m),a[x+80>>2]=a[y>>2],x=x+84|0,si(I,E+60|0,x),zn(x),we=q}function zl(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,52)|0,Ce()|0,m&15|0}function Xa(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,45)|0,Ce()|0,m&127|0}function xa(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0;if(!(!0&(m&-16777216|0)==134217728)||(O=ne(y|0,m|0,45)|0,Ce()|0,O=O&127,O>>>0>121))return m=0,m|0;x=ne(y|0,m|0,52)|0,Ce()|0,x=x&15;do if(x|0){for(I=1,E=0;;){if(R=ne(y|0,m|0,(15-I|0)*3|0)|0,Ce()|0,R=R&7,(R|0)!=0&(E^1))if((R|0)==1&(Gn(O)|0)!=0){U=0,E=13;break}else E=1;if((R|0)==7){U=0,E=13;break}if(I>>>0<x>>>0)I=I+1|0;else{E=9;break}}if((E|0)==9){if((x|0)==15)U=1;else break;return U|0}else if((E|0)==13)return U|0}while(0);for(;;){if(U=ne(y|0,m|0,(14-x|0)*3|0)|0,Ce()|0,!((U&7|0)==7&!0)){U=0,E=13;break}if(x>>>0<14)x=x+1|0;else{U=1,E=13;break}}return(E|0)==13?U|0:0}function Ol(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0;if(R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,x>>>0>15)return E=4,E|0;if((R|0)<(x|0))return E=12,E|0;if((R|0)==(x|0))return a[E>>2]=y,a[E+4>>2]=m,E=0,E|0;if(I=ue(x|0,0,52)|0,I=I|y,y=Ce()|0|m&-15728641,(R|0)>(x|0))do m=ue(7,0,(14-x|0)*3|0)|0,x=x+1|0,I=m|I,y=Ce()|0|y;while((x|0)<(R|0));return a[E>>2]=I,a[E+4>>2]=y,E=0,E|0}function Fl(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0;if(R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,!((x|0)<16&(R|0)<=(x|0)))return E=4,E|0;I=x-R|0,x=ne(y|0,m|0,45)|0,Ce()|0;e:do if(!(Gn(x&127)|0))x=qs(7,0,I,((I|0)<0)<<31>>31)|0,I=Ce()|0;else{t:do if(R|0){for(x=1;O=ue(7,0,(15-x|0)*3|0)|0,!!((O&y|0)==0&((Ce()|0)&m|0)==0);)if(x>>>0<R>>>0)x=x+1|0;else break t;x=qs(7,0,I,((I|0)<0)<<31>>31)|0,I=Ce()|0;break e}while(0);x=qs(7,0,I,((I|0)<0)<<31>>31)|0,x=V(x|0,Ce()|0,5,0)|0,x=d(x|0,Ce()|0,-5,-1)|0,x=P(x|0,Ce()|0,6,0)|0,x=d(x|0,Ce()|0,1,0)|0,I=Ce()|0}while(0);return O=E,a[O>>2]=x,a[O+4>>2]=I,O=0,O|0}function gr(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;if(I=ne(y|0,m|0,45)|0,Ce()|0,!(Gn(I&127)|0))return I=0,I|0;I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15;e:do if(!I)x=0;else for(E=1;;){if(x=ne(y|0,m|0,(15-E|0)*3|0)|0,Ce()|0,x=x&7,x|0)break e;if(E>>>0<I>>>0)E=E+1|0;else{x=0;break}}while(0);return I=(x|0)==0&1,I|0}function MA(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0;if(O=we,we=we+16|0,R=O,ba(R,y,m,x),m=R,y=a[m>>2]|0,m=a[m+4>>2]|0,(y|0)==0&(m|0)==0)return we=O,0;I=0,x=0;do U=E+(I<<3)|0,a[U>>2]=y,a[U+4>>2]=m,I=d(I|0,x|0,1,0)|0,x=Ce()|0,el(R),U=R,y=a[U>>2]|0,m=a[U+4>>2]|0;while(!((y|0)==0&(m|0)==0));return we=O,0}function cs(y,m,x,E){return y=y|0,m=m|0,x=x|0,E=E|0,(E|0)<(x|0)?(x=m,E=y,Mt(x|0),E|0):(x=ue(-1,-1,((E-x|0)*3|0)+3|0)|0,E=ue(~x|0,~(Ce()|0)|0,(15-E|0)*3|0)|0,x=~(Ce()|0)&m,E=~E&y,Mt(x|0),E|0)}function du(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0;return I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15,(x|0)<16&(I|0)<=(x|0)?((I|0)<(x|0)&&(I=ue(-1,-1,((x+-1-I|0)*3|0)+3|0)|0,I=ue(~I|0,~(Ce()|0)|0,(15-x|0)*3|0)|0,m=~(Ce()|0)&m,y=~I&y),I=ue(x|0,0,52)|0,x=m&-15728641|(Ce()|0),a[E>>2]=y|I,a[E+4>>2]=x,E=0,E|0):(E=4,E|0)}function Nl(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,gt=0,vt=0;if((x|0)==0&(E|0)==0)return gt=0,gt|0;if(I=y,R=a[I>>2]|0,I=a[I+4>>2]|0,!0&(I&15728640|0)==0){if(!((E|0)>0|(E|0)==0&x>>>0>0)||(gt=m,a[gt>>2]=R,a[gt+4>>2]=I,(x|0)==1&(E|0)==0))return gt=0,gt|0;I=1;do Gt=y+(I<<3)|0,zt=a[Gt+4>>2]|0,gt=m+(I<<3)|0,a[gt>>2]=a[Gt>>2],a[gt+4>>2]=zt,I=I+1|0;while(0<(E|0)|(E|0)==0&I>>>0<x>>>0);return I=0,I|0}if(Je=x<<3,zt=_(Je)|0,!zt)return gt=13,gt|0;if($e(zt|0,y|0,Je|0)|0,Gt=h(x,8)|0,!Gt)return A(zt),gt=13,gt|0;e:do if(x|0){t:for(;;){I=zt,ct=a[I>>2]|0,I=a[I+4>>2]|0,st=ne(ct|0,I|0,52)|0,Ce()|0,st=st&15,ot=st+-1|0,ft=(x|0)>0;n:do if((st|0)!=0&ft){if(je=((x|0)<0)<<31>>31,Be=ue(ot|0,0,52)|0,Ke=Ce()|0,ot>>>0>15){if(!((ct|0)==0&(I|0)==0)){gt=17;break t}for(R=0;;){if(R=R+1|0,(R|0)>=(x|0))break n;if(E=zt+(R<<3)|0,Ke=a[E>>2]|0,E=a[E+4>>2]|0,!((Ke|0)==0&(E|0)==0)){I=E,gt=17;break t}}}for(R=0,y=ct,E=I;;){if(!((y|0)==0&(E|0)==0)){if(!(!0&(E&117440512|0)==0)){gt=22;break t}if(U=ne(y|0,E|0,52)|0,Ce()|0,U=U&15,(U|0)<(ot|0)){I=12,gt=28;break t}if((U|0)!=(ot|0)&&(y=y|Be,E=E&-15728641|Ke,U>>>0>=st>>>0)){O=ot;do Re=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,y=Re|y,E=Ce()|0|E;while(O>>>0<U>>>0)}if(O=X(y|0,E|0,x|0,je|0)|0,Ce()|0,ee=Gt+(O<<3)|0,U=ee,q=a[U>>2]|0,U=a[U+4>>2]|0,(q|0)==0&(U|0)==0)O=ee;else for(Re=0;;){if((Re|0)>(x|0)){gt=32;break t}if((q|0)==(y|0)&(U&-117440513|0)==(E|0)){le=ne(q|0,U|0,56)|0,Ce()|0,le=le&7,de=le+1|0,vt=ne(q|0,U|0,45)|0,Ce()|0;r:do if(!(Gn(vt&127)|0))U=7;else{if(q=ne(q|0,U|0,52)|0,Ce()|0,q=q&15,!q){U=6;break}for(U=1;;){if(vt=ue(7,0,(15-U|0)*3|0)|0,!((vt&y|0)==0&((Ce()|0)&E|0)==0)){U=7;break r}if(U>>>0<q>>>0)U=U+1|0;else{U=6;break}}}while(0);if((le+2|0)>>>0>U>>>0){gt=42;break t}vt=ue(de|0,0,56)|0,E=Ce()|0|E&-117440513,de=ee,a[de>>2]=0,a[de+4>>2]=0,y=vt|y}else O=(O+1|0)%(x|0)|0;if(ee=Gt+(O<<3)|0,U=ee,q=a[U>>2]|0,U=a[U+4>>2]|0,(q|0)==0&(U|0)==0){O=ee;break}else Re=Re+1|0}vt=O,a[vt>>2]=y,a[vt+4>>2]=E}if(R=R+1|0,(R|0)>=(x|0))break n;E=zt+(R<<3)|0,y=a[E>>2]|0,E=a[E+4>>2]|0}}while(0);if((x+5|0)>>>0<11){gt=85;break}if(Ke=h((x|0)/6|0,8)|0,!Ke){gt=49;break}n:do if(ft){Re=0,de=0;do{if(U=Gt+(Re<<3)|0,E=U,R=a[E>>2]|0,E=a[E+4>>2]|0,!((R|0)==0&(E|0)==0)){q=ne(R|0,E|0,56)|0,Ce()|0,q=q&7,y=q+1|0,ee=E&-117440513,vt=ne(R|0,E|0,45)|0,Ce()|0;r:do if(Gn(vt&127)|0){if(le=ne(R|0,E|0,52)|0,Ce()|0,le=le&15,le|0)for(O=1;;){if(vt=ue(7,0,(15-O|0)*3|0)|0,!((R&vt|0)==0&(ee&(Ce()|0)|0)==0))break r;if(O>>>0<le>>>0)O=O+1|0;else break}E=ue(y|0,0,56)|0,R=E|R,E=Ce()|0|ee,y=U,a[y>>2]=R,a[y+4>>2]=E,y=q+2|0}while(0);(y|0)==7&&(vt=Ke+(de<<3)|0,a[vt>>2]=R,a[vt+4>>2]=E&-117440513,de=de+1|0)}Re=Re+1|0}while((Re|0)!=(x|0));if(ft){if(Re=((x|0)<0)<<31>>31,je=ue(ot|0,0,52)|0,Be=Ce()|0,ot>>>0>15){if(!((ct|0)==0&(I|0)==0)){I=4,gt=84;break t}for(I=0;;){if(I=I+1|0,(I|0)>=(x|0)){R=0,I=de;break n}if(vt=zt+(I<<3)|0,!((a[vt>>2]|0)==0&(a[vt+4>>2]|0)==0)){I=4,gt=84;break t}}}for(le=0,R=0,ee=ct;;){do if(!((ee|0)==0&(I|0)==0)){if(U=ne(ee|0,I|0,52)|0,Ce()|0,U=U&15,(U|0)<(ot|0)){I=12,gt=84;break t}do if((U|0)==(ot|0))E=ee,U=I;else{if(E=ee|je,y=I&-15728641|Be,U>>>0<st>>>0){U=y;break}O=ot;do vt=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,E=vt|E,y=Ce()|0|y;while(O>>>0<U>>>0);U=y}while(0);for(O=X(E|0,U|0,x|0,Re|0)|0,Ce()|0,y=0;;){if((y|0)>(x|0)){gt=77;break t}if(vt=Gt+(O<<3)|0,q=a[vt+4>>2]|0,(q&-117440513|0)==(U|0)&&(a[vt>>2]|0)==(E|0)){gt=79;break}if(O=(O+1|0)%(x|0)|0,vt=Gt+(O<<3)|0,(a[vt>>2]|0)==(E|0)&&(a[vt+4>>2]|0)==(U|0))break;y=y+1|0}if((gt|0)==79&&(gt=0,!0&(q&117440512|0)==100663296))break;vt=m+(R<<3)|0,a[vt>>2]=ee,a[vt+4>>2]=I,R=R+1|0}while(0);if(I=le+1|0,(I|0)>=(x|0)){I=de;break n}vt=zt+(I<<3)|0,le=I,ee=a[vt>>2]|0,I=a[vt+4>>2]|0}}else R=0,I=de}else R=0,I=0;while(0);if(Se(Gt|0,0,Je|0)|0,$e(zt|0,Ke|0,I<<3|0)|0,A(Ke),I)m=m+(R<<3)|0,x=I;else break e}if((gt|0)==17)!0&(I&117440512|0)==0?(I=4,gt=28):gt=22;else if((gt|0)==32)cn(23313,22674,362,22684);else{if((gt|0)==42)return A(zt),A(Gt),vt=10,vt|0;if((gt|0)==49)return A(zt),A(Gt),vt=13,vt|0;if((gt|0)==77)cn(23313,22674,462,22684);else{if((gt|0)==84)return A(Ke),A(zt),A(Gt),vt=I,vt|0;if((gt|0)==85){$e(m|0,zt|0,x<<3|0)|0;break}}}if((gt|0)==22)return A(zt),A(Gt),vt=5,vt|0;if((gt|0)==28)return A(zt),A(Gt),vt=I,vt|0}while(0);return A(zt),A(Gt),vt=0,vt|0}function vc(y,m,x,E,I,R,O){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0,O=O|0;var U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0;if(Ke=we,we=we+16|0,Be=Ke,!((x|0)>0|(x|0)==0&m>>>0>0))return Be=0,we=Ke,Be|0;if((O|0)>=16)return Be=12,we=Ke,Be|0;Re=0,je=0,de=0,U=0;e:for(;;){if(ee=y+(Re<<3)|0,q=a[ee>>2]|0,ee=a[ee+4>>2]|0,le=ne(q|0,ee|0,52)|0,Ce()|0,(le&15|0)>(O|0)){U=12,q=11;break}if(ba(Be,q,ee,O),le=Be,ee=a[le>>2]|0,le=a[le+4>>2]|0,(ee|0)==0&(le|0)==0)q=de;else{q=de;do{if(!((U|0)<(R|0)|(U|0)==(R|0)&q>>>0<I>>>0)){q=10;break e}de=E+(q<<3)|0,a[de>>2]=ee,a[de+4>>2]=le,q=d(q|0,U|0,1,0)|0,U=Ce()|0,el(Be),de=Be,ee=a[de>>2]|0,le=a[de+4>>2]|0}while(!((ee|0)==0&(le|0)==0))}if(Re=d(Re|0,je|0,1,0)|0,je=Ce()|0,(je|0)<(x|0)|(je|0)==(x|0)&Re>>>0<m>>>0)de=q;else{U=0,q=11;break}}return(q|0)==10?(Be=14,we=Ke,Be|0):(q|0)==11?(we=Ke,U|0):0}function Xr(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0;Re=we,we=we+16|0,de=Re;e:do if((x|0)>0|(x|0)==0&m>>>0>0){for(ee=0,O=0,R=0,le=0;;){if(q=y+(ee<<3)|0,U=a[q>>2]|0,q=a[q+4>>2]|0,!((U|0)==0&(q|0)==0)&&(q=(Fl(U,q,E,de)|0)==0,U=de,O=d(a[U>>2]|0,a[U+4>>2]|0,O|0,R|0)|0,R=Ce()|0,!q)){R=12;break}if(ee=d(ee|0,le|0,1,0)|0,le=Ce()|0,!((le|0)<(x|0)|(le|0)==(x|0)&ee>>>0<m>>>0))break e}return we=Re,R|0}else O=0,R=0;while(0);return a[I>>2]=O,a[I+4>>2]=R,I=0,we=Re,I|0}function zr(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,52)|0,Ce()|0,m&1|0}function oi(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;if(I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15,!I)return I=0,I|0;for(E=1;;){if(x=ne(y|0,m|0,(15-E|0)*3|0)|0,Ce()|0,x=x&7,x|0){E=5;break}if(E>>>0<I>>>0)E=E+1|0;else{x=0,E=5;break}}return(E|0)==5?x|0:0}function pu(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0;if(q=ne(y|0,m|0,52)|0,Ce()|0,q=q&15,!q)return U=m,q=y,Mt(U|0),q|0;for(U=1,x=0;;){R=(15-U|0)*3|0,E=ue(7,0,R|0)|0,I=Ce()|0,O=ne(y|0,m|0,R|0)|0,Ce()|0,R=ue(xo(O&7)|0,0,R|0)|0,O=Ce()|0,y=R|y&~E,m=O|m&~I;e:do if(!x)if((R&E|0)==0&(O&I|0)==0)x=0;else if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)x=1;else{x=1;t:for(;;){switch(O=ne(y|0,m|0,(15-x|0)*3|0)|0,Ce()|0,O&7){case 1:break t;case 0:break;default:{x=1;break e}}if(x>>>0<E>>>0)x=x+1|0;else{x=1;break e}}for(x=1;;)if(O=(15-x|0)*3|0,I=ne(y|0,m|0,O|0)|0,Ce()|0,R=ue(7,0,O|0)|0,m=m&~(Ce()|0),O=ue(xo(I&7)|0,0,O|0)|0,y=y&~R|O,m=m|(Ce()|0),x>>>0<E>>>0)x=x+1|0;else{x=1;break}}while(0);if(U>>>0<q>>>0)U=U+1|0;else break}return Mt(m|0),y|0}function Hs(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0;if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)return x=m,E=y,Mt(x|0),E|0;for(x=1;R=(15-x|0)*3|0,O=ne(y|0,m|0,R|0)|0,Ce()|0,I=ue(7,0,R|0)|0,m=m&~(Ce()|0),R=ue(xo(O&7)|0,0,R|0)|0,y=R|y&~I,m=Ce()|0|m,x>>>0<E>>>0;)x=x+1|0;return Mt(m|0),y|0}function xc(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0;if(q=ne(y|0,m|0,52)|0,Ce()|0,q=q&15,!q)return U=m,q=y,Mt(U|0),q|0;for(U=1,x=0;;){R=(15-U|0)*3|0,E=ue(7,0,R|0)|0,I=Ce()|0,O=ne(y|0,m|0,R|0)|0,Ce()|0,R=ue(qo(O&7)|0,0,R|0)|0,O=Ce()|0,y=R|y&~E,m=O|m&~I;e:do if(!x)if((R&E|0)==0&(O&I|0)==0)x=0;else if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)x=1;else{x=1;t:for(;;){switch(O=ne(y|0,m|0,(15-x|0)*3|0)|0,Ce()|0,O&7){case 1:break t;case 0:break;default:{x=1;break e}}if(x>>>0<E>>>0)x=x+1|0;else{x=1;break e}}for(x=1;;)if(I=(15-x|0)*3|0,R=ue(7,0,I|0)|0,O=m&~(Ce()|0),m=ne(y|0,m|0,I|0)|0,Ce()|0,m=ue(qo(m&7)|0,0,I|0)|0,y=y&~R|m,m=O|(Ce()|0),x>>>0<E>>>0)x=x+1|0;else{x=1;break}}while(0);if(U>>>0<q>>>0)U=U+1|0;else break}return Mt(m|0),y|0}function PA(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0;if(E=ne(y|0,m|0,52)|0,Ce()|0,E=E&15,!E)return x=m,E=y,Mt(x|0),E|0;for(x=1;O=(15-x|0)*3|0,R=ue(7,0,O|0)|0,I=m&~(Ce()|0),m=ne(y|0,m|0,O|0)|0,Ce()|0,m=ue(qo(m&7)|0,0,O|0)|0,y=m|y&~R,m=Ce()|0|I,x>>>0<E>>>0;)x=x+1|0;return Mt(m|0),y|0}function fi(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(q=we,we=we+64|0,U=q+40|0,E=q+24|0,I=q+12|0,R=q,ue(m|0,0,52)|0,x=Ce()|0|134225919,!m)return(a[y+4>>2]|0)>2||(a[y+8>>2]|0)>2||(a[y+12>>2]|0)>2?(O=0,U=0,Mt(O|0),we=q,U|0):(ue(xA(y)|0,0,45)|0,O=Ce()|0|x,U=-1,Mt(O|0),we=q,U|0);if(a[U>>2]=a[y>>2],a[U+4>>2]=a[y+4>>2],a[U+8>>2]=a[y+8>>2],a[U+12>>2]=a[y+12>>2],O=U+4|0,(m|0)>0)for(y=-1;a[E>>2]=a[O>>2],a[E+4>>2]=a[O+4>>2],a[E+8>>2]=a[O+8>>2],m&1?(SA(O),a[I>>2]=a[O>>2],a[I+4>>2]=a[O+4>>2],a[I+8>>2]=a[O+8>>2],Qo(I)):(qa(O),a[I>>2]=a[O>>2],a[I+4>>2]=a[O+4>>2],a[I+8>>2]=a[O+8>>2],Wi(I)),_o(E,I,R),zn(R),le=(15-m|0)*3|0,ee=ue(7,0,le|0)|0,x=x&~(Ce()|0),le=ue(Wo(R)|0,0,le|0)|0,y=le|y&~ee,x=Ce()|0|x,(m|0)>1;)m=m+-1|0;else y=-1;e:do if((a[O>>2]|0)<=2&&(a[U+8>>2]|0)<=2&&(a[U+12>>2]|0)<=2){if(E=xA(U)|0,m=ue(E|0,0,45)|0,m=m|y,y=Ce()|0|x&-1040385,R=wA(U)|0,!(Gn(E)|0)){if((R|0)<=0)break;for(I=0;;){if(E=ne(m|0,y|0,52)|0,Ce()|0,E=E&15,E)for(x=1;le=(15-x|0)*3|0,U=ne(m|0,y|0,le|0)|0,Ce()|0,ee=ue(7,0,le|0)|0,y=y&~(Ce()|0),le=ue(xo(U&7)|0,0,le|0)|0,m=m&~ee|le,y=y|(Ce()|0),x>>>0<E>>>0;)x=x+1|0;if(I=I+1|0,(I|0)==(R|0))break e}}I=ne(m|0,y|0,52)|0,Ce()|0,I=I&15;t:do if(I){x=1;n:for(;;){switch(le=ne(m|0,y|0,(15-x|0)*3|0)|0,Ce()|0,le&7){case 1:break n;case 0:break;default:break t}if(x>>>0<I>>>0)x=x+1|0;else break t}if(bA(E,a[U>>2]|0)|0)for(x=1;U=(15-x|0)*3|0,ee=ue(7,0,U|0)|0,le=y&~(Ce()|0),y=ne(m|0,y|0,U|0)|0,Ce()|0,y=ue(qo(y&7)|0,0,U|0)|0,m=m&~ee|y,y=le|(Ce()|0),x>>>0<I>>>0;)x=x+1|0;else for(x=1;le=(15-x|0)*3|0,U=ne(m|0,y|0,le|0)|0,Ce()|0,ee=ue(7,0,le|0)|0,y=y&~(Ce()|0),le=ue(xo(U&7)|0,0,le|0)|0,m=m&~ee|le,y=y|(Ce()|0),x>>>0<I>>>0;)x=x+1|0}while(0);if((R|0)>0){x=0;do m=pu(m,y)|0,y=Ce()|0,x=x+1|0;while((x|0)!=(R|0))}}else m=0,y=0;while(0);return ee=y,le=m,Mt(ee|0),we=q,le|0}function Ei(y){return y=y|0,(y|0)%2|0|0}function hs(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;return I=we,we=we+16|0,E=I,m>>>0>15?(E=4,we=I,E|0):(a[y+4>>2]&2146435072|0)==2146435072||(a[y+8+4>>2]&2146435072|0)==2146435072?(E=3,we=I,E|0):($n(y,m,E),m=fi(E,m)|0,E=Ce()|0,a[x>>2]=m,a[x+4>>2]=E,(m|0)==0&(E|0)==0&&cn(23313,22674,786,22697),E=0,we=I,E|0)}function wa(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;if(I=x+4|0,R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,O=ne(y|0,m|0,45)|0,Ce()|0,E=(R|0)==0,Gn(O&127)|0){if(E)return O=1,O|0;E=1}else{if(E)return O=0,O|0;!(a[I>>2]|0)&&!(a[x+8>>2]|0)?E=(a[x+12>>2]|0)!=0&1:E=1}for(x=1;x&1?Qo(I):Wi(I),O=ne(y|0,m|0,(15-x|0)*3|0)|0,Ce()|0,Qi(I,O&7),x>>>0<R>>>0;)x=x+1|0;return E|0}function Ki(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(le=we,we=we+16|0,q=le,ee=ne(y|0,m|0,45)|0,Ce()|0,ee=ee&127,ee>>>0>121)return a[x>>2]=0,a[x+4>>2]=0,a[x+8>>2]=0,a[x+12>>2]=0,ee=5,we=le,ee|0;e:do if(Gn(ee)|0&&(R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,(R|0)!=0)){E=1;t:for(;;){switch(U=ne(y|0,m|0,(15-E|0)*3|0)|0,Ce()|0,U&7){case 5:break t;case 0:break;default:{E=m;break e}}if(E>>>0<R>>>0)E=E+1|0;else{E=m;break e}}for(I=1,E=m;m=(15-I|0)*3|0,O=ue(7,0,m|0)|0,U=E&~(Ce()|0),E=ne(y|0,E|0,m|0)|0,Ce()|0,E=ue(qo(E&7)|0,0,m|0)|0,y=y&~O|E,E=U|(Ce()|0),I>>>0<R>>>0;)I=I+1|0}else E=m;while(0);if(U=7696+(ee*28|0)|0,a[x>>2]=a[U>>2],a[x+4>>2]=a[U+4>>2],a[x+8>>2]=a[U+8>>2],a[x+12>>2]=a[U+12>>2],!(wa(y,E,x)|0))return ee=0,we=le,ee|0;if(O=x+4|0,a[q>>2]=a[O>>2],a[q+4>>2]=a[O+4>>2],a[q+8>>2]=a[O+8>>2],R=ne(y|0,E|0,52)|0,Ce()|0,U=R&15,R&1?(Wi(O),R=U+1|0):R=U,!(Gn(ee)|0))E=0;else{e:do if(!U)E=0;else for(m=1;;){if(I=ne(y|0,E|0,(15-m|0)*3|0)|0,Ce()|0,I=I&7,I|0){E=I;break e}if(m>>>0<U>>>0)m=m+1|0;else{E=0;break}}while(0);E=(E|0)==4&1}if(!(Ya(x,R,E,0)|0))(R|0)!=(U|0)&&(a[O>>2]=a[q>>2],a[O+4>>2]=a[q+4>>2],a[O+8>>2]=a[q+8>>2]);else{if(Gn(ee)|0)do;while(Ya(x,R,0,0)|0);(R|0)!=(U|0)&&qa(O)}return ee=0,we=le,ee|0}function bo(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;return R=we,we=we+16|0,E=R,I=Ki(y,m,E)|0,I|0?(we=R,I|0):(I=ne(y|0,m|0,52)|0,Ce()|0,Bl(E,I&15,x),I=0,we=R,I|0)}function mi(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0;if(O=we,we=we+16|0,R=O,E=Ki(y,m,R)|0,E|0)return R=E,we=O,R|0;E=ne(y|0,m|0,45)|0,Ce()|0,E=(Gn(E&127)|0)==0,I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15;e:do if(!E){if(I|0)for(E=1;;){if(U=ue(7,0,(15-E|0)*3|0)|0,!((U&y|0)==0&((Ce()|0)&m|0)==0))break e;if(E>>>0<I>>>0)E=E+1|0;else break}return Yo(R,I,0,5,x),U=0,we=O,U|0}while(0);return fu(R,I,0,6,x),U=0,we=O,U|0}function Ka(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if(I=ne(y|0,m|0,45)|0,Ce()|0,!(Gn(I&127)|0))return I=2,a[x>>2]=I,0;if(I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15,!I)return I=5,a[x>>2]=I,0;for(E=1;;){if(R=ue(7,0,(15-E|0)*3|0)|0,!((R&y|0)==0&((Ce()|0)&m|0)==0)){E=2,y=6;break}if(E>>>0<I>>>0)E=E+1|0;else{E=5,y=6;break}}return(y|0)==6&&(a[x>>2]=E),0}function Ul(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0;de=we,we=we+128|0,ee=de+112|0,R=de+96|0,le=de,I=ne(y|0,m|0,52)|0,Ce()|0,U=I&15,a[ee>>2]=U,O=ne(y|0,m|0,45)|0,Ce()|0,O=O&127;e:do if(Gn(O)|0){if(U|0)for(E=1;;){if(q=ue(7,0,(15-E|0)*3|0)|0,!((q&y|0)==0&((Ce()|0)&m|0)==0)){I=0;break e}if(E>>>0<U>>>0)E=E+1|0;else break}if(I&1)I=1;else return q=ue(U+1|0,0,52)|0,le=Ce()|0|m&-15728641,ee=ue(7,0,(14-U|0)*3|0)|0,le=Ul((q|y)&~ee,le&~(Ce()|0),x)|0,we=de,le|0}else I=0;while(0);if(E=Ki(y,m,R)|0,!E){I?(yc(R,ee,le),q=5):(js(R,ee,le),q=6);e:do if(Gn(O)|0)if(!U)y=5;else for(E=1;;){if(O=ue(7,0,(15-E|0)*3|0)|0,!((O&y|0)==0&((Ce()|0)&m|0)==0)){y=2;break e}if(E>>>0<U>>>0)E=E+1|0;else{y=5;break}}else y=2;while(0);Se(x|0,-1,y<<2|0)|0;e:do if(I)for(R=0;;){if(O=le+(R<<4)|0,_c(O,a[ee>>2]|0)|0,O=a[O>>2]|0,U=a[x>>2]|0,(U|0)==-1|(U|0)==(O|0))E=x;else{I=0;do{if(I=I+1|0,I>>>0>=y>>>0){E=1;break e}E=x+(I<<2)|0,U=a[E>>2]|0}while(!((U|0)==-1|(U|0)==(O|0)))}if(a[E>>2]=O,R=R+1|0,R>>>0>=q>>>0){E=0;break}}else for(R=0;;){if(O=le+(R<<4)|0,Ya(O,a[ee>>2]|0,0,1)|0,O=a[O>>2]|0,U=a[x>>2]|0,(U|0)==-1|(U|0)==(O|0))E=x;else{I=0;do{if(I=I+1|0,I>>>0>=y>>>0){E=1;break e}E=x+(I<<2)|0,U=a[E>>2]|0}while(!((U|0)==-1|(U|0)==(O|0)))}if(a[E>>2]=O,R=R+1|0,R>>>0>=q>>>0){E=0;break}}while(0)}return le=E,we=de,le|0}function Ja(){return 12}function Ws(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0;if(y>>>0>15)return U=4,U|0;if(ue(y|0,0,52)|0,U=Ce()|0|134225919,!y){x=0,E=0;do Gn(E)|0&&(ue(E|0,0,45)|0,O=U|(Ce()|0),y=m+(x<<3)|0,a[y>>2]=-1,a[y+4>>2]=O,x=x+1|0),E=E+1|0;while((E|0)!=122);return x=0,x|0}x=0,O=0;do{if(Gn(O)|0){for(ue(O|0,0,45)|0,E=1,I=-1,R=U|(Ce()|0);q=ue(7,0,(15-E|0)*3|0)|0,I=I&~q,R=R&~(Ce()|0),(E|0)!=(y|0);)E=E+1|0;q=m+(x<<3)|0,a[q>>2]=I,a[q+4>>2]=R,x=x+1|0}O=O+1|0}while((O|0)!=122);return x=0,x|0}function fs(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0;if(st=we,we=we+16|0,ft=st,ct=ne(y|0,m|0,52)|0,Ce()|0,ct=ct&15,x>>>0>15)return ct=4,we=st,ct|0;if((ct|0)<(x|0))return ct=12,we=st,ct|0;if((ct|0)!=(x|0))if(R=ue(x|0,0,52)|0,R=R|y,U=Ce()|0|m&-15728641,(ct|0)>(x|0)){q=x;do Ke=ue(7,0,(14-q|0)*3|0)|0,q=q+1|0,R=Ke|R,U=Ce()|0|U;while((q|0)<(ct|0));Ke=R}else Ke=R;else Ke=y,U=m;Be=ne(Ke|0,U|0,45)|0,Ce()|0;e:do if(Gn(Be&127)|0){if(q=ne(Ke|0,U|0,52)|0,Ce()|0,q=q&15,q|0)for(R=1;;){if(Be=ue(7,0,(15-R|0)*3|0)|0,!((Be&Ke|0)==0&((Ce()|0)&U|0)==0)){ee=33;break e}if(R>>>0<q>>>0)R=R+1|0;else break}if(Be=E,a[Be>>2]=0,a[Be+4>>2]=0,(ct|0)>(x|0)){for(Be=m&-15728641,je=ct;;){if(Re=je,je=je+-1|0,je>>>0>15|(ct|0)<(je|0)){ee=19;break}if((ct|0)!=(je|0))if(R=ue(je|0,0,52)|0,R=R|y,q=Ce()|0|Be,(ct|0)<(Re|0))de=R;else{ee=je;do de=ue(7,0,(14-ee|0)*3|0)|0,ee=ee+1|0,R=de|R,q=Ce()|0|q;while((ee|0)<(ct|0));de=R}else de=y,q=m;if(le=ne(de|0,q|0,45)|0,Ce()|0,!(Gn(le&127)|0))R=0;else{le=ne(de|0,q|0,52)|0,Ce()|0,le=le&15;t:do if(!le)R=0;else for(ee=1;;){if(R=ne(de|0,q|0,(15-ee|0)*3|0)|0,Ce()|0,R=R&7,R|0)break t;if(ee>>>0<le>>>0)ee=ee+1|0;else{R=0;break}}while(0);R=(R|0)==0&1}if(q=ne(y|0,m|0,(15-Re|0)*3|0)|0,Ce()|0,q=q&7,(q|0)==7){I=5,ee=42;break}if(R=(R|0)!=0,(q|0)==1&R){I=5,ee=42;break}if(de=q+(((q|0)!=0&R)<<31>>31)|0,de|0&&(ee=ct-Re|0,ee=qs(7,0,ee,((ee|0)<0)<<31>>31)|0,le=Ce()|0,R?(R=V(ee|0,le|0,5,0)|0,R=d(R|0,Ce()|0,-5,-1)|0,R=P(R|0,Ce()|0,6,0)|0,R=d(R|0,Ce()|0,1,0)|0,q=Ce()|0):(R=ee,q=le),Re=de+-1|0,Re=V(ee|0,le|0,Re|0,((Re|0)<0)<<31>>31|0)|0,Re=d(R|0,q|0,Re|0,Ce()|0)|0,de=Ce()|0,le=E,le=d(Re|0,de|0,a[le>>2]|0,a[le+4>>2]|0)|0,de=Ce()|0,Re=E,a[Re>>2]=le,a[Re+4>>2]=de),(je|0)<=(x|0)){ee=37;break}}if((ee|0)==19)cn(23313,22674,1099,22710);else if((ee|0)==37){O=E,I=a[O+4>>2]|0,O=a[O>>2]|0;break}else if((ee|0)==42)return we=st,I|0}else I=0,O=0}else ee=33;while(0);e:do if((ee|0)==33)if(Be=E,a[Be>>2]=0,a[Be+4>>2]=0,(ct|0)>(x|0)){for(R=ct;;){if(I=ne(y|0,m|0,(15-R|0)*3|0)|0,Ce()|0,I=I&7,(I|0)==7){I=5;break}if(O=ct-R|0,O=qs(7,0,O,((O|0)<0)<<31>>31)|0,I=V(O|0,Ce()|0,I|0,0)|0,O=Ce()|0,Be=E,O=d(a[Be>>2]|0,a[Be+4>>2]|0,I|0,O|0)|0,I=Ce()|0,Be=E,a[Be>>2]=O,a[Be+4>>2]=I,R=R+-1|0,(R|0)<=(x|0))break e}return we=st,I|0}else I=0,O=0;while(0);return Fl(Ke,U,ct,ft)|0&&cn(23313,22674,1063,22725),ct=ft,ft=a[ct+4>>2]|0,((I|0)>-1|(I|0)==-1&O>>>0>4294967295)&((ft|0)>(I|0)|((ft|0)==(I|0)?(a[ct>>2]|0)>>>0>O>>>0:0))?(ct=0,we=st,ct|0):(cn(23313,22674,1139,22710),0)}function wc(y,m,x,E,I,R){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0;var O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0;if(de=we,we=we+16|0,O=de,I>>>0>15)return R=4,we=de,R|0;if(U=ne(x|0,E|0,52)|0,Ce()|0,U=U&15,(U|0)>(I|0))return R=12,we=de,R|0;if(Fl(x,E,I,O)|0&&cn(23313,22674,1063,22725),le=O,ee=a[le+4>>2]|0,!(((m|0)>-1|(m|0)==-1&y>>>0>4294967295)&((ee|0)>(m|0)|((ee|0)==(m|0)?(a[le>>2]|0)>>>0>y>>>0:0))))return R=2,we=de,R|0;le=I-U|0,I=ue(I|0,0,52)|0,q=Ce()|0|E&-15728641,ee=R,a[ee>>2]=I|x,a[ee+4>>2]=q,ee=ne(x|0,E|0,45)|0,Ce()|0;e:do if(Gn(ee&127)|0){if(U|0)for(O=1;;){if(ee=ue(7,0,(15-O|0)*3|0)|0,!((ee&x|0)==0&((Ce()|0)&E|0)==0))break e;if(O>>>0<U>>>0)O=O+1|0;else break}if((le|0)<1)return R=0,we=de,R|0;for(ee=U^15,E=-1,q=1,O=1;;){U=le-q|0,U=qs(7,0,U,((U|0)<0)<<31>>31)|0,x=Ce()|0;do if(O)if(O=V(U|0,x|0,5,0)|0,O=d(O|0,Ce()|0,-5,-1)|0,O=P(O|0,Ce()|0,6,0)|0,I=Ce()|0,(m|0)>(I|0)|(m|0)==(I|0)&y>>>0>O>>>0){m=d(y|0,m|0,-1,-1)|0,m=w(m|0,Ce()|0,O|0,I|0)|0,O=Ce()|0,Re=R,Be=a[Re>>2]|0,Re=a[Re+4>>2]|0,Ke=(ee+E|0)*3|0,je=ue(7,0,Ke|0)|0,Re=Re&~(Ce()|0),E=P(m|0,O|0,U|0,x|0)|0,y=Ce()|0,I=d(E|0,y|0,2,0)|0,Ke=ue(I|0,Ce()|0,Ke|0)|0,Re=Ce()|0|Re,I=R,a[I>>2]=Ke|Be&~je,a[I+4>>2]=Re,y=V(E|0,y|0,U|0,x|0)|0,y=w(m|0,O|0,y|0,Ce()|0)|0,O=0,m=Ce()|0;break}else{Ke=R,je=a[Ke>>2]|0,Ke=a[Ke+4>>2]|0,Be=ue(7,0,(ee+E|0)*3|0)|0,Ke=Ke&~(Ce()|0),O=R,a[O>>2]=je&~Be,a[O+4>>2]=Ke,O=1;break}else je=R,I=a[je>>2]|0,je=a[je+4>>2]|0,E=(ee+E|0)*3|0,Re=ue(7,0,E|0)|0,je=je&~(Ce()|0),Ke=P(y|0,m|0,U|0,x|0)|0,O=Ce()|0,E=ue(Ke|0,O|0,E|0)|0,je=Ce()|0|je,Be=R,a[Be>>2]=E|I&~Re,a[Be+4>>2]=je,O=V(Ke|0,O|0,U|0,x|0)|0,y=w(y|0,m|0,O|0,Ce()|0)|0,O=0,m=Ce()|0;while(0);if((le|0)>(q|0))E=~q,q=q+1|0;else{m=0;break}}return we=de,m|0}while(0);if((le|0)<1)return Ke=0,we=de,Ke|0;for(I=U^15,O=1;;)if(Be=le-O|0,Be=qs(7,0,Be,((Be|0)<0)<<31>>31)|0,Ke=Ce()|0,q=R,x=a[q>>2]|0,q=a[q+4>>2]|0,U=(I-O|0)*3|0,E=ue(7,0,U|0)|0,q=q&~(Ce()|0),Re=P(y|0,m|0,Be|0,Ke|0)|0,je=Ce()|0,U=ue(Re|0,je|0,U|0)|0,q=Ce()|0|q,ee=R,a[ee>>2]=U|x&~E,a[ee+4>>2]=q,Ke=V(Re|0,je|0,Be|0,Ke|0)|0,y=w(y|0,m|0,Ke|0,Ce()|0)|0,m=Ce()|0,(le|0)<=(O|0)){m=0;break}else O=O+1|0;return we=de,m|0}function ba(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0;I=ne(m|0,x|0,52)|0,Ce()|0,I=I&15,(m|0)==0&(x|0)==0|((E|0)>15|(I|0)>(E|0))?(E=-1,I=-1,m=0,x=0):(R=cs(m,x,I+1|0,E)|0,x=(Ce()|0)&-15728641,m=ue(E|0,0,52)|0,m=R|m,x=x|(Ce()|0),R=(gr(m,x)|0)==0,E=R?-1:E),R=y,a[R>>2]=m,a[R+4>>2]=x,a[y+8>>2]=I,a[y+12>>2]=E}function el(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0;if(x=y,m=a[x>>2]|0,x=a[x+4>>2]|0,!((m|0)==0&(x|0)==0)&&(E=ne(m|0,x|0,52)|0,Ce()|0,E=E&15,U=ue(1,0,(E^15)*3|0)|0,m=d(U|0,Ce()|0,m|0,x|0)|0,x=Ce()|0,U=y,a[U>>2]=m,a[U+4>>2]=x,U=y+8|0,O=a[U>>2]|0,!((E|0)<(O|0)))){for(q=y+12|0,R=E;;){if((R|0)==(O|0)){E=5;break}if(ee=(R|0)==(a[q>>2]|0),I=(15-R|0)*3|0,E=ne(m|0,x|0,I|0)|0,Ce()|0,E=E&7,ee&((E|0)==1&!0)){E=7;break}if(!((E|0)==7&!0)){E=10;break}if(ee=ue(1,0,I|0)|0,m=d(m|0,x|0,ee|0,Ce()|0)|0,x=Ce()|0,ee=y,a[ee>>2]=m,a[ee+4>>2]=x,(R|0)>(O|0))R=R+-1|0;else{E=10;break}}if((E|0)==5){ee=y,a[ee>>2]=0,a[ee+4>>2]=0,a[U>>2]=-1,a[q>>2]=-1;return}else if((E|0)==7){O=ue(1,0,I|0)|0,O=d(m|0,x|0,O|0,Ce()|0)|0,U=Ce()|0,ee=y,a[ee>>2]=O,a[ee+4>>2]=U,a[q>>2]=R+-1;return}else if((E|0)==10)return}}function ai(y){y=+y;var m=0;return m=y<0?y+6.283185307179586:y,+(y>=6.283185307179586?m+-6.283185307179586:m)}function Ms(y,m){return y=y|0,m=m|0,+Ie(+(+G[y>>3]-+G[m>>3]))<17453292519943298e-27?(m=+Ie(+(+G[y+8>>3]-+G[m+8>>3]))<17453292519943298e-27,m|0):(m=0,m|0)}function Ji(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return I=+G[m>>3],E=+G[y>>3],R=+dt(+((I-E)*.5)),x=+dt(+((+G[m+8>>3]-+G[y+8>>3])*.5)),x=R*R+x*(+We(+I)*+We(+E)*x),+(+pn(+ +qe(+x),+ +qe(+(1-x)))*2)}function Vl(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return I=+G[m>>3],E=+G[y>>3],R=+dt(+((I-E)*.5)),x=+dt(+((+G[m+8>>3]-+G[y+8>>3])*.5)),x=R*R+x*(+We(+I)*+We(+E)*x),+(+pn(+ +qe(+x),+ +qe(+(1-x)))*2*6371.007180918475)}function Xo(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return I=+G[m>>3],E=+G[y>>3],R=+dt(+((I-E)*.5)),x=+dt(+((+G[m+8>>3]-+G[y+8>>3])*.5)),x=R*R+x*(+We(+I)*+We(+E)*x),+(+pn(+ +qe(+x),+ +qe(+(1-x)))*2*6371.007180918475*1e3)}function bc(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0;return R=+G[m>>3],E=+We(+R),I=+G[m+8>>3]-+G[y+8>>3],O=E*+dt(+I),x=+G[y>>3],+ +pn(+O,+(+dt(+R)*+We(+x)-+We(+I)*(E*+dt(+x))))}function Eo(y,m,x,E){y=y|0,m=+m,x=+x,E=E|0;var I=0,R=0,O=0,U=0;if(x<1e-16){a[E>>2]=a[y>>2],a[E+4>>2]=a[y+4>>2],a[E+8>>2]=a[y+8>>2],a[E+12>>2]=a[y+12>>2];return}R=m<0?m+6.283185307179586:m,R=m>=6.283185307179586?R+-6.283185307179586:R;do if(R<1e-16)m=+G[y>>3]+x,G[E>>3]=m,I=E;else{if(I=+Ie(+(R+-3.141592653589793))<1e-16,m=+G[y>>3],I){m=m-x,G[E>>3]=m,I=E;break}if(O=+We(+x),x=+dt(+x),m=O*+dt(+m)+ +We(+R)*(x*+We(+m)),m=m>1?1:m,m=+sn(+(m<-1?-1:m)),G[E>>3]=m,+Ie(+(m+-1.5707963267948966))<1e-16){G[E>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+Ie(+(m+1.5707963267948966))<1e-16){G[E>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(U=+We(+m),R=x*+dt(+R)/U,x=+G[y>>3],m=(O-+dt(+m)*+dt(+x))/+We(+x)/U,O=R>1?1:R,m=m>1?1:m,m=+G[y+8>>3]+ +pn(+(O<-1?-1:O),+(m<-1?-1:m)),m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);G[E+8>>3]=m;return}while(0);if(+Ie(+(m+-1.5707963267948966))<1e-16){G[I>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+Ie(+(m+1.5707963267948966))<1e-16){G[I>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(m=+G[y+8>>3],m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);G[E+8>>3]=m}function Gl(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20528+(y<<3)>>3],m=0,m|0)}function tl(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20656+(y<<3)>>3],m=0,m|0)}function Th(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20784+(y<<3)>>3],m=0,m|0)}function Sh(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20912+(y<<3)>>3],m=0,m|0)}function nl(y,m){y=y|0,m=m|0;var x=0;return y>>>0>15?(m=4,m|0):(x=qs(7,0,y,((y|0)<0)<<31>>31)|0,x=V(x|0,Ce()|0,120,0)|0,y=Ce()|0,a[m>>2]=x|2,a[m+4>>2]=y,m=0,m|0)}function Ea(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0;return Re=+G[m>>3],le=+G[y>>3],q=+dt(+((Re-le)*.5)),R=+G[m+8>>3],ee=+G[y+8>>3],O=+dt(+((R-ee)*.5)),U=+We(+le),de=+We(+Re),O=q*q+O*(de*U*O),O=+pn(+ +qe(+O),+ +qe(+(1-O)))*2,q=+G[x>>3],Re=+dt(+((q-Re)*.5)),E=+G[x+8>>3],R=+dt(+((E-R)*.5)),I=+We(+q),R=Re*Re+R*(de*I*R),R=+pn(+ +qe(+R),+ +qe(+(1-R)))*2,q=+dt(+((le-q)*.5)),E=+dt(+((ee-E)*.5)),E=q*q+E*(U*I*E),E=+pn(+ +qe(+E),+ +qe(+(1-E)))*2,I=(O+R+E)*.5,+(+jt(+ +qe(+(+Dt(+(I*.5))*+Dt(+((I-O)*.5))*+Dt(+((I-R)*.5))*+Dt(+((I-E)*.5)))))*4)}function ds(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0;if(U=we,we=we+192|0,R=U+168|0,O=U,I=bo(y,m,R)|0,I|0)return x=I,we=U,x|0;if(mi(y,m,O)|0&&cn(23313,22742,386,22751),m=a[O>>2]|0,(m|0)>0){if(E=+Ea(O+8|0,O+8+(((m|0)!=1&1)<<4)|0,R)+0,(m|0)!=1){y=1;do I=y,y=y+1|0,E=E+ +Ea(O+8+(I<<4)|0,O+8+(((y|0)%(m|0)|0)<<4)|0,R);while((y|0)<(m|0))}}else E=0;return G[x>>3]=E,x=0,we=U,x|0}function Nt(y,m,x){return y=y|0,m=m|0,x=x|0,y=ds(y,m,x)|0,y|0||(G[x>>3]=+G[x>>3]*6371.007180918475*6371.007180918475),y|0}function gu(y,m,x){return y=y|0,m=m|0,x=x|0,y=ds(y,m,x)|0,y|0||(G[x>>3]=+G[x>>3]*6371.007180918475*6371.007180918475*1e3*1e3),y|0}function Ta(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(U=we,we=we+176|0,O=U,y=$s(y,m,O)|0,y|0)return O=y,we=U,O|0;if(G[x>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,we=U,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],I=+G[O+16>>3],R=0;do y=y+1|0,ee=E,E=+G[O+8+(y<<4)>>3],le=+dt(+((E-ee)*.5)),q=I,I=+G[O+8+(y<<4)+8>>3],q=+dt(+((I-q)*.5)),q=le*le+q*(+We(+E)*+We(+ee)*q),R=R+ +pn(+ +qe(+q),+ +qe(+(1-q)))*2;while((y|0)<(m|0));return G[x>>3]=R,O=0,we=U,O|0}function Ko(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(U=we,we=we+176|0,O=U,y=$s(y,m,O)|0,y|0)return O=y,R=+G[x>>3],R=R*6371.007180918475,G[x>>3]=R,we=U,O|0;if(G[x>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,R=0,R=R*6371.007180918475,G[x>>3]=R,we=U,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],I=+G[O+16>>3],R=0;do y=y+1|0,ee=E,E=+G[O+8+(y<<4)>>3],le=+dt(+((E-ee)*.5)),q=I,I=+G[O+8+(y<<4)+8>>3],q=+dt(+((I-q)*.5)),q=le*le+q*(+We(+ee)*+We(+E)*q),R=R+ +pn(+ +qe(+q),+ +qe(+(1-q)))*2;while((y|0)!=(m|0));return G[x>>3]=R,O=0,le=R,le=le*6371.007180918475,G[x>>3]=le,we=U,O|0}function mu(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(U=we,we=we+176|0,O=U,y=$s(y,m,O)|0,y|0)return O=y,R=+G[x>>3],R=R*6371.007180918475,R=R*1e3,G[x>>3]=R,we=U,O|0;if(G[x>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,R=0,R=R*6371.007180918475,R=R*1e3,G[x>>3]=R,we=U,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],I=+G[O+16>>3],R=0;do y=y+1|0,ee=E,E=+G[O+8+(y<<4)>>3],le=+dt(+((E-ee)*.5)),q=I,I=+G[O+8+(y<<4)+8>>3],q=+dt(+((I-q)*.5)),q=le*le+q*(+We(+ee)*+We(+E)*q),R=R+ +pn(+ +qe(+q),+ +qe(+(1-q)))*2;while((y|0)!=(m|0));return G[x>>3]=R,O=0,le=R,le=le*6371.007180918475,le=le*1e3,G[x>>3]=le,we=U,O|0}function Vt(y){y=y|0;var m=0,x=0,E=0;return m=h(1,12)|0,m||cn(22832,22787,49,22845),x=y+4|0,E=a[x>>2]|0,E|0?(E=E+8|0,a[E>>2]=m,a[x>>2]=m,m|0):(a[y>>2]|0&&cn(22862,22787,61,22885),E=y,a[E>>2]=m,a[x>>2]=m,m|0)}function kA(y,m){y=y|0,m=m|0;var x=0,E=0;return E=_(24)|0,E||cn(22899,22787,78,22913),a[E>>2]=a[m>>2],a[E+4>>2]=a[m+4>>2],a[E+8>>2]=a[m+8>>2],a[E+12>>2]=a[m+12>>2],a[E+16>>2]=0,m=y+4|0,x=a[m>>2]|0,x|0?(a[x+16>>2]=E,a[m>>2]=E,E|0):(a[y>>2]|0&&cn(22928,22787,82,22913),a[y>>2]=E,a[m>>2]=E,E|0)}function $l(y){y=y|0;var m=0,x=0,E=0,I=0;if(y)for(E=1;;){if(m=a[y>>2]|0,m|0)do{if(x=a[m>>2]|0,x|0)do I=x,x=a[x+16>>2]|0,A(I);while(x|0);I=m,m=a[m+8>>2]|0,A(I)}while(m|0);if(m=y,y=a[y+8>>2]|0,E||A(m),y)E=0;else break}}function IA(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,gt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,ar=0,kn=0;if(I=y+8|0,a[I>>2]|0)return kn=1,kn|0;if(E=a[y>>2]|0,!E)return kn=0,kn|0;m=E,x=0;do x=x+1|0,m=a[m+8>>2]|0;while(m|0);if(x>>>0<2)return kn=0,kn|0;Dn=_(x<<2)|0,Dn||cn(22948,22787,317,22967),En=_(x<<5)|0,En||cn(22989,22787,321,22967),a[y>>2]=0,zt=y+4|0,a[zt>>2]=0,a[I>>2]=0,x=0,_n=0,Gt=0,de=0;e:for(;;){if(le=a[E>>2]|0,le){R=0,O=le;do{if(q=+G[O+8>>3],m=O,O=a[O+16>>2]|0,ee=(O|0)==0,I=ee?le:O,U=+G[I+8>>3],+Ie(+(q-U))>3.141592653589793){kn=14;break}R=R+(U-q)*(+G[m>>3]+ +G[I>>3])}while(!ee);if((kn|0)==14){kn=0,R=0,m=le;do Je=+G[m+8>>3],mn=m+16|0,wn=a[mn>>2]|0,wn=wn|0?wn:le,ot=+G[wn+8>>3],R=R+(+G[m>>3]+ +G[wn>>3])*((ot<0?ot+6.283185307179586:ot)-(Je<0?Je+6.283185307179586:Je)),m=a[(m|0?mn:E)>>2]|0;while(m|0)}R>0?(a[Dn+(_n<<2)>>2]=E,_n=_n+1|0,I=Gt,m=de):kn=19}else kn=19;if((kn|0)==19){kn=0;do if(x){if(m=x+8|0,a[m>>2]|0){kn=21;break e}if(x=h(1,12)|0,!x){kn=23;break e}a[m>>2]=x,I=x+4|0,O=x,m=de}else if(de){I=zt,O=de+8|0,m=E,x=y;break}else if(a[y>>2]|0){kn=27;break e}else{I=zt,O=y,m=E,x=y;break}while(0);if(a[O>>2]=E,a[I>>2]=E,O=En+(Gt<<5)|0,ee=a[E>>2]|0,ee){for(le=En+(Gt<<5)+8|0,G[le>>3]=17976931348623157e292,de=En+(Gt<<5)+24|0,G[de>>3]=17976931348623157e292,G[O>>3]=-17976931348623157e292,Re=En+(Gt<<5)+16|0,G[Re>>3]=-17976931348623157e292,ct=17976931348623157e292,st=-17976931348623157e292,I=0,je=ee,q=17976931348623157e292,Ke=17976931348623157e292,ft=-17976931348623157e292,U=-17976931348623157e292;R=+G[je>>3],Je=+G[je+8>>3],je=a[je+16>>2]|0,Be=(je|0)==0,ot=+G[(Be?ee:je)+8>>3],R<q&&(G[le>>3]=R,q=R),Je<Ke&&(G[de>>3]=Je,Ke=Je),R>ft?G[O>>3]=R:R=ft,Je>U&&(G[Re>>3]=Je,U=Je),ct=Je>0&Je<ct?Je:ct,st=Je<0&Je>st?Je:st,I=I|+Ie(+(Je-ot))>3.141592653589793,!Be;)ft=R;I&&(G[Re>>3]=st,G[de>>3]=ct)}else a[O>>2]=0,a[O+4>>2]=0,a[O+8>>2]=0,a[O+12>>2]=0,a[O+16>>2]=0,a[O+20>>2]=0,a[O+24>>2]=0,a[O+28>>2]=0;I=Gt+1|0}if(mn=E+8|0,E=a[mn>>2]|0,a[mn>>2]=0,E)Gt=I,de=m;else{kn=45;break}}if((kn|0)==21)cn(22765,22787,35,22799);else if((kn|0)==23)cn(22819,22787,37,22799);else if((kn|0)==27)cn(22862,22787,61,22885);else if((kn|0)==45){e:do if((_n|0)>0){for(mn=(I|0)==0,Pn=I<<2,wn=(y|0)==0,vt=0,m=0;;){if(gt=a[Dn+(vt<<2)>>2]|0,mn)kn=73;else{if(Gt=_(Pn)|0,!Gt){kn=50;break}if(zt=_(Pn)|0,!zt){kn=52;break}t:do if(wn)x=0;else{for(I=0,x=0,O=y;E=En+(I<<5)|0,rl(a[O>>2]|0,E,a[gt>>2]|0)|0?(a[Gt+(x<<2)>>2]=O,a[zt+(x<<2)>>2]=E,Be=x+1|0):Be=x,O=a[O+8>>2]|0,O;)I=I+1|0,x=Be;if((Be|0)>0)if(E=a[Gt>>2]|0,(Be|0)==1)x=E;else for(Re=0,je=-1,x=E,de=E;;){for(ee=a[de>>2]|0,E=0,O=0;I=a[a[Gt+(O<<2)>>2]>>2]|0,(I|0)==(ee|0)?le=E:le=E+((rl(I,a[zt+(O<<2)>>2]|0,a[ee>>2]|0)|0)&1)|0,O=O+1|0,(O|0)!=(Be|0);)E=le;if(I=(le|0)>(je|0),x=I?de:x,E=Re+1|0,(E|0)==(Be|0))break t;Re=E,je=I?le:je,de=a[Gt+(E<<2)>>2]|0}else x=0}while(0);if(A(Gt),A(zt),x){if(I=x+4|0,E=a[I>>2]|0,E)x=E+8|0;else if(a[x>>2]|0){kn=70;break}a[x>>2]=gt,a[I>>2]=gt}else kn=73}if((kn|0)==73){if(kn=0,m=a[gt>>2]|0,m|0)do zt=m,m=a[m+16>>2]|0,A(zt);while(m|0);A(gt),m=1}if(vt=vt+1|0,(vt|0)>=(_n|0)){ar=m;break e}}(kn|0)==50?cn(23004,22787,249,23023):(kn|0)==52?cn(23042,22787,252,23023):(kn|0)==70&&cn(22862,22787,61,22885)}else ar=0;while(0);return A(Dn),A(En),kn=ar,kn|0}return 0}function rl(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0;if(!(ou(m,x)|0)||(m=Xn(m)|0,E=+G[x>>3],I=+G[x+8>>3],I=m&I<0?I+6.283185307179586:I,y=a[y>>2]|0,!y))return y=0,y|0;if(m){m=0,ee=I,x=y;e:for(;;){for(;O=+G[x>>3],I=+G[x+8>>3],x=x+16|0,le=a[x>>2]|0,le=le|0?le:y,R=+G[le>>3],U=+G[le+8>>3],O>R?(q=O,O=U):(q=R,R=O,O=I,I=U),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(x=a[x>>2]|0,!x){x=22;break e}if(U=O<0?O+6.283185307179586:O,O=I<0?I+6.283185307179586:I,ee=U==ee|O==ee?ee+-2220446049250313e-31:ee,q=U+(O-U)*((E-R)/(q-R)),(q<0?q+6.283185307179586:q)>ee&&(m=m^1),x=a[x>>2]|0,!x){x=22;break}}if((x|0)==22)return m|0}else{m=0,ee=I,x=y;e:for(;;){for(;O=+G[x>>3],I=+G[x+8>>3],x=x+16|0,le=a[x>>2]|0,le=le|0?le:y,R=+G[le>>3],U=+G[le+8>>3],O>R?(q=O,O=U):(q=R,R=O,O=I,I=U),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(x=a[x>>2]|0,!x){x=22;break e}if(ee=O==ee|I==ee?ee+-2220446049250313e-31:ee,O+(I-O)*((E-R)/(q-R))>ee&&(m=m^1),x=a[x>>2]|0,!x){x=22;break}}if((x|0)==22)return m|0}return 0}function Qs(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0;if(st=we,we=we+32|0,ct=st+16|0,ft=st,R=ne(y|0,m|0,52)|0,Ce()|0,R=R&15,je=ne(x|0,E|0,52)|0,Ce()|0,(R|0)!=(je&15|0))return ct=12,we=st,ct|0;if(ee=ne(y|0,m|0,45)|0,Ce()|0,ee=ee&127,le=ne(x|0,E|0,45)|0,Ce()|0,le=le&127,ee>>>0>121|le>>>0>121)return ct=5,we=st,ct|0;if(je=(ee|0)!=(le|0),je){if(U=kl(ee,le)|0,(U|0)==7)return ct=1,we=st,ct|0;q=kl(le,ee)|0,(q|0)==7?cn(23066,23090,161,23100):(Be=U,O=q)}else Be=0,O=0;de=Gn(ee)|0,Re=Gn(le)|0,a[ct>>2]=0,a[ct+4>>2]=0,a[ct+8>>2]=0,a[ct+12>>2]=0;do if(Be){if(le=a[4272+(ee*28|0)+(Be<<2)>>2]|0,U=(le|0)>0,Re)if(U){ee=0,q=x,U=E;do q=xc(q,U)|0,U=Ce()|0,O=qo(O)|0,(O|0)==1&&(O=qo(1)|0),ee=ee+1|0;while((ee|0)!=(le|0));le=O,ee=q,q=U}else le=O,ee=x,q=E;else if(U){ee=0,q=x,U=E;do q=PA(q,U)|0,U=Ce()|0,O=qo(O)|0,ee=ee+1|0;while((ee|0)!=(le|0));le=O,ee=q,q=U}else le=O,ee=x,q=E;if(wa(ee,q,ct)|0,je||cn(23115,23090,191,23100),U=(de|0)!=0,O=(Re|0)!=0,U&O&&cn(23142,23090,192,23100),U){if(O=oi(y,m)|0,(O|0)==7){R=5;break}if(fe[21872+(O*7|0)+Be>>0]|0){R=1;break}q=a[21040+(O*28|0)+(Be<<2)>>2]|0,ee=q}else if(O){if(O=oi(ee,q)|0,(O|0)==7){R=5;break}if(fe[21872+(O*7|0)+le>>0]|0){R=1;break}ee=0,q=a[21040+(le*28|0)+(O<<2)>>2]|0}else ee=0,q=0;if((ee|q|0)<0)R=5;else{if((q|0)>0){U=ct+4|0,O=0;do Dl(U),O=O+1|0;while((O|0)!=(q|0))}if(a[ft>>2]=0,a[ft+4>>2]=0,a[ft+8>>2]=0,Qi(ft,Be),R|0)for(;Ei(R)|0?Qo(ft):Wi(ft),(R|0)>1;)R=R+-1|0;if((ee|0)>0){R=0;do Dl(ft),R=R+1|0;while((R|0)!=(ee|0))}Ke=ct+4|0,si(Ke,ft,Ke),zn(Ke),Ke=51}}else if(wa(x,E,ct)|0,(de|0)!=0&(Re|0)!=0)if((le|0)!=(ee|0)&&cn(23173,23090,261,23100),O=oi(y,m)|0,R=oi(x,E)|0,(O|0)==7|(R|0)==7)R=5;else if(fe[21872+(O*7|0)+R>>0]|0)R=1;else if(O=a[21040+(O*28|0)+(R<<2)>>2]|0,(O|0)>0){U=ct+4|0,R=0;do Dl(U),R=R+1|0;while((R|0)!=(O|0));Ke=51}else Ke=51;else Ke=51;while(0);return(Ke|0)==51&&(R=ct+4|0,a[I>>2]=a[R>>2],a[I+4>>2]=a[R+4>>2],a[I+8>>2]=a[R+8>>2],R=0),ct=R,we=st,ct|0}function yu(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0;if(Ke=we,we=we+48|0,ee=Ke+36|0,O=Ke+24|0,U=Ke+12|0,q=Ke,I=ne(y|0,m|0,52)|0,Ce()|0,I=I&15,Re=ne(y|0,m|0,45)|0,Ce()|0,Re=Re&127,Re>>>0>121)return E=5,we=Ke,E|0;if(le=Gn(Re)|0,ue(I|0,0,52)|0,ft=Ce()|0|134225919,R=E,a[R>>2]=-1,a[R+4>>2]=ft,!I)return I=Wo(x)|0,(I|0)==7||(I=Pl(Re,I)|0,(I|0)==127)?(ft=1,we=Ke,ft|0):(je=ue(I|0,0,45)|0,Be=Ce()|0,Re=E,Be=a[Re+4>>2]&-1040385|Be,ft=E,a[ft>>2]=a[Re>>2]|je,a[ft+4>>2]=Be,ft=0,we=Ke,ft|0);for(a[ee>>2]=a[x>>2],a[ee+4>>2]=a[x+4>>2],a[ee+8>>2]=a[x+8>>2],x=I;;){if(R=x,x=x+-1|0,a[O>>2]=a[ee>>2],a[O+4>>2]=a[ee+4>>2],a[O+8>>2]=a[ee+8>>2],Ei(R)|0){if(I=ya(ee)|0,I|0){x=13;break}a[U>>2]=a[ee>>2],a[U+4>>2]=a[ee+4>>2],a[U+8>>2]=a[ee+8>>2],Qo(U)}else{if(I=vo(ee)|0,I|0){x=13;break}a[U>>2]=a[ee>>2],a[U+4>>2]=a[ee+4>>2],a[U+8>>2]=a[ee+8>>2],Wi(U)}if(_o(O,U,q),zn(q),I=E,st=a[I>>2]|0,I=a[I+4>>2]|0,ot=(15-R|0)*3|0,ct=ue(7,0,ot|0)|0,I=I&~(Ce()|0),ot=ue(Wo(q)|0,0,ot|0)|0,I=Ce()|0|I,ft=E,a[ft>>2]=ot|st&~ct,a[ft+4>>2]=I,(R|0)<=1){x=14;break}}e:do if((x|0)!=13&&(x|0)==14)if((a[ee>>2]|0)<=1&&(a[ee+4>>2]|0)<=1&&(a[ee+8>>2]|0)<=1){x=Wo(ee)|0,I=Pl(Re,x)|0,(I|0)==127?q=0:q=Gn(I)|0;t:do if(x){if(le){if(I=oi(y,m)|0,(I|0)==7){I=5;break e}if(R=a[21248+(I*28|0)+(x<<2)>>2]|0,(R|0)>0){I=x,x=0;do I=xo(I)|0,x=x+1|0;while((x|0)!=(R|0))}else I=x;if((I|0)==1){I=9;break e}x=Pl(Re,I)|0,(x|0)==127&&cn(23200,23090,411,23230),Gn(x)|0?cn(23245,23090,412,23230):(Be=x,je=R,de=I)}else Be=I,je=0,de=x;if(U=a[4272+(Re*28|0)+(de<<2)>>2]|0,(U|0)<=-1&&cn(23276,23090,419,23230),!q){if((je|0)<0){I=5;break e}if(je|0){R=E,I=0,x=a[R>>2]|0,R=a[R+4>>2]|0;do x=Hs(x,R)|0,R=Ce()|0,ot=E,a[ot>>2]=x,a[ot+4>>2]=R,I=I+1|0;while((I|0)<(je|0))}if((U|0)<=0){I=Be,x=58;break}for(R=E,I=0,x=a[R>>2]|0,R=a[R+4>>2]|0;;)if(x=Hs(x,R)|0,R=Ce()|0,ot=E,a[ot>>2]=x,a[ot+4>>2]=R,I=I+1|0,(I|0)==(U|0)){I=Be,x=58;break t}}if(O=kl(Be,Re)|0,(O|0)==7&&cn(23066,23090,428,23230),I=E,x=a[I>>2]|0,I=a[I+4>>2]|0,(U|0)>0){R=0;do x=Hs(x,I)|0,I=Ce()|0,ot=E,a[ot>>2]=x,a[ot+4>>2]=I,R=R+1|0;while((R|0)!=(U|0))}if(I=oi(x,I)|0,(I|0)==7&&cn(23313,23090,440,23230),x=vA(Be)|0,x=a[(x?21664:21456)+(O*28|0)+(I<<2)>>2]|0,(x|0)<0&&cn(23313,23090,454,23230),!x)I=Be,x=58;else{O=E,I=0,R=a[O>>2]|0,O=a[O+4>>2]|0;do R=pu(R,O)|0,O=Ce()|0,ot=E,a[ot>>2]=R,a[ot+4>>2]=O,I=I+1|0;while((I|0)<(x|0));I=Be,x=58}}else if((le|0)!=0&(q|0)!=0){if(x=oi(y,m)|0,R=E,R=oi(a[R>>2]|0,a[R+4>>2]|0)|0,(x|0)==7|(R|0)==7){I=5;break e}if(R=a[21248+(x*28|0)+(R<<2)>>2]|0,(R|0)<0){I=5;break e}if(!R)x=59;else{U=E,x=0,O=a[U>>2]|0,U=a[U+4>>2]|0;do O=Hs(O,U)|0,U=Ce()|0,ot=E,a[ot>>2]=O,a[ot+4>>2]=U,x=x+1|0;while((x|0)<(R|0));x=58}}else x=58;while(0);if((x|0)==58&&q&&(x=59),(x|0)==59&&(ot=E,(oi(a[ot>>2]|0,a[ot+4>>2]|0)|0)==1)){I=9;break}ot=E,ct=a[ot>>2]|0,ot=a[ot+4>>2]&-1040385,st=ue(I|0,0,45)|0,ot=ot|(Ce()|0),I=E,a[I>>2]=ct|st,a[I+4>>2]=ot,I=0}else I=1;while(0);return ot=I,we=Ke,ot|0}function Ch(y,m,x,E,I,R){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0,R=R|0;var O=0,U=0;return U=we,we=we+16|0,O=U,I?y=15:(y=Qs(y,m,x,E,O)|0,y||(CA(O,R),y=0)),we=U,y|0}function Ec(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0;return O=we,we=we+16|0,R=O,E?x=15:(x=Au(x,R)|0,x||(x=yu(y,m,R,I)|0)),we=O,x|0}function _u(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0;return q=we,we=we+32|0,O=q+12|0,U=q,R=Qs(y,m,y,m,O)|0,R|0?(U=R,we=q,U|0):(y=Qs(y,m,x,E,U)|0,y|0?(U=y,we=q,U|0):(O=Rl(O,U)|0,U=I,a[U>>2]=O,a[U+4>>2]=((O|0)<0)<<31>>31,U=0,we=q,U|0))}function vu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0;return q=we,we=we+32|0,O=q+12|0,U=q,R=Qs(y,m,y,m,O)|0,!R&&(R=Qs(y,m,x,E,U)|0,!R)?(E=Rl(O,U)|0,E=d(E|0,((E|0)<0)<<31>>31|0,1,0)|0,O=Ce()|0,U=I,a[U>>2]=E,a[U+4>>2]=O,U=0,we=q,U|0):(U=R,we=q,U|0)}function xu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,gt=0,vt=0;if(gt=we,we=we+48|0,O=gt+24|0,U=gt+12|0,zt=gt,R=Qs(y,m,y,m,O)|0,!R&&(R=Qs(y,m,x,E,U)|0,!R)){Je=Rl(O,U)|0,Gt=((Je|0)<0)<<31>>31,a[O>>2]=0,a[O+4>>2]=0,a[O+8>>2]=0,a[U>>2]=0,a[U+4>>2]=0,a[U+8>>2]=0,Qs(y,m,y,m,O)|0&&cn(23313,23090,691,23299),Qs(y,m,x,E,U)|0&&cn(23313,23090,696,23299),Zo(O),Zo(U),Je?(de=a[O>>2]|0,Be=+(Je|0),ct=O+4|0,Re=a[ct>>2]|0,st=O+8|0,je=a[st>>2]|0,ot=O,E=de,R=Re,x=je,Ke=+((a[U>>2]|0)-de|0)/Be,ft=+((a[U+4>>2]|0)-Re|0)/Be,Be=+((a[U+8>>2]|0)-je|0)/Be):(R=O+4|0,x=O+8|0,ct=R,st=x,ot=O,E=a[O>>2]|0,R=a[R>>2]|0,x=a[x>>2]|0,Ke=0,ft=0,Be=0),a[zt>>2]=E,je=zt+4|0,a[je>>2]=R,Re=zt+8|0,a[Re>>2]=x;e:do if((Je|0)<0)R=0;else for(le=0,de=0,R=E;;){ee=+(de>>>0)+4294967296*+(le|0),vt=Ke*ee+ +(R|0),q=ft*ee+ +(a[ct>>2]|0),ee=Be*ee+ +(a[st>>2]|0),x=~~+ve(+vt),O=~~+ve(+q),R=~~+ve(+ee),vt=+Ie(+(+(x|0)-vt)),q=+Ie(+(+(O|0)-q)),ee=+Ie(+(+(R|0)-ee));do if(vt>q&vt>ee)x=0-(O+R)|0,E=O;else if(U=0-x|0,q>ee){E=U-R|0;break}else{E=O,R=U-O|0;break}while(0);if(a[zt>>2]=x,a[je>>2]=E,a[Re>>2]=R,Za(zt),R=yu(y,m,zt,I+(de<<3)|0)|0,R|0)break e;if(!((le|0)<(Gt|0)|(le|0)==(Gt|0)&de>>>0<Je>>>0)){R=0;break e}R=d(de|0,le|0,1,0)|0,U=Ce()|0,le=U,de=R,R=a[ot>>2]|0}while(0);return zt=R,we=gt,zt|0}return zt=R,we=gt,zt|0}function qs(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0;if((x|0)==0&(E|0)==0)return I=0,R=1,Mt(I|0),R|0;R=y,I=m,y=1,m=0;do O=(x&1|0)==0&!0,y=V((O?1:R)|0,(O?0:I)|0,y|0,m|0)|0,m=Ce()|0,x=ae(x|0,E|0,1)|0,E=Ce()|0,R=V(R|0,I|0,R|0,I|0)|0,I=Ce()|0;while(!((x|0)==0&(E|0)==0));return Mt(m|0),y|0}function Bi(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0;if(!(ou(m,x)|0)||(m=Xn(m)|0,E=+G[x>>3],I=+G[x+8>>3],I=m&I<0?I+6.283185307179586:I,Re=a[y>>2]|0,(Re|0)<=0))return Re=0,Re|0;if(de=a[y+4>>2]|0,m){m=0,le=I,x=-1,y=0;e:for(;;){for(ee=y;O=+G[de+(ee<<4)>>3],I=+G[de+(ee<<4)+8>>3],y=(x+2|0)%(Re|0)|0,R=+G[de+(y<<4)>>3],U=+G[de+(y<<4)+8>>3],O>R?(q=O,O=U):(q=R,R=O,O=I,I=U),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(x=ee+1|0,(x|0)>=(Re|0)){x=22;break e}else y=ee,ee=x,x=y;if(U=O<0?O+6.283185307179586:O,O=I<0?I+6.283185307179586:I,le=U==le|O==le?le+-2220446049250313e-31:le,q=U+(O-U)*((E-R)/(q-R)),(q<0?q+6.283185307179586:q)>le&&(m=m^1),y=ee+1|0,(y|0)>=(Re|0)){x=22;break}else x=ee}if((x|0)==22)return m|0}else{m=0,le=I,x=-1,y=0;e:for(;;){for(ee=y;O=+G[de+(ee<<4)>>3],I=+G[de+(ee<<4)+8>>3],y=(x+2|0)%(Re|0)|0,R=+G[de+(y<<4)>>3],U=+G[de+(y<<4)+8>>3],O>R?(q=O,O=U):(q=R,R=O,O=I,I=U),E=E==R|E==q?E+2220446049250313e-31:E,!!(E<R|E>q);)if(x=ee+1|0,(x|0)>=(Re|0)){x=22;break e}else y=ee,ee=x,x=y;if(le=O==le|I==le?le+-2220446049250313e-31:le,O+(I-O)*((E-R)/(q-R))>le&&(m=m^1),y=ee+1|0,(y|0)>=(Re|0)){x=22;break}else x=ee}if((x|0)==22)return m|0}return 0}function To(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0;if(Be=a[y>>2]|0,!Be){a[m>>2]=0,a[m+4>>2]=0,a[m+8>>2]=0,a[m+12>>2]=0,a[m+16>>2]=0,a[m+20>>2]=0,a[m+24>>2]=0,a[m+28>>2]=0;return}if(Ke=m+8|0,G[Ke>>3]=17976931348623157e292,ft=m+24|0,G[ft>>3]=17976931348623157e292,G[m>>3]=-17976931348623157e292,ct=m+16|0,G[ct>>3]=-17976931348623157e292,!((Be|0)<=0)){for(Re=a[y+4>>2]|0,ee=17976931348623157e292,le=-17976931348623157e292,de=0,y=-1,R=17976931348623157e292,O=17976931348623157e292,q=-17976931348623157e292,E=-17976931348623157e292,je=0;x=+G[Re+(je<<4)>>3],U=+G[Re+(je<<4)+8>>3],y=y+2|0,I=+G[Re+(((y|0)==(Be|0)?0:y)<<4)+8>>3],x<R&&(G[Ke>>3]=x,R=x),U<O&&(G[ft>>3]=U,O=U),x>q?G[m>>3]=x:x=q,U>E&&(G[ct>>3]=U,E=U),ee=U>0&U<ee?U:ee,le=U<0&U>le?U:le,de=de|+Ie(+(U-I))>3.141592653589793,y=je+1|0,(y|0)!=(Be|0);)st=je,q=x,je=y,y=st;de&&(G[ct>>3]=le,G[ft>>3]=ee)}}function wu(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0,zt=0,gt=0;if(Be=a[y>>2]|0,Be){if(Ke=m+8|0,G[Ke>>3]=17976931348623157e292,ft=m+24|0,G[ft>>3]=17976931348623157e292,G[m>>3]=-17976931348623157e292,ct=m+16|0,G[ct>>3]=-17976931348623157e292,(Be|0)>0){for(I=a[y+4>>2]|0,Re=17976931348623157e292,je=-17976931348623157e292,E=0,x=-1,q=17976931348623157e292,ee=17976931348623157e292,de=-17976931348623157e292,O=-17976931348623157e292,st=0;R=+G[I+(st<<4)>>3],le=+G[I+(st<<4)+8>>3],zt=x+2|0,U=+G[I+(((zt|0)==(Be|0)?0:zt)<<4)+8>>3],R<q&&(G[Ke>>3]=R,q=R),le<ee&&(G[ft>>3]=le,ee=le),R>de?G[m>>3]=R:R=de,le>O&&(G[ct>>3]=le,O=le),Re=le>0&le<Re?le:Re,je=le<0&le>je?le:je,E=E|+Ie(+(le-U))>3.141592653589793,x=st+1|0,(x|0)!=(Be|0);)zt=st,de=R,st=x,x=zt;E&&(G[ct>>3]=je,G[ft>>3]=Re)}}else a[m>>2]=0,a[m+4>>2]=0,a[m+8>>2]=0,a[m+12>>2]=0,a[m+16>>2]=0,a[m+20>>2]=0,a[m+24>>2]=0,a[m+28>>2]=0;if(zt=y+8|0,x=a[zt>>2]|0,!((x|0)<=0)){Gt=y+12|0,Je=0;do if(I=a[Gt>>2]|0,E=Je,Je=Je+1|0,ft=m+(Je<<5)|0,ct=a[I+(E<<3)>>2]|0,ct){if(st=m+(Je<<5)+8|0,G[st>>3]=17976931348623157e292,y=m+(Je<<5)+24|0,G[y>>3]=17976931348623157e292,G[ft>>3]=-17976931348623157e292,ot=m+(Je<<5)+16|0,G[ot>>3]=-17976931348623157e292,(ct|0)>0){for(Be=a[I+(E<<3)+4>>2]|0,Re=17976931348623157e292,je=-17976931348623157e292,I=0,E=-1,Ke=0,q=17976931348623157e292,ee=17976931348623157e292,le=-17976931348623157e292,O=-17976931348623157e292;R=+G[Be+(Ke<<4)>>3],de=+G[Be+(Ke<<4)+8>>3],E=E+2|0,U=+G[Be+(((E|0)==(ct|0)?0:E)<<4)+8>>3],R<q&&(G[st>>3]=R,q=R),de<ee&&(G[y>>3]=de,ee=de),R>le?G[ft>>3]=R:R=le,de>O&&(G[ot>>3]=de,O=de),Re=de>0&de<Re?de:Re,je=de<0&de>je?de:je,I=I|+Ie(+(de-U))>3.141592653589793,E=Ke+1|0,(E|0)!=(ct|0);)gt=Ke,Ke=E,le=R,E=gt;I&&(G[ot>>3]=je,G[y>>3]=Re)}}else a[ft>>2]=0,a[ft+4>>2]=0,a[ft+8>>2]=0,a[ft+12>>2]=0,a[ft+16>>2]=0,a[ft+20>>2]=0,a[ft+24>>2]=0,a[ft+28>>2]=0,x=a[zt>>2]|0;while((Je|0)<(x|0))}}function Sa(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if(!(Bi(y,m,x)|0))return I=0,I|0;if(I=y+8|0,(a[I>>2]|0)<=0)return I=1,I|0;for(E=y+12|0,y=0;;){if(R=y,y=y+1|0,Bi((a[E>>2]|0)+(R<<3)|0,m+(y<<5)|0,x)|0){y=0,E=6;break}if((y|0)>=(a[I>>2]|0)){y=1,E=6;break}}return(E|0)==6?y|0:0}function Ur(){return 8}function jl(){return 16}function Tc(){return 168}function ps(){return 8}function Mr(){return 16}function il(){return 12}function Hl(){return 8}function bu(y){return y=y|0,+(+((a[y>>2]|0)>>>0)+4294967296*+(a[y+4>>2]|0))}function Sc(y){y=y|0;var m=0,x=0;return x=+G[y>>3],m=+G[y+8>>3],+ +qe(+(x*x+m*m))}function Eu(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0;ee=+G[y>>3],q=+G[m>>3]-ee,U=+G[y+8>>3],O=+G[m+8>>3]-U,de=+G[x>>3],R=+G[E>>3]-de,Re=+G[x+8>>3],le=+G[E+8>>3]-Re,R=(R*(U-Re)-(ee-de)*le)/(q*le-O*R),G[I>>3]=ee+q*R,G[I+8>>3]=U+O*R}function Cc(y,m){return y=y|0,m=m|0,+Ie(+(+G[y>>3]-+G[m>>3]))<11920928955078125e-23?(m=+Ie(+(+G[y+8>>3]-+G[m+8>>3]))<11920928955078125e-23,m|0):(m=0,m|0)}function mr(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;return I=+G[y>>3]-+G[m>>3],E=+G[y+8>>3]-+G[m+8>>3],x=+G[y+16>>3]-+G[m+16>>3],+(I*I+E*E+x*x)}function Wl(y,m){y=y|0,m=m|0;var x=0,E=0,I=0;x=+G[y>>3],E=+We(+x),x=+dt(+x),G[m+16>>3]=x,x=+G[y+8>>3],I=E*+We(+x),G[m>>3]=I,x=E*+dt(+x),G[m+8>>3]=x}function Xt(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if(R=we,we=we+16|0,I=R,E=gr(y,m)|0,(x+-1|0)>>>0>5||(E=(E|0)!=0,(x|0)==1&E))return I=-1,we=R,I|0;do if(Kt(y,m,I)|0)E=-1;else if(E){E=((a[21936+(x<<2)>>2]|0)+5-(a[I>>2]|0)|0)%5|0;break}else{E=((a[21968+(x<<2)>>2]|0)+6-(a[I>>2]|0)|0)%6|0;break}while(0);return I=E,we=R,I|0}function Kt(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0,ee=0;if(ee=we,we=we+32|0,O=ee+16|0,U=ee,E=Ki(y,m,O)|0,E|0)return x=E,we=ee,x|0;R=Xa(y,m)|0,q=oi(y,m)|0,iu(R,U),E=su(R,a[O>>2]|0)|0;e:do if(Gn(R)|0){do switch(R|0){case 4:{y=0;break}case 14:{y=1;break}case 24:{y=2;break}case 38:{y=3;break}case 49:{y=4;break}case 58:{y=5;break}case 63:{y=6;break}case 72:{y=7;break}case 83:{y=8;break}case 97:{y=9;break}case 107:{y=10;break}case 117:{y=11;break}default:{E=1;break e}}while(0);if(I=a[22e3+(y*24|0)+8>>2]|0,m=a[22e3+(y*24|0)+16>>2]|0,y=a[O>>2]|0,(y|0)!=(a[U>>2]|0)&&(U=vA(R)|0,y=a[O>>2]|0,U|(y|0)==(m|0)&&(E=(E+1|0)%6|0)),(q|0)==3&(y|0)==(m|0)){E=(E+5|0)%6|0,I=22;break}(q|0)==5&(y|0)==(I|0)&&(E=(E+1|0)%6|0),I=22}else I=22;while(0);return(I|0)==22&&(a[x>>2]=E,E=0),x=E,we=ee,x|0}function fn(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0;if(ot=we,we=we+32|0,st=ot+24|0,ft=ot+20|0,Be=ot+8|0,je=ot+16|0,Re=ot,q=(gr(y,m)|0)==0,q=q?6:5,le=ne(y|0,m|0,52)|0,Ce()|0,le=le&15,q>>>0<=x>>>0)return E=2,we=ot,E|0;de=(le|0)==0,!de&&(Ke=ue(7,0,(le^15)*3|0)|0,(Ke&y|0)==0&((Ce()|0)&m|0)==0)?I=x:R=4;e:do if((R|0)==4){if(I=(gr(y,m)|0)!=0,((I?4:5)|0)<(x|0)||Kt(y,m,st)|0||(R=(a[st>>2]|0)+x|0,I?I=22288+(((R|0)%5|0)<<2)|0:I=22320+(((R|0)%6|0)<<2)|0,Ke=a[I>>2]|0,(Ke|0)==7))return E=1,we=ot,E|0;a[ft>>2]=0,I=Ne(y,m,Ke,ft,Be)|0;do if(!I){if(U=Be,ee=a[U>>2]|0,U=a[U+4>>2]|0,O=U>>>0<m>>>0|(U|0)==(m|0)&ee>>>0<y>>>0,R=O?ee:y,O=O?U:m,!de&&(de=ue(7,0,(le^15)*3|0)|0,(ee&de|0)==0&(U&(Ce()|0)|0)==0))I=x;else{if(U=(x+-1+q|0)%(q|0)|0,I=gr(y,m)|0,(U|0)<0&&cn(23313,23315,245,23324),q=(I|0)!=0,((q?4:5)|0)<(U|0)&&cn(23313,23315,245,23324),Kt(y,m,st)|0&&cn(23313,23315,245,23324),I=(a[st>>2]|0)+U|0,q?I=22288+(((I|0)%5|0)<<2)|0:I=22320+(((I|0)%6|0)<<2)|0,U=a[I>>2]|0,(U|0)==7&&cn(23313,23315,245,23324),a[je>>2]=0,I=Ne(y,m,U,je,Re)|0,I|0)break;ee=Re,q=a[ee>>2]|0,ee=a[ee+4>>2]|0;do if(ee>>>0<O>>>0|(ee|0)==(O|0)&q>>>0<R>>>0){if(gr(q,ee)|0?R=lt(q,ee,y,m)|0:R=a[22384+((((a[je>>2]|0)+(a[22352+(U<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,I=gr(q,ee)|0,(R+-1|0)>>>0>5){I=-1,R=q,O=ee;break}if(I=(I|0)!=0,(R|0)==1&I){I=-1,R=q,O=ee;break}do if(Kt(q,ee,st)|0)I=-1;else if(I){I=((a[21936+(R<<2)>>2]|0)+5-(a[st>>2]|0)|0)%5|0;break}else{I=((a[21968+(R<<2)>>2]|0)+6-(a[st>>2]|0)|0)%6|0;break}while(0);R=q,O=ee}else I=x;while(0);U=Be,ee=a[U>>2]|0,U=a[U+4>>2]|0}if((R|0)==(ee|0)&(O|0)==(U|0)){if(q=(gr(ee,U)|0)!=0,q?y=lt(ee,U,y,m)|0:y=a[22384+((((a[ft>>2]|0)+(a[22352+(Ke<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,I=gr(ee,U)|0,(y+-1|0)>>>0<=5&&(ct=(I|0)!=0,!((y|0)==1&ct)))do if(Kt(ee,U,st)|0)I=-1;else if(ct){I=((a[21936+(y<<2)>>2]|0)+5-(a[st>>2]|0)|0)%5|0;break}else{I=((a[21968+(y<<2)>>2]|0)+6-(a[st>>2]|0)|0)%6|0;break}while(0);else I=-1;I=I+1|0,I=(I|0)==6|q&(I|0)==5?0:I}m=O,y=R;break e}while(0);return E=I,we=ot,E|0}while(0);return ct=ue(I|0,0,56)|0,st=Ce()|0|m&-2130706433|536870912,a[E>>2]=ct|y,a[E+4>>2]=st,E=0,we=ot,E|0}function es(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;return R=(gr(y,m)|0)==0,E=fn(y,m,0,x)|0,I=(E|0)==0,R?!I||(E=fn(y,m,1,x+8|0)|0,E|0)||(E=fn(y,m,2,x+16|0)|0,E|0)||(E=fn(y,m,3,x+24|0)|0,E|0)||(E=fn(y,m,4,x+32|0)|0,E)?(R=E,R|0):fn(y,m,5,x+40|0)|0:!I||(E=fn(y,m,1,x+8|0)|0,E|0)||(E=fn(y,m,2,x+16|0)|0,E|0)||(E=fn(y,m,3,x+24|0)|0,E|0)||(E=fn(y,m,4,x+32|0)|0,E|0)?(R=E,R|0):(R=x+40|0,a[R>>2]=0,a[R+4>>2]=0,R=0,R|0)}function Jo(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0,U=0,q=0;return q=we,we=we+192|0,I=q,R=q+168|0,O=ne(y|0,m|0,56)|0,Ce()|0,O=O&7,U=m&-2130706433|134217728,E=Ki(y,U,R)|0,E|0?(U=E,we=q,U|0):(m=ne(y|0,m|0,52)|0,Ce()|0,m=m&15,gr(y,U)|0?Yo(R,m,O,1,I):fu(R,m,O,1,I),U=I+8|0,a[x>>2]=a[U>>2],a[x+4>>2]=a[U+4>>2],a[x+8>>2]=a[U+8>>2],a[x+12>>2]=a[U+12>>2],U=0,we=q,U|0)}function Hr(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return I=we,we=we+16|0,x=I,!(!0&(m&2013265920|0)==536870912)||(E=m&-2130706433|134217728,!(xa(y,E)|0))?(E=0,we=I,E|0):(R=ne(y|0,m|0,56)|0,Ce()|0,R=(fn(y,E,R&7,x)|0)==0,E=x,E=R&((a[E>>2]|0)==(y|0)?(a[E+4>>2]|0)==(m|0):0)&1,we=I,E|0)}function Zs(y,m,x){y=y|0,m=m|0,x=x|0;var E=0;(m|0)>0?(E=h(m,4)|0,a[y>>2]=E,E||cn(23337,23360,40,23374)):a[y>>2]=0,a[y+4>>2]=m,a[y+8>>2]=0,a[y+12>>2]=x}function Ps(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0;I=y+4|0,R=y+12|0,O=y+8|0;e:for(;;){for(x=a[I>>2]|0,m=0;;){if((m|0)>=(x|0))break e;if(E=a[y>>2]|0,U=a[E+(m<<2)>>2]|0,!U)m=m+1|0;else break}m=E+(~~(+Ie(+(+At(10,+ +(15-(a[R>>2]|0)|0))*(+G[U>>3]+ +G[U+8>>3])))%+(x|0))>>>0<<2)|0,x=a[m>>2]|0;t:do if(x|0){if(E=U+32|0,(x|0)==(U|0))a[m>>2]=a[E>>2];else{if(x=x+32|0,m=a[x>>2]|0,!m)break;for(;(m|0)!=(U|0);)if(x=m+32|0,m=a[x>>2]|0,!m)break t;a[x>>2]=a[E>>2]}A(U),a[O>>2]=(a[O>>2]|0)+-1}while(0)}A(a[y>>2]|0)}function Ys(y){y=y|0;var m=0,x=0,E=0;for(E=a[y+4>>2]|0,x=0;;){if((x|0)>=(E|0)){m=0,x=4;break}if(m=a[(a[y>>2]|0)+(x<<2)>>2]|0,!m)x=x+1|0;else{x=4;break}}return(x|0)==4?m|0:0}function Ct(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;if(x=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,x=(a[y>>2]|0)+(x<<2)|0,E=a[x>>2]|0,!E)return R=1,R|0;R=m+32|0;do if((E|0)!=(m|0)){if(x=a[E+32>>2]|0,!x)return R=1,R|0;for(I=x;;){if((I|0)==(m|0)){I=8;break}if(x=a[I+32>>2]|0,x)E=I,I=x;else{x=1,I=10;break}}if((I|0)==8){a[E+32>>2]=a[R>>2];break}else if((I|0)==10)return x|0}else a[x>>2]=a[R>>2];while(0);return A(m),R=y+8|0,a[R>>2]=(a[R>>2]|0)+-1,R=0,R|0}function Pt(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;R=_(40)|0,R||cn(23390,23360,98,23403),a[R>>2]=a[m>>2],a[R+4>>2]=a[m+4>>2],a[R+8>>2]=a[m+8>>2],a[R+12>>2]=a[m+12>>2],I=R+16|0,a[I>>2]=a[x>>2],a[I+4>>2]=a[x+4>>2],a[I+8>>2]=a[x+8>>2],a[I+12>>2]=a[x+12>>2],a[R+32>>2]=0,I=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,I=(a[y>>2]|0)+(I<<2)|0,E=a[I>>2]|0;do if(!E)a[I>>2]=R;else{for(;!(Ms(E,m)|0&&Ms(E+16|0,x)|0);)if(I=a[E+32>>2]|0,E=I|0?I:E,!(a[E+32>>2]|0)){O=10;break}if((O|0)==10){a[E+32>>2]=R;break}return A(R),O=E,O|0}while(0);return O=y+8|0,a[O>>2]=(a[O>>2]|0)+1,O=R,O|0}function Wr(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0;if(I=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,I=a[(a[y>>2]|0)+(I<<2)>>2]|0,!I)return x=0,x|0;if(!x){for(y=I;;){if(Ms(y,m)|0){E=10;break}if(y=a[y+32>>2]|0,!y){y=0,E=10;break}}if((E|0)==10)return y|0}for(y=I;;){if(Ms(y,m)|0&&Ms(y+16|0,x)|0){E=10;break}if(y=a[y+32>>2]|0,!y){y=0,E=10;break}}return(E|0)==10?y|0:0}function sl(y,m){y=y|0,m=m|0;var x=0;if(x=~~(+Ie(+(+At(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,y=a[(a[y>>2]|0)+(x<<2)>>2]|0,!y)return x=0,x|0;for(;;){if(Ms(y,m)|0){m=5;break}if(y=a[y+32>>2]|0,!y){y=0,m=5;break}}return(m|0)==5?y|0:0}function Xs(){return 23424}function L(y){return y=+y,+ +Ge(+y)}function c(y){return y=+y,~~+L(y)|0}function _(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0,Ke=0,ft=0,ct=0,st=0,ot=0,Je=0,Gt=0;Gt=we,we=we+16|0,Re=Gt;do if(y>>>0<245){if(ee=y>>>0<11?16:y+11&-8,y=ee>>>3,de=a[5857]|0,x=de>>>y,x&3|0)return m=(x&1^1)+y|0,y=23468+(m<<1<<2)|0,x=y+8|0,E=a[x>>2]|0,I=E+8|0,R=a[I>>2]|0,(R|0)==(y|0)?a[5857]=de&~(1<<m):(a[R+12>>2]=y,a[x>>2]=R),Je=m<<3,a[E+4>>2]=Je|3,Je=E+Je+4|0,a[Je>>2]=a[Je>>2]|1,Je=I,we=Gt,Je|0;if(le=a[5859]|0,ee>>>0>le>>>0){if(x|0)return m=2<<y,m=x<<y&(m|0-m),m=(m&0-m)+-1|0,U=m>>>12&16,m=m>>>U,x=m>>>5&8,m=m>>>x,R=m>>>2&4,m=m>>>R,y=m>>>1&2,m=m>>>y,E=m>>>1&1,E=(x|U|R|y|E)+(m>>>E)|0,m=23468+(E<<1<<2)|0,y=m+8|0,R=a[y>>2]|0,U=R+8|0,x=a[U>>2]|0,(x|0)==(m|0)?(y=de&~(1<<E),a[5857]=y):(a[x+12>>2]=m,a[y>>2]=x,y=de),Je=E<<3,O=Je-ee|0,a[R+4>>2]=ee|3,I=R+ee|0,a[I+4>>2]=O|1,a[R+Je>>2]=O,le|0&&(E=a[5862]|0,m=le>>>3,x=23468+(m<<1<<2)|0,m=1<<m,y&m?(y=x+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=x,y=x+8|0),a[y>>2]=E,a[m+12>>2]=E,a[E+8>>2]=m,a[E+12>>2]=x),a[5859]=O,a[5862]=I,Je=U,we=Gt,Je|0;if(R=a[5858]|0,R){for(x=(R&0-R)+-1|0,I=x>>>12&16,x=x>>>I,E=x>>>5&8,x=x>>>E,O=x>>>2&4,x=x>>>O,U=x>>>1&2,x=x>>>U,q=x>>>1&1,q=a[23732+((E|I|O|U|q)+(x>>>q)<<2)>>2]|0,x=q,U=q,q=(a[q+4>>2]&-8)-ee|0;y=a[x+16>>2]|0,!(!y&&(y=a[x+20>>2]|0,!y));)O=(a[y+4>>2]&-8)-ee|0,I=O>>>0<q>>>0,x=y,U=I?y:U,q=I?O:q;if(O=U+ee|0,O>>>0>U>>>0){I=a[U+24>>2]|0,m=a[U+12>>2]|0;do if((m|0)==(U|0)){if(y=U+20|0,m=a[y>>2]|0,!m&&(y=U+16|0,m=a[y>>2]|0,!m)){x=0;break}for(;;)if(E=m+20|0,x=a[E>>2]|0,x)m=x,y=E;else if(E=m+16|0,x=a[E>>2]|0,x)m=x,y=E;else break;a[y>>2]=0,x=m}else x=a[U+8>>2]|0,a[x+12>>2]=m,a[m+8>>2]=x,x=m;while(0);do if(I|0){if(m=a[U+28>>2]|0,y=23732+(m<<2)|0,(U|0)==(a[y>>2]|0)){if(a[y>>2]=x,!x){a[5858]=R&~(1<<m);break}}else if(Je=I+16|0,a[((a[Je>>2]|0)==(U|0)?Je:I+20|0)>>2]=x,!x)break;a[x+24>>2]=I,m=a[U+16>>2]|0,m|0&&(a[x+16>>2]=m,a[m+24>>2]=x),m=a[U+20>>2]|0,m|0&&(a[x+20>>2]=m,a[m+24>>2]=x)}while(0);return q>>>0<16?(Je=q+ee|0,a[U+4>>2]=Je|3,Je=U+Je+4|0,a[Je>>2]=a[Je>>2]|1):(a[U+4>>2]=ee|3,a[O+4>>2]=q|1,a[O+q>>2]=q,le|0&&(E=a[5862]|0,m=le>>>3,x=23468+(m<<1<<2)|0,m=1<<m,m&de?(y=x+8|0,m=a[y>>2]|0):(a[5857]=m|de,m=x,y=x+8|0),a[y>>2]=E,a[m+12>>2]=E,a[E+8>>2]=m,a[E+12>>2]=x),a[5859]=q,a[5862]=O),Je=U+8|0,we=Gt,Je|0}else de=ee}else de=ee}else de=ee}else if(y>>>0<=4294967231)if(y=y+11|0,ee=y&-8,E=a[5858]|0,E){I=0-ee|0,y=y>>>8,y?ee>>>0>16777215?q=31:(de=(y+1048320|0)>>>16&8,Ke=y<<de,U=(Ke+520192|0)>>>16&4,Ke=Ke<<U,q=(Ke+245760|0)>>>16&2,q=14-(U|de|q)+(Ke<<q>>>15)|0,q=ee>>>(q+7|0)&1|q<<1):q=0,x=a[23732+(q<<2)>>2]|0;e:do if(!x)x=0,y=0,Ke=61;else for(y=0,U=ee<<((q|0)==31?0:25-(q>>>1)|0),R=0;;){if(O=(a[x+4>>2]&-8)-ee|0,O>>>0<I>>>0)if(O)y=x,I=O;else{y=x,I=0,Ke=65;break e}if(Ke=a[x+20>>2]|0,x=a[x+16+(U>>>31<<2)>>2]|0,R=(Ke|0)==0|(Ke|0)==(x|0)?R:Ke,x)U=U<<1;else{x=R,Ke=61;break}}while(0);if((Ke|0)==61){if((x|0)==0&(y|0)==0){if(y=2<<q,y=(y|0-y)&E,!y){de=ee;break}de=(y&0-y)+-1|0,O=de>>>12&16,de=de>>>O,R=de>>>5&8,de=de>>>R,U=de>>>2&4,de=de>>>U,q=de>>>1&2,de=de>>>q,x=de>>>1&1,y=0,x=a[23732+((R|O|U|q|x)+(de>>>x)<<2)>>2]|0}x?Ke=65:(U=y,O=I)}if((Ke|0)==65)for(R=x;;)if(de=(a[R+4>>2]&-8)-ee|0,x=de>>>0<I>>>0,I=x?de:I,y=x?R:y,x=a[R+16>>2]|0,x||(x=a[R+20>>2]|0),x)R=x;else{U=y,O=I;break}if(U|0&&O>>>0<((a[5859]|0)-ee|0)>>>0&&(le=U+ee|0,le>>>0>U>>>0)){R=a[U+24>>2]|0,m=a[U+12>>2]|0;do if((m|0)==(U|0)){if(y=U+20|0,m=a[y>>2]|0,!m&&(y=U+16|0,m=a[y>>2]|0,!m)){m=0;break}for(;;)if(I=m+20|0,x=a[I>>2]|0,x)m=x,y=I;else if(I=m+16|0,x=a[I>>2]|0,x)m=x,y=I;else break;a[y>>2]=0}else Je=a[U+8>>2]|0,a[Je+12>>2]=m,a[m+8>>2]=Je;while(0);do if(R){if(y=a[U+28>>2]|0,x=23732+(y<<2)|0,(U|0)==(a[x>>2]|0)){if(a[x>>2]=m,!m){E=E&~(1<<y),a[5858]=E;break}}else if(Je=R+16|0,a[((a[Je>>2]|0)==(U|0)?Je:R+20|0)>>2]=m,!m)break;a[m+24>>2]=R,y=a[U+16>>2]|0,y|0&&(a[m+16>>2]=y,a[y+24>>2]=m),y=a[U+20>>2]|0,y&&(a[m+20>>2]=y,a[y+24>>2]=m)}while(0);e:do if(O>>>0<16)Je=O+ee|0,a[U+4>>2]=Je|3,Je=U+Je+4|0,a[Je>>2]=a[Je>>2]|1;else{if(a[U+4>>2]=ee|3,a[le+4>>2]=O|1,a[le+O>>2]=O,m=O>>>3,O>>>0<256){x=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=x+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=x,y=x+8|0),a[y>>2]=le,a[m+12>>2]=le,a[le+8>>2]=m,a[le+12>>2]=x;break}if(m=O>>>8,m?O>>>0>16777215?x=31:(ot=(m+1048320|0)>>>16&8,Je=m<<ot,st=(Je+520192|0)>>>16&4,Je=Je<<st,x=(Je+245760|0)>>>16&2,x=14-(st|ot|x)+(Je<<x>>>15)|0,x=O>>>(x+7|0)&1|x<<1):x=0,m=23732+(x<<2)|0,a[le+28>>2]=x,y=le+16|0,a[y+4>>2]=0,a[y>>2]=0,y=1<<x,!(E&y)){a[5858]=E|y,a[m>>2]=le,a[le+24>>2]=m,a[le+12>>2]=le,a[le+8>>2]=le;break}m=a[m>>2]|0;t:do if((a[m+4>>2]&-8|0)!=(O|0)){for(E=O<<((x|0)==31?0:25-(x>>>1)|0);x=m+16+(E>>>31<<2)|0,y=a[x>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(O|0)){m=y;break t}else E=E<<1,m=y;a[x>>2]=le,a[le+24>>2]=m,a[le+12>>2]=le,a[le+8>>2]=le;break e}while(0);ot=m+8|0,Je=a[ot>>2]|0,a[Je+12>>2]=le,a[ot>>2]=le,a[le+8>>2]=Je,a[le+12>>2]=m,a[le+24>>2]=0}while(0);return Je=U+8|0,we=Gt,Je|0}else de=ee}else de=ee;else de=-1;while(0);if(x=a[5859]|0,x>>>0>=de>>>0)return m=x-de|0,y=a[5862]|0,m>>>0>15?(Je=y+de|0,a[5862]=Je,a[5859]=m,a[Je+4>>2]=m|1,a[y+x>>2]=m,a[y+4>>2]=de|3):(a[5859]=0,a[5862]=0,a[y+4>>2]=x|3,Je=y+x+4|0,a[Je>>2]=a[Je>>2]|1),Je=y+8|0,we=Gt,Je|0;if(O=a[5860]|0,O>>>0>de>>>0)return st=O-de|0,a[5860]=st,Je=a[5863]|0,ot=Je+de|0,a[5863]=ot,a[ot+4>>2]=st|1,a[Je+4>>2]=de|3,Je=Je+8|0,we=Gt,Je|0;if(a[5975]|0?y=a[5977]|0:(a[5977]=4096,a[5976]=4096,a[5978]=-1,a[5979]=-1,a[5980]=0,a[5968]=0,a[5975]=Re&-16^1431655768,y=4096),U=de+48|0,q=de+47|0,R=y+q|0,I=0-y|0,ee=R&I,ee>>>0<=de>>>0||(y=a[5967]|0,y|0&&(le=a[5965]|0,Re=le+ee|0,Re>>>0<=le>>>0|Re>>>0>y>>>0)))return Je=0,we=Gt,Je|0;e:do if(a[5968]&4)m=0,Ke=143;else{x=a[5863]|0;t:do if(x){for(E=23876;Re=a[E>>2]|0,!(Re>>>0<=x>>>0&&(Re+(a[E+4>>2]|0)|0)>>>0>x>>>0);)if(y=a[E+8>>2]|0,y)E=y;else{Ke=128;break t}if(m=R-O&I,m>>>0<2147483647)if(y=xe(m|0)|0,(y|0)==((a[E>>2]|0)+(a[E+4>>2]|0)|0)){if((y|0)!=-1){O=m,R=y,Ke=145;break e}}else E=y,Ke=136;else m=0}else Ke=128;while(0);do if((Ke|0)==128)if(x=xe(0)|0,(x|0)!=-1&&(m=x,je=a[5976]|0,Be=je+-1|0,m=(Be&m|0?(Be+m&0-je)-m|0:0)+ee|0,je=a[5965]|0,Be=m+je|0,m>>>0>de>>>0&m>>>0<2147483647)){if(Re=a[5967]|0,Re|0&&Be>>>0<=je>>>0|Be>>>0>Re>>>0){m=0;break}if(y=xe(m|0)|0,(y|0)==(x|0)){O=m,R=x,Ke=145;break e}else E=y,Ke=136}else m=0;while(0);do if((Ke|0)==136){if(x=0-m|0,!(U>>>0>m>>>0&(m>>>0<2147483647&(E|0)!=-1)))if((E|0)==-1){m=0;break}else{O=m,R=E,Ke=145;break e}if(y=a[5977]|0,y=q-m+y&0-y,y>>>0>=2147483647){O=m,R=E,Ke=145;break e}if((xe(y|0)|0)==-1){xe(x|0)|0,m=0;break}else{O=y+m|0,R=E,Ke=145;break e}}while(0);a[5968]=a[5968]|4,Ke=143}while(0);if((Ke|0)==143&&ee>>>0<2147483647&&(st=xe(ee|0)|0,Be=xe(0)|0,ft=Be-st|0,ct=ft>>>0>(de+40|0)>>>0,!((st|0)==-1|ct^1|st>>>0<Be>>>0&((st|0)!=-1&(Be|0)!=-1)^1))&&(O=ct?ft:m,R=st,Ke=145),(Ke|0)==145){m=(a[5965]|0)+O|0,a[5965]=m,m>>>0>(a[5966]|0)>>>0&&(a[5966]=m),q=a[5863]|0;e:do if(q){for(m=23876;;){if(y=a[m>>2]|0,x=a[m+4>>2]|0,(R|0)==(y+x|0)){Ke=154;break}if(E=a[m+8>>2]|0,E)m=E;else break}if((Ke|0)==154&&(ot=m+4|0,(a[m+12>>2]&8|0)==0)&&R>>>0>q>>>0&y>>>0<=q>>>0){a[ot>>2]=x+O,Je=(a[5860]|0)+O|0,st=q+8|0,st=st&7|0?0-st&7:0,ot=q+st|0,st=Je-st|0,a[5863]=ot,a[5860]=st,a[ot+4>>2]=st|1,a[q+Je+4>>2]=40,a[5864]=a[5979];break}for(R>>>0<(a[5861]|0)>>>0&&(a[5861]=R),x=R+O|0,m=23876;;){if((a[m>>2]|0)==(x|0)){Ke=162;break}if(y=a[m+8>>2]|0,y)m=y;else break}if((Ke|0)==162&&!(a[m+12>>2]&8|0)){a[m>>2]=R,le=m+4|0,a[le>>2]=(a[le>>2]|0)+O,le=R+8|0,le=R+(le&7|0?0-le&7:0)|0,m=x+8|0,m=x+(m&7|0?0-m&7:0)|0,ee=le+de|0,U=m-le-de|0,a[le+4>>2]=de|3;t:do if((q|0)==(m|0))Je=(a[5860]|0)+U|0,a[5860]=Je,a[5863]=ee,a[ee+4>>2]=Je|1;else{if((a[5862]|0)==(m|0)){Je=(a[5859]|0)+U|0,a[5859]=Je,a[5862]=ee,a[ee+4>>2]=Je|1,a[ee+Je>>2]=Je;break}if(y=a[m+4>>2]|0,(y&3|0)==1){O=y&-8,E=y>>>3;n:do if(y>>>0<256)if(y=a[m+8>>2]|0,x=a[m+12>>2]|0,(x|0)==(y|0)){a[5857]=a[5857]&~(1<<E);break}else{a[y+12>>2]=x,a[x+8>>2]=y;break}else{R=a[m+24>>2]|0,y=a[m+12>>2]|0;do if((y|0)==(m|0)){if(x=m+16|0,E=x+4|0,y=a[E>>2]|0,y)x=E;else if(y=a[x>>2]|0,!y){y=0;break}for(;;)if(I=y+20|0,E=a[I>>2]|0,E)y=E,x=I;else if(I=y+16|0,E=a[I>>2]|0,E)y=E,x=I;else break;a[x>>2]=0}else Je=a[m+8>>2]|0,a[Je+12>>2]=y,a[y+8>>2]=Je;while(0);if(!R)break;x=a[m+28>>2]|0,E=23732+(x<<2)|0;do if((a[E>>2]|0)!=(m|0)){if(Je=R+16|0,a[((a[Je>>2]|0)==(m|0)?Je:R+20|0)>>2]=y,!y)break n}else{if(a[E>>2]=y,y|0)break;a[5858]=a[5858]&~(1<<x);break n}while(0);if(a[y+24>>2]=R,x=m+16|0,E=a[x>>2]|0,E|0&&(a[y+16>>2]=E,a[E+24>>2]=y),x=a[x+4>>2]|0,!x)break;a[y+20>>2]=x,a[x+24>>2]=y}while(0);m=m+O|0,I=O+U|0}else I=U;if(m=m+4|0,a[m>>2]=a[m>>2]&-2,a[ee+4>>2]=I|1,a[ee+I>>2]=I,m=I>>>3,I>>>0<256){x=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=x+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=x,y=x+8|0),a[y>>2]=ee,a[m+12>>2]=ee,a[ee+8>>2]=m,a[ee+12>>2]=x;break}m=I>>>8;do if(!m)E=0;else{if(I>>>0>16777215){E=31;break}ot=(m+1048320|0)>>>16&8,Je=m<<ot,st=(Je+520192|0)>>>16&4,Je=Je<<st,E=(Je+245760|0)>>>16&2,E=14-(st|ot|E)+(Je<<E>>>15)|0,E=I>>>(E+7|0)&1|E<<1}while(0);if(m=23732+(E<<2)|0,a[ee+28>>2]=E,y=ee+16|0,a[y+4>>2]=0,a[y>>2]=0,y=a[5858]|0,x=1<<E,!(y&x)){a[5858]=y|x,a[m>>2]=ee,a[ee+24>>2]=m,a[ee+12>>2]=ee,a[ee+8>>2]=ee;break}m=a[m>>2]|0;n:do if((a[m+4>>2]&-8|0)!=(I|0)){for(E=I<<((E|0)==31?0:25-(E>>>1)|0);x=m+16+(E>>>31<<2)|0,y=a[x>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(I|0)){m=y;break n}else E=E<<1,m=y;a[x>>2]=ee,a[ee+24>>2]=m,a[ee+12>>2]=ee,a[ee+8>>2]=ee;break t}while(0);ot=m+8|0,Je=a[ot>>2]|0,a[Je+12>>2]=ee,a[ot>>2]=ee,a[ee+8>>2]=Je,a[ee+12>>2]=m,a[ee+24>>2]=0}while(0);return Je=le+8|0,we=Gt,Je|0}for(m=23876;y=a[m>>2]|0,!(y>>>0<=q>>>0&&(Je=y+(a[m+4>>2]|0)|0,Je>>>0>q>>>0));)m=a[m+8>>2]|0;I=Je+-47|0,y=I+8|0,y=I+(y&7|0?0-y&7:0)|0,I=q+16|0,y=y>>>0<I>>>0?q:y,m=y+8|0,x=O+-40|0,st=R+8|0,st=st&7|0?0-st&7:0,ot=R+st|0,st=x-st|0,a[5863]=ot,a[5860]=st,a[ot+4>>2]=st|1,a[R+x+4>>2]=40,a[5864]=a[5979],x=y+4|0,a[x>>2]=27,a[m>>2]=a[5969],a[m+4>>2]=a[5970],a[m+8>>2]=a[5971],a[m+12>>2]=a[5972],a[5969]=R,a[5970]=O,a[5972]=0,a[5971]=m,m=y+24|0;do ot=m,m=m+4|0,a[m>>2]=7;while((ot+8|0)>>>0<Je>>>0);if((y|0)!=(q|0)){if(R=y-q|0,a[x>>2]=a[x>>2]&-2,a[q+4>>2]=R|1,a[y>>2]=R,m=R>>>3,R>>>0<256){x=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=x+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=x,y=x+8|0),a[y>>2]=q,a[m+12>>2]=q,a[q+8>>2]=m,a[q+12>>2]=x;break}if(m=R>>>8,m?R>>>0>16777215?E=31:(ot=(m+1048320|0)>>>16&8,Je=m<<ot,st=(Je+520192|0)>>>16&4,Je=Je<<st,E=(Je+245760|0)>>>16&2,E=14-(st|ot|E)+(Je<<E>>>15)|0,E=R>>>(E+7|0)&1|E<<1):E=0,x=23732+(E<<2)|0,a[q+28>>2]=E,a[q+20>>2]=0,a[I>>2]=0,m=a[5858]|0,y=1<<E,!(m&y)){a[5858]=m|y,a[x>>2]=q,a[q+24>>2]=x,a[q+12>>2]=q,a[q+8>>2]=q;break}m=a[x>>2]|0;t:do if((a[m+4>>2]&-8|0)!=(R|0)){for(E=R<<((E|0)==31?0:25-(E>>>1)|0);x=m+16+(E>>>31<<2)|0,y=a[x>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(R|0)){m=y;break t}else E=E<<1,m=y;a[x>>2]=q,a[q+24>>2]=m,a[q+12>>2]=q,a[q+8>>2]=q;break e}while(0);ot=m+8|0,Je=a[ot>>2]|0,a[Je+12>>2]=q,a[ot>>2]=q,a[q+8>>2]=Je,a[q+12>>2]=m,a[q+24>>2]=0}}else Je=a[5861]|0,(Je|0)==0|R>>>0<Je>>>0&&(a[5861]=R),a[5969]=R,a[5970]=O,a[5972]=0,a[5866]=a[5975],a[5865]=-1,a[5870]=23468,a[5869]=23468,a[5872]=23476,a[5871]=23476,a[5874]=23484,a[5873]=23484,a[5876]=23492,a[5875]=23492,a[5878]=23500,a[5877]=23500,a[5880]=23508,a[5879]=23508,a[5882]=23516,a[5881]=23516,a[5884]=23524,a[5883]=23524,a[5886]=23532,a[5885]=23532,a[5888]=23540,a[5887]=23540,a[5890]=23548,a[5889]=23548,a[5892]=23556,a[5891]=23556,a[5894]=23564,a[5893]=23564,a[5896]=23572,a[5895]=23572,a[5898]=23580,a[5897]=23580,a[5900]=23588,a[5899]=23588,a[5902]=23596,a[5901]=23596,a[5904]=23604,a[5903]=23604,a[5906]=23612,a[5905]=23612,a[5908]=23620,a[5907]=23620,a[5910]=23628,a[5909]=23628,a[5912]=23636,a[5911]=23636,a[5914]=23644,a[5913]=23644,a[5916]=23652,a[5915]=23652,a[5918]=23660,a[5917]=23660,a[5920]=23668,a[5919]=23668,a[5922]=23676,a[5921]=23676,a[5924]=23684,a[5923]=23684,a[5926]=23692,a[5925]=23692,a[5928]=23700,a[5927]=23700,a[5930]=23708,a[5929]=23708,a[5932]=23716,a[5931]=23716,Je=O+-40|0,st=R+8|0,st=st&7|0?0-st&7:0,ot=R+st|0,st=Je-st|0,a[5863]=ot,a[5860]=st,a[ot+4>>2]=st|1,a[R+Je+4>>2]=40,a[5864]=a[5979];while(0);if(m=a[5860]|0,m>>>0>de>>>0)return st=m-de|0,a[5860]=st,Je=a[5863]|0,ot=Je+de|0,a[5863]=ot,a[ot+4>>2]=st|1,a[Je+4>>2]=de|3,Je=Je+8|0,we=Gt,Je|0}return Je=Xs()|0,a[Je>>2]=12,Je=0,we=Gt,Je|0}function A(y){y=y|0;var m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0;if(y){x=y+-8|0,I=a[5861]|0,y=a[y+-4>>2]|0,m=y&-8,q=x+m|0;do if(y&1)U=x,O=x;else{if(E=a[x>>2]|0,!(y&3)||(O=x+(0-E)|0,R=E+m|0,O>>>0<I>>>0))return;if((a[5862]|0)==(O|0)){if(y=q+4|0,m=a[y>>2]|0,(m&3|0)!=3){U=O,m=R;break}a[5859]=R,a[y>>2]=m&-2,a[O+4>>2]=R|1,a[O+R>>2]=R;return}if(x=E>>>3,E>>>0<256)if(y=a[O+8>>2]|0,m=a[O+12>>2]|0,(m|0)==(y|0)){a[5857]=a[5857]&~(1<<x),U=O,m=R;break}else{a[y+12>>2]=m,a[m+8>>2]=y,U=O,m=R;break}I=a[O+24>>2]|0,y=a[O+12>>2]|0;do if((y|0)==(O|0)){if(m=O+16|0,x=m+4|0,y=a[x>>2]|0,y)m=x;else if(y=a[m>>2]|0,!y){y=0;break}for(;;)if(E=y+20|0,x=a[E>>2]|0,x)y=x,m=E;else if(E=y+16|0,x=a[E>>2]|0,x)y=x,m=E;else break;a[m>>2]=0}else U=a[O+8>>2]|0,a[U+12>>2]=y,a[y+8>>2]=U;while(0);if(I){if(m=a[O+28>>2]|0,x=23732+(m<<2)|0,(a[x>>2]|0)==(O|0)){if(a[x>>2]=y,!y){a[5858]=a[5858]&~(1<<m),U=O,m=R;break}}else if(U=I+16|0,a[((a[U>>2]|0)==(O|0)?U:I+20|0)>>2]=y,!y){U=O,m=R;break}a[y+24>>2]=I,m=O+16|0,x=a[m>>2]|0,x|0&&(a[y+16>>2]=x,a[x+24>>2]=y),m=a[m+4>>2]|0,m?(a[y+20>>2]=m,a[m+24>>2]=y,U=O,m=R):(U=O,m=R)}else U=O,m=R}while(0);if(!(O>>>0>=q>>>0)&&(y=q+4|0,E=a[y>>2]|0,!!(E&1))){if(E&2)a[y>>2]=E&-2,a[U+4>>2]=m|1,a[O+m>>2]=m,I=m;else{if((a[5863]|0)==(q|0)){if(q=(a[5860]|0)+m|0,a[5860]=q,a[5863]=U,a[U+4>>2]=q|1,(U|0)!=(a[5862]|0))return;a[5862]=0,a[5859]=0;return}if((a[5862]|0)==(q|0)){q=(a[5859]|0)+m|0,a[5859]=q,a[5862]=O,a[U+4>>2]=q|1,a[O+q>>2]=q;return}I=(E&-8)+m|0,x=E>>>3;do if(E>>>0<256)if(m=a[q+8>>2]|0,y=a[q+12>>2]|0,(y|0)==(m|0)){a[5857]=a[5857]&~(1<<x);break}else{a[m+12>>2]=y,a[y+8>>2]=m;break}else{R=a[q+24>>2]|0,y=a[q+12>>2]|0;do if((y|0)==(q|0)){if(m=q+16|0,x=m+4|0,y=a[x>>2]|0,y)m=x;else if(y=a[m>>2]|0,!y){x=0;break}for(;;)if(E=y+20|0,x=a[E>>2]|0,x)y=x,m=E;else if(E=y+16|0,x=a[E>>2]|0,x)y=x,m=E;else break;a[m>>2]=0,x=y}else x=a[q+8>>2]|0,a[x+12>>2]=y,a[y+8>>2]=x,x=y;while(0);if(R|0){if(y=a[q+28>>2]|0,m=23732+(y<<2)|0,(a[m>>2]|0)==(q|0)){if(a[m>>2]=x,!x){a[5858]=a[5858]&~(1<<y);break}}else if(E=R+16|0,a[((a[E>>2]|0)==(q|0)?E:R+20|0)>>2]=x,!x)break;a[x+24>>2]=R,y=q+16|0,m=a[y>>2]|0,m|0&&(a[x+16>>2]=m,a[m+24>>2]=x),y=a[y+4>>2]|0,y|0&&(a[x+20>>2]=y,a[y+24>>2]=x)}}while(0);if(a[U+4>>2]=I|1,a[O+I>>2]=I,(U|0)==(a[5862]|0)){a[5859]=I;return}}if(y=I>>>3,I>>>0<256){x=23468+(y<<1<<2)|0,m=a[5857]|0,y=1<<y,m&y?(m=x+8|0,y=a[m>>2]|0):(a[5857]=m|y,y=x,m=x+8|0),a[m>>2]=U,a[y+12>>2]=U,a[U+8>>2]=y,a[U+12>>2]=x;return}y=I>>>8,y?I>>>0>16777215?E=31:(O=(y+1048320|0)>>>16&8,q=y<<O,R=(q+520192|0)>>>16&4,q=q<<R,E=(q+245760|0)>>>16&2,E=14-(R|O|E)+(q<<E>>>15)|0,E=I>>>(E+7|0)&1|E<<1):E=0,y=23732+(E<<2)|0,a[U+28>>2]=E,a[U+20>>2]=0,a[U+16>>2]=0,m=a[5858]|0,x=1<<E;e:do if(!(m&x))a[5858]=m|x,a[y>>2]=U,a[U+24>>2]=y,a[U+12>>2]=U,a[U+8>>2]=U;else{y=a[y>>2]|0;t:do if((a[y+4>>2]&-8|0)!=(I|0)){for(E=I<<((E|0)==31?0:25-(E>>>1)|0);x=y+16+(E>>>31<<2)|0,m=a[x>>2]|0,!!m;)if((a[m+4>>2]&-8|0)==(I|0)){y=m;break t}else E=E<<1,y=m;a[x>>2]=U,a[U+24>>2]=y,a[U+12>>2]=U,a[U+8>>2]=U;break e}while(0);O=y+8|0,q=a[O>>2]|0,a[q+12>>2]=U,a[O>>2]=U,a[U+8>>2]=q,a[U+12>>2]=y,a[U+24>>2]=0}while(0);if(q=(a[5865]|0)+-1|0,a[5865]=q,!(q|0)){for(y=23884;y=a[y>>2]|0,y;)y=y+8|0;a[5865]=-1}}}}function h(y,m){y=y|0,m=m|0;var x=0;return y?(x=an(m,y)|0,(m|y)>>>0>65535&&(x=((x>>>0)/(y>>>0)|0|0)==(m|0)?x:-1)):x=0,y=_(x)|0,!y||!(a[y+-4>>2]&3)||Se(y|0,0,x|0)|0,y|0}function d(y,m,x,E){return y=y|0,m=m|0,x=x|0,E=E|0,x=y+x>>>0,Mt(m+E+(x>>>0<y>>>0|0)>>>0|0),x|0|0}function w(y,m,x,E){return y=y|0,m=m|0,x=x|0,E=E|0,E=m-E-(x>>>0>y>>>0|0)>>>0,Mt(E|0),y-x>>>0|0|0}function b(y){return y=y|0,(y?31-(Oe(y^y-1)|0)|0:32)|0}function C(y,m,x,E,I){y=y|0,m=m|0,x=x|0,E=E|0,I=I|0;var R=0,O=0,U=0,q=0,ee=0,le=0,de=0,Re=0,je=0,Be=0;if(le=y,q=m,ee=q,O=x,Re=E,U=Re,!ee)return R=(I|0)!=0,U?R?(a[I>>2]=y|0,a[I+4>>2]=m&0,Re=0,I=0,Mt(Re|0),I|0):(Re=0,I=0,Mt(Re|0),I|0):(R&&(a[I>>2]=(le>>>0)%(O>>>0),a[I+4>>2]=0),Re=0,I=(le>>>0)/(O>>>0)>>>0,Mt(Re|0),I|0);R=(U|0)==0;do if(O){if(!R){if(R=(Oe(U|0)|0)-(Oe(ee|0)|0)|0,R>>>0<=31){de=R+1|0,U=31-R|0,m=R-31>>31,O=de,y=le>>>(de>>>0)&m|ee<<U,m=ee>>>(de>>>0)&m,R=0,U=le<<U;break}return I?(a[I>>2]=y|0,a[I+4>>2]=q|m&0,Re=0,I=0,Mt(Re|0),I|0):(Re=0,I=0,Mt(Re|0),I|0)}if(R=O-1|0,R&O|0){U=(Oe(O|0)|0)+33-(Oe(ee|0)|0)|0,Be=64-U|0,de=32-U|0,q=de>>31,je=U-32|0,m=je>>31,O=U,y=de-1>>31&ee>>>(je>>>0)|(ee<<de|le>>>(U>>>0))&m,m=m&ee>>>(U>>>0),R=le<<Be&q,U=(ee<<Be|le>>>(je>>>0))&q|le<<de&U-33>>31;break}return I|0&&(a[I>>2]=R&le,a[I+4>>2]=0),(O|0)==1?(je=q|m&0,Be=y|0|0,Mt(je|0),Be|0):(Be=b(O|0)|0,je=ee>>>(Be>>>0)|0,Be=ee<<32-Be|le>>>(Be>>>0)|0,Mt(je|0),Be|0)}else{if(R)return I|0&&(a[I>>2]=(ee>>>0)%(O>>>0),a[I+4>>2]=0),je=0,Be=(ee>>>0)/(O>>>0)>>>0,Mt(je|0),Be|0;if(!le)return I|0&&(a[I>>2]=0,a[I+4>>2]=(ee>>>0)%(U>>>0)),je=0,Be=(ee>>>0)/(U>>>0)>>>0,Mt(je|0),Be|0;if(R=U-1|0,!(R&U))return I|0&&(a[I>>2]=y|0,a[I+4>>2]=R&ee|m&0),je=0,Be=ee>>>((b(U|0)|0)>>>0),Mt(je|0),Be|0;if(R=(Oe(U|0)|0)-(Oe(ee|0)|0)|0,R>>>0<=30){m=R+1|0,U=31-R|0,O=m,y=ee<<U|le>>>(m>>>0),m=ee>>>(m>>>0),R=0,U=le<<U;break}return I?(a[I>>2]=y|0,a[I+4>>2]=q|m&0,je=0,Be=0,Mt(je|0),Be|0):(je=0,Be=0,Mt(je|0),Be|0)}while(0);if(!O)ee=U,q=0,U=0;else{de=x|0|0,le=Re|E&0,ee=d(de|0,le|0,-1,-1)|0,x=Ce()|0,q=U,U=0;do E=q,q=R>>>31|q<<1,R=U|R<<1,E=y<<1|E>>>31|0,Re=y>>>31|m<<1|0,w(ee|0,x|0,E|0,Re|0)|0,Be=Ce()|0,je=Be>>31|((Be|0)<0?-1:0)<<1,U=je&1,y=w(E|0,Re|0,je&de|0,(((Be|0)<0?-1:0)>>31|((Be|0)<0?-1:0)<<1)&le|0)|0,m=Ce()|0,O=O-1|0;while(O|0);ee=q,q=0}return O=0,I|0&&(a[I>>2]=y,a[I+4>>2]=m),je=(R|0)>>>31|(ee|O)<<1|(O<<1|R>>>31)&0|q,Be=(R<<1|0)&-2|U,Mt(je|0),Be|0}function P(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0;return ee=m>>31|((m|0)<0?-1:0)<<1,q=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,R=E>>31|((E|0)<0?-1:0)<<1,I=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,U=w(ee^y|0,q^m|0,ee|0,q|0)|0,O=Ce()|0,y=R^ee,m=I^q,w((C(U,O,w(R^x|0,I^E|0,R|0,I|0)|0,Ce()|0,0)|0)^y|0,(Ce()|0)^m|0,y|0,m|0)|0}function B(y,m){y=y|0,m=m|0;var x=0,E=0,I=0,R=0;return R=y&65535,I=m&65535,x=an(I,R)|0,E=y>>>16,y=(x>>>16)+(an(I,E)|0)|0,I=m>>>16,m=an(I,R)|0,Mt((y>>>16)+(an(I,E)|0)+(((y&65535)+m|0)>>>16)|0),y+m<<16|x&65535|0|0}function V(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0;return I=y,R=x,x=B(I,R)|0,y=Ce()|0,Mt((an(m,R)|0)+(an(E,I)|0)+y|y&0|0),x|0|0|0}function W(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0,O=0,U=0,q=0,ee=0;return I=we,we=we+16|0,U=I|0,O=m>>31|((m|0)<0?-1:0)<<1,R=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,ee=E>>31|((E|0)<0?-1:0)<<1,q=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,y=w(O^y|0,R^m|0,O|0,R|0)|0,m=Ce()|0,C(y,m,w(ee^x|0,q^E|0,ee|0,q|0)|0,Ce()|0,U)|0,E=w(a[U>>2]^O|0,a[U+4>>2]^R|0,O|0,R|0)|0,x=Ce()|0,we=I,Mt(x|0),E|0}function X(y,m,x,E){y=y|0,m=m|0,x=x|0,E=E|0;var I=0,R=0;return R=we,we=we+16|0,I=R|0,C(y,m,x,E,I)|0,we=R,Mt(a[I+4>>2]|0),a[I>>2]|0|0}function ae(y,m,x){return y=y|0,m=m|0,x=x|0,(x|0)<32?(Mt(m>>x|0),y>>>x|(m&(1<<x)-1)<<32-x):(Mt(((m|0)<0?-1:0)|0),m>>x-32|0)}function ne(y,m,x){return y=y|0,m=m|0,x=x|0,(x|0)<32?(Mt(m>>>x|0),y>>>x|(m&(1<<x)-1)<<32-x):(Mt(0),m>>>x-32|0)}function ue(y,m,x){return y=y|0,m=m|0,x=x|0,(x|0)<32?(Mt(m<<x|(y&(1<<x)-1<<32-x)>>>32-x|0),y<<x):(Mt(y<<x-32|0),0)}function be(y,m){return y=+y,m=+m,y!=y?+m:m!=m?+y:+Ft(+y,+m)}function Me(y,m){return y=+y,m=+m,y!=y?+m:m!=m?+y:+xn(+y,+m)}function ve(y){return y=+y,y>=0?+Pe(y+.5):+qt(y-.5)}function $e(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0;if((x|0)>=8192)return pa(y|0,m|0,x|0)|0,y|0;if(R=y|0,I=y+x|0,(y&3)==(m&3)){for(;y&3;){if(!x)return R|0;fe[y>>0]=fe[m>>0]|0,y=y+1|0,m=m+1|0,x=x-1|0}for(x=I&-4|0,E=x-64|0;(y|0)<=(E|0);)a[y>>2]=a[m>>2],a[y+4>>2]=a[m+4>>2],a[y+8>>2]=a[m+8>>2],a[y+12>>2]=a[m+12>>2],a[y+16>>2]=a[m+16>>2],a[y+20>>2]=a[m+20>>2],a[y+24>>2]=a[m+24>>2],a[y+28>>2]=a[m+28>>2],a[y+32>>2]=a[m+32>>2],a[y+36>>2]=a[m+36>>2],a[y+40>>2]=a[m+40>>2],a[y+44>>2]=a[m+44>>2],a[y+48>>2]=a[m+48>>2],a[y+52>>2]=a[m+52>>2],a[y+56>>2]=a[m+56>>2],a[y+60>>2]=a[m+60>>2],y=y+64|0,m=m+64|0;for(;(y|0)<(x|0);)a[y>>2]=a[m>>2],y=y+4|0,m=m+4|0}else for(x=I-4|0;(y|0)<(x|0);)fe[y>>0]=fe[m>>0]|0,fe[y+1>>0]=fe[m+1>>0]|0,fe[y+2>>0]=fe[m+2>>0]|0,fe[y+3>>0]=fe[m+3>>0]|0,y=y+4|0,m=m+4|0;for(;(y|0)<(I|0);)fe[y>>0]=fe[m>>0]|0,y=y+1|0,m=m+1|0;return R|0}function Se(y,m,x){y=y|0,m=m|0,x=x|0;var E=0,I=0,R=0,O=0;if(R=y+x|0,m=m&255,(x|0)>=67){for(;y&3;)fe[y>>0]=m,y=y+1|0;for(E=R&-4|0,O=m|m<<8|m<<16|m<<24,I=E-64|0;(y|0)<=(I|0);)a[y>>2]=O,a[y+4>>2]=O,a[y+8>>2]=O,a[y+12>>2]=O,a[y+16>>2]=O,a[y+20>>2]=O,a[y+24>>2]=O,a[y+28>>2]=O,a[y+32>>2]=O,a[y+36>>2]=O,a[y+40>>2]=O,a[y+44>>2]=O,a[y+48>>2]=O,a[y+52>>2]=O,a[y+56>>2]=O,a[y+60>>2]=O,y=y+64|0;for(;(y|0)<(E|0);)a[y>>2]=O,y=y+4|0}for(;(y|0)<(R|0);)fe[y>>0]=m,y=y+1|0;return R-x|0}function Ge(y){return y=+y,y>=0?+Pe(y+.5):+qt(y-.5)}function xe(y){y=y|0;var m=0,x=0,E=0;return E=rr()|0,x=a[ke>>2]|0,m=x+y|0,(y|0)>0&(m|0)<(x|0)|(m|0)<0?(Ha(m|0)|0,hi(12),-1):(m|0)>(E|0)&&!(De(m|0)|0)?(hi(12),-1):(a[ke>>2]=m,x|0)}return{___divdi3:P,___muldi3:V,___remdi3:W,___uremdi3:X,_areNeighborCells:uu,_bitshift64Ashr:ae,_bitshift64Lshr:ne,_bitshift64Shl:ue,_calloc:h,_cellAreaKm2:Nt,_cellAreaM2:gu,_cellAreaRads2:ds,_cellToBoundary:mi,_cellToCenterChild:du,_cellToChildPos:fs,_cellToChildren:MA,_cellToChildrenSize:Fl,_cellToLatLng:bo,_cellToLocalIj:Ch,_cellToParent:Ol,_cellToVertex:fn,_cellToVertexes:es,_cellsToDirectedEdge:cu,_cellsToLinkedMultiPolygon:Br,_childPosToCell:wc,_compactCells:Nl,_destroyLinkedMultiPolygon:$l,_directedEdgeToBoundary:$s,_directedEdgeToCells:va,_edgeLengthKm:Ko,_edgeLengthM:mu,_edgeLengthRads:Ta,_emscripten_replace_memory:jo,_free:A,_getBaseCellNumber:Xa,_getDirectedEdgeDestination:_a,_getDirectedEdgeOrigin:wo,_getHexagonAreaAvgKm2:Gl,_getHexagonAreaAvgM2:tl,_getHexagonEdgeLengthAvgKm:Th,_getHexagonEdgeLengthAvgM:Sh,_getIcosahedronFaces:Ul,_getNumCells:nl,_getPentagons:Ws,_getRes0Cells:TA,_getResolution:zl,_greatCircleDistanceKm:Vl,_greatCircleDistanceM:Xo,_greatCircleDistanceRads:Ji,_gridDisk:ma,_gridDiskDistances:ii,_gridDistance:_u,_gridPathCells:xu,_gridPathCellsSize:vu,_gridRingUnsafe:bt,_i64Add:d,_i64Subtract:w,_isPentagon:gr,_isResClassIII:zr,_isValidCell:xa,_isValidDirectedEdge:hu,_isValidVertex:Hr,_latLngToCell:hs,_llvm_maxnum_f64:be,_llvm_minnum_f64:Me,_llvm_round_f64:ve,_localIjToCell:Ec,_malloc:_,_maxFaceCount:Ka,_maxGridDiskSize:Ml,_maxPolygonToCellsSize:Qt,_memcpy:$e,_memset:Se,_originToDirectedEdges:fr,_pentagonCount:Ja,_polygonToCells:Dr,_readInt64AsDoubleFromPointer:bu,_res0CellCount:EA,_round:Ge,_sbrk:xe,_sizeOfCellBoundary:Tc,_sizeOfCoordIJ:Hl,_sizeOfGeoLoop:ps,_sizeOfGeoPolygon:Mr,_sizeOfH3Index:Ur,_sizeOfLatLng:jl,_sizeOfLinkedGeoPolygon:il,_uncompactCells:vc,_uncompactCellsSize:Xr,_vertexToLatLng:Jo,establishStackSpace:ga,stackAlloc:Ss,stackRestore:Qa,stackSave:Wa}}(Ts,yn,Fe);e.___divdi3=Xe.___divdi3,e.___muldi3=Xe.___muldi3,e.___remdi3=Xe.___remdi3,e.___uremdi3=Xe.___uremdi3,e._areNeighborCells=Xe._areNeighborCells,e._bitshift64Ashr=Xe._bitshift64Ashr,e._bitshift64Lshr=Xe._bitshift64Lshr,e._bitshift64Shl=Xe._bitshift64Shl,e._calloc=Xe._calloc,e._cellAreaKm2=Xe._cellAreaKm2,e._cellAreaM2=Xe._cellAreaM2,e._cellAreaRads2=Xe._cellAreaRads2,e._cellToBoundary=Xe._cellToBoundary,e._cellToCenterChild=Xe._cellToCenterChild,e._cellToChildPos=Xe._cellToChildPos,e._cellToChildren=Xe._cellToChildren,e._cellToChildrenSize=Xe._cellToChildrenSize,e._cellToLatLng=Xe._cellToLatLng,e._cellToLocalIj=Xe._cellToLocalIj,e._cellToParent=Xe._cellToParent,e._cellToVertex=Xe._cellToVertex,e._cellToVertexes=Xe._cellToVertexes,e._cellsToDirectedEdge=Xe._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=Xe._cellsToLinkedMultiPolygon,e._childPosToCell=Xe._childPosToCell,e._compactCells=Xe._compactCells,e._destroyLinkedMultiPolygon=Xe._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=Xe._directedEdgeToBoundary,e._directedEdgeToCells=Xe._directedEdgeToCells,e._edgeLengthKm=Xe._edgeLengthKm,e._edgeLengthM=Xe._edgeLengthM,e._edgeLengthRads=Xe._edgeLengthRads;var Zr=e._emscripten_replace_memory=Xe._emscripten_replace_memory;e._free=Xe._free,e._getBaseCellNumber=Xe._getBaseCellNumber,e._getDirectedEdgeDestination=Xe._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=Xe._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=Xe._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=Xe._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=Xe._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=Xe._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=Xe._getIcosahedronFaces,e._getNumCells=Xe._getNumCells,e._getPentagons=Xe._getPentagons,e._getRes0Cells=Xe._getRes0Cells,e._getResolution=Xe._getResolution,e._greatCircleDistanceKm=Xe._greatCircleDistanceKm,e._greatCircleDistanceM=Xe._greatCircleDistanceM,e._greatCircleDistanceRads=Xe._greatCircleDistanceRads,e._gridDisk=Xe._gridDisk,e._gridDiskDistances=Xe._gridDiskDistances,e._gridDistance=Xe._gridDistance,e._gridPathCells=Xe._gridPathCells,e._gridPathCellsSize=Xe._gridPathCellsSize,e._gridRingUnsafe=Xe._gridRingUnsafe,e._i64Add=Xe._i64Add,e._i64Subtract=Xe._i64Subtract,e._isPentagon=Xe._isPentagon,e._isResClassIII=Xe._isResClassIII,e._isValidCell=Xe._isValidCell,e._isValidDirectedEdge=Xe._isValidDirectedEdge,e._isValidVertex=Xe._isValidVertex,e._latLngToCell=Xe._latLngToCell,e._llvm_maxnum_f64=Xe._llvm_maxnum_f64,e._llvm_minnum_f64=Xe._llvm_minnum_f64,e._llvm_round_f64=Xe._llvm_round_f64,e._localIjToCell=Xe._localIjToCell,e._malloc=Xe._malloc,e._maxFaceCount=Xe._maxFaceCount,e._maxGridDiskSize=Xe._maxGridDiskSize,e._maxPolygonToCellsSize=Xe._maxPolygonToCellsSize,e._memcpy=Xe._memcpy,e._memset=Xe._memset,e._originToDirectedEdges=Xe._originToDirectedEdges,e._pentagonCount=Xe._pentagonCount,e._polygonToCells=Xe._polygonToCells,e._readInt64AsDoubleFromPointer=Xe._readInt64AsDoubleFromPointer,e._res0CellCount=Xe._res0CellCount,e._round=Xe._round,e._sbrk=Xe._sbrk,e._sizeOfCellBoundary=Xe._sizeOfCellBoundary,e._sizeOfCoordIJ=Xe._sizeOfCoordIJ,e._sizeOfGeoLoop=Xe._sizeOfGeoLoop,e._sizeOfGeoPolygon=Xe._sizeOfGeoPolygon,e._sizeOfH3Index=Xe._sizeOfH3Index,e._sizeOfLatLng=Xe._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=Xe._sizeOfLinkedGeoPolygon,e._uncompactCells=Xe._uncompactCells,e._uncompactCellsSize=Xe._uncompactCellsSize,e._vertexToLatLng=Xe._vertexToLatLng,e.establishStackSpace=Xe.establishStackSpace;var Vs=e.stackAlloc=Xe.stackAlloc,Fr=e.stackRestore=Xe.stackRestore,ci=e.stackSave=Xe.stackSave;if(e.asm=Xe,e.cwrap=se,e.setValue=F,e.getValue=H,Qn){yo(Qn)||(Qn=s(Qn));{Vn();var Yn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ze.set(K,k),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,ki()},Gs=function(){l(Qn,Yn,function(){throw"could not load memory initializer "+Qn})},ji=Rr(Qn);if(ji)Yn(ji.buffer);else if(e.memoryInitializerRequest){var Hi=function(){var K=e.memoryInitializerRequest,Q=K.response;if(K.status!==200&&K.status!==0){var te=Rr(e.memoryInitializerRequestURL);if(te)Q=te.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+Qn),Gs();return}}Yn(Q)};e.memoryInitializerRequest.response?setTimeout(Hi,0):e.memoryInitializerRequest.addEventListener("load",Hi)}else Gs()}}var Ri;ri=function K(){Ri||us(),Ri||(ri=K)};function us(K){if(nr>0||(Un(),nr>0))return;function Q(){Ri||(Ri=!0,!j&&(Cr(),wt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),rn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Q()},1)):Q()}e.run=us;function Nr(K){throw e.onAbort&&e.onAbort(K),K+="",o(K),p(K),j=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Nr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return us(),t}(typeof Vi=="object"?Vi:{}),Zn="number",Rn=Zn,wp=Zn,On=Zn,Fn=Zn,so=Zn,dn=Zn,TZ=[["sizeOfH3Index",Zn],["sizeOfLatLng",Zn],["sizeOfCellBoundary",Zn],["sizeOfGeoLoop",Zn],["sizeOfGeoPolygon",Zn],["sizeOfLinkedGeoPolygon",Zn],["sizeOfCoordIJ",Zn],["readInt64AsDoubleFromPointer",Zn],["isValidCell",wp,[On,Fn]],["latLngToCell",Rn,[Zn,Zn,so,dn]],["cellToLatLng",Rn,[On,Fn,dn]],["cellToBoundary",Rn,[On,Fn,dn]],["maxGridDiskSize",Rn,[Zn,dn]],["gridDisk",Rn,[On,Fn,Zn,dn]],["gridDiskDistances",Rn,[On,Fn,Zn,dn,dn]],["gridRingUnsafe",Rn,[On,Fn,Zn,dn]],["maxPolygonToCellsSize",Rn,[dn,so,Zn,dn]],["polygonToCells",Rn,[dn,so,Zn,dn]],["cellsToLinkedMultiPolygon",Rn,[dn,Zn,dn]],["destroyLinkedMultiPolygon",null,[dn]],["compactCells",Rn,[dn,dn,Zn,Zn]],["uncompactCells",Rn,[dn,Zn,Zn,dn,Zn,so]],["uncompactCellsSize",Rn,[dn,Zn,Zn,so,dn]],["isPentagon",wp,[On,Fn]],["isResClassIII",wp,[On,Fn]],["getBaseCellNumber",Zn,[On,Fn]],["getResolution",Zn,[On,Fn]],["maxFaceCount",Rn,[On,Fn,dn]],["getIcosahedronFaces",Rn,[On,Fn,dn]],["cellToParent",Rn,[On,Fn,so,dn]],["cellToChildren",Rn,[On,Fn,so,dn]],["cellToCenterChild",Rn,[On,Fn,so,dn]],["cellToChildrenSize",Rn,[On,Fn,so,dn]],["cellToChildPos",Rn,[On,Fn,so,dn]],["childPosToCell",Rn,[Zn,Zn,On,Fn,so,dn]],["areNeighborCells",Rn,[On,Fn,On,Fn,dn]],["cellsToDirectedEdge",Rn,[On,Fn,On,Fn,dn]],["getDirectedEdgeOrigin",Rn,[On,Fn,dn]],["getDirectedEdgeDestination",Rn,[On,Fn,dn]],["isValidDirectedEdge",wp,[On,Fn]],["directedEdgeToCells",Rn,[On,Fn,dn]],["originToDirectedEdges",Rn,[On,Fn,dn]],["directedEdgeToBoundary",Rn,[On,Fn,dn]],["gridDistance",Rn,[On,Fn,On,Fn,dn]],["gridPathCells",Rn,[On,Fn,On,Fn,dn]],["gridPathCellsSize",Rn,[On,Fn,On,Fn,dn]],["cellToLocalIj",Rn,[On,Fn,On,Fn,Zn,dn]],["localIjToCell",Rn,[On,Fn,dn,Zn,dn]],["getHexagonAreaAvgM2",Rn,[so,dn]],["getHexagonAreaAvgKm2",Rn,[so,dn]],["getHexagonEdgeLengthAvgM",Rn,[so,dn]],["getHexagonEdgeLengthAvgKm",Rn,[so,dn]],["greatCircleDistanceM",Zn,[dn,dn]],["greatCircleDistanceKm",Zn,[dn,dn]],["greatCircleDistanceRads",Zn,[dn,dn]],["cellAreaM2",Rn,[On,Fn,dn]],["cellAreaKm2",Rn,[On,Fn,dn]],["cellAreaRads2",Rn,[On,Fn,dn]],["edgeLengthM",Rn,[On,Fn,dn]],["edgeLengthKm",Rn,[On,Fn,dn]],["edgeLengthRads",Rn,[On,Fn,dn]],["getNumCells",Rn,[so,dn]],["getRes0Cells",Rn,[dn]],["res0CellCount",Zn],["getPentagons",Rn,[Zn,dn]],["pentagonCount",Zn],["cellToVertex",Rn,[On,Fn,Zn,dn]],["cellToVertexes",Rn,[On,Fn,dn]],["vertexToLatLng",Rn,[On,Fn,dn]],["isValidVertex",wp,[On,Fn]]],SZ=0,CZ=1,MZ=2,PZ=3,kB=4,kZ=5,IZ=6,LZ=7,DZ=8,RZ=9,BZ=10,zZ=11,OZ=12,FZ=13,NZ=14,UZ=15,Ns={};Ns[SZ]="Success";Ns[CZ]="The operation failed but a more specific error is not available";Ns[MZ]="Argument was outside of acceptable range";Ns[PZ]="Latitude or longitude arguments were outside of acceptable range";Ns[kB]="Resolution argument was outside of acceptable range";Ns[kZ]="Cell argument was not valid";Ns[IZ]="Directed edge argument was not valid";Ns[LZ]="Undirected edge argument was not valid";Ns[DZ]="Vertex argument was not valid";Ns[RZ]="Pentagon distortion was encountered";Ns[BZ]="Duplicate input";Ns[zZ]="Cell arguments were not neighbors";Ns[OZ]="Cell arguments had incompatible resolutions";Ns[FZ]="Memory allocation failed";Ns[NZ]="Bounds of provided memory were insufficient";Ns[UZ]="Mode or flags argument was not valid";var sv=1e3,VZ=1001,GZ=1002,ov={};ov[sv]="Unknown unit";ov[VZ]="Array length out of bounds";ov[GZ]="Got unexpected null value for H3 index";var $Z="Unknown error";function IB(t,e,n){var r=n&&"value"in n,i=new Error((t[e]||$Z)+" (code: "+e+(r?", value: "+n.value:"")+")");return i.code=e,i}function LB(t,e){var n=arguments.length===2?{value:e}:{};return IB(Ns,t,n)}function oS(t,e){var n=arguments.length===2?{value:e}:{};return IB(ov,t,n)}function KA(t){if(t!==0)throw LB(t)}var bs={};TZ.forEach(function(e){bs[e[0]]=Vi.cwrap.apply(Vi,e)});var k0=16,jZ=4,gh=8,I3=bs.sizeOfH3Index(),HZ=bs.sizeOfLatLng(),WZ=bs.sizeOfCellBoundary();bs.sizeOfGeoPolygon();bs.sizeOfGeoLoop();bs.sizeOfLinkedGeoPolygon();bs.sizeOfCoordIJ();var yr={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function DB(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw LB(kB,t);return t}var QZ=/[^0-9a-fA-F]/;function av(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||QZ.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),k0),n=parseInt(t.substring(t.length-8),k0);return[n,e]}function pP(t){if(t>=0)return t.toString(k0);t=t&2147483647;var e=RB(8,t.toString(k0)),n=(parseInt(e[0],k0)+8).toString(k0);return e=n+e.substring(1),e}function qZ(t,e){return pP(e)+RB(8,pP(t))}function RB(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function ZZ(t,e){e===void 0&&(e=0);var n=Vi.getValue(t+I3*e,"i32"),r=Vi.getValue(t+I3*e+jZ,"i32");return r?qZ(n,r):null}function aS(t,e){return e===void 0&&(e=0),Vi.getValue(t+gh*e,"double")}function YZ(t,e){for(var n=[],r=0;r<e;r++){var i=ZZ(t,r);i!==null&&n.push(i)}return n}function H_(t){return eY(Vi.getValue(t,"double"))}function BB(t){return[H_(t),H_(t+gh)]}function XZ(t){return[H_(t+gh),H_(t)]}function KZ(t,e,n){for(var r=Vi.getValue(t,"i32"),i=t+gh,s=[],l=e?XZ:BB,o=0;o<r*2;o+=2)s.push(l(i+gh*o));return n&&s.push(s[0]),s}function lS(t){var e=Vi._malloc(HZ),n=av(t),r=n[0],i=n[1];try{return KA(bs.cellToLatLng(r,i,e)),BB(e)}finally{Vi._free(e)}}function JZ(t,e){var n=Vi._malloc(WZ),r=av(t),i=r[0],s=r[1];try{return KA(bs.cellToBoundary(i,s,n)),KZ(n,e,e)}finally{Vi._free(n)}}function gP(t){var e=av(t),n=e[0],r=e[1],i=6,s=Vi._calloc(i,I3);try{return KA(bs.originToDirectedEdges(n,r,s)),YZ(s,i)}finally{Vi._free(s)}}function mP(t,e){var n=av(t),r=n[0],i=n[1],s=Vi._malloc(gh);try{switch(e){case yr.m:KA(bs.edgeLengthM(r,i,s));break;case yr.km:KA(bs.edgeLengthKm(r,i,s));break;case yr.rads:KA(bs.edgeLengthRads(r,i,s));break;default:throw oS(sv,e)}return aS(s)}finally{Vi._free(s)}}function ic(t,e){DB(t);var n=Vi._malloc(gh);try{switch(e){case yr.m2:KA(bs.getHexagonAreaAvgM2(t,n));break;case yr.km2:KA(bs.getHexagonAreaAvgKm2(t,n));break;default:throw oS(sv,e)}return aS(n)}finally{Vi._free(n)}}function Bs(t,e){DB(t);var n=Vi._malloc(gh);try{switch(e){case yr.m:KA(bs.getHexagonEdgeLengthAvgM(t,n));break;case yr.km:KA(bs.getHexagonEdgeLengthAvgKm(t,n));break;default:throw oS(sv,e)}return aS(n)}finally{Vi._free(n)}}function eY(t){return t*180/Math.PI}var zB={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(W9,function(){var n,r,i;function s(o,p){if(!n)n=p;else if(!r)r=p;else{var v="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",S={};n(S),i=p(S),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([v],{type:"text/javascript"})))}}s(["exports"],function(o){var p=v;function v(f,u,g,T){this.cx=3*f,this.bx=3*(g-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(T-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=g,this.p2y=T}function S(f,u,g,T){const D=new p(f,u,g,T);return function(z){return D.solve(z)}}v.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var g=f,T=0;T<8;T++){var D=this.sampleCurveX(g)-f;if(Math.abs(D)<u)return g;var z=this.sampleCurveDerivativeX(g);if(Math.abs(z)<1e-6)break;g-=D/z}var N=0,$=1;for(g=f,T=0;T<20&&(D=this.sampleCurveX(g),!(Math.abs(D-f)<u));T++)f>D?N=g:$=g,g=.5*($-N)+N;return g},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};const M=S(.25,.1,.25,1);function k(f,u,g){return Math.min(g,Math.max(u,f))}function F(f,u,g){const T=g-u,D=((f-u)%T+T)%T+u;return D===u?g:D}function H(f,...u){for(const g of u)for(const T in g)f[T]=g[T];return f}let j=1;function ie(f,u){f.forEach(g=>{u[g]&&(u[g]=u[g].bind(u))})}function Y(f,u,g){const T={};for(const D in f)T[D]=u.call(g||this,f[D],D,f);return T}function J(f,u,g){const T={};for(const D in f)u.call(g||this,f[D],D,f)&&(T[D]=f[D]);return T}function se(f){return Array.isArray(f)?f.map(se):typeof f=="object"&&f?Y(f,se):f}const ce={};function me(f){ce[f]||(typeof console<"u"&&console.warn(f),ce[f]=!0)}function Ee(f,u,g){return(g.y-f.y)*(u.x-f.x)>(u.y-f.y)*(g.x-f.x)}function He(f){let u=0;for(let g,T,D=0,z=f.length,N=z-1;D<z;N=D++)g=f[D],T=f[N],u+=(T.x-g.x)*(g.y+T.y);return u}function Qe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ye(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(g,T,D,z)=>{const N=D||z;return u[T]=!N||N.toLowerCase(),""}),u["max-age"]){const g=parseInt(u["max-age"],10);isNaN(g)?delete u["max-age"]:u["max-age"]=g}return u}let nt,Fe,tt=null;function Ze(f){if(tt==null){const u=f.navigator?f.navigator.userAgent:null;tt=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return tt}function pt(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const Yt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){const g=window.document.createElement("canvas"),T=g.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return g.width=f.width,g.height=f.height,T.drawImage(f,0,0,f.width,f.height),T.getImageData(-u,-u,f.width+2*u,f.height+2*u)},resolveURL:f=>(nt||(nt=document.createElement("a")),nt.href=f,nt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Fe==null&&(Fe=matchMedia("(prefers-reduced-motion: reduce)")),Fe.matches)}};var Et=un;function un(f,u){this.x=f,this.y=u}un.prototype={clone:function(){return new un(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,g=f.y-this.y;return u*u+g*g},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),g=Math.sin(f),T=g*this.x+u*this.y;return this.x=u*this.x-g*this.y,this.y=T,this},_rotateAround:function(f,u){var g=Math.cos(f),T=Math.sin(f),D=u.y+T*(this.x-u.x)+g*(this.y-u.y);return this.x=u.x+g*(this.x-u.x)-T*(this.y-u.y),this.y=D,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},un.convert=function(f){return f instanceof un?f:Array.isArray(f)?new un(f[0],f[1]):f};const _t={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Tt="mapbox-tiles";let Jt,In,Tn=500,kr=50;function er(){typeof caches>"u"||Jt||(Jt=caches.open(Tt))}let or=1/0;const hr={supported:!1,testSupport:function(f){!wt&&Cr&&(rn?Mn(f):Un=f)}};let Un,Cr,wt=!1,rn=!1;function Mn(f){const u=f.createTexture();f.bindTexture(f.TEXTURE_2D,u);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Cr),f.isContextLost())return;hr.supported=!0}catch{}f.deleteTexture(u),wt=!0}typeof document<"u"&&(Cr=document.createElement("img"),Cr.onload=function(){Un&&Mn(Un),Un=null,rn=!0},Cr.onerror=function(){wt=!0,Un=null},Cr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const xt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(xt);class tr extends Error{constructor(u,g,T,D){super(`AJAXError: ${g} (${u}): ${T}`),this.status=u,this.statusText=g,this.url=T,this.body=D}}const Hn=Qe()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function xr(f,u){const g=new AbortController,T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Hn(),signal:g.signal});let D=!1,z=!1;return f.type==="json"&&T.headers.set("Accept","application/json"),((N,$,Z)=>{if(z)return;const re=Date.now();fetch(T).then(Ae=>Ae.ok?((he,pe,ye)=>{(f.type==="arrayBuffer"?he.arrayBuffer():f.type==="json"?he.json():he.text()).then(_e=>{z||(pe&&ye&&function(Ve,ze,it){if(er(),!Jt)return;const ut={status:ze.status,statusText:ze.statusText,headers:new Headers};ze.headers.forEach((at,yt)=>ut.headers.set(yt,at));const et=Ye(ze.headers.get("Cache-Control")||"");et["no-store"]||(et["max-age"]&&ut.headers.set("Expires",new Date(it+1e3*et["max-age"]).toUTCString()),new Date(ut.headers.get("Expires")).getTime()-it<42e4||function(at,yt){if(In===void 0)try{new Response(new ReadableStream),In=!0}catch{In=!1}In?yt(at.body):at.blob().then(yt)}(ze,at=>{const yt=new Response(at,ut);er(),Jt&&Jt.then(mt=>mt.put(function(Zt){const tn=Zt.indexOf("?");return tn<0?Zt:Zt.slice(0,tn)}(Ve.url),yt)).catch(mt=>me(mt.message))}))}(T,pe,ye),D=!0,u(null,_e,he.headers.get("Cache-Control"),he.headers.get("Expires")))}).catch(_e=>{z||u(new Error(_e.message))})})(Ae,null,re):Ae.blob().then(he=>u(new tr(Ae.status,Ae.statusText,f.url,he)))).catch(Ae=>{Ae.code!==20&&u(new Error(Ae.message))})})(),{cancel:()=>{z=!0,D||g.abort()}}}const lr=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!Qe()){const T=f.url.substring(0,f.url.indexOf("://"));return(_t.REGISTERED_PROTOCOLS[T]||xr)(f,u)}}if(!(/^file:/.test(g=f.url)||/^file:/.test(Hn())&&!/^\w+:/.test(g))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return xr(f,u);if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var g;return function(T,D){const z=new XMLHttpRequest;z.open(T.method||"GET",T.url,!0),T.type==="arrayBuffer"&&(z.responseType="arraybuffer");for(const N in T.headers)z.setRequestHeader(N,T.headers[N]);return T.type==="json"&&(z.responseType="text",z.setRequestHeader("Accept","application/json")),z.withCredentials=T.credentials==="include",z.onerror=()=>{D(new Error(z.statusText))},z.onload=()=>{if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let N=z.response;if(T.type==="json")try{N=JSON.parse(z.response)}catch($){return D($)}D(null,N,z.getResponseHeader("Cache-Control"),z.getResponseHeader("Expires"))}else{const N=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});D(new tr(z.status,z.statusText,T.url,N))}},z.send(T.body),{cancel:()=>z.abort()}}(f,u)},nr=function(f,u){return lr(H(f,{type:"arrayBuffer"}),u)};function ri(f){const u=window.document.createElement("a");return u.href=f,u.protocol===window.document.location.protocol&&u.host===window.document.location.host}const Vn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ki,Qn;ki=[],Qn=0;const Gi=function(f,u){if(hr.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),Qn>=_t.MAX_PARALLEL_IMAGE_REQUESTS){const z={requestParameters:f,callback:u,cancelled:!1,cancel(){this.cancelled=!0}};return ki.push(z),z}Qn++;let g=!1;const T=()=>{if(!g)for(g=!0,Qn--;ki.length&&Qn<_t.MAX_PARALLEL_IMAGE_REQUESTS;){const z=ki.shift(),{requestParameters:N,callback:$,cancelled:Z}=z;Z||(z.cancel=Gi(N,$).cancel)}},D=nr(f,(z,N,$,Z)=>{T(),z?u(z):N&&function(re,Ae){typeof createImageBitmap=="function"?function(he,pe){const ye=new Blob([new Uint8Array(he)],{type:"image/png"});createImageBitmap(ye).then(_e=>{pe(null,_e)}).catch(_e=>{pe(new Error(`Could not load image because of ${_e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(re,Ae):function(he,pe){const ye=new Image;ye.onload=()=>{pe(null,ye),URL.revokeObjectURL(ye.src),ye.onload=null,window.requestAnimationFrame(()=>{ye.src=Vn})},ye.onerror=()=>pe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _e=new Blob([new Uint8Array(he)],{type:"image/png"});ye.src=he.byteLength?URL.createObjectURL(_e):Vn}(re,Ae)}(N,(re,Ae)=>{re!=null?u(re):Ae!=null&&u(null,Ae,{cacheControl:$,expires:Z})})});return{cancel:()=>{D.cancel(),T()}}};function yo(f,u,g){g[f]&&g[f].indexOf(u)!==-1||(g[f]=g[f]||[],g[f].push(u))}function jr(f,u,g){if(g&&g[f]){const T=g[f].indexOf(u);T!==-1&&g[f].splice(T,1)}}class Ii{constructor(u,g={}){H(this,g),this.type=u}}class $o extends Ii{constructor(u,g={}){super("error",H({error:u},g))}}class ls{on(u,g){return this._listeners=this._listeners||{},yo(u,g,this._listeners),this}off(u,g){return jr(u,g,this._listeners),jr(u,g,this._oneTimeListeners),this}once(u,g){return this._oneTimeListeners=this._oneTimeListeners||{},yo(u,g,this._oneTimeListeners),this}fire(u,g){typeof u=="string"&&(u=new Ii(u,g||{}));const T=u.type;if(this.listens(T)){u.target=this;const D=this._listeners&&this._listeners[T]?this._listeners[T].slice():[];for(const $ of D)$.call(this,u);const z=this._oneTimeListeners&&this._oneTimeListeners[T]?this._oneTimeListeners[T].slice():[];for(const $ of z)jr(T,$,this._oneTimeListeners),$.call(this,u);const N=this._eventedParent;N&&(H(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),N.fire(u))}else u instanceof $o&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,g){return this._eventedParent=u,this._eventedParentData=g,this}}var ht={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class It{constructor(u,g,T,D){this.message=(u?`${u}: `:"")+T,D&&(this.identifier=D),g!=null&&g.__line__&&(this.line=g.__line__)}}function Us(f){const u=f.value;return u?[new It(f.key,u,"constants have been deprecated as of v8")]:[]}function bi(f,...u){for(const g of u)for(const T in g)f[T]=g[T];return f}function Bn(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function $i(f){if(Array.isArray(f))return f.map($i);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const g in f)u[g]=$i(f[g]);return u}return Bn(f)}class Li extends Error{constructor(u,g){super(g),this.message=g,this.key=u}}class Di{constructor(u,g=[]){this.parent=u,this.bindings={};for(const[T,D]of g)this.bindings[T]=D}concat(u){return new Di(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const As={kind:"null"},Lt={kind:"number"},Sn={kind:"string"},bn={kind:"boolean"},Rr={kind:"color"},Ts={kind:"object"},yn={kind:"value"},Xe={kind:"collator"},Zr={kind:"formatted"},Vs={kind:"padding"},Fr={kind:"resolvedImage"};function ci(f,u){return{kind:"array",itemType:f,N:u}}function Yn(f){if(f.kind==="array"){const u=Yn(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const Gs=[As,Lt,Sn,bn,Rr,Zr,Ts,ci(yn),Vs,Fr];function ji(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!ji(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const g of Gs)if(!ji(g,u))return null}}return`Expected ${Yn(f)} but found ${Yn(u)} instead.`}function Hi(f,u){return u.some(g=>g.kind===f.kind)}function Ri(f,u){return u.some(g=>g==="null"?f===null:g==="array"?Array.isArray(f):g==="object"?f&&!Array.isArray(f)&&typeof f=="object":g===typeof f)}var us,Nr={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function K(f){return(f=Math.round(f))<0?0:f>255?255:f}function Q(f){return K(f[f.length-1]==="%"?parseFloat(f)/100*255:parseInt(f))}function te(f){return(u=f[f.length-1]==="%"?parseFloat(f)/100:parseFloat(f))<0?0:u>1?1:u;var u}function fe(f,u,g){return g<0?g+=1:g>1&&(g-=1),6*g<1?f+(u-f)*g*6:2*g<1?u:3*g<2?f+(u-f)*(2/3-g)*6:f}try{us={}.parseCSSColor=function(f){var u,g=f.replace(/ /g,"").toLowerCase();if(g in Nr)return Nr[g].slice();if(g[0]==="#")return g.length===4?(u=parseInt(g.substr(1),16))>=0&&u<=4095?[(3840&u)>>4|(3840&u)>>8,240&u|(240&u)>>4,15&u|(15&u)<<4,1]:null:g.length===7&&(u=parseInt(g.substr(1),16))>=0&&u<=16777215?[(16711680&u)>>16,(65280&u)>>8,255&u,1]:null;var T=g.indexOf("("),D=g.indexOf(")");if(T!==-1&&D+1===g.length){var z=g.substr(0,T),N=g.substr(T+1,D-(T+1)).split(","),$=1;switch(z){case"rgba":if(N.length!==4)return null;$=te(N.pop());case"rgb":return N.length!==3?null:[Q(N[0]),Q(N[1]),Q(N[2]),$];case"hsla":if(N.length!==4)return null;$=te(N.pop());case"hsl":if(N.length!==3)return null;var Z=(parseFloat(N[0])%360+360)%360/360,re=te(N[1]),Ae=te(N[2]),he=Ae<=.5?Ae*(re+1):Ae+re-Ae*re,pe=2*Ae-he;return[K(255*fe(pe,he,Z+1/3)),K(255*fe(pe,he,Z)),K(255*fe(pe,he,Z-1/3)),$];default:return null}}return null}}catch{}class a{constructor(u,g,T,D=1){this.r=u,this.g=g,this.b=T,this.a=D}static parse(u){if(!u)return;if(u instanceof a)return u;if(typeof u!="string")return;const g=us(u);return g?new a(g[0]/255*g[3],g[1]/255*g[3],g[2]/255*g[3],g[3]):void 0}toString(){const[u,g,T,D]=this.toArray();return`rgba(${Math.round(u)},${Math.round(g)},${Math.round(T)},${D})`}toArray(){const{r:u,g,b:T,a:D}=this;return D===0?[0,0,0,0]:[255*u/D,255*g/D,255*T/D,D]}}a.black=new a(0,0,0,1),a.white=new a(1,1,1,1),a.transparent=new a(0,0,0,0),a.red=new a(1,0,0,1);class G{constructor(u,g,T){this.sensitivity=u?g?"variant":"case":g?"accent":"base",this.locale=T,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,g){return this.collator.compare(u,g)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Le{constructor(u,g,T,D,z){this.text=u,this.image=g,this.scale=T,this.fontStack=D,this.textColor=z}}class ke{constructor(u){this.sections=u}static fromString(u){return new ke([new Le(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof ke?u:ke.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Pe{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Pe)return u;if(typeof u=="number")return new Pe([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const g of u)if(typeof g!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Pe(u)}}toString(){return JSON.stringify(this.values)}}class Ie{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new Ie({name:u,available:!1}):null}}function qe(f,u,g,T){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof g=="number"&&g>=0&&g<=255?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:`Invalid rgba value [${[f,u,g,T].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof T=="number"?[f,u,g,T]:[f,u,g]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function At(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof a||f instanceof G||f instanceof ke||f instanceof Pe||f instanceof Ie)return!0;if(Array.isArray(f)){for(const u of f)if(!At(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!At(f[u]))return!1;return!0}return!1}function We(f){if(f===null)return As;if(typeof f=="string")return Sn;if(typeof f=="boolean")return bn;if(typeof f=="number")return Lt;if(f instanceof a)return Rr;if(f instanceof G)return Xe;if(f instanceof ke)return Zr;if(f instanceof Pe)return Vs;if(f instanceof Ie)return Fr;if(Array.isArray(f)){const u=f.length;let g;for(const T of f){const D=We(T);if(g){if(g===D)continue;g=yn;break}g=D}return ci(g||yn,u)}return Ts}function dt(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof a||f instanceof ke||f instanceof Pe||f instanceof Ie?f.toString():JSON.stringify(f)}class Dt{constructor(u,g){this.type=u,this.value=g}static parse(u,g){if(u.length!==2)return g.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!At(u[1]))return g.error("invalid value");const T=u[1];let D=We(T);const z=g.expectedType;return D.kind!=="array"||D.N!==0||!z||z.kind!=="array"||typeof z.N=="number"&&z.N!==0||(D=z),new Dt(D,T)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Rt{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const sn={string:Sn,number:Lt,boolean:bn,object:Ts};class jt{constructor(u,g){this.type=u,this.args=g}static parse(u,g){if(u.length<2)return g.error("Expected at least one argument.");let T,D=1;const z=u[0];if(z==="array"){let $,Z;if(u.length>2){const re=u[1];if(typeof re!="string"||!(re in sn)||re==="object")return g.error('The item type argument of "array" must be one of string, number, boolean',1);$=sn[re],D++}else $=yn;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return g.error('The length argument to "array" must be a positive integer literal',2);Z=u[2],D++}T=ci($,Z)}else{if(!sn[z])throw new Error(`Types doesn't contain name = ${z}`);T=sn[z]}const N=[];for(;D<u.length;D++){const $=g.parse(u[D],D,yn);if(!$)return null;N.push($)}return new jt(T,N)}evaluate(u){for(let g=0;g<this.args.length;g++){const T=this.args[g].evaluate(u);if(!ji(this.type,We(T)))return T;if(g===this.args.length-1)throw new Rt(`Expected value to be of type ${Yn(this.type)}, but found ${Yn(We(T))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const pn={"to-boolean":bn,"to-color":Rr,"to-number":Lt,"to-string":Sn};class qt{constructor(u,g){this.type=u,this.args=g}static parse(u,g){if(u.length<2)return g.error("Expected at least one argument.");const T=u[0];if(!pn[T])throw new Error(`Can't parse ${T} as it is not part of the known types`);if((T==="to-boolean"||T==="to-string")&&u.length!==2)return g.error("Expected one argument.");const D=pn[T],z=[];for(let N=1;N<u.length;N++){const $=g.parse(u[N],N,yn);if(!$)return null;z.push($)}return new qt(D,z)}evaluate(u){if(this.type.kind==="boolean")return!!this.args[0].evaluate(u);if(this.type.kind==="color"){let g,T;for(const D of this.args){if(g=D.evaluate(u),T=null,g instanceof a)return g;if(typeof g=="string"){const z=u.parseColor(g);if(z)return z}else if(Array.isArray(g)&&(T=g.length<3||g.length>4?`Invalid rbga value ${JSON.stringify(g)}: expected an array containing either three or four numeric values.`:qe(g[0],g[1],g[2],g[3]),!T))return new a(g[0]/255,g[1]/255,g[2]/255,g[3])}throw new Rt(T||`Could not parse color from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}if(this.type.kind==="padding"){let g;for(const T of this.args){g=T.evaluate(u);const D=Pe.parse(g);if(D)return D}throw new Rt(`Could not parse padding from value '${typeof g=="string"?g:JSON.stringify(g)}'`)}if(this.type.kind==="number"){let g=null;for(const T of this.args){if(g=T.evaluate(u),g===null)return 0;const D=Number(g);if(!isNaN(D))return D}throw new Rt(`Could not convert ${JSON.stringify(g)} to number.`)}return this.type.kind==="formatted"?ke.fromString(dt(this.args[0].evaluate(u))):this.type.kind==="resolvedImage"?Ie.fromString(dt(this.args[0].evaluate(u))):dt(this.args[0].evaluate(u))}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const an=["Unknown","Point","LineString","Polygon"];class xn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?an[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let g=this._parseColorCache[u];return g||(g=this._parseColorCache[u]=a.parse(u)),g}}class Ft{constructor(u,g,T,D){this.name=u,this.type=g,this._evaluate=T,this.args=D}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,g){const T=u[0],D=Ft.definitions[T];if(!D)return g.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0);const z=Array.isArray(D)?D[0]:D.type,N=Array.isArray(D)?[[D[1],D[2]]]:D.overloads,$=N.filter(([re])=>!Array.isArray(re)||re.length===u.length-1);let Z=null;for(const[re,Ae]of $){Z=new bt(g.registry,g.path,null,g.scope);const he=[];let pe=!1;for(let ye=1;ye<u.length;ye++){const _e=u[ye],Ve=Array.isArray(re)?re[ye-1]:re.type,ze=Z.parse(_e,1+he.length,Ve);if(!ze){pe=!0;break}he.push(ze)}if(!pe)if(Array.isArray(re)&&re.length!==he.length)Z.error(`Expected ${re.length} arguments, but found ${he.length} instead.`);else{for(let ye=0;ye<he.length;ye++){const _e=Array.isArray(re)?re[ye]:re.type,Ve=he[ye];Z.concat(ye+1).checkSubtype(_e,Ve.type)}if(Z.errors.length===0)return new Ft(T,z,Ae,he)}}if($.length===1)g.errors.push(...Z.errors);else{const re=($.length?$:N).map(([he])=>{return pe=he,Array.isArray(pe)?`(${pe.map(Yn).join(", ")})`:`(${Yn(pe.type)}...)`;var pe}).join(" | "),Ae=[];for(let he=1;he<u.length;he++){const pe=g.parse(u[he],1+Ae.length);if(!pe)return null;Ae.push(Yn(pe.type))}g.error(`Expected arguments of type ${re}, but found (${Ae.join(", ")}) instead.`)}return null}static register(u,g){Ft.definitions=g;for(const T in g)u[T]=Ft}}class Oe{constructor(u,g,T){this.type=Xe,this.locale=T,this.caseSensitive=u,this.diacriticSensitive=g}static parse(u,g){if(u.length!==2)return g.error("Expected one argument.");const T=u[1];if(typeof T!="object"||Array.isArray(T))return g.error("Collator options argument must be an object.");const D=g.parse(T["case-sensitive"]!==void 0&&T["case-sensitive"],1,bn);if(!D)return null;const z=g.parse(T["diacritic-sensitive"]!==void 0&&T["diacritic-sensitive"],1,bn);if(!z)return null;let N=null;return T.locale&&(N=g.parse(T.locale,1,Sn),!N)?null:new Oe(D,z,N)}evaluate(u){return new G(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const Mt=8192;function Ce(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function cn(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function hi(f,u){const g=(180+f[0])/360,T=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,D=Math.pow(2,u.z);return[Math.round(g*D*Mt),Math.round(T*D*Mt)]}function rr(f,u,g){const T=f[0]-u[0],D=f[1]-u[1],z=f[0]-g[0],N=f[1]-g[1];return T*N-z*D==0&&T*z<=0&&D*N<=0}function pa(f,u){let g=!1;for(let N=0,$=u.length;N<$;N++){const Z=u[N];for(let re=0,Ae=Z.length;re<Ae-1;re++){if(rr(f,Z[re],Z[re+1]))return!1;(D=Z[re])[1]>(T=f)[1]!=(z=Z[re+1])[1]>T[1]&&T[0]<(z[0]-D[0])*(T[1]-D[1])/(z[1]-D[1])+D[0]&&(g=!g)}}var T,D,z;return g}function De(f,u){for(let g=0;g<u.length;g++)if(pa(f,u[g]))return!0;return!1}function Ha(f,u,g,T){const D=T[0]-g[0],z=T[1]-g[1],N=(f[0]-g[0])*z-D*(f[1]-g[1]),$=(u[0]-g[0])*z-D*(u[1]-g[1]);return N>0&&$<0||N<0&&$>0}function we(f,u,g){for(const re of g)for(let Ae=0;Ae<re.length-1;++Ae)if(($=[(N=re[Ae+1])[0]-(z=re[Ae])[0],N[1]-z[1]])[0]*(Z=[(D=u)[0]-(T=f)[0],D[1]-T[1]])[1]-$[1]*Z[0]!=0&&Ha(T,D,z,N)&&Ha(z,N,T,D))return!0;var T,D,z,N,$,Z;return!1}function jo(f,u){for(let g=0;g<f.length;++g)if(!pa(f[g],u))return!1;for(let g=0;g<f.length-1;++g)if(we(f[g],f[g+1],u))return!1;return!0}function Ss(f,u){for(let g=0;g<u.length;g++)if(jo(f,u[g]))return!0;return!1}function Wa(f,u,g){const T=[];for(let D=0;D<f.length;D++){const z=[];for(let N=0;N<f[D].length;N++){const $=hi(f[D][N],g);Ce(u,$),z.push($)}T.push(z)}return T}function Qa(f,u,g){const T=[];for(let D=0;D<f.length;D++){const z=Wa(f[D],u,g);T.push(z)}return T}function ga(f,u,g,T){if(f[0]<g[0]||f[0]>g[2]){const D=.5*T;let z=f[0]-g[0]>D?-T:g[0]-f[0]>D?T:0;z===0&&(z=f[0]-g[2]>D?-T:g[2]-f[0]>D?T:0),f[0]+=z}Ce(u,f)}function Ml(f,u,g,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],N=[];for(const $ of f)for(const Z of $){const re=[Z.x+z[0],Z.y+z[1]];ga(re,u,g,D),N.push(re)}return N}function ma(f,u,g,T){const D=Math.pow(2,T.z)*Mt,z=[T.x*Mt,T.y*Mt],N=[];for(const Z of f){const re=[];for(const Ae of Z){const he=[Ae.x+z[0],Ae.y+z[1]];Ce(u,he),re.push(he)}N.push(re)}if(u[2]-u[0]<=D/2){($=u)[0]=$[1]=1/0,$[2]=$[3]=-1/0;for(const Z of N)for(const re of Z)ga(re,u,g,D)}var $;return N}class ii{constructor(u,g){this.type=bn,this.geojson=u,this.geometries=g}static parse(u,g){if(u.length!==2)return g.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(At(u[1])){const T=u[1];if(T.type==="FeatureCollection")for(let D=0;D<T.features.length;++D){const z=T.features[D].geometry.type;if(z==="Polygon"||z==="MultiPolygon")return new ii(T,T.features[D].geometry)}else if(T.type==="Feature"){const D=T.geometry.type;if(D==="Polygon"||D==="MultiPolygon")return new ii(T,T.geometry)}else if(T.type==="Polygon"||T.type==="MultiPolygon")return new ii(T,T)}return g.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(g,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],N=g.canonicalID();if(T.type==="Polygon"){const $=Wa(T.coordinates,z,N),Z=Ml(g.geometry(),D,z,N);if(!cn(D,z))return!1;for(const re of Z)if(!pa(re,$))return!1}if(T.type==="MultiPolygon"){const $=Qa(T.coordinates,z,N),Z=Ml(g.geometry(),D,z,N);if(!cn(D,z))return!1;for(const re of Z)if(!De(re,$))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(g,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],N=g.canonicalID();if(T.type==="Polygon"){const $=Wa(T.coordinates,z,N),Z=ma(g.geometry(),D,z,N);if(!cn(D,z))return!1;for(const re of Z)if(!jo(re,$))return!1}if(T.type==="MultiPolygon"){const $=Qa(T.coordinates,z,N),Z=ma(g.geometry(),D,z,N);if(!cn(D,z))return!1;for(const re of Z)if(!Ss(re,$))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ge(f){if(f instanceof Ft&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof ii)return!1;let u=!0;return f.eachChild(g=>{u&&!ge(g)&&(u=!1)}),u}function Te(f){if(f instanceof Ft&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(g=>{u&&!Te(g)&&(u=!1)}),u}function Ne(f,u){if(f instanceof Ft&&u.indexOf(f.name)>=0)return!1;let g=!0;return f.eachChild(T=>{g&&!Ne(T,u)&&(g=!1)}),g}class lt{constructor(u,g){this.type=g.type,this.name=u,this.boundExpression=g}static parse(u,g){if(u.length!==2||typeof u[1]!="string")return g.error("'var' expression requires exactly one string literal argument.");const T=u[1];return g.scope.has(T)?new lt(T,g.scope.get(T)):g.error(`Unknown variable "${T}". Make sure "${T}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class bt{constructor(u,g=[],T,D=new Di,z=[]){this.registry=u,this.path=g,this.key=g.map(N=>`[${N}]`).join(""),this.scope=D,this.errors=z,this.expectedType=T}parse(u,g,T,D,z={}){return g?this.concat(g,T,D)._parse(u,z):this._parse(u,z)}_parse(u,g){function T(D,z,N){return N==="assert"?new jt(z,[D]):N==="coerce"?new qt(z,[D]):D}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const D=u[0];if(typeof D!="string")return this.error(`Expression name must be a string, but found ${typeof D} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const z=this.registry[D];if(z){let N=z.parse(u,this);if(!N)return null;if(this.expectedType){const $=this.expectedType,Z=N.type;if($.kind!=="string"&&$.kind!=="number"&&$.kind!=="boolean"&&$.kind!=="object"&&$.kind!=="array"||Z.kind!=="value")if($.kind!=="color"&&$.kind!=="formatted"&&$.kind!=="resolvedImage"||Z.kind!=="value"&&Z.kind!=="string")if($.kind!=="padding"||Z.kind!=="value"&&Z.kind!=="number"&&Z.kind!=="array"){if(this.checkSubtype($,Z))return null}else N=T(N,$,g.typeAnnotation||"coerce");else N=T(N,$,g.typeAnnotation||"coerce");else N=T(N,$,g.typeAnnotation||"assert")}if(!(N instanceof Dt)&&N.type.kind!=="resolvedImage"&&Qt(N)){const $=new xn;try{N=new Dt(N.type,N.evaluate($))}catch(Z){return this.error(Z.message),null}}return N}return this.error(`Unknown expression "${D}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,g,T){const D=typeof u=="number"?this.path.concat(u):this.path,z=T?this.scope.concat(T):this.scope;return new bt(this.registry,D,g||null,z,this.errors)}error(u,...g){const T=`${this.key}${g.map(D=>`[${D}]`).join("")}`;this.errors.push(new Li(T,u))}checkSubtype(u,g){const T=ji(u,g);return T&&this.error(T),T}}function Qt(f){if(f instanceof lt)return Qt(f.boundExpression);if(f instanceof Ft&&f.name==="error"||f instanceof Oe||f instanceof ii)return!1;const u=f instanceof qt||f instanceof jt;let g=!0;return f.eachChild(T=>{g=u?g&&Qt(T):g&&T instanceof Dt}),!!g&&ge(f)&&Ne(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ln(f,u){const g=f.length-1;let T,D,z=0,N=g,$=0;for(;z<=N;)if($=Math.floor((z+N)/2),T=f[$],D=f[$+1],T<=u){if($===g||u<D)return $;z=$+1}else{if(!(T>u))throw new Rt("Input is not a number.");N=$-1}return 0}class Dr{constructor(u,g,T){this.type=u,this.input=g,this.labels=[],this.outputs=[];for(const[D,z]of T)this.labels.push(D),this.outputs.push(z)}static parse(u,g){if(u.length-1<4)return g.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return g.error("Expected an even number of arguments.");const T=g.parse(u[1],1,Lt);if(!T)return null;const D=[];let z=null;g.expectedType&&g.expectedType.kind!=="value"&&(z=g.expectedType);for(let N=1;N<u.length;N+=2){const $=N===1?-1/0:u[N],Z=u[N+1],re=N,Ae=N+1;if(typeof $!="number")return g.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',re);if(D.length&&D[D.length-1][0]>=$)return g.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',re);const he=g.parse(Z,Ae,z);if(!he)return null;z=z||he.type,D.push([$,he])}return new Dr(z,T,D)}evaluate(u){const g=this.labels,T=this.outputs;if(g.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=g[0])return T[0].evaluate(u);const z=g.length;return D>=g[z-1]?T[z-1].evaluate(u):T[Ln(g,D)].evaluate(u)}eachChild(u){u(this.input);for(const g of this.outputs)u(g)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function en(f,u,g){return f*(1-g)+u*g}var Br=Object.freeze({__proto__:null,number:en,color:function(f,u,g){return new a(en(f.r,u.r,g),en(f.g,u.g,g),en(f.b,u.b,g),en(f.a,u.a,g))},array:function(f,u,g){return f.map((T,D)=>en(T,u[D],g))},padding:function(f,u,g){const T=f.values,D=u.values;return new Pe([en(T[0],D[0],g),en(T[1],D[1],g),en(T[2],D[2],g),en(T[3],D[3],g)])}});const Gn=.95047,vA=1.08883,xA=4/29,wA=6/29,iu=3*wA*wA,su=Math.PI/180,bA=180/Math.PI;function Pl(f){return f>.008856451679035631?Math.pow(f,1/3):f/iu+xA}function kl(f){return f>wA?f*f*f:iu*(f-xA)}function EA(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function TA(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Xn(f){const u=TA(f.r),g=TA(f.g),T=TA(f.b),D=Pl((.4124564*u+.3575761*g+.1804375*T)/Gn),z=Pl((.2126729*u+.7151522*g+.072175*T)/1);return{l:116*z-16,a:500*(D-z),b:200*(z-Pl((.0193339*u+.119192*g+.9503041*T)/vA)),alpha:f.a}}function ou(f){let u=(f.l+16)/116,g=isNaN(f.a)?u:u+f.a/500,T=isNaN(f.b)?u:u-f.b/200;return u=1*kl(u),g=Gn*kl(g),T=vA*kl(T),new a(EA(3.2404542*g-1.5371385*u-.4985314*T),EA(-.969266*g+1.8760108*u+.041556*T),EA(.0556434*g-.2040259*u+1.0572252*T),f.alpha)}function gc(f,u,g){const T=u-f;return f+g*(T>180||T<-180?T-360*Math.round(T/360):T)}const Il={forward:Xn,reverse:ou,interpolate:function(f,u,g){return{l:en(f.l,u.l,g),a:en(f.a,u.a,g),b:en(f.b,u.b,g),alpha:en(f.alpha,u.alpha,g)}}},Yr={forward:function(f){const{l:u,a:g,b:T}=Xn(f),D=Math.atan2(T,g)*bA;return{h:D<0?D+360:D,c:Math.sqrt(g*g+T*T),l:u,alpha:f.a}},reverse:function(f){const u=f.h*su,g=f.c;return ou({l:f.l,a:Math.cos(u)*g,b:Math.sin(u)*g,alpha:f.alpha})},interpolate:function(f,u,g){return{h:gc(f.h,u.h,g),c:en(f.c,u.c,g),l:en(f.l,u.l,g),alpha:en(f.alpha,u.alpha,g)}}};var Ho=Object.freeze({__proto__:null,lab:Il,hcl:Yr});class zn{constructor(u,g,T,D,z){this.type=u,this.operator=g,this.interpolation=T,this.input=D,this.labels=[],this.outputs=[];for(const[N,$]of z)this.labels.push(N),this.outputs.push($)}static interpolationFactor(u,g,T,D){let z=0;if(u.name==="exponential")z=Cs(g,u.base,T,D);else if(u.name==="linear")z=Cs(g,1,T,D);else if(u.name==="cubic-bezier"){const N=u.controlPoints;z=new p(N[0],N[1],N[2],N[3]).solve(Cs(g,1,T,D))}return z}static parse(u,g){let[T,D,z,...N]=u;if(!Array.isArray(D)||D.length===0)return g.error("Expected an interpolation type expression.",1);if(D[0]==="linear")D={name:"linear"};else if(D[0]==="exponential"){const re=D[1];if(typeof re!="number")return g.error("Exponential interpolation requires a numeric base.",1,1);D={name:"exponential",base:re}}else{if(D[0]!=="cubic-bezier")return g.error(`Unknown interpolation type ${String(D[0])}`,1,0);{const re=D.slice(1);if(re.length!==4||re.some(Ae=>typeof Ae!="number"||Ae<0||Ae>1))return g.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);D={name:"cubic-bezier",controlPoints:re}}}if(u.length-1<4)return g.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return g.error("Expected an even number of arguments.");if(z=g.parse(z,2,Lt),!z)return null;const $=[];let Z=null;T==="interpolate-hcl"||T==="interpolate-lab"?Z=Rr:g.expectedType&&g.expectedType.kind!=="value"&&(Z=g.expectedType);for(let re=0;re<N.length;re+=2){const Ae=N[re],he=N[re+1],pe=re+3,ye=re+4;if(typeof Ae!="number")return g.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pe);if($.length&&$[$.length-1][0]>=Ae)return g.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',pe);const _e=g.parse(he,ye,Z);if(!_e)return null;Z=Z||_e.type,$.push([Ae,_e])}return Z.kind==="number"||Z.kind==="color"||Z.kind==="padding"||Z.kind==="array"&&Z.itemType.kind==="number"&&typeof Z.N=="number"?new zn(Z,T,D,z,$):g.error(`Type ${Yn(Z)} is not interpolatable.`)}evaluate(u){const g=this.labels,T=this.outputs;if(g.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=g[0])return T[0].evaluate(u);const z=g.length;if(D>=g[z-1])return T[z-1].evaluate(u);const N=Ln(g,D),$=zn.interpolationFactor(this.interpolation,D,g[N],g[N+1]),Z=T[N].evaluate(u),re=T[N+1].evaluate(u);return this.operator==="interpolate"?Br[this.type.kind.toLowerCase()](Z,re,$):this.operator==="interpolate-hcl"?Yr.reverse(Yr.interpolate(Yr.forward(Z),Yr.forward(re),$)):Il.reverse(Il.interpolate(Il.forward(Z),Il.forward(re),$))}eachChild(u){u(this.input);for(const g of this.outputs)u(g)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function Cs(f,u,g,T){const D=T-g,z=f-g;return D===0?0:u===1?z/D:(Math.pow(u,z)-1)/(Math.pow(u,D)-1)}class si{constructor(u,g){this.type=u,this.args=g}static parse(u,g){if(u.length<2)return g.error("Expectected at least one argument.");let T=null;const D=g.expectedType;D&&D.kind!=="value"&&(T=D);const z=[];for(const $ of u.slice(1)){const Z=g.parse($,1+z.length,T,void 0,{typeAnnotation:"omit"});if(!Z)return null;T=T||Z.type,z.push(Z)}if(!T)throw new Error("No output type");const N=D&&z.some($=>ji(D,$.type));return new si(N?yn:T,z)}evaluate(u){let g,T=null,D=0;for(const z of this.args)if(D++,T=z.evaluate(u),T&&T instanceof Ie&&!T.available&&(g||(g=T.name),T=null,D===this.args.length&&(T=g)),T!==null)break;return T}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class _o{constructor(u,g){this.type=g.type,this.bindings=[].concat(u),this.result=g}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const g of this.bindings)u(g[1]);u(this.result)}static parse(u,g){if(u.length<4)return g.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const T=[];for(let z=1;z<u.length-1;z+=2){const N=u[z];if(typeof N!="string")return g.error(`Expected string, but found ${typeof N} instead.`,z);if(/[^a-zA-Z0-9_]/.test(N))return g.error("Variable names must contain only alphanumeric characters or '_'.",z);const $=g.parse(u[z+1],z+1);if(!$)return null;T.push([N,$])}const D=g.parse(u[u.length-1],u.length-1,g.expectedType,T);return D?new _o(T,D):null}outputDefined(){return this.result.outputDefined()}}class Ll{constructor(u,g,T){this.type=u,this.index=g,this.input=T}static parse(u,g){if(u.length!==3)return g.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,Lt),D=g.parse(u[2],2,ci(g.expectedType||yn));return T&&D?new Ll(D.type.itemType,T,D):null}evaluate(u){const g=this.index.evaluate(u),T=this.input.evaluate(u);if(g<0)throw new Rt(`Array index out of bounds: ${g} < 0.`);if(g>=T.length)throw new Rt(`Array index out of bounds: ${g} > ${T.length-1}.`);if(g!==Math.floor(g))throw new Rt(`Array index must be an integer, but found ${g} instead.`);return T[g]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class Wo{constructor(u,g){this.type=bn,this.needle=u,this.haystack=g}static parse(u,g){if(u.length!==3)return g.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,yn),D=g.parse(u[2],2,yn);return T&&D?Hi(T.type,[bn,Sn,Lt,As,yn])?new Wo(T,D):g.error(`Expected first argument to be of type boolean, string, number or null, but found ${Yn(T.type)} instead`):null}evaluate(u){const g=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!T)return!1;if(!Ri(g,["boolean","string","number","null"]))throw new Rt(`Expected first argument to be of type boolean, string, number or null, but found ${Yn(We(g))} instead.`);if(!Ri(T,["string","array"]))throw new Rt(`Expected second argument to be of type array or string, but found ${Yn(We(T))} instead.`);return T.indexOf(g)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class ya{constructor(u,g,T){this.type=Lt,this.needle=u,this.haystack=g,this.fromIndex=T}static parse(u,g){if(u.length<=2||u.length>=5)return g.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,yn),D=g.parse(u[2],2,yn);if(!T||!D)return null;if(!Hi(T.type,[bn,Sn,Lt,As,yn]))return g.error(`Expected first argument to be of type boolean, string, number or null, but found ${Yn(T.type)} instead`);if(u.length===4){const z=g.parse(u[3],3,Lt);return z?new ya(T,D,z):null}return new ya(T,D)}evaluate(u){const g=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!Ri(g,["boolean","string","number","null"]))throw new Rt(`Expected first argument to be of type boolean, string, number or null, but found ${Yn(We(g))} instead.`);if(!Ri(T,["string","array"]))throw new Rt(`Expected second argument to be of type array or string, but found ${Yn(We(T))} instead.`);if(this.fromIndex){const D=this.fromIndex.evaluate(u);return T.indexOf(g,D)}return T.indexOf(g)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class vo{constructor(u,g,T,D,z,N){this.inputType=u,this.type=g,this.input=T,this.cases=D,this.outputs=z,this.otherwise=N}static parse(u,g){if(u.length<5)return g.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return g.error("Expected an even number of arguments.");let T,D;g.expectedType&&g.expectedType.kind!=="value"&&(D=g.expectedType);const z={},N=[];for(let re=2;re<u.length-1;re+=2){let Ae=u[re];const he=u[re+1];Array.isArray(Ae)||(Ae=[Ae]);const pe=g.concat(re);if(Ae.length===0)return pe.error("Expected at least one branch label.");for(const _e of Ae){if(typeof _e!="number"&&typeof _e!="string")return pe.error("Branch labels must be numbers or strings.");if(typeof _e=="number"&&Math.abs(_e)>Number.MAX_SAFE_INTEGER)return pe.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof _e=="number"&&Math.floor(_e)!==_e)return pe.error("Numeric branch labels must be integer values.");if(T){if(pe.checkSubtype(T,We(_e)))return null}else T=We(_e);if(z[String(_e)]!==void 0)return pe.error("Branch labels must be unique.");z[String(_e)]=N.length}const ye=g.parse(he,re,D);if(!ye)return null;D=D||ye.type,N.push(ye)}const $=g.parse(u[1],1,yn);if(!$)return null;const Z=g.parse(u[u.length-1],u.length-1,D);return Z?$.type.kind!=="value"&&g.concat(1).checkSubtype(T,$.type)?null:new vo(T,D,$,z,N,Z):null}evaluate(u){const g=this.input.evaluate(u);return(We(g)===this.inputType&&this.outputs[this.cases[g]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class SA{constructor(u,g,T){this.type=u,this.branches=g,this.otherwise=T}static parse(u,g){if(u.length<4)return g.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return g.error("Expected an odd number of arguments.");let T;g.expectedType&&g.expectedType.kind!=="value"&&(T=g.expectedType);const D=[];for(let N=1;N<u.length-1;N+=2){const $=g.parse(u[N],N,bn);if(!$)return null;const Z=g.parse(u[N+1],N+1,T);if(!Z)return null;D.push([$,Z]),T=T||Z.type}const z=g.parse(u[u.length-1],u.length-1,T);if(!z)return null;if(!T)throw new Error("Can't infer output type");return new SA(T,D,z)}evaluate(u){for(const[g,T]of this.branches)if(g.evaluate(u))return T.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[g,T]of this.branches)u(g),u(T);u(this.otherwise)}outputDefined(){return this.branches.every(([u,g])=>g.outputDefined())&&this.otherwise.outputDefined()}}class qa{constructor(u,g,T,D){this.type=u,this.input=g,this.beginIndex=T,this.endIndex=D}static parse(u,g){if(u.length<=2||u.length>=5)return g.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=g.parse(u[1],1,yn),D=g.parse(u[2],2,Lt);if(!T||!D)return null;if(!Hi(T.type,[ci(yn),Sn,yn]))return g.error(`Expected first argument to be of type array or string, but found ${Yn(T.type)} instead`);if(u.length===4){const z=g.parse(u[3],3,Lt);return z?new qa(T.type,T,D,z):null}return new qa(T.type,T,D)}evaluate(u){const g=this.input.evaluate(u),T=this.beginIndex.evaluate(u);if(!Ri(g,["string","array"]))throw new Rt(`Expected first argument to be of type array or string, but found ${Yn(We(g))} instead.`);if(this.endIndex){const D=this.endIndex.evaluate(u);return g.slice(T,D)}return g.slice(T)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function Qo(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function Wi(f,u,g,T){return T.compare(u,g)===0}function Qi(f,u,g){const T=f!=="=="&&f!=="!=";return class OB{constructor(z,N,$){this.type=bn,this.lhs=z,this.rhs=N,this.collator=$,this.hasUntypedArgument=z.type.kind==="value"||N.type.kind==="value"}static parse(z,N){if(z.length!==3&&z.length!==4)return N.error("Expected two or three arguments.");const $=z[0];let Z=N.parse(z[1],1,yn);if(!Z)return null;if(!Qo($,Z.type))return N.concat(1).error(`"${$}" comparisons are not supported for type '${Yn(Z.type)}'.`);let re=N.parse(z[2],2,yn);if(!re)return null;if(!Qo($,re.type))return N.concat(2).error(`"${$}" comparisons are not supported for type '${Yn(re.type)}'.`);if(Z.type.kind!==re.type.kind&&Z.type.kind!=="value"&&re.type.kind!=="value")return N.error(`Cannot compare types '${Yn(Z.type)}' and '${Yn(re.type)}'.`);T&&(Z.type.kind==="value"&&re.type.kind!=="value"?Z=new jt(re.type,[Z]):Z.type.kind!=="value"&&re.type.kind==="value"&&(re=new jt(Z.type,[re])));let Ae=null;if(z.length===4){if(Z.type.kind!=="string"&&re.type.kind!=="string"&&Z.type.kind!=="value"&&re.type.kind!=="value")return N.error("Cannot use collator to compare non-string types.");if(Ae=N.parse(z[3],3,Xe),!Ae)return null}return new OB(Z,re,Ae)}evaluate(z){const N=this.lhs.evaluate(z),$=this.rhs.evaluate(z);if(T&&this.hasUntypedArgument){const Z=We(N),re=We($);if(Z.kind!==re.kind||Z.kind!=="string"&&Z.kind!=="number")throw new Rt(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${Z.kind}, ${re.kind}) instead.`)}if(this.collator&&!T&&this.hasUntypedArgument){const Z=We(N),re=We($);if(Z.kind!=="string"||re.kind!=="string")return u(z,N,$)}return this.collator?g(z,N,$,this.collator.evaluate(z)):u(z,N,$)}eachChild(z){z(this.lhs),z(this.rhs),this.collator&&z(this.collator)}outputDefined(){return!0}}}const au=Qi("==",function(f,u,g){return u===g},Wi),Dl=Qi("!=",function(f,u,g){return u!==g},function(f,u,g,T){return!Wi(0,u,g,T)}),xo=Qi("<",function(f,u,g){return u<g},function(f,u,g,T){return T.compare(u,g)<0}),qo=Qi(">",function(f,u,g){return u>g},function(f,u,g,T){return T.compare(u,g)>0}),mc=Qi("<=",function(f,u,g){return u<=g},function(f,u,g,T){return T.compare(u,g)<=0}),lu=Qi(">=",function(f,u,g){return u>=g},function(f,u,g,T){return T.compare(u,g)>=0});class Rl{constructor(u,g,T,D,z){this.type=Sn,this.number=u,this.locale=g,this.currency=T,this.minFractionDigits=D,this.maxFractionDigits=z}static parse(u,g){if(u.length!==3)return g.error("Expected two arguments.");const T=g.parse(u[1],1,Lt);if(!T)return null;const D=u[2];if(typeof D!="object"||Array.isArray(D))return g.error("NumberFormat options argument must be an object.");let z=null;if(D.locale&&(z=g.parse(D.locale,1,Sn),!z))return null;let N=null;if(D.currency&&(N=g.parse(D.currency,1,Sn),!N))return null;let $=null;if(D["min-fraction-digits"]&&($=g.parse(D["min-fraction-digits"],1,Lt),!$))return null;let Z=null;return D["max-fraction-digits"]&&(Z=g.parse(D["max-fraction-digits"],1,Lt),!Z)?null:new Rl(T,z,N,$,Z)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class CA{constructor(u){this.type=Zr,this.sections=u}static parse(u,g){if(u.length<2)return g.error("Expected at least one argument.");const T=u[1];if(!Array.isArray(T)&&typeof T=="object")return g.error("First argument must be an image or text section.");const D=[];let z=!1;for(let N=1;N<=u.length-1;++N){const $=u[N];if(z&&typeof $=="object"&&!Array.isArray($)){z=!1;let Z=null;if($["font-scale"]&&(Z=g.parse($["font-scale"],1,Lt),!Z))return null;let re=null;if($["text-font"]&&(re=g.parse($["text-font"],1,ci(Sn)),!re))return null;let Ae=null;if($["text-color"]&&(Ae=g.parse($["text-color"],1,Rr),!Ae))return null;const he=D[D.length-1];he.scale=Z,he.font=re,he.textColor=Ae}else{const Z=g.parse(u[N],1,yn);if(!Z)return null;const re=Z.type.kind;if(re!=="string"&&re!=="value"&&re!=="null"&&re!=="resolvedImage")return g.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");z=!0,D.push({content:Z,scale:null,font:null,textColor:null})}}return new CA(D)}evaluate(u){return new ke(this.sections.map(g=>{const T=g.content.evaluate(u);return We(T)===Fr?new Le("",T,null,null,null):new Le(dt(T),null,g.scale?g.scale.evaluate(u):null,g.font?g.font.evaluate(u).join(","):null,g.textColor?g.textColor.evaluate(u):null)}))}eachChild(u){for(const g of this.sections)u(g.content),g.scale&&u(g.scale),g.font&&u(g.font),g.textColor&&u(g.textColor)}outputDefined(){return!1}}class Au{constructor(u){this.type=Fr,this.input=u}static parse(u,g){if(u.length!==2)return g.error("Expected two arguments.");const T=g.parse(u[1],1,Sn);return T?new Au(T):g.error("No image name provided.")}evaluate(u){const g=this.input.evaluate(u),T=Ie.fromString(g);return T&&u.availableImages&&(T.available=u.availableImages.indexOf(g)>-1),T}eachChild(u){u(this.input)}outputDefined(){return!1}}class Zo{constructor(u){this.type=Lt,this.input=u}static parse(u,g){if(u.length!==2)return g.error(`Expected 1 argument, but found ${u.length-1} instead.`);const T=g.parse(u[1],1);return T?T.type.kind!=="array"&&T.type.kind!=="string"&&T.type.kind!=="value"?g.error(`Expected argument of type string or array, but found ${Yn(T.type)} instead.`):new Zo(T):null}evaluate(u){const g=this.input.evaluate(u);if(typeof g=="string"||Array.isArray(g))return g.length;throw new Rt(`Expected value to be of type string or array, but found ${Yn(We(g))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const Za={"==":au,"!=":Dl,">":qo,"<":xo,">=":lu,"<=":mc,array:jt,at:Ll,boolean:jt,case:SA,coalesce:si,collator:Oe,format:CA,image:Au,in:Wo,"index-of":ya,interpolate:zn,"interpolate-hcl":zn,"interpolate-lab":zn,length:Zo,let:_o,literal:Dt,match:vo,number:jt,"number-format":Rl,object:jt,slice:qa,step:Dr,string:jt,"to-boolean":qt,"to-color":qt,"to-number":qt,"to-string":qt,var:lt,within:ii};function uu(f,[u,g,T,D]){u=u.evaluate(f),g=g.evaluate(f),T=T.evaluate(f);const z=D?D.evaluate(f):1,N=qe(u,g,T,z);if(N)throw new Rt(N);return new a(u/255*z,g/255*z,T/255*z,z)}function cu(f,u){return f in u}function wo(f,u){const g=u[f];return g===void 0?null:g}function _a(f){return{type:f}}function hu(f){return{result:"success",value:f}}function va(f){return{result:"error",value:f}}function fr(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function $s(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function $n(f){return!!f.expression&&f.expression.interpolated}function qn(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function br(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function pr(f){return f}function Bl(f,u){const g=u.type==="color",T=f.stops&&typeof f.stops[0][0]=="object",D=T||!(T||f.property!==void 0),z=f.type||($n(u)?"exponential":"interval");if(g||u.type==="padding"){const re=g?a.parse:Pe.parse;(f=bi({},f)).stops&&(f.stops=f.stops.map(Ae=>[Ae[0],re(Ae[1])])),f.default=re(f.default?f.default:u.default)}if(f.colorSpace&&f.colorSpace!=="rgb"&&!Ho[f.colorSpace])throw new Error(`Unknown color space: ${f.colorSpace}`);let N,$,Z;if(z==="exponential")N=_c;else if(z==="interval")N=Ya;else if(z==="categorical"){N=yc,$=Object.create(null);for(const re of f.stops)$[re[0]]=re[1];Z=typeof f.stops[0][0]}else{if(z!=="identity")throw new Error(`Unknown function type "${z}"`);N=fu}if(T){const re={},Ae=[];for(let ye=0;ye<f.stops.length;ye++){const _e=f.stops[ye],Ve=_e[0].zoom;re[Ve]===void 0&&(re[Ve]={zoom:Ve,type:f.type,property:f.property,default:f.default,stops:[]},Ae.push(Ve)),re[Ve].stops.push([_e[0].value,_e[1]])}const he=[];for(const ye of Ae)he.push([re[ye].zoom,Bl(re[ye],u)]);const pe={name:"linear"};return{kind:"composite",interpolationType:pe,interpolationFactor:zn.interpolationFactor.bind(void 0,pe),zoomStops:he.map(ye=>ye[0]),evaluate:({zoom:ye},_e)=>_c({stops:he,base:f.base},u,ye).evaluate(ye,_e)}}if(D){const re=z==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:re,interpolationFactor:zn.interpolationFactor.bind(void 0,re),zoomStops:f.stops.map(Ae=>Ae[0]),evaluate:({zoom:Ae})=>N(f,u,Ae,$,Z)}}return{kind:"source",evaluate(re,Ae){const he=Ae&&Ae.properties?Ae.properties[f.property]:void 0;return he===void 0?Yo(f.default,u.default):N(f,u,he,$,Z)}}}function Yo(f,u,g){return f!==void 0?f:u!==void 0?u:g!==void 0?g:void 0}function yc(f,u,g,T,D){return Yo(typeof g===D?T[g]:void 0,f.default,u.default)}function Ya(f,u,g){if(qn(g)!=="number")return Yo(f.default,u.default);const T=f.stops.length;if(T===1||g<=f.stops[0][0])return f.stops[0][1];if(g>=f.stops[T-1][0])return f.stops[T-1][1];const D=Ln(f.stops.map(z=>z[0]),g);return f.stops[D][1]}function _c(f,u,g){const T=f.base!==void 0?f.base:1;if(qn(g)!=="number")return Yo(f.default,u.default);const D=f.stops.length;if(D===1||g<=f.stops[0][0])return f.stops[0][1];if(g>=f.stops[D-1][0])return f.stops[D-1][1];const z=Ln(f.stops.map(Ae=>Ae[0]),g),N=function(Ae,he,pe,ye){const _e=ye-pe,Ve=Ae-pe;return _e===0?0:he===1?Ve/_e:(Math.pow(he,Ve)-1)/(Math.pow(he,_e)-1)}(g,T,f.stops[z][0],f.stops[z+1][0]),$=f.stops[z][1],Z=f.stops[z+1][1];let re=Br[u.type]||pr;if(f.colorSpace&&f.colorSpace!=="rgb"){const Ae=Ho[f.colorSpace];re=(he,pe)=>Ae.reverse(Ae.interpolate(Ae.forward(he),Ae.forward(pe),N))}return typeof $.evaluate=="function"?{evaluate(...Ae){const he=$.evaluate.apply(void 0,Ae),pe=Z.evaluate.apply(void 0,Ae);if(he!==void 0&&pe!==void 0)return re(he,pe,N)}}:re($,Z,N)}function fu(f,u,g){switch(u.type){case"color":g=a.parse(g);break;case"formatted":g=ke.fromString(g.toString());break;case"resolvedImage":g=Ie.fromString(g.toString());break;case"padding":g=Pe.parse(g);break;default:qn(g)===u.type||u.type==="enum"&&u.values[g]||(g=void 0)}return Yo(g,f.default,u.default)}Ft.register(Za,{error:[{kind:"error"},[Sn],(f,[u])=>{throw new Rt(u.evaluate(f))}],typeof:[Sn,[yn],(f,[u])=>Yn(We(u.evaluate(f)))],"to-rgba":[ci(Lt,4),[Rr],(f,[u])=>u.evaluate(f).toArray()],rgb:[Rr,[Lt,Lt,Lt],uu],rgba:[Rr,[Lt,Lt,Lt,Lt],uu],has:{type:bn,overloads:[[[Sn],(f,[u])=>cu(u.evaluate(f),f.properties())],[[Sn,Ts],(f,[u,g])=>cu(u.evaluate(f),g.evaluate(f))]]},get:{type:yn,overloads:[[[Sn],(f,[u])=>wo(u.evaluate(f),f.properties())],[[Sn,Ts],(f,[u,g])=>wo(u.evaluate(f),g.evaluate(f))]]},"feature-state":[yn,[Sn],(f,[u])=>wo(u.evaluate(f),f.featureState||{})],properties:[Ts,[],f=>f.properties()],"geometry-type":[Sn,[],f=>f.geometryType()],id:[yn,[],f=>f.id()],zoom:[Lt,[],f=>f.globals.zoom],"heatmap-density":[Lt,[],f=>f.globals.heatmapDensity||0],"line-progress":[Lt,[],f=>f.globals.lineProgress||0],accumulated:[yn,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[Lt,_a(Lt),(f,u)=>{let g=0;for(const T of u)g+=T.evaluate(f);return g}],"*":[Lt,_a(Lt),(f,u)=>{let g=1;for(const T of u)g*=T.evaluate(f);return g}],"-":{type:Lt,overloads:[[[Lt,Lt],(f,[u,g])=>u.evaluate(f)-g.evaluate(f)],[[Lt],(f,[u])=>-u.evaluate(f)]]},"/":[Lt,[Lt,Lt],(f,[u,g])=>u.evaluate(f)/g.evaluate(f)],"%":[Lt,[Lt,Lt],(f,[u,g])=>u.evaluate(f)%g.evaluate(f)],ln2:[Lt,[],()=>Math.LN2],pi:[Lt,[],()=>Math.PI],e:[Lt,[],()=>Math.E],"^":[Lt,[Lt,Lt],(f,[u,g])=>Math.pow(u.evaluate(f),g.evaluate(f))],sqrt:[Lt,[Lt],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))],log2:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[Lt,[Lt],(f,[u])=>Math.sin(u.evaluate(f))],cos:[Lt,[Lt],(f,[u])=>Math.cos(u.evaluate(f))],tan:[Lt,[Lt],(f,[u])=>Math.tan(u.evaluate(f))],asin:[Lt,[Lt],(f,[u])=>Math.asin(u.evaluate(f))],acos:[Lt,[Lt],(f,[u])=>Math.acos(u.evaluate(f))],atan:[Lt,[Lt],(f,[u])=>Math.atan(u.evaluate(f))],min:[Lt,_a(Lt),(f,u)=>Math.min(...u.map(g=>g.evaluate(f)))],max:[Lt,_a(Lt),(f,u)=>Math.max(...u.map(g=>g.evaluate(f)))],abs:[Lt,[Lt],(f,[u])=>Math.abs(u.evaluate(f))],round:[Lt,[Lt],(f,[u])=>{const g=u.evaluate(f);return g<0?-Math.round(-g):Math.round(g)}],floor:[Lt,[Lt],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[Lt,[Lt],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[bn,[Sn,yn],(f,[u,g])=>f.properties()[u.value]===g.value],"filter-id-==":[bn,[yn],(f,[u])=>f.id()===u.value],"filter-type-==":[bn,[Sn],(f,[u])=>f.geometryType()===u.value],"filter-<":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T<D}],"filter-id-<":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g<T}],"filter->":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T>D}],"filter-id->":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g>T}],"filter-<=":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T<=D}],"filter-id-<=":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g<=T}],"filter->=":[bn,[Sn,yn],(f,[u,g])=>{const T=f.properties()[u.value],D=g.value;return typeof T==typeof D&&T>=D}],"filter-id->=":[bn,[yn],(f,[u])=>{const g=f.id(),T=u.value;return typeof g==typeof T&&g>=T}],"filter-has":[bn,[yn],(f,[u])=>u.value in f.properties()],"filter-has-id":[bn,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[bn,[ci(Sn)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[bn,[ci(yn)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[bn,[Sn,ci(yn)],(f,[u,g])=>g.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[bn,[Sn,ci(yn)],(f,[u,g])=>function(T,D,z,N){for(;z<=N;){const $=z+N>>1;if(D[$]===T)return!0;D[$]>T?N=$-1:z=$+1}return!1}(f.properties()[u.value],g.value,0,g.value.length-1)],all:{type:bn,overloads:[[[bn,bn],(f,[u,g])=>u.evaluate(f)&&g.evaluate(f)],[_a(bn),(f,u)=>{for(const g of u)if(!g.evaluate(f))return!1;return!0}]]},any:{type:bn,overloads:[[[bn,bn],(f,[u,g])=>u.evaluate(f)||g.evaluate(f)],[_a(bn),(f,u)=>{for(const g of u)if(g.evaluate(f))return!0;return!1}]]},"!":[bn,[bn],(f,[u])=>!u.evaluate(f)],"is-supported-script":[bn,[Sn],(f,[u])=>{const g=f.globals&&f.globals.isSupportedScript;return!g||g(u.evaluate(f))}],upcase:[Sn,[Sn],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[Sn,[Sn],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[Sn,_a(yn),(f,u)=>u.map(g=>dt(g.evaluate(f))).join("")],"resolved-locale":[Sn,[Xe],(f,[u])=>u.evaluate(f).resolvedLocale()]});class js{constructor(u,g){this.expression=u,this._warningHistory={},this._evaluator=new xn,this._defaultValue=g?function(T){return T.type==="color"&&br(T.default)?new a(0,0,0,0):T.type==="color"?a.parse(T.default)||null:T.type==="padding"?Pe.parse(T.default)||null:T.default===void 0?null:T.default}(g):null,this._enumValues=g&&g.type==="enum"?g.values:null}evaluateWithoutErrorHandling(u,g,T,D,z,N){return this._evaluator.globals=u,this._evaluator.feature=g,this._evaluator.featureState=T,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=N,this.expression.evaluate(this._evaluator)}evaluate(u,g,T,D,z,N){this._evaluator.globals=u,this._evaluator.feature=g||null,this._evaluator.featureState=T||null,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=N||null;try{const $=this.expression.evaluate(this._evaluator);if($==null||typeof $=="number"&&$!=$)return this._defaultValue;if(this._enumValues&&!($ in this._enumValues))throw new Rt(`Expected value to be one of ${Object.keys(this._enumValues).map(Z=>JSON.stringify(Z)).join(", ")}, but found ${JSON.stringify($)} instead.`);return $}catch($){return this._warningHistory[$.message]||(this._warningHistory[$.message]=!0,typeof console<"u"&&console.warn($.message)),this._defaultValue}}}function zl(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Za}function Xa(f,u){const g=new bt(Za,[],u?function(D){const z={color:Rr,string:Sn,number:Lt,enum:Sn,boolean:bn,formatted:Zr,padding:Vs,resolvedImage:Fr};return D.type==="array"?ci(z[D.value]||yn,D.length):z[D.type]}(u):void 0),T=g.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return T?hu(new js(T,u)):va(g.errors)}class xa{constructor(u,g){this.kind=u,this._styleExpression=g,this.isStateDependent=u!=="constant"&&!Te(g.expression)}evaluateWithoutErrorHandling(u,g,T,D,z,N){return this._styleExpression.evaluateWithoutErrorHandling(u,g,T,D,z,N)}evaluate(u,g,T,D,z,N){return this._styleExpression.evaluate(u,g,T,D,z,N)}}class Ol{constructor(u,g,T,D){this.kind=u,this.zoomStops=T,this._styleExpression=g,this.isStateDependent=u!=="camera"&&!Te(g.expression),this.interpolationType=D}evaluateWithoutErrorHandling(u,g,T,D,z,N){return this._styleExpression.evaluateWithoutErrorHandling(u,g,T,D,z,N)}evaluate(u,g,T,D,z,N){return this._styleExpression.evaluate(u,g,T,D,z,N)}interpolationFactor(u,g,T){return this.interpolationType?zn.interpolationFactor(this.interpolationType,u,g,T):0}}function Fl(f,u){const g=Xa(f,u);if(g.result==="error")return g;const T=g.value.expression,D=ge(T);if(!D&&!fr(u))return va([new Li("","data expressions not supported")]);const z=Ne(T,["zoom"]);if(!z&&!$s(u))return va([new Li("","zoom expressions not supported")]);const N=MA(T);return N||z?N instanceof Li?va([N]):N instanceof zn&&!$n(u)?va([new Li("",'"interpolate" expressions cannot be used with this property')]):hu(N?new Ol(D?"camera":"composite",g.value,N.labels,N instanceof zn?N.interpolation:void 0):new xa(D?"constant":"source",g.value)):va([new Li("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class gr{constructor(u,g){this._parameters=u,this._specification=g,bi(this,Bl(this._parameters,this._specification))}static deserialize(u){return new gr(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function MA(f){let u=null;if(f instanceof _o)u=MA(f.result);else if(f instanceof si){for(const g of f.args)if(u=MA(g),u)break}else(f instanceof Dr||f instanceof zn)&&f.input instanceof Ft&&f.input.name==="zoom"&&(u=f);return u instanceof Li||f.eachChild(g=>{const T=MA(g);T instanceof Li?u=T:!u&&T?u=new Li("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&T&&u!==T&&(u=new Li("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function cs(f){const u=f.key,g=f.value,T=f.valueSpec||{},D=f.objectElementValidators||{},z=f.style,N=f.styleSpec;let $=[];const Z=qn(g);if(Z!=="object")return[new It(u,g,`object expected, ${Z} found`)];for(const re in g){const Ae=re.split(".")[0],he=T[Ae]||T["*"];let pe;if(D[Ae])pe=D[Ae];else if(T[Ae])pe=Ji;else if(D["*"])pe=D["*"];else{if(!T["*"]){$.push(new It(u,g[re],`unknown property "${re}"`));continue}pe=Ji}$=$.concat(pe({key:(u&&`${u}.`)+re,value:g[re],valueSpec:he,style:z,styleSpec:N,object:g,objectKey:re},g))}for(const re in T)D[re]||T[re].required&&T[re].default===void 0&&g[re]===void 0&&$.push(new It(u,g,`missing required property "${re}"`));return $}function du(f){const u=f.value,g=f.valueSpec,T=f.style,D=f.styleSpec,z=f.key,N=f.arrayElementValidator||Ji;if(qn(u)!=="array")return[new It(z,u,`array expected, ${qn(u)} found`)];if(g.length&&u.length!==g.length)return[new It(z,u,`array length ${g.length} expected, length ${u.length} found`)];if(g["min-length"]&&u.length<g["min-length"])return[new It(z,u,`array length at least ${g["min-length"]} expected, length ${u.length} found`)];let $={type:g.value,values:g.values};D.$version<7&&($.function=g.function),qn(g.value)==="object"&&($=g.value);let Z=[];for(let re=0;re<u.length;re++)Z=Z.concat(N({array:u,arrayIndex:re,value:u[re],valueSpec:$,style:T,styleSpec:D,key:`${z}[${re}]`}));return Z}function Nl(f){const u=f.key,g=f.value,T=f.valueSpec;let D=qn(g);return D==="number"&&g!=g&&(D="NaN"),D!=="number"?[new It(u,g,`number expected, ${D} found`)]:"minimum"in T&&g<T.minimum?[new It(u,g,`${g} is less than the minimum value ${T.minimum}`)]:"maximum"in T&&g>T.maximum?[new It(u,g,`${g} is greater than the maximum value ${T.maximum}`)]:[]}function vc(f){const u=f.valueSpec,g=Bn(f.value.type);let T,D,z,N={};const $=g!=="categorical"&&f.value.property===void 0,Z=!$,re=qn(f.value.stops)==="array"&&qn(f.value.stops[0])==="array"&&qn(f.value.stops[0][0])==="object",Ae=cs({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(ye){if(g==="identity")return[new It(ye.key,ye.value,'identity function may not have a "stops" property')];let _e=[];const Ve=ye.value;return _e=_e.concat(du({key:ye.key,value:Ve,valueSpec:ye.valueSpec,style:ye.style,styleSpec:ye.styleSpec,arrayElementValidator:he})),qn(Ve)==="array"&&Ve.length===0&&_e.push(new It(ye.key,Ve,"array must have at least one stop")),_e},default:function(ye){return Ji({key:ye.key,value:ye.value,valueSpec:u,style:ye.style,styleSpec:ye.styleSpec})}}});return g==="identity"&&$&&Ae.push(new It(f.key,f.value,'missing required property "property"')),g==="identity"||f.value.stops||Ae.push(new It(f.key,f.value,'missing required property "stops"')),g==="exponential"&&f.valueSpec.expression&&!$n(f.valueSpec)&&Ae.push(new It(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(Z&&!fr(f.valueSpec)?Ae.push(new It(f.key,f.value,"property functions not supported")):$&&!$s(f.valueSpec)&&Ae.push(new It(f.key,f.value,"zoom functions not supported"))),g!=="categorical"&&!re||f.value.property!==void 0||Ae.push(new It(f.key,f.value,'"property" property is required')),Ae;function he(ye){let _e=[];const Ve=ye.value,ze=ye.key;if(qn(Ve)!=="array")return[new It(ze,Ve,`array expected, ${qn(Ve)} found`)];if(Ve.length!==2)return[new It(ze,Ve,`array length 2 expected, length ${Ve.length} found`)];if(re){if(qn(Ve[0])!=="object")return[new It(ze,Ve,`object expected, ${qn(Ve[0])} found`)];if(Ve[0].zoom===void 0)return[new It(ze,Ve,"object stop key must have zoom")];if(Ve[0].value===void 0)return[new It(ze,Ve,"object stop key must have value")];if(z&&z>Bn(Ve[0].zoom))return[new It(ze,Ve[0].zoom,"stop zoom values must appear in ascending order")];Bn(Ve[0].zoom)!==z&&(z=Bn(Ve[0].zoom),D=void 0,N={}),_e=_e.concat(cs({key:`${ze}[0]`,value:Ve[0],valueSpec:{zoom:{}},style:ye.style,styleSpec:ye.styleSpec,objectElementValidators:{zoom:Nl,value:pe}}))}else _e=_e.concat(pe({key:`${ze}[0]`,value:Ve[0],valueSpec:{},style:ye.style,styleSpec:ye.styleSpec},Ve));return zl($i(Ve[1]))?_e.concat([new It(`${ze}[1]`,Ve[1],"expressions are not allowed in function stops.")]):_e.concat(Ji({key:`${ze}[1]`,value:Ve[1],valueSpec:u,style:ye.style,styleSpec:ye.styleSpec}))}function pe(ye,_e){const Ve=qn(ye.value),ze=Bn(ye.value),it=ye.value!==null?ye.value:_e;if(T){if(Ve!==T)return[new It(ye.key,it,`${Ve} stop domain type must match previous stop domain type ${T}`)]}else T=Ve;if(Ve!=="number"&&Ve!=="string"&&Ve!=="boolean")return[new It(ye.key,it,"stop domain value must be a number, string, or boolean")];if(Ve!=="number"&&g!=="categorical"){let ut=`number expected, ${Ve} found`;return fr(u)&&g===void 0&&(ut+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new It(ye.key,it,ut)]}return g!=="categorical"||Ve!=="number"||isFinite(ze)&&Math.floor(ze)===ze?g!=="categorical"&&Ve==="number"&&D!==void 0&&ze<D?[new It(ye.key,it,"stop domain values must appear in ascending order")]:(D=ze,g==="categorical"&&ze in N?[new It(ye.key,it,"stop domain values must be unique")]:(N[ze]=!0,[])):[new It(ye.key,it,`integer expected, found ${ze}`)]}}function Xr(f){const u=(f.expressionContext==="property"?Fl:Xa)($i(f.value),f.valueSpec);if(u.result==="error")return u.value.map(T=>new It(`${f.key}${T.key}`,f.value,T.message));const g=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!g.outputDefined())return[new It(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!Te(g))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!Te(g))return[new It(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!Ne(g,["zoom","feature-state"]))return[new It(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!ge(g))return[new It(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function zr(f){const u=f.key,g=f.value,T=f.valueSpec,D=[];return Array.isArray(T.values)?T.values.indexOf(Bn(g))===-1&&D.push(new It(u,g,`expected one of [${T.values.join(", ")}], ${JSON.stringify(g)} found`)):Object.keys(T.values).indexOf(Bn(g))===-1&&D.push(new It(u,g,`expected one of [${Object.keys(T.values).join(", ")}], ${JSON.stringify(g)} found`)),D}function oi(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!oi(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const pu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Hs(f){if(f==null)return{filter:()=>!0,needGeometry:!1};oi(f)||(f=fi(f));const u=Xa(f,pu);if(u.result==="error")throw new Error(u.value.map(g=>`${g.key}: ${g.message}`).join(", "));return{filter:(g,T,D)=>u.value.evaluate(g,T,{},D),needGeometry:PA(f)}}function xc(f,u){return f<u?-1:f>u?1:0}function PA(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(PA(f[u]))return!0;return!1}function fi(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?Ei(f[1],f[2],"=="):u==="!="?Ki(Ei(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?Ei(f[1],f[2],u):u==="any"?(g=f.slice(1),["any"].concat(g.map(fi))):u==="all"?["all"].concat(f.slice(1).map(fi)):u==="none"?["all"].concat(f.slice(1).map(fi).map(Ki)):u==="in"?hs(f[1],f.slice(2)):u==="!in"?Ki(hs(f[1],f.slice(2))):u==="has"?wa(f[1]):u==="!has"?Ki(wa(f[1])):u!=="within"||f;var g}function Ei(f,u,g){switch(f){case"$type":return[`filter-type-${g}`,u];case"$id":return[`filter-id-${g}`,u];default:return[`filter-${g}`,f,u]}}function hs(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(g=>typeof g!=typeof u[0])?["filter-in-large",f,["literal",u.sort(xc)]]:["filter-in-small",f,["literal",u]]}}function wa(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Ki(f){return["!",f]}function bo(f){return oi($i(f.value))?Xr(bi({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):mi(f)}function mi(f){const u=f.value,g=f.key;if(qn(u)!=="array")return[new It(g,u,`array expected, ${qn(u)} found`)];const T=f.styleSpec;let D,z=[];if(u.length<1)return[new It(g,u,"filter array must have at least 1 element")];switch(z=z.concat(zr({key:`${g}[0]`,value:u[0],valueSpec:T.filter_operator,style:f.style,styleSpec:f.styleSpec})),Bn(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Bn(u[1])==="$type"&&z.push(new It(g,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&z.push(new It(g,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(D=qn(u[1]),D!=="string"&&z.push(new It(`${g}[1]`,u[1],`string expected, ${D} found`)));for(let N=2;N<u.length;N++)D=qn(u[N]),Bn(u[1])==="$type"?z=z.concat(zr({key:`${g}[${N}]`,value:u[N],valueSpec:T.geometry_type,style:f.style,styleSpec:f.styleSpec})):D!=="string"&&D!=="number"&&D!=="boolean"&&z.push(new It(`${g}[${N}]`,u[N],`string, number, or boolean expected, ${D} found`));break;case"any":case"all":case"none":for(let N=1;N<u.length;N++)z=z.concat(mi({key:`${g}[${N}]`,value:u[N],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":D=qn(u[1]),u.length!==2?z.push(new It(g,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="string"&&z.push(new It(`${g}[1]`,u[1],`string expected, ${D} found`));break;case"within":D=qn(u[1]),u.length!==2?z.push(new It(g,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="object"&&z.push(new It(`${g}[1]`,u[1],`object expected, ${D} found`))}return z}function Ka(f,u){const g=f.key,T=f.style,D=f.styleSpec,z=f.value,N=f.objectKey,$=D[`${u}_${f.layerType}`];if(!$)return[];const Z=N.match(/^(.*)-transition$/);if(u==="paint"&&Z&&$[Z[1]]&&$[Z[1]].transition)return Ji({key:g,value:z,valueSpec:D.transition,style:T,styleSpec:D});const re=f.valueSpec||$[N];if(!re)return[new It(g,z,`unknown property "${N}"`)];let Ae;if(qn(z)==="string"&&fr(re)&&!re.tokens&&(Ae=/^{([^}]+)}$/.exec(z)))return[new It(g,z,`"${N}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Ae[1])} }\`.`)];const he=[];return f.layerType==="symbol"&&(N==="text-field"&&T&&!T.glyphs&&he.push(new It(g,z,'use of "text-field" requires a style "glyphs" property')),N==="text-font"&&br($i(z))&&Bn(z.type)==="identity"&&he.push(new It(g,z,'"text-font" does not support identity functions'))),he.concat(Ji({key:f.key,value:z,valueSpec:re,style:T,styleSpec:D,expressionContext:"property",propertyType:u,propertyKey:N}))}function Ul(f){return Ka(f,"paint")}function Ja(f){return Ka(f,"layout")}function Ws(f){let u=[];const g=f.value,T=f.key,D=f.style,z=f.styleSpec;g.type||g.ref||u.push(new It(T,g,'either "type" or "ref" is required'));let N=Bn(g.type);const $=Bn(g.ref);if(g.id){const Z=Bn(g.id);for(let re=0;re<f.arrayIndex;re++){const Ae=D.layers[re];Bn(Ae.id)===Z&&u.push(new It(T,g.id,`duplicate layer id "${g.id}", previously used at line ${Ae.id.__line__}`))}}if("ref"in g){let Z;["type","source","source-layer","filter","layout"].forEach(re=>{re in g&&u.push(new It(T,g[re],`"${re}" is prohibited for ref layers`))}),D.layers.forEach(re=>{Bn(re.id)===$&&(Z=re)}),Z?Z.ref?u.push(new It(T,g.ref,"ref cannot reference another ref layer")):N=Bn(Z.type):u.push(new It(T,g.ref,`ref layer "${$}" not found`))}else if(N!=="background")if(g.source){const Z=D.sources&&D.sources[g.source],re=Z&&Bn(Z.type);Z?re==="vector"&&N==="raster"?u.push(new It(T,g.source,`layer "${g.id}" requires a raster source`)):re==="raster"&&N!=="raster"?u.push(new It(T,g.source,`layer "${g.id}" requires a vector source`)):re!=="vector"||g["source-layer"]?re==="raster-dem"&&N!=="hillshade"?u.push(new It(T,g.source,"raster-dem source can only be used with layer type 'hillshade'.")):N!=="line"||!g.paint||!g.paint["line-gradient"]||re==="geojson"&&Z.lineMetrics||u.push(new It(T,g,`layer "${g.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new It(T,g,`layer "${g.id}" must specify a "source-layer"`)):u.push(new It(T,g.source,`source "${g.source}" not found`))}else u.push(new It(T,g,'missing required property "source"'));return u=u.concat(cs({key:T,value:g,valueSpec:z.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Ji({key:`${T}.type`,value:g.type,valueSpec:z.layer.type,style:f.style,styleSpec:f.styleSpec,object:g,objectKey:"type"}),filter:bo,layout:Z=>cs({layer:g,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>Ja(bi({layerType:N},re))}}),paint:Z=>cs({layer:g,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>Ul(bi({layerType:N},re))}})}})),u}function fs(f){const u=f.value,g=f.key,T=qn(u);return T!=="string"?[new It(g,u,`string expected, ${T} found`)]:[]}const wc={promoteId:function({key:f,value:u}){if(qn(u)==="string")return fs({key:f,value:u});{const g=[];for(const T in u)g.push(...fs({key:`${f}.${T}`,value:u[T]}));return g}}};function ba(f){const u=f.value,g=f.key,T=f.styleSpec,D=f.style;if(!u.type)return[new It(g,u,'"type" is required')];const z=Bn(u.type);let N;switch(z){case"vector":case"raster":case"raster-dem":return N=cs({key:g,value:u,valueSpec:T[`source_${z.replace("-","_")}`],style:f.style,styleSpec:T,objectElementValidators:wc}),N;case"geojson":if(N=cs({key:g,value:u,valueSpec:T.source_geojson,style:D,styleSpec:T,objectElementValidators:wc}),u.cluster)for(const $ in u.clusterProperties){const[Z,re]=u.clusterProperties[$],Ae=typeof Z=="string"?[Z,["accumulated"],["get",$]]:Z;N.push(...Xr({key:`${g}.${$}.map`,value:re,expressionContext:"cluster-map"})),N.push(...Xr({key:`${g}.${$}.reduce`,value:Ae,expressionContext:"cluster-reduce"}))}return N;case"video":return cs({key:g,value:u,valueSpec:T.source_video,style:D,styleSpec:T});case"image":return cs({key:g,value:u,valueSpec:T.source_image,style:D,styleSpec:T});case"canvas":return[new It(g,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return zr({key:`${g}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:D,styleSpec:T})}}function el(f){const u=f.value,g=f.styleSpec,T=g.light,D=f.style;let z=[];const N=qn(u);if(u===void 0)return z;if(N!=="object")return z=z.concat([new It("light",u,`object expected, ${N} found`)]),z;for(const $ in u){const Z=$.match(/^(.*)-transition$/);z=z.concat(Z&&T[Z[1]]&&T[Z[1]].transition?Ji({key:$,value:u[$],valueSpec:g.transition,style:D,styleSpec:g}):T[$]?Ji({key:$,value:u[$],valueSpec:T[$],style:D,styleSpec:g}):[new It($,u[$],`unknown property "${$}"`)])}return z}function ai(f){const u=f.value,g=f.styleSpec,T=g.terrain,D=f.style;let z=[];const N=qn(u);if(u===void 0)return z;if(N!=="object")return z=z.concat([new It("terrain",u,`object expected, ${N} found`)]),z;for(const $ in u)z=z.concat(T[$]?Ji({key:$,value:u[$],valueSpec:T[$],style:D,styleSpec:g}):[new It($,u[$],`unknown property "${$}"`)]);return z}const Ms={"*":()=>[],array:du,boolean:function(f){const u=f.value,g=f.key,T=qn(u);return T!=="boolean"?[new It(g,u,`boolean expected, ${T} found`)]:[]},number:Nl,color:function(f){const u=f.key,g=f.value,T=qn(g);return T!=="string"?[new It(u,g,`color expected, ${T} found`)]:us(g)===null?[new It(u,g,`color expected, "${g}" found`)]:[]},constants:Us,enum:zr,filter:bo,function:vc,layer:Ws,object:cs,source:ba,light:el,terrain:ai,string:fs,formatted:function(f){return fs(f).length===0?[]:Xr(f)},resolvedImage:function(f){return fs(f).length===0?[]:Xr(f)},padding:function(f){const u=f.key,g=f.value;if(qn(g)==="array"){if(g.length<1||g.length>4)return[new It(u,g,`padding requires 1 to 4 values; ${g.length} values found`)];const T={type:"number"};let D=[];for(let z=0;z<g.length;z++)D=D.concat(Ji({key:`${u}[${z}]`,value:g[z],valueSpec:T}));return D}return Nl({key:u,value:g,valueSpec:{}})}};function Ji(f){const u=f.value,g=f.valueSpec,T=f.styleSpec;return g.expression&&br(Bn(u))?vc(f):g.expression&&zl($i(u))?Xr(f):g.type&&Ms[g.type]?Ms[g.type](f):cs(bi({},f,{valueSpec:g.type?T[g.type]:g}))}function Vl(f){const u=f.value,g=f.key,T=fs(f);return T.length||(u.indexOf("{fontstack}")===-1&&T.push(new It(g,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&T.push(new It(g,u,'"glyphs" url must include a "{range}" token'))),T}function Xo(f,u=ht){let g=[];return g=g.concat(Ji({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,objectElementValidators:{glyphs:Vl,"*":()=>[]}})),f.constants&&(g=g.concat(Us({key:"constants",value:f.constants,style:f,styleSpec:u}))),bc(g)}function bc(f){return[].concat(f).sort((u,g)=>u.line-g.line)}function Eo(f){return function(...u){return bc(f.apply(this,u))}}Xo.source=Eo(ba),Xo.light=Eo(el),Xo.terrain=Eo(ai),Xo.layer=Eo(Ws),Xo.filter=Eo(bo),Xo.paintProperty=Eo(Ul),Xo.layoutProperty=Eo(Ja);const Gl=Xo,tl=Gl.light,Th=Gl.paintProperty,Sh=Gl.layoutProperty;function nl(f,u){let g=!1;if(u&&u.length)for(const T of u)f.fire(new $o(new Error(T.message))),g=!0;return g}class Ea{constructor(u,g,T){const D=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const N=new Int32Array(this.arrayBuffer);u=N[0],this.d=(g=N[1])+2*(T=N[2]);for(let Z=0;Z<this.d*this.d;Z++){const re=N[3+Z],Ae=N[3+Z+1];D.push(re===Ae?null:N.subarray(re,Ae))}const $=N[3+D.length+1];this.keys=N.subarray(N[3+D.length],$),this.bboxes=N.subarray($),this.insert=this._insertReadonly}else{this.d=g+2*T;for(let N=0;N<this.d*this.d;N++)D.push([]);this.keys=[],this.bboxes=[]}this.n=g,this.extent=u,this.padding=T,this.scale=g/u,this.uid=0;const z=T/g*u;this.min=-z,this.max=u+z}insert(u,g,T,D,z){this._forEachCell(g,T,D,z,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(g),this.bboxes.push(T),this.bboxes.push(D),this.bboxes.push(z)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,g,T,D,z,N){this.cells[z].push(N)}query(u,g,T,D,z){const N=this.min,$=this.max;if(u<=N&&g<=N&&$<=T&&$<=D&&!z)return Array.prototype.slice.call(this.keys);{const Z=[];return this._forEachCell(u,g,T,D,this._queryCell,Z,{},z),Z}}_queryCell(u,g,T,D,z,N,$,Z){const re=this.cells[z];if(re!==null){const Ae=this.keys,he=this.bboxes;for(let pe=0;pe<re.length;pe++){const ye=re[pe];if($[ye]===void 0){const _e=4*ye;(Z?Z(he[_e+0],he[_e+1],he[_e+2],he[_e+3]):u<=he[_e+2]&&g<=he[_e+3]&&T>=he[_e+0]&&D>=he[_e+1])?($[ye]=!0,N.push(Ae[ye])):$[ye]=!1}}}}_forEachCell(u,g,T,D,z,N,$,Z){const re=this._convertToCellCoord(u),Ae=this._convertToCellCoord(g),he=this._convertToCellCoord(T),pe=this._convertToCellCoord(D);for(let ye=re;ye<=he;ye++)for(let _e=Ae;_e<=pe;_e++){const Ve=this.d*_e+ye;if((!Z||Z(this._convertFromCellCoord(ye),this._convertFromCellCoord(_e),this._convertFromCellCoord(ye+1),this._convertFromCellCoord(_e+1)))&&z.call(this,u,g,T,D,Ve,N,$,Z))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,g=3+this.cells.length+1+1;let T=0;for(let N=0;N<this.cells.length;N++)T+=this.cells[N].length;const D=new Int32Array(g+T+this.keys.length+this.bboxes.length);D[0]=this.extent,D[1]=this.n,D[2]=this.padding;let z=g;for(let N=0;N<u.length;N++){const $=u[N];D[3+N]=z,D.set($,z),z+=$.length}return D[3+u.length]=z,D.set(this.keys,z),z+=this.keys.length,D[3+u.length+1]=z,D.set(this.bboxes,z),z+=this.bboxes.length,D.buffer}static serialize(u,g){const T=u.toArrayBuffer();return g&&g.push(T),{buffer:T}}static deserialize(u){return new Ea(u.buffer)}}const ds={};function Nt(f,u,g={}){if(ds[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),ds[f]={klass:u,omit:g.omit||[],shallow:g.shallow||[]}}Nt("Object",Object),Nt("TransferableGridIndex",Ea),Nt("Color",a),Nt("Error",Error),Nt("AJAXError",tr),Nt("ResolvedImage",Ie),Nt("StylePropertyFunction",gr),Nt("StyleExpression",js,{omit:["_evaluator"]}),Nt("ZoomDependentExpression",Ol),Nt("ZoomConstantExpression",xa),Nt("CompoundExpression",Ft,{omit:["_evaluate"]});for(const f in Za)Za[f]._classRegistryKey||Nt(`Expression_${f}`,Za[f]);function gu(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function Ta(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(gu(f)||pt(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const g=f;return u&&u.push(g.buffer),g}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const g=[];for(const T of f)g.push(Ta(T,u));return g}if(typeof f=="object"){const g=f.constructor,T=g._classRegistryKey;if(!T)throw new Error("can't serialize object of unregistered class");if(!ds[T])throw new Error(`${T} is not registered.`);const D=g.serialize?g.serialize(f,u):{};if(g.serialize){if(u&&D===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const z in f){if(!f.hasOwnProperty(z)||ds[T].omit.indexOf(z)>=0)continue;const N=f[z];D[z]=ds[T].shallow.indexOf(z)>=0?N:Ta(N,u)}f instanceof Error&&(D.message=f.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return T!=="Object"&&(D.$name=T),D}throw new Error("can't serialize object of type "+typeof f)}function Ko(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||gu(f)||pt(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(Ko);if(typeof f=="object"){const u=f.$name||"Object";if(!ds[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:g}=ds[u];if(!g)throw new Error(`can't deserialize unregistered class ${u}`);if(g.deserialize)return g.deserialize(f);const T=Object.create(g.prototype);for(const D of Object.keys(f)){if(D==="$name")continue;const z=f[D];T[D]=ds[u].shallow.indexOf(D)>=0?z:Ko(z)}return T}throw new Error("can't deserialize object of type "+typeof f)}class mu{constructor(){this.first=!0}update(u,g){const T=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=T,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=T,!0):(this.lastFloorZoom>T?(this.lastIntegerZoom=T+1,this.lastIntegerZoomTime=g):this.lastFloorZoom<T&&(this.lastIntegerZoom=T,this.lastIntegerZoomTime=g),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=T,!0))}}const Vt={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function kA(f){for(const u of f)if(rl(u.charCodeAt(0)))return!0;return!1}function $l(f){for(const u of f)if(!IA(u.charCodeAt(0)))return!1;return!0}function IA(f){return!(Vt.Arabic(f)||Vt["Arabic Supplement"](f)||Vt["Arabic Extended-A"](f)||Vt["Arabic Presentation Forms-A"](f)||Vt["Arabic Presentation Forms-B"](f))}function rl(f){return!(f!==746&&f!==747&&(f<4352||!(Vt["Bopomofo Extended"](f)||Vt.Bopomofo(f)||Vt["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Vt["CJK Compatibility Ideographs"](f)||Vt["CJK Compatibility"](f)||Vt["CJK Radicals Supplement"](f)||Vt["CJK Strokes"](f)||!(!Vt["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Vt["CJK Unified Ideographs Extension A"](f)||Vt["CJK Unified Ideographs"](f)||Vt["Enclosed CJK Letters and Months"](f)||Vt["Hangul Compatibility Jamo"](f)||Vt["Hangul Jamo Extended-A"](f)||Vt["Hangul Jamo Extended-B"](f)||Vt["Hangul Jamo"](f)||Vt["Hangul Syllables"](f)||Vt.Hiragana(f)||Vt["Ideographic Description Characters"](f)||Vt.Kanbun(f)||Vt["Kangxi Radicals"](f)||Vt["Katakana Phonetic Extensions"](f)||Vt.Katakana(f)&&f!==12540||!(!Vt["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Vt["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Vt["Unified Canadian Aboriginal Syllabics"](f)||Vt["Unified Canadian Aboriginal Syllabics Extended"](f)||Vt["Vertical Forms"](f)||Vt["Yijing Hexagram Symbols"](f)||Vt["Yi Syllables"](f)||Vt["Yi Radicals"](f))))}function Qs(f){return!(rl(f)||function(u){return!!(Vt["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||Vt["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||Vt["Letterlike Symbols"](u)||Vt["Number Forms"](u)||Vt["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||Vt["Control Pictures"](u)&&u!==9251||Vt["Optical Character Recognition"](u)||Vt["Enclosed Alphanumerics"](u)||Vt["Geometric Shapes"](u)||Vt["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||Vt["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||Vt["CJK Symbols and Punctuation"](u)||Vt.Katakana(u)||Vt["Private Use Area"](u)||Vt["CJK Compatibility Forms"](u)||Vt["Small Form Variants"](u)||Vt["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function yu(f){return f>=1424&&f<=2303||Vt["Arabic Presentation Forms-A"](f)||Vt["Arabic Presentation Forms-B"](f)}function Ch(f,u){return!(!u&&yu(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Vt.Khmer(f))}function Ec(f){for(const u of f)if(yu(u.charCodeAt(0)))return!0;return!1}const _u="deferred",vu="loading",xu="loaded";let qs=null,Bi="unavailable",To=null;const wu=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(Bi="error"),qs&&qs(f)};function Sa(){Ur.fire(new Ii("pluginStateChange",{pluginStatus:Bi,pluginURL:To}))}const Ur=new ls,jl=function(){return Bi},Tc=function(){if(Bi!==_u||!To)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Bi=vu,Sa(),To&&nr({url:To},f=>{f?wu(f):(Bi=xu,Sa())})},ps={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Bi===xu||ps.applyArabicShaping!=null,isLoading:()=>Bi===vu,setState(f){if(!Qe())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Bi=f.pluginStatus,To=f.pluginURL},isParsed(){if(!Qe())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ps.applyArabicShaping!=null&&ps.processBidirectionalText!=null&&ps.processStyledBidirectionalText!=null},getPluginURL(){if(!Qe())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return To}};class Mr{constructor(u,g){this.zoom=u,g?(this.now=g.now,this.fadeDuration=g.fadeDuration,this.zoomHistory=g.zoomHistory,this.transition=g.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new mu,this.transition={})}isSupportedScript(u){return function(g,T){for(const D of g)if(!Ch(D.charCodeAt(0),T))return!1;return!0}(u,ps.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,g=u-Math.floor(u),T=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:g+(1-g)*T}:{fromScale:.5,toScale:1,t:1-(1-T)*g}}}class il{constructor(u,g){this.property=u,this.value=g,this.expression=function(T,D){if(br(T))return new gr(T,D);if(zl(T)){const z=Fl(T,D);if(z.result==="error")throw new Error(z.value.map(N=>`${N.key}: ${N.message}`).join(", "));return z.value}{let z=T;return D.type==="color"&&typeof T=="string"?z=a.parse(T):D.type!=="padding"||typeof T!="number"&&!Array.isArray(T)||(z=Pe.parse(T)),{kind:"constant",evaluate:()=>z}}}(g===void 0?u.specification.default:g,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,g,T){return this.property.possiblyEvaluate(this,u,g,T)}}class Hl{constructor(u){this.property=u,this.value=new il(u,void 0)}transitioned(u,g){return new Sc(this.property,this.value,g,H({},u.transition,this.transition),u.now)}untransitioned(){return new Sc(this.property,this.value,null,{},0)}}class bu{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return se(this._values[u].value.value)}setValue(u,g){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Hl(this._values[u].property)),this._values[u].value=new il(this._values[u].property,g===null?void 0:se(g))}getTransition(u){return se(this._values[u].transition)}setTransition(u,g){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Hl(this._values[u].property)),this._values[u].transition=se(g)||void 0}serialize(){const u={};for(const g of Object.keys(this._values)){const T=this.getValue(g);T!==void 0&&(u[g]=T);const D=this.getTransition(g);D!==void 0&&(u[`${g}-transition`]=D)}return u}transitioned(u,g){const T=new Eu(this._properties);for(const D of Object.keys(this._values))T._values[D]=this._values[D].transitioned(u,g._values[D]);return T}untransitioned(){const u=new Eu(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].untransitioned();return u}}class Sc{constructor(u,g,T,D,z){this.property=u,this.value=g,this.begin=z+D.delay||0,this.end=this.begin+D.duration||0,u.specification.transition&&(D.delay||D.duration)&&(this.prior=T)}possiblyEvaluate(u,g,T){const D=u.now||0,z=this.value.possiblyEvaluate(u,g,T),N=this.prior;if(N){if(D>this.end)return this.prior=null,z;if(this.value.isDataDriven())return this.prior=null,z;if(D<this.begin)return N.possiblyEvaluate(u,g,T);{const $=(D-this.begin)/(this.end-this.begin);return this.property.interpolate(N.possiblyEvaluate(u,g,T),z,function(Z){if(Z<=0)return 0;if(Z>=1)return 1;const re=Z*Z,Ae=re*Z;return 4*(Z<.5?Ae:3*(Z-re)+Ae-.75)}($))}}return z}}class Eu{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,g,T){const D=new Wl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,g,T);return D}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class Cc{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}getValue(u){return se(this._values[u].value)}setValue(u,g){this._values[u]=new il(this._values[u].property,g===null?void 0:se(g))}serialize(){const u={};for(const g of Object.keys(this._values)){const T=this.getValue(g);T!==void 0&&(u[g]=T)}return u}possiblyEvaluate(u,g,T){const D=new Wl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,g,T);return D}}class mr{constructor(u,g,T){this.property=u,this.value=g,this.parameters=T}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,g,T,D){return this.property.evaluate(this.value,this.parameters,u,g,T,D)}}class Wl{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class Xt{constructor(u){this.specification=u}possiblyEvaluate(u,g){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(g)}interpolate(u,g,T){const D=Br[this.specification.type];return D?D(u,g,T):u}}class Kt{constructor(u,g){this.specification=u,this.overrides=g}possiblyEvaluate(u,g,T,D){return new mr(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(g,null,{},T,D)}:u.expression,g)}interpolate(u,g,T){if(u.value.kind!=="constant"||g.value.kind!=="constant")return u;if(u.value.value===void 0||g.value.value===void 0)return new mr(this,{kind:"constant",value:void 0},u.parameters);const D=Br[this.specification.type];return D?new mr(this,{kind:"constant",value:D(u.value.value,g.value.value,T)},u.parameters):u}evaluate(u,g,T,D,z,N){return u.kind==="constant"?u.value:u.evaluate(g,T,D,z,N)}}class fn extends Kt{possiblyEvaluate(u,g,T,D){if(u.value===void 0)return new mr(this,{kind:"constant",value:void 0},g);if(u.expression.kind==="constant"){const z=u.expression.evaluate(g,null,{},T,D),N=u.property.specification.type==="resolvedImage"&&typeof z!="string"?z.name:z,$=this._calculate(N,N,N,g);return new mr(this,{kind:"constant",value:$},g)}if(u.expression.kind==="camera"){const z=this._calculate(u.expression.evaluate({zoom:g.zoom-1}),u.expression.evaluate({zoom:g.zoom}),u.expression.evaluate({zoom:g.zoom+1}),g);return new mr(this,{kind:"constant",value:z},g)}return new mr(this,u.expression,g)}evaluate(u,g,T,D,z,N){if(u.kind==="source"){const $=u.evaluate(g,T,D,z,N);return this._calculate($,$,$,g)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(g.zoom)-1},T,D),u.evaluate({zoom:Math.floor(g.zoom)},T,D),u.evaluate({zoom:Math.floor(g.zoom)+1},T,D),g):u.value}_calculate(u,g,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:g}:{from:T,to:g}}interpolate(u){return u}}class es{constructor(u){this.specification=u}possiblyEvaluate(u,g,T,D){if(u.value!==void 0){if(u.expression.kind==="constant"){const z=u.expression.evaluate(g,null,{},T,D);return this._calculate(z,z,z,g)}return this._calculate(u.expression.evaluate(new Mr(Math.floor(g.zoom-1),g)),u.expression.evaluate(new Mr(Math.floor(g.zoom),g)),u.expression.evaluate(new Mr(Math.floor(g.zoom+1),g)),g)}}_calculate(u,g,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:g}:{from:T,to:g}}interpolate(u){return u}}class Jo{constructor(u){this.specification=u}possiblyEvaluate(u,g,T,D){return!!u.expression.evaluate(g,null,{},T,D)}interpolate(){return!1}}class Hr{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const g in u){const T=u[g];T.specification.overridable&&this.overridableProperties.push(g);const D=this.defaultPropertyValues[g]=new il(T,void 0),z=this.defaultTransitionablePropertyValues[g]=new Hl(T);this.defaultTransitioningPropertyValues[g]=z.untransitioned(),this.defaultPossiblyEvaluatedValues[g]=D.possiblyEvaluate({})}}}Nt("DataDrivenProperty",Kt),Nt("DataConstantProperty",Xt),Nt("CrossFadedDataDrivenProperty",fn),Nt("CrossFadedProperty",es),Nt("ColorRampProperty",Jo);const Zs="-transition";class Ps extends ls{constructor(u,g){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),g.layout&&(this._unevaluatedLayout=new Cc(g.layout)),g.paint)){this._transitionablePaint=new bu(g.paint);for(const T in u.paint)this.setPaintProperty(T,u.paint[T],{validate:!1});for(const T in u.layout)this.setLayoutProperty(T,u.layout[T],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Wl(g.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,g,T={}){g!=null&&this._validate(Sh,`layers.${this.id}.layout.${u}`,u,g,T)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,g):this.visibility=g)}getPaintProperty(u){return u.endsWith(Zs)?this._transitionablePaint.getTransition(u.slice(0,-Zs.length)):this._transitionablePaint.getValue(u)}setPaintProperty(u,g,T={}){if(g!=null&&this._validate(Th,`layers.${this.id}.paint.${u}`,u,g,T))return!1;if(u.endsWith(Zs))return this._transitionablePaint.setTransition(u.slice(0,-Zs.length),g||void 0),!1;{const D=this._transitionablePaint._values[u],z=D.property.specification["property-type"]==="cross-faded-data-driven",N=D.value.isDataDriven(),$=D.value;this._transitionablePaint.setValue(u,g),this._handleSpecialPaintPropertyUpdate(u);const Z=this._transitionablePaint._values[u].value;return Z.isDataDriven()||N||z||this._handleOverridablePaintPropertyUpdate(u,$,Z)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,g,T){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,g){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,g)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,g)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),J(u,(g,T)=>!(g===void 0||T==="layout"&&!Object.keys(g).length||T==="paint"&&!Object.keys(g).length))}_validate(u,g,T,D,z={}){return(!z||z.validate!==!1)&&nl(this,u.call(Gl,{key:g,layerType:this.type,objectKey:T,value:D,styleSpec:ht,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const g=this.paint.get(u);if(g instanceof mr&&fr(g.property.specification)&&(g.value.kind==="source"||g.value.kind==="composite")&&g.value.isStateDependent)return!0}return!1}}const Ys={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ct{constructor(u,g){this._structArray=u,this._pos1=g*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,g){return u._trim(),g&&(u.isTransferred=!0,g.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const g=Object.create(this.prototype);return g.arrayBuffer=u.arrayBuffer,g.length=u.length,g.capacity=u.arrayBuffer.byteLength/g.bytesPerElement,g._refreshViews(),g}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const g=this.uint8;this._refreshViews(),g&&this.uint8.set(g)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Wr(f,u=1){let g=0,T=0;return{members:f.map(D=>{const z=Ys[D.type].BYTES_PER_ELEMENT,N=g=sl(g,Math.max(u,z)),$=D.components||1;return T=Math.max(T,z),g+=z*$,{name:D.name,type:D.type,components:$,offset:N}}),size:sl(g,Math.max(T,u)),alignment:u}}function sl(f,u){return Math.ceil(f/u)*u}class Xs extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g){const T=this.length;return this.resize(T+1),this.emplace(T,u,g)}emplace(u,g,T){const D=2*u;return this.int16[D+0]=g,this.int16[D+1]=T,u}}Xs.prototype.bytesPerElement=4,Nt("StructArrayLayout2i4",Xs);class L extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,g,T,D)}emplace(u,g,T,D,z){const N=4*u;return this.int16[N+0]=g,this.int16[N+1]=T,this.int16[N+2]=D,this.int16[N+3]=z,u}}L.prototype.bytesPerElement=8,Nt("StructArrayLayout4i8",L);class c extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N){const $=this.length;return this.resize($+1),this.emplace($,u,g,T,D,z,N)}emplace(u,g,T,D,z,N,$){const Z=6*u;return this.int16[Z+0]=g,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=N,this.int16[Z+5]=$,u}}c.prototype.bytesPerElement=12,Nt("StructArrayLayout2i4i12",c);class _ extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N){const $=this.length;return this.resize($+1),this.emplace($,u,g,T,D,z,N)}emplace(u,g,T,D,z,N,$){const Z=4*u,re=8*u;return this.int16[Z+0]=g,this.int16[Z+1]=T,this.uint8[re+4]=D,this.uint8[re+5]=z,this.uint8[re+6]=N,this.uint8[re+7]=$,u}}_.prototype.bytesPerElement=8,Nt("StructArrayLayout2i4ub8",_);class A extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g){const T=this.length;return this.resize(T+1),this.emplace(T,u,g)}emplace(u,g,T){const D=2*u;return this.float32[D+0]=g,this.float32[D+1]=T,u}}A.prototype.bytesPerElement=8,Nt("StructArrayLayout2f8",A);class h extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re,Ae){const he=this.length;return this.resize(he+1),this.emplace(he,u,g,T,D,z,N,$,Z,re,Ae)}emplace(u,g,T,D,z,N,$,Z,re,Ae,he){const pe=10*u;return this.uint16[pe+0]=g,this.uint16[pe+1]=T,this.uint16[pe+2]=D,this.uint16[pe+3]=z,this.uint16[pe+4]=N,this.uint16[pe+5]=$,this.uint16[pe+6]=Z,this.uint16[pe+7]=re,this.uint16[pe+8]=Ae,this.uint16[pe+9]=he,u}}h.prototype.bytesPerElement=20,Nt("StructArrayLayout10ui20",h);class d extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re,Ae,he,pe){const ye=this.length;return this.resize(ye+1),this.emplace(ye,u,g,T,D,z,N,$,Z,re,Ae,he,pe)}emplace(u,g,T,D,z,N,$,Z,re,Ae,he,pe,ye){const _e=12*u;return this.int16[_e+0]=g,this.int16[_e+1]=T,this.int16[_e+2]=D,this.int16[_e+3]=z,this.uint16[_e+4]=N,this.uint16[_e+5]=$,this.uint16[_e+6]=Z,this.uint16[_e+7]=re,this.int16[_e+8]=Ae,this.int16[_e+9]=he,this.int16[_e+10]=pe,this.int16[_e+11]=ye,u}}d.prototype.bytesPerElement=24,Nt("StructArrayLayout4i4ui4i24",d);class w extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=3*u;return this.float32[z+0]=g,this.float32[z+1]=T,this.float32[z+2]=D,u}}w.prototype.bytesPerElement=12,Nt("StructArrayLayout3f12",w);class b extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const g=this.length;return this.resize(g+1),this.emplace(g,u)}emplace(u,g){return this.uint32[1*u+0]=g,u}}b.prototype.bytesPerElement=4,Nt("StructArrayLayout1ul4",b);class C extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,u,g,T,D,z,N,$,Z,re)}emplace(u,g,T,D,z,N,$,Z,re,Ae){const he=10*u,pe=5*u;return this.int16[he+0]=g,this.int16[he+1]=T,this.int16[he+2]=D,this.int16[he+3]=z,this.int16[he+4]=N,this.int16[he+5]=$,this.uint32[pe+3]=Z,this.uint16[he+8]=re,this.uint16[he+9]=Ae,u}}C.prototype.bytesPerElement=20,Nt("StructArrayLayout6i1ul2ui20",C);class P extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N){const $=this.length;return this.resize($+1),this.emplace($,u,g,T,D,z,N)}emplace(u,g,T,D,z,N,$){const Z=6*u;return this.int16[Z+0]=g,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=N,this.int16[Z+5]=$,u}}P.prototype.bytesPerElement=12,Nt("StructArrayLayout2i2i2i12",P);class B extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z){const N=this.length;return this.resize(N+1),this.emplace(N,u,g,T,D,z)}emplace(u,g,T,D,z,N){const $=4*u,Z=8*u;return this.float32[$+0]=g,this.float32[$+1]=T,this.float32[$+2]=D,this.int16[Z+6]=z,this.int16[Z+7]=N,u}}B.prototype.bytesPerElement=16,Nt("StructArrayLayout2f1f2i16",B);class V extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,g,T,D)}emplace(u,g,T,D,z){const N=12*u,$=3*u;return this.uint8[N+0]=g,this.uint8[N+1]=T,this.float32[$+1]=D,this.float32[$+2]=z,u}}V.prototype.bytesPerElement=12,Nt("StructArrayLayout2ub2f12",V);class W extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=3*u;return this.uint16[z+0]=g,this.uint16[z+1]=T,this.uint16[z+2]=D,u}}W.prototype.bytesPerElement=6,Nt("StructArrayLayout3ui6",W);class X extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re,Ae,he,pe,ye,_e,Ve,ze,it){const ut=this.length;return this.resize(ut+1),this.emplace(ut,u,g,T,D,z,N,$,Z,re,Ae,he,pe,ye,_e,Ve,ze,it)}emplace(u,g,T,D,z,N,$,Z,re,Ae,he,pe,ye,_e,Ve,ze,it,ut){const et=24*u,at=12*u,yt=48*u;return this.int16[et+0]=g,this.int16[et+1]=T,this.uint16[et+2]=D,this.uint16[et+3]=z,this.uint32[at+2]=N,this.uint32[at+3]=$,this.uint32[at+4]=Z,this.uint16[et+10]=re,this.uint16[et+11]=Ae,this.uint16[et+12]=he,this.float32[at+7]=pe,this.float32[at+8]=ye,this.uint8[yt+36]=_e,this.uint8[yt+37]=Ve,this.uint8[yt+38]=ze,this.uint32[at+10]=it,this.int16[et+22]=ut,u}}X.prototype.bytesPerElement=48,Nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",X);class ae extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D,z,N,$,Z,re,Ae,he,pe,ye,_e,Ve,ze,it,ut,et,at,yt,mt,Zt,tn,Ht,Ut,Ot,Wt){const $t=this.length;return this.resize($t+1),this.emplace($t,u,g,T,D,z,N,$,Z,re,Ae,he,pe,ye,_e,Ve,ze,it,ut,et,at,yt,mt,Zt,tn,Ht,Ut,Ot,Wt)}emplace(u,g,T,D,z,N,$,Z,re,Ae,he,pe,ye,_e,Ve,ze,it,ut,et,at,yt,mt,Zt,tn,Ht,Ut,Ot,Wt,$t){const St=34*u,gn=17*u;return this.int16[St+0]=g,this.int16[St+1]=T,this.int16[St+2]=D,this.int16[St+3]=z,this.int16[St+4]=N,this.int16[St+5]=$,this.int16[St+6]=Z,this.int16[St+7]=re,this.uint16[St+8]=Ae,this.uint16[St+9]=he,this.uint16[St+10]=pe,this.uint16[St+11]=ye,this.uint16[St+12]=_e,this.uint16[St+13]=Ve,this.uint16[St+14]=ze,this.uint16[St+15]=it,this.uint16[St+16]=ut,this.uint16[St+17]=et,this.uint16[St+18]=at,this.uint16[St+19]=yt,this.uint16[St+20]=mt,this.uint16[St+21]=Zt,this.uint16[St+22]=tn,this.uint32[gn+12]=Ht,this.float32[gn+13]=Ut,this.float32[gn+14]=Ot,this.float32[gn+15]=Wt,this.float32[gn+16]=$t,u}}ae.prototype.bytesPerElement=68,Nt("StructArrayLayout8i15ui1ul4f68",ae);class ne extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const g=this.length;return this.resize(g+1),this.emplace(g,u)}emplace(u,g){return this.float32[1*u+0]=g,u}}ne.prototype.bytesPerElement=4,Nt("StructArrayLayout1f4",ne);class ue extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=3*u;return this.int16[z+0]=g,this.int16[z+1]=T,this.int16[z+2]=D,u}}ue.prototype.bytesPerElement=6,Nt("StructArrayLayout3i6",ue);class be extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,g,T)}emplace(u,g,T,D){const z=4*u;return this.uint32[2*u+0]=g,this.uint16[z+2]=T,this.uint16[z+3]=D,u}}be.prototype.bytesPerElement=8,Nt("StructArrayLayout1ul2ui8",be);class Me extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,g){const T=this.length;return this.resize(T+1),this.emplace(T,u,g)}emplace(u,g,T){const D=2*u;return this.uint16[D+0]=g,this.uint16[D+1]=T,u}}Me.prototype.bytesPerElement=4,Nt("StructArrayLayout2ui4",Me);class ve extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const g=this.length;return this.resize(g+1),this.emplace(g,u)}emplace(u,g){return this.uint16[1*u+0]=g,u}}ve.prototype.bytesPerElement=2,Nt("StructArrayLayout1ui2",ve);class $e extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,g,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,g,T,D)}emplace(u,g,T,D,z){const N=4*u;return this.float32[N+0]=g,this.float32[N+1]=T,this.float32[N+2]=D,this.float32[N+3]=z,u}}$e.prototype.bytesPerElement=16,Nt("StructArrayLayout4f16",$e);class Se extends Ct{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Et(this.anchorPointX,this.anchorPointY)}}Se.prototype.size=20;class Ge extends C{get(u){return new Se(this,u)}}Nt("CollisionBoxArray",Ge);class xe extends Ct{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}xe.prototype.size=48;class y extends X{get(u){return new xe(this,u)}}Nt("PlacedSymbolArray",y);class m extends Ct{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}m.prototype.size=68;class x extends ae{get(u){return new m(this,u)}}Nt("SymbolInstanceArray",x);class E extends ne{getoffsetX(u){return this.float32[1*u+0]}}Nt("GlyphOffsetArray",E);class I extends ue{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Nt("SymbolLineVertexArray",I);class R extends Ct{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}R.prototype.size=8;class O extends be{get(u){return new R(this,u)}}Nt("FeatureIndexArray",O);class U extends Xs{}class q extends Xs{}class ee extends Xs{}class le extends c{}class de extends _{}class Re extends A{}class je extends h{}class Be extends d{}class Ke extends w{}class ft extends b{}class ct extends P{}class st extends V{}class ot extends W{}class Je extends Me{}const Gt=Wr([{name:"a_pos",components:2,type:"Int16"}],4),{members:zt}=Gt;class gt{constructor(u=[]){this.segments=u}prepareSegment(u,g,T,D){let z=this.segments[this.segments.length-1];return u>gt.MAX_VERTEX_ARRAY_LENGTH&&me(`Max vertices per segment is ${gt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!z||z.vertexLength+u>gt.MAX_VERTEX_ARRAY_LENGTH||z.sortKey!==D)&&(z={vertexOffset:g.length,primitiveOffset:T.length,vertexLength:0,primitiveLength:0},D!==void 0&&(z.sortKey=D),this.segments.push(z)),z}get(){return this.segments}destroy(){for(const u of this.segments)for(const g in u.vaos)u.vaos[g].destroy()}static simpleSegment(u,g,T,D){return new gt([{vertexOffset:u,primitiveOffset:g,vertexLength:T,primitiveLength:D,vaos:{},sortKey:0}])}}function vt(f,u){return 256*(f=k(Math.floor(f),0,255))+k(Math.floor(u),0,255)}gt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nt("SegmentVector",gt);const Pn=Wr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var wn={exports:{}},mn={exports:{}};mn.exports=function(f,u){var g,T,D,z,N,$,Z,re;for(T=f.length-(g=3&f.length),D=u,N=3432918353,$=461845907,re=0;re<T;)Z=255&f.charCodeAt(re)|(255&f.charCodeAt(++re))<<8|(255&f.charCodeAt(++re))<<16|(255&f.charCodeAt(++re))<<24,++re,D=27492+(65535&(z=5*(65535&(D=(D^=Z=(65535&(Z=(Z=(65535&Z)*N+(((Z>>>16)*N&65535)<<16)&4294967295)<<15|Z>>>17))*$+(((Z>>>16)*$&65535)<<16)&4294967295)<<13|D>>>19))+((5*(D>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(Z=0,g){case 3:Z^=(255&f.charCodeAt(re+2))<<16;case 2:Z^=(255&f.charCodeAt(re+1))<<8;case 1:D^=Z=(65535&(Z=(Z=(65535&(Z^=255&f.charCodeAt(re)))*N+(((Z>>>16)*N&65535)<<16)&4294967295)<<15|Z>>>17))*$+(((Z>>>16)*$&65535)<<16)&4294967295}return D^=f.length,D=2246822507*(65535&(D^=D>>>16))+((2246822507*(D>>>16)&65535)<<16)&4294967295,D=3266489909*(65535&(D^=D>>>13))+((3266489909*(D>>>16)&65535)<<16)&4294967295,(D^=D>>>16)>>>0};var _n={exports:{}};_n.exports=function(f,u){for(var g,T=f.length,D=u^T,z=0;T>=4;)g=1540483477*(65535&(g=255&f.charCodeAt(z)|(255&f.charCodeAt(++z))<<8|(255&f.charCodeAt(++z))<<16|(255&f.charCodeAt(++z))<<24))+((1540483477*(g>>>16)&65535)<<16),D=1540483477*(65535&D)+((1540483477*(D>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),T-=4,++z;switch(T){case 3:D^=(255&f.charCodeAt(z+2))<<16;case 2:D^=(255&f.charCodeAt(z+1))<<8;case 1:D=1540483477*(65535&(D^=255&f.charCodeAt(z)))+((1540483477*(D>>>16)&65535)<<16)}return D=1540483477*(65535&(D^=D>>>13))+((1540483477*(D>>>16)&65535)<<16),(D^=D>>>15)>>>0};var En=mn.exports,Dn=_n.exports;wn.exports=En,wn.exports.murmur3=En,wn.exports.murmur2=Dn;class ar{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,g,T,D){this.ids.push(kn(u)),this.positions.push(g,T,D)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const g=kn(u);let T=0,D=this.ids.length-1;for(;T<D;){const N=T+D>>1;this.ids[N]>=g?D=N:T=N+1}const z=[];for(;this.ids[T]===g;)z.push({index:this.positions[3*T],start:this.positions[3*T+1],end:this.positions[3*T+2]}),T++;return z}static serialize(u,g){const T=new Float64Array(u.ids),D=new Uint32Array(u.positions);return Er(T,D,0,T.length-1),g&&g.push(T.buffer,D.buffer),{ids:T,positions:D}}static deserialize(u){const g=new ar;return g.ids=u.ids,g.positions=u.positions,g.indexed=!0,g}}function kn(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:wn.exports(String(f))}function Er(f,u,g,T){for(;g<T;){const D=f[g+T>>1];let z=g-1,N=T+1;for(;;){do z++;while(f[z]<D);do N--;while(f[N]>D);if(z>=N)break;Kr(f,z,N),Kr(u,3*z,3*N),Kr(u,3*z+1,3*N+1),Kr(u,3*z+2,3*N+2)}N-g<T-N?(Er(f,u,g,N),g=N+1):(Er(f,u,N+1,T),T=N)}}function Kr(f,u,g){const T=f[u];f[u]=f[g],f[g]=T}Nt("FeaturePositionMap",ar);class ol{constructor(u,g){this.gl=u.gl,this.location=g}}class Tu extends ol{constructor(u,g){super(u,g),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class $f extends ol{constructor(u,g){super(u,g),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class z4 extends ol{constructor(u,g){super(u,g),this.current=a.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const iN=new Float32Array(16);function $v(f){return[vt(255*f.r,255*f.g),vt(255*f.b,255*f.a)]}class Qd{constructor(u,g,T){this.value=u,this.uniformNames=g.map(D=>`u_${D}`),this.type=T}setUniform(u,g,T){u.set(T.constantOr(this.value))}getBinding(u,g,T){return this.type==="color"?new z4(u,g):new Tu(u,g)}}class jf{constructor(u,g){this.uniformNames=g.map(T=>`u_${T}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,g){this.pixelRatioFrom=g.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=g.tlbr,this.patternTo=u.tlbr}setUniform(u,g,T,D){const z=D==="u_pattern_to"?this.patternTo:D==="u_pattern_from"?this.patternFrom:D==="u_pixel_ratio_to"?this.pixelRatioTo:D==="u_pixel_ratio_from"?this.pixelRatioFrom:null;z&&u.set(z)}getBinding(u,g,T){return T.substr(0,9)==="u_pattern"?new $f(u,g):new Tu(u,g)}}class Su{constructor(u,g,T,D){this.expression=u,this.type=T,this.maxValue=0,this.paintVertexAttributes=g.map(z=>({name:`a_${z}`,type:"Float32",components:T==="color"?2:1,offset:0})),this.paintVertexArray=new D}populatePaintArray(u,g,T,D,z){const N=this.paintVertexArray.length,$=this.expression.evaluate(new Mr(0),g,{},D,[],z);this.paintVertexArray.resize(u),this._setPaintValue(N,u,$)}updatePaintArray(u,g,T,D){const z=this.expression.evaluate({zoom:0},T,D);this._setPaintValue(u,g,z)}_setPaintValue(u,g,T){if(this.type==="color"){const D=$v(T);for(let z=u;z<g;z++)this.paintVertexArray.emplace(z,D[0],D[1])}else{for(let D=u;D<g;D++)this.paintVertexArray.emplace(D,T);this.maxValue=Math.max(this.maxValue,Math.abs(T))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ql{constructor(u,g,T,D,z,N){this.expression=u,this.uniformNames=g.map($=>`u_${$}_t`),this.type=T,this.useIntegerZoom=D,this.zoom=z,this.maxValue=0,this.paintVertexAttributes=g.map($=>({name:`a_${$}`,type:"Float32",components:T==="color"?4:2,offset:0})),this.paintVertexArray=new N}populatePaintArray(u,g,T,D,z){const N=this.expression.evaluate(new Mr(this.zoom),g,{},D,[],z),$=this.expression.evaluate(new Mr(this.zoom+1),g,{},D,[],z),Z=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(Z,u,N,$)}updatePaintArray(u,g,T,D){const z=this.expression.evaluate({zoom:this.zoom},T,D),N=this.expression.evaluate({zoom:this.zoom+1},T,D);this._setPaintValue(u,g,z,N)}_setPaintValue(u,g,T,D){if(this.type==="color"){const z=$v(T),N=$v(D);for(let $=u;$<g;$++)this.paintVertexArray.emplace($,z[0],z[1],N[0],N[1])}else{for(let z=u;z<g;z++)this.paintVertexArray.emplace(z,T,D);this.maxValue=Math.max(this.maxValue,Math.abs(T),Math.abs(D))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,g){const T=this.useIntegerZoom?Math.floor(g.zoom):g.zoom,D=k(this.expression.interpolationFactor(T,this.zoom,this.zoom+1),0,1);u.set(D)}getBinding(u,g,T){return new Tu(u,g)}}class Mc{constructor(u,g,T,D,z,N){this.expression=u,this.type=g,this.useIntegerZoom=T,this.zoom=D,this.layerId=N,this.zoomInPaintVertexArray=new z,this.zoomOutPaintVertexArray=new z}populatePaintArray(u,g,T){const D=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(D,u,g.patterns&&g.patterns[this.layerId],T)}updatePaintArray(u,g,T,D,z){this._setPaintValues(u,g,T.patterns&&T.patterns[this.layerId],z)}_setPaintValues(u,g,T,D){if(!D||!T)return;const{min:z,mid:N,max:$}=T,Z=D[z],re=D[N],Ae=D[$];if(Z&&re&&Ae)for(let he=u;he<g;he++)this.zoomInPaintVertexArray.emplace(he,re.tl[0],re.tl[1],re.br[0],re.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],re.pixelRatio,Z.pixelRatio),this.zoomOutPaintVertexArray.emplace(he,re.tl[0],re.tl[1],re.br[0],re.br[1],Ae.tl[0],Ae.tl[1],Ae.br[0],Ae.br[1],re.pixelRatio,Ae.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,Pn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,Pn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class O4{constructor(u,g,T){this.binders={},this._buffers=[];const D=[];for(const z in u.paint._values){if(!T(z))continue;const N=u.paint.get(z);if(!(N instanceof mr&&fr(N.property.specification)))continue;const $=sN(z,u.type),Z=N.value,re=N.property.specification.type,Ae=N.property.useIntegerZoom,he=N.property.specification["property-type"],pe=he==="cross-faded"||he==="cross-faded-data-driven";if(Z.kind==="constant")this.binders[z]=pe?new jf(Z.value,$):new Qd(Z.value,$,re),D.push(`/u_${z}`);else if(Z.kind==="source"||pe){const ye=F4(z,re,"source");this.binders[z]=pe?new Mc(Z,re,Ae,g,ye,u.id):new Su(Z,$,re,ye),D.push(`/a_${z}`)}else{const ye=F4(z,re,"composite");this.binders[z]=new Ql(Z,$,re,Ae,g,ye),D.push(`/z_${z}`)}}this.cacheKey=D.sort().join("")}getMaxValue(u){const g=this.binders[u];return g instanceof Su||g instanceof Ql?g.maxValue:0}populatePaintArrays(u,g,T,D,z){for(const N in this.binders){const $=this.binders[N];($ instanceof Su||$ instanceof Ql||$ instanceof Mc)&&$.populatePaintArray(u,g,T,D,z)}}setConstantPatternPositions(u,g){for(const T in this.binders){const D=this.binders[T];D instanceof jf&&D.setConstantPatternPositions(u,g)}}updatePaintArrays(u,g,T,D,z){let N=!1;for(const $ in u){const Z=g.getPositions($);for(const re of Z){const Ae=T.feature(re.index);for(const he in this.binders){const pe=this.binders[he];if((pe instanceof Su||pe instanceof Ql||pe instanceof Mc)&&pe.expression.isStateDependent===!0){const ye=D.paint.get(he);pe.expression=ye.value,pe.updatePaintArray(re.start,re.end,Ae,u[$],z),N=!0}}}}return N}defines(){const u=[];for(const g in this.binders){const T=this.binders[g];(T instanceof Qd||T instanceof jf)&&u.push(...T.uniformNames.map(D=>`#define HAS_UNIFORM_${D}`))}return u}getBinderAttributes(){const u=[];for(const g in this.binders){const T=this.binders[g];if(T instanceof Su||T instanceof Ql)for(let D=0;D<T.paintVertexAttributes.length;D++)u.push(T.paintVertexAttributes[D].name);else if(T instanceof Mc)for(let D=0;D<Pn.members.length;D++)u.push(Pn.members[D].name)}return u}getBinderUniforms(){const u=[];for(const g in this.binders){const T=this.binders[g];if(T instanceof Qd||T instanceof jf||T instanceof Ql)for(const D of T.uniformNames)u.push(D)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,g){const T=[];for(const D in this.binders){const z=this.binders[D];if(z instanceof Qd||z instanceof jf||z instanceof Ql){for(const N of z.uniformNames)if(g[N]){const $=z.getBinding(u,g[N],N);T.push({name:N,property:D,binding:$})}}}return T}setUniforms(u,g,T,D){for(const{name:z,property:N,binding:$}of g)this.binders[N].setUniform($,D,T.get(N),z)}updatePaintBuffers(u){this._buffers=[];for(const g in this.binders){const T=this.binders[g];if(u&&T instanceof Mc){const D=u.fromScale===2?T.zoomInPaintVertexBuffer:T.zoomOutPaintVertexBuffer;D&&this._buffers.push(D)}else(T instanceof Su||T instanceof Ql)&&T.paintVertexBuffer&&this._buffers.push(T.paintVertexBuffer)}}upload(u){for(const g in this.binders){const T=this.binders[g];(T instanceof Su||T instanceof Ql||T instanceof Mc)&&T.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const g=this.binders[u];(g instanceof Su||g instanceof Ql||g instanceof Mc)&&g.destroy()}}}class Mh{constructor(u,g,T=()=>!0){this.programConfigurations={};for(const D of u)this.programConfigurations[D.id]=new O4(D,g,T);this.needsUpload=!1,this._featureMap=new ar,this._bufferOffset=0}populatePaintArrays(u,g,T,D,z,N){for(const $ in this.programConfigurations)this.programConfigurations[$].populatePaintArrays(u,g,D,z,N);g.id!==void 0&&this._featureMap.add(g.id,T,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,g,T,D){for(const z of T)this.needsUpload=this.programConfigurations[z.id].updatePaintArrays(u,this._featureMap,g,z,D)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const g in this.programConfigurations)this.programConfigurations[g].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function sN(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function F4(f,u,g){const T={color:{source:A,composite:$e},number:{source:ne,composite:A}},D=function(z){return{"line-pattern":{source:je,composite:je},"fill-pattern":{source:je,composite:je},"fill-extrusion-pattern":{source:je,composite:je}}[z]}(f);return D&&D[g]||T[u][g]}Nt("ConstantBinder",Qd),Nt("CrossFadedConstantBinder",jf),Nt("SourceExpressionBinder",Su),Nt("CrossFadedCompositeBinder",Mc),Nt("CompositeExpressionBinder",Ql),Nt("ProgramConfiguration",O4,{omit:["_buffers"]}),Nt("ProgramConfigurationSet",Mh);var zi=8192;const jv=Math.pow(2,14)-1,N4=-jv-1;function Ph(f){const u=zi/f.extent,g=f.loadGeometry();for(let T=0;T<g.length;T++){const D=g[T];for(let z=0;z<D.length;z++){const N=D[z],$=Math.round(N.x*u),Z=Math.round(N.y*u);N.x=k($,N4,jv),N.y=k(Z,N4,jv),($<N.x||$>N.x+1||Z<N.y||Z>N.y+1)&&me("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return g}function kh(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?Ph(f):[]}}function Hm(f,u,g,T,D){f.emplaceBack(2*u+(T+1)/2,2*g+(D+1)/2)}class Hv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new q,this.indexArray=new ot,this.segments=new gt,this.programConfigurations=new Mh(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){const D=this.layers[0],z=[];let N=null,$=!1;D.type==="circle"&&(N=D.layout.get("circle-sort-key"),$=!N.isConstant());for(const{feature:Z,id:re,index:Ae,sourceLayerIndex:he}of u){const pe=this.layers[0]._featureFilter.needGeometry,ye=kh(Z,pe);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),ye,T))continue;const _e=$?N.evaluate(ye,{},T):void 0,Ve={id:re,properties:Z.properties,type:Z.type,sourceLayerIndex:he,index:Ae,geometry:pe?ye.geometry:Ph(Z),patterns:{},sortKey:_e};z.push(Ve)}$&&z.sort((Z,re)=>Z.sortKey-re.sortKey);for(const Z of z){const{geometry:re,index:Ae,sourceLayerIndex:he}=Z,pe=u[Ae].feature;this.addFeature(Z,re,Ae,T),g.featureIndex.insert(pe,re,Ae,he,this.index)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,zt),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,g,T,D){for(const z of g)for(const N of z){const $=N.x,Z=N.y;if($<0||$>=zi||Z<0||Z>=zi)continue;const re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Ae=re.vertexLength;Hm(this.layoutVertexArray,$,Z,-1,-1),Hm(this.layoutVertexArray,$,Z,1,-1),Hm(this.layoutVertexArray,$,Z,1,1),Hm(this.layoutVertexArray,$,Z,-1,1),this.indexArray.emplaceBack(Ae,Ae+1,Ae+2),this.indexArray.emplaceBack(Ae,Ae+3,Ae+2),re.vertexLength+=4,re.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,{},D)}}function U4(f,u){for(let g=0;g<f.length;g++)if(Hf(u,f[g]))return!0;for(let g=0;g<u.length;g++)if(Hf(f,u[g]))return!0;return!!Wv(f,u)}function oN(f,u,g){return!!Hf(f,u)||!!Qv(u,f,g)}function V4(f,u){if(f.length===1)return $4(u,f[0]);for(let g=0;g<u.length;g++){const T=u[g];for(let D=0;D<T.length;D++)if(Hf(f,T[D]))return!0}for(let g=0;g<f.length;g++)if($4(u,f[g]))return!0;for(let g=0;g<u.length;g++)if(Wv(f,u[g]))return!0;return!1}function aN(f,u,g){if(f.length>1){if(Wv(f,u))return!0;for(let T=0;T<u.length;T++)if(Qv(u[T],f,g))return!0}for(let T=0;T<f.length;T++)if(Qv(f[T],u,g))return!0;return!1}function Wv(f,u){if(f.length===0||u.length===0)return!1;for(let g=0;g<f.length-1;g++){const T=f[g],D=f[g+1];for(let z=0;z<u.length-1;z++)if(lN(T,D,u[z],u[z+1]))return!0}return!1}function lN(f,u,g,T){return Ee(f,g,T)!==Ee(u,g,T)&&Ee(f,u,g)!==Ee(f,u,T)}function Qv(f,u,g){const T=g*g;if(u.length===1)return f.distSqr(u[0])<T;for(let D=1;D<u.length;D++)if(G4(f,u[D-1],u[D])<T)return!0;return!1}function G4(f,u,g){const T=u.distSqr(g);if(T===0)return f.distSqr(u);const D=((f.x-u.x)*(g.x-u.x)+(f.y-u.y)*(g.y-u.y))/T;return f.distSqr(D<0?u:D>1?g:g.sub(u)._mult(D)._add(u))}function $4(f,u){let g,T,D,z=!1;for(let N=0;N<f.length;N++){g=f[N];for(let $=0,Z=g.length-1;$<g.length;Z=$++)T=g[$],D=g[Z],T.y>u.y!=D.y>u.y&&u.x<(D.x-T.x)*(u.y-T.y)/(D.y-T.y)+T.x&&(z=!z)}return z}function Hf(f,u){let g=!1;for(let T=0,D=f.length-1;T<f.length;D=T++){const z=f[T],N=f[D];z.y>u.y!=N.y>u.y&&u.x<(N.x-z.x)*(u.y-z.y)/(N.y-z.y)+z.x&&(g=!g)}return g}function AN(f,u,g){const T=g[0],D=g[2];if(f.x<T.x&&u.x<T.x||f.x>D.x&&u.x>D.x||f.y<T.y&&u.y<T.y||f.y>D.y&&u.y>D.y)return!1;const z=Ee(f,u,g[0]);return z!==Ee(f,u,g[1])||z!==Ee(f,u,g[2])||z!==Ee(f,u,g[3])}function qd(f,u,g){const T=u.paint.get(f).value;return T.kind==="constant"?T.value:g.programConfigurations.get(u.id).getMaxValue(f)}function Wm(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function Qm(f,u,g,T,D){if(!u[0]&&!u[1])return f;const z=Et.convert(u)._mult(D);g==="viewport"&&z._rotate(-T);const N=[];for(let $=0;$<f.length;$++)N.push(f[$].sub(z));return N}Nt("CircleBucket",Hv,{omit:["layers"]});const uN=new Hr({"circle-sort-key":new Kt(ht.layout_circle["circle-sort-key"])});var cN={paint:new Hr({"circle-radius":new Kt(ht.paint_circle["circle-radius"]),"circle-color":new Kt(ht.paint_circle["circle-color"]),"circle-blur":new Kt(ht.paint_circle["circle-blur"]),"circle-opacity":new Kt(ht.paint_circle["circle-opacity"]),"circle-translate":new Xt(ht.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(ht.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(ht.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(ht.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Kt(ht.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Kt(ht.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Kt(ht.paint_circle["circle-stroke-opacity"])}),layout:uN},Ks=1e-6,Js=typeof Float32Array<"u"?Float32Array:Array;function j4(){var f=new Js(9);return Js!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f}function qv(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function H4(f,u,g){var T=u[0],D=u[1],z=u[2],N=u[3],$=u[4],Z=u[5],re=u[6],Ae=u[7],he=u[8],pe=u[9],ye=u[10],_e=u[11],Ve=u[12],ze=u[13],it=u[14],ut=u[15],et=g[0],at=g[1],yt=g[2],mt=g[3];return f[0]=et*T+at*$+yt*he+mt*Ve,f[1]=et*D+at*Z+yt*pe+mt*ze,f[2]=et*z+at*re+yt*ye+mt*it,f[3]=et*N+at*Ae+yt*_e+mt*ut,f[4]=(et=g[4])*T+(at=g[5])*$+(yt=g[6])*he+(mt=g[7])*Ve,f[5]=et*D+at*Z+yt*pe+mt*ze,f[6]=et*z+at*re+yt*ye+mt*it,f[7]=et*N+at*Ae+yt*_e+mt*ut,f[8]=(et=g[8])*T+(at=g[9])*$+(yt=g[10])*he+(mt=g[11])*Ve,f[9]=et*D+at*Z+yt*pe+mt*ze,f[10]=et*z+at*re+yt*ye+mt*it,f[11]=et*N+at*Ae+yt*_e+mt*ut,f[12]=(et=g[12])*T+(at=g[13])*$+(yt=g[14])*he+(mt=g[15])*Ve,f[13]=et*D+at*Z+yt*pe+mt*ze,f[14]=et*z+at*re+yt*ye+mt*it,f[15]=et*N+at*Ae+yt*_e+mt*ut,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var Zd,hN=H4;function W4(){var f=new Js(3);return Js!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f}function Q4(f,u,g){var T=new Js(3);return T[0]=f,T[1]=u,T[2]=g,T}function qm(f,u,g){var T=u[0],D=u[1],z=u[2],N=u[3];return f[0]=g[0]*T+g[4]*D+g[8]*z+g[12]*N,f[1]=g[1]*T+g[5]*D+g[9]*z+g[13]*N,f[2]=g[2]*T+g[6]*D+g[10]*z+g[14]*N,f[3]=g[3]*T+g[7]*D+g[11]*z+g[15]*N,f}function q4(){var f=new Js(4);return Js!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f[3]=1,f}function Z4(f,u){const g=qm([],[f.x,f.y,0,1],u);return new Et(g[0]/g[3],g[1]/g[3])}W4(),Zd=new Js(4),Js!=Float32Array&&(Zd[0]=0,Zd[1]=0,Zd[2]=0,Zd[3]=0),W4(),Q4(1,0,0),Q4(0,1,0),q4(),q4(),j4(),function(){var f;f=new Js(2),Js!=Float32Array&&(f[0]=0,f[1]=0)}();class Y4 extends Hv{}Nt("HeatmapBucket",Y4,{omit:["layers"]});var fN={paint:new Hr({"heatmap-radius":new Kt(ht.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Kt(ht.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(ht.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Jo(ht.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(ht.paint_heatmap["heatmap-opacity"])})};function Zv(f,{width:u,height:g},T,D){if(D){if(D instanceof Uint8ClampedArray)D=new Uint8Array(D.buffer);else if(D.length!==u*g*T)throw new RangeError(`mismatched image size. expected: ${D.length} but got: ${u*g*T}`)}else D=new Uint8Array(u*g*T);return f.width=u,f.height=g,f.data=D,f}function X4(f,{width:u,height:g},T){if(u===f.width&&g===f.height)return;const D=Zv({},{width:u,height:g},T);Yv(f,D,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,g)},T),f.width=u,f.height=g,f.data=D.data}function Yv(f,u,g,T,D,z){if(D.width===0||D.height===0)return u;if(D.width>f.width||D.height>f.height||g.x>f.width-D.width||g.y>f.height-D.height)throw new RangeError("out of range source coordinates for image copy");if(D.width>u.width||D.height>u.height||T.x>u.width-D.width||T.y>u.height-D.height)throw new RangeError("out of range destination coordinates for image copy");const N=f.data,$=u.data;if(N===$)throw new Error("srcData equals dstData, so image is already copied");for(let Z=0;Z<D.height;Z++){const re=((g.y+Z)*f.width+g.x)*z,Ae=((T.y+Z)*u.width+T.x)*z;for(let he=0;he<D.width*z;he++)$[Ae+he]=N[re+he]}return u}class Yd{constructor(u,g){Zv(this,u,1,g)}resize(u){X4(this,u,1)}clone(){return new Yd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,g,T,D,z){Yv(u,g,T,D,z,1)}}class Ca{constructor(u,g){Zv(this,u,4,g)}resize(u){X4(this,u,4)}replace(u,g){g?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new Ca({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,g,T,D,z){Yv(u,g,T,D,z,4)}}function K4(f){const u={},g=f.resolution||256,T=f.clips?f.clips.length:1,D=f.image||new Ca({width:g,height:T});if(Math.log(g)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${g}`);const z=(N,$,Z)=>{u[f.evaluationKey]=Z;const re=f.expression.evaluate(u);D.data[N+$+0]=Math.floor(255*re.r/re.a),D.data[N+$+1]=Math.floor(255*re.g/re.a),D.data[N+$+2]=Math.floor(255*re.b/re.a),D.data[N+$+3]=Math.floor(255*re.a)};if(f.clips)for(let N=0,$=0;N<T;++N,$+=4*g)for(let Z=0,re=0;Z<g;Z++,re+=4){const Ae=Z/(g-1),{start:he,end:pe}=f.clips[N];z($,re,he*(1-Ae)+pe*Ae)}else for(let N=0,$=0;N<g;N++,$+=4)z(0,$,N/(g-1));return D}Nt("AlphaImage",Yd),Nt("RGBAImage",Ca);var dN={paint:new Hr({"hillshade-illumination-direction":new Xt(ht.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xt(ht.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(ht.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(ht.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(ht.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(ht.paint_hillshade["hillshade-accent-color"])})};const pN=Wr([{name:"a_pos",components:2,type:"Int16"}],4),{members:gN}=pN;var Zm={exports:{}};function Ym(f,u,g){g=g||2;var T,D,z,N,$,Z,re,Ae=u&&u.length,he=Ae?u[0]*g:f.length,pe=J4(f,0,he,g,!0),ye=[];if(!pe||pe.next===pe.prev)return ye;if(Ae&&(pe=function(Ve,ze,it,ut){var et,at,yt,mt=[];for(et=0,at=ze.length;et<at;et++)(yt=J4(Ve,ze[et]*ut,et<at-1?ze[et+1]*ut:Ve.length,ut,!1))===yt.next&&(yt.steiner=!0),mt.push(EN(yt));for(mt.sort(xN),et=0;et<mt.length;et++)it=wN(mt[et],it);return it}(f,u,pe,g)),f.length>80*g){T=z=f[0],D=N=f[1];for(var _e=g;_e<he;_e+=g)($=f[_e])<T&&(T=$),(Z=f[_e+1])<D&&(D=Z),$>z&&(z=$),Z>N&&(N=Z);re=(re=Math.max(z-T,N-D))!==0?32767/re:0}return Xd(pe,ye,g,T,D,re,0),ye}function J4(f,u,g,T,D){var z,N;if(D===Jv(f,u,g,T)>0)for(z=u;z<g;z+=T)N=n5(z,f[z],f[z+1],N);else for(z=g-T;z>=u;z-=T)N=n5(z,f[z],f[z+1],N);return N&&Xm(N,N.next)&&(Jd(N),N=N.next),N}function Ih(f,u){if(!f)return f;u||(u=f);var g,T=f;do if(g=!1,T.steiner||!Xm(T,T.next)&&yi(T.prev,T,T.next)!==0)T=T.next;else{if(Jd(T),(T=u=T.prev)===T.next)break;g=!0}while(g||T!==u);return u}function Xd(f,u,g,T,D,z,N){if(f){!N&&z&&function(Ae,he,pe,ye){var _e=Ae;do _e.z===0&&(_e.z=Xv(_e.x,_e.y,he,pe,ye)),_e.prevZ=_e.prev,_e.nextZ=_e.next,_e=_e.next;while(_e!==Ae);_e.prevZ.nextZ=null,_e.prevZ=null,function(Ve){var ze,it,ut,et,at,yt,mt,Zt,tn=1;do{for(it=Ve,Ve=null,at=null,yt=0;it;){for(yt++,ut=it,mt=0,ze=0;ze<tn&&(mt++,ut=ut.nextZ);ze++);for(Zt=tn;mt>0||Zt>0&&ut;)mt!==0&&(Zt===0||!ut||it.z<=ut.z)?(et=it,it=it.nextZ,mt--):(et=ut,ut=ut.nextZ,Zt--),at?at.nextZ=et:Ve=et,et.prevZ=at,at=et;it=ut}at.nextZ=null,tn*=2}while(yt>1)}(_e)}(f,T,D,z);for(var $,Z,re=f;f.prev!==f.next;)if($=f.prev,Z=f.next,z?yN(f,T,D,z):mN(f))u.push($.i/g|0),u.push(f.i/g|0),u.push(Z.i/g|0),Jd(f),f=Z.next,re=Z.next;else if((f=Z)===re){N?N===1?Xd(f=_N(Ih(f),u,g),u,g,T,D,z,2):N===2&&vN(f,u,g,T,D,z):Xd(Ih(f),u,g,T,D,z,1);break}}}function mN(f){var u=f.prev,g=f,T=f.next;if(yi(u,g,T)>=0)return!1;for(var D=u.x,z=g.x,N=T.x,$=u.y,Z=g.y,re=T.y,Ae=D<z?D<N?D:N:z<N?z:N,he=$<Z?$<re?$:re:Z<re?Z:re,pe=D>z?D>N?D:N:z>N?z:N,ye=$>Z?$>re?$:re:Z>re?Z:re,_e=T.next;_e!==u;){if(_e.x>=Ae&&_e.x<=pe&&_e.y>=he&&_e.y<=ye&&Wf(D,$,z,Z,N,re,_e.x,_e.y)&&yi(_e.prev,_e,_e.next)>=0)return!1;_e=_e.next}return!0}function yN(f,u,g,T){var D=f.prev,z=f,N=f.next;if(yi(D,z,N)>=0)return!1;for(var $=D.x,Z=z.x,re=N.x,Ae=D.y,he=z.y,pe=N.y,ye=$<Z?$<re?$:re:Z<re?Z:re,_e=Ae<he?Ae<pe?Ae:pe:he<pe?he:pe,Ve=$>Z?$>re?$:re:Z>re?Z:re,ze=Ae>he?Ae>pe?Ae:pe:he>pe?he:pe,it=Xv(ye,_e,u,g,T),ut=Xv(Ve,ze,u,g,T),et=f.prevZ,at=f.nextZ;et&&et.z>=it&&at&&at.z<=ut;){if(et.x>=ye&&et.x<=Ve&&et.y>=_e&&et.y<=ze&&et!==D&&et!==N&&Wf($,Ae,Z,he,re,pe,et.x,et.y)&&yi(et.prev,et,et.next)>=0||(et=et.prevZ,at.x>=ye&&at.x<=Ve&&at.y>=_e&&at.y<=ze&&at!==D&&at!==N&&Wf($,Ae,Z,he,re,pe,at.x,at.y)&&yi(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;et&&et.z>=it;){if(et.x>=ye&&et.x<=Ve&&et.y>=_e&&et.y<=ze&&et!==D&&et!==N&&Wf($,Ae,Z,he,re,pe,et.x,et.y)&&yi(et.prev,et,et.next)>=0)return!1;et=et.prevZ}for(;at&&at.z<=ut;){if(at.x>=ye&&at.x<=Ve&&at.y>=_e&&at.y<=ze&&at!==D&&at!==N&&Wf($,Ae,Z,he,re,pe,at.x,at.y)&&yi(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}function _N(f,u,g){var T=f;do{var D=T.prev,z=T.next.next;!Xm(D,z)&&e5(D,T,T.next,z)&&Kd(D,z)&&Kd(z,D)&&(u.push(D.i/g|0),u.push(T.i/g|0),u.push(z.i/g|0),Jd(T),Jd(T.next),T=f=z),T=T.next}while(T!==f);return Ih(T)}function vN(f,u,g,T,D,z){var N=f;do{for(var $=N.next.next;$!==N.prev;){if(N.i!==$.i&&TN(N,$)){var Z=t5(N,$);return N=Ih(N,N.next),Z=Ih(Z,Z.next),Xd(N,u,g,T,D,z,0),void Xd(Z,u,g,T,D,z,0)}$=$.next}N=N.next}while(N!==f)}function xN(f,u){return f.x-u.x}function wN(f,u){var g=function(D,z){var N,$=z,Z=D.x,re=D.y,Ae=-1/0;do{if(re<=$.y&&re>=$.next.y&&$.next.y!==$.y){var he=$.x+(re-$.y)*($.next.x-$.x)/($.next.y-$.y);if(he<=Z&&he>Ae&&(Ae=he,N=$.x<$.next.x?$:$.next,he===Z))return N}$=$.next}while($!==z);if(!N)return null;var pe,ye=N,_e=N.x,Ve=N.y,ze=1/0;$=N;do Z>=$.x&&$.x>=_e&&Z!==$.x&&Wf(re<Ve?Z:Ae,re,_e,Ve,re<Ve?Ae:Z,re,$.x,$.y)&&(pe=Math.abs(re-$.y)/(Z-$.x),Kd($,D)&&(pe<ze||pe===ze&&($.x>N.x||$.x===N.x&&bN(N,$)))&&(N=$,ze=pe)),$=$.next;while($!==ye);return N}(f,u);if(!g)return u;var T=t5(g,f);return Ih(T,T.next),Ih(g,g.next)}function bN(f,u){return yi(f.prev,f,u.prev)<0&&yi(u.next,f,f.next)<0}function Xv(f,u,g,T,D){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-g)*D|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-T)*D|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function EN(f){var u=f,g=f;do(u.x<g.x||u.x===g.x&&u.y<g.y)&&(g=u),u=u.next;while(u!==f);return g}function Wf(f,u,g,T,D,z,N,$){return(D-N)*(u-$)>=(f-N)*(z-$)&&(f-N)*(T-$)>=(g-N)*(u-$)&&(g-N)*(z-$)>=(D-N)*(T-$)}function TN(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(g,T){var D=g;do{if(D.i!==g.i&&D.next.i!==g.i&&D.i!==T.i&&D.next.i!==T.i&&e5(D,D.next,g,T))return!0;D=D.next}while(D!==g);return!1}(f,u)&&(Kd(f,u)&&Kd(u,f)&&function(g,T){var D=g,z=!1,N=(g.x+T.x)/2,$=(g.y+T.y)/2;do D.y>$!=D.next.y>$&&D.next.y!==D.y&&N<(D.next.x-D.x)*($-D.y)/(D.next.y-D.y)+D.x&&(z=!z),D=D.next;while(D!==g);return z}(f,u)&&(yi(f.prev,f,u.prev)||yi(f,u.prev,u))||Xm(f,u)&&yi(f.prev,f,f.next)>0&&yi(u.prev,u,u.next)>0)}function yi(f,u,g){return(u.y-f.y)*(g.x-u.x)-(u.x-f.x)*(g.y-u.y)}function Xm(f,u){return f.x===u.x&&f.y===u.y}function e5(f,u,g,T){var D=Jm(yi(f,u,g)),z=Jm(yi(f,u,T)),N=Jm(yi(g,T,f)),$=Jm(yi(g,T,u));return D!==z&&N!==$||!(D!==0||!Km(f,g,u))||!(z!==0||!Km(f,T,u))||!(N!==0||!Km(g,f,T))||!($!==0||!Km(g,u,T))}function Km(f,u,g){return u.x<=Math.max(f.x,g.x)&&u.x>=Math.min(f.x,g.x)&&u.y<=Math.max(f.y,g.y)&&u.y>=Math.min(f.y,g.y)}function Jm(f){return f>0?1:f<0?-1:0}function Kd(f,u){return yi(f.prev,f,f.next)<0?yi(f,u,f.next)>=0&&yi(f,f.prev,u)>=0:yi(f,u,f.prev)<0||yi(f,f.next,u)<0}function t5(f,u){var g=new Kv(f.i,f.x,f.y),T=new Kv(u.i,u.x,u.y),D=f.next,z=u.prev;return f.next=u,u.prev=f,g.next=D,D.prev=g,T.next=g,g.prev=T,z.next=T,T.prev=z,T}function n5(f,u,g,T){var D=new Kv(f,u,g);return T?(D.next=T.next,D.prev=T,T.next.prev=D,T.next=D):(D.prev=D,D.next=D),D}function Jd(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function Kv(f,u,g){this.i=f,this.x=u,this.y=g,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Jv(f,u,g,T){for(var D=0,z=u,N=g-T;z<g;z+=T)D+=(f[N]-f[z])*(f[z+1]+f[N+1]),N=z;return D}function SN(f,u,g,T,D){r5(f,u,g||0,T||f.length-1,D||CN)}function r5(f,u,g,T,D){for(;T>g;){if(T-g>600){var z=T-g+1,N=u-g+1,$=Math.log(z),Z=.5*Math.exp(2*$/3),re=.5*Math.sqrt($*Z*(z-Z)/z)*(N-z/2<0?-1:1);r5(f,u,Math.max(g,Math.floor(u-N*Z/z+re)),Math.min(T,Math.floor(u+(z-N)*Z/z+re)),D)}var Ae=f[u],he=g,pe=T;for(ep(f,g,u),D(f[T],Ae)>0&&ep(f,g,T);he<pe;){for(ep(f,he,pe),he++,pe--;D(f[he],Ae)<0;)he++;for(;D(f[pe],Ae)>0;)pe--}D(f[g],Ae)===0?ep(f,g,pe):ep(f,++pe,T),pe<=u&&(g=pe+1),u<=pe&&(T=pe-1)}}function ep(f,u,g){var T=f[u];f[u]=f[g],f[g]=T}function CN(f,u){return f<u?-1:f>u?1:0}function ex(f,u){const g=f.length;if(g<=1)return[f];const T=[];let D,z;for(let N=0;N<g;N++){const $=He(f[N]);$!==0&&(f[N].area=Math.abs($),z===void 0&&(z=$<0),z===$<0?(D&&T.push(D),D=[f[N]]):D.push(f[N]))}if(D&&T.push(D),u>1)for(let N=0;N<T.length;N++)T[N].length<=u||(SN(T[N],u,1,T[N].length-1,MN),T[N]=T[N].slice(0,u));return T}function MN(f,u){return u.area-f.area}function tx(f,u,g){const T=g.patternDependencies;let D=!1;for(const z of u){const N=z.paint.get(`${f}-pattern`);N.isConstant()||(D=!0);const $=N.constantOr(null);$&&(D=!0,T[$.to]=!0,T[$.from]=!0)}return D}function nx(f,u,g,T,D){const z=D.patternDependencies;for(const N of u){const $=N.paint.get(`${f}-pattern`).value;if($.kind!=="constant"){let Z=$.evaluate({zoom:T-1},g,{},D.availableImages),re=$.evaluate({zoom:T},g,{},D.availableImages),Ae=$.evaluate({zoom:T+1},g,{},D.availableImages);Z=Z&&Z.name?Z.name:Z,re=re&&re.name?re.name:re,Ae=Ae&&Ae.name?Ae.name:Ae,z[Z]=!0,z[re]=!0,z[Ae]=!0,g.patterns[N.id]={min:Z,mid:re,max:Ae}}}return g}Zm.exports=Ym,Zm.exports.default=Ym,Ym.deviation=function(f,u,g,T){var D=u&&u.length,z=Math.abs(Jv(f,0,D?u[0]*g:f.length,g));if(D)for(var N=0,$=u.length;N<$;N++)z-=Math.abs(Jv(f,u[N]*g,N<$-1?u[N+1]*g:f.length,g));var Z=0;for(N=0;N<T.length;N+=3){var re=T[N]*g,Ae=T[N+1]*g,he=T[N+2]*g;Z+=Math.abs((f[re]-f[he])*(f[Ae+1]-f[re+1])-(f[re]-f[Ae])*(f[he+1]-f[re+1]))}return z===0&&Z===0?0:Math.abs((Z-z)/z)},Ym.flatten=function(f){for(var u=f[0][0].length,g={vertices:[],holes:[],dimensions:u},T=0,D=0;D<f.length;D++){for(var z=0;z<f[D].length;z++)for(var N=0;N<u;N++)g.vertices.push(f[D][z][N]);D>0&&g.holes.push(T+=f[D-1].length)}return g};class rx{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ee,this.indexArray=new ot,this.indexArray2=new Je,this.programConfigurations=new Mh(u.layers,u.zoom),this.segments=new gt,this.segments2=new gt,this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){this.hasPattern=tx("fill",this.layers,g);const D=this.layers[0].layout.get("fill-sort-key"),z=!D.isConstant(),N=[];for(const{feature:$,id:Z,index:re,sourceLayerIndex:Ae}of u){const he=this.layers[0]._featureFilter.needGeometry,pe=kh($,he);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),pe,T))continue;const ye=z?D.evaluate(pe,{},T,g.availableImages):void 0,_e={id:Z,properties:$.properties,type:$.type,sourceLayerIndex:Ae,index:re,geometry:he?pe.geometry:Ph($),patterns:{},sortKey:ye};N.push(_e)}z&&N.sort(($,Z)=>$.sortKey-Z.sortKey);for(const $ of N){const{geometry:Z,index:re,sourceLayerIndex:Ae}=$;if(this.hasPattern){const he=nx("fill",this.layers,$,this.zoom,g);this.patternFeatures.push(he)}else this.addFeature($,Z,re,T,{});g.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}addFeatures(u,g,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,g,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,gN),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,g,T,D,z){for(const N of ex(g,500)){let $=0;for(const ye of N)$+=ye.length;const Z=this.segments.prepareSegment($,this.layoutVertexArray,this.indexArray),re=Z.vertexLength,Ae=[],he=[];for(const ye of N){if(ye.length===0)continue;ye!==N[0]&&he.push(Ae.length/2);const _e=this.segments2.prepareSegment(ye.length,this.layoutVertexArray,this.indexArray2),Ve=_e.vertexLength;this.layoutVertexArray.emplaceBack(ye[0].x,ye[0].y),this.indexArray2.emplaceBack(Ve+ye.length-1,Ve),Ae.push(ye[0].x),Ae.push(ye[0].y);for(let ze=1;ze<ye.length;ze++)this.layoutVertexArray.emplaceBack(ye[ze].x,ye[ze].y),this.indexArray2.emplaceBack(Ve+ze-1,Ve+ze),Ae.push(ye[ze].x),Ae.push(ye[ze].y);_e.vertexLength+=ye.length,_e.primitiveLength+=ye.length}const pe=Zm.exports(Ae,he);for(let ye=0;ye<pe.length;ye+=3)this.indexArray.emplaceBack(re+pe[ye],re+pe[ye+1],re+pe[ye+2]);Z.vertexLength+=$,Z.primitiveLength+=pe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}Nt("FillBucket",rx,{omit:["layers","patternFeatures"]});const PN=new Hr({"fill-sort-key":new Kt(ht.layout_fill["fill-sort-key"])});var kN={paint:new Hr({"fill-antialias":new Xt(ht.paint_fill["fill-antialias"]),"fill-opacity":new Kt(ht.paint_fill["fill-opacity"]),"fill-color":new Kt(ht.paint_fill["fill-color"]),"fill-outline-color":new Kt(ht.paint_fill["fill-outline-color"]),"fill-translate":new Xt(ht.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(ht.paint_fill["fill-translate-anchor"]),"fill-pattern":new fn(ht.paint_fill["fill-pattern"])}),layout:PN};const IN=Wr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),LN=Wr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:DN}=IN;var Pc={},RN=Et,i5=Qf;function Qf(f,u,g,T,D){this.properties={},this.extent=g,this.type=0,this._pbf=f,this._geometry=-1,this._keys=T,this._values=D,f.readFields(BN,this,u)}function BN(f,u,g){f==1?u.id=g.readVarint():f==2?function(T,D){for(var z=T.readVarint()+T.pos;T.pos<z;){var N=D._keys[T.readVarint()],$=D._values[T.readVarint()];D.properties[N]=$}}(g,u):f==3?u.type=g.readVarint():f==4&&(u._geometry=g.pos)}function zN(f){for(var u,g,T=0,D=0,z=f.length,N=z-1;D<z;N=D++)T+=((g=f[N]).x-(u=f[D]).x)*(u.y+g.y);return T}Qf.types=["Unknown","Point","LineString","Polygon"],Qf.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,g=f.readVarint()+f.pos,T=1,D=0,z=0,N=0,$=[];f.pos<g;){if(D<=0){var Z=f.readVarint();T=7&Z,D=Z>>3}if(D--,T===1||T===2)z+=f.readSVarint(),N+=f.readSVarint(),T===1&&(u&&$.push(u),u=[]),u.push(new RN(z,N));else{if(T!==7)throw new Error("unknown command "+T);u&&u.push(u[0].clone())}}return u&&$.push(u),$},Qf.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,g=1,T=0,D=0,z=0,N=1/0,$=-1/0,Z=1/0,re=-1/0;f.pos<u;){if(T<=0){var Ae=f.readVarint();g=7&Ae,T=Ae>>3}if(T--,g===1||g===2)(D+=f.readSVarint())<N&&(N=D),D>$&&($=D),(z+=f.readSVarint())<Z&&(Z=z),z>re&&(re=z);else if(g!==7)throw new Error("unknown command "+g)}return[N,Z,$,re]},Qf.prototype.toGeoJSON=function(f,u,g){var T,D,z=this.extent*Math.pow(2,g),N=this.extent*f,$=this.extent*u,Z=this.loadGeometry(),re=Qf.types[this.type];function Ae(ye){for(var _e=0;_e<ye.length;_e++){var Ve=ye[_e];ye[_e]=[360*(Ve.x+N)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ve.y+$)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var he=[];for(T=0;T<Z.length;T++)he[T]=Z[T][0];Ae(Z=he);break;case 2:for(T=0;T<Z.length;T++)Ae(Z[T]);break;case 3:for(Z=function(ye){var _e=ye.length;if(_e<=1)return[ye];for(var Ve,ze,it=[],ut=0;ut<_e;ut++){var et=zN(ye[ut]);et!==0&&(ze===void 0&&(ze=et<0),ze===et<0?(Ve&&it.push(Ve),Ve=[ye[ut]]):Ve.push(ye[ut]))}return Ve&&it.push(Ve),it}(Z),T=0;T<Z.length;T++)for(D=0;D<Z[T].length;D++)Ae(Z[T][D])}Z.length===1?Z=Z[0]:re="Multi"+re;var pe={type:"Feature",geometry:{type:re,coordinates:Z},properties:this.properties};return"id"in this&&(pe.id=this.id),pe};var ON=i5,s5=o5;function o5(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(FN,this,u),this.length=this._features.length}function FN(f,u,g){f===15?u.version=g.readVarint():f===1?u.name=g.readString():f===5?u.extent=g.readVarint():f===2?u._features.push(g.pos):f===3?u._keys.push(g.readString()):f===4&&u._values.push(function(T){for(var D=null,z=T.readVarint()+T.pos;T.pos<z;){var N=T.readVarint()>>3;D=N===1?T.readString():N===2?T.readFloat():N===3?T.readDouble():N===4?T.readVarint64():N===5?T.readVarint():N===6?T.readSVarint():N===7?T.readBoolean():null}return D}(g))}o5.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new ON(this._pbf,u,this.extent,this._keys,this._values)};var NN=s5;function UN(f,u,g){if(f===3){var T=new NN(g,g.readVarint()+g.pos);T.length&&(u[T.name]=T)}}Pc.VectorTile=function(f,u){this.layers=f.readFields(UN,{},u)},Pc.VectorTileFeature=i5,Pc.VectorTileLayer=s5;const VN=Pc.VectorTileFeature.types,ix=Math.pow(2,13);function tp(f,u,g,T,D,z,N,$){f.emplaceBack(u,g,2*Math.floor(T*ix)+N,D*ix*2,z*ix*2,Math.round($))}class sx{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new le,this.centroidVertexArray=new U,this.indexArray=new ot,this.programConfigurations=new Mh(u.layers,u.zoom),this.segments=new gt,this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){this.features=[],this.hasPattern=tx("fill-extrusion",this.layers,g);for(const{feature:D,id:z,index:N,sourceLayerIndex:$}of u){const Z=this.layers[0]._featureFilter.needGeometry,re=kh(D,Z);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),re,T))continue;const Ae={id:z,sourceLayerIndex:$,index:N,geometry:Z?re.geometry:Ph(D),properties:D.properties,type:D.type,patterns:{}};this.hasPattern?this.features.push(nx("fill-extrusion",this.layers,Ae,this.zoom,g)):this.addFeature(Ae,Ae.geometry,N,T,{}),g.featureIndex.insert(D,Ae.geometry,N,$,this.index,!0)}}addFeatures(u,g,T){for(const D of this.features){const{geometry:z}=D;this.addFeature(D,z,D.index,g,T)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,DN),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,LN.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,g,T,D,z){const N={x:0,y:0,vertexCount:0};for(const $ of ex(g,500)){let Z=0;for(const _e of $)Z+=_e.length;let re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const _e of $){if(_e.length===0||$N(_e))continue;let Ve=0;for(let ze=0;ze<_e.length;ze++){const it=_e[ze];if(ze>=1){const ut=_e[ze-1];if(!GN(it,ut)){re.vertexLength+4>gt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const et=it.sub(ut)._perp()._unit(),at=ut.dist(it);Ve+at>32768&&(Ve=0),tp(this.layoutVertexArray,it.x,it.y,et.x,et.y,0,0,Ve),tp(this.layoutVertexArray,it.x,it.y,et.x,et.y,0,1,Ve),N.x+=2*it.x,N.y+=2*it.y,N.vertexCount+=2,Ve+=at,tp(this.layoutVertexArray,ut.x,ut.y,et.x,et.y,0,0,Ve),tp(this.layoutVertexArray,ut.x,ut.y,et.x,et.y,0,1,Ve),N.x+=2*ut.x,N.y+=2*ut.y,N.vertexCount+=2;const yt=re.vertexLength;this.indexArray.emplaceBack(yt,yt+2,yt+1),this.indexArray.emplaceBack(yt+1,yt+2,yt+3),re.vertexLength+=4,re.primitiveLength+=2}}}}if(re.vertexLength+Z>gt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(Z,this.layoutVertexArray,this.indexArray)),VN[u.type]!=="Polygon")continue;const Ae=[],he=[],pe=re.vertexLength;for(const _e of $)if(_e.length!==0){_e!==$[0]&&he.push(Ae.length/2);for(let Ve=0;Ve<_e.length;Ve++){const ze=_e[Ve];tp(this.layoutVertexArray,ze.x,ze.y,0,0,1,1,0),N.x+=ze.x,N.y+=ze.y,N.vertexCount+=1,Ae.push(ze.x),Ae.push(ze.y)}}const ye=Zm.exports(Ae,he);for(let _e=0;_e<ye.length;_e+=3)this.indexArray.emplaceBack(pe+ye[_e],pe+ye[_e+2],pe+ye[_e+1]);re.primitiveLength+=ye.length/3,re.vertexLength+=Z}for(let $=0;$<N.vertexCount;$++)this.centroidVertexArray.emplaceBack(Math.floor(N.x/N.vertexCount),Math.floor(N.y/N.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}function GN(f,u){return f.x===u.x&&(f.x<0||f.x>zi)||f.y===u.y&&(f.y<0||f.y>zi)}function $N(f){return f.every(u=>u.x<0)||f.every(u=>u.x>zi)||f.every(u=>u.y<0)||f.every(u=>u.y>zi)}Nt("FillExtrusionBucket",sx,{omit:["layers","features"]});var jN={paint:new Hr({"fill-extrusion-opacity":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Kt(ht["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new fn(ht["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Kt(ht["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Kt(ht["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xt(ht["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function np(f,u){return f.x*u.x+f.y*u.y}function a5(f,u){if(f.length===1){let g=0;const T=u[g++];let D;for(;!D||T.equals(D);)if(D=u[g++],!D)return 1/0;for(;g<u.length;g++){const z=u[g],N=f[0],$=D.sub(T),Z=z.sub(T),re=N.sub(T),Ae=np($,$),he=np($,Z),pe=np(Z,Z),ye=np(re,$),_e=np(re,Z),Ve=Ae*pe-he*he,ze=(pe*ye-he*_e)/Ve,it=(Ae*_e-he*ye)/Ve,ut=T.z*(1-ze-it)+D.z*ze+z.z*it;if(isFinite(ut))return ut}return 1/0}{let g=1/0;for(const T of u)g=Math.min(g,T.z);return g}}const HN=Wr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:WN}=HN,QN=Wr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:qN}=QN,ZN=Pc.VectorTileFeature.types,YN=Math.cos(Math.PI/180*37.5),l5=Math.pow(2,14)/.5;class ox{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(g=>g.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(g=>{this.gradients[g.id]={}}),this.layoutVertexArray=new de,this.layoutVertexArray2=new Re,this.indexArray=new ot,this.programConfigurations=new Mh(u.layers,u.zoom),this.segments=new gt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id)}populate(u,g,T){this.hasPattern=tx("line",this.layers,g);const D=this.layers[0].layout.get("line-sort-key"),z=!D.isConstant(),N=[];for(const{feature:$,id:Z,index:re,sourceLayerIndex:Ae}of u){const he=this.layers[0]._featureFilter.needGeometry,pe=kh($,he);if(!this.layers[0]._featureFilter.filter(new Mr(this.zoom),pe,T))continue;const ye=z?D.evaluate(pe,{},T):void 0,_e={id:Z,properties:$.properties,type:$.type,sourceLayerIndex:Ae,index:re,geometry:he?pe.geometry:Ph($),patterns:{},sortKey:ye};N.push(_e)}z&&N.sort(($,Z)=>$.sortKey-Z.sortKey);for(const $ of N){const{geometry:Z,index:re,sourceLayerIndex:Ae}=$;if(this.hasPattern){const he=nx("line",this.layers,$,this.zoom,g);this.patternFeatures.push(he)}else this.addFeature($,Z,re,T,{});g.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,g,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,g,this.stateDependentLayers,T)}addFeatures(u,g,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,g,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,qN)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,WN),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,g,T,D,z){const N=this.layers[0].layout,$=N.get("line-join").evaluate(u,{}),Z=N.get("line-cap"),re=N.get("line-miter-limit"),Ae=N.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const he of g)this.addLine(he,u,$,Z,re,Ae);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}addLine(u,g,T,D,z,N){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let it=0;it<u.length-1;it++)this.totalDistance+=u[it].dist(u[it+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const $=ZN[g.type]==="Polygon";let Z=u.length;for(;Z>=2&&u[Z-1].equals(u[Z-2]);)Z--;let re=0;for(;re<Z-1&&u[re].equals(u[re+1]);)re++;if(Z<($?3:2))return;T==="bevel"&&(z=1.05);const Ae=this.overscaling<=16?122880/(512*this.overscaling):0,he=this.segments.prepareSegment(10*Z,this.layoutVertexArray,this.indexArray);let pe,ye,_e,Ve,ze;this.e1=this.e2=-1,$&&(pe=u[Z-2],ze=u[re].sub(pe)._unit()._perp());for(let it=re;it<Z;it++){if(_e=it===Z-1?$?u[re+1]:void 0:u[it+1],_e&&u[it].equals(_e))continue;ze&&(Ve=ze),pe&&(ye=pe),pe=u[it],ze=_e?_e.sub(pe)._unit()._perp():Ve,Ve=Ve||ze;let ut=Ve.add(ze);ut.x===0&&ut.y===0||ut._unit();const et=Ve.x*ze.x+Ve.y*ze.y,at=ut.x*ze.x+ut.y*ze.y,yt=at!==0?1/at:1/0,mt=2*Math.sqrt(2-2*at),Zt=at<YN&&ye&&_e,tn=Ve.x*ze.y-Ve.y*ze.x>0;if(Zt&&it>re){const Ot=pe.dist(ye);if(Ot>2*Ae){const Wt=pe.sub(pe.sub(ye)._mult(Ae/Ot)._round());this.updateDistance(ye,Wt),this.addCurrentVertex(Wt,Ve,0,0,he),ye=Wt}}const Ht=ye&&_e;let Ut=Ht?T:$?"butt":D;if(Ht&&Ut==="round"&&(yt<N?Ut="miter":yt<=2&&(Ut="fakeround")),Ut==="miter"&&yt>z&&(Ut="bevel"),Ut==="bevel"&&(yt>2&&(Ut="flipbevel"),yt<z&&(Ut="miter")),ye&&this.updateDistance(ye,pe),Ut==="miter")ut._mult(yt),this.addCurrentVertex(pe,ut,0,0,he);else if(Ut==="flipbevel"){if(yt>100)ut=ze.mult(-1);else{const Ot=yt*Ve.add(ze).mag()/Ve.sub(ze).mag();ut._perp()._mult(Ot*(tn?-1:1))}this.addCurrentVertex(pe,ut,0,0,he),this.addCurrentVertex(pe,ut.mult(-1),0,0,he)}else if(Ut==="bevel"||Ut==="fakeround"){const Ot=-Math.sqrt(yt*yt-1),Wt=tn?Ot:0,$t=tn?0:Ot;if(ye&&this.addCurrentVertex(pe,Ve,Wt,$t,he),Ut==="fakeround"){const St=Math.round(180*mt/Math.PI/20);for(let gn=1;gn<St;gn++){let ln=gn/St;if(ln!==.5){const Vr=ln-.5;ln+=ln*Vr*(ln-1)*((1.0904+et*(et*(3.55645-1.43519*et)-3.2452))*Vr*Vr+(.848013+et*(.215638*et-1.06021)))}const jn=ze.sub(Ve)._mult(ln)._add(Ve)._unit()._mult(tn?-1:1);this.addHalfVertex(pe,jn.x,jn.y,!1,tn,0,he)}}_e&&this.addCurrentVertex(pe,ze,-Wt,-$t,he)}else if(Ut==="butt")this.addCurrentVertex(pe,ut,0,0,he);else if(Ut==="square"){const Ot=ye?1:-1;this.addCurrentVertex(pe,ut,Ot,Ot,he)}else Ut==="round"&&(ye&&(this.addCurrentVertex(pe,Ve,0,0,he),this.addCurrentVertex(pe,Ve,1,1,he,!0)),_e&&(this.addCurrentVertex(pe,ze,-1,-1,he,!0),this.addCurrentVertex(pe,ze,0,0,he)));if(Zt&&it<Z-1){const Ot=pe.dist(_e);if(Ot>2*Ae){const Wt=pe.add(_e.sub(pe)._mult(Ae/Ot)._round());this.updateDistance(pe,Wt),this.addCurrentVertex(Wt,ze,0,0,he),pe=Wt}}}}addCurrentVertex(u,g,T,D,z,N=!1){const $=g.y*D-g.x,Z=-g.y-g.x*D;this.addHalfVertex(u,g.x+g.y*T,g.y-g.x*T,N,!1,T,z),this.addHalfVertex(u,$,Z,N,!0,-D,z),this.distance>l5/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(u,g,T,D,z,N))}addHalfVertex({x:u,y:g},T,D,z,N,$,Z){const re=.5*(this.lineClips?this.scaledDistance*(l5-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(z?1:0),(g<<1)+(N?1:0),Math.round(63*T)+128,Math.round(63*D)+128,1+($===0?0:$<0?-1:1)|(63&re)<<2,re>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Ae=Z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Ae),Z.primitiveLength++),N?this.e2=Ae:this.e1=Ae}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,g){this.distance+=u.dist(g),this.updateScaledDistance()}}Nt("LineBucket",ox,{omit:["layers","patternFeatures"]});const XN=new Hr({"line-cap":new Xt(ht.layout_line["line-cap"]),"line-join":new Kt(ht.layout_line["line-join"]),"line-miter-limit":new Xt(ht.layout_line["line-miter-limit"]),"line-round-limit":new Xt(ht.layout_line["line-round-limit"]),"line-sort-key":new Kt(ht.layout_line["line-sort-key"])});var A5={paint:new Hr({"line-opacity":new Kt(ht.paint_line["line-opacity"]),"line-color":new Kt(ht.paint_line["line-color"]),"line-translate":new Xt(ht.paint_line["line-translate"]),"line-translate-anchor":new Xt(ht.paint_line["line-translate-anchor"]),"line-width":new Kt(ht.paint_line["line-width"]),"line-gap-width":new Kt(ht.paint_line["line-gap-width"]),"line-offset":new Kt(ht.paint_line["line-offset"]),"line-blur":new Kt(ht.paint_line["line-blur"]),"line-dasharray":new es(ht.paint_line["line-dasharray"]),"line-pattern":new fn(ht.paint_line["line-pattern"]),"line-gradient":new Jo(ht.paint_line["line-gradient"])}),layout:XN};const u5=new class extends Kt{possiblyEvaluate(f,u){return u=new Mr(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(f,u)}evaluate(f,u,g,T){return u=H({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(f,u,g,T)}}(A5.paint.properties["line-width"].specification);function c5(f,u){return u>0?u+2*f:f}u5.useIntegerZoom=!0;const KN=Wr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),JN=Wr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Wr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const e9=Wr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Wr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const h5=Wr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),t9=Wr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function n9(f,u,g){return f.sections.forEach(T=>{T.text=function(D,z,N){const $=z.layout.get("text-transform").evaluate(N,{});return $==="uppercase"?D=D.toLocaleUpperCase():$==="lowercase"&&(D=D.toLocaleLowerCase()),ps.applyArabicShaping&&(D=ps.applyArabicShaping(D)),D}(T.text,u,g)}),f}Wr([{name:"triangle",components:3,type:"Uint16"}]),Wr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Wr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Wr([{type:"Float32",name:"offsetX"}]),Wr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const rp={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var ts=24,ax=Ir,f5=function(f,u,g,T,D){var z,N,$=8*D-T-1,Z=(1<<$)-1,re=Z>>1,Ae=-7,he=g?D-1:0,pe=g?-1:1,ye=f[u+he];for(he+=pe,z=ye&(1<<-Ae)-1,ye>>=-Ae,Ae+=$;Ae>0;z=256*z+f[u+he],he+=pe,Ae-=8);for(N=z&(1<<-Ae)-1,z>>=-Ae,Ae+=T;Ae>0;N=256*N+f[u+he],he+=pe,Ae-=8);if(z===0)z=1-re;else{if(z===Z)return N?NaN:1/0*(ye?-1:1);N+=Math.pow(2,T),z-=re}return(ye?-1:1)*N*Math.pow(2,z-T)},d5=function(f,u,g,T,D,z){var N,$,Z,re=8*z-D-1,Ae=(1<<re)-1,he=Ae>>1,pe=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,ye=T?0:z-1,_e=T?1:-1,Ve=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?($=isNaN(u)?1:0,N=Ae):(N=Math.floor(Math.log(u)/Math.LN2),u*(Z=Math.pow(2,-N))<1&&(N--,Z*=2),(u+=N+he>=1?pe/Z:pe*Math.pow(2,1-he))*Z>=2&&(N++,Z/=2),N+he>=Ae?($=0,N=Ae):N+he>=1?($=(u*Z-1)*Math.pow(2,D),N+=he):($=u*Math.pow(2,he-1)*Math.pow(2,D),N=0));D>=8;f[g+ye]=255&$,ye+=_e,$/=256,D-=8);for(N=N<<D|$,re+=D;re>0;f[g+ye]=255&N,ye+=_e,N/=256,re-=8);f[g+ye-_e]|=128*Ve};function Ir(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}Ir.Varint=0,Ir.Fixed64=1,Ir.Bytes=2,Ir.Fixed32=5;var kc,lx=4294967296,p5=1/lx,g5=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Cu(f){return f.type===Ir.Bytes?f.readVarint()+f.pos:f.pos+1}function qf(f,u,g){return g?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function m5(f,u,g){var T=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));g.realloc(T);for(var D=g.pos-1;D>=f;D--)g.buf[D+T]=g.buf[D]}function r9(f,u){for(var g=0;g<f.length;g++)u.writeVarint(f[g])}function i9(f,u){for(var g=0;g<f.length;g++)u.writeSVarint(f[g])}function s9(f,u){for(var g=0;g<f.length;g++)u.writeFloat(f[g])}function o9(f,u){for(var g=0;g<f.length;g++)u.writeDouble(f[g])}function a9(f,u){for(var g=0;g<f.length;g++)u.writeBoolean(f[g])}function l9(f,u){for(var g=0;g<f.length;g++)u.writeFixed32(f[g])}function A9(f,u){for(var g=0;g<f.length;g++)u.writeSFixed32(f[g])}function u9(f,u){for(var g=0;g<f.length;g++)u.writeFixed64(f[g])}function c9(f,u){for(var g=0;g<f.length;g++)u.writeSFixed64(f[g])}function e1(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function Zf(f,u,g){f[g]=u,f[g+1]=u>>>8,f[g+2]=u>>>16,f[g+3]=u>>>24}function y5(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}function h9(f,u,g){f===1&&g.readMessage(f9,u)}function f9(f,u,g){if(f===3){const{id:T,bitmap:D,width:z,height:N,left:$,top:Z,advance:re}=g.readMessage(d9,{});u.push({id:T,bitmap:new Yd({width:z+6,height:N+6},D),metrics:{width:z,height:N,left:$,top:Z,advance:re}})}}function d9(f,u,g){f===1?u.id=g.readVarint():f===2?u.bitmap=g.readBytes():f===3?u.width=g.readVarint():f===4?u.height=g.readVarint():f===5?u.left=g.readSVarint():f===6?u.top=g.readSVarint():f===7&&(u.advance=g.readVarint())}function _5(f){let u=0,g=0;for(const N of f)u+=N.w*N.h,g=Math.max(g,N.w);f.sort((N,$)=>$.h-N.h);const T=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),g),h:1/0}];let D=0,z=0;for(const N of f)for(let $=T.length-1;$>=0;$--){const Z=T[$];if(!(N.w>Z.w||N.h>Z.h)){if(N.x=Z.x,N.y=Z.y,z=Math.max(z,N.y+N.h),D=Math.max(D,N.x+N.w),N.w===Z.w&&N.h===Z.h){const re=T.pop();$<T.length&&(T[$]=re)}else N.h===Z.h?(Z.x+=N.w,Z.w-=N.w):N.w===Z.w?(Z.y+=N.h,Z.h-=N.h):(T.push({x:Z.x+N.w,y:Z.y,w:Z.w-N.w,h:N.h}),Z.y+=N.h,Z.h-=N.h);break}}return{w:D,h:z,fill:u/(D*z)||0}}Ir.prototype={destroy:function(){this.buf=null},readFields:function(f,u,g){for(g=g||this.length;this.pos<g;){var T=this.readVarint(),D=T>>3,z=this.pos;this.type=7&T,f(D,u,this),this.pos===z&&this.skip(T)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=e1(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=y5(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=e1(this.buf,this.pos)+e1(this.buf,this.pos+4)*lx;return this.pos+=8,f},readSFixed64:function(){var f=e1(this.buf,this.pos)+y5(this.buf,this.pos+4)*lx;return this.pos+=8,f},readFloat:function(){var f=f5(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=f5(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,g,T=this.buf;return u=127&(g=T[this.pos++]),g<128?u:(u|=(127&(g=T[this.pos++]))<<7,g<128?u:(u|=(127&(g=T[this.pos++]))<<14,g<128?u:(u|=(127&(g=T[this.pos++]))<<21,g<128?u:function(D,z,N){var $,Z,re=N.buf;if($=(112&(Z=re[N.pos++]))>>4,Z<128||($|=(127&(Z=re[N.pos++]))<<3,Z<128)||($|=(127&(Z=re[N.pos++]))<<10,Z<128)||($|=(127&(Z=re[N.pos++]))<<17,Z<128)||($|=(127&(Z=re[N.pos++]))<<24,Z<128)||($|=(1&(Z=re[N.pos++]))<<31,Z<128))return qf(D,$,z);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(g=T[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&g5?function(g,T,D){return g5.decode(g.subarray(T,D))}(this.buf,u,f):function(g,T,D){for(var z="",N=T;N<D;){var $,Z,re,Ae=g[N],he=null,pe=Ae>239?4:Ae>223?3:Ae>191?2:1;if(N+pe>D)break;pe===1?Ae<128&&(he=Ae):pe===2?(192&($=g[N+1]))==128&&(he=(31&Ae)<<6|63&$)<=127&&(he=null):pe===3?(Z=g[N+2],(192&($=g[N+1]))==128&&(192&Z)==128&&((he=(15&Ae)<<12|(63&$)<<6|63&Z)<=2047||he>=55296&&he<=57343)&&(he=null)):pe===4&&(Z=g[N+2],re=g[N+3],(192&($=g[N+1]))==128&&(192&Z)==128&&(192&re)==128&&((he=(15&Ae)<<18|(63&$)<<12|(63&Z)<<6|63&re)<=65535||he>=1114112)&&(he=null)),he===null?(he=65533,pe=1):he>65535&&(he-=65536,z+=String.fromCharCode(he>>>10&1023|55296),he=56320|1023&he),z+=String.fromCharCode(he),N+=pe}return z}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==Ir.Bytes)return f.push(this.readVarint(u));var g=Cu(this);for(f=f||[];this.pos<g;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==Ir.Bytes)return f.push(this.readSVarint());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==Ir.Bytes)return f.push(this.readBoolean());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==Ir.Bytes)return f.push(this.readFloat());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==Ir.Bytes)return f.push(this.readDouble());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==Ir.Bytes)return f.push(this.readFixed32());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==Ir.Bytes)return f.push(this.readSFixed32());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==Ir.Bytes)return f.push(this.readFixed64());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==Ir.Bytes)return f.push(this.readSFixed64());var u=Cu(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===Ir.Varint)for(;this.buf[this.pos++]>127;);else if(u===Ir.Bytes)this.pos=this.readVarint()+this.pos;else if(u===Ir.Fixed32)this.pos+=4;else{if(u!==Ir.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var g=new Uint8Array(u);g.set(this.buf),this.buf=g,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),Zf(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),Zf(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),Zf(this.buf,-1&f,this.pos),Zf(this.buf,Math.floor(f*p5),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),Zf(this.buf,-1&f,this.pos),Zf(this.buf,Math.floor(f*p5),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,g){var T,D;if(u>=0?(T=u%4294967296|0,D=u/4294967296|0):(D=~(-u/4294967296),4294967295^(T=~(-u%4294967296))?T=T+1|0:(T=0,D=D+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),function(z,N,$){$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,$.buf[$.pos]=127&(z>>>=7)}(T,0,g),function(z,N){var $=(7&z)<<4;N.buf[N.pos++]|=$|((z>>>=3)?128:0),z&&(N.buf[N.pos++]=127&z|((z>>>=7)?128:0),z&&(N.buf[N.pos++]=127&z|((z>>>=7)?128:0),z&&(N.buf[N.pos++]=127&z|((z>>>=7)?128:0),z&&(N.buf[N.pos++]=127&z|((z>>>=7)?128:0),z&&(N.buf[N.pos++]=127&z)))))}(D,g)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(T,D,z){for(var N,$,Z=0;Z<D.length;Z++){if((N=D.charCodeAt(Z))>55295&&N<57344){if(!$){N>56319||Z+1===D.length?(T[z++]=239,T[z++]=191,T[z++]=189):$=N;continue}if(N<56320){T[z++]=239,T[z++]=191,T[z++]=189,$=N;continue}N=$-55296<<10|N-56320|65536,$=null}else $&&(T[z++]=239,T[z++]=191,T[z++]=189,$=null);N<128?T[z++]=N:(N<2048?T[z++]=N>>6|192:(N<65536?T[z++]=N>>12|224:(T[z++]=N>>18|240,T[z++]=N>>12&63|128),T[z++]=N>>6&63|128),T[z++]=63&N|128)}return z}(this.buf,f,this.pos);var g=this.pos-u;g>=128&&m5(u,g,this),this.pos=u-1,this.writeVarint(g),this.pos+=g},writeFloat:function(f){this.realloc(4),d5(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),d5(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var g=0;g<u;g++)this.buf[this.pos++]=f[g]},writeRawMessage:function(f,u){this.pos++;var g=this.pos;f(u,this);var T=this.pos-g;T>=128&&m5(g,T,this),this.pos=g-1,this.writeVarint(T),this.pos+=T},writeMessage:function(f,u,g){this.writeTag(f,Ir.Bytes),this.writeRawMessage(u,g)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,r9,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,i9,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,a9,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,s9,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,o9,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,l9,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,A9,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,u9,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,c9,u)},writeBytesField:function(f,u){this.writeTag(f,Ir.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,Ir.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,Ir.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,Ir.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,Ir.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,Ir.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,Ir.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,Ir.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,Ir.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,Ir.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};class Ax{constructor(u,{pixelRatio:g,version:T,stretchX:D,stretchY:z,content:N}){this.paddedRect=u,this.pixelRatio=g,this.stretchX=D,this.stretchY=z,this.content=N,this.version=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class v5{constructor(u,g){const T={},D={};this.haveRenderCallbacks=[];const z=[];this.addImages(u,T,z),this.addImages(g,D,z);const{w:N,h:$}=_5(z),Z=new Ca({width:N||1,height:$||1});for(const re in u){const Ae=u[re],he=T[re].paddedRect;Ca.copy(Ae.data,Z,{x:0,y:0},{x:he.x+1,y:he.y+1},Ae.data)}for(const re in g){const Ae=g[re],he=D[re].paddedRect,pe=he.x+1,ye=he.y+1,_e=Ae.data.width,Ve=Ae.data.height;Ca.copy(Ae.data,Z,{x:0,y:0},{x:pe,y:ye},Ae.data),Ca.copy(Ae.data,Z,{x:0,y:Ve-1},{x:pe,y:ye-1},{width:_e,height:1}),Ca.copy(Ae.data,Z,{x:0,y:0},{x:pe,y:ye+Ve},{width:_e,height:1}),Ca.copy(Ae.data,Z,{x:_e-1,y:0},{x:pe-1,y:ye},{width:1,height:Ve}),Ca.copy(Ae.data,Z,{x:0,y:0},{x:pe+_e,y:ye},{width:1,height:Ve})}this.image=Z,this.iconPositions=T,this.patternPositions=D}addImages(u,g,T){for(const D in u){const z=u[D],N={x:0,y:0,w:z.data.width+2,h:z.data.height+2};T.push(N),g[D]=new Ax(N,z),z.hasRenderCallback&&this.haveRenderCallbacks.push(D)}}patchUpdatedImages(u,g){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const T in u.updatedImages)this.patchUpdatedImage(this.iconPositions[T],u.getImage(T),g),this.patchUpdatedImage(this.patternPositions[T],u.getImage(T),g)}patchUpdatedImage(u,g,T){if(!u||!g||u.version===g.version)return;u.version=g.version;const[D,z]=u.tl;T.update(g.data,void 0,{x:D,y:z})}}Nt("ImagePosition",Ax),Nt("ImageAtlas",v5),o.WritingMode=void 0,(kc=o.WritingMode||(o.WritingMode={}))[kc.none=0]="none",kc[kc.horizontal=1]="horizontal",kc[kc.vertical=2]="vertical",kc[kc.horizontalOnly=3]="horizontalOnly";const t1=-17;class ip{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,g){const T=new ip;return T.scale=u||1,T.fontStack=g,T}static forImage(u){const g=new ip;return g.imageName=u,g}}class Yf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,g){const T=new Yf;for(let D=0;D<u.sections.length;D++){const z=u.sections[D];z.image?T.addImageSection(z):T.addTextSection(z,g)}return T}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let g="";for(let T=0;T<u.length;T++){const D=u.charCodeAt(T+1)||null,z=u.charCodeAt(T-1)||null;g+=D&&Qs(D)&&!rp[u[T+1]]||z&&Qs(z)&&!rp[u[T-1]]||!rp[u[T]]?u[T]:rp[u[T]]}return g}(this.text)}trim(){let u=0;for(let T=0;T<this.text.length&&r1[this.text.charCodeAt(T)];T++)u++;let g=this.text.length;for(let T=this.text.length-1;T>=0&&T>=u&&r1[this.text.charCodeAt(T)];T--)g--;this.text=this.text.substring(u,g),this.sectionIndex=this.sectionIndex.slice(u,g)}substring(u,g){const T=new Yf;return T.text=this.text.substring(u,g),T.sectionIndex=this.sectionIndex.slice(u,g),T.sections=this.sections,T}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,g)=>Math.max(u,this.sections[g].scale),0)}addTextSection(u,g){this.text+=u.text,this.sections.push(ip.forText(u.scale,u.fontStack||g));const T=this.sections.length-1;for(let D=0;D<u.text.length;++D)this.sectionIndex.push(T)}addImageSection(u){const g=u.image?u.image.name:"";if(g.length===0)return void me("Can't add FormattedSection with an empty image.");const T=this.getNextImageSectionCharCode();T?(this.text+=String.fromCharCode(T),this.sections.push(ip.forImage(g)),this.sectionIndex.push(this.sections.length-1)):me("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function n1(f,u,g,T,D,z,N,$,Z,re,Ae,he,pe,ye,_e,Ve){const ze=Yf.fromFeature(f,D);let it;he===o.WritingMode.vertical&&ze.verticalizePunctuation();const{processBidirectionalText:ut,processStyledBidirectionalText:et}=ps;if(ut&&ze.sections.length===1){it=[];const mt=ut(ze.toString(),ux(ze,re,z,u,T,ye,_e));for(const Zt of mt){const tn=new Yf;tn.text=Zt,tn.sections=ze.sections;for(let Ht=0;Ht<Zt.length;Ht++)tn.sectionIndex.push(0);it.push(tn)}}else if(et){it=[];const mt=et(ze.text,ze.sectionIndex,ux(ze,re,z,u,T,ye,_e));for(const Zt of mt){const tn=new Yf;tn.text=Zt[0],tn.sectionIndex=Zt[1],tn.sections=ze.sections,it.push(tn)}}else it=function(mt,Zt){const tn=[],Ht=mt.text;let Ut=0;for(const Ot of Zt)tn.push(mt.substring(Ut,Ot)),Ut=Ot;return Ut<Ht.length&&tn.push(mt.substring(Ut,Ht.length)),tn}(ze,ux(ze,re,z,u,T,ye,_e));const at=[],yt={positionedLines:at,text:ze.toString(),top:Ae[1],bottom:Ae[1],left:Ae[0],right:Ae[0],writingMode:he,iconsInText:!1,verticalizable:!1};return function(mt,Zt,tn,Ht,Ut,Ot,Wt,$t,St,gn,ln,jn){let Vr=0,Qr=t1,Oi=0,Pa=0;const gs=$t==="right"?1:$t==="left"?0:.5;let Ti=0;for(const Si of Ut){Si.trim();const ys=Si.getMaxScale(),Is=(ys-1)*ts,eo={positionedGlyphs:[],lineOffset:0};mt.positionedLines[Ti]=eo;const Co=eo.positionedGlyphs;let Mo=0;if(!Si.length()){Qr+=Ot,++Ti;continue}for(let Zi=0;Zi<Si.length();Zi++){const Kn=Si.getSection(Zi),ea=Si.getSectionIndex(Zi),_s=Si.getCharCode(Zi);let Ls=0,al=null,ql=null,Zl=null,Pu=ts;const ll=!(St===o.WritingMode.horizontal||!ln&&!rl(_s)||ln&&(r1[_s]||(qi=_s,Vt.Arabic(qi)||Vt["Arabic Supplement"](qi)||Vt["Arabic Extended-A"](qi)||Vt["Arabic Presentation Forms-A"](qi)||Vt["Arabic Presentation Forms-B"](qi))));if(Kn.imageName){const ka=Ht[Kn.imageName];if(!ka)continue;Zl=Kn.imageName,mt.iconsInText=mt.iconsInText||!0,ql=ka.paddedRect;const Po=ka.displaySize;Kn.scale=Kn.scale*ts/jn,al={width:Po[0],height:Po[1],left:1,top:-3,advance:ll?Po[1]:Po[0]},Ls=Is+(ts-Po[1]*Kn.scale),Pu=al.advance;const ku=ll?Po[0]*Kn.scale-ts*ys:Po[1]*Kn.scale-ts*ys;ku>0&&ku>Mo&&(Mo=ku)}else{const ka=tn[Kn.fontStack],Po=ka&&ka[_s];if(Po&&Po.rect)ql=Po.rect,al=Po.metrics;else{const ku=Zt[Kn.fontStack],ap=ku&&ku[_s];if(!ap)continue;al=ap.metrics}Ls=(ys-Kn.scale)*ts}ll?(mt.verticalizable=!0,Co.push({glyph:_s,imageName:Zl,x:Vr,y:Qr+Ls,vertical:ll,scale:Kn.scale,fontStack:Kn.fontStack,sectionIndex:ea,metrics:al,rect:ql}),Vr+=Pu*Kn.scale+gn):(Co.push({glyph:_s,imageName:Zl,x:Vr,y:Qr+Ls,vertical:ll,scale:Kn.scale,fontStack:Kn.fontStack,sectionIndex:ea,metrics:al,rect:ql}),Vr+=al.advance*Kn.scale+gn)}Co.length!==0&&(Oi=Math.max(Vr-gn,Oi),m9(Co,0,Co.length-1,gs,Mo)),Vr=0;const Jr=Ot*ys+Mo;eo.lineOffset=Math.max(Mo,Is),Qr+=Jr,Pa=Math.max(Jr,Pa),++Ti}var qi;const ms=Qr-t1,{horizontalAlign:ks,verticalAlign:So}=cx(Wt);(function(Si,ys,Is,eo,Co,Mo,Jr,Zi,Kn){const ea=(ys-Is)*Co;let _s=0;_s=Mo!==Jr?-Zi*eo-t1:(-eo*Kn+.5)*Jr;for(const Ls of Si)for(const al of Ls.positionedGlyphs)al.x+=ea,al.y+=_s})(mt.positionedLines,gs,ks,So,Oi,Pa,Ot,ms,Ut.length),mt.top+=-So*ms,mt.bottom=mt.top+ms,mt.left+=-ks*Oi,mt.right=mt.left+Oi}(yt,u,g,T,it,N,$,Z,he,re,pe,Ve),!function(mt){for(const Zt of mt)if(Zt.positionedGlyphs.length!==0)return!1;return!0}(at)&&yt}const r1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},p9={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function x5(f,u,g,T,D,z){if(u.imageName){const N=T[u.imageName];return N?N.displaySize[0]*u.scale*ts/z+D:0}{const N=g[u.fontStack],$=N&&N[f];return $?$.metrics.advance*u.scale+D:0}}function w5(f,u,g,T){const D=Math.pow(f-u,2);return T?f<u?D/2:2*D:D+Math.abs(g)*g}function g9(f,u,g){let T=0;return f===10&&(T-=1e4),g&&(T+=150),f!==40&&f!==65288||(T+=50),u!==41&&u!==65289||(T+=50),T}function b5(f,u,g,T,D,z){let N=null,$=w5(u,g,D,z);for(const Z of T){const re=w5(u-Z.x,g,D,z)+Z.badness;re<=$&&(N=Z,$=re)}return{index:f,x:u,priorBreak:N,badness:$}}function E5(f){return f?E5(f.priorBreak).concat(f.index):[]}function ux(f,u,g,T,D,z,N){if(z!=="point")return[];if(!f)return[];const $=[],Z=function(pe,ye,_e,Ve,ze,it){let ut=0;for(let et=0;et<pe.length();et++){const at=pe.getSection(et);ut+=x5(pe.getCharCode(et),at,Ve,ze,ye,it)}return ut/Math.max(1,Math.ceil(ut/_e))}(f,u,g,T,D,N),re=f.text.indexOf("​")>=0;let Ae=0;for(let pe=0;pe<f.length();pe++){const ye=f.getSection(pe),_e=f.getCharCode(pe);if(r1[_e]||(Ae+=x5(_e,ye,T,D,u,N)),pe<f.length()-1){const Ve=!((he=_e)<11904||!(Vt["Bopomofo Extended"](he)||Vt.Bopomofo(he)||Vt["CJK Compatibility Forms"](he)||Vt["CJK Compatibility Ideographs"](he)||Vt["CJK Compatibility"](he)||Vt["CJK Radicals Supplement"](he)||Vt["CJK Strokes"](he)||Vt["CJK Symbols and Punctuation"](he)||Vt["CJK Unified Ideographs Extension A"](he)||Vt["CJK Unified Ideographs"](he)||Vt["Enclosed CJK Letters and Months"](he)||Vt["Halfwidth and Fullwidth Forms"](he)||Vt.Hiragana(he)||Vt["Ideographic Description Characters"](he)||Vt["Kangxi Radicals"](he)||Vt["Katakana Phonetic Extensions"](he)||Vt.Katakana(he)||Vt["Vertical Forms"](he)||Vt["Yi Radicals"](he)||Vt["Yi Syllables"](he)));(p9[_e]||Ve||ye.imageName)&&$.push(b5(pe+1,Ae,Z,$,g9(_e,f.getCharCode(pe+1),Ve&&re),!1))}}var he;return E5(b5(f.length(),Ae,Z,$,0,!0))}function cx(f){let u=.5,g=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":g=1;break;case"top":case"top-right":case"top-left":g=0}return{horizontalAlign:u,verticalAlign:g}}function m9(f,u,g,T,D){if(!T&&!D)return;const z=f[g],N=(f[g].x+z.metrics.advance*z.scale)*T;for(let $=u;$<=g;$++)f[$].x-=N,f[$].y+=D}function y9(f,u,g){const{horizontalAlign:T,verticalAlign:D}=cx(g),z=u[0]-f.displaySize[0]*T,N=u[1]-f.displaySize[1]*D;return{image:f,top:N,bottom:N+f.displaySize[1],left:z,right:z+f.displaySize[0]}}function T5(f,u,g,T,D,z){const N=f.image;let $;if(N.content){const ze=N.content,it=N.pixelRatio||1;$=[ze[0]/it,ze[1]/it,N.displaySize[0]-ze[2]/it,N.displaySize[1]-ze[3]/it]}const Z=u.left*z,re=u.right*z;let Ae,he,pe,ye;g==="width"||g==="both"?(ye=D[0]+Z-T[3],he=D[0]+re+T[1]):(ye=D[0]+(Z+re-N.displaySize[0])/2,he=ye+N.displaySize[0]);const _e=u.top*z,Ve=u.bottom*z;return g==="height"||g==="both"?(Ae=D[1]+_e-T[0],pe=D[1]+Ve+T[2]):(Ae=D[1]+(_e+Ve-N.displaySize[1])/2,pe=Ae+N.displaySize[1]),{image:N,top:Ae,right:he,bottom:pe,left:ye,collisionPadding:$}}const Mu=128;function S5(f,u){const{expression:g}=u;if(g.kind==="constant")return{kind:"constant",layoutSize:g.evaluate(new Mr(f+1))};if(g.kind==="source")return{kind:"source"};{const{zoomStops:T,interpolationType:D}=g;let z=0;for(;z<T.length&&T[z]<=f;)z++;z=Math.max(0,z-1);let N=z;for(;N<T.length&&T[N]<f+1;)N++;N=Math.min(T.length-1,N);const $=T[z],Z=T[N];return g.kind==="composite"?{kind:"composite",minZoom:$,maxZoom:Z,interpolationType:D}:{kind:"camera",minZoom:$,maxZoom:Z,minSize:g.evaluate(new Mr($)),maxSize:g.evaluate(new Mr(Z)),interpolationType:D}}}class Ic extends Et{constructor(u,g,T,D){super(u,g),this.angle=T,D!==void 0&&(this.segment=D)}clone(){return new Ic(this.x,this.y,this.angle,this.segment)}}function C5(f,u,g,T,D){if(u.segment===void 0)return!0;let z=u,N=u.segment+1,$=0;for(;$>-g/2;){if(N--,N<0)return!1;$-=f[N].dist(z),z=f[N]}$+=f[N].dist(f[N+1]),N++;const Z=[];let re=0;for(;$<g/2;){const Ae=f[N],he=f[N+1];if(!he)return!1;let pe=f[N-1].angleTo(Ae)-Ae.angleTo(he);for(pe=Math.abs((pe+3*Math.PI)%(2*Math.PI)-Math.PI),Z.push({distance:$,angleDelta:pe}),re+=pe;$-Z[0].distance>T;)re-=Z.shift().angleDelta;if(re>D)return!1;N++,$+=Ae.dist(he)}return!0}function M5(f){let u=0;for(let g=0;g<f.length-1;g++)u+=f[g].dist(f[g+1]);return u}function P5(f,u,g){return f?.6*u*g:0}function k5(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function _9(f,u,g,T,D,z){const N=P5(g,D,z),$=k5(g,T)*z;let Z=0;const re=M5(f)/2;for(let Ae=0;Ae<f.length-1;Ae++){const he=f[Ae],pe=f[Ae+1],ye=he.dist(pe);if(Z+ye>re){const _e=(re-Z)/ye,Ve=en(he.x,pe.x,_e),ze=en(he.y,pe.y,_e),it=new Ic(Ve,ze,pe.angleTo(he),Ae);return it._round(),!N||C5(f,it,$,N,u)?it:void 0}Z+=ye}}function v9(f,u,g,T,D,z,N,$,Z){const re=P5(T,z,N),Ae=k5(T,D),he=Ae*N,pe=f[0].x===0||f[0].x===Z||f[0].y===0||f[0].y===Z;return u-he<u/4&&(u=he+u/4),I5(f,pe?u/2*$%u:(Ae/2+2*z)*N*$%u,u,re,g,he,pe,!1,Z)}function I5(f,u,g,T,D,z,N,$,Z){const re=z/2,Ae=M5(f);let he=0,pe=u-g,ye=[];for(let _e=0;_e<f.length-1;_e++){const Ve=f[_e],ze=f[_e+1],it=Ve.dist(ze),ut=ze.angleTo(Ve);for(;pe+g<he+it;){pe+=g;const et=(pe-he)/it,at=en(Ve.x,ze.x,et),yt=en(Ve.y,ze.y,et);if(at>=0&&at<Z&&yt>=0&&yt<Z&&pe-re>=0&&pe+re<=Ae){const mt=new Ic(at,yt,ut,_e);mt._round(),T&&!C5(f,mt,z,T,D)||ye.push(mt)}}he+=it}return $||ye.length||N||(ye=I5(f,he/2,g,T,D,z,N,!0,Z)),ye}function L5(f,u,g,T,D){const z=[];for(let N=0;N<f.length;N++){const $=f[N];let Z;for(let re=0;re<$.length-1;re++){let Ae=$[re],he=$[re+1];Ae.x<u&&he.x<u||(Ae.x<u?Ae=new Et(u,Ae.y+(u-Ae.x)/(he.x-Ae.x)*(he.y-Ae.y))._round():he.x<u&&(he=new Et(u,Ae.y+(u-Ae.x)/(he.x-Ae.x)*(he.y-Ae.y))._round()),Ae.y<g&&he.y<g||(Ae.y<g?Ae=new Et(Ae.x+(g-Ae.y)/(he.y-Ae.y)*(he.x-Ae.x),g)._round():he.y<g&&(he=new Et(Ae.x+(g-Ae.y)/(he.y-Ae.y)*(he.x-Ae.x),g)._round()),Ae.x>=T&&he.x>=T||(Ae.x>=T?Ae=new Et(T,Ae.y+(T-Ae.x)/(he.x-Ae.x)*(he.y-Ae.y))._round():he.x>=T&&(he=new Et(T,Ae.y+(T-Ae.x)/(he.x-Ae.x)*(he.y-Ae.y))._round()),Ae.y>=D&&he.y>=D||(Ae.y>=D?Ae=new Et(Ae.x+(D-Ae.y)/(he.y-Ae.y)*(he.x-Ae.x),D)._round():he.y>=D&&(he=new Et(Ae.x+(D-Ae.y)/(he.y-Ae.y)*(he.x-Ae.x),D)._round()),Z&&Ae.equals(Z[Z.length-1])||(Z=[Ae],z.push(Z)),Z.push(he)))))}}return z}function D5(f,u,g,T){const D=[],z=f.image,N=z.pixelRatio,$=z.paddedRect.w-2,Z=z.paddedRect.h-2,re=f.right-f.left,Ae=f.bottom-f.top,he=z.stretchX||[[0,$]],pe=z.stretchY||[[0,Z]],ye=(Ot,Wt)=>Ot+Wt[1]-Wt[0],_e=he.reduce(ye,0),Ve=pe.reduce(ye,0),ze=$-_e,it=Z-Ve;let ut=0,et=_e,at=0,yt=Ve,mt=0,Zt=ze,tn=0,Ht=it;if(z.content&&T){const Ot=z.content;ut=i1(he,0,Ot[0]),at=i1(pe,0,Ot[1]),et=i1(he,Ot[0],Ot[2]),yt=i1(pe,Ot[1],Ot[3]),mt=Ot[0]-ut,tn=Ot[1]-at,Zt=Ot[2]-Ot[0]-et,Ht=Ot[3]-Ot[1]-yt}const Ut=(Ot,Wt,$t,St)=>{const gn=s1(Ot.stretch-ut,et,re,f.left),ln=o1(Ot.fixed-mt,Zt,Ot.stretch,_e),jn=s1(Wt.stretch-at,yt,Ae,f.top),Vr=o1(Wt.fixed-tn,Ht,Wt.stretch,Ve),Qr=s1($t.stretch-ut,et,re,f.left),Oi=o1($t.fixed-mt,Zt,$t.stretch,_e),Pa=s1(St.stretch-at,yt,Ae,f.top),gs=o1(St.fixed-tn,Ht,St.stretch,Ve),Ti=new Et(gn,jn),qi=new Et(Qr,jn),ms=new Et(Qr,Pa),ks=new Et(gn,Pa),So=new Et(ln/N,Vr/N),Si=new Et(Oi/N,gs/N),ys=u*Math.PI/180;if(ys){const Co=Math.sin(ys),Mo=Math.cos(ys),Jr=[Mo,-Co,Co,Mo];Ti._matMult(Jr),qi._matMult(Jr),ks._matMult(Jr),ms._matMult(Jr)}const Is=Ot.stretch+Ot.fixed,eo=Wt.stretch+Wt.fixed;return{tl:Ti,tr:qi,bl:ks,br:ms,tex:{x:z.paddedRect.x+1+Is,y:z.paddedRect.y+1+eo,w:$t.stretch+$t.fixed-Is,h:St.stretch+St.fixed-eo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:So,pixelOffsetBR:Si,minFontScaleX:Zt/N/re,minFontScaleY:Ht/N/Ae,isSDF:g}};if(T&&(z.stretchX||z.stretchY)){const Ot=R5(he,ze,_e),Wt=R5(pe,it,Ve);for(let $t=0;$t<Ot.length-1;$t++){const St=Ot[$t],gn=Ot[$t+1];for(let ln=0;ln<Wt.length-1;ln++)D.push(Ut(St,Wt[ln],gn,Wt[ln+1]))}}else D.push(Ut({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:$+1},{fixed:0,stretch:Z+1}));return D}function i1(f,u,g){let T=0;for(const D of f)T+=Math.max(u,Math.min(g,D[1]))-Math.max(u,Math.min(g,D[0]));return T}function R5(f,u,g){const T=[{fixed:-1,stretch:0}];for(const[D,z]of f){const N=T[T.length-1];T.push({fixed:D-N.stretch,stretch:N.stretch}),T.push({fixed:D-N.stretch,stretch:N.stretch+(z-D)})}return T.push({fixed:u+1,stretch:g}),T}function s1(f,u,g,T){return f/u*g+T}function o1(f,u,g,T){return f-u*g/T}Nt("Anchor",Ic);class a1{constructor(u,g,T,D,z,N,$,Z,re,Ae){if(this.boxStartIndex=u.length,re){let he=N.top,pe=N.bottom;const ye=N.collisionPadding;ye&&(he-=ye[1],pe+=ye[3]);let _e=pe-he;_e>0&&(_e=Math.max(10,_e),this.circleDiameter=_e)}else{let he=N.top*$-Z[0],pe=N.bottom*$+Z[2],ye=N.left*$-Z[3],_e=N.right*$+Z[1];const Ve=N.collisionPadding;if(Ve&&(ye-=Ve[0]*$,he-=Ve[1]*$,_e+=Ve[2]*$,pe+=Ve[3]*$),Ae){const ze=new Et(ye,he),it=new Et(_e,he),ut=new Et(ye,pe),et=new Et(_e,pe),at=Ae*Math.PI/180;ze._rotate(at),it._rotate(at),ut._rotate(at),et._rotate(at),ye=Math.min(ze.x,it.x,ut.x,et.x),_e=Math.max(ze.x,it.x,ut.x,et.x),he=Math.min(ze.y,it.y,ut.y,et.y),pe=Math.max(ze.y,it.y,ut.y,et.y)}u.emplaceBack(g.x,g.y,ye,he,_e,pe,T,D,z)}this.boxEndIndex=u.length}}class x9{constructor(u=[],g=w9){if(this.data=u,this.length=this.data.length,this.compare=g,this.length>0)for(let T=(this.length>>1)-1;T>=0;T--)this._down(T)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],g=this.data.pop();return this.length--,this.length>0&&(this.data[0]=g,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:g,compare:T}=this,D=g[u];for(;u>0;){const z=u-1>>1,N=g[z];if(T(D,N)>=0)break;g[u]=N,u=z}g[u]=D}_down(u){const{data:g,compare:T}=this,D=this.length>>1,z=g[u];for(;u<D;){let N=1+(u<<1),$=g[N];const Z=N+1;if(Z<this.length&&T(g[Z],$)<0&&(N=Z,$=g[Z]),T($,z)>=0)break;g[u]=$,u=N}g[u]=z}}function w9(f,u){return f<u?-1:f>u?1:0}function b9(f,u=1,g=!1){let T=1/0,D=1/0,z=-1/0,N=-1/0;const $=f[0];for(let ye=0;ye<$.length;ye++){const _e=$[ye];(!ye||_e.x<T)&&(T=_e.x),(!ye||_e.y<D)&&(D=_e.y),(!ye||_e.x>z)&&(z=_e.x),(!ye||_e.y>N)&&(N=_e.y)}const Z=Math.min(z-T,N-D);let re=Z/2;const Ae=new x9([],E9);if(Z===0)return new Et(T,D);for(let ye=T;ye<z;ye+=Z)for(let _e=D;_e<N;_e+=Z)Ae.push(new Xf(ye+re,_e+re,re,f));let he=function(ye){let _e=0,Ve=0,ze=0;const it=ye[0];for(let ut=0,et=it.length,at=et-1;ut<et;at=ut++){const yt=it[ut],mt=it[at],Zt=yt.x*mt.y-mt.x*yt.y;Ve+=(yt.x+mt.x)*Zt,ze+=(yt.y+mt.y)*Zt,_e+=3*Zt}return new Xf(Ve/_e,ze/_e,0,ye)}(f),pe=Ae.length;for(;Ae.length;){const ye=Ae.pop();(ye.d>he.d||!he.d)&&(he=ye,g&&console.log("found best %d after %d probes",Math.round(1e4*ye.d)/1e4,pe)),ye.max-he.d<=u||(re=ye.h/2,Ae.push(new Xf(ye.p.x-re,ye.p.y-re,re,f)),Ae.push(new Xf(ye.p.x+re,ye.p.y-re,re,f)),Ae.push(new Xf(ye.p.x-re,ye.p.y+re,re,f)),Ae.push(new Xf(ye.p.x+re,ye.p.y+re,re,f)),pe+=4)}return g&&(console.log(`num probes: ${pe}`),console.log(`best distance: ${he.d}`)),he.p}function E9(f,u){return u.max-f.max}function Xf(f,u,g,T){this.p=new Et(f,u),this.h=g,this.d=function(D,z){let N=!1,$=1/0;for(let Z=0;Z<z.length;Z++){const re=z[Z];for(let Ae=0,he=re.length,pe=he-1;Ae<he;pe=Ae++){const ye=re[Ae],_e=re[pe];ye.y>D.y!=_e.y>D.y&&D.x<(_e.x-ye.x)*(D.y-ye.y)/(_e.y-ye.y)+ye.x&&(N=!N),$=Math.min($,G4(D,ye,_e))}}return(N?1:-1)*Math.sqrt($)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}const hx=Number.POSITIVE_INFINITY;function B5(f,u){return u[1]!==hx?function(g,T,D){let z=0,N=0;switch(T=Math.abs(T),D=Math.abs(D),g){case"top-right":case"top-left":case"top":N=D-7;break;case"bottom-right":case"bottom-left":case"bottom":N=7-D}switch(g){case"top-right":case"bottom-right":case"right":z=-T;break;case"top-left":case"bottom-left":case"left":z=T}return[z,N]}(f,u[0],u[1]):function(g,T){let D=0,z=0;T<0&&(T=0);const N=T/Math.sqrt(2);switch(g){case"top-right":case"top-left":z=N-7;break;case"bottom-right":case"bottom-left":z=7-N;break;case"bottom":z=7-T;break;case"top":z=T-7}switch(g){case"top-right":case"bottom-right":D=-N;break;case"top-left":case"bottom-left":D=N;break;case"left":D=T;break;case"right":D=-T}return[D,z]}(f,u[0])}function fx(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function T9(f,u,g,T,D,z,N,$,Z,re,Ae){let he=z.textMaxSize.evaluate(u,{});he===void 0&&(he=N);const pe=f.layers[0].layout,ye=pe.get("icon-offset").evaluate(u,{},Ae),_e=O5(g.horizontal),Ve=N/24,ze=f.tilePixelRatio*Ve,it=f.tilePixelRatio*he/24,ut=f.tilePixelRatio*$,et=f.tilePixelRatio*pe.get("symbol-spacing"),at=pe.get("text-padding")*f.tilePixelRatio,yt=function(St,gn,ln,jn=1){const Vr=St.get("icon-padding").evaluate(gn,{},ln),Qr=Vr&&Vr.values;return[Qr[0]*jn,Qr[1]*jn,Qr[2]*jn,Qr[3]*jn]}(pe,u,Ae,f.tilePixelRatio),mt=pe.get("text-max-angle")/180*Math.PI,Zt=pe.get("text-rotation-alignment")!=="viewport"&&pe.get("symbol-placement")!=="point",tn=pe.get("icon-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point",Ht=pe.get("symbol-placement"),Ut=et/2,Ot=pe.get("icon-text-fit");let Wt;T&&Ot!=="none"&&(f.allowVerticalPlacement&&g.vertical&&(Wt=T5(T,g.vertical,Ot,pe.get("icon-text-fit-padding"),ye,Ve)),_e&&(T=T5(T,_e,Ot,pe.get("icon-text-fit-padding"),ye,Ve)));const $t=(St,gn)=>{gn.x<0||gn.x>=zi||gn.y<0||gn.y>=zi||function(ln,jn,Vr,Qr,Oi,Pa,gs,Ti,qi,ms,ks,So,Si,ys,Is,eo,Co,Mo,Jr,Zi,Kn,ea,_s,Ls,al){const ql=ln.addToLineVertexArray(jn,Vr);let Zl,Pu,ll,ka,Po=0,ku=0,ap=0,J5=0,bx=-1,Ex=-1;const Iu={};let eC=wn.exports(""),Tx=0,Sx=0;if(Ti._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Tx,Sx]=Ti.layout.get("text-offset").evaluate(Kn,{},Ls).map(ko=>ko*ts):(Tx=Ti.layout.get("text-radial-offset").evaluate(Kn,{},Ls)*ts,Sx=hx),ln.allowVerticalPlacement&&Qr.vertical){const ko=Ti.layout.get("text-rotate").evaluate(Kn,{},Ls)+90;ll=new a1(qi,jn,ms,ks,So,Qr.vertical,Si,ys,Is,ko),gs&&(ka=new a1(qi,jn,ms,ks,So,gs,Co,Mo,Is,ko))}if(Oi){const ko=Ti.layout.get("icon-rotate").evaluate(Kn,{}),LA=Ti.layout.get("icon-text-fit")!=="none",lp=D5(Oi,ko,_s,LA),Ap=gs?D5(gs,ko,_s,LA):void 0;Pu=new a1(qi,jn,ms,ks,So,Oi,Co,Mo,!1,ko),Po=4*lp.length;const rC=ln.iconSizeData;let Dh=null;rC.kind==="source"?(Dh=[Mu*Ti.layout.get("icon-size").evaluate(Kn,{})],Dh[0]>Lc&&me(`${ln.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):rC.kind==="composite"&&(Dh=[Mu*ea.compositeIconSizes[0].evaluate(Kn,{},Ls),Mu*ea.compositeIconSizes[1].evaluate(Kn,{},Ls)],(Dh[0]>Lc||Dh[1]>Lc)&&me(`${ln.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ln.addSymbols(ln.icon,lp,Dh,Zi,Jr,Kn,o.WritingMode.none,jn,ql.lineStartIndex,ql.lineLength,-1,Ls),bx=ln.icon.placedSymbolArray.length-1,Ap&&(ku=4*Ap.length,ln.addSymbols(ln.icon,Ap,Dh,Zi,Jr,Kn,o.WritingMode.vertical,jn,ql.lineStartIndex,ql.lineLength,-1,Ls),Ex=ln.icon.placedSymbolArray.length-1)}const tC=Object.keys(Qr.horizontal);for(const ko of tC){const LA=Qr.horizontal[ko];if(!Zl){eC=wn.exports(LA.text);const Ap=Ti.layout.get("text-rotate").evaluate(Kn,{},Ls);Zl=new a1(qi,jn,ms,ks,So,LA,Si,ys,Is,Ap)}const lp=LA.positionedLines.length===1;if(ap+=z5(ln,jn,LA,Pa,Ti,Is,Kn,eo,ql,Qr.vertical?o.WritingMode.horizontal:o.WritingMode.horizontalOnly,lp?tC:[ko],Iu,bx,ea,Ls),lp)break}Qr.vertical&&(J5+=z5(ln,jn,Qr.vertical,Pa,Ti,Is,Kn,eo,ql,o.WritingMode.vertical,["vertical"],Iu,Ex,ea,Ls));const F9=Zl?Zl.boxStartIndex:ln.collisionBoxArray.length,N9=Zl?Zl.boxEndIndex:ln.collisionBoxArray.length,U9=ll?ll.boxStartIndex:ln.collisionBoxArray.length,V9=ll?ll.boxEndIndex:ln.collisionBoxArray.length,G9=Pu?Pu.boxStartIndex:ln.collisionBoxArray.length,$9=Pu?Pu.boxEndIndex:ln.collisionBoxArray.length,j9=ka?ka.boxStartIndex:ln.collisionBoxArray.length,H9=ka?ka.boxEndIndex:ln.collisionBoxArray.length;let Yl=-1;const h1=(ko,LA)=>ko&&ko.circleDiameter?Math.max(ko.circleDiameter,LA):LA;Yl=h1(Zl,Yl),Yl=h1(ll,Yl),Yl=h1(Pu,Yl),Yl=h1(ka,Yl);const nC=Yl>-1?1:0;nC&&(Yl*=al/ts),ln.glyphOffsetArray.length>=Kf.MAX_GLYPHS&&me("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Kn.sortKey!==void 0&&ln.addToSortKeyRanges(ln.symbolInstances.length,Kn.sortKey),ln.symbolInstances.emplaceBack(jn.x,jn.y,Iu.right>=0?Iu.right:-1,Iu.center>=0?Iu.center:-1,Iu.left>=0?Iu.left:-1,Iu.vertical||-1,bx,Ex,eC,F9,N9,U9,V9,G9,$9,j9,H9,ms,ap,J5,Po,ku,nC,0,Si,Tx,Sx,Yl)}(f,gn,St,g,T,D,Wt,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,ze,[at,at,at,at],Zt,Z,ut,yt,tn,ye,u,z,re,Ae,N)};if(Ht==="line")for(const St of L5(u.geometry,0,0,zi,zi)){const gn=v9(St,et,mt,g.vertical||_e,T,24,it,f.overscaling,zi);for(const ln of gn){const jn=_e;jn&&S9(f,jn.text,Ut,ln)||$t(St,ln)}}else if(Ht==="line-center"){for(const St of u.geometry)if(St.length>1){const gn=_9(St,mt,g.vertical||_e,T,24,it);gn&&$t(St,gn)}}else if(u.type==="Polygon")for(const St of ex(u.geometry,0)){const gn=b9(St,16);$t(St[0],new Ic(gn.x,gn.y,0))}else if(u.type==="LineString")for(const St of u.geometry)$t(St,new Ic(St[0].x,St[0].y,0));else if(u.type==="Point")for(const St of u.geometry)for(const gn of St)$t([gn],new Ic(gn.x,gn.y,0))}const Lc=32640;function z5(f,u,g,T,D,z,N,$,Z,re,Ae,he,pe,ye,_e){const Ve=function(ut,et,at,yt,mt,Zt,tn,Ht){const Ut=yt.layout.get("text-rotate").evaluate(Zt,{})*Math.PI/180,Ot=[];for(const Wt of et.positionedLines)for(const $t of Wt.positionedGlyphs){if(!$t.rect)continue;const St=$t.rect||{};let gn=4,ln=!0,jn=1,Vr=0;const Qr=(mt||Ht)&&$t.vertical,Oi=$t.metrics.advance*$t.scale/2;if(Ht&&et.verticalizable){const Jr=($t.scale-1)*ts,Zi=(ts-$t.metrics.width*$t.scale)/2;Vr=Wt.lineOffset/2-($t.imageName?-Zi:Jr)}if($t.imageName){const Jr=tn[$t.imageName];ln=Jr.sdf,jn=Jr.pixelRatio,gn=1/jn}const Pa=mt?[$t.x+Oi,$t.y]:[0,0];let gs=mt?[0,0]:[$t.x+Oi+at[0],$t.y+at[1]-Vr],Ti=[0,0];Qr&&(Ti=gs,gs=[0,0]);const qi=($t.metrics.left-gn)*$t.scale-Oi+gs[0],ms=(-$t.metrics.top-gn)*$t.scale+gs[1],ks=qi+St.w*$t.scale/jn,So=ms+St.h*$t.scale/jn,Si=new Et(qi,ms),ys=new Et(ks,ms),Is=new Et(qi,So),eo=new Et(ks,So);if(Qr){const Jr=new Et(-Oi,Oi-t1),Zi=-Math.PI/2,Kn=12-Oi,ea=new Et(22-Kn,-($t.imageName?Kn:0)),_s=new Et(...Ti);Si._rotateAround(Zi,Jr)._add(ea)._add(_s),ys._rotateAround(Zi,Jr)._add(ea)._add(_s),Is._rotateAround(Zi,Jr)._add(ea)._add(_s),eo._rotateAround(Zi,Jr)._add(ea)._add(_s)}if(Ut){const Jr=Math.sin(Ut),Zi=Math.cos(Ut),Kn=[Zi,-Jr,Jr,Zi];Si._matMult(Kn),ys._matMult(Kn),Is._matMult(Kn),eo._matMult(Kn)}const Co=new Et(0,0),Mo=new Et(0,0);Ot.push({tl:Si,tr:ys,bl:Is,br:eo,tex:St,writingMode:et.writingMode,glyphOffset:Pa,sectionIndex:$t.sectionIndex,isSDF:ln,pixelOffsetTL:Co,pixelOffsetBR:Mo,minFontScaleX:0,minFontScaleY:0})}return Ot}(0,g,$,D,z,N,T,f.allowVerticalPlacement),ze=f.textSizeData;let it=null;ze.kind==="source"?(it=[Mu*D.layout.get("text-size").evaluate(N,{})],it[0]>Lc&&me(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ze.kind==="composite"&&(it=[Mu*ye.compositeTextSizes[0].evaluate(N,{},_e),Mu*ye.compositeTextSizes[1].evaluate(N,{},_e)],(it[0]>Lc||it[1]>Lc)&&me(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),f.addSymbols(f.text,Ve,it,$,z,N,re,u,Z.lineStartIndex,Z.lineLength,pe,_e);for(const ut of Ae)he[ut]=f.text.placedSymbolArray.length-1;return 4*Ve.length}function O5(f){for(const u in f)return f[u];return null}function S9(f,u,g,T){const D=f.compareText;if(u in D){const z=D[u];for(let N=z.length-1;N>=0;N--)if(T.dist(z[N])<g)return!0}else D[u]=[];return D[u].push(T),!1}const C9=Pc.VectorTileFeature.types,M9=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function l1(f,u,g,T,D,z,N,$,Z,re,Ae,he,pe){const ye=$?Math.min(Lc,Math.round($[0])):0,_e=$?Math.min(Lc,Math.round($[1])):0;f.emplaceBack(u,g,Math.round(32*T),Math.round(32*D),z,N,(ye<<1)+(Z?1:0),_e,16*re,16*Ae,256*he,256*pe)}function dx(f,u,g){f.emplaceBack(u.x,u.y,g),f.emplaceBack(u.x,u.y,g),f.emplaceBack(u.x,u.y,g),f.emplaceBack(u.x,u.y,g)}function P9(f){for(const u of f.sections)if(Ec(u.text))return!0;return!1}class px{constructor(u){this.layoutVertexArray=new Be,this.indexArray=new ot,this.programConfigurations=u,this.segments=new gt,this.dynamicLayoutVertexArray=new Ke,this.opacityVertexArray=new ft,this.placedSymbolArray=new y}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,g,T,D){this.isEmpty()||(T&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,KN.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,g),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,JN.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,M9,!0),this.opacityVertexBuffer.itemSize=1),(T||D)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Nt("SymbolBuffers",px);class gx{constructor(u,g,T){this.layoutVertexArray=new u,this.layoutAttributes=g,this.indexArray=new T,this.segments=new gt,this.collisionVertexArray=new st}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,e9.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Nt("CollisionBuffers",gx);class Kf{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(N=>N.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=qv([]),this.placementViewportMatrix=qv([]);const g=this.layers[0]._unevaluatedLayout._values;this.textSizeData=S5(this.zoom,g["text-size"]),this.iconSizeData=S5(this.zoom,g["icon-size"]);const T=this.layers[0].layout,D=T.get("symbol-sort-key"),z=T.get("symbol-z-order");this.canOverlap=yx(T,"text-overlap","text-allow-overlap")!=="never"||yx(T,"icon-overlap","icon-allow-overlap")!=="never"||T.get("text-ignore-placement")||T.get("icon-ignore-placement"),this.sortFeaturesByKey=z!=="viewport-y"&&!D.isConstant(),this.sortFeaturesByY=(z==="viewport-y"||z==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,T.get("symbol-placement")==="point"&&(this.writingModes=T.get("text-writing-mode").map(N=>o.WritingMode[N])),this.stateDependentLayerIds=this.layers.filter(N=>N.isStateDependent()).map(N=>N.id),this.sourceID=u.sourceID}createArrays(){this.text=new px(new Mh(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new px(new Mh(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new E,this.lineVertexArray=new I,this.symbolInstances=new x}calculateGlyphDependencies(u,g,T,D,z){for(let N=0;N<u.length;N++)if(g[u.charCodeAt(N)]=!0,(T||D)&&z){const $=rp[u.charAt(N)];$&&(g[$.charCodeAt(0)]=!0)}}populate(u,g,T){const D=this.layers[0],z=D.layout,N=z.get("text-font"),$=z.get("text-field"),Z=z.get("icon-image"),re=($.value.kind!=="constant"||$.value.value instanceof ke&&!$.value.value.isEmpty()||$.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),Ae=Z.value.kind!=="constant"||!!Z.value.value||Object.keys(Z.parameters).length>0,he=z.get("symbol-sort-key");if(this.features=[],!re&&!Ae)return;const pe=g.iconDependencies,ye=g.glyphDependencies,_e=g.availableImages,Ve=new Mr(this.zoom);for(const{feature:ze,id:it,index:ut,sourceLayerIndex:et}of u){const at=D._featureFilter.needGeometry,yt=kh(ze,at);if(!D._featureFilter.filter(Ve,yt,T))continue;let mt,Zt;if(at||(yt.geometry=Ph(ze)),re){const Ht=D.getValueAndResolveTokens("text-field",yt,T,_e),Ut=ke.factory(Ht);P9(Ut)&&(this.hasRTLText=!0),(!this.hasRTLText||jl()==="unavailable"||this.hasRTLText&&ps.isParsed())&&(mt=n9(Ut,D,yt))}if(Ae){const Ht=D.getValueAndResolveTokens("icon-image",yt,T,_e);Zt=Ht instanceof Ie?Ht:Ie.fromString(Ht)}if(!mt&&!Zt)continue;const tn=this.sortFeaturesByKey?he.evaluate(yt,{},T):void 0;if(this.features.push({id:it,text:mt,icon:Zt,index:ut,sourceLayerIndex:et,geometry:yt.geometry,properties:ze.properties,type:C9[ze.type],sortKey:tn}),Zt&&(pe[Zt.name]=!0),mt){const Ht=N.evaluate(yt,{},T).join(","),Ut=z.get("text-rotation-alignment")!=="viewport"&&z.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(o.WritingMode.vertical)>=0;for(const Ot of mt.sections)if(Ot.image)pe[Ot.image.name]=!0;else{const Wt=kA(mt.toString()),$t=Ot.fontStack||Ht,St=ye[$t]=ye[$t]||{};this.calculateGlyphDependencies(Ot.text,St,Ut,this.allowVerticalPlacement,Wt)}}}z.get("symbol-placement")==="line"&&(this.features=function(ze){const it={},ut={},et=[];let at=0;function yt(Ht){et.push(ze[Ht]),at++}function mt(Ht,Ut,Ot){const Wt=ut[Ht];return delete ut[Ht],ut[Ut]=Wt,et[Wt].geometry[0].pop(),et[Wt].geometry[0]=et[Wt].geometry[0].concat(Ot[0]),Wt}function Zt(Ht,Ut,Ot){const Wt=it[Ut];return delete it[Ut],it[Ht]=Wt,et[Wt].geometry[0].shift(),et[Wt].geometry[0]=Ot[0].concat(et[Wt].geometry[0]),Wt}function tn(Ht,Ut,Ot){const Wt=Ot?Ut[0][Ut[0].length-1]:Ut[0][0];return`${Ht}:${Wt.x}:${Wt.y}`}for(let Ht=0;Ht<ze.length;Ht++){const Ut=ze[Ht],Ot=Ut.geometry,Wt=Ut.text?Ut.text.toString():null;if(!Wt){yt(Ht);continue}const $t=tn(Wt,Ot),St=tn(Wt,Ot,!0);if($t in ut&&St in it&&ut[$t]!==it[St]){const gn=Zt($t,St,Ot),ln=mt($t,St,et[gn].geometry);delete it[$t],delete ut[St],ut[tn(Wt,et[ln].geometry,!0)]=ln,et[gn].geometry=null}else $t in ut?mt($t,St,Ot):St in it?Zt($t,St,Ot):(yt(Ht),it[$t]=at-1,ut[St]=at-1)}return et.filter(Ht=>Ht.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ze,it)=>ze.sortKey-it.sortKey)}update(u,g,T){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,g,this.layers,T),this.icon.programConfigurations.updatePaintArrays(u,g,this.layers,T))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,g){const T=this.lineVertexArray.length;if(u.segment!==void 0){let D=u.dist(g[u.segment+1]),z=u.dist(g[u.segment]);const N={};for(let $=u.segment+1;$<g.length;$++)N[$]={x:g[$].x,y:g[$].y,tileUnitDistanceFromAnchor:D},$<g.length-1&&(D+=g[$+1].dist(g[$]));for(let $=u.segment||0;$>=0;$--)N[$]={x:g[$].x,y:g[$].y,tileUnitDistanceFromAnchor:z},$>0&&(z+=g[$-1].dist(g[$]));for(let $=0;$<g.length;$++){const Z=N[$];this.lineVertexArray.emplaceBack(Z.x,Z.y,Z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:T,lineLength:this.lineVertexArray.length-T}}addSymbols(u,g,T,D,z,N,$,Z,re,Ae,he,pe){const ye=u.indexArray,_e=u.layoutVertexArray,Ve=u.segments.prepareSegment(4*g.length,_e,ye,this.canOverlap?N.sortKey:void 0),ze=this.glyphOffsetArray.length,it=Ve.vertexLength,ut=this.allowVerticalPlacement&&$===o.WritingMode.vertical?Math.PI/2:0,et=N.text&&N.text.sections;for(let at=0;at<g.length;at++){const{tl:yt,tr:mt,bl:Zt,br:tn,tex:Ht,pixelOffsetTL:Ut,pixelOffsetBR:Ot,minFontScaleX:Wt,minFontScaleY:$t,glyphOffset:St,isSDF:gn,sectionIndex:ln}=g[at],jn=Ve.vertexLength,Vr=St[1];l1(_e,Z.x,Z.y,yt.x,Vr+yt.y,Ht.x,Ht.y,T,gn,Ut.x,Ut.y,Wt,$t),l1(_e,Z.x,Z.y,mt.x,Vr+mt.y,Ht.x+Ht.w,Ht.y,T,gn,Ot.x,Ut.y,Wt,$t),l1(_e,Z.x,Z.y,Zt.x,Vr+Zt.y,Ht.x,Ht.y+Ht.h,T,gn,Ut.x,Ot.y,Wt,$t),l1(_e,Z.x,Z.y,tn.x,Vr+tn.y,Ht.x+Ht.w,Ht.y+Ht.h,T,gn,Ot.x,Ot.y,Wt,$t),dx(u.dynamicLayoutVertexArray,Z,ut),ye.emplaceBack(jn,jn+1,jn+2),ye.emplaceBack(jn+1,jn+2,jn+3),Ve.vertexLength+=4,Ve.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(St[0]),at!==g.length-1&&ln===g[at+1].sectionIndex||u.programConfigurations.populatePaintArrays(_e.length,N,N.index,{},pe,et&&et[ln])}u.placedSymbolArray.emplaceBack(Z.x,Z.y,ze,this.glyphOffsetArray.length-ze,it,re,Ae,Z.segment,T?T[0]:0,T?T[1]:0,D[0],D[1],$,0,!1,0,he)}_addCollisionDebugVertex(u,g,T,D,z,N){return g.emplaceBack(0,0),u.emplaceBack(T.x,T.y,D,z,Math.round(N.x),Math.round(N.y))}addCollisionDebugVertices(u,g,T,D,z,N,$){const Z=z.segments.prepareSegment(4,z.layoutVertexArray,z.indexArray),re=Z.vertexLength,Ae=z.layoutVertexArray,he=z.collisionVertexArray,pe=$.anchorX,ye=$.anchorY;this._addCollisionDebugVertex(Ae,he,N,pe,ye,new Et(u,g)),this._addCollisionDebugVertex(Ae,he,N,pe,ye,new Et(T,g)),this._addCollisionDebugVertex(Ae,he,N,pe,ye,new Et(T,D)),this._addCollisionDebugVertex(Ae,he,N,pe,ye,new Et(u,D)),Z.vertexLength+=4;const _e=z.indexArray;_e.emplaceBack(re,re+1),_e.emplaceBack(re+1,re+2),_e.emplaceBack(re+2,re+3),_e.emplaceBack(re+3,re),Z.primitiveLength+=4}addDebugCollisionBoxes(u,g,T,D){for(let z=u;z<g;z++){const N=this.collisionBoxArray.get(z);this.addCollisionDebugVertices(N.x1,N.y1,N.x2,N.y2,D?this.textCollisionBox:this.iconCollisionBox,N.anchorPoint,T)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new gx(ct,h5.members,Je),this.iconCollisionBox=new gx(ct,h5.members,Je);for(let u=0;u<this.symbolInstances.length;u++){const g=this.symbolInstances.get(u);this.addDebugCollisionBoxes(g.textBoxStartIndex,g.textBoxEndIndex,g,!0),this.addDebugCollisionBoxes(g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g,!0),this.addDebugCollisionBoxes(g.iconBoxStartIndex,g.iconBoxEndIndex,g,!1),this.addDebugCollisionBoxes(g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g,!1)}}_deserializeCollisionBoxesForSymbol(u,g,T,D,z,N,$,Z,re){const Ae={};for(let he=g;he<T;he++){const pe=u.get(he);Ae.textBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.textFeatureIndex=pe.featureIndex;break}for(let he=D;he<z;he++){const pe=u.get(he);Ae.verticalTextBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalTextFeatureIndex=pe.featureIndex;break}for(let he=N;he<$;he++){const pe=u.get(he);Ae.iconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.iconFeatureIndex=pe.featureIndex;break}for(let he=Z;he<re;he++){const pe=u.get(he);Ae.verticalIconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalIconFeatureIndex=pe.featureIndex;break}return Ae}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let g=0;g<this.symbolInstances.length;g++){const T=this.symbolInstances.get(g);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,T.textBoxStartIndex,T.textBoxEndIndex,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T.iconBoxStartIndex,T.iconBoxEndIndex,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,g){const T=u.placedSymbolArray.get(g),D=T.vertexStartIndex+4*T.numGlyphs;for(let z=T.vertexStartIndex;z<D;z+=4)u.indexArray.emplaceBack(z,z+1,z+2),u.indexArray.emplaceBack(z+1,z+2,z+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const g=Math.sin(u),T=Math.cos(u),D=[],z=[],N=[];for(let $=0;$<this.symbolInstances.length;++$){N.push($);const Z=this.symbolInstances.get($);D.push(0|Math.round(g*Z.anchorX+T*Z.anchorY)),z.push(Z.featureIndex)}return N.sort(($,Z)=>D[$]-D[Z]||z[Z]-z[$]),N}addToSortKeyRanges(u,g){const T=this.sortKeyRanges[this.sortKeyRanges.length-1];T&&T.sortKey===g?T.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:g,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const g of this.symbolInstanceIndexes){const T=this.symbolInstances.get(g);this.featureSortOrder.push(T.featureIndex),[T.rightJustifiedTextSymbolIndex,T.centerJustifiedTextSymbolIndex,T.leftJustifiedTextSymbolIndex].forEach((D,z,N)=>{D>=0&&N.indexOf(D)===z&&this.addIndicesForPlacedSymbol(this.text,D)}),T.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,T.verticalPlacedTextSymbolIndex),T.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.placedIconSymbolIndex),T.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Nt("SymbolBucket",Kf,{omit:["layers","collisionBoxArray","features","compareText"]}),Kf.MAX_GLYPHS=65535,Kf.addDynamicAttributes=dx;const k9=new Hr({"symbol-placement":new Xt(ht.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(ht.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(ht.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Kt(ht.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(ht.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Xt(ht.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Xt(ht.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Xt(ht.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(ht.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(ht.layout_symbol["icon-rotation-alignment"]),"icon-size":new Kt(ht.layout_symbol["icon-size"]),"icon-text-fit":new Xt(ht.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xt(ht.layout_symbol["icon-text-fit-padding"]),"icon-image":new Kt(ht.layout_symbol["icon-image"]),"icon-rotate":new Kt(ht.layout_symbol["icon-rotate"]),"icon-padding":new Kt(ht.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(ht.layout_symbol["icon-keep-upright"]),"icon-offset":new Kt(ht.layout_symbol["icon-offset"]),"icon-anchor":new Kt(ht.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(ht.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(ht.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(ht.layout_symbol["text-rotation-alignment"]),"text-field":new Kt(ht.layout_symbol["text-field"]),"text-font":new Kt(ht.layout_symbol["text-font"]),"text-size":new Kt(ht.layout_symbol["text-size"]),"text-max-width":new Kt(ht.layout_symbol["text-max-width"]),"text-line-height":new Xt(ht.layout_symbol["text-line-height"]),"text-letter-spacing":new Kt(ht.layout_symbol["text-letter-spacing"]),"text-justify":new Kt(ht.layout_symbol["text-justify"]),"text-radial-offset":new Kt(ht.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(ht.layout_symbol["text-variable-anchor"]),"text-anchor":new Kt(ht.layout_symbol["text-anchor"]),"text-max-angle":new Xt(ht.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(ht.layout_symbol["text-writing-mode"]),"text-rotate":new Kt(ht.layout_symbol["text-rotate"]),"text-padding":new Xt(ht.layout_symbol["text-padding"]),"text-keep-upright":new Xt(ht.layout_symbol["text-keep-upright"]),"text-transform":new Kt(ht.layout_symbol["text-transform"]),"text-offset":new Kt(ht.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(ht.layout_symbol["text-allow-overlap"]),"text-overlap":new Xt(ht.layout_symbol["text-overlap"]),"text-ignore-placement":new Xt(ht.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(ht.layout_symbol["text-optional"])});var mx={paint:new Hr({"icon-opacity":new Kt(ht.paint_symbol["icon-opacity"]),"icon-color":new Kt(ht.paint_symbol["icon-color"]),"icon-halo-color":new Kt(ht.paint_symbol["icon-halo-color"]),"icon-halo-width":new Kt(ht.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Kt(ht.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(ht.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(ht.paint_symbol["icon-translate-anchor"]),"text-opacity":new Kt(ht.paint_symbol["text-opacity"]),"text-color":new Kt(ht.paint_symbol["text-color"],{runtimeType:Rr,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new Kt(ht.paint_symbol["text-halo-color"]),"text-halo-width":new Kt(ht.paint_symbol["text-halo-width"]),"text-halo-blur":new Kt(ht.paint_symbol["text-halo-blur"]),"text-translate":new Xt(ht.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(ht.paint_symbol["text-translate-anchor"])}),layout:k9};class F5{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:As,this.defaultValue=u}evaluate(u){if(u.formattedSection){const g=this.defaultValue.property.overrides;if(g&&g.hasOverride(u.formattedSection))return g.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nt("FormatSectionOverride",F5,{omit:["defaultValue"]});class A1 extends Ps{constructor(u){super(u,mx)}recalculate(u,g){if(super.recalculate(u,g),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const T=this.layout.get("text-writing-mode");if(T){const D=[];for(const z of T)D.indexOf(z)<0&&D.push(z);this.layout._values["text-writing-mode"]=D}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,g,T,D){const z=this.layout.get(u).evaluate(g,{},T,D),N=this._unevaluatedLayout._values[u];return N.isDataDriven()||zl(N.value)||!z?z:function($,Z){return Z.replace(/{([^{}]+)}/g,(re,Ae)=>Ae in $?String($[Ae]):"")}(g.properties,z)}createBucket(u){return new Kf(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of mx.paint.overridableProperties){if(!A1.hasPaintOverride(this.layout,u))continue;const g=this.paint.get(u),T=new F5(g),D=new js(T,g.property.specification);let z=null;z=g.value.kind==="constant"||g.value.kind==="source"?new xa("source",D):new Ol("composite",D,g.value.zoomStops),this.paint._values[u]=new mr(g.property,z,g.parameters)}}_handleOverridablePaintPropertyUpdate(u,g,T){return!(!this.layout||g.isDataDriven()||T.isDataDriven())&&A1.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,g){const T=u.get("text-field"),D=mx.paint.properties[g];let z=!1;const N=$=>{for(const Z of $)if(D.overrides&&D.overrides.hasOverride(Z))return void(z=!0)};if(T.value.kind==="constant"&&T.value.value instanceof ke)N(T.value.value.sections);else if(T.value.kind==="source"){const $=re=>{z||(re instanceof Dt&&We(re.value)===Zr?N(re.value.sections):re instanceof CA?N(re.sections):re.eachChild($))},Z=T.value;Z._styleExpression&&$(Z._styleExpression.expression)}return z}}function yx(f,u,g){let T="never";const D=f.get(u);return D?T=D:f.get(g)&&(T="always"),T}var I9={paint:new Hr({"background-color":new Xt(ht.paint_background["background-color"]),"background-pattern":new es(ht.paint_background["background-pattern"]),"background-opacity":new Xt(ht.paint_background["background-opacity"])})},L9={paint:new Hr({"raster-opacity":new Xt(ht.paint_raster["raster-opacity"]),"raster-hue-rotate":new Xt(ht.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(ht.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(ht.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(ht.paint_raster["raster-saturation"]),"raster-contrast":new Xt(ht.paint_raster["raster-contrast"]),"raster-resampling":new Xt(ht.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(ht.paint_raster["raster-fade-duration"])})};class D9 extends Ps{constructor(u){super(u,{}),this.onAdd=g=>{this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},this.onRemove=g=>{this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const R9={circle:class extends Ps{constructor(f){super(f,cN)}createBucket(f){return new Hv(f)}queryRadius(f){const u=f;return qd("circle-radius",this,u)+qd("circle-stroke-width",this,u)+Wm(this.paint.get("circle-translate"))}queryIntersectsFeature(f,u,g,T,D,z,N,$){const Z=Qm(f,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),z.angle,N),re=this.paint.get("circle-radius").evaluate(u,g)+this.paint.get("circle-stroke-width").evaluate(u,g),Ae=this.paint.get("circle-pitch-alignment")==="map",he=Ae?Z:function(ye,_e){return ye.map(Ve=>Z4(Ve,_e))}(Z,$),pe=Ae?re*N:re;for(const ye of T)for(const _e of ye){const Ve=Ae?_e:Z4(_e,$);let ze=pe;const it=qm([],[_e.x,_e.y,0,1],$);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ze*=it[3]/z.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ze*=z.cameraToCenterDistance/it[3]),oN(he,Ve,ze))return!0}return!1}},heatmap:class extends Ps{constructor(f){super(f,fN),this._updateColorRamp()}createBucket(f){return new Y4(f)}_handleSpecialPaintPropertyUpdate(f){f==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=K4({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Ps{constructor(f){super(f,dN)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Ps{constructor(f){super(f,kN)}recalculate(f,u){super.recalculate(f,u);const g=this.paint._values["fill-outline-color"];g.value.kind==="constant"&&g.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(f){return new rx(f)}queryRadius(){return Wm(this.paint.get("fill-translate"))}queryIntersectsFeature(f,u,g,T,D,z,N){return V4(Qm(f,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),z.angle,N),T)}isTileClipped(){return!0}},"fill-extrusion":class extends Ps{constructor(f){super(f,jN)}createBucket(f){return new sx(f)}queryRadius(){return Wm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(f,u,g,T,D,z,N,$){const Z=Qm(f,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),z.angle,N),re=this.paint.get("fill-extrusion-height").evaluate(u,g),Ae=this.paint.get("fill-extrusion-base").evaluate(u,g),he=function(ye,_e,Ve,ze){const it=[];for(const ut of ye){const et=[ut.x,ut.y,0,1];qm(et,et,_e),it.push(new Et(et[0]/et[3],et[1]/et[3]))}return it}(Z,$),pe=function(ye,_e,Ve,ze){const it=[],ut=[],et=ze[8]*_e,at=ze[9]*_e,yt=ze[10]*_e,mt=ze[11]*_e,Zt=ze[8]*Ve,tn=ze[9]*Ve,Ht=ze[10]*Ve,Ut=ze[11]*Ve;for(const Ot of ye){const Wt=[],$t=[];for(const St of Ot){const gn=St.x,ln=St.y,jn=ze[0]*gn+ze[4]*ln+ze[12],Vr=ze[1]*gn+ze[5]*ln+ze[13],Qr=ze[2]*gn+ze[6]*ln+ze[14],Oi=ze[3]*gn+ze[7]*ln+ze[15],Pa=Qr+yt,gs=Oi+mt,Ti=jn+Zt,qi=Vr+tn,ms=Qr+Ht,ks=Oi+Ut,So=new Et((jn+et)/gs,(Vr+at)/gs);So.z=Pa/gs,Wt.push(So);const Si=new Et(Ti/ks,qi/ks);Si.z=ms/ks,$t.push(Si)}it.push(Wt),ut.push($t)}return[it,ut]}(T,Ae,re,$);return function(ye,_e,Ve){let ze=1/0;V4(Ve,_e)&&(ze=a5(Ve,_e[0]));for(let it=0;it<_e.length;it++){const ut=_e[it],et=ye[it];for(let at=0;at<ut.length-1;at++){const yt=ut[at],mt=[yt,ut[at+1],et[at+1],et[at],yt];U4(Ve,mt)&&(ze=Math.min(ze,a5(Ve,mt)))}}return ze!==1/0&&ze}(pe[0],pe[1],he)}},line:class extends Ps{constructor(f){super(f,A5),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(f){f==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Dr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(f,u){super.recalculate(f,u),this.paint._values["line-floorwidth"]=u5.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,f)}createBucket(f){return new ox(f)}queryRadius(f){const u=f,g=c5(qd("line-width",this,u),qd("line-gap-width",this,u)),T=qd("line-offset",this,u);return g/2+Math.abs(T)+Wm(this.paint.get("line-translate"))}queryIntersectsFeature(f,u,g,T,D,z,N){const $=Qm(f,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),z.angle,N),Z=N/2*c5(this.paint.get("line-width").evaluate(u,g),this.paint.get("line-gap-width").evaluate(u,g)),re=this.paint.get("line-offset").evaluate(u,g);return re&&(T=function(Ae,he){const pe=[];for(let ye=0;ye<Ae.length;ye++){const _e=Ae[ye],Ve=[];for(let ze=0;ze<_e.length;ze++){const it=_e[ze-1],ut=_e[ze],et=_e[ze+1],at=ze===0?new Et(0,0):ut.sub(it)._unit()._perp(),yt=ze===_e.length-1?new Et(0,0):et.sub(ut)._unit()._perp(),mt=at._add(yt)._unit(),Zt=mt.x*yt.x+mt.y*yt.y;Zt!==0&&mt._mult(1/Zt),Ve.push(mt._mult(he)._add(ut))}pe.push(Ve)}return pe}(T,re*N)),function(Ae,he,pe){for(let ye=0;ye<he.length;ye++){const _e=he[ye];if(Ae.length>=3){for(let Ve=0;Ve<_e.length;Ve++)if(Hf(Ae,_e[Ve]))return!0}if(aN(Ae,_e,pe))return!0}return!1}($,T,Z)}isTileClipped(){return!0}},symbol:A1,background:class extends Ps{constructor(f){super(f,I9)}},raster:class extends Ps{constructor(f){super(f,L9)}}};class B9{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const N5=63710088e-1;class di{constructor(u,g){if(isNaN(u)||isNaN(g))throw new Error(`Invalid LngLat object: (${u}, ${g})`);if(this.lng=+u,this.lat=+g,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new di(F(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const g=Math.PI/180,T=this.lat*g,D=u.lat*g,z=Math.sin(T)*Math.sin(D)+Math.cos(T)*Math.cos(D)*Math.cos((u.lng-this.lng)*g);return N5*Math.acos(Math.min(z,1))}toBounds(u=0){const g=360*u/40075017,T=g/Math.cos(Math.PI/180*this.lat);return new Lh(new di(this.lng-T,this.lat-g),new di(this.lng+T,this.lat+g))}static convert(u){if(u instanceof di)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new di(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new di(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Lh{constructor(u,g){u&&(g?this.setSouthWest(u).setNorthEast(g):u.length===4?this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]]):this.setSouthWest(u[0]).setNorthEast(u[1]))}setNorthEast(u){return this._ne=u instanceof di?new di(u.lng,u.lat):di.convert(u),this}setSouthWest(u){return this._sw=u instanceof di?new di(u.lng,u.lat):di.convert(u),this}extend(u){const g=this._sw,T=this._ne;let D,z;if(u instanceof di)D=u,z=u;else{if(!(u instanceof Lh))return Array.isArray(u)?u.length===4||u.every(Array.isArray)?this.extend(Lh.convert(u)):this.extend(di.convert(u)):this;if(D=u._sw,z=u._ne,!D||!z)return this}return g||T?(g.lng=Math.min(D.lng,g.lng),g.lat=Math.min(D.lat,g.lat),T.lng=Math.max(z.lng,T.lng),T.lat=Math.max(z.lat,T.lat)):(this._sw=new di(D.lng,D.lat),this._ne=new di(z.lng,z.lat)),this}getCenter(){return new di((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new di(this.getWest(),this.getNorth())}getSouthEast(){return new di(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(u){const{lng:g,lat:T}=di.convert(u);let D=this._sw.lng<=g&&g<=this._ne.lng;return this._sw.lng>this._ne.lng&&(D=this._sw.lng>=g&&g>=this._ne.lng),this._sw.lat<=T&&T<=this._ne.lat&&D}static convert(u){return u instanceof Lh?u:u&&new Lh(u)}}const U5=2*Math.PI*N5;function V5(f){return U5*Math.cos(f*Math.PI/180)}function G5(f){return(180+f)/360}function $5(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function j5(f,u){return f/V5(u)}function _x(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class u1{constructor(u,g,T=0){this.x=+u,this.y=+g,this.z=+T}static fromLngLat(u,g=0){const T=di.convert(u);return new u1(G5(T.lng),$5(T.lat),j5(g,T.lat))}toLngLat(){return new di(360*this.x-180,_x(this.y))}toAltitude(){return this.z*V5(_x(this.y))}meterInMercatorCoordinateUnits(){return 1/U5*(u=_x(this.y),1/Math.cos(u*Math.PI/180));var u}}function H5(f,u,g){var T=2*Math.PI*6378137/256/Math.pow(2,g);return[f*T-2*Math.PI*6378137/2,u*T-2*Math.PI*6378137/2]}class vx{constructor(u,g,T){if(u<0||u>25||T<0||T>=Math.pow(2,u)||g<0||g>=Math.pow(2,u))throw new Error(`x=${g}, y=${T}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=g,this.y=T,this.key=sp(0,u,u,g,T)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,g,T){const D=(N=this.y,$=this.z,Z=H5(256*(z=this.x),256*(N=Math.pow(2,$)-N-1),$),re=H5(256*(z+1),256*(N+1),$),Z[0]+","+Z[1]+","+re[0]+","+re[1]);var z,N,$,Z,re;const Ae=function(he,pe,ye){let _e,Ve="";for(let ze=he;ze>0;ze--)_e=1<<ze-1,Ve+=(pe&_e?1:0)+(ye&_e?2:0);return Ve}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(T==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,g>1?"@2x":"").replace(/{quadkey}/g,Ae).replace(/{bbox-epsg-3857}/g,D)}isChildOf(u){const g=this.z-u.z;return g>0&&u.x===this.x>>g&&u.y===this.y>>g}getTilePoint(u){const g=Math.pow(2,this.z);return new Et((u.x*g-this.x)*zi,(u.y*g-this.y)*zi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class W5{constructor(u,g){this.wrap=u,this.canonical=g,this.key=sp(u,g.z,g.z,g.x,g.y)}}class Ma{constructor(u,g,T,D,z){if(u<T)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${T}`);this.overscaledZ=u,this.wrap=g,this.canonical=new vx(T,+D,+z),this.key=sp(g,u,T,D,z)}clone(){return new Ma(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-u;return u>this.canonical.z?new Ma(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ma(u,this.wrap,u,this.canonical.x>>g,this.canonical.y>>g)}calculateScaledKey(u,g){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const T=this.canonical.z-u;return u>this.canonical.z?sp(this.wrap*+g,u,this.canonical.z,this.canonical.x,this.canonical.y):sp(this.wrap*+g,u,u,this.canonical.x>>T,this.canonical.y>>T)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const g=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>g&&u.canonical.y===this.canonical.y>>g}children(u){if(this.overscaledZ>=u)return[new Ma(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const g=this.canonical.z+1,T=2*this.canonical.x,D=2*this.canonical.y;return[new Ma(g,this.wrap,g,T,D),new Ma(g,this.wrap,g,T+1,D),new Ma(g,this.wrap,g,T,D+1),new Ma(g,this.wrap,g,T+1,D+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new Ma(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new Ma(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new W5(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new u1(u.x-this.wrap,u.y))}}function sp(f,u,g,T,D){(f*=2)<0&&(f=-1*f-1);const z=1<<g;return(z*z*f+z*D+T).toString(36)+g.toString(36)+u.toString(36)}Nt("CanonicalTileID",vx),Nt("OverscaledTileID",Ma,{omit:["posMatrix"]});class Q5{constructor(u,g,T){if(this.uid=u,g.height!==g.width)throw new RangeError("DEM tiles must be square");if(T&&T!=="mapbox"&&T!=="terrarium")return void me(`"${T}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=g.height;const D=this.dim=g.height-2;this.data=new Uint32Array(g.data.buffer),this.encoding=T||"mapbox";for(let z=0;z<D;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(D,z)]=this.data[this._idx(D-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,D)]=this.data[this._idx(z,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<D;z++)for(let N=0;N<D;N++){const $=this.get(z,N);$>this.max&&(this.max=$),$<this.min&&(this.min=$)}}get(u,g){const T=new Uint8Array(this.data.buffer),D=4*this._idx(u,g);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(T[D],T[D+1],T[D+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(u,g){if(u<-1||u>=this.dim+1||g<-1||g>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(g+1)*this.stride+(u+1)}_unpackMapbox(u,g,T){return(256*u*256+256*g+T)/10-1e4}_unpackTerrarium(u,g,T){return 256*u+g+T/256-32768}getPixels(){return new Ca({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,g,T){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let D=g*this.dim,z=g*this.dim+this.dim,N=T*this.dim,$=T*this.dim+this.dim;switch(g){case-1:D=z-1;break;case 1:z=D+1}switch(T){case-1:N=$-1;break;case 1:$=N+1}const Z=-g*this.dim,re=-T*this.dim;for(let Ae=N;Ae<$;Ae++)for(let he=D;he<z;he++)this.data[this._idx(he,Ae)]=u.data[this._idx(he+Z,Ae+re)]}}Nt("DEMData",Q5);class q5{constructor(u){this._stringToNumber={},this._numberToString=[];for(let g=0;g<u.length;g++){const T=u[g];this._stringToNumber[T]=g,this._numberToString[g]=T}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class Z5{constructor(u,g,T,D,z){this.type="Feature",this._vectorTileFeature=u,u._z=g,u._x=T,u._y=D,this.properties=u.properties,this.id=z}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const g in this)g!=="_geometry"&&g!=="_vectorTileFeature"&&(u[g]=this[g]);return u}}class Y5{constructor(u,g){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new Ea(zi,16,0),this.grid3D=new Ea(zi,16,0),this.featureIndexArray=new O,this.promoteId=g}insert(u,g,T,D,z,N){const $=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(T,D,z);const Z=N?this.grid3D:this.grid;for(let re=0;re<g.length;re++){const Ae=g[re],he=[1/0,1/0,-1/0,-1/0];for(let pe=0;pe<Ae.length;pe++){const ye=Ae[pe];he[0]=Math.min(he[0],ye.x),he[1]=Math.min(he[1],ye.y),he[2]=Math.max(he[2],ye.x),he[3]=Math.max(he[3],ye.y)}he[0]<zi&&he[1]<zi&&he[2]>=0&&he[3]>=0&&Z.insert($,he[0],he[1],he[2],he[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Pc.VectorTile(new ax(this.rawTileData)).layers,this.sourceLayerCoder=new q5(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,g,T,D){this.loadVTLayers();const z=u.params||{},N=zi/u.tileSize/u.scale,$=Hs(z.filter),Z=u.queryGeometry,re=u.queryPadding*N,Ae=K5(Z),he=this.grid.query(Ae.minX-re,Ae.minY-re,Ae.maxX+re,Ae.maxY+re),pe=K5(u.cameraQueryGeometry),ye=this.grid3D.query(pe.minX-re,pe.minY-re,pe.maxX+re,pe.maxY+re,(ze,it,ut,et)=>function(at,yt,mt,Zt,tn){for(const Ut of at)if(yt<=Ut.x&&mt<=Ut.y&&Zt>=Ut.x&&tn>=Ut.y)return!0;const Ht=[new Et(yt,mt),new Et(yt,tn),new Et(Zt,tn),new Et(Zt,mt)];if(at.length>2){for(const Ut of Ht)if(Hf(at,Ut))return!0}for(let Ut=0;Ut<at.length-1;Ut++)if(AN(at[Ut],at[Ut+1],Ht))return!0;return!1}(u.cameraQueryGeometry,ze-re,it-re,ut+re,et+re));for(const ze of ye)he.push(ze);he.sort(z9);const _e={};let Ve;for(let ze=0;ze<he.length;ze++){const it=he[ze];if(it===Ve)continue;Ve=it;const ut=this.featureIndexArray.get(it);let et=null;this.loadMatchingFeature(_e,ut.bucketIndex,ut.sourceLayerIndex,ut.featureIndex,$,z.layers,z.availableImages,g,T,D,(at,yt,mt)=>(et||(et=Ph(at)),yt.queryIntersectsFeature(Z,at,mt,et,this.z,u.transform,N,u.pixelPosMatrix)))}return _e}loadMatchingFeature(u,g,T,D,z,N,$,Z,re,Ae,he){const pe=this.bucketLayerIDs[g];if(N&&!function(ze,it){for(let ut=0;ut<ze.length;ut++)if(it.indexOf(ze[ut])>=0)return!0;return!1}(N,pe))return;const ye=this.sourceLayerCoder.decode(T),_e=this.vtLayers[ye].feature(D);if(z.needGeometry){const ze=kh(_e,!0);if(!z.filter(new Mr(this.tileID.overscaledZ),ze,this.tileID.canonical))return}else if(!z.filter(new Mr(this.tileID.overscaledZ),_e))return;const Ve=this.getId(_e,ye);for(let ze=0;ze<pe.length;ze++){const it=pe[ze];if(N&&N.indexOf(it)<0)continue;const ut=Z[it];if(!ut)continue;let et={};Ve&&Ae&&(et=Ae.getState(ut.sourceLayer||"_geojsonTileLayer",Ve));const at=H({},re[it]);at.paint=X5(at.paint,ut.paint,_e,et,$),at.layout=X5(at.layout,ut.layout,_e,et,$);const yt=!he||he(_e,ut,et);if(!yt)continue;const mt=new Z5(_e,this.z,this.x,this.y,Ve);mt.layer=at;let Zt=u[it];Zt===void 0&&(Zt=u[it]=[]),Zt.push({featureIndex:D,feature:mt,intersectionZ:yt})}}lookupSymbolFeatures(u,g,T,D,z,N,$,Z){const re={};this.loadVTLayers();const Ae=Hs(z);for(const he of u)this.loadMatchingFeature(re,T,D,he,Ae,N,$,Z,g);return re}hasLayer(u){for(const g of this.bucketLayerIDs)for(const T of g)if(u===T)return!0;return!1}getId(u,g){let T=u.id;return this.promoteId&&(T=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[g]],typeof T=="boolean"&&(T=Number(T))),T}}function X5(f,u,g,T,D){return Y(f,(z,N)=>{const $=u instanceof Wl?u.get(N):null;return $&&$.evaluate?$.evaluate(g,T,D):$})}function K5(f){let u=1/0,g=1/0,T=-1/0,D=-1/0;for(const z of f)u=Math.min(u,z.x),g=Math.min(g,z.y),T=Math.max(T,z.x),D=Math.max(D,z.y);return{minX:u,minY:g,maxX:T,maxY:D}}function z9(f,u){return u-f}var xx;Nt("FeatureIndex",Y5,{omit:["rawTileData","sourceLayerCoder"]}),o.PerformanceMarkers=void 0,(xx=o.PerformanceMarkers||(o.PerformanceMarkers={})).create="create",xx.load="load",xx.fullLoad="fullLoad";let c1=null,op=[];const wx=1e3/30,O9={mark(f){performance.mark(f)},frame(f){const u=f;c1!=null&&op.push(u-c1),c1=u},clearMetrics(){c1=null,op=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const f in o.PerformanceMarkers)performance.clearMarks(o.PerformanceMarkers[f])},getPerformanceMetrics(){performance.measure("loadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.load),performance.measure("fullLoadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.fullLoad);const f=performance.getEntriesByName("loadTime")[0].duration,u=performance.getEntriesByName("fullLoadTime")[0].duration,g=op.length,T=1/(op.reduce((z,N)=>z+N,0)/g/1e3),D=op.filter(z=>z>wx).reduce((z,N)=>z+(N-wx)/wx,0);return{loadTime:f,fullLoadTime:u,fps:T,percentDroppedFrames:D/(g+D)*100}}};o.AJAXError=tr,o.ARRAY_TYPE=Js,o.Actor=class{constructor(f,u,g){this.target=f,this.parent=u,this.mapId=g,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},ie(["receive","process"],this),this.invoker=new B9(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qe()?f:window}send(f,u,g,T,D=!1){const z=Math.round(1e18*Math.random()).toString(36).substring(0,10);g&&(this.callbacks[z]=g);const N=Ze(this.globalScope)?void 0:[];return this.target.postMessage({id:z,type:f,hasCallback:!!g,targetMapId:T,mustQueue:D,sourceMapId:this.mapId,data:Ta(u,N)},N),{cancel:()=>{g&&delete this.callbacks[z],this.target.postMessage({id:z,type:"<cancel>",targetMapId:T,sourceMapId:this.mapId})}}}receive(f){const u=f.data,g=u.id;if(g&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){delete this.tasks[g];const T=this.cancelCallbacks[g];delete this.cancelCallbacks[g],T&&T()}else Qe()||u.mustQueue?(this.tasks[g]=u,this.taskQueue.push(g),this.invoker.trigger()):this.processTask(g,u)}process(){if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),u=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),u&&this.processTask(f,u)}processTask(f,u){if(u.type==="<response>"){const g=this.callbacks[f];delete this.callbacks[f],g&&(u.error?g(Ko(u.error)):g(null,Ko(u.data)))}else{let g=!1;const T=Ze(this.globalScope)?void 0:[],D=u.hasCallback?($,Z)=>{g=!0,delete this.cancelCallbacks[f],this.target.postMessage({id:f,type:"<response>",sourceMapId:this.mapId,error:$?Ta($):null,data:Ta(Z,T)},T)}:$=>{g=!0};let z=null;const N=Ko(u.data);if(this.parent[u.type])z=this.parent[u.type](u.sourceMapId,N,D);else if(this.parent.getWorkerSource){const $=u.type.split(".");z=this.parent.getWorkerSource(u.sourceMapId,$[0],N.source)[$[1]](N,D)}else D(new Error(`Could not find function ${u.type}`));!g&&z&&z.cancel&&(this.cancelCallbacks[f]=z.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.AlphaImage=Yd,o.CanonicalTileID=vx,o.CollisionBoxArray=Ge,o.CollisionCircleLayoutArray=class extends B{},o.Color=a,o.DEMData=Q5,o.DataConstantProperty=Xt,o.DictionaryCoder=q5,o.EXTENT=zi,o.ErrorEvent=$o,o.EvaluationParameters=Mr,o.Event=Ii,o.Evented=ls,o.FeatureIndex=Y5,o.FillBucket=rx,o.FillExtrusionBucket=sx,o.GeoJSONFeature=Z5,o.ImageAtlas=v5,o.ImagePosition=Ax,o.LineBucket=ox,o.LineStripIndexArray=class extends ve{},o.LngLat=di,o.LngLatBounds=Lh,o.MercatorCoordinate=u1,o.ONE_EM=ts,o.OverscaledTileID=Ma,o.PerformanceUtils=O9,o.PosArray=U,o.Properties=Hr,o.QuadTriangleArray=class extends W{},o.RGBAImage=Ca,o.RasterBoundsArray=class extends L{},o.RequestPerformance=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},o.ResourceType=xt,o.SegmentVector=gt,o.SymbolBucket=Kf,o.Transitionable=bu,o.TriangleIndexArray=ot,o.Uniform1f=Tu,o.Uniform1i=class extends ol{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},o.Uniform2f=class extends ol{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},o.Uniform3f=class extends ol{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},o.Uniform4f=$f,o.UniformColor=z4,o.UniformMatrix4f=class extends ol{constructor(f,u){super(f,u),this.current=iN}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},o.UnwrappedTileID=W5,o.ValidationError=It,o.ZoomHistory=mu,o.add=function(f,u,g){return f[0]=u[0]+g[0],f[1]=u[1]+g[1],f[2]=u[2]+g[2],f},o.addDynamicAttributes=dx,o.asyncAll=function(f,u,g){if(!f.length)return g(null,[]);let T=f.length;const D=new Array(f.length);let z=null;f.forEach((N,$)=>{u(N,(Z,re)=>{Z&&(z=Z),D[$]=re,--T==0&&g(z,D)})})},o.bezier=S,o.bindAll=ie,o.cacheEntryPossiblyAdded=function(f){or++,or>kr&&(f.getActor().send("enforceCacheSizeLimit",Tn),or=0)},o.clamp=k,o.clearTileCache=function(f){const u=caches.delete(Tt);f&&u.catch(f).then(()=>f())},o.clipLine=L5,o.clone=function(f){var u=new Js(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},o.clone$1=se,o.clone$2=function(f){var u=new Js(3);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u},o.collisionCircleLayout=t9,o.config=_t,o.copy=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},o.create=function(){var f=new Js(16);return Js!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},o.create$1=j4,o.createExpression=Xa,o.createFilter=Hs,o.createLayout=Wr,o.createStyleLayer=function(f){return f.type==="custom"?new D9(f):new R9[f.type](f)},o.cross=function(f,u,g){var T=u[0],D=u[1],z=u[2],N=g[0],$=g[1],Z=g[2];return f[0]=D*Z-z*$,f[1]=z*N-T*Z,f[2]=T*$-D*N,f},o.dot=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]},o.dot$1=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},o.ease=M,o.emitValidationErrors=nl,o.enforceCacheSizeLimit=function(f){er(),Jt&&Jt.then(u=>{u.keys().then(g=>{for(let T=0;T<g.length-f;T++)u.delete(g[T])})})},o.equals=function(f,u){var g=f[0],T=f[1],D=f[2],z=f[3],N=f[4],$=f[5],Z=f[6],re=f[7],Ae=f[8],he=f[9],pe=f[10],ye=f[11],_e=f[12],Ve=f[13],ze=f[14],it=f[15],ut=u[0],et=u[1],at=u[2],yt=u[3],mt=u[4],Zt=u[5],tn=u[6],Ht=u[7],Ut=u[8],Ot=u[9],Wt=u[10],$t=u[11],St=u[12],gn=u[13],ln=u[14],jn=u[15];return Math.abs(g-ut)<=Ks*Math.max(1,Math.abs(g),Math.abs(ut))&&Math.abs(T-et)<=Ks*Math.max(1,Math.abs(T),Math.abs(et))&&Math.abs(D-at)<=Ks*Math.max(1,Math.abs(D),Math.abs(at))&&Math.abs(z-yt)<=Ks*Math.max(1,Math.abs(z),Math.abs(yt))&&Math.abs(N-mt)<=Ks*Math.max(1,Math.abs(N),Math.abs(mt))&&Math.abs($-Zt)<=Ks*Math.max(1,Math.abs($),Math.abs(Zt))&&Math.abs(Z-tn)<=Ks*Math.max(1,Math.abs(Z),Math.abs(tn))&&Math.abs(re-Ht)<=Ks*Math.max(1,Math.abs(re),Math.abs(Ht))&&Math.abs(Ae-Ut)<=Ks*Math.max(1,Math.abs(Ae),Math.abs(Ut))&&Math.abs(he-Ot)<=Ks*Math.max(1,Math.abs(he),Math.abs(Ot))&&Math.abs(pe-Wt)<=Ks*Math.max(1,Math.abs(pe),Math.abs(Wt))&&Math.abs(ye-$t)<=Ks*Math.max(1,Math.abs(ye),Math.abs($t))&&Math.abs(_e-St)<=Ks*Math.max(1,Math.abs(_e),Math.abs(St))&&Math.abs(Ve-gn)<=Ks*Math.max(1,Math.abs(Ve),Math.abs(gn))&&Math.abs(ze-ln)<=Ks*Math.max(1,Math.abs(ze),Math.abs(ln))&&Math.abs(it-jn)<=Ks*Math.max(1,Math.abs(it),Math.abs(jn))},o.evaluateSizeForFeature=function(f,{uSize:u,uSizeT:g},{lowerSize:T,upperSize:D}){return f.kind==="source"?T/Mu:f.kind==="composite"?en(T/Mu,D/Mu,g):u},o.evaluateSizeForZoom=function(f,u){let g=0,T=0;if(f.kind==="constant")T=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:D,minZoom:z,maxZoom:N}=f,$=D?k(zn.interpolationFactor(D,u,z,N),0,1):0;f.kind==="camera"?T=en(f.minSize,f.maxSize,$):g=$}return{uSizeT:g,uSize:T}},o.evaluateVariableOffset=B5,o.evented=Ur,o.exported=Yt,o.exported$1=hr,o.extend=H,o.filterObject=J,o.fromRotation=function(f,u){var g=Math.sin(u),T=Math.cos(u);return f[0]=T,f[1]=g,f[2]=0,f[3]=-g,f[4]=T,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},o.fromScaling=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},o.getAnchorAlignment=cx,o.getAnchorJustification=fx,o.getArrayBuffer=nr,o.getImage=Gi,o.getJSON=function(f,u){return lr(H(f,{type:"json"}),u)},o.getOverlapMode=yx,o.getRTLTextPluginStatus=jl,o.getReferrer=Hn,o.getVideo=function(f,u){const g=window.document.createElement("video");g.muted=!0,g.onloadstart=function(){u(null,g)};for(let T=0;T<f.length;T++){const D=window.document.createElement("source");ri(f[T])||(g.crossOrigin="Anonymous"),D.src=f[T],g.appendChild(D)}return{cancel:()=>{}}},o.identity=qv,o.invert=function(f,u){var g=u[0],T=u[1],D=u[2],z=u[3],N=u[4],$=u[5],Z=u[6],re=u[7],Ae=u[8],he=u[9],pe=u[10],ye=u[11],_e=u[12],Ve=u[13],ze=u[14],it=u[15],ut=g*$-T*N,et=g*Z-D*N,at=g*re-z*N,yt=T*Z-D*$,mt=T*re-z*$,Zt=D*re-z*Z,tn=Ae*Ve-he*_e,Ht=Ae*ze-pe*_e,Ut=Ae*it-ye*_e,Ot=he*ze-pe*Ve,Wt=he*it-ye*Ve,$t=pe*it-ye*ze,St=ut*$t-et*Wt+at*Ot+yt*Ut-mt*Ht+Zt*tn;return St?(f[0]=($*$t-Z*Wt+re*Ot)*(St=1/St),f[1]=(D*Wt-T*$t-z*Ot)*St,f[2]=(Ve*Zt-ze*mt+it*yt)*St,f[3]=(pe*mt-he*Zt-ye*yt)*St,f[4]=(Z*Ut-N*$t-re*Ht)*St,f[5]=(g*$t-D*Ut+z*Ht)*St,f[6]=(ze*at-_e*Zt-it*et)*St,f[7]=(Ae*Zt-pe*at+ye*et)*St,f[8]=(N*Wt-$*Ut+re*tn)*St,f[9]=(T*Ut-g*Wt-z*tn)*St,f[10]=(_e*mt-Ve*at+it*ut)*St,f[11]=(he*at-Ae*mt-ye*ut)*St,f[12]=($*Ht-N*Ot-Z*tn)*St,f[13]=(g*Ot-T*Ht+D*tn)*St,f[14]=(Ve*et-_e*yt-ze*ut)*St,f[15]=(Ae*yt-he*et+pe*ut)*St,f):null},o.isImageBitmap=pt,o.isSafari=Ze,o.isWorker=Qe,o.keysDifference=function(f,u){const g=[];for(const T in f)T in u||g.push(T);return g},o.lazyLoadRTLTextPlugin=function(){ps.isLoading()||ps.isLoaded()||jl()!=="deferred"||Tc()},o.makeRequest=lr,o.mapObject=Y,o.mercatorXfromLng=G5,o.mercatorYfromLat=$5,o.mercatorZfromAltitude=j5,o.mul=hN,o.mul$1=function(f,u,g){return f[0]=u[0]*g[0],f[1]=u[1]*g[1],f[2]=u[2]*g[2],f[3]=u[3]*g[3],f},o.multiply=H4,o.nextPowerOfTwo=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},o.normalize=function(f,u){var g=u[0],T=u[1],D=u[2],z=g*g+T*T+D*D;return z>0&&(z=1/Math.sqrt(z)),f[0]=u[0]*z,f[1]=u[1]*z,f[2]=u[2]*z,f},o.number=en,o.ortho=function(f,u,g,T,D,z,N){var $=1/(u-g),Z=1/(T-D),re=1/(z-N);return f[0]=-2*$,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*Z,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*re,f[11]=0,f[12]=(u+g)*$,f[13]=(D+T)*Z,f[14]=(N+z)*re,f[15]=1,f},o.parseCacheControl=Ye,o.parseGlyphPbf=function(f){return new ax(f).readFields(h9,[])},o.pbf=ax,o.performSymbolLayout=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=zi/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0].layout,g=f.bucket.layers[0]._unevaluatedLayout._values,T={layoutIconSize:g["icon-size"].possiblyEvaluate(new Mr(f.bucket.zoom+1),f.canonical),layoutTextSize:g["text-size"].possiblyEvaluate(new Mr(f.bucket.zoom+1),f.canonical),textMaxSize:g["text-size"].possiblyEvaluate(new Mr(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.textSizeData;T.compositeTextSizes=[g["text-size"].possiblyEvaluate(new Mr(Z),f.canonical),g["text-size"].possiblyEvaluate(new Mr(re),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.iconSizeData;T.compositeIconSizes=[g["icon-size"].possiblyEvaluate(new Mr(Z),f.canonical),g["icon-size"].possiblyEvaluate(new Mr(re),f.canonical)]}const D=u.get("text-line-height")*ts,z=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",N=u.get("text-keep-upright"),$=u.get("text-size");for(const Z of f.bucket.features){const re=u.get("text-font").evaluate(Z,{},f.canonical).join(","),Ae=$.evaluate(Z,{},f.canonical),he=T.layoutTextSize.evaluate(Z,{},f.canonical),pe=T.layoutIconSize.evaluate(Z,{},f.canonical),ye={horizontal:{},vertical:void 0},_e=Z.text;let Ve,ze=[0,0];if(_e){const et=_e.toString(),at=u.get("text-letter-spacing").evaluate(Z,{},f.canonical)*ts,yt=$l(et)?at:0,mt=u.get("text-anchor").evaluate(Z,{},f.canonical),Zt=u.get("text-variable-anchor");if(!Zt){const Wt=u.get("text-radial-offset").evaluate(Z,{},f.canonical);ze=Wt?B5(mt,[Wt*ts,hx]):u.get("text-offset").evaluate(Z,{},f.canonical).map($t=>$t*ts)}let tn=z?"center":u.get("text-justify").evaluate(Z,{},f.canonical);const Ht=u.get("symbol-placement"),Ut=Ht==="point"?u.get("text-max-width").evaluate(Z,{},f.canonical)*ts:0,Ot=()=>{f.bucket.allowVerticalPlacement&&kA(et)&&(ye.vertical=n1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,mt,"left",yt,ze,o.WritingMode.vertical,!0,Ht,he,Ae))};if(!z&&Zt){const Wt=tn==="auto"?Zt.map(St=>fx(St)):[tn];let $t=!1;for(let St=0;St<Wt.length;St++){const gn=Wt[St];if(!ye.horizontal[gn])if($t)ye.horizontal[gn]=ye.horizontal[0];else{const ln=n1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,"center",gn,yt,ze,o.WritingMode.horizontal,!1,Ht,he,Ae);ln&&(ye.horizontal[gn]=ln,$t=ln.positionedLines.length===1)}}Ot()}else{tn==="auto"&&(tn=fx(mt));const Wt=n1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,mt,tn,yt,ze,o.WritingMode.horizontal,!1,Ht,he,Ae);Wt&&(ye.horizontal[tn]=Wt),Ot(),kA(et)&&z&&N&&(ye.vertical=n1(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,mt,tn,yt,ze,o.WritingMode.vertical,!1,Ht,he,Ae))}}let it=!1;if(Z.icon&&Z.icon.name){const et=f.imageMap[Z.icon.name];et&&(Ve=y9(f.imagePositions[Z.icon.name],u.get("icon-offset").evaluate(Z,{},f.canonical),u.get("icon-anchor").evaluate(Z,{},f.canonical)),it=!!et.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=it:f.bucket.sdfIcons!==it&&me("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(et.pixelRatio!==f.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const ut=O5(ye.horizontal)||ye.vertical;f.bucket.iconsInText=!!ut&&ut.iconsInText,(ut||Ve)&&T9(f.bucket,Z,ye,Ve,f.imageMap,T,he,pe,ze,it,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},o.perspective=function(f,u,g,T,D){var z,N=1/Math.tan(u/2);return f[0]=N/g,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=N,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,D!=null&&D!==1/0?(f[10]=(D+T)*(z=1/(T-D)),f[14]=2*D*T*z):(f[10]=-1,f[14]=-2*T),f},o.pick=function(f,u){const g={};for(let T=0;T<u.length;T++){const D=u[T];D in f&&(g[D]=f[D])}return g},o.plugin=ps,o.pointGeometry=Et,o.polygonIntersectsPolygon=U4,o.potpack=_5,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=Nt,o.registerForPluginStateChange=function(f){return f({pluginStatus:Bi,pluginURL:To}),Ur.on("pluginStateChange",f),f},o.renderColorRamp=K4,o.rotateX=function(f,u,g){var T=Math.sin(g),D=Math.cos(g),z=u[4],N=u[5],$=u[6],Z=u[7],re=u[8],Ae=u[9],he=u[10],pe=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=z*D+re*T,f[5]=N*D+Ae*T,f[6]=$*D+he*T,f[7]=Z*D+pe*T,f[8]=re*D-z*T,f[9]=Ae*D-N*T,f[10]=he*D-$*T,f[11]=pe*D-Z*T,f},o.rotateZ=function(f,u,g){var T=Math.sin(g),D=Math.cos(g),z=u[0],N=u[1],$=u[2],Z=u[3],re=u[4],Ae=u[5],he=u[6],pe=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=z*D+re*T,f[1]=N*D+Ae*T,f[2]=$*D+he*T,f[3]=Z*D+pe*T,f[4]=re*D-z*T,f[5]=Ae*D-N*T,f[6]=he*D-$*T,f[7]=pe*D-Z*T,f},o.scale=function(f,u,g){var T=g[0],D=g[1],z=g[2];return f[0]=u[0]*T,f[1]=u[1]*T,f[2]=u[2]*T,f[3]=u[3]*T,f[4]=u[4]*D,f[5]=u[5]*D,f[6]=u[6]*D,f[7]=u[7]*D,f[8]=u[8]*z,f[9]=u[9]*z,f[10]=u[10]*z,f[11]=u[11]*z,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},o.scale$1=function(f,u,g){return f[0]=u[0]*g,f[1]=u[1]*g,f[2]=u[2]*g,f},o.setCacheLimits=function(f,u){Tn=f,kr=u},o.setRTLTextPlugin=function(f,u,g=!1){if(Bi===_u||Bi===vu||Bi===xu)throw new Error("setRTLTextPlugin cannot be called multiple times.");To=Yt.resolveURL(f),Bi=_u,qs=u,Sa(),g||Tc()},o.spec=ht,o.sphericalToCartesian=function([f,u,g]){return u+=90,u*=Math.PI/180,g*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(g),y:f*Math.sin(u)*Math.sin(g),z:f*Math.cos(g)}},o.sqrLen=function(f){var u=f[0],g=f[1];return u*u+g*g},o.sub=function(f,u,g){return f[0]=u[0]-g[0],f[1]=u[1]-g[1],f[2]=u[2]-g[2],f},o.toEvaluationFeature=kh,o.transformMat3=function(f,u,g){var T=u[0],D=u[1],z=u[2];return f[0]=T*g[0]+D*g[3]+z*g[6],f[1]=T*g[1]+D*g[4]+z*g[7],f[2]=T*g[2]+D*g[5]+z*g[8],f},o.transformMat4=qm,o.transformMat4$1=function(f,u,g){var T=u[0],D=u[1];return f[0]=g[0]*T+g[4]*D+g[12],f[1]=g[1]*T+g[5]*D+g[13],f},o.translate=function(f,u,g){var T,D,z,N,$,Z,re,Ae,he,pe,ye,_e,Ve=g[0],ze=g[1],it=g[2];return u===f?(f[12]=u[0]*Ve+u[4]*ze+u[8]*it+u[12],f[13]=u[1]*Ve+u[5]*ze+u[9]*it+u[13],f[14]=u[2]*Ve+u[6]*ze+u[10]*it+u[14],f[15]=u[3]*Ve+u[7]*ze+u[11]*it+u[15]):(D=u[1],z=u[2],N=u[3],$=u[4],Z=u[5],re=u[6],Ae=u[7],he=u[8],pe=u[9],ye=u[10],_e=u[11],f[0]=T=u[0],f[1]=D,f[2]=z,f[3]=N,f[4]=$,f[5]=Z,f[6]=re,f[7]=Ae,f[8]=he,f[9]=pe,f[10]=ye,f[11]=_e,f[12]=T*Ve+$*ze+he*it+u[12],f[13]=D*Ve+Z*ze+pe*it+u[13],f[14]=z*Ve+re*ze+ye*it+u[14],f[15]=N*Ve+Ae*ze+_e*it+u[15]),f},o.triggerPluginCompletionEvent=wu,o.unicodeBlockLookup=Vt,o.uniqueId=function(){return j++},o.validateCustomStyleLayer=function(f){const u=[],g=f.id;return g===void 0&&u.push({message:`layers.${g}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${g}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${g}: property "renderingMode" must be either "2d" or "3d"`}),u},o.validateLight=tl,o.validateStyle=Gl,o.vectorTile=Pc,o.warnOnce=me,o.wrap=F}),s(["./shared"],function(o){function p(K){const Q=typeof K;if(Q==="number"||Q==="boolean"||Q==="string"||K==null)return JSON.stringify(K);if(Array.isArray(K)){let a="[";for(const G of K)a+=`${p(G)},`;return`${a}]`}const te=Object.keys(K).sort();let fe="{";for(let a=0;a<te.length;a++)fe+=`${JSON.stringify(te[a])}:${p(K[te[a]])},`;return`${fe}}`}function v(K){let Q="";for(const te of o.refProperties)Q+=`/${p(K[te])}`;return Q}class S{constructor(Q){this.keyCache={},Q&&this.replace(Q)}replace(Q){this._layerConfigs={},this._layers={},this.update(Q,[])}update(Q,te){for(const a of Q){this._layerConfigs[a.id]=a;const G=this._layers[a.id]=o.createStyleLayer(a);G._featureFilter=o.createFilter(G.filter),this.keyCache[a.id]&&delete this.keyCache[a.id]}for(const a of te)delete this.keyCache[a],delete this._layerConfigs[a],delete this._layers[a];this.familiesBySource={};const fe=function(a,G){const Le={};for(let Pe=0;Pe<a.length;Pe++){const Ie=G&&G[a[Pe].id]||v(a[Pe]);G&&(G[a[Pe].id]=Ie);let qe=Le[Ie];qe||(qe=Le[Ie]=[]),qe.push(a[Pe])}const ke=[];for(const Pe in Le)ke.push(Le[Pe]);return ke}(Object.values(this._layerConfigs),this.keyCache);for(const a of fe){const G=a.map(At=>this._layers[At.id]),Le=G[0];if(Le.visibility==="none")continue;const ke=Le.source||"";let Pe=this.familiesBySource[ke];Pe||(Pe=this.familiesBySource[ke]={});const Ie=Le.sourceLayer||"_geojsonTileLayer";let qe=Pe[Ie];qe||(qe=Pe[Ie]=[]),qe.push(G)}}}class M{constructor(Q){const te={},fe=[];for(const ke in Q){const Pe=Q[ke],Ie=te[ke]={};for(const qe in Pe){const At=Pe[+qe];if(!At||At.bitmap.width===0||At.bitmap.height===0)continue;const We={x:0,y:0,w:At.bitmap.width+2,h:At.bitmap.height+2};fe.push(We),Ie[qe]={rect:We,metrics:At.metrics}}}const{w:a,h:G}=o.potpack(fe),Le=new o.AlphaImage({width:a||1,height:G||1});for(const ke in Q){const Pe=Q[ke];for(const Ie in Pe){const qe=Pe[+Ie];if(!qe||qe.bitmap.width===0||qe.bitmap.height===0)continue;const At=te[ke][Ie].rect;o.AlphaImage.copy(qe.bitmap,Le,{x:0,y:0},{x:At.x+1,y:At.y+1},qe.bitmap)}}this.image=Le,this.positions=te}}o.register("GlyphAtlas",M);class k{constructor(Q){this.tileID=new o.OverscaledTileID(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.uid=Q.uid,this.zoom=Q.zoom,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Q.showCollisionBoxes,this.collectResourceTiming=!!Q.collectResourceTiming,this.returnDependencies=!!Q.returnDependencies,this.promoteId=Q.promoteId}parse(Q,te,fe,a,G){this.status="parsing",this.data=Q,this.collisionBoxArray=new o.CollisionBoxArray;const Le=new o.DictionaryCoder(Object.keys(Q.layers).sort()),ke=new o.FeatureIndex(this.tileID,this.promoteId);ke.bucketLayerIDs=[];const Pe={},Ie={featureIndex:ke,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:fe},qe=te.familiesBySource[this.source];for(const qt in qe){const an=Q.layers[qt];if(!an)continue;an.version===1&&o.warnOnce(`Vector tile source "${this.source}" layer "${qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xn=Le.encode(qt),Ft=[];for(let Oe=0;Oe<an.length;Oe++){const Mt=an.feature(Oe),Ce=ke.getId(Mt,qt);Ft.push({feature:Mt,id:Ce,index:Oe,sourceLayerIndex:xn})}for(const Oe of qe[qt]){const Mt=Oe[0];Mt.source!==this.source&&o.warnOnce(`layer.source = ${Mt.source} does not equal this.source = ${this.source}`),Mt.minzoom&&this.zoom<Math.floor(Mt.minzoom)||Mt.maxzoom&&this.zoom>=Mt.maxzoom||Mt.visibility!=="none"&&(F(Oe,this.zoom,fe),(Pe[Mt.id]=Mt.createBucket({index:ke.bucketLayerIDs.length,layers:Oe,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xn,sourceID:this.source})).populate(Ft,Ie,this.tileID.canonical),ke.bucketLayerIDs.push(Oe.map(Ce=>Ce.id)))}}let At,We,dt,Dt;const Rt=o.mapObject(Ie.glyphDependencies,qt=>Object.keys(qt).map(Number));Object.keys(Rt).length?a.send("getGlyphs",{uid:this.uid,stacks:Rt},(qt,an)=>{At||(At=qt,We=an,pn.call(this))}):We={};const sn=Object.keys(Ie.iconDependencies);sn.length?a.send("getImages",{icons:sn,source:this.source,tileID:this.tileID,type:"icons"},(qt,an)=>{At||(At=qt,dt=an,pn.call(this))}):dt={};const jt=Object.keys(Ie.patternDependencies);function pn(){if(At)return G(At);if(We&&dt&&Dt){const qt=new M(We),an=new o.ImageAtlas(dt,Dt);for(const xn in Pe){const Ft=Pe[xn];Ft instanceof o.SymbolBucket?(F(Ft.layers,this.zoom,fe),o.performSymbolLayout({bucket:Ft,glyphMap:We,glyphPositions:qt.positions,imageMap:dt,imagePositions:an.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ft.hasPattern&&(Ft instanceof o.LineBucket||Ft instanceof o.FillBucket||Ft instanceof o.FillExtrusionBucket)&&(F(Ft.layers,this.zoom,fe),Ft.addFeatures(Ie,this.tileID.canonical,an.patternPositions))}this.status="done",G(null,{buckets:Object.values(Pe).filter(xn=>!xn.isEmpty()),featureIndex:ke,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:qt.image,imageAtlas:an,glyphMap:this.returnDependencies?We:null,iconMap:this.returnDependencies?dt:null,glyphPositions:this.returnDependencies?qt.positions:null})}}jt.length?a.send("getImages",{icons:jt,source:this.source,tileID:this.tileID,type:"patterns"},(qt,an)=>{At||(At=qt,Dt=an,pn.call(this))}):Dt={},pn.call(this)}}function F(K,Q,te){const fe=new o.EvaluationParameters(Q);for(const a of K)a.recalculate(fe,te)}function H(K,Q){const te=o.getArrayBuffer(K.request,(fe,a,G,Le)=>{fe?Q(fe):a&&Q(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(a)),rawData:a,cacheControl:G,expires:Le})});return()=>{te.cancel(),Q()}}class j{constructor(Q,te,fe,a){this.actor=Q,this.layerIndex=te,this.availableImages=fe,this.loadVectorData=a||H,this.loading={},this.loaded={}}loadTile(Q,te){const fe=Q.uid;this.loading||(this.loading={});const a=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new o.RequestPerformance(Q.request),G=this.loading[fe]=new k(Q);G.abort=this.loadVectorData(Q,(Le,ke)=>{if(delete this.loading[fe],Le||!ke)return G.status="done",this.loaded[fe]=G,te(Le);const Pe=ke.rawData,Ie={};ke.expires&&(Ie.expires=ke.expires),ke.cacheControl&&(Ie.cacheControl=ke.cacheControl);const qe={};if(a){const At=a.finish();At&&(qe.resourceTiming=JSON.parse(JSON.stringify(At)))}G.vectorTile=ke.vectorTile,G.parse(ke.vectorTile,this.layerIndex,this.availableImages,this.actor,(At,We)=>{if(At||!We)return te(At);te(null,o.extend({rawTileData:Pe.slice(0)},We,Ie,qe))}),this.loaded=this.loaded||{},this.loaded[fe]=G})}reloadTile(Q,te){const fe=this.loaded,a=Q.uid,G=this;if(fe&&fe[a]){const Le=fe[a];Le.showCollisionBoxes=Q.showCollisionBoxes;const ke=(Pe,Ie)=>{const qe=Le.reloadCallback;qe&&(delete Le.reloadCallback,Le.parse(Le.vectorTile,G.layerIndex,this.availableImages,G.actor,qe)),te(Pe,Ie)};Le.status==="parsing"?Le.reloadCallback=ke:Le.status==="done"&&(Le.vectorTile?Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,ke):ke())}}abortTile(Q,te){const fe=this.loading,a=Q.uid;fe&&fe[a]&&fe[a].abort&&(fe[a].abort(),delete fe[a]),te()}removeTile(Q,te){const fe=this.loaded,a=Q.uid;fe&&fe[a]&&delete fe[a],te()}}class ie{constructor(){this.loaded={}}loadTile(Q,te){const{uid:fe,encoding:a,rawImageData:G}=Q,Le=o.isImageBitmap(G)?this.getImageData(G):G,ke=new o.DEMData(fe,Le,a);this.loaded=this.loaded||{},this.loaded[fe]=ke,te(null,ke)}getImageData(Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);const te=this.offscreenCanvasContext.getImageData(-1,-1,Q.width+2,Q.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:te.width,height:te.height},te.data)}removeTile(Q){const te=this.loaded,fe=Q.uid;te&&te[fe]&&delete te[fe]}}var Y=function K(Q,te){var fe,a=Q&&Q.type;if(a==="FeatureCollection")for(fe=0;fe<Q.features.length;fe++)K(Q.features[fe],te);else if(a==="GeometryCollection")for(fe=0;fe<Q.geometries.length;fe++)K(Q.geometries[fe],te);else if(a==="Feature")K(Q.geometry,te);else if(a==="Polygon")J(Q.coordinates,te);else if(a==="MultiPolygon")for(fe=0;fe<Q.coordinates.length;fe++)J(Q.coordinates[fe],te);return Q};function J(K,Q){if(K.length!==0){se(K[0],Q);for(var te=1;te<K.length;te++)se(K[te],!Q)}}function se(K,Q){for(var te=0,fe=0,a=0,G=K.length,Le=G-1;a<G;Le=a++){var ke=(K[a][0]-K[Le][0])*(K[Le][1]+K[a][1]),Pe=te+ke;fe+=Math.abs(te)>=Math.abs(ke)?te-Pe+ke:ke-Pe+te,te=Pe}te+fe>=0!=!!Q&&K.reverse()}const ce=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class me{constructor(Q){this._feature=Q,this.extent=o.EXTENT,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){const Q=[];for(const te of this._feature.geometry)Q.push([new o.pointGeometry(te[0],te[1])]);return Q}{const Q=[];for(const te of this._feature.geometry){const fe=[];for(const a of te)fe.push(new o.pointGeometry(a[0],a[1]));Q.push(fe)}return Q}}toGeoJSON(Q,te,fe){return ce.call(this,Q,te,fe)}}class Ee{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=Q.length,this._features=Q}feature(Q){return new me(this._features[Q])}}var He={exports:{}},Qe=o.pointGeometry,Ye=o.vectorTile.VectorTileFeature,nt=Fe;function Fe(K,Q){this.options=Q||{},this.features=K,this.length=K.length}function tt(K,Q){this.id=typeof K.id=="number"?K.id:void 0,this.type=K.type,this.rawGeometry=K.type===1?[K.geometry]:K.geometry,this.properties=K.tags,this.extent=Q||4096}Fe.prototype.feature=function(K){return new tt(this.features[K],this.options.extent)},tt.prototype.loadGeometry=function(){var K=this.rawGeometry;this.geometry=[];for(var Q=0;Q<K.length;Q++){for(var te=K[Q],fe=[],a=0;a<te.length;a++)fe.push(new Qe(te[a][0],te[a][1]));this.geometry.push(fe)}return this.geometry},tt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var K=this.geometry,Q=1/0,te=-1/0,fe=1/0,a=-1/0,G=0;G<K.length;G++)for(var Le=K[G],ke=0;ke<Le.length;ke++){var Pe=Le[ke];Q=Math.min(Q,Pe.x),te=Math.max(te,Pe.x),fe=Math.min(fe,Pe.y),a=Math.max(a,Pe.y)}return[Q,fe,te,a]},tt.prototype.toGeoJSON=Ye.prototype.toGeoJSON;var Ze=o.pbf,pt=nt;function Yt(K){var Q=new Ze;return function(te,fe){for(var a in te.layers)fe.writeMessage(3,Et,te.layers[a])}(K,Q),Q.finish()}function Et(K,Q){var te;Q.writeVarintField(15,K.version||1),Q.writeStringField(1,K.name||""),Q.writeVarintField(5,K.extent||4096);var fe={keys:[],values:[],keycache:{},valuecache:{}};for(te=0;te<K.length;te++)fe.feature=K.feature(te),Q.writeMessage(2,un,fe);var a=fe.keys;for(te=0;te<a.length;te++)Q.writeStringField(3,a[te]);var G=fe.values;for(te=0;te<G.length;te++)Q.writeMessage(4,Tn,G[te])}function un(K,Q){var te=K.feature;te.id!==void 0&&Q.writeVarintField(1,te.id),Q.writeMessage(2,_t,K),Q.writeVarintField(3,te.type),Q.writeMessage(4,In,te)}function _t(K,Q){var te=K.feature,fe=K.keys,a=K.values,G=K.keycache,Le=K.valuecache;for(var ke in te.properties){var Pe=te.properties[ke],Ie=G[ke];if(Pe!==null){Ie===void 0&&(fe.push(ke),G[ke]=Ie=fe.length-1),Q.writeVarint(Ie);var qe=typeof Pe;qe!=="string"&&qe!=="boolean"&&qe!=="number"&&(Pe=JSON.stringify(Pe));var At=qe+":"+Pe,We=Le[At];We===void 0&&(a.push(Pe),Le[At]=We=a.length-1),Q.writeVarint(We)}}}function Tt(K,Q){return(Q<<3)+(7&K)}function Jt(K){return K<<1^K>>31}function In(K,Q){for(var te=K.loadGeometry(),fe=K.type,a=0,G=0,Le=te.length,ke=0;ke<Le;ke++){var Pe=te[ke],Ie=1;fe===1&&(Ie=Pe.length),Q.writeVarint(Tt(1,Ie));for(var qe=fe===3?Pe.length-1:Pe.length,At=0;At<qe;At++){At===1&&fe!==1&&Q.writeVarint(Tt(2,qe-1));var We=Pe[At].x-a,dt=Pe[At].y-G;Q.writeVarint(Jt(We)),Q.writeVarint(Jt(dt)),a+=We,G+=dt}fe===3&&Q.writeVarint(Tt(7,1))}}function Tn(K,Q){var te=typeof K;te==="string"?Q.writeStringField(1,K):te==="boolean"?Q.writeBooleanField(7,K):te==="number"&&(K%1!=0?Q.writeDoubleField(3,K):K<0?Q.writeSVarintField(6,K):Q.writeVarintField(5,K))}function kr(K,Q,te,fe,a,G){if(a-fe<=te)return;const Le=fe+a>>1;er(K,Q,Le,fe,a,G%2),kr(K,Q,te,fe,Le-1,G+1),kr(K,Q,te,Le+1,a,G+1)}function er(K,Q,te,fe,a,G){for(;a>fe;){if(a-fe>600){const Ie=a-fe+1,qe=te-fe+1,At=Math.log(Ie),We=.5*Math.exp(2*At/3),dt=.5*Math.sqrt(At*We*(Ie-We)/Ie)*(qe-Ie/2<0?-1:1);er(K,Q,te,Math.max(fe,Math.floor(te-qe*We/Ie+dt)),Math.min(a,Math.floor(te+(Ie-qe)*We/Ie+dt)),G)}const Le=Q[2*te+G];let ke=fe,Pe=a;for(or(K,Q,fe,te),Q[2*a+G]>Le&&or(K,Q,fe,a);ke<Pe;){for(or(K,Q,ke,Pe),ke++,Pe--;Q[2*ke+G]<Le;)ke++;for(;Q[2*Pe+G]>Le;)Pe--}Q[2*fe+G]===Le?or(K,Q,fe,Pe):(Pe++,or(K,Q,Pe,a)),Pe<=te&&(fe=Pe+1),te<=Pe&&(a=Pe-1)}}function or(K,Q,te,fe){hr(K,te,fe),hr(Q,2*te,2*fe),hr(Q,2*te+1,2*fe+1)}function hr(K,Q,te){const fe=K[Q];K[Q]=K[te],K[te]=fe}function Un(K,Q,te,fe){const a=K-te,G=Q-fe;return a*a+G*G}He.exports=Yt,He.exports.fromVectorTileJs=Yt,He.exports.fromGeojsonVt=function(K,Q){Q=Q||{};var te={};for(var fe in K)te[fe]=new pt(K[fe].features,Q),te[fe].name=fe,te[fe].version=Q.version,te[fe].extent=Q.extent;return Yt({layers:te})},He.exports.GeoJSONWrapper=pt;const Cr=K=>K[0],wt=K=>K[1];class rn{constructor(Q,te=Cr,fe=wt,a=64,G=Float64Array){this.nodeSize=a,this.points=Q;const Le=Q.length<65536?Uint16Array:Uint32Array,ke=this.ids=new Le(Q.length),Pe=this.coords=new G(2*Q.length);for(let Ie=0;Ie<Q.length;Ie++)ke[Ie]=Ie,Pe[2*Ie]=te(Q[Ie]),Pe[2*Ie+1]=fe(Q[Ie]);kr(ke,Pe,a,0,ke.length-1,0)}range(Q,te,fe,a){return function(G,Le,ke,Pe,Ie,qe,At){const We=[0,G.length-1,0],dt=[];let Dt,Rt;for(;We.length;){const sn=We.pop(),jt=We.pop(),pn=We.pop();if(jt-pn<=At){for(let xn=pn;xn<=jt;xn++)Dt=Le[2*xn],Rt=Le[2*xn+1],Dt>=ke&&Dt<=Ie&&Rt>=Pe&&Rt<=qe&&dt.push(G[xn]);continue}const qt=Math.floor((pn+jt)/2);Dt=Le[2*qt],Rt=Le[2*qt+1],Dt>=ke&&Dt<=Ie&&Rt>=Pe&&Rt<=qe&&dt.push(G[qt]);const an=(sn+1)%2;(sn===0?ke<=Dt:Pe<=Rt)&&(We.push(pn),We.push(qt-1),We.push(an)),(sn===0?Ie>=Dt:qe>=Rt)&&(We.push(qt+1),We.push(jt),We.push(an))}return dt}(this.ids,this.coords,Q,te,fe,a,this.nodeSize)}within(Q,te,fe){return function(a,G,Le,ke,Pe,Ie){const qe=[0,a.length-1,0],At=[],We=Pe*Pe;for(;qe.length;){const dt=qe.pop(),Dt=qe.pop(),Rt=qe.pop();if(Dt-Rt<=Ie){for(let an=Rt;an<=Dt;an++)Un(G[2*an],G[2*an+1],Le,ke)<=We&&At.push(a[an]);continue}const sn=Math.floor((Rt+Dt)/2),jt=G[2*sn],pn=G[2*sn+1];Un(jt,pn,Le,ke)<=We&&At.push(a[sn]);const qt=(dt+1)%2;(dt===0?Le-Pe<=jt:ke-Pe<=pn)&&(qe.push(Rt),qe.push(sn-1),qe.push(qt)),(dt===0?Le+Pe>=jt:ke+Pe>=pn)&&(qe.push(sn+1),qe.push(Dt),qe.push(qt))}return At}(this.ids,this.coords,Q,te,fe,this.nodeSize)}}const Mn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:K=>K},xt=Math.fround||(tr=new Float32Array(1),K=>(tr[0]=+K,tr[0]));var tr;class Hn{constructor(Q){this.options=Gi(Object.create(Mn),Q),this.trees=new Array(this.options.maxZoom+1)}load(Q){const{log:te,minZoom:fe,maxZoom:a,nodeSize:G}=this.options;te&&console.time("total time");const Le=`prepare ${Q.length} points`;te&&console.time(Le),this.points=Q;let ke=[];for(let Pe=0;Pe<Q.length;Pe++)Q[Pe].geometry&&ke.push(lr(Q[Pe],Pe));this.trees[a+1]=new rn(ke,yo,jr,G,Float32Array),te&&console.timeEnd(Le);for(let Pe=a;Pe>=fe;Pe--){const Ie=+Date.now();ke=this._cluster(ke,Pe),this.trees[Pe]=new rn(ke,yo,jr,G,Float32Array),te&&console.log("z%d: %d clusters in %dms",Pe,ke.length,+Date.now()-Ie)}return te&&console.timeEnd("total time"),this}getClusters(Q,te){let fe=((Q[0]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,Q[1]));let G=Q[2]===180?180:((Q[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)fe=-180,G=180;else if(fe>G){const qe=this.getClusters([fe,a,180,Le],te),At=this.getClusters([-180,a,G,Le],te);return qe.concat(At)}const ke=this.trees[this._limitZoom(te)],Pe=ke.range(Vn(fe),ki(Le),Vn(G),ki(a)),Ie=[];for(const qe of Pe){const At=ke.points[qe];Ie.push(At.numPoints?nr(At):this.points[At.index])}return Ie}getChildren(Q){const te=this._getOriginId(Q),fe=this._getOriginZoom(Q),a="No cluster with the specified id.",G=this.trees[fe];if(!G)throw new Error(a);const Le=G.points[te];if(!Le)throw new Error(a);const ke=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),Pe=G.within(Le.x,Le.y,ke),Ie=[];for(const qe of Pe){const At=G.points[qe];At.parentId===Q&&Ie.push(At.numPoints?nr(At):this.points[At.index])}if(Ie.length===0)throw new Error(a);return Ie}getLeaves(Q,te,fe){const a=[];return this._appendLeaves(a,Q,te=te||10,fe=fe||0,0),a}getTile(Q,te,fe){const a=this.trees[this._limitZoom(Q)],G=Math.pow(2,Q),{extent:Le,radius:ke}=this.options,Pe=ke/Le,Ie=(fe-Pe)/G,qe=(fe+1+Pe)/G,At={features:[]};return this._addTileFeatures(a.range((te-Pe)/G,Ie,(te+1+Pe)/G,qe),a.points,te,fe,G,At),te===0&&this._addTileFeatures(a.range(1-Pe/G,Ie,1,qe),a.points,G,fe,G,At),te===G-1&&this._addTileFeatures(a.range(0,Ie,Pe/G,qe),a.points,-1,fe,G,At),At.features.length?At:null}getClusterExpansionZoom(Q){let te=this._getOriginZoom(Q)-1;for(;te<=this.options.maxZoom;){const fe=this.getChildren(Q);if(te++,fe.length!==1)break;Q=fe[0].properties.cluster_id}return te}_appendLeaves(Q,te,fe,a,G){const Le=this.getChildren(te);for(const ke of Le){const Pe=ke.properties;if(Pe&&Pe.cluster?G+Pe.point_count<=a?G+=Pe.point_count:G=this._appendLeaves(Q,Pe.cluster_id,fe,a,G):G<a?G++:Q.push(ke),Q.length===fe)break}return G}_addTileFeatures(Q,te,fe,a,G,Le){for(const ke of Q){const Pe=te[ke],Ie=Pe.numPoints;let qe,At,We;if(Ie)qe=ri(Pe),At=Pe.x,We=Pe.y;else{const Rt=this.points[Pe.index];qe=Rt.properties,At=Vn(Rt.geometry.coordinates[0]),We=ki(Rt.geometry.coordinates[1])}const dt={type:1,geometry:[[Math.round(this.options.extent*(At*G-fe)),Math.round(this.options.extent*(We*G-a))]],tags:qe};let Dt;Ie?Dt=Pe.id:this.options.generateId?Dt=Pe.index:this.points[Pe.index].id&&(Dt=this.points[Pe.index].id),Dt!==void 0&&(dt.id=Dt),Le.features.push(dt)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,te){const fe=[],{radius:a,extent:G,reduce:Le,minPoints:ke}=this.options,Pe=a/(G*Math.pow(2,te));for(let Ie=0;Ie<Q.length;Ie++){const qe=Q[Ie];if(qe.zoom<=te)continue;qe.zoom=te;const At=this.trees[te+1],We=At.within(qe.x,qe.y,Pe),dt=qe.numPoints||1;let Dt=dt;for(const Rt of We){const sn=At.points[Rt];sn.zoom>te&&(Dt+=sn.numPoints||1)}if(Dt>dt&&Dt>=ke){let Rt=qe.x*dt,sn=qe.y*dt,jt=Le&&dt>1?this._map(qe,!0):null;const pn=(Ie<<5)+(te+1)+this.points.length;for(const qt of We){const an=At.points[qt];if(an.zoom<=te)continue;an.zoom=te;const xn=an.numPoints||1;Rt+=an.x*xn,sn+=an.y*xn,an.parentId=pn,Le&&(jt||(jt=this._map(qe,!0)),Le(jt,this._map(an)))}qe.parentId=pn,fe.push(xr(Rt/Dt,sn/Dt,pn,Dt,jt))}else if(fe.push(qe),Dt>1)for(const Rt of We){const sn=At.points[Rt];sn.zoom<=te||(sn.zoom=te,fe.push(sn))}}return fe}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,te){if(Q.numPoints)return te?Gi({},Q.properties):Q.properties;const fe=this.points[Q.index].properties,a=this.options.map(fe);return te&&a===fe?Gi({},a):a}}function xr(K,Q,te,fe,a){return{x:xt(K),y:xt(Q),zoom:1/0,id:te,parentId:-1,numPoints:fe,properties:a}}function lr(K,Q){const[te,fe]=K.geometry.coordinates;return{x:xt(Vn(te)),y:xt(ki(fe)),zoom:1/0,index:Q,parentId:-1}}function nr(K){return{type:"Feature",id:K.id,properties:ri(K),geometry:{type:"Point",coordinates:[(Q=K.x,360*(Q-.5)),Qn(K.y)]}};var Q}function ri(K){const Q=K.numPoints,te=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q;return Gi(Gi({},K.properties),{cluster:!0,cluster_id:K.id,point_count:Q,point_count_abbreviated:te})}function Vn(K){return K/360+.5}function ki(K){const Q=Math.sin(K*Math.PI/180),te=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return te<0?0:te>1?1:te}function Qn(K){const Q=(180-360*K)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function Gi(K,Q){for(const te in Q)K[te]=Q[te];return K}function yo(K){return K.x}function jr(K){return K.y}function Ii(K,Q,te,fe){for(var a,G=fe,Le=te-Q>>1,ke=te-Q,Pe=K[Q],Ie=K[Q+1],qe=K[te],At=K[te+1],We=Q+3;We<te;We+=3){var dt=$o(K[We],K[We+1],Pe,Ie,qe,At);if(dt>G)a=We,G=dt;else if(dt===G){var Dt=Math.abs(We-Le);Dt<ke&&(a=We,ke=Dt)}}G>fe&&(a-Q>3&&Ii(K,Q,a,fe),K[a+2]=G,te-a>3&&Ii(K,a,te,fe))}function $o(K,Q,te,fe,a,G){var Le=a-te,ke=G-fe;if(Le!==0||ke!==0){var Pe=((K-te)*Le+(Q-fe)*ke)/(Le*Le+ke*ke);Pe>1?(te=a,fe=G):Pe>0&&(te+=Le*Pe,fe+=ke*Pe)}return(Le=K-te)*Le+(ke=Q-fe)*ke}function ls(K,Q,te,fe){var a={id:K===void 0?null:K,type:Q,geometry:te,tags:fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(G){var Le=G.geometry,ke=G.type;if(ke==="Point"||ke==="MultiPoint"||ke==="LineString")ht(G,Le);else if(ke==="Polygon"||ke==="MultiLineString")for(var Pe=0;Pe<Le.length;Pe++)ht(G,Le[Pe]);else if(ke==="MultiPolygon")for(Pe=0;Pe<Le.length;Pe++)for(var Ie=0;Ie<Le[Pe].length;Ie++)ht(G,Le[Pe][Ie])}(a),a}function ht(K,Q){for(var te=0;te<Q.length;te+=3)K.minX=Math.min(K.minX,Q[te]),K.minY=Math.min(K.minY,Q[te+1]),K.maxX=Math.max(K.maxX,Q[te]),K.maxY=Math.max(K.maxY,Q[te+1])}function It(K,Q,te,fe){if(Q.geometry){var a=Q.geometry.coordinates,G=Q.geometry.type,Le=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2),ke=[],Pe=Q.id;if(te.promoteId?Pe=Q.properties[te.promoteId]:te.generateId&&(Pe=fe||0),G==="Point")Us(a,ke);else if(G==="MultiPoint")for(var Ie=0;Ie<a.length;Ie++)Us(a[Ie],ke);else if(G==="LineString")bi(a,ke,Le,!1);else if(G==="MultiLineString"){if(te.lineMetrics){for(Ie=0;Ie<a.length;Ie++)bi(a[Ie],ke=[],Le,!1),K.push(ls(Pe,"LineString",ke,Q.properties));return}Bn(a,ke,Le,!1)}else if(G==="Polygon")Bn(a,ke,Le,!0);else{if(G!=="MultiPolygon"){if(G==="GeometryCollection"){for(Ie=0;Ie<Q.geometry.geometries.length;Ie++)It(K,{id:Pe,geometry:Q.geometry.geometries[Ie],properties:Q.properties},te,fe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ie=0;Ie<a.length;Ie++){var qe=[];Bn(a[Ie],qe,Le,!0),ke.push(qe)}}K.push(ls(Pe,G,ke,Q.properties))}}function Us(K,Q){Q.push($i(K[0])),Q.push(Li(K[1])),Q.push(0)}function bi(K,Q,te,fe){for(var a,G,Le=0,ke=0;ke<K.length;ke++){var Pe=$i(K[ke][0]),Ie=Li(K[ke][1]);Q.push(Pe),Q.push(Ie),Q.push(0),ke>0&&(Le+=fe?(a*Ie-Pe*G)/2:Math.sqrt(Math.pow(Pe-a,2)+Math.pow(Ie-G,2))),a=Pe,G=Ie}var qe=Q.length-3;Q[2]=1,Ii(Q,0,qe,te),Q[qe+2]=1,Q.size=Math.abs(Le),Q.start=0,Q.end=Q.size}function Bn(K,Q,te,fe){for(var a=0;a<K.length;a++){var G=[];bi(K[a],G,te,fe),Q.push(G)}}function $i(K){return K/360+.5}function Li(K){var Q=Math.sin(K*Math.PI/180),te=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return te<0?0:te>1?1:te}function Di(K,Q,te,fe,a,G,Le,ke){if(fe/=Q,G>=(te/=Q)&&Le<fe)return K;if(Le<te||G>=fe)return null;for(var Pe=[],Ie=0;Ie<K.length;Ie++){var qe=K[Ie],At=qe.geometry,We=qe.type,dt=a===0?qe.minX:qe.minY,Dt=a===0?qe.maxX:qe.maxY;if(dt>=te&&Dt<fe)Pe.push(qe);else if(!(Dt<te||dt>=fe)){var Rt=[];if(We==="Point"||We==="MultiPoint")As(At,Rt,te,fe,a);else if(We==="LineString")Lt(At,Rt,te,fe,a,!1,ke.lineMetrics);else if(We==="MultiLineString")bn(At,Rt,te,fe,a,!1);else if(We==="Polygon")bn(At,Rt,te,fe,a,!0);else if(We==="MultiPolygon")for(var sn=0;sn<At.length;sn++){var jt=[];bn(At[sn],jt,te,fe,a,!0),jt.length&&Rt.push(jt)}if(Rt.length){if(ke.lineMetrics&&We==="LineString"){for(sn=0;sn<Rt.length;sn++)Pe.push(ls(qe.id,We,Rt[sn],qe.tags));continue}We!=="LineString"&&We!=="MultiLineString"||(Rt.length===1?(We="LineString",Rt=Rt[0]):We="MultiLineString"),We!=="Point"&&We!=="MultiPoint"||(We=Rt.length===3?"Point":"MultiPoint"),Pe.push(ls(qe.id,We,Rt,qe.tags))}}}return Pe.length?Pe:null}function As(K,Q,te,fe,a){for(var G=0;G<K.length;G+=3){var Le=K[G+a];Le>=te&&Le<=fe&&(Q.push(K[G]),Q.push(K[G+1]),Q.push(K[G+2]))}}function Lt(K,Q,te,fe,a,G,Le){for(var ke,Pe,Ie=Sn(K),qe=a===0?Ts:yn,At=K.start,We=0;We<K.length-3;We+=3){var dt=K[We],Dt=K[We+1],Rt=K[We+2],sn=K[We+3],jt=K[We+4],pn=a===0?dt:Dt,qt=a===0?sn:jt,an=!1;Le&&(ke=Math.sqrt(Math.pow(dt-sn,2)+Math.pow(Dt-jt,2))),pn<te?qt>te&&(Pe=qe(Ie,dt,Dt,sn,jt,te),Le&&(Ie.start=At+ke*Pe)):pn>fe?qt<fe&&(Pe=qe(Ie,dt,Dt,sn,jt,fe),Le&&(Ie.start=At+ke*Pe)):Rr(Ie,dt,Dt,Rt),qt<te&&pn>=te&&(Pe=qe(Ie,dt,Dt,sn,jt,te),an=!0),qt>fe&&pn<=fe&&(Pe=qe(Ie,dt,Dt,sn,jt,fe),an=!0),!G&&an&&(Le&&(Ie.end=At+ke*Pe),Q.push(Ie),Ie=Sn(K)),Le&&(At+=ke)}var xn=K.length-3;dt=K[xn],Dt=K[xn+1],Rt=K[xn+2],(pn=a===0?dt:Dt)>=te&&pn<=fe&&Rr(Ie,dt,Dt,Rt),xn=Ie.length-3,G&&xn>=3&&(Ie[xn]!==Ie[0]||Ie[xn+1]!==Ie[1])&&Rr(Ie,Ie[0],Ie[1],Ie[2]),Ie.length&&Q.push(Ie)}function Sn(K){var Q=[];return Q.size=K.size,Q.start=K.start,Q.end=K.end,Q}function bn(K,Q,te,fe,a,G){for(var Le=0;Le<K.length;Le++)Lt(K[Le],Q,te,fe,a,G,!1)}function Rr(K,Q,te,fe){K.push(Q),K.push(te),K.push(fe)}function Ts(K,Q,te,fe,a,G){var Le=(G-Q)/(fe-Q);return K.push(G),K.push(te+(a-te)*Le),K.push(1),Le}function yn(K,Q,te,fe,a,G){var Le=(G-te)/(a-te);return K.push(Q+(fe-Q)*Le),K.push(G),K.push(1),Le}function Xe(K,Q){for(var te=[],fe=0;fe<K.length;fe++){var a,G=K[fe],Le=G.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")a=Zr(G.geometry,Q);else if(Le==="MultiLineString"||Le==="Polygon"){a=[];for(var ke=0;ke<G.geometry.length;ke++)a.push(Zr(G.geometry[ke],Q))}else if(Le==="MultiPolygon")for(a=[],ke=0;ke<G.geometry.length;ke++){for(var Pe=[],Ie=0;Ie<G.geometry[ke].length;Ie++)Pe.push(Zr(G.geometry[ke][Ie],Q));a.push(Pe)}te.push(ls(G.id,Le,a,G.tags))}return te}function Zr(K,Q){var te=[];te.size=K.size,K.start!==void 0&&(te.start=K.start,te.end=K.end);for(var fe=0;fe<K.length;fe+=3)te.push(K[fe]+Q,K[fe+1],K[fe+2]);return te}function Vs(K,Q){if(K.transformed)return K;var te,fe,a,G=1<<K.z,Le=K.x,ke=K.y;for(te=0;te<K.features.length;te++){var Pe=K.features[te],Ie=Pe.geometry,qe=Pe.type;if(Pe.geometry=[],qe===1)for(fe=0;fe<Ie.length;fe+=2)Pe.geometry.push(Fr(Ie[fe],Ie[fe+1],Q,G,Le,ke));else for(fe=0;fe<Ie.length;fe++){var At=[];for(a=0;a<Ie[fe].length;a+=2)At.push(Fr(Ie[fe][a],Ie[fe][a+1],Q,G,Le,ke));Pe.geometry.push(At)}}return K.transformed=!0,K}function Fr(K,Q,te,fe,a,G){return[Math.round(te*(K*fe-a)),Math.round(te*(Q*fe-G))]}function ci(K,Q,te,fe,a){for(var G=Q===a.maxZoom?0:a.tolerance/((1<<Q)*a.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:te,y:fe,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ke=0;ke<K.length;ke++){Le.numFeatures++,Yn(Le,K[ke],G,a);var Pe=K[ke].minX,Ie=K[ke].minY,qe=K[ke].maxX,At=K[ke].maxY;Pe<Le.minX&&(Le.minX=Pe),Ie<Le.minY&&(Le.minY=Ie),qe>Le.maxX&&(Le.maxX=qe),At>Le.maxY&&(Le.maxY=At)}return Le}function Yn(K,Q,te,fe){var a=Q.geometry,G=Q.type,Le=[];if(G==="Point"||G==="MultiPoint")for(var ke=0;ke<a.length;ke+=3)Le.push(a[ke]),Le.push(a[ke+1]),K.numPoints++,K.numSimplified++;else if(G==="LineString")Gs(Le,a,K,te,!1,!1);else if(G==="MultiLineString"||G==="Polygon")for(ke=0;ke<a.length;ke++)Gs(Le,a[ke],K,te,G==="Polygon",ke===0);else if(G==="MultiPolygon")for(var Pe=0;Pe<a.length;Pe++){var Ie=a[Pe];for(ke=0;ke<Ie.length;ke++)Gs(Le,Ie[ke],K,te,!0,ke===0)}if(Le.length){var qe=Q.tags||null;if(G==="LineString"&&fe.lineMetrics){for(var At in qe={},Q.tags)qe[At]=Q.tags[At];qe.mapbox_clip_start=a.start/a.size,qe.mapbox_clip_end=a.end/a.size}var We={geometry:Le,type:G==="Polygon"||G==="MultiPolygon"?3:G==="LineString"||G==="MultiLineString"?2:1,tags:qe};Q.id!==null&&(We.id=Q.id),K.features.push(We)}}function Gs(K,Q,te,fe,a,G){var Le=fe*fe;if(fe>0&&Q.size<(a?Le:fe))te.numPoints+=Q.length/3;else{for(var ke=[],Pe=0;Pe<Q.length;Pe+=3)(fe===0||Q[Pe+2]>Le)&&(te.numSimplified++,ke.push(Q[Pe]),ke.push(Q[Pe+1])),te.numPoints++;a&&function(Ie,qe){for(var At=0,We=0,dt=Ie.length,Dt=dt-2;We<dt;Dt=We,We+=2)At+=(Ie[We]-Ie[Dt])*(Ie[We+1]+Ie[Dt+1]);if(At>0===qe)for(We=0,dt=Ie.length;We<dt/2;We+=2){var Rt=Ie[We],sn=Ie[We+1];Ie[We]=Ie[dt-2-We],Ie[We+1]=Ie[dt-1-We],Ie[dt-2-We]=Rt,Ie[dt-1-We]=sn}}(ke,G),K.push(ke)}}function ji(K,Q){var te=(Q=this.options=function(a,G){for(var Le in G)a[Le]=G[Le];return a}(Object.create(this.options),Q)).debug;if(te&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");var fe=function(a,G){var Le=[];if(a.type==="FeatureCollection")for(var ke=0;ke<a.features.length;ke++)It(Le,a.features[ke],G,ke);else It(Le,a.type==="Feature"?a:{geometry:a},G);return Le}(K,Q);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=function(a,G){var Le=G.buffer/G.extent,ke=a,Pe=Di(a,1,-1-Le,Le,0,-1,2,G),Ie=Di(a,1,1-Le,2+Le,0,-1,2,G);return(Pe||Ie)&&(ke=Di(a,1,-Le,1+Le,0,-1,2,G)||[],Pe&&(ke=Xe(Pe,1).concat(ke)),Ie&&(ke=ke.concat(Xe(Ie,-1)))),ke}(fe,Q),fe.length&&this.splitTile(fe,0,0,0),te&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Hi(K,Q,te){return 32*((1<<K)*te+Q)+K}function Ri(K,Q){const te=K.tileID.canonical;if(!this._geoJSONIndex)return Q(null,null);const fe=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!fe)return Q(null,null);const a=new Ee(fe.features);let G=He.exports(a);G.byteOffset===0&&G.byteLength===G.buffer.byteLength||(G=new Uint8Array(G)),Q(null,{vectorTile:a,rawData:G.buffer})}ji.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ji.prototype.splitTile=function(K,Q,te,fe,a,G,Le){for(var ke=[K,Q,te,fe],Pe=this.options,Ie=Pe.debug;ke.length;){fe=ke.pop(),te=ke.pop(),Q=ke.pop(),K=ke.pop();var qe=1<<Q,At=Hi(Q,te,fe),We=this.tiles[At];if(!We&&(Ie>1&&console.time("creation"),We=this.tiles[At]=ci(K,Q,te,fe,Pe),this.tileCoords.push({z:Q,x:te,y:fe}),Ie)){Ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,te,fe,We.numFeatures,We.numPoints,We.numSimplified),console.timeEnd("creation"));var dt="z"+Q;this.stats[dt]=(this.stats[dt]||0)+1,this.total++}if(We.source=K,a){if(Q===Pe.maxZoom||Q===a)continue;var Dt=1<<a-Q;if(te!==Math.floor(G/Dt)||fe!==Math.floor(Le/Dt))continue}else if(Q===Pe.indexMaxZoom||We.numPoints<=Pe.indexMaxPoints)continue;if(We.source=null,K.length!==0){Ie>1&&console.time("clipping");var Rt,sn,jt,pn,qt,an,xn=.5*Pe.buffer/Pe.extent,Ft=.5-xn,Oe=.5+xn,Mt=1+xn;Rt=sn=jt=pn=null,qt=Di(K,qe,te-xn,te+Oe,0,We.minX,We.maxX,Pe),an=Di(K,qe,te+Ft,te+Mt,0,We.minX,We.maxX,Pe),K=null,qt&&(Rt=Di(qt,qe,fe-xn,fe+Oe,1,We.minY,We.maxY,Pe),sn=Di(qt,qe,fe+Ft,fe+Mt,1,We.minY,We.maxY,Pe),qt=null),an&&(jt=Di(an,qe,fe-xn,fe+Oe,1,We.minY,We.maxY,Pe),pn=Di(an,qe,fe+Ft,fe+Mt,1,We.minY,We.maxY,Pe),an=null),Ie>1&&console.timeEnd("clipping"),ke.push(Rt||[],Q+1,2*te,2*fe),ke.push(sn||[],Q+1,2*te,2*fe+1),ke.push(jt||[],Q+1,2*te+1,2*fe),ke.push(pn||[],Q+1,2*te+1,2*fe+1)}}},ji.prototype.getTile=function(K,Q,te){var fe=this.options,a=fe.extent,G=fe.debug;if(K<0||K>24)return null;var Le=1<<K,ke=Hi(K,Q=(Q%Le+Le)%Le,te);if(this.tiles[ke])return Vs(this.tiles[ke],a);G>1&&console.log("drilling down to z%d-%d-%d",K,Q,te);for(var Pe,Ie=K,qe=Q,At=te;!Pe&&Ie>0;)Ie--,qe=Math.floor(qe/2),At=Math.floor(At/2),Pe=this.tiles[Hi(Ie,qe,At)];return Pe&&Pe.source?(G>1&&console.log("found parent tile z%d-%d-%d",Ie,qe,At),G>1&&console.time("drilling down"),this.splitTile(Pe.source,Ie,qe,At,K,Q,te),G>1&&console.timeEnd("drilling down"),this.tiles[ke]?Vs(this.tiles[ke],a):null):null};class us extends j{constructor(Q,te,fe,a){super(Q,te,fe,Ri),a&&(this.loadGeoJSON=a)}loadData(Q,te){var fe;(fe=this._pendingRequest)===null||fe===void 0||fe.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const a=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new o.RequestPerformance(Q.request);this._pendingCallback=te,this._pendingRequest=this.loadGeoJSON(Q,(G,Le)=>{if(delete this._pendingCallback,delete this._pendingRequest,G||!Le)return te(G);if(typeof Le!="object")return te(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));{Y(Le,!0);try{if(Q.filter){const Pe=o.createExpression(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pe.result==="error")throw new Error(Pe.value.map(qe=>`${qe.key}: ${qe.message}`).join(", "));Le={type:"FeatureCollection",features:Le.features.filter(qe=>Pe.value.evaluate({zoom:0},qe))}}this._geoJSONIndex=Q.cluster?new Hn(function({superclusterOptions:Pe,clusterProperties:Ie}){if(!Ie||!Pe)return Pe;const qe={},At={},We={accumulated:null,zoom:0},dt={properties:null},Dt=Object.keys(Ie);for(const Rt of Dt){const[sn,jt]=Ie[Rt],pn=o.createExpression(jt),qt=o.createExpression(typeof sn=="string"?[sn,["accumulated"],["get",Rt]]:sn);qe[Rt]=pn.value,At[Rt]=qt.value}return Pe.map=Rt=>{dt.properties=Rt;const sn={};for(const jt of Dt)sn[jt]=qe[jt].evaluate(We,dt);return sn},Pe.reduce=(Rt,sn)=>{dt.properties=sn;for(const jt of Dt)We.accumulated=Rt[jt],Rt[jt]=At[jt].evaluate(We,dt)},Pe}(Q)).load(Le.features):function(Pe,Ie){return new ji(Pe,Ie)}(Le,Q.geojsonVtOptions)}catch(Pe){return te(Pe)}this.loaded={};const ke={};if(a){const Pe=a.finish();Pe&&(ke.resourceTiming={},ke.resourceTiming[Q.source]=JSON.parse(JSON.stringify(Pe)))}te(null,ke)}})}reloadTile(Q,te){const fe=this.loaded;return fe&&fe[Q.uid]?super.reloadTile(Q,te):this.loadTile(Q,te)}loadGeoJSON(Q,te){if(Q.request)return o.getJSON(Q.request,te);if(typeof Q.data=="string")try{te(null,JSON.parse(Q.data))}catch{te(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`))}else te(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(Q,te){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),te()}getClusterExpansionZoom(Q,te){try{te(null,this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId))}catch(fe){te(fe)}}getClusterChildren(Q,te){try{te(null,this._geoJSONIndex.getChildren(Q.clusterId))}catch(fe){te(fe)}}getClusterLeaves(Q,te){try{te(null,this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset))}catch(fe){te(fe)}}}class Nr{constructor(Q){this.self=Q,this.actor=new o.Actor(Q,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:j,geojson:us},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(te,fe)=>{if(this.workerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.workerSourceTypes[te]=fe},this.self.registerRTLTextPlugin=te=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=te.applyArabicShaping,o.plugin.processBidirectionalText=te.processBidirectionalText,o.plugin.processStyledBidirectionalText=te.processStyledBidirectionalText}}setReferrer(Q,te){this.referrer=te}setImages(Q,te,fe){this.availableImages[Q]=te;for(const a in this.workerSources[Q]){const G=this.workerSources[Q][a];for(const Le in G)G[Le].availableImages=te}fe()}setLayers(Q,te,fe){this.getLayerIndex(Q).replace(te),fe()}updateLayers(Q,te,fe){this.getLayerIndex(Q).update(te.layers,te.removedIds),fe()}loadTile(Q,te,fe){this.getWorkerSource(Q,te.type,te.source).loadTile(te,fe)}loadDEMTile(Q,te,fe){this.getDEMWorkerSource(Q,te.source).loadTile(te,fe)}reloadTile(Q,te,fe){this.getWorkerSource(Q,te.type,te.source).reloadTile(te,fe)}abortTile(Q,te,fe){this.getWorkerSource(Q,te.type,te.source).abortTile(te,fe)}removeTile(Q,te,fe){this.getWorkerSource(Q,te.type,te.source).removeTile(te,fe)}removeDEMTile(Q,te){this.getDEMWorkerSource(Q,te.source).removeTile(te)}removeSource(Q,te,fe){if(!this.workerSources[Q]||!this.workerSources[Q][te.type]||!this.workerSources[Q][te.type][te.source])return;const a=this.workerSources[Q][te.type][te.source];delete this.workerSources[Q][te.type][te.source],a.removeSource!==void 0?a.removeSource(te,fe):fe()}loadWorkerSource(Q,te,fe){try{this.self.importScripts(te.url),fe()}catch(a){fe(a.toString())}}syncRTLPluginState(Q,te,fe){try{o.plugin.setState(te);const a=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&a!=null){this.self.importScripts(a);const G=o.plugin.isParsed();fe(G?void 0:new Error(`RTL Text Plugin failed to import scripts from ${a}`),G)}}catch(a){fe(a.toString())}}getAvailableImages(Q){let te=this.availableImages[Q];return te||(te=[]),te}getLayerIndex(Q){let te=this.layerIndexes[Q];return te||(te=this.layerIndexes[Q]=new S),te}getWorkerSource(Q,te,fe){if(this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][te]||(this.workerSources[Q][te]={}),!this.workerSources[Q][te][fe]){const a={send:(G,Le,ke)=>{this.actor.send(G,Le,ke,Q)}};this.workerSources[Q][te][fe]=new this.workerSourceTypes[te](a,this.getLayerIndex(Q),this.getAvailableImages(Q))}return this.workerSources[Q][te][fe]}getDEMWorkerSource(Q,te){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][te]||(this.demWorkerSources[Q][te]=new ie),this.demWorkerSources[Q][te]}enforceCacheSizeLimit(Q,te){o.enforceCacheSizeLimit(te)}}return o.isWorker()&&(self.worker=new Nr(self)),Nr}),s(["./shared"],function(o){var p=v;function v(L){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,h,d=new Blob([""],{type:"text/javascript"}),w=URL.createObjectURL(d);try{h=new Worker(w),A=!0}catch{A=!1}return h&&h.terminate(),URL.revokeObjectURL(w),A}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var A=document.createElement("canvas");A.width=A.height=1;var h=A.getContext("2d");if(!h)return!1;var d=h.getImageData(0,0,1,1);return d&&d.width===A.width}()?(S[_=c&&c.failIfMajorPerformanceCaveat]===void 0&&(S[_]=function(A){var h,d=function(w){var b=document.createElement("canvas"),C=Object.create(v.webGLContextAttributes);return C.failIfMajorPerformanceCaveat=w,b.getContext("webgl",C)||b.getContext("experimental-webgl",C)}(A);if(!d)return!1;try{h=d.createShader(d.VERTEX_SHADER)}catch{return!1}return!(!h||d.isContextLost())&&(d.shaderSource(h,"void main() {}"),d.compileShader(h),d.getShaderParameter(h,d.COMPILE_STATUS)===!0)}(_)),S[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}(L)}var S={};function M(L,c){if(Array.isArray(L)){if(!Array.isArray(c)||L.length!==c.length)return!1;for(let _=0;_<L.length;_++)if(!M(L[_],c[_]))return!1;return!0}if(typeof L=="object"&&L!==null&&c!==null){if(typeof c!="object"||Object.keys(L).length!==Object.keys(c).length)return!1;for(const _ in L)if(!M(L[_],c[_]))return!1;return!0}return L===c}v.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class k{static testProp(c){if(!k.docStyle)return c[0];for(let _=0;_<c.length;_++)if(c[_]in k.docStyle)return c[_];return c[0]}static create(c,_,A){const h=window.document.createElement(c);return _!==void 0&&(h.className=_),A&&A.appendChild(h),h}static createNS(c,_){return window.document.createElementNS(c,_)}static disableDrag(){k.docStyle&&k.selectProp&&(k.userSelect=k.docStyle[k.selectProp],k.docStyle[k.selectProp]="none")}static enableDrag(){k.docStyle&&k.selectProp&&(k.docStyle[k.selectProp]=k.userSelect)}static setTransform(c,_){c.style[k.transformProp]=_}static addEventListener(c,_,A,h={}){c.addEventListener(_,A,"passive"in h?h:h.capture)}static removeEventListener(c,_,A,h={}){c.removeEventListener(_,A,"passive"in h?h:h.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",k.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",k.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",k.suppressClickInternal,!0)},0)}static mousePos(c,_){const A=c.getBoundingClientRect();return new o.pointGeometry(_.clientX-A.left-c.clientLeft,_.clientY-A.top-c.clientTop)}static touchPos(c,_){const A=c.getBoundingClientRect(),h=[];for(let d=0;d<_.length;d++)h.push(new o.pointGeometry(_[d].clientX-A.left-c.clientLeft,_[d].clientY-A.top-c.clientTop));return h}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}}k.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,k.selectProp=k.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),k.transformProp=k.testProp(["transform","WebkitTransform"]);class F{constructor(c){this._transformRequestFn=c}transformRequest(c,_){return this._transformRequestFn&&this._transformRequestFn(c,_)||{url:c}}normalizeSpriteURL(c,_,A){const h=function(d){const w=d.match(H);if(!w)throw new Error(`Unable to parse URL "${d}"`);return{protocol:w[1],authority:w[2],path:w[3]||"/",params:w[4]?w[4].split("&"):[]}}(c);return h.path+=`${_}${A}`,function(d){const w=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${w}`}(h)}setTransformRequest(c){this._transformRequestFn=c}}const H=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class j{constructor(c,_,A,h){this.context=c,this.format=A,this.texture=c.gl.createTexture(),this.update(_,h)}update(c,_,A){const{width:h,height:d}=c,w=!(this.size&&this.size[0]===h&&this.size[1]===d||A),{context:b}=this,{gl:C}=b;if(this.useMipmap=!!(_&&_.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!_||_.premultiply!==!1)),w)this.size=[h,d],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,c):C.texImage2D(C.TEXTURE_2D,0,this.format,h,d,0,this.format,C.UNSIGNED_BYTE,c.data);else{const{x:P,y:B}=A||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?C.texSubImage2D(C.TEXTURE_2D,0,P,B,C.RGBA,C.UNSIGNED_BYTE,c):C.texSubImage2D(C.TEXTURE_2D,0,P,B,h,d,C.RGBA,C.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D)}bind(c,_,A){const{context:h}=this,{gl:d}=h;d.bindTexture(d.TEXTURE_2D,this.texture),A!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(A=d.LINEAR),c!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,A||c),this.filter=c),_!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,_),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,_),this.wrap=_)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}function ie(L){const{userImage:c}=L;return!!(c&&c.render&&c.render())&&(L.data.replace(new Uint8Array(c.data.buffer)),!0)}class Y extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:_,callback:A}of this.requestors)this._notify(_,A);this.requestors=[]}}getImage(c){return this.images[c]}addImage(c,_){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,_)&&(this.images[c]=_)}_validate(c,_){let A=!0;return this._validateStretch(_.stretchX,_.data&&_.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),A=!1),this._validateStretch(_.stretchY,_.data&&_.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),A=!1),this._validateContent(_.content,_)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),A=!1),A}_validateStretch(c,_){if(!c)return!0;let A=0;for(const h of c){if(h[0]<A||h[1]<h[0]||_<h[1])return!1;A=h[1]}return!0}_validateContent(c,_){return!(c&&(c.length!==4||c[0]<0||_.data.width<c[0]||c[1]<0||_.data.height<c[1]||c[2]<0||_.data.width<c[2]||c[3]<0||_.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,_){const A=this.images[c];if(A.data.width!==_.data.width||A.data.height!==_.data.height)throw new Error(`size mismatch between old image (${A.data.width}x${A.data.height}) and new image (${_.data.width}x${_.data.height}).`);_.version=A.version+1,this.images[c]=_,this.updatedImages[c]=!0}removeImage(c){const _=this.images[c];delete this.images[c],delete this.patterns[c],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,_){let A=!0;if(!this.isLoaded())for(const h of c)this.images[h]||(A=!1);this.isLoaded()||A?this._notify(c,_):this.requestors.push({ids:c,callback:_})}_notify(c,_){const A={};for(const h of c){this.images[h]||this.fire(new o.Event("styleimagemissing",{id:h}));const d=this.images[h];d?A[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:o.warnOnce(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}_(null,A)}getPixelSize(){const{width:c,height:_}=this.atlasImage;return{width:c,height:_}}getPattern(c){const _=this.patterns[c],A=this.getImage(c);if(!A)return null;if(_&&_.position.version===A.version)return _.position;if(_)_.position.version=A.version;else{const h={w:A.data.width+2,h:A.data.height+2,x:0,y:0},d=new o.ImagePosition(h,A);this.patterns[c]={bin:h,position:d}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const _=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new j(c,this.atlasImage,_.RGBA),this.atlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const d in this.patterns)c.push(this.patterns[d].bin);const{w:_,h:A}=o.potpack(c),h=this.atlasImage;h.resize({width:_||1,height:A||1});for(const d in this.patterns){const{bin:w}=this.patterns[d],b=w.x+1,C=w.y+1,P=this.images[d].data,B=P.width,V=P.height;o.RGBAImage.copy(P,h,{x:0,y:0},{x:b,y:C},{width:B,height:V}),o.RGBAImage.copy(P,h,{x:0,y:V-1},{x:b,y:C-1},{width:B,height:1}),o.RGBAImage.copy(P,h,{x:0,y:0},{x:b,y:C+V},{width:B,height:1}),o.RGBAImage.copy(P,h,{x:B-1,y:0},{x:b-1,y:C},{width:1,height:V}),o.RGBAImage.copy(P,h,{x:0,y:0},{x:b+B,y:C},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const _ of c){if(this.callbackDispatchedThisFrame[_])continue;this.callbackDispatchedThisFrame[_]=!0;const A=this.images[_];A||o.warnOnce(`Image with ID: "${_}" was not found`),ie(A)&&this.updateImage(_,A)}}}const J=1e20;function se(L,c,_,A,h,d,w,b,C){for(let P=c;P<c+A;P++)ce(L,_*d+P,d,h,w,b,C);for(let P=_;P<_+h;P++)ce(L,P*d+c,1,A,w,b,C)}function ce(L,c,_,A,h,d,w){d[0]=0,w[0]=-J,w[1]=J,h[0]=L[c];for(let b=1,C=0,P=0;b<A;b++){h[b]=L[c+b*_];const B=b*b;do{const V=d[C];P=(h[b]-h[V]+B-V*V)/(b-V)/2}while(P<=w[C]&&--C>-1);C++,d[C]=b,w[C]=P,w[C+1]=J}for(let b=0,C=0;b<A;b++){for(;w[C+1]<b;)C++;const P=d[C],B=b-P;L[c+b*_]=h[P]+B*B}}class me{constructor(c,_){this.requestManager=c,this.localIdeographFontFamily=_,this.entries={}}setURL(c){this.url=c}getGlyphs(c,_){const A=[];for(const h in c)for(const d of c[h])A.push({stack:h,id:d});o.asyncAll(A,({stack:h,id:d},w)=>{let b=this.entries[h];b||(b=this.entries[h]={glyphs:{},requests:{},ranges:{}});let C=b.glyphs[d];if(C!==void 0)return void w(null,{stack:h,id:d,glyph:C});if(C=this._tinySDF(b,h,d),C)return b.glyphs[d]=C,void w(null,{stack:h,id:d,glyph:C});const P=Math.floor(d/256);if(256*P>65535)return void w(new Error("glyphs > 65535 not supported"));if(b.ranges[P])return void w(null,{stack:h,id:d,glyph:C});let B=b.requests[P];B||(B=b.requests[P]=[],me.loadGlyphRange(h,P,this.url,this.requestManager,(V,W)=>{if(W){for(const X in W)this._doesCharSupportLocalGlyph(+X)||(b.glyphs[+X]=W[+X]);b.ranges[P]=!0}for(const X of B)X(V,W);delete b.requests[P]})),B.push((V,W)=>{V?w(V):W&&w(null,{stack:h,id:d,glyph:W[d]||null})})},(h,d)=>{if(h)_(h);else if(d){const w={};for(const{stack:b,id:C,glyph:P}of d)(w[b]||(w[b]={}))[C]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};_(null,w)}})}_doesCharSupportLocalGlyph(c){return!!this.localIdeographFontFamily&&(o.unicodeBlockLookup["CJK Unified Ideographs"](c)||o.unicodeBlockLookup["Hangul Syllables"](c)||o.unicodeBlockLookup.Hiragana(c)||o.unicodeBlockLookup.Katakana(c))}_tinySDF(c,_,A){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(A))return;let d=c.tinySDF;if(!d){let b="400";/bold/i.test(_)?b="900":/medium/i.test(_)?b="500":/light/i.test(_)&&(b="200"),d=c.tinySDF=new me.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:h,fontWeight:b})}const w=d.draw(String.fromCharCode(A));return{id:A,bitmap:new o.AlphaImage({width:w.width||30,height:w.height||30},w.data),metrics:{width:w.glyphWidth||24,height:w.glyphHeight||24,left:w.glyphLeft||0,top:w.glyphTop-27||-8,advance:w.glyphAdvance||24}}}}me.loadGlyphRange=function(L,c,_,A,h){const d=256*c,w=d+255,b=A.transformRequest(_.replace("{fontstack}",L).replace("{range}",`${d}-${w}`),o.ResourceType.Glyphs);o.getArrayBuffer(b,(C,P)=>{if(C)h(C);else if(P){const B={};for(const V of o.parseGlyphPbf(P))B[V.id]=V;h(null,B)}})},me.TinySDF=class{constructor({fontSize:L=24,buffer:c=3,radius:_=8,cutoff:A=.25,fontFamily:h="sans-serif",fontWeight:d="normal",fontStyle:w="normal"}={}){this.buffer=c,this.cutoff=A,this.radius=_;const b=this.size=L+4*c,C=this._createCanvas(b),P=this.ctx=C.getContext("2d",{willReadFrequently:!0});P.font=`${w} ${d} ${L}px ${h}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(L){const c=document.createElement("canvas");return c.width=c.height=L,c}draw(L){const{width:c,actualBoundingBoxAscent:_,actualBoundingBoxDescent:A,actualBoundingBoxLeft:h,actualBoundingBoxRight:d}=this.ctx.measureText(L),w=Math.ceil(_),b=Math.min(this.size-this.buffer,Math.ceil(d-h)),C=Math.min(this.size-this.buffer,w+Math.ceil(A)),P=b+2*this.buffer,B=C+2*this.buffer,V=Math.max(P*B,0),W=new Uint8ClampedArray(V),X={data:W,width:P,height:B,glyphWidth:b,glyphHeight:C,glyphTop:w,glyphLeft:0,glyphAdvance:c};if(b===0||C===0)return X;const{ctx:ae,buffer:ne,gridInner:ue,gridOuter:be}=this;ae.clearRect(ne,ne,b,C),ae.fillText(L,ne,ne+w);const Me=ae.getImageData(ne,ne,b,C);be.fill(J,0,V),ue.fill(0,0,V);for(let ve=0;ve<C;ve++)for(let $e=0;$e<b;$e++){const Se=Me.data[4*(ve*b+$e)+3]/255;if(Se===0)continue;const Ge=(ve+ne)*P+$e+ne;if(Se===1)be[Ge]=0,ue[Ge]=J;else{const xe=.5-Se;be[Ge]=xe>0?xe*xe:0,ue[Ge]=xe<0?xe*xe:0}}se(be,0,0,P,B,P,this.f,this.v,this.z),se(ue,ne,ne,b,C,P,this.f,this.v,this.z);for(let ve=0;ve<V;ve++){const $e=Math.sqrt(be[ve])-Math.sqrt(ue[ve]);W[ve]=Math.round(255-255*($e/this.radius+this.cutoff))}return X}};const Ee=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(L,c){return o.sphericalToCartesian(L.expression.evaluate(c))}interpolate(L,c,_){return{x:o.number(L.x,c.x,_),y:o.number(L.y,c.y,_),z:o.number(L.z,c.z,_)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),He="-transition";class Qe extends o.Evented{constructor(c){super(),this._transitionable=new o.Transitionable(Ee),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,_={}){if(!this._validate(o.validateLight,c,_))for(const A in c){const h=c[A];A.endsWith(He)?this._transitionable.setTransition(A.slice(0,-He.length),h):this._transitionable.setValue(A,h)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,_,A){return(!A||A.validate!==!1)&&o.emitValidationErrors(this,c.call(o.validateStyle,o.extend({value:_,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Ye{constructor(c,_){this.width=c,this.height=_,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,_){const A=c.join(",")+String(_);return this.dashEntry[A]||(this.dashEntry[A]=this.addDash(c,_)),this.dashEntry[A]}getDashRanges(c,_,A){const h=[];let d=c.length%2==1?-c[c.length-1]*A:0,w=c[0]*A,b=!0;h.push({left:d,right:w,isDash:b,zeroLength:c[0]===0});let C=c[0];for(let P=1;P<c.length;P++){b=!b;const B=c[P];d=C*A,C+=B,w=C*A,h.push({left:d,right:w,isDash:b,zeroLength:B===0})}return h}addRoundDash(c,_,A){const h=_/2;for(let d=-A;d<=A;d++){const w=this.width*(this.nextRow+A+d);let b=0,C=c[b];for(let P=0;P<this.width;P++){P/C.right>1&&(C=c[++b]);const B=Math.abs(P-C.left),V=Math.abs(P-C.right),W=Math.min(B,V);let X;const ae=d/A*(h+1);if(C.isDash){const ne=h-Math.abs(ae);X=Math.sqrt(W*W+ne*ne)}else X=h-Math.sqrt(W*W+ae*ae);this.data[w+P]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(c){for(let b=c.length-1;b>=0;--b){const C=c[b],P=c[b+1];C.zeroLength?c.splice(b,1):P&&P.isDash===C.isDash&&(P.left=C.left,c.splice(b,1))}const _=c[0],A=c[c.length-1];_.isDash===A.isDash&&(_.left=A.left-this.width,A.right=_.right+this.width);const h=this.width*this.nextRow;let d=0,w=c[d];for(let b=0;b<this.width;b++){b/w.right>1&&(w=c[++d]);const C=Math.abs(b-w.left),P=Math.abs(b-w.right),B=Math.min(C,P);this.data[h+b]=Math.max(0,Math.min(255,(w.isDash?B:-B)+128))}}addDash(c,_){const A=_?7:0,h=2*A+1;if(this.nextRow+h>this.height)return o.warnOnce("LineAtlas out of space"),null;let d=0;for(let b=0;b<c.length;b++)d+=c[b];if(d!==0){const b=this.width/d,C=this.getDashRanges(c,this.width,b);_?this.addRoundDash(C,b,A):this.addRegularDash(C)}const w={y:(this.nextRow+A+.5)/this.height,height:2*A/this.height,width:d};return this.nextRow+=h,this.dirty=!0,w}bind(c){const _=c.gl;this.texture?(_.bindTexture(_.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,_.texSubImage2D(_.TEXTURE_2D,0,0,0,this.width,this.height,_.ALPHA,_.UNSIGNED_BYTE,this.data))):(this.texture=_.createTexture(),_.bindTexture(_.TEXTURE_2D,this.texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_2D,0,_.ALPHA,this.width,this.height,0,_.ALPHA,_.UNSIGNED_BYTE,this.data))}}class nt{constructor(c,_){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const A=this.workerPool.acquire(this.id);for(let h=0;h<A.length;h++){const d=new nt.Actor(A[h],_,this.id);d.name=`Worker ${h}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,_,A){o.asyncAll(this.actors,(h,d)=>{h.send(c,_,d)},A=A||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Fe(L,c,_){const A=function(h,d){if(h)return _(h);if(d){const w=o.pick(o.extend(d,L),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);d.vector_layers&&(w.vectorLayers=d.vector_layers,w.vectorLayerIds=w.vectorLayers.map(b=>b.id)),_(null,w)}};return L.url?o.getJSON(c.transformRequest(L.url,o.ResourceType.Source),A):o.exported.frame(()=>A(null,L))}nt.Actor=o.Actor;class tt{constructor(c,_,A){this.bounds=o.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=_||0,this.maxzoom=A||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const _=Math.pow(2,c.z),A=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*_),h=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*_),d=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*_),w=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*_);return c.x>=A&&c.x<d&&c.y>=h&&c.y<w}}class Ze extends o.Evented{constructor(c,_,A,h){if(super(),this.id=c,this.dispatcher=A,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(_,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},_),this._collectResourceTiming=_.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Fe(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),c?this.fire(new o.ErrorEvent(c)):_&&(o.extend(this,_),_.bounds&&(this.tileBounds=new tt(_.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(c,_){const A=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(A,o.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function d(w,b){return delete c.request,c.aborted?_(null):w&&w.status!==404?_(w):(b&&b.resourceTiming&&(c.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&c.setExpiryData(b),c.loadVectorData(b,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),_(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}h.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired"?c.state==="loading"?c.reloadCallback=_:c.request=c.actor.send("reloadTile",h,d.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",h,d.bind(this)))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class pt extends o.Evented{constructor(c,_,A,h){super(),this.id=c,this.dispatcher=A,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},_),o.extend(this,o.pick(_,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Fe(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new o.ErrorEvent(c)):_&&(o.extend(this,_),_.bounds&&(this.tileBounds=new tt(_.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,_){const A=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.request=o.getImage(this.map._requestManager.transformRequest(A,o.ResourceType.Tile),(h,d,w)=>{if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(h)c.state="errored",_(h);else if(d){this.map._refreshExpiredTiles&&c.setExpiryData(w);const b=this.map.painter.context,C=b.gl;c.texture=this.map.painter.getTileTexture(d.width),c.texture?c.texture.update(d,{useMipmap:!0}):(c.texture=new j(b,d,C.RGBA,{useMipmap:!0}),c.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE,C.LINEAR_MIPMAP_NEAREST),b.extTextureFilterAnisotropic&&C.texParameterf(C.TEXTURE_2D,b.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,b.extTextureFilterAnisotropicMax)),c.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),_(null)}})}abortTile(c,_){c.request&&(c.request.cancel(),delete c.request),_()}unloadTile(c,_){c.texture&&this.map.painter.saveTileTexture(c.texture),_()}hasTransition(){return!1}}let Yt;class Et extends pt{constructor(c,_,A,h){super(c,_,A,h),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},_),this.encoding=_.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(c,_){const A=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function h(d,w){d&&(c.state="errored",_(d)),w&&(c.dem=w,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded",_(null))}c.request=o.getImage(this.map._requestManager.transformRequest(A,o.ResourceType.Tile),function(d,w){if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(d)c.state="errored",_(d);else if(w){this.map._refreshExpiredTiles&&c.setExpiryData(w),delete w.cacheControl,delete w.expires;const b=o.isImageBitmap(w)&&(Yt==null&&(Yt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Yt)?w:o.exported.getImageData(w,1),C={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:b,encoding:this.encoding};c.actor&&c.state!=="expired"||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",C,h.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)}_getNeighboringTiles(c){const _=c.canonical,A=Math.pow(2,_.z),h=(_.x-1+A)%A,d=_.x===0?c.wrap-1:c.wrap,w=(_.x+1+A)%A,b=_.x+1===A?c.wrap+1:c.wrap,C={};return C[new o.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y).key]={backfilled:!1},C[new o.OverscaledTileID(c.overscaledZ,b,_.z,w,_.y).key]={backfilled:!1},_.y>0&&(C[new o.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y-1).key]={backfilled:!1},C[new o.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y-1).key]={backfilled:!1},C[new o.OverscaledTileID(c.overscaledZ,b,_.z,w,_.y-1).key]={backfilled:!1}),_.y+1<A&&(C[new o.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y+1).key]={backfilled:!1},C[new o.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y+1).key]={backfilled:!1},C[new o.OverscaledTileID(c.overscaledZ,b,_.z,w,_.y+1).key]={backfilled:!1}),C}unloadTile(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})}}class un extends o.Evented{constructor(c,_,A,h){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=A.getActor(),this.setEventedParent(h),this._data=_.data,this._options=o.extend({},_),this._collectResourceTiming=_.collectResourceTiming,_.maxzoom!==void 0&&(this.maxzoom=_.maxzoom),_.type&&(this.type=_.type),_.attribution&&(this.attribution=_.attribution),this.promoteId=_.promoteId;const d=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:_.cluster||!1,geojsonVtOptions:{buffer:(_.buffer!==void 0?_.buffer:128)*d,tolerance:(_.tolerance!==void 0?_.tolerance:.375)*d,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:_.lineMetrics||!1,generateId:_.generateId||!1},superclusterOptions:{maxZoom:_.clusterMaxZoom!==void 0?_.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,_.clusterMinPoints||2),extent:o.EXTENT,radius:(_.clusterRadius||50)*d,log:!1,generateId:_.generateId||!1},clusterProperties:_.clusterProperties,filter:_.filter},_.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(c){this.map=c,this.load()}setData(c){return this._data=c,this._updateWorkerData("content"),this}getClusterExpansionZoom(c,_){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},_),this}getClusterChildren(c,_){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},_),this}getClusterLeaves(c,_,A,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:_,offset:A},h),this}_updateWorkerData(c){const _=o.extend({},this.workerOptions),A=this._data;typeof A=="string"?(_.request=this.map._requestManager.transformRequest(o.exported.resolveURL(A),o.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(A),this._pendingLoads++,this.fire(new o.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,_,(h,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new o.Event("dataabort",{dataType:"source",sourceDataType:c}));let w=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(w=d.resourceTiming[this.id].slice(0)),h)return void this.fire(new o.ErrorEvent(h));const b={dataType:"source",sourceDataType:c};this._collectResourceTiming&&w&&w.length>0&&o.extend(b,{resourceTiming:w}),this.fire(new o.Event("data",b))})}loaded(){return this._pendingLoads===0}loadTile(c,_){const A=c.actor?"reloadTile":"loadTile";c.actor=this.actor;const h={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request=this.actor.send(A,h,(d,w)=>(delete c.request,c.unloadVectorData(),c.aborted?_(null):d?_(d):(c.loadVectorData(w,this.map.painter,A==="reloadTile"),_(null))))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0}unloadTile(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var _t=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Tt extends o.Evented{constructor(c,_,A,h){super(),this.id=c,this.dispatcher=A,this.coordinates=_.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=_}load(c,_){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(A,h)=>{this._loaded=!0,A?this.fire(new o.ErrorEvent(A)):h&&(this.image=h,c&&(this.coordinates=c),_&&_(),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}setCoordinates(c){this.coordinates=c;const _=c.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(h){let d=1/0,w=1/0,b=-1/0,C=-1/0;for(const W of h)d=Math.min(d,W.x),w=Math.min(w,W.y),b=Math.max(b,W.x),C=Math.max(C,W.y);const P=Math.max(b-d,C-w),B=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),V=Math.pow(2,B);return new o.CanonicalTileID(B,Math.floor((d+b)/2*V),Math.floor((w+C)/2*V))}(_),this.minzoom=this.maxzoom=this.tileID.z;const A=_.map(h=>this.tileID.getTilePoint(h)._round());return this._boundsArray=new o.RasterBoundsArray,this._boundsArray.emplaceBack(A[0].x,A[0].y,0,0),this._boundsArray.emplaceBack(A[1].x,A[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(A[3].x,A[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(A[2].x,A[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new j(c,this.image,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const A in this.tiles){const h=this.tiles[A];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}loadTile(c,_){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},_(null)):(c.state="errored",_(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Jt extends Tt{constructor(c,_,A,h){super(c,_,A,h),this.roundZoom=!0,this.type="video",this.options=_}load(){this._loaded=!1;const c=this.options;this.urls=[];for(const _ of c.urls)this.urls.push(this.map._requestManager.transformRequest(_,o.ResourceType.Source).url);o.getVideo(this.urls,(_,A)=>{this._loaded=!0,_?this.fire(new o.ErrorEvent(_)):A&&(this.video=A,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const _=this.video.seekable;c<_.start(0)||c>_.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${_.start(0)} and ${_.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE),_.texSubImage2D(_.TEXTURE_2D,0,0,0,_.RGBA,_.UNSIGNED_BYTE,this.video)):(this.texture=new j(c,this.video,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const A in this.tiles){const h=this.tiles[A];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class In extends Tt{constructor(c,_,A,h){super(c,_,A,h),_.coordinates?Array.isArray(_.coordinates)&&_.coordinates.length===4&&!_.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(w=>typeof w!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "coordinates"'))),_.animate&&typeof _.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),_.canvas?typeof _.canvas=="string"||_.canvas instanceof HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "canvas"'))),this.options=_,this.animate=_.animate===void 0||_.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const _=this.map.painter.context,A=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new j(_,this.canvas,A.RGBA,{premultiply:!0});for(const h in this.tiles){const d=this.tiles[h];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}const Tn={vector:Ze,raster:pt,"raster-dem":Et,geojson:un,video:Jt,image:Tt,canvas:In};function kr(L,c){const _=o.create();return o.translate(_,_,[1,1,0]),o.scale(_,_,[.5*L.width,.5*L.height,1]),o.multiply(_,_,L.calculatePosMatrix(c.toUnwrapped()))}function er(L,c,_,A,h,d){const w=function(V,W,X){if(V)for(const ae of V){const ne=W[ae];if(ne&&ne.source===X&&ne.type==="fill-extrusion")return!0}else for(const ae in W){const ne=W[ae];if(ne.source===X&&ne.type==="fill-extrusion")return!0}return!1}(h&&h.layers,c,L.id),b=d.maxPitchScaleFactor(),C=L.tilesIn(A,b,w);C.sort(or);const P=[];for(const V of C)P.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(c,_,L._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,h,d,b,kr(L.transform,V.tileID))});const B=function(V){const W={},X={};for(const ae of V){const ne=ae.queryResults,ue=ae.wrappedTileID,be=X[ue]=X[ue]||{};for(const Me in ne){const ve=ne[Me],$e=be[Me]=be[Me]||{},Se=W[Me]=W[Me]||[];for(const Ge of ve)$e[Ge.featureIndex]||($e[Ge.featureIndex]=!0,Se.push(Ge))}}return W}(P);for(const V in B)B[V].forEach(W=>{const X=W.feature,ae=L.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=ae});return B}function or(L,c){const _=L.tileID,A=c.tileID;return _.overscaledZ-A.overscaledZ||_.canonical.y-A.canonical.y||_.wrap-A.wrap||_.canonical.x-A.canonical.x}class hr{constructor(c,_){this.tileID=c,this.uid=o.uniqueId(),this.uses=0,this.tileSize=_,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(c){const _=c+this.timeAdded;_<o.exported.now()||this.fadeEndTime&&_<this.fadeEndTime||(this.fadeEndTime=_)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.textures.forEach(_=>c.saveTileTexture(_)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(c,_,A){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(h,d){const w={};if(!d)return w;for(const b of h){const C=b.layerIds.map(P=>d.getLayer(P)).filter(Boolean);if(C.length!==0){b.layers=C,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(P=>C.filter(B=>B.id===P)[0]));for(const P of C)w[P.id]=b}}return w}(c.buckets,_.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const d=this.buckets[h];if(d instanceof o.SymbolBucket){if(this.hasSymbolBuckets=!0,!A)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const d=this.buckets[h];if(d instanceof o.SymbolBucket&&d.hasRTLText){this.hasRTLText=!0,o.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const h in this.buckets){const d=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,_.style.getLayer(h).queryRadius(d))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new o.CollisionBoxArray}unloadVectorData(){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(const A in this.buckets){const h=this.buckets[A];h.uploadPending()&&h.upload(c)}const _=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new j(c,this.imageAtlas.image,_.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new j(c,this.glyphAtlasImage,_.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,_,A,h,d,w,b,C,P,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:d,scale:w,tileSize:this.tileSize,pixelPosMatrix:B,transform:C,params:b,queryPadding:this.queryPadding*P},c,_,A):{}}querySourceFeatures(c,_){const A=this.latestFeatureIndex;if(!A||!A.rawTileData)return;const h=A.loadVTLayers(),d=_?_.sourceLayer:"",w=h._geojsonTileLayer||h[d];if(!w)return;const b=o.createFilter(_&&_.filter),{z:C,x:P,y:B}=this.tileID.canonical,V={z:C,x:P,y:B};for(let W=0;W<w.length;W++){const X=w.feature(W);if(b.needGeometry){const ue=o.toEvaluationFeature(X,!0);if(!b.filter(new o.EvaluationParameters(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!b.filter(new o.EvaluationParameters(this.tileID.overscaledZ),X))continue;const ae=A.getId(X,d),ne=new o.GeoJSONFeature(X,C,P,B,ae);ne.tile=V,c.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const _=this.expirationTime;if(c.cacheControl){const A=o.parseCacheControl(c.cacheControl);A["max-age"]&&(this.expirationTime=Date.now()+1e3*A["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const A=Date.now();let h=!1;if(this.expirationTime>A)h=!1;else if(_)if(this.expirationTime<_)h=!0;else{const d=this.expirationTime-_;d?this.expirationTime=A+Math.max(d,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,_){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;const A=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!_.style.hasLayer(h))continue;const d=this.buckets[h],w=d.layers[0].sourceLayer||"_geojsonTileLayer",b=A[w],C=c[w];if(!b||!C||Object.keys(C).length===0)continue;d.update(C,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const P=_&&_.style&&_.style.getLayer(h);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=o.exported.now()+c}setDependencies(c,_){const A={};for(const h of _)A[h]=!0;this.dependencies[c]=A}hasDependency(c,_){for(const A of c){const h=this.dependencies[A];if(h){for(const d of _)if(h[d])return!0}}return!1}}class Un{constructor(c,_){this.max=c,this.onRemove=_,this.reset()}reset(){for(const c in this.data)for(const _ of this.data[c])_.timeout&&clearTimeout(_.timeout),this.onRemove(_.value);return this.data={},this.order=[],this}add(c,_,A){const h=c.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const d={value:_,timeout:void 0};if(A!==void 0&&(d.timeout=setTimeout(()=>{this.remove(c,d)},A)),this.data[h].push(d),this.order.push(h),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const _=this.data[c].shift();return _.timeout&&clearTimeout(_.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),_.value}getByKey(c){const _=this.data[c];return _?_[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,_){if(!this.has(c))return this;const A=c.wrapped().key,h=_===void 0?0:this.data[A].indexOf(_),d=this.data[A][h];return this.data[A].splice(h,1),d.timeout&&clearTimeout(d.timeout),this.data[A].length===0&&delete this.data[A],this.onRemove(d.value),this.order.splice(this.order.indexOf(A),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}filter(c){const _=[];for(const A in this.data)for(const h of this.data[A])c(h.value)||_.push(h);for(const A of _)this.remove(A.value.tileID,A)}}class Cr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,_,A){const h=String(_);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][h]=this.stateChanges[c][h]||{},o.extend(this.stateChanges[c][h],A),this.deletedStates[c]===null){this.deletedStates[c]={};for(const d in this.state[c])d!==h&&(this.deletedStates[c][d]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][h]===null){this.deletedStates[c][h]={};for(const d in this.state[c][h])A[d]||(this.deletedStates[c][h][d]=null)}else for(const d in A)this.deletedStates[c]&&this.deletedStates[c][h]&&this.deletedStates[c][h][d]===null&&delete this.deletedStates[c][h][d]}removeFeatureState(c,_,A){if(this.deletedStates[c]===null)return;const h=String(_);if(this.deletedStates[c]=this.deletedStates[c]||{},A&&_!==void 0)this.deletedStates[c][h]!==null&&(this.deletedStates[c][h]=this.deletedStates[c][h]||{},this.deletedStates[c][h][A]=null);else if(_!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][h])for(A in this.deletedStates[c][h]={},this.stateChanges[c][h])this.deletedStates[c][h][A]=null;else this.deletedStates[c][h]=null;else this.deletedStates[c]=null}getState(c,_){const A=String(_),h=o.extend({},(this.state[c]||{})[A],(this.stateChanges[c]||{})[A]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const d=this.deletedStates[c][_];if(d===null)return{};for(const w in d)delete h[w]}return h}initializeTileState(c,_){c.setFeatureState(this.state,_)}coalesceChanges(c,_){const A={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const d={};for(const w in this.stateChanges[h])this.state[h][w]||(this.state[h][w]={}),o.extend(this.state[h][w],this.stateChanges[h][w]),d[w]=this.state[h][w];A[h]=d}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const d={};if(this.deletedStates[h]===null)for(const w in this.state[h])d[w]={},this.state[h][w]={};else for(const w in this.deletedStates[h]){if(this.deletedStates[h][w]===null)this.state[h][w]={};else for(const b of Object.keys(this.deletedStates[h][w]))delete this.state[h][w][b];d[w]=this.state[h][w]}A[h]=A[h]||{},o.extend(A[h],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(A).length!==0)for(const h in c)c[h].setFeatureState(A,_)}}class wt extends o.Evented{constructor(c,_,A){super(),this.id=c,this.dispatcher=A,this.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(h,d,w,b){const C=new Tn[d.type](h,d,w,b);if(C.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${C.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],C),C}(c,_,A,this),this._tiles={},this._cache=new Un(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Cr}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles){const _=this._tiles[c];if(_.state!=="loaded"&&_.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,_){return this._source.loadTile(c,_)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){this._source.abortTile&&this._source.abortTile(c,()=>{}),this._source.fire(new o.Event("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const _ in this._tiles){const A=this._tiles[_];A.upload(c),A.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(rn).map(c=>c.key)}getRenderableIds(c){const _=[];for(const A in this._tiles)this._isIdRenderable(A,c)&&_.push(this._tiles[A]);return c?_.sort((A,h)=>{const d=A.tileID,w=h.tileID,b=new o.pointGeometry(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),C=new o.pointGeometry(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-w.overscaledZ||C.y-b.y||C.x-b.x}).map(A=>A.tileID.key):_.map(A=>A.tileID).sort(rn).map(A=>A.key)}hasRenderableParent(c){const _=this.findLoadedParent(c,0);return!!_&&this._isIdRenderable(_.tileID.key)}_isIdRenderable(c,_){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(_||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(c,_){const A=this._tiles[c];A&&(A.state!=="loading"&&(A.state=_),this._loadTile(A,this._tileLoaded.bind(this,A,c,_)))}_tileLoaded(c,_,A,h){if(h)return c.state="errored",void(h.status!==404?this._source.fire(new o.ErrorEvent(h,{tile:c})):this.update(this.transform,this.terrain));c.timeAdded=o.exported.now(),A==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(_,c),this.getSource().type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new o.Event("data",{dataType:"source",tile:c,coord:c.tileID}))}_backfillDEM(c){const _=this.getRenderableIds();for(let h=0;h<_.length;h++){const d=_[h];if(c.neighboringTiles&&c.neighboringTiles[d]){const w=this.getTileByID(d);A(c,w),A(w,c)}}function A(h,d){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let w=d.tileID.canonical.x-h.tileID.canonical.x;const b=d.tileID.canonical.y-h.tileID.canonical.y,C=Math.pow(2,h.tileID.canonical.z),P=d.tileID.key;w===0&&b===0||Math.abs(b)>1||(Math.abs(w)>1&&(Math.abs(w+C)===1?w+=C:Math.abs(w-C)===1&&(w-=C)),d.dem&&h.dem&&(h.dem.backfillBorder(d.dem,w,b),h.neighboringTiles&&h.neighboringTiles[P]&&(h.neighboringTiles[P].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,_,A,h){for(const d in this._tiles){let w=this._tiles[d];if(h[d]||!w.hasData()||w.tileID.overscaledZ<=_||w.tileID.overscaledZ>A)continue;let b=w.tileID;for(;w&&w.tileID.overscaledZ>_+1;){const P=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[P.key],w&&w.hasData()&&(b=P)}let C=b;for(;C.overscaledZ>_;)if(C=C.scaledTo(C.overscaledZ-1),c[C.key]){h[b.key]=b;break}}}findLoadedParent(c,_){if(c.key in this._loadedParentTiles){const A=this._loadedParentTiles[c.key];return A&&A.tileID.overscaledZ>=_?A:null}for(let A=c.overscaledZ-1;A>=_;A--){const h=c.scaledTo(A),d=this._getLoadedTile(h);if(d)return d}}_getLoadedTile(c){const _=this._tiles[c.key];return _&&_.hasData()?_:this._cache.getByKey(c.wrapped().key)}updateCacheSize(c){const _=Math.ceil(c.width/this._source.tileSize)+1,A=Math.ceil(c.height/this._source.tileSize)+1,h=Math.floor(_*A*5),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(d)}handleWrapJump(c){const _=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,_){const A={};for(const h in this._tiles){const d=this._tiles[h];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+_),A[d.tileID.key]=d}this._tiles=A;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}update(c,_){if(this.transform=c,this.terrain=_,!this._sourceLoaded||this._paused)return;let A;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?A=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(P=>new o.OverscaledTileID(P.canonical.z,P.wrap,P.canonical.z,P.canonical.x,P.canonical.y)):(A=c.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:_}),this._source.hasTile&&(A=A.filter(P=>this._source.hasTile(P)))):A=[];const h=c.coveringZoomLevel(this._source),d=Math.max(h-wt.maxOverzooming,this._source.minzoom),w=Math.max(h+wt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const P={};for(const B of A)if(B.canonical.z>this._source.minzoom){const V=B.scaledTo(B.canonical.z-1);P[V.key]=V;const W=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));P[W.key]=W}A=A.concat(Object.values(P))}const b=this._updateRetainedTiles(A,h);if(Mn(this._source.type)){const P={},B={},V=Object.keys(b);for(const W of V){const X=b[W],ae=this._tiles[W];if(!ae||ae.fadeEndTime&&ae.fadeEndTime<=o.exported.now())continue;const ne=this.findLoadedParent(X,d);ne&&(this._addTile(ne.tileID),P[ne.tileID.key]=ne.tileID),B[W]=X}this._retainLoadedChildren(B,h,w,b);for(const W in P)b[W]||(this._coveredTiles[W]=!0,b[W]=P[W]);if(_){const W={},X={};for(const ae of A)this._tiles[ae.key].hasData()?W[ae.key]=ae:X[ae.key]=ae;for(const ae in X){const ne=X[ae].children(this._source.maxzoom);this._tiles[ne[0].key]&&this._tiles[ne[1].key]&&this._tiles[ne[2].key]&&this._tiles[ne[3].key]&&(W[ne[0].key]=b[ne[0].key]=ne[0],W[ne[1].key]=b[ne[1].key]=ne[1],W[ne[2].key]=b[ne[2].key]=ne[2],W[ne[3].key]=b[ne[3].key]=ne[3],delete X[ae])}for(const ae in X){const ne=this.findLoadedParent(X[ae],this._source.minzoom);if(ne){W[ne.tileID.key]=b[ne.tileID.key]=ne.tileID;for(const ue in W)W[ue].isChildOf(ne.tileID)&&delete W[ue]}}for(const ae in this._tiles)W[ae]||(this._coveredTiles[ae]=!0)}}for(const P in b)this._tiles[P].clearFadeHold();const C=o.keysDifference(this._tiles,b);for(const P of C){const B=this._tiles[P];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(P)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)}_updateRetainedTiles(c,_){const A={},h={},d=Math.max(_-wt.maxOverzooming,this._source.minzoom),w=Math.max(_+wt.maxUnderzooming,this._source.minzoom),b={};for(const C of c){const P=this._addTile(C);A[C.key]=C,P.hasData()||_<this._source.maxzoom&&(b[C.key]=C)}this._retainLoadedChildren(b,_,w,A);for(const C of c){let P=this._tiles[C.key];if(P.hasData())continue;if(_+1>this._source.maxzoom){const V=C.children(this._source.maxzoom)[0],W=this.getTile(V);if(W&&W.hasData()){A[V.key]=V;continue}}else{const V=C.children(this._source.maxzoom);if(A[V[0].key]&&A[V[1].key]&&A[V[2].key]&&A[V[3].key])continue}let B=P.wasRequested();for(let V=C.overscaledZ-1;V>=d;--V){const W=C.scaledTo(V);if(h[W.key]||(h[W.key]=!0,P=this.getTile(W),!P&&B&&(P=this._addTile(W)),P&&(A[W.key]=W,B=P.wasRequested(),P.hasData())))break}}return A}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const _=[];let A,h=this._tiles[c].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){A=this._loadedParentTiles[h.key];break}_.push(h.key);const d=h.scaledTo(h.overscaledZ-1);if(A=this._getLoadedTile(d),A)break;h=d}for(const d of _)this._loadedParentTiles[d]=A}}_addTile(c){let _=this._tiles[c.key];if(_)return _;_=this._cache.getAndRemove(c),_&&(this._setTileReloadTimer(c.key,_),_.tileID=c,this._state.initializeTileState(_,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,_)));const A=_;return _||(_=new hr(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(_,this._tileLoaded.bind(this,_,c.key,_.state))),_.uses++,this._tiles[c.key]=_,A||this._source.fire(new o.Event("dataloading",{tile:_,coord:_.tileID,dataType:"source"})),_}_setTileReloadTimer(c,_){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const A=_.getExpiryTimeout();A&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},A))}_removeTile(c){const _=this._tiles[c];_&&(_.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),_.uses>0||(_.hasData()&&_.state!=="reloading"?this._cache.add(_.tileID,_,_.getExpiryTimeout()):(_.aborted=!0,this._abortTile(_),this._unloadTile(_))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(c);this._cache.reset()}tilesIn(c,_,A){const h=[],d=this.transform;if(!d)return h;const w=A?d.getCameraQueryGeometry(c):c,b=c.map(ae=>d.pointCoordinate(ae,this.terrain)),C=w.map(ae=>d.pointCoordinate(ae,this.terrain)),P=this.getIds();let B=1/0,V=1/0,W=-1/0,X=-1/0;for(const ae of C)B=Math.min(B,ae.x),V=Math.min(V,ae.y),W=Math.max(W,ae.x),X=Math.max(X,ae.y);for(let ae=0;ae<P.length;ae++){const ne=this._tiles[P[ae]];if(ne.holdingForFade())continue;const ue=ne.tileID,be=Math.pow(2,d.zoom-ne.tileID.overscaledZ),Me=_*ne.queryPadding*o.EXTENT/ne.tileSize/be,ve=[ue.getTilePoint(new o.MercatorCoordinate(B,V)),ue.getTilePoint(new o.MercatorCoordinate(W,X))];if(ve[0].x-Me<o.EXTENT&&ve[0].y-Me<o.EXTENT&&ve[1].x+Me>=0&&ve[1].y+Me>=0){const $e=b.map(Ge=>ue.getTilePoint(Ge)),Se=C.map(Ge=>ue.getTilePoint(Ge));h.push({tile:ne,tileID:ue,queryGeometry:$e,cameraQueryGeometry:Se,scale:be})}}return h}getVisibleCoordinates(c){const _=this.getRenderableIds(c).map(A=>this._tiles[A].tileID);for(const A of _)A.posMatrix=this.transform.calculatePosMatrix(A.toUnwrapped());return _}hasTransition(){if(this._source.hasTransition())return!0;if(Mn(this._source.type))for(const c in this._tiles){const _=this._tiles[c];if(_.fadeEndTime!==void 0&&_.fadeEndTime>=o.exported.now())return!0}return!1}setFeatureState(c,_,A){this._state.updateState(c=c||"_geojsonTileLayer",_,A)}removeFeatureState(c,_,A){this._state.removeFeatureState(c=c||"_geojsonTileLayer",_,A)}getFeatureState(c,_){return this._state.getState(c=c||"_geojsonTileLayer",_)}setDependencies(c,_,A){const h=this._tiles[c];h&&h.setDependencies(_,A)}reloadTilesForDependencies(c,_){for(const A in this._tiles)this._tiles[A].hasDependency(c,_)&&this._reloadTile(A,"reloading");this._cache.filter(A=>!A.hasDependency(c,_))}}function rn(L,c){const _=Math.abs(2*L.wrap)-+(L.wrap<0),A=Math.abs(2*c.wrap)-+(c.wrap<0);return L.overscaledZ-c.overscaledZ||A-_||c.canonical.y-L.canonical.y||c.canonical.x-L.canonical.x}function Mn(L){return L==="raster"||L==="image"||L==="video"}wt.maxOverzooming=10,wt.maxUnderzooming=3;const xt="mapboxgl_preloaded_worker_pool";class tr{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<tr.workerCount;)this.workers.push(new Worker(Xs.workerUrl));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(_=>{_.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[xt]}numActive(){return Object.keys(this.active).length}}const Hn=Math.floor(o.exported.hardwareConcurrency/2);let xr;function lr(){return xr||(xr=new tr),xr}function nr(L,c){const _={};for(const A in L)A!=="ref"&&(_[A]=L[A]);return o.refProperties.forEach(A=>{A in c&&(_[A]=c[A])}),_}function ri(L){L=L.slice();const c=Object.create(null);for(let _=0;_<L.length;_++)c[L[_].id]=L[_];for(let _=0;_<L.length;_++)"ref"in L[_]&&(L[_]=nr(L[_],c[L[_].ref]));return L}tr.workerCount=Math.max(Math.min(Hn,6),1);const Vn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ki(L,c,_){_.push({command:Vn.addSource,args:[L,c[L]]})}function Qn(L,c,_){c.push({command:Vn.removeSource,args:[L]}),_[L]=!0}function Gi(L,c,_,A){Qn(L,_,A),ki(L,c,_)}function yo(L,c,_){let A;for(A in L[_])if(Object.prototype.hasOwnProperty.call(L[_],A)&&A!=="data"&&!M(L[_][A],c[_][A]))return!1;for(A in c[_])if(Object.prototype.hasOwnProperty.call(c[_],A)&&A!=="data"&&!M(L[_][A],c[_][A]))return!1;return!0}function jr(L,c,_,A,h,d){let w;for(w in c=c||{},L=L||{})Object.prototype.hasOwnProperty.call(L,w)&&(M(L[w],c[w])||_.push({command:d,args:[A,w,c[w],h]}));for(w in c)Object.prototype.hasOwnProperty.call(c,w)&&!Object.prototype.hasOwnProperty.call(L,w)&&(M(L[w],c[w])||_.push({command:d,args:[A,w,c[w],h]}))}function Ii(L){return L.id}function $o(L,c){return L[c.id]=c,L}class ls{constructor(c,_){this.reset(c,_)}reset(c,_){this.points=c||[],this._distances=[0];for(let A=1;A<this.points.length;A++)this._distances[A]=this._distances[A-1]+this.points[A].dist(this.points[A-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(_||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=o.clamp(c,0,1);let _=1,A=this._distances[_];const h=c*this.paddedLength+this.padding;for(;A<h&&_<this._distances.length;)A=this._distances[++_];const d=_-1,w=this._distances[d],b=A-w,C=b>0?(h-w)/b:0;return this.points[d].mult(1-C).add(this.points[_].mult(C))}}function ht(L,c){let _=!0;return L==="always"||L!=="never"&&c!=="never"||(_=!1),_}class It{constructor(c,_,A){const h=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(c/A),this.yCellCount=Math.ceil(_/A);for(let w=0;w<this.xCellCount*this.yCellCount;w++)h.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=_,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/_,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,_,A,h,d){this._forEachCell(_,A,h,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(_),this.bboxes.push(A),this.bboxes.push(h),this.bboxes.push(d)}insertCircle(c,_,A,h){this._forEachCell(_-h,A-h,_+h,A+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(_),this.circles.push(A),this.circles.push(h)}_insertBoxCell(c,_,A,h,d,w){this.boxCells[d].push(w)}_insertCircleCell(c,_,A,h,d,w){this.circleCells[d].push(w)}_query(c,_,A,h,d,w,b){if(A<0||c>this.width||h<0||_>this.height)return[];const C=[];if(c<=0&&_<=0&&this.width<=A&&this.height<=h){if(d)return[{key:null,x1:c,y1:_,x2:A,y2:h}];for(let P=0;P<this.boxKeys.length;P++)C.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const B=this.circles[3*P],V=this.circles[3*P+1],W=this.circles[3*P+2];C.push({key:this.circleKeys[P],x1:B-W,y1:V-W,x2:B+W,y2:V+W})}}else this._forEachCell(c,_,A,h,this._queryCell,C,{hitTest:d,overlapMode:w,seenUids:{box:{},circle:{}}},b);return C}query(c,_,A,h){return this._query(c,_,A,h,!1,null)}hitTest(c,_,A,h,d,w){return this._query(c,_,A,h,!0,d,w).length>0}hitTestCircle(c,_,A,h,d){const w=c-A,b=c+A,C=_-A,P=_+A;if(b<0||w>this.width||P<0||C>this.height)return!1;const B=[];return this._forEachCell(w,C,b,P,this._queryCellCircle,B,{hitTest:!0,overlapMode:h,circle:{x:c,y:_,radius:A},seenUids:{box:{},circle:{}}},d),B.length>0}_queryCell(c,_,A,h,d,w,b,C){const{seenUids:P,hitTest:B,overlapMode:V}=b,W=this.boxCells[d];if(W!==null){const ae=this.bboxes;for(const ne of W)if(!P.box[ne]){P.box[ne]=!0;const ue=4*ne,be=this.boxKeys[ne];if(c<=ae[ue+2]&&_<=ae[ue+3]&&A>=ae[ue+0]&&h>=ae[ue+1]&&(!C||C(be))&&(!B||!ht(V,be.overlapMode))&&(w.push({key:be,x1:ae[ue],y1:ae[ue+1],x2:ae[ue+2],y2:ae[ue+3]}),B))return!0}}const X=this.circleCells[d];if(X!==null){const ae=this.circles;for(const ne of X)if(!P.circle[ne]){P.circle[ne]=!0;const ue=3*ne,be=this.circleKeys[ne];if(this._circleAndRectCollide(ae[ue],ae[ue+1],ae[ue+2],c,_,A,h)&&(!C||C(be))&&(!B||!ht(V,be.overlapMode))){const Me=ae[ue],ve=ae[ue+1],$e=ae[ue+2];if(w.push({key:be,x1:Me-$e,y1:ve-$e,x2:Me+$e,y2:ve+$e}),B)return!0}}}return!1}_queryCellCircle(c,_,A,h,d,w,b,C){const{circle:P,seenUids:B,overlapMode:V}=b,W=this.boxCells[d];if(W!==null){const ae=this.bboxes;for(const ne of W)if(!B.box[ne]){B.box[ne]=!0;const ue=4*ne,be=this.boxKeys[ne];if(this._circleAndRectCollide(P.x,P.y,P.radius,ae[ue+0],ae[ue+1],ae[ue+2],ae[ue+3])&&(!C||C(be))&&!ht(V,be.overlapMode))return w.push(!0),!0}}const X=this.circleCells[d];if(X!==null){const ae=this.circles;for(const ne of X)if(!B.circle[ne]){B.circle[ne]=!0;const ue=3*ne,be=this.circleKeys[ne];if(this._circlesCollide(ae[ue],ae[ue+1],ae[ue+2],P.x,P.y,P.radius)&&(!C||C(be))&&!ht(V,be.overlapMode))return w.push(!0),!0}}}_forEachCell(c,_,A,h,d,w,b,C){const P=this._convertToXCellCoord(c),B=this._convertToYCellCoord(_),V=this._convertToXCellCoord(A),W=this._convertToYCellCoord(h);for(let X=P;X<=V;X++)for(let ae=B;ae<=W;ae++)if(d.call(this,c,_,A,h,this.xCellCount*ae+X,w,b,C))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,_,A,h,d,w){const b=h-c,C=d-_,P=A+w;return P*P>b*b+C*C}_circleAndRectCollide(c,_,A,h,d,w,b){const C=(w-h)/2,P=Math.abs(c-(h+C));if(P>C+A)return!1;const B=(b-d)/2,V=Math.abs(_-(d+B));if(V>B+A)return!1;if(P<=C||V<=B)return!0;const W=P-C,X=V-B;return W*W+X*X<=A*A}}function Us(L,c,_,A,h){const d=o.create();return c?(o.scale(d,d,[1/h,1/h,1]),_||o.rotateZ(d,d,A.angle)):o.multiply(d,A.labelPlaneMatrix,L),d}function bi(L,c,_,A,h){if(c){const d=o.clone(L);return o.scale(d,d,[h,h,1]),_||o.rotateZ(d,d,-A.angle),d}return A.glCoordMatrix}function Bn(L,c,_){let A;_?(A=[L.x,L.y,_(L.x,L.y),1],o.transformMat4(A,A,c)):(A=[L.x,L.y,0,1],Xe(A,A,c));const h=A[3];return{point:new o.pointGeometry(A[0]/h,A[1]/h),signedDistanceFromCamera:h}}function $i(L,c){return .5+L/c*.5}function Li(L,c){const _=L[0]/L[3],A=L[1]/L[3];return _>=-c[0]&&_<=c[0]&&A>=-c[1]&&A<=c[1]}function Di(L,c,_,A,h,d,w,b,C,P){const B=A?L.textSizeData:L.iconSizeData,V=o.evaluateSizeForZoom(B,_.transform.zoom),W=[256/_.width*2+1,256/_.height*2+1],X=A?L.text.dynamicLayoutVertexArray:L.icon.dynamicLayoutVertexArray;X.clear();const ae=L.lineVertexArray,ne=A?L.text.placedSymbolArray:L.icon.placedSymbolArray,ue=_.transform.width/_.transform.height;let be=!1;for(let Me=0;Me<ne.length;Me++){const ve=ne.get(Me);if(ve.hidden||ve.writingMode===o.WritingMode.vertical&&!be){yn(ve.numGlyphs,X);continue}let $e;if(be=!1,P?($e=[ve.anchorX,ve.anchorY,P(ve.anchorX,ve.anchorY),1],o.transformMat4($e,$e,c)):($e=[ve.anchorX,ve.anchorY,0,1],Xe($e,$e,c)),!Li($e,W)){yn(ve.numGlyphs,X);continue}const Se=$i(_.transform.cameraToCenterDistance,$e[3]),Ge=o.evaluateSizeForFeature(B,V,ve),xe=w?Ge/Se:Ge*Se,y=new o.pointGeometry(ve.anchorX,ve.anchorY),m=Bn(y,h,P).point,x={},E=Sn(ve,xe,!1,b,c,h,d,L.glyphOffsetArray,ae,X,m,y,x,ue,C,P);be=E.useVertical,(E.notEnoughRoom||be||E.needsFlipping&&Sn(ve,xe,!0,b,c,h,d,L.glyphOffsetArray,ae,X,m,y,x,ue,C,P).notEnoughRoom)&&yn(ve.numGlyphs,X)}A?L.text.dynamicLayoutVertexBuffer.updateData(X):L.icon.dynamicLayoutVertexBuffer.updateData(X)}function As(L,c,_,A,h,d,w,b,C,P,B,V,W){const X=b.glyphStartIndex+b.numGlyphs,ae=b.lineStartIndex,ne=b.lineStartIndex+b.lineLength,ue=c.getoffsetX(b.glyphStartIndex),be=c.getoffsetX(X-1),Me=Rr(L*ue,_,A,h,d,w,b.segment,ae,ne,C,P,B,V,W);if(!Me)return null;const ve=Rr(L*be,_,A,h,d,w,b.segment,ae,ne,C,P,B,V,W);return ve?{first:Me,last:ve}:null}function Lt(L,c,_,A){return L===o.WritingMode.horizontal&&Math.abs(_.y-c.y)>Math.abs(_.x-c.x)*A?{useVertical:!0}:(L===o.WritingMode.vertical?c.y<_.y:c.x>_.x)?{needsFlipping:!0}:null}function Sn(L,c,_,A,h,d,w,b,C,P,B,V,W,X,ae,ne){const ue=c/24,be=L.lineOffsetX*ue,Me=L.lineOffsetY*ue;let ve;if(L.numGlyphs>1){const $e=L.glyphStartIndex+L.numGlyphs,Se=L.lineStartIndex,Ge=L.lineStartIndex+L.lineLength,xe=As(ue,b,be,Me,_,B,V,L,C,d,W,ae,ne);if(!xe)return{notEnoughRoom:!0};const y=Bn(xe.first.point,w,ne).point,m=Bn(xe.last.point,w,ne).point;if(A&&!_){const x=Lt(L.writingMode,y,m,X);if(x)return x}ve=[xe.first];for(let x=L.glyphStartIndex+1;x<$e-1;x++)ve.push(Rr(ue*b.getoffsetX(x),be,Me,_,B,V,L.segment,Se,Ge,C,d,W,ae,ne));ve.push(xe.last)}else{if(A&&!_){const Se=Bn(V,h,ne).point,Ge=L.lineStartIndex+L.segment+1,xe=new o.pointGeometry(C.getx(Ge),C.gety(Ge)),y=Bn(xe,h,ne),m=y.signedDistanceFromCamera>0?y.point:bn(V,xe,Se,1,h,ne),x=Lt(L.writingMode,Se,m,X);if(x)return x}const $e=Rr(ue*b.getoffsetX(L.glyphStartIndex),be,Me,_,B,V,L.segment,L.lineStartIndex,L.lineStartIndex+L.lineLength,C,d,W,ae,ne);if(!$e)return{notEnoughRoom:!0};ve=[$e]}for(const $e of ve)o.addDynamicAttributes(P,$e.point,$e.angle);return{}}function bn(L,c,_,A,h,d){const w=Bn(L.add(L.sub(c)._unit()),h,d).point,b=_.sub(w);return _.add(b._mult(A/b.mag()))}function Rr(L,c,_,A,h,d,w,b,C,P,B,V,W,X){const ae=A?L-c:L+c;let ne=ae>0?1:-1,ue=0;A&&(ne*=-1,ue=Math.PI),ne<0&&(ue+=Math.PI);let be=ne>0?b+w:b+w+1,Me=h,ve=h,$e=0,Se=0;const Ge=Math.abs(ae),xe=[];for(;$e+Se<=Ge;){if(be+=ne,be<b||be>=C)return null;if(ve=Me,xe.push(Me),Me=V[be],Me===void 0){const I=new o.pointGeometry(P.getx(be),P.gety(be)),R=Bn(I,B,X);if(R.signedDistanceFromCamera>0)Me=V[be]=R.point;else{const O=be-ne;Me=bn($e===0?d:new o.pointGeometry(P.getx(O),P.gety(O)),I,ve,Ge-$e+1,B,X)}}$e+=Se,Se=ve.dist(Me)}const y=(Ge-$e)/Se,m=Me.sub(ve),x=m.mult(y)._add(ve);x._add(m._unit()._perp()._mult(_*ne));const E=ue+Math.atan2(Me.y-ve.y,Me.x-ve.x);return xe.push(x),{point:x,angle:W?E:0,path:xe}}const Ts=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function yn(L,c){for(let _=0;_<L;_++){const A=c.length;c.resize(A+4),c.float32.set(Ts,3*A)}}function Xe(L,c,_){const A=c[0],h=c[1];return L[0]=_[0]*A+_[4]*h+_[12],L[1]=_[1]*A+_[5]*h+_[13],L[3]=_[3]*A+_[7]*h+_[15],L}const Zr=100;class Vs{constructor(c,_=new It(c.width+200,c.height+200,25),A=new It(c.width+200,c.height+200,25)){this.transform=c,this.grid=_,this.ignoredGrid=A,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Zr,this.screenBottomBoundary=c.height+Zr,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,_,A,h,d,w){const b=this.projectAndGetPerspectiveRatio(h,c.anchorPointX,c.anchorPointY,w),C=A*b.perspectiveRatio,P=c.x1*C+b.point.x,B=c.y1*C+b.point.y,V=c.x2*C+b.point.x,W=c.y2*C+b.point.y;return!this.isInsideGrid(P,B,V,W)||_!=="always"&&this.grid.hitTest(P,B,V,W,_,d)||b.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[P,B,V,W],offscreen:this.isOffscreen(P,B,V,W)}}placeCollisionCircles(c,_,A,h,d,w,b,C,P,B,V,W,X,ae){const ne=[],ue=new o.pointGeometry(_.anchorX,_.anchorY),be=Bn(ue,w,ae),Me=$i(this.transform.cameraToCenterDistance,be.signedDistanceFromCamera),ve=(B?d/Me:d*Me)/o.ONE_EM,$e=Bn(ue,b,ae).point,Se=As(ve,h,_.lineOffsetX*ve,_.lineOffsetY*ve,!1,$e,ue,_,A,b,{},!1,ae);let Ge=!1,xe=!1,y=!0;if(Se){const m=.5*W*Me+X,x=new o.pointGeometry(-100,-100),E=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),I=new ls,R=Se.first,O=Se.last;let U=[];for(let le=R.path.length-1;le>=1;le--)U.push(R.path[le]);for(let le=1;le<O.path.length;le++)U.push(O.path[le]);const q=2.5*m;if(C){const le=U.map(de=>Bn(de,C,ae));U=le.some(de=>de.signedDistanceFromCamera<=0)?[]:le.map(de=>de.point)}let ee=[];if(U.length>0){const le=U[0].clone(),de=U[0].clone();for(let Re=1;Re<U.length;Re++)le.x=Math.min(le.x,U[Re].x),le.y=Math.min(le.y,U[Re].y),de.x=Math.max(de.x,U[Re].x),de.y=Math.max(de.y,U[Re].y);ee=le.x>=x.x&&de.x<=E.x&&le.y>=x.y&&de.y<=E.y?[U]:de.x<x.x||le.x>E.x||de.y<x.y||le.y>E.y?[]:o.clipLine([U],x.x,x.y,E.x,E.y)}for(const le of ee){I.reset(le,.25*m);let de=0;de=I.length<=.5*m?1:Math.ceil(I.paddedLength/q)+1;for(let Re=0;Re<de;Re++){const je=Re/Math.max(de-1,1),Be=I.lerp(je),Ke=Be.x+Zr,ft=Be.y+Zr;ne.push(Ke,ft,m,0);const ct=Ke-m,st=ft-m,ot=Ke+m,Je=ft+m;if(y=y&&this.isOffscreen(ct,st,ot,Je),xe=xe||this.isInsideGrid(ct,st,ot,Je),c!=="always"&&this.grid.hitTestCircle(Ke,ft,m,c,V)&&(Ge=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Ge}}}}return{circles:!P&&Ge||!xe||Me<this.perspectiveRatioCutoff?[]:ne,offscreen:y,collisionDetected:Ge}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const _=[];let A=1/0,h=1/0,d=-1/0,w=-1/0;for(const B of c){const V=new o.pointGeometry(B.x+Zr,B.y+Zr);A=Math.min(A,V.x),h=Math.min(h,V.y),d=Math.max(d,V.x),w=Math.max(w,V.y),_.push(V)}const b=this.grid.query(A,h,d,w).concat(this.ignoredGrid.query(A,h,d,w)),C={},P={};for(const B of b){const V=B.key;if(C[V.bucketInstanceId]===void 0&&(C[V.bucketInstanceId]={}),C[V.bucketInstanceId][V.featureIndex])continue;const W=[new o.pointGeometry(B.x1,B.y1),new o.pointGeometry(B.x2,B.y1),new o.pointGeometry(B.x2,B.y2),new o.pointGeometry(B.x1,B.y2)];o.polygonIntersectsPolygon(_,W)&&(C[V.bucketInstanceId][V.featureIndex]=!0,P[V.bucketInstanceId]===void 0&&(P[V.bucketInstanceId]=[]),P[V.bucketInstanceId].push(V.featureIndex))}return P}insertCollisionBox(c,_,A,h,d,w){(A?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:d,collisionGroupID:w,overlapMode:_},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,_,A,h,d,w){const b=A?this.ignoredGrid:this.grid,C={bucketInstanceId:h,featureIndex:d,collisionGroupID:w,overlapMode:_};for(let P=0;P<c.length;P+=4)b.insertCircle(C,c[P],c[P+1],c[P+2])}projectAndGetPerspectiveRatio(c,_,A,h){let d;return h?(d=[_,A,h(_,A),1],o.transformMat4(d,d,c)):(d=[_,A,0,1],Xe(d,d,c)),{point:new o.pointGeometry((d[0]/d[3]+1)/2*this.transform.width+Zr,(-d[1]/d[3]+1)/2*this.transform.height+Zr),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(c,_,A,h){return A<Zr||c>=this.screenRightBoundary||h<Zr||_>this.screenBottomBoundary}isInsideGrid(c,_,A,h){return A>=0&&c<this.gridRightBoundary&&h>=0&&_<this.gridBottomBoundary}getViewportMatrix(){const c=o.identity([]);return o.translate(c,c,[-100,-100,0]),c}}function Fr(L,c,_){return c*(o.EXTENT/(L.tileSize*Math.pow(2,_-L.tileID.overscaledZ)))}class ci{constructor(c,_,A,h){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?_:-_))):h&&A?1:0,this.placed=A}isHidden(){return this.opacity===0&&!this.placed}}class Yn{constructor(c,_,A,h,d){this.text=new ci(c?c.text:null,_,A,d),this.icon=new ci(c?c.icon:null,_,h,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Gs{constructor(c,_,A){this.text=c,this.icon=_,this.skipFade=A}}class ji{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Hi{constructor(c,_,A,h,d){this.bucketInstanceId=c,this.featureIndex=_,this.sourceLayerIndex=A,this.bucketIndex=h,this.tileID=d}}class Ri{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const _=++this.maxGroupID;this.collisionGroups[c]={ID:_,predicate:A=>A.collisionGroupID===_}}return this.collisionGroups[c]}}function us(L,c,_,A,h){const{horizontalAlign:d,verticalAlign:w}=o.getAnchorAlignment(L),b=-(d-.5)*c,C=-(w-.5)*_,P=o.evaluateVariableOffset(L,A);return new o.pointGeometry(b+P[0]*h,C+P[1]*h)}function Nr(L,c,_,A,h,d){const{x1:w,x2:b,y1:C,y2:P,anchorPointX:B,anchorPointY:V}=L,W=new o.pointGeometry(c,_);return A&&W._rotate(h?d:-d),{x1:w+W.x,y1:C+W.y,x2:b+W.x,y2:P+W.y,anchorPointX:B,anchorPointY:V}}class K{constructor(c,_,A,h,d){this.transform=c.clone(),this.terrain=_,this.collisionIndex=new Vs(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=A,this.retainedQueryData={},this.collisionGroups=new Ri(h),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,_,A,h){const d=A.getBucket(_),w=A.latestFeatureIndex;if(!d||!w||_.id!==d.layerIds[0])return;const b=A.collisionBoxArray,C=d.layers[0].layout,P=Math.pow(2,this.transform.zoom-A.tileID.overscaledZ),B=A.tileSize/o.EXTENT,V=this.transform.calculatePosMatrix(A.tileID.toUnwrapped()),W=C.get("text-pitch-alignment")==="map",X=C.get("text-rotation-alignment")==="map",ae=Fr(A,1,this.transform.zoom),ne=Us(V,W,X,this.transform,ae);let ue=null;if(W){const Me=bi(V,W,X,this.transform,ae);ue=o.multiply([],this.transform.labelPlaneMatrix,Me)}this.retainedQueryData[d.bucketInstanceId]=new Hi(d.bucketInstanceId,w,d.sourceLayerIndex,d.index,A.tileID);const be={bucket:d,layout:C,posMatrix:V,textLabelPlaneMatrix:ne,labelToScreenMatrix:ue,scale:P,textPixelRatio:B,holdingForFade:A.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(h)for(const Me of d.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:$e,symbolInstanceEnd:Se}=Me;c.push({sortKey:ve,symbolInstanceStart:$e,symbolInstanceEnd:Se,parameters:be})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:be})}attemptAnchorPlacement(c,_,A,h,d,w,b,C,P,B,V,W,X,ae,ne,ue){const be=[W.textOffset0,W.textOffset1],Me=us(c,A,h,be,d),ve=this.collisionIndex.placeCollisionBox(Nr(_,Me.x,Me.y,w,b,this.transform.angle),V,C,P,B.predicate,ue);if((!ne||this.collisionIndex.placeCollisionBox(Nr(ne,Me.x,Me.y,w,b,this.transform.angle),V,C,P,B.predicate,ue).box.length!==0)&&ve.box.length>0){let $e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&($e=this.prevPlacement.variableOffsets[W.crossTileID].anchor),W.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[W.crossTileID]={textOffset:be,width:A,height:h,anchor:c,textBoxScale:d,prevAnchor:$e},this.markUsedJustification(X,c,W,ae),X.allowVerticalPlacement&&(this.markUsedOrientation(X,ae,W),this.placedOrientations[W.crossTileID]=ae),{shift:Me,placedGlyphBoxes:ve}}}placeLayerBucketPart(c,_,A){const{bucket:h,layout:d,posMatrix:w,textLabelPlaneMatrix:b,labelToScreenMatrix:C,textPixelRatio:P,holdingForFade:B,collisionBoxArray:V,partiallyEvaluatedTextSize:W,collisionGroup:X}=c.parameters,ae=d.get("text-optional"),ne=d.get("icon-optional"),ue=o.getOverlapMode(d,"text-overlap","text-allow-overlap"),be=ue==="always",Me=o.getOverlapMode(d,"icon-overlap","icon-allow-overlap"),ve=Me==="always",$e=d.get("text-rotation-alignment")==="map",Se=d.get("text-pitch-alignment")==="map",Ge=d.get("icon-text-fit")!=="none",xe=d.get("symbol-z-order")==="viewport-y",y=be&&(ve||!h.hasIconData()||ne),m=ve&&(be||!h.hasTextData()||ae);!h.collisionArrays&&V&&h.deserializeCollisionBoxes(V);const x=(E,I)=>{if(_[E.crossTileID])return;if(B)return void(this.placements[E.crossTileID]=new Gs(!1,!1,!1));let R=!1,O=!1,U=!0,q=null,ee={box:null,offscreen:null},le={box:null,offscreen:null},de=null,Re=null,je=null,Be=0,Ke=0,ft=0;I.textFeatureIndex?Be=I.textFeatureIndex:E.useRuntimeCollisionCircles&&(Be=E.featureIndex),I.verticalTextFeatureIndex&&(Ke=I.verticalTextFeatureIndex);const ct=this.retainedQueryData[h.bucketInstanceId].tileID,st=this.terrain?(zt,gt)=>this.terrain.getElevation(ct,zt,gt):null;for(const zt of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const gt=I[zt];gt&&(gt.elevation=st?st(gt.anchorPointX,gt.anchorPointY):0)}const ot=I.textBox;if(ot){const zt=vt=>{let Pn=o.WritingMode.horizontal;if(h.allowVerticalPlacement&&!vt&&this.prevPlacement){const wn=this.prevPlacement.placedOrientations[E.crossTileID];wn&&(this.placedOrientations[E.crossTileID]=wn,Pn=wn,this.markUsedOrientation(h,Pn,E))}return Pn},gt=(vt,Pn)=>{if(h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&I.verticalTextBox){for(const wn of h.writingModes)if(wn===o.WritingMode.vertical?(ee=Pn(),le=ee):ee=vt(),ee&&ee.box&&ee.box.length)break}else ee=vt()};if(d.get("text-variable-anchor")){let vt=d.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[E.crossTileID]){const mn=this.prevPlacement.variableOffsets[E.crossTileID];vt.indexOf(mn.anchor)>0&&(vt=vt.filter(_n=>_n!==mn.anchor),vt.unshift(mn.anchor))}const Pn=(mn,_n,En)=>{const Dn=mn.x2-mn.x1,ar=mn.y2-mn.y1,kn=E.textBoxScale,Er=Ge&&Me==="never"?_n:null;let Kr={box:[],offscreen:!1};const ol=ue!=="never"?2*vt.length:vt.length;for(let Tu=0;Tu<ol;++Tu){const $f=this.attemptAnchorPlacement(vt[Tu%vt.length],mn,Dn,ar,kn,$e,Se,P,w,X,Tu>=vt.length?ue:"never",E,h,En,Er,st);if($f&&(Kr=$f.placedGlyphBoxes,Kr&&Kr.box&&Kr.box.length)){R=!0,q=$f.shift;break}}return Kr};gt(()=>Pn(ot,I.iconBox,o.WritingMode.horizontal),()=>{const mn=I.verticalTextBox;return h.allowVerticalPlacement&&!(ee&&ee.box&&ee.box.length)&&E.numVerticalGlyphVertices>0&&mn?Pn(mn,I.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),ee&&(R=ee.box,U=ee.offscreen);const wn=zt(ee&&ee.box);if(!R&&this.prevPlacement){const mn=this.prevPlacement.variableOffsets[E.crossTileID];mn&&(this.variableOffsets[E.crossTileID]=mn,this.markUsedJustification(h,mn.anchor,E,wn))}}else{const vt=(Pn,wn)=>{const mn=this.collisionIndex.placeCollisionBox(Pn,ue,P,w,X.predicate,st);return mn&&mn.box&&mn.box.length&&(this.markUsedOrientation(h,wn,E),this.placedOrientations[E.crossTileID]=wn),mn};gt(()=>vt(ot,o.WritingMode.horizontal),()=>{const Pn=I.verticalTextBox;return h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&Pn?vt(Pn,o.WritingMode.vertical):{box:null,offscreen:null}}),zt(ee&&ee.box&&ee.box.length)}}if(de=ee,R=de&&de.box&&de.box.length>0,U=de&&de.offscreen,E.useRuntimeCollisionCircles){const zt=h.text.placedSymbolArray.get(E.centerJustifiedTextSymbolIndex),gt=o.evaluateSizeForFeature(h.textSizeData,W,zt),vt=d.get("text-padding");Re=this.collisionIndex.placeCollisionCircles(ue,zt,h.lineVertexArray,h.glyphOffsetArray,gt,w,b,C,A,Se,X.predicate,E.collisionCircleDiameter,vt,st),Re.circles.length&&Re.collisionDetected&&!A&&o.warnOnce("Collisions detected, but collision boxes are not shown"),R=be||Re.circles.length>0&&!Re.collisionDetected,U=U&&Re.offscreen}if(I.iconFeatureIndex&&(ft=I.iconFeatureIndex),I.iconBox){const zt=gt=>{const vt=Ge&&q?Nr(gt,q.x,q.y,$e,Se,this.transform.angle):gt;return this.collisionIndex.placeCollisionBox(vt,Me,P,w,X.predicate,st)};le&&le.box&&le.box.length&&I.verticalIconBox?(je=zt(I.verticalIconBox),O=je.box.length>0):(je=zt(I.iconBox),O=je.box.length>0),U=U&&je.offscreen}const Je=ae||E.numHorizontalGlyphVertices===0&&E.numVerticalGlyphVertices===0,Gt=ne||E.numIconVertices===0;if(Je||Gt?Gt?Je||(O=O&&R):R=O&&R:O=R=O&&R,R&&de&&de.box&&this.collisionIndex.insertCollisionBox(de.box,ue,d.get("text-ignore-placement"),h.bucketInstanceId,le&&le.box&&Ke?Ke:Be,X.ID),O&&je&&this.collisionIndex.insertCollisionBox(je.box,Me,d.get("icon-ignore-placement"),h.bucketInstanceId,ft,X.ID),Re&&(R&&this.collisionIndex.insertCollisionCircles(Re.circles,ue,d.get("text-ignore-placement"),h.bucketInstanceId,Be,X.ID),A)){const zt=h.bucketInstanceId;let gt=this.collisionCircleArrays[zt];gt===void 0&&(gt=this.collisionCircleArrays[zt]=new ji);for(let vt=0;vt<Re.circles.length;vt+=4)gt.circles.push(Re.circles[vt+0]),gt.circles.push(Re.circles[vt+1]),gt.circles.push(Re.circles[vt+2]),gt.circles.push(Re.collisionDetected?1:0)}if(E.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[E.crossTileID]=new Gs(R||y,O||m,U||h.justReloaded),_[E.crossTileID]=!0};if(xe){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const E=h.getSortedSymbolIndexes(this.transform.angle);for(let I=E.length-1;I>=0;--I){const R=E[I];x(h.symbolInstances.get(R),h.collisionArrays[R])}}else for(let E=c.symbolInstanceStart;E<c.symbolInstanceEnd;E++)x(h.symbolInstances.get(E),h.collisionArrays[E]);if(A&&h.bucketInstanceId in this.collisionCircleArrays){const E=this.collisionCircleArrays[h.bucketInstanceId];o.invert(E.invProjMatrix,w),E.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(c,_,A,h){let d;d=h===o.WritingMode.vertical?A.verticalPlacedTextSymbolIndex:{left:A.leftJustifiedTextSymbolIndex,center:A.centerJustifiedTextSymbolIndex,right:A.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(_)];const w=[A.leftJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.rightJustifiedTextSymbolIndex,A.verticalPlacedTextSymbolIndex];for(const b of w)b>=0&&(c.text.placedSymbolArray.get(b).crossTileID=d>=0&&b!==d?0:A.crossTileID)}markUsedOrientation(c,_,A){const h=_===o.WritingMode.horizontal||_===o.WritingMode.horizontalOnly?_:0,d=_===o.WritingMode.vertical?_:0,w=[A.leftJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.rightJustifiedTextSymbolIndex];for(const b of w)c.text.placedSymbolArray.get(b).placedOrientation=h;A.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(A.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const _=this.prevPlacement;let A=!1;this.prevZoomAdjustment=_?_.zoomAdjustment(this.transform.zoom):0;const h=_?_.symbolFadeChange(c):1,d=_?_.opacities:{},w=_?_.variableOffsets:{},b=_?_.placedOrientations:{};for(const C in this.placements){const P=this.placements[C],B=d[C];B?(this.opacities[C]=new Yn(B,h,P.text,P.icon),A=A||P.text!==B.text.placed||P.icon!==B.icon.placed):(this.opacities[C]=new Yn(null,h,P.text,P.icon,P.skipFade),A=A||P.text||P.icon)}for(const C in d){const P=d[C];if(!this.opacities[C]){const B=new Yn(P,h,!1,!1);B.isHidden()||(this.opacities[C]=B,A=A||P.text.placed||P.icon.placed)}}for(const C in w)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=w[C]);for(const C in b)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=b[C]);if(_&&_.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");A?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=_?_.lastPlacementChangeTime:c)}updateLayerOpacities(c,_){const A={};for(const h of _){const d=h.getBucket(c);d&&h.latestFeatureIndex&&c.id===d.layerIds[0]&&this.updateBucketOpacities(d,A,h.collisionBoxArray)}}updateBucketOpacities(c,_,A){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const h=c.layers[0].layout,d=new Yn(null,0,!1,!1,!0),w=h.get("text-allow-overlap"),b=h.get("icon-allow-overlap"),C=h.get("text-variable-anchor"),P=h.get("text-rotation-alignment")==="map",B=h.get("text-pitch-alignment")==="map",V=h.get("icon-text-fit")!=="none",W=new Yn(null,0,w&&(b||!c.hasIconData()||h.get("icon-optional")),b&&(w||!c.hasTextData()||h.get("text-optional")),!0);!c.collisionArrays&&A&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(A);const X=(ae,ne,ue)=>{for(let be=0;be<ne/4;be++)ae.opacityVertexArray.emplaceBack(ue)};for(let ae=0;ae<c.symbolInstances.length;ae++){const ne=c.symbolInstances.get(ae),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:be,crossTileID:Me}=ne;let ve=this.opacities[Me];_[Me]?ve=d:ve||(ve=W,this.opacities[Me]=ve),_[Me]=!0;const $e=ne.numIconVertices>0,Se=this.placedOrientations[ne.crossTileID],Ge=Se===o.WritingMode.vertical,xe=Se===o.WritingMode.horizontal||Se===o.WritingMode.horizontalOnly;if(ue>0||be>0){const y=Ie(ve.text);X(c.text,ue,Ge?qe:y),X(c.text,be,xe?qe:y);const m=ve.text.isHidden();[ne.rightJustifiedTextSymbolIndex,ne.centerJustifiedTextSymbolIndex,ne.leftJustifiedTextSymbolIndex].forEach(I=>{I>=0&&(c.text.placedSymbolArray.get(I).hidden=m||Ge?1:0)}),ne.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(ne.verticalPlacedTextSymbolIndex).hidden=m||xe?1:0);const x=this.variableOffsets[ne.crossTileID];x&&this.markUsedJustification(c,x.anchor,ne,Se);const E=this.placedOrientations[ne.crossTileID];E&&(this.markUsedJustification(c,"left",ne,E),this.markUsedOrientation(c,E,ne))}if($e){const y=Ie(ve.icon),m=!(V&&ne.verticalPlacedIconSymbolIndex&&Ge);ne.placedIconSymbolIndex>=0&&(X(c.icon,ne.numIconVertices,m?y:qe),c.icon.placedSymbolArray.get(ne.placedIconSymbolIndex).hidden=ve.icon.isHidden()),ne.verticalPlacedIconSymbolIndex>=0&&(X(c.icon,ne.numVerticalIconVertices,m?qe:y),c.icon.placedSymbolArray.get(ne.verticalPlacedIconSymbolIndex).hidden=ve.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const y=c.collisionArrays[ae];if(y){let m=new o.pointGeometry(0,0);if(y.textBox||y.verticalTextBox){let E=!0;if(C){const I=this.variableOffsets[Me];I?(m=us(I.anchor,I.width,I.height,I.textOffset,I.textBoxScale),P&&m._rotate(B?this.transform.angle:-this.transform.angle)):E=!1}y.textBox&&Q(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||Ge,m.x,m.y),y.verticalTextBox&&Q(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||xe,m.x,m.y)}const x=!!(!xe&&y.verticalIconBox);y.iconBox&&Q(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,x,V?m.x:0,V?m.y:0),y.verticalIconBox&&Q(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,!x,V?m.x:0,V?m.y:0)}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);if(c.bucketInstanceId in this.collisionCircleArrays){const ae=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=ae.invProjMatrix,c.placementViewportMatrix=ae.viewportMatrix,c.collisionCircleArray=ae.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,_){const A=this.zoomAtLastRecencyCheck===_?1-this.zoomAdjustment(_):1;return this.zoomAtLastRecencyCheck=_,this.commitTime+this.fadeDuration*A>c}setStale(){this.stale=!0}}function Q(L,c,_,A,h){L.emplaceBack(c?1:0,_?1:0,A||0,h||0),L.emplaceBack(c?1:0,_?1:0,A||0,h||0),L.emplaceBack(c?1:0,_?1:0,A||0,h||0),L.emplaceBack(c?1:0,_?1:0,A||0,h||0)}const te=Math.pow(2,25),fe=Math.pow(2,24),a=Math.pow(2,17),G=Math.pow(2,16),Le=Math.pow(2,9),ke=Math.pow(2,8),Pe=Math.pow(2,1);function Ie(L){if(L.opacity===0&&!L.placed)return 0;if(L.opacity===1&&L.placed)return 4294967295;const c=L.placed?1:0,_=Math.floor(127*L.opacity);return _*te+c*fe+_*a+c*G+_*Le+c*ke+_*Pe+c}const qe=0;class At{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,_,A,h,d){const w=this._bucketParts;for(;this._currentTileIndex<c.length;)if(_.getBucketParts(w,h,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((b,C)=>b.sortKey-C.sortKey));this._currentPartIndex<w.length;)if(_.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,A),this._currentPartIndex++,d())return!0;return!1}}class We{constructor(c,_,A,h,d,w,b,C){this.placement=new K(c,_,w,b,C),this._currentPlacementIndex=A.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(c,_,A){const h=o.exported.now(),d=()=>{const w=o.exported.now()-h;return!this._forceFullPlacement&&w>2};for(;this._currentPlacementIndex>=0;){const w=_[c[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=b)&&(!w.maxzoom||w.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new At(w)),this._inProgressLayer.continuePlacement(A[w.source],this.placement,this._showCollisionBoxes,w,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const dt=512/o.EXTENT/2;class Dt{constructor(c,_,A){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=A;for(let h=0;h<_.length;h++){const d=_.get(h),w=d.key;this.indexedSymbolInstances[w]||(this.indexedSymbolInstances[w]=[]),this.indexedSymbolInstances[w].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,c)})}}getScaledCoordinates(c,_){const A=dt/Math.pow(2,_.canonical.z-this.tileID.canonical.z);return{x:Math.floor((_.canonical.x*o.EXTENT+c.anchorX)*A),y:Math.floor((_.canonical.y*o.EXTENT+c.anchorY)*A)}}findMatches(c,_,A){const h=this.tileID.canonical.z<_.canonical.z?1:Math.pow(2,this.tileID.canonical.z-_.canonical.z);for(let d=0;d<c.length;d++){const w=c.get(d);if(w.crossTileID)continue;const b=this.indexedSymbolInstances[w.key];if(!b)continue;const C=this.getScaledCoordinates(w,_);for(const P of b)if(Math.abs(P.coord.x-C.x)<=h&&Math.abs(P.coord.y-C.y)<=h&&!A[P.crossTileID]){A[P.crossTileID]=!0,w.crossTileID=P.crossTileID;break}}}}class Rt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class sn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const _=Math.round((c-this.lng)/360);if(_!==0)for(const A in this.indexes){const h=this.indexes[A],d={};for(const w in h){const b=h[w];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+_),d[b.tileID.key]=b}this.indexes[A]=d}this.lng=c}addBucket(c,_,A){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===_.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let d=0;d<_.symbolInstances.length;d++)_.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const h=this.usedCrossTileIDs[c.overscaledZ];for(const d in this.indexes){const w=this.indexes[d];if(Number(d)>c.overscaledZ)for(const b in w){const C=w[b];C.tileID.isChildOf(c)&&C.findMatches(_.symbolInstances,c,h)}else{const b=w[c.scaledTo(Number(d)).key];b&&b.findMatches(_.symbolInstances,c,h)}}for(let d=0;d<_.symbolInstances.length;d++){const w=_.symbolInstances.get(d);w.crossTileID||(w.crossTileID=A.generate(),h[w.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Dt(c,_.symbolInstances,_.bucketInstanceId),!0}removeBucketCrossTileIDs(c,_){for(const A in _.indexedSymbolInstances)for(const h of _.indexedSymbolInstances[A])delete this.usedCrossTileIDs[c][h.crossTileID]}removeStaleBuckets(c){let _=!1;for(const A in this.indexes){const h=this.indexes[A];for(const d in h)c[h[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(A,h[d]),delete h[d],_=!0)}return _}}class jt{constructor(){this.layerIndexes={},this.crossTileIDs=new Rt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,_,A){let h=this.layerIndexes[c.id];h===void 0&&(h=this.layerIndexes[c.id]=new sn);let d=!1;const w={};h.handleWrapJump(A);for(const b of _){const C=b.getBucket(c);C&&c.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(b.tileID,C,this.crossTileIDs)&&(d=!0),w[C.bucketInstanceId]=!0)}return h.removeStaleBuckets(w)&&(d=!0),d}pruneUnusedLayers(c){const _={};c.forEach(A=>{_[A]=!0});for(const A in this.layerIndexes)_[A]||delete this.layerIndexes[A]}}var pn=o.createLayout([{name:"a_pos",type:"Int16",components:2}]);class qt extends o.Evented{constructor(c){super(),this.sourceCache=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=c._cache.max,c.usedForTerrain=!0,c.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const c in this._tiles){const _=this._tiles[c];_.textures.forEach(A=>A.destroy()),_.textures=[]}}update(c,_){this.sourceCache.update(c,_),this._renderableTilesKeys=[];for(const A of c.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:_}))this._renderableTilesKeys.push(A.key),this._tiles[A.key]||(A.posMatrix=new Float64Array(16),o.ortho(A.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),this._tiles[A.key]=new hr(A,this.tileSize))}removeOutdated(c){const _={};this.renderHistory=this.renderHistory.filter((A,h)=>this.renderHistory.indexOf(A)===h).slice(0,this.renderHistorySize);for(const A of this._renderableTilesKeys)_[A]=!0;for(const A of this.renderHistory)_[A]=!0;for(const A in this._tiles)_[A]||(this._tiles[A].clearTextures(c),delete this._tiles[A])}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c){const _={};for(const A of this._renderableTilesKeys){const h=this._tiles[A].tileID;if(h.canonical.equals(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16),o.ortho(d.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),_[A]=d}else if(h.canonical.isChildOf(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const w=h.canonical.z-c.canonical.z,b=h.canonical.x-(h.canonical.x>>w<<w),C=h.canonical.y-(h.canonical.y>>w<<w),P=o.EXTENT>>w;o.ortho(d.posMatrix,0,P,0,P,0,1),o.translate(d.posMatrix,d.posMatrix,[-b*P,-C*P,0]),_[A]=d}else if(c.canonical.isChildOf(h.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const w=c.canonical.z-h.canonical.z,b=c.canonical.x-(c.canonical.x>>w<<w),C=c.canonical.y-(c.canonical.y>>w<<w),P=o.EXTENT>>w;o.ortho(d.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),o.translate(d.posMatrix,d.posMatrix,[b*P,C*P,0]),o.scale(d.posMatrix,d.posMatrix,[1/2**w,1/2**w,0]),_[A]=d}}return _}getSourceTile(c,_){const A=this.sourceCache._source;let h=c.overscaledZ-this.deltaZoom;if(h>A.maxzoom&&(h=A.maxzoom),h<A.minzoom)return null;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(h).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[c.key]);if((!d||!d.dem)&&_)for(;h>=A.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(c.scaledTo(h--).key);return d}tilesAfterTime(c=Date.now()){return Object.values(this._tiles).filter(_=>_.timeLoaded>=c)}}class an{constructor(c,_,A){this.style=c,this.sourceCache=new qt(_),this.options=A,this.exaggeration=typeof A.exaggeration=="number"?A.exaggeration:1,this.elevationOffset=typeof A.elevationOffset=="number"?A.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(c,_,A,h=o.EXTENT){if(!(_>=0&&_<h&&A>=0&&A<h))return this.elevationOffset;let d=0;const w=this.getTerrainData(c);if(w.tile&&w.tile.dem){const b=o.transformMat4$1([],[_/h*o.EXTENT,A/h*o.EXTENT],w.u_terrain_matrix),C=[b[0]*w.tile.dem.dim,b[1]*w.tile.dem.dim],P=[Math.floor(C[0]),Math.floor(C[1])],B=w.tile.dem.get(P[0],P[1]),V=w.tile.dem.get(P[0],P[1]+1),W=w.tile.dem.get(P[0]+1,P[1]),X=w.tile.dem.get(P[0]+1,P[1]+1);d=o.number(o.number(B,V,C[0]-P[0]),o.number(W,X,C[0]-P[0]),C[1]-P[1])}return d}rememberForRerender(c,_){for(const A in this.sourceCache._tiles){const h=this.sourceCache._tiles[A];(h.tileID.equals(_)||h.tileID.isChildOf(_))&&(c===this.sourceCache.sourceCache.id&&(h.timeLoaded=Date.now()),this._rerender[c]=this._rerender[c]||{},this._rerender[c][h.tileID.key]=!0)}}needsRerender(c,_){return this._rerender[c]&&this._rerender[c][_.key]}clearRerenderCache(){this._rerender={}}getElevation(c,_,A,h=o.EXTENT){return(this.getDEMElevation(c,_,A,h)+this.elevationOffset)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){const h=this.style.map.painter.context,d=new o.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new j(h,d,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new j(h,new o.RGBAImage({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.identity([])}const _=this.sourceCache.getSourceTile(c,!0);if(_&&_.dem&&(!_.demTexture||_.needsTerrainPrepare)){const h=this.style.map.painter.context;_.demTexture=this.style.map.painter.getTileTexture(_.dem.stride),_.demTexture?_.demTexture.update(_.dem.getPixels(),{premultiply:!1}):_.demTexture=new j(h,_.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),_.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),_.needsTerrainPrepare=!1}const A=_&&_+_.tileID.key+c.key;if(A&&!this._demMatrixCache[A]){const h=this.sourceCache.sourceCache._source.maxzoom;let d=c.canonical.z-_.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=h?d=c.canonical.z-h:o.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=c.canonical.x-(c.canonical.x>>d<<d),b=c.canonical.y-(c.canonical.y>>d<<d),C=o.fromScaling(new Float64Array(16),[1/(o.EXTENT<<d),1/(o.EXTENT<<d),0]);o.translate(C,C,[w*o.EXTENT,b*o.EXTENT,0]),this._demMatrixCache[c.key]={matrix:C,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:_&&_.dem&&_.dem.dim||1,u_terrain_matrix:A?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:_&&_.dem&&_.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(_&&_.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:_}}getRTTFramebuffer(){const c=this.style.map.painter;if(!this._rttFramebuffer){const _=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=c.context.createFramebuffer(_,_,!0),this._rttFramebuffer.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,_,_))}return this._rttFramebuffer}getFramebuffer(c){const _=this.style.map.painter,A=_.width/devicePixelRatio,h=_.height/devicePixelRatio;return!this._fbo||this._fbo.width===A&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new j(_.context,{width:A,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new j(_.context,{width:A,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=_.context.createFramebuffer(A,h,!0),this._fbo.depthAttachment.set(_.context.createRenderbuffer(_.context.gl.DEPTH_COMPONENT16,A,h))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const c=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const _=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,w=0;d<this._coordsTextureSize;d++)for(let b=0;b<this._coordsTextureSize;b++,w+=4)_[w+0]=255&b,_[w+1]=255&d,_[w+2]=b>>8<<4|d>>8,_[w+3]=0;const A=new o.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(_.buffer)),h=new j(c,A,c.gl.RGBA,{premultiply:!1});return h.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(c){const _=new Uint8Array(4),A=this.style.map.painter,h=A.context,d=h.gl;h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(c.x,A.height/devicePixelRatio-c.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,_),h.bindFramebuffer.set(null);const w=_[0]+(_[2]>>4<<8),b=_[1]+((15&_[2])<<8),C=this.coordsIndex[255-_[3]],P=C&&this.sourceCache.getTileByID(C);if(!P)return null;const B=this._coordsTextureSize,V=(1<<P.tileID.canonical.z)*B;return new o.MercatorCoordinate((P.tileID.canonical.x*B+w)/V,(P.tileID.canonical.y*B+b)/V,this.getElevation(P.tileID,w,b,B))}getTerrainMesh(){if(this._mesh)return this._mesh;const c=this.style.map.painter.context,_=new o.PosArray,A=new o.TriangleIndexArray,h=this.meshSize,d=o.EXTENT/h,w=h*h;for(let b=0;b<=h;b++)for(let C=0;C<=h;C++)_.emplaceBack(C*d,b*d);for(let b=0;b<w;b+=h+1)for(let C=0;C<h;C++)A.emplaceBack(C+b,h+C+b+1,h+C+b+2),A.emplaceBack(C+b,h+C+b+2,C+b+1);return this._mesh={indexBuffer:c.createIndexBuffer(A),vertexBuffer:c.createVertexBuffer(_,pn.members),segments:o.SegmentVector.simpleSegment(0,0,_.length,A.length)},this._mesh}getMinMaxElevation(c){const _=this.getTerrainData(c).tile,A={minElevation:null,maxElevation:null};return _&&_.dem&&(A.minElevation=(_.dem.min+this.elevationOffset)*this.exaggeration,A.maxElevation=(_.dem.max+this.elevationOffset)*this.exaggeration),A}}const xn=(L,c)=>o.emitValidationErrors(L,c&&c.filter(_=>_.identifier!=="source.canvas")),Ft=o.pick(Vn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Oe=o.pick(Vn,["setCenter","setZoom","setBearing","setPitch"]),Mt=function(){const L={},c=o.spec.$version;for(const _ in o.spec.$root){const A=o.spec.$root[_];if(A.required){let h=null;h=_==="version"?c:A.type==="array"?[]:{},h!=null&&(L[_]=h)}}return L}();class Ce extends o.Evented{constructor(c,_={}){super(),this.map=c,this.dispatcher=new nt(lr(),this),this.imageManager=new Y,this.imageManager.setEventedParent(this),this.glyphManager=new me(c._requestManager,_.localIdeographFontFamily),this.lineAtlas=new Ye(256,512),this.crossTileSymbolIndex=new jt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const A=this;this._rtlTextPluginCallback=Ce.registerForPluginStateChange(h=>{A.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:h.pluginStatus,pluginURL:h.pluginURL},(d,w)=>{if(o.triggerPluginCompletionEvent(d),w&&w.every(b=>b))for(const b in A.sourceCaches)A.sourceCaches[b].reload()})}),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const w=d.getSource();if(w&&w.vectorLayerIds)for(const b in this._layers){const C=this._layers[b];C.source===w.id&&this._validateLayer(C)}})}loadURL(c,_={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const A=typeof _.validate!="boolean"||_.validate,h=this.map._requestManager.transformRequest(c,o.ResourceType.Style);this._request=o.getJSON(h,(d,w)=>{this._request=null,d?this.fire(new o.ErrorEvent(d)):w&&this._load(w,A)})}loadJSON(c,_={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(c,_.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Mt,!1)}_load(c,_){if(_&&xn(this,o.validateStyle(c)))return;this._loaded=!0,this.stylesheet=c;for(const h in c.sources)this.addSource(h,c.sources[h],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);const A=ri(this.stylesheet.layers);this._order=A.map(h=>h.id),this._layers={},this._serializedLayers={};for(let h of A)h=o.createStyleLayer(h),h.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=h,this._serializedLayers[h.id]=h.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Qe(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}_loadSprite(c){this._spriteRequest=function(_,A,h,d){let w,b,C;const P=h>1?"@2x":"";let B=o.getJSON(A.transformRequest(A.normalizeSpriteURL(_,P,".json"),o.ResourceType.SpriteJSON),(X,ae)=>{B=null,C||(C=X,w=ae,W())}),V=o.getImage(A.transformRequest(A.normalizeSpriteURL(_,P,".png"),o.ResourceType.SpriteImage),(X,ae)=>{V=null,C||(C=X,b=ae,W())});function W(){if(C)d(C);else if(w&&b){const X=o.exported.getImageData(b),ae={};for(const ne in w){const{width:ue,height:be,x:Me,y:ve,sdf:$e,pixelRatio:Se,stretchX:Ge,stretchY:xe,content:y}=w[ne],m=new o.RGBAImage({width:ue,height:be});o.RGBAImage.copy(X,m,{x:Me,y:ve},{x:0,y:0},{width:ue,height:be}),ae[ne]={data:m,pixelRatio:Se,sdf:$e,stretchX:Ge,stretchY:xe,content:y}}d(null,ae)}}return{cancel(){B&&(B.cancel(),B=null),V&&(V.cancel(),V=null)}}}(c,this.map._requestManager,this.map.getPixelRatio(),(_,A)=>{if(this._spriteRequest=null,_)this.fire(new o.ErrorEvent(_));else if(A)for(const h in A)this.imageManager.addImage(h,A[h]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(c){const _=this.sourceCaches[c.source];if(!_)return;const A=c.sourceLayer;if(!A)return;const h=_.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(A)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${A}" does not exist on source "${h.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const _=[];for(const A of c){const h=this._layers[A];h.type!=="custom"&&_.push(h.serialize())}return _}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;const _=this._changed;if(this._changed){const h=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(h.length||d.length)&&this._updateWorkerLayers(h,d);for(const w in this._updatedSources){const b=this._updatedSources[w];if(b==="reload")this._reloadSource(w);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(w)}}this._updateTilesForChangedImages();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}const A={};for(const h in this.sourceCaches){const d=this.sourceCaches[h];A[h]=d.used,d.used=!1}for(const h of this._order){const d=this._layers[h];d.recalculate(c,this._availableImages),!d.isHidden(c.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const h in A){const d=this.sourceCaches[h];A[h]!==d.used&&d.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(c),this.z=c.zoom,_&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const _ in this.sourceCaches)this.sourceCaches[_].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,_){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:_})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(c){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),c){const _=this.sourceCaches[c.source];if(!_)throw new Error(`cannot load terrain, because there exists no source with ID: ${c.source}`);this.terrain=new an(this,_,c),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=A=>{A.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=A=>{A.tile&&(A.sourceId===c.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(A.sourceId,A.tile.tileID)):A.source.type==="geojson"&&this.terrain.rememberForRerender(A.sourceId,A.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new o.Event("terrain",{terrain:c}))}setState(c){if(this._checkLoaded(),xn(this,o.validateStyle(c)))return!1;(c=o.clone$1(c)).layers=ri(c.layers);const _=function(h,d){if(!h)return[{command:Vn.setStyle,args:[d]}];let w=[];try{if(!M(h.version,d.version))return[{command:Vn.setStyle,args:[d]}];M(h.center,d.center)||w.push({command:Vn.setCenter,args:[d.center]}),M(h.zoom,d.zoom)||w.push({command:Vn.setZoom,args:[d.zoom]}),M(h.bearing,d.bearing)||w.push({command:Vn.setBearing,args:[d.bearing]}),M(h.pitch,d.pitch)||w.push({command:Vn.setPitch,args:[d.pitch]}),M(h.sprite,d.sprite)||w.push({command:Vn.setSprite,args:[d.sprite]}),M(h.glyphs,d.glyphs)||w.push({command:Vn.setGlyphs,args:[d.glyphs]}),M(h.transition,d.transition)||w.push({command:Vn.setTransition,args:[d.transition]}),M(h.light,d.light)||w.push({command:Vn.setLight,args:[d.light]});const b={},C=[];(function(B,V,W,X){let ae;for(ae in V=V||{},B=B||{})Object.prototype.hasOwnProperty.call(B,ae)&&(Object.prototype.hasOwnProperty.call(V,ae)||Qn(ae,W,X));for(ae in V)Object.prototype.hasOwnProperty.call(V,ae)&&(Object.prototype.hasOwnProperty.call(B,ae)?M(B[ae],V[ae])||(B[ae].type==="geojson"&&V[ae].type==="geojson"&&yo(B,V,ae)?W.push({command:Vn.setGeoJSONSourceData,args:[ae,V[ae].data]}):Gi(ae,V,W,X)):ki(ae,V,W))})(h.sources,d.sources,C,b);const P=[];h.layers&&h.layers.forEach(B=>{b[B.source]?w.push({command:Vn.removeLayer,args:[B.id]}):P.push(B)}),w=w.concat(C),function(B,V,W){V=V||[];const X=(B=B||[]).map(Ii),ae=V.map(Ii),ne=B.reduce($o,{}),ue=V.reduce($o,{}),be=X.slice(),Me=Object.create(null);let ve,$e,Se,Ge,xe,y,m;for(ve=0,$e=0;ve<X.length;ve++)Se=X[ve],Object.prototype.hasOwnProperty.call(ue,Se)?$e++:(W.push({command:Vn.removeLayer,args:[Se]}),be.splice(be.indexOf(Se,$e),1));for(ve=0,$e=0;ve<ae.length;ve++)Se=ae[ae.length-1-ve],be[be.length-1-ve]!==Se&&(Object.prototype.hasOwnProperty.call(ne,Se)?(W.push({command:Vn.removeLayer,args:[Se]}),be.splice(be.lastIndexOf(Se,be.length-$e),1)):$e++,y=be[be.length-ve],W.push({command:Vn.addLayer,args:[ue[Se],y]}),be.splice(be.length-ve,0,Se),Me[Se]=!0);for(ve=0;ve<ae.length;ve++)if(Se=ae[ve],Ge=ne[Se],xe=ue[Se],!Me[Se]&&!M(Ge,xe))if(M(Ge.source,xe.source)&&M(Ge["source-layer"],xe["source-layer"])&&M(Ge.type,xe.type)){for(m in jr(Ge.layout,xe.layout,W,Se,null,Vn.setLayoutProperty),jr(Ge.paint,xe.paint,W,Se,null,Vn.setPaintProperty),M(Ge.filter,xe.filter)||W.push({command:Vn.setFilter,args:[Se,xe.filter]}),M(Ge.minzoom,xe.minzoom)&&M(Ge.maxzoom,xe.maxzoom)||W.push({command:Vn.setLayerZoomRange,args:[Se,xe.minzoom,xe.maxzoom]}),Ge)Object.prototype.hasOwnProperty.call(Ge,m)&&m!=="layout"&&m!=="paint"&&m!=="filter"&&m!=="metadata"&&m!=="minzoom"&&m!=="maxzoom"&&(m.indexOf("paint.")===0?jr(Ge[m],xe[m],W,Se,m.slice(6),Vn.setPaintProperty):M(Ge[m],xe[m])||W.push({command:Vn.setLayerProperty,args:[Se,m,xe[m]]}));for(m in xe)Object.prototype.hasOwnProperty.call(xe,m)&&!Object.prototype.hasOwnProperty.call(Ge,m)&&m!=="layout"&&m!=="paint"&&m!=="filter"&&m!=="metadata"&&m!=="minzoom"&&m!=="maxzoom"&&(m.indexOf("paint.")===0?jr(Ge[m],xe[m],W,Se,m.slice(6),Vn.setPaintProperty):M(Ge[m],xe[m])||W.push({command:Vn.setLayerProperty,args:[Se,m,xe[m]]}))}else W.push({command:Vn.removeLayer,args:[Se]}),y=be[be.lastIndexOf(Se)+1],W.push({command:Vn.addLayer,args:[xe,y]})}(P,d.layers,w)}catch(b){console.warn("Unable to compute style diff:",b),w=[{command:Vn.setStyle,args:[d]}]}return w}(this.serialize(),c).filter(h=>!(h.command in Oe));if(_.length===0)return!1;const A=_.filter(h=>!(h.command in Ft));if(A.length>0)throw new Error(`Unimplemented: ${A.map(h=>h.command).join(", ")}.`);return _.forEach(h=>{h.command!=="setTransition"&&this[h.command].apply(this,h.args)}),this.stylesheet=c,!0}addImage(c,_){if(this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,_),this._afterImageUpdated(c)}updateImage(c,_){this.imageManager.updateImage(c,_)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,_,A={}){if(this._checkLoaded(),this.sourceCaches[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!_.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(_).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(_.type)>=0&&this._validate(o.validateStyle.source,`sources.${c}`,_,null,A))return;this.map&&this.map._collectResourceTiming&&(_.collectResourceTiming=!0);const h=this.sourceCaches[c]=new wt(c,_,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:h.serialize(),sourceId:c})),h.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error("There is no source with this ID");for(const A in this._layers)if(this._layers[A].source===c)return this.fire(new o.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${A}" is using it.`)));const _=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],_.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),_.setEventedParent(null),_.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,_){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error(`There is no source with this ID=${c}`);const A=this.sourceCaches[c].getSource();if(A.type!=="geojson")throw new Error(`geojsonSource.type is ${A.type}, which is !== 'geojson`);A.setData(_),this._changed=!0}getSource(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()}addLayer(c,_,A={}){this._checkLoaded();const h=c.id;if(this.getLayer(h))return void this.fire(new o.ErrorEvent(new Error(`Layer "${h}" already exists on this map.`)));let d;if(c.type==="custom"){if(xn(this,o.validateCustomStyleLayer(c)))return;d=o.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(h,c.source),c=o.clone$1(c),c=o.extend(c,{source:h})),this._validate(o.validateStyle.layer,`layers.${h}`,c,{arrayIndex:-1},A))return;d=o.createStyleLayer(c),this._validateLayer(d),d.setEventedParent(this,{layer:{id:h}}),this._serializedLayers[d.id]=d.serialize()}const w=_?this._order.indexOf(_):this._order.length;if(_&&w===-1)this.fire(new o.ErrorEvent(new Error(`Cannot add layer "${h}" before non-existing layer "${_}".`)));else{if(this._order.splice(w,0,h),this._layerOrderChanged=!0,this._layers[h]=d,this._removedLayers[h]&&d.source&&d.type!=="custom"){const b=this._removedLayers[h];delete this._removedLayers[h],b.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(c,_){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===_)return;const A=this._order.indexOf(c);this._order.splice(A,1);const h=_?this._order.indexOf(_):this._order.length;_&&h===-1?this.fire(new o.ErrorEvent(new Error(`Cannot move layer "${c}" before non-existing layer "${_}".`))):(this._order.splice(h,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();const _=this._layers[c];if(!_)return void this.fire(new o.ErrorEvent(new Error(`Cannot remove non-existing layer "${c}".`)));_.setEventedParent(null);const A=this._order.indexOf(c);this._order.splice(A,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=_,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],_.onRemove&&_.onRemove(this.map)}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,_,A){this._checkLoaded();const h=this.getLayer(c);h?h.minzoom===_&&h.maxzoom===A||(_!=null&&(h.minzoom=_),A!=null&&(h.maxzoom=A),this._updateLayer(h)):this.fire(new o.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,_,A={}){this._checkLoaded();const h=this.getLayer(c);if(h){if(!M(h.filter,_))return _==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(o.validateStyle.filter,`layers.${h.id}.filter`,_,null,A)||(h.filter=o.clone$1(_),this._updateLayer(h)))}else this.fire(new o.ErrorEvent(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return o.clone$1(this.getLayer(c).filter)}setLayoutProperty(c,_,A,h={}){this._checkLoaded();const d=this.getLayer(c);d?M(d.getLayoutProperty(_),A)||(d.setLayoutProperty(_,A,h),this._updateLayer(d)):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,_){const A=this.getLayer(c);if(A)return A.getLayoutProperty(_);this.fire(new o.ErrorEvent(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,_,A,h={}){this._checkLoaded();const d=this.getLayer(c);d?M(d.getPaintProperty(_),A)||(d.setPaintProperty(_,A,h)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getPaintProperty(c,_){return this.getLayer(c).getPaintProperty(_)}setFeatureState(c,_){this._checkLoaded();const A=c.source,h=c.sourceLayer,d=this.sourceCaches[A];if(d===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${A}' does not exist in the map's style.`)));const w=d.getSource().type;w==="geojson"&&h?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||h?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),d.setFeatureState(h,c.id,_)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,_){this._checkLoaded();const A=c.source,h=this.sourceCaches[A];if(h===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${A}' does not exist in the map's style.`)));const d=h.getSource().type,w=d==="vector"?c.sourceLayer:void 0;d!=="vector"||w?_&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(w,c.id,_):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();const _=c.source,A=c.sourceLayer,h=this.sourceCaches[_];if(h!==void 0)return h.getSource().type!=="vector"||A?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),h.getFeatureState(A,c.id)):void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,c=>c.serialize()),layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.sourceCaches[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(c){const _=w=>this._layers[w].type==="fill-extrusion",A={},h=[];for(let w=this._order.length-1;w>=0;w--){const b=this._order[w];if(_(b)){A[b]=w;for(const C of c){const P=C[b];if(P)for(const B of P)h.push(B)}}}h.sort((w,b)=>b.intersectionZ-w.intersectionZ);const d=[];for(let w=this._order.length-1;w>=0;w--){const b=this._order[w];if(_(b))for(let C=h.length-1;C>=0;C--){const P=h[C].feature;if(A[P.layer.id]<w)break;d.push(P),h.pop()}else for(const C of c){const P=C[b];if(P)for(const B of P)d.push(B.feature)}}return d}queryRenderedFeatures(c,_,A){_&&_.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",_.filter,null,_);const h={};if(_&&_.layers){if(!Array.isArray(_.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const w of _.layers){const b=this._layers[w];if(!b)return this.fire(new o.ErrorEvent(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];h[b.source]=!0}}const d=[];_.availableImages=this._availableImages;for(const w in this.sourceCaches)_.layers&&!h[w]||d.push(er(this.sourceCaches[w],this._layers,this._serializedLayers,c,_,A));return this.placement&&d.push(function(w,b,C,P,B,V,W){const X={},ae=V.queryRenderedSymbols(P),ne=[];for(const ue of Object.keys(ae).map(Number))ne.push(W[ue]);ne.sort(or);for(const ue of ne){const be=ue.featureIndex.lookupSymbolFeatures(ae[ue.bucketInstanceId],b,ue.bucketIndex,ue.sourceLayerIndex,B.filter,B.layers,B.availableImages,w);for(const Me in be){const ve=X[Me]=X[Me]||[],$e=be[Me];$e.sort((Se,Ge)=>{const xe=ue.featureSortOrder;if(xe){const y=xe.indexOf(Se.featureIndex);return xe.indexOf(Ge.featureIndex)-y}return Ge.featureIndex-Se.featureIndex});for(const Se of $e)ve.push(Se)}}for(const ue in X)X[ue].forEach(be=>{const Me=be.feature,ve=C[w[ue].source].getFeatureState(Me.layer["source-layer"],Me.id);Me.source=Me.layer.source,Me.layer["source-layer"]&&(Me.sourceLayer=Me.layer["source-layer"]),Me.state=ve});return X}(this._layers,this._serializedLayers,this.sourceCaches,c,_,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(c,_){_&&_.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",_.filter,null,_);const A=this.sourceCaches[c];return A?function(h,d){const w=h.getRenderableIds().map(P=>h.getTileByID(P)),b=[],C={};for(let P=0;P<w.length;P++){const B=w[P],V=B.tileID.canonical.key;C[V]||(C[V]=!0,B.querySourceFeatures(b,d))}return b}(A,_):[]}addSourceType(c,_,A){return Ce.getSourceType(c)?A(new Error(`A source type called "${c}" already exists.`)):(Ce.setSourceType(c,_),_.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:_.workerSourceURL},A):A(null,null))}getLight(){return this.light.getLight()}setLight(c,_={}){this._checkLoaded();const A=this.light.getLight();let h=!1;for(const w in c)if(!M(c[w],A[w])){h=!0;break}if(!h)return;const d={now:o.exported.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,_),this.light.updateTransitions(d)}_validate(c,_,A,h,d={}){return(!d||d.validate!==!1)&&xn(this,c.call(o.validateStyle,o.extend({key:_,style:this.serialize(),value:A,styleSpec:o.spec},h)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const _=this.sourceCaches[c];_.setEventedParent(null),_.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){this.sourceCaches[c].clearTiles()}_reloadSource(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()}_updateSources(c){for(const _ in this.sourceCaches)this.sourceCaches[_].update(c,this.terrain)}_generateCollisionBoxes(){for(const c in this.sourceCaches)this._reloadSource(c)}_updatePlacement(c,_,A,h,d=!1){let w=!1,b=!1;const C={};for(const P of this._order){const B=this._layers[P];if(B.type!=="symbol")continue;if(!C[B.source]){const W=this.sourceCaches[B.source];C[B.source]=W.getRenderableIds(!0).map(X=>W.getTileByID(X)).sort((X,ae)=>ae.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(ae.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(B,C[B.source],c.center.lng);w=w||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||A===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),c.zoom))&&(this.pauseablePlacement=new We(c,this.terrain,this._order,d,_,A,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),b=!0),w&&this.pauseablePlacement.placement.setStale()),b||w)for(const P of this._order){const B=this._layers[P];B.type==="symbol"&&this.placement.updateLayerOpacities(B,C[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,_,A){this.imageManager.getImages(_.icons,A),this._updateTilesForChangedImages();const h=this.sourceCaches[_.source];h&&h.setDependencies(_.tileID.key,_.type,_.icons)}getGlyphs(c,_,A){this.glyphManager.getGlyphs(_.stacks,A)}getResource(c,_,A){return o.makeRequest(_,A)}}Ce.getSourceType=function(L){return Tn[L]},Ce.setSourceType=function(L,c){Tn[L]=c},Ce.registerForPluginStateChange=o.registerForPluginStateChange;var cn="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const hi={prelude:rr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:rr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:rr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:rr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:rr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:rr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:rr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:rr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:rr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:rr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:rr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:rr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:rr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:rr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:rr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:rr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:rr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:rr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:rr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:rr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:rr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:rr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:rr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:rr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:rr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:rr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:rr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",cn),terrainDepth:rr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",cn),terrainCoords:rr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",cn)};function rr(L,c){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,A=c.match(/attribute ([\w]+) ([\w]+)/g),h=L.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=d?d.concat(h):h,b={};return{fragmentSource:L=L.replace(_,(C,P,B,V,W)=>(b[W]=!0,P==="define"?`
#ifndef HAS_UNIFORM_u_${W}
varying ${B} ${V} ${W};
#else
uniform ${B} ${V} u_${W};
#endif
`:`
#ifdef HAS_UNIFORM_u_${W}
    ${B} ${V} ${W} = u_${W};
#endif
`)),vertexSource:c=c.replace(_,(C,P,B,V,W)=>{const X=V==="float"?"vec2":"vec4",ae=W.match(/color/)?"color":X;return b[W]?P==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${B} ${X} a_${W};
varying ${B} ${V} ${W};
#else
uniform ${B} ${V} u_${W};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${B} ${V} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${ae}(a_${W}, u_${W}_t);
#else
    ${B} ${V} ${W} = u_${W};
#endif
`:P==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${B} ${X} a_${W};
#else
uniform ${B} ${V} u_${W};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${B} ${V} ${W} = a_${W};
#else
    ${B} ${V} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${B} ${V} ${W} = unpack_mix_${ae}(a_${W}, u_${W}_t);
#else
    ${B} ${V} ${W} = u_${W};
#endif
`}),staticAttributes:A,staticUniforms:w}}class pa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,_,A,h,d,w,b,C,P){this.context=c;let B=this.boundPaintVertexBuffers.length!==h.length;for(let V=0;!B&&V<h.length;V++)this.boundPaintVertexBuffers[V]!==h[V]&&(B=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===_&&this.boundLayoutVertexBuffer===A&&!B&&this.boundIndexBuffer===d&&this.boundVertexOffset===w&&this.boundDynamicVertexBuffer===b&&this.boundDynamicVertexBuffer2===C&&this.boundDynamicVertexBuffer3===P?(c.bindVertexArrayOES.set(this.vao),b&&b.bind(),d&&d.dynamicDraw&&d.bind(),C&&C.bind(),P&&P.bind()):this.freshBind(_,A,h,d,w,b,C,P)}freshBind(c,_,A,h,d,w,b,C){let P;const B=c.numAttributes,V=this.context,W=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=c,this.boundLayoutVertexBuffer=_,this.boundPaintVertexBuffers=A,this.boundIndexBuffer=h,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=C;else{P=V.currentNumAttributes||0;for(let X=B;X<P;X++)W.disableVertexAttribArray(X)}_.enableAttributes(W,c);for(const X of A)X.enableAttributes(W,c);w&&w.enableAttributes(W,c),b&&b.enableAttributes(W,c),C&&C.enableAttributes(W,c),_.bind(),_.setVertexAttribPointers(W,c,d);for(const X of A)X.bind(),X.setVertexAttribPointers(W,c,d);w&&(w.bind(),w.setVertexAttribPointers(W,c,d)),h&&h.bind(),b&&(b.bind(),b.setVertexAttribPointers(W,c,d)),C&&(C.bind(),C.setVertexAttribPointers(W,c,d)),V.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function De(L){const c=[];for(let _=0;_<L.length;_++){if(L[_]===null)continue;const A=L[_].split(" ");c.push(A.pop())}return c}class Ha{constructor(c,_,A,h,d,w,b){const C=c.gl;this.program=C.createProgram();const P=De(A.staticAttributes),B=h?h.getBinderAttributes():[],V=P.concat(B),W=hi.prelude.staticUniforms?De(hi.prelude.staticUniforms):[],X=A.staticUniforms?De(A.staticUniforms):[],ae=h?h.getBinderUniforms():[],ne=W.concat(X).concat(ae),ue=[];for(const xe of ne)ue.indexOf(xe)<0&&ue.push(xe);const be=h?h.defines():[];w&&be.push("#define OVERDRAW_INSPECTOR;"),b&&be.push("#define TERRAIN3D;");const Me=be.concat(hi.prelude.fragmentSource,A.fragmentSource).join(`
`),ve=be.concat(hi.prelude.vertexSource,A.vertexSource).join(`
`),$e=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource($e,Me),C.compileShader($e),C.attachShader(this.program,$e);const Se=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())return void(this.failedToCreate=!0);C.shaderSource(Se,ve),C.compileShader(Se),C.attachShader(this.program,Se),this.attributes={};const Ge={};this.numAttributes=V.length;for(let xe=0;xe<this.numAttributes;xe++)V[xe]&&(C.bindAttribLocation(this.program,xe,V[xe]),this.attributes[V[xe]]=xe);C.linkProgram(this.program),C.deleteShader(Se),C.deleteShader($e);for(let xe=0;xe<ue.length;xe++){const y=ue[xe];if(y&&!Ge[y]){const m=C.getUniformLocation(this.program,y);m&&(Ge[y]=m)}}this.fixedUniforms=d(c,Ge),this.terrainUniforms=((xe,y)=>({u_depth:new o.Uniform1i(xe,y.u_depth),u_terrain:new o.Uniform1i(xe,y.u_terrain),u_terrain_dim:new o.Uniform1f(xe,y.u_terrain_dim),u_terrain_matrix:new o.UniformMatrix4f(xe,y.u_terrain_matrix),u_terrain_unpack:new o.Uniform4f(xe,y.u_terrain_unpack),u_terrain_offset:new o.Uniform1f(xe,y.u_terrain_offset),u_terrain_exaggeration:new o.Uniform1f(xe,y.u_terrain_exaggeration)}))(c,Ge),this.binderUniforms=h?h.getUniforms(c,Ge):[]}draw(c,_,A,h,d,w,b,C,P,B,V,W,X,ae,ne,ue,be,Me){const ve=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(A),c.setStencilMode(h),c.setColorMode(d),c.setCullFace(w),C){c.activeTexture.set(ve.TEXTURE2),ve.bindTexture(ve.TEXTURE_2D,C.depthTexture),c.activeTexture.set(ve.TEXTURE3),ve.bindTexture(ve.TEXTURE_2D,C.texture);for(const Se in this.terrainUniforms)this.terrainUniforms[Se].set(C[Se])}for(const Se in this.fixedUniforms)this.fixedUniforms[Se].set(b[Se]);ne&&ne.setUniforms(c,this.binderUniforms,X,{zoom:ae});let $e=0;switch(_){case ve.LINES:$e=2;break;case ve.TRIANGLES:$e=3;break;case ve.LINE_STRIP:$e=1}for(const Se of W.get()){const Ge=Se.vaos||(Se.vaos={});(Ge[P]||(Ge[P]=new pa)).bind(c,this,B,ne?ne.getPaintVertexBuffers():[],V,Se.vertexOffset,ue,be,Me),ve.drawElements(_,Se.primitiveLength*$e,ve.UNSIGNED_SHORT,Se.primitiveOffset*$e*2)}}}function we(L,c,_){const A=1/Fr(_,1,c.transform.tileZoom),h=Math.pow(2,_.tileID.overscaledZ),d=_.tileSize*Math.pow(2,c.transform.tileZoom)/h,w=d*(_.tileID.canonical.x+_.tileID.wrap*h),b=d*_.tileID.canonical.y;return{u_image:0,u_texsize:_.imageAtlasTexture.size,u_scale:[A,L.fromScale,L.toScale],u_fade:L.t,u_pixel_coord_upper:[w>>16,b>>16],u_pixel_coord_lower:[65535&w,65535&b]}}const jo=(L,c,_,A)=>{const h=c.style.light,d=h.properties.get("position"),w=[d.x,d.y,d.z],b=o.create$1();h.properties.get("anchor")==="viewport"&&o.fromRotation(b,-c.transform.angle),o.transformMat3(w,w,b);const C=h.properties.get("color");return{u_matrix:L,u_lightpos:w,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+_,u_opacity:A}},Ss=(L,c,_,A,h,d,w)=>o.extend(jo(L,c,_,A),we(d,c,w),{u_height_factor:-Math.pow(2,h.overscaledZ)/w.tileSize/8}),Wa=L=>({u_matrix:L}),Qa=(L,c,_,A)=>o.extend(Wa(L),we(_,c,A)),ga=(L,c)=>({u_matrix:L,u_world:c}),Ml=(L,c,_,A,h)=>o.extend(Qa(L,c,_,A),{u_world:h}),ma=(L,c,_,A)=>{const h=L.transform;let d,w;if(A.paint.get("circle-pitch-alignment")==="map"){const b=Fr(_,1,h.zoom);d=!0,w=[b,b]}else d=!1,w=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(A.paint.get("circle-pitch-scale")==="map"),u_matrix:L.translatePosMatrix(c.posMatrix,_,A.paint.get("circle-translate"),A.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:L.pixelRatio,u_extrude_scale:w}},ii=(L,c,_)=>{const A=Fr(_,1,c.zoom),h=Math.pow(2,c.zoom-_.tileID.overscaledZ),d=_.tileID.overscaleFactor();return{u_matrix:L,u_camera_to_center_distance:c.cameraToCenterDistance,u_pixels_to_tile_units:A,u_extrude_scale:[c.pixelsToGLUnits[0]/(A*h),c.pixelsToGLUnits[1]/(A*h)],u_overscale_factor:d}},ge=(L,c,_=1)=>({u_matrix:L,u_color:c,u_overlay:0,u_overlay_scale:_}),Te=L=>({u_matrix:L}),Ne=(L,c,_,A)=>({u_matrix:L,u_extrude_scale:Fr(c,1,_),u_intensity:A});function lt(L,c){const _=Math.pow(2,c.canonical.z),A=c.canonical.y;return[new o.MercatorCoordinate(0,A/_).toLngLat().lat,new o.MercatorCoordinate(0,(A+1)/_).toLngLat().lat]}const bt=(L,c,_,A)=>{const h=L.transform;return{u_matrix:Br(L,c,_,A),u_ratio:1/Fr(c,1,h.zoom),u_device_pixel_ratio:L.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Qt=(L,c,_,A,h)=>o.extend(bt(L,c,_,h),{u_image:0,u_image_height:A}),Ln=(L,c,_,A,h)=>{const d=L.transform,w=en(c,d);return{u_matrix:Br(L,c,_,h),u_texsize:c.imageAtlasTexture.size,u_ratio:1/Fr(c,1,d.zoom),u_device_pixel_ratio:L.pixelRatio,u_image:0,u_scale:[w,A.fromScale,A.toScale],u_fade:A.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Dr=(L,c,_,A,h,d)=>{const w=L.lineAtlas,b=en(c,L.transform),C=_.layout.get("line-cap")==="round",P=w.getDash(A.from,C),B=w.getDash(A.to,C),V=P.width*h.fromScale,W=B.width*h.toScale;return o.extend(bt(L,c,_,d),{u_patternscale_a:[b/V,-P.height/2],u_patternscale_b:[b/W,-B.height/2],u_sdfgamma:w.width/(256*Math.min(V,W)*L.pixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:B.y,u_mix:h.t})};function en(L,c){return 1/Fr(L,1,c.tileZoom)}function Br(L,c,_,A){return L.translatePosMatrix(A?A.posMatrix:c.tileID.posMatrix,c,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}const Gn=(L,c,_,A,h)=>{return{u_matrix:L,u_tl_parent:c,u_scale_parent:_,u_buffer_scale:1,u_fade_t:A.mix,u_opacity:A.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(w=h.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(d=h.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:vA(h.paint.get("raster-hue-rotate"))};var d,w};function vA(L){L*=Math.PI/180;const c=Math.sin(L),_=Math.cos(L);return[(2*_+1)/3,(-Math.sqrt(3)*c-_+1)/3,(Math.sqrt(3)*c-_+1)/3]}const xA=(L,c,_,A,h,d,w,b,C,P)=>{const B=h.transform;return{u_is_size_zoom_constant:+(L==="constant"||L==="source"),u_is_size_feature_constant:+(L==="constant"||L==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+_,u_aspect_ratio:B.width/B.height,u_fade_change:h.options.fadeDuration?h.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:w,u_coord_matrix:b,u_is_text:+C,u_pitch_with_map:+A,u_texsize:P,u_texture:0}},wA=(L,c,_,A,h,d,w,b,C,P,B)=>{const V=h.transform;return o.extend(xA(L,c,_,A,h,d,w,b,C,P),{u_gamma_scale:A?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:h.pixelRatio,u_is_halo:+B})},iu=(L,c,_,A,h,d,w,b,C,P)=>o.extend(wA(L,c,_,A,h,d,w,b,!0,C,!0),{u_texsize_icon:P,u_texture_icon:1}),su=(L,c,_)=>({u_matrix:L,u_opacity:c,u_color:_}),bA=(L,c,_,A,h,d)=>o.extend(function(w,b,C,P){const B=C.imageManager.getPattern(w.from.toString()),V=C.imageManager.getPattern(w.to.toString()),{width:W,height:X}=C.imageManager.getPixelSize(),ae=Math.pow(2,P.tileID.overscaledZ),ne=P.tileSize*Math.pow(2,C.transform.tileZoom)/ae,ue=ne*(P.tileID.canonical.x+P.tileID.wrap*ae),be=ne*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[W,X],u_mix:b.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/Fr(P,1,C.transform.tileZoom),u_pixel_coord_upper:[ue>>16,be>>16],u_pixel_coord_lower:[65535&ue,65535&be]}}(A,d,_,h),{u_matrix:L,u_opacity:c}),Pl={fillExtrusion:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_lightpos:new o.Uniform3f(L,c.u_lightpos),u_lightintensity:new o.Uniform1f(L,c.u_lightintensity),u_lightcolor:new o.Uniform3f(L,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(L,c.u_vertical_gradient),u_opacity:new o.Uniform1f(L,c.u_opacity)}),fillExtrusionPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_lightpos:new o.Uniform3f(L,c.u_lightpos),u_lightintensity:new o.Uniform1f(L,c.u_lightintensity),u_lightcolor:new o.Uniform3f(L,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(L,c.u_vertical_gradient),u_height_factor:new o.Uniform1f(L,c.u_height_factor),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade),u_opacity:new o.Uniform1f(L,c.u_opacity)}),fill:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),fillPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),fillOutline:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world)}),fillOutlinePattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),circle:(L,c)=>({u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(L,c.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(L,c.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),collisionBox:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(L,c.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(L,c.u_extrude_scale),u_overscale_factor:new o.Uniform1f(L,c.u_overscale_factor)}),collisionCircle:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_inv_matrix:new o.UniformMatrix4f(L,c.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(L,c.u_viewport_size)}),debug:(L,c)=>({u_color:new o.UniformColor(L,c.u_color),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_overlay:new o.Uniform1i(L,c.u_overlay),u_overlay_scale:new o.Uniform1f(L,c.u_overlay_scale)}),clippingMask:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),heatmap:(L,c)=>({u_extrude_scale:new o.Uniform1f(L,c.u_extrude_scale),u_intensity:new o.Uniform1f(L,c.u_intensity),u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),heatmapTexture:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world),u_image:new o.Uniform1i(L,c.u_image),u_color_ramp:new o.Uniform1i(L,c.u_color_ramp),u_opacity:new o.Uniform1f(L,c.u_opacity)}),hillshade:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_latrange:new o.Uniform2f(L,c.u_latrange),u_light:new o.Uniform2f(L,c.u_light),u_shadow:new o.UniformColor(L,c.u_shadow),u_highlight:new o.UniformColor(L,c.u_highlight),u_accent:new o.UniformColor(L,c.u_accent)}),hillshadePrepare:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_dimension:new o.Uniform2f(L,c.u_dimension),u_zoom:new o.Uniform1f(L,c.u_zoom),u_unpack:new o.Uniform4f(L,c.u_unpack)}),line:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels)}),lineGradient:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_image:new o.Uniform1i(L,c.u_image),u_image_height:new o.Uniform1f(L,c.u_image_height)}),linePattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texsize:new o.Uniform2f(L,c.u_texsize),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_image:new o.Uniform1i(L,c.u_image),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),lineSDF:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(L,c.u_patternscale_a),u_patternscale_b:new o.Uniform2f(L,c.u_patternscale_b),u_sdfgamma:new o.Uniform1f(L,c.u_sdfgamma),u_image:new o.Uniform1i(L,c.u_image),u_tex_y_a:new o.Uniform1f(L,c.u_tex_y_a),u_tex_y_b:new o.Uniform1f(L,c.u_tex_y_b),u_mix:new o.Uniform1f(L,c.u_mix)}),raster:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_tl_parent:new o.Uniform2f(L,c.u_tl_parent),u_scale_parent:new o.Uniform1f(L,c.u_scale_parent),u_buffer_scale:new o.Uniform1f(L,c.u_buffer_scale),u_fade_t:new o.Uniform1f(L,c.u_fade_t),u_opacity:new o.Uniform1f(L,c.u_opacity),u_image0:new o.Uniform1i(L,c.u_image0),u_image1:new o.Uniform1i(L,c.u_image1),u_brightness_low:new o.Uniform1f(L,c.u_brightness_low),u_brightness_high:new o.Uniform1f(L,c.u_brightness_high),u_saturation_factor:new o.Uniform1f(L,c.u_saturation_factor),u_contrast_factor:new o.Uniform1f(L,c.u_contrast_factor),u_spin_weights:new o.Uniform3f(L,c.u_spin_weights)}),symbolIcon:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texture:new o.Uniform1i(L,c.u_texture)}),symbolSDF:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texture:new o.Uniform1i(L,c.u_texture),u_gamma_scale:new o.Uniform1f(L,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(L,c.u_is_halo)}),symbolTextAndIcon:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texsize_icon:new o.Uniform2f(L,c.u_texsize_icon),u_texture:new o.Uniform1i(L,c.u_texture),u_texture_icon:new o.Uniform1i(L,c.u_texture_icon),u_gamma_scale:new o.Uniform1f(L,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(L,c.u_is_halo)}),background:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_opacity:new o.Uniform1f(L,c.u_opacity),u_color:new o.UniformColor(L,c.u_color)}),backgroundPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_opacity:new o.Uniform1f(L,c.u_opacity),u_image:new o.Uniform1i(L,c.u_image),u_pattern_tl_a:new o.Uniform2f(L,c.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(L,c.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(L,c.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(L,c.u_pattern_br_b),u_texsize:new o.Uniform2f(L,c.u_texsize),u_mix:new o.Uniform1f(L,c.u_mix),u_pattern_size_a:new o.Uniform2f(L,c.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(L,c.u_pattern_size_b),u_scale_a:new o.Uniform1f(L,c.u_scale_a),u_scale_b:new o.Uniform1f(L,c.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(L,c.u_tile_units_to_pixels)}),terrain:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texture:new o.Uniform1i(L,c.u_texture)}),terrainDepth:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),terrainCoords:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texture:new o.Uniform1i(L,c.u_texture),u_terrain_coords_id:new o.Uniform1f(L,c.u_terrain_coords_id)})};class kl{constructor(c,_,A){this.context=c;const h=c.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!A,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const _=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),_.bufferSubData(_.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const EA={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class TA{constructor(c,_,A,h){this.length=_.length,this.attributes=A,this.itemSize=_.bytesPerElement,this.dynamicDraw=h,this.context=c;const d=c.gl;this.buffer=d.createBuffer(),c.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);const _=this.context.gl;this.bind(),_.bufferSubData(_.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,_){for(let A=0;A<this.attributes.length;A++){const h=_.attributes[this.attributes[A].name];h!==void 0&&c.enableVertexAttribArray(h)}}setVertexAttribPointers(c,_,A){for(let h=0;h<this.attributes.length;h++){const d=this.attributes[h],w=_.attributes[d.name];w!==void 0&&c.vertexAttribPointer(w,d.components,c[EA[d.type]],!1,this.itemSize,d.offset+this.itemSize*(A||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Xn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ou extends Xn{getDefault(){return o.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class gc extends Xn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Il extends Xn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Yr extends Xn{getDefault(){return[!0,!0,!0,!0]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Ho extends Xn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class zn extends Xn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Cs extends Xn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const _=this.current;(c.func!==_.func||c.ref!==_.ref||c.mask!==_.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class si extends Xn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class _o extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.STENCIL_TEST):_.disable(_.STENCIL_TEST),this.current=c,this.dirty=!1}}class Ll extends Xn{getDefault(){return[0,1]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Wo extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.DEPTH_TEST):_.disable(_.DEPTH_TEST),this.current=c,this.dirty=!1}}class ya extends Xn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class vo extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.BLEND):_.disable(_.BLEND),this.current=c,this.dirty=!1}}class SA extends Xn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class qa extends Xn{getDefault(){return o.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Qo extends Xn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Wi extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE),this.current=c,this.dirty=!1}}class Qi extends Xn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class au extends Xn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class Dl extends Xn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class xo extends Xn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class qo extends Xn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class mc extends Xn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class lu extends Xn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindRenderbuffer(_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Rl extends Xn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindTexture(_.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class CA extends Xn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindBuffer(_.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Au extends Xn{getDefault(){return null}set(c){const _=this.gl;_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Zo extends Xn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class Za extends Xn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class uu extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class cu extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class wo extends Xn{constructor(c,_){super(c),this.context=c,this.parent=_}getDefault(){return null}}class _a extends wo{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class hu extends wo{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class va{constructor(c,_,A,h){this.context=c,this.width=_,this.height=A;const d=c.gl,w=this.framebuffer=d.createFramebuffer();if(this.colorAttachment=new _a(c,w),h&&(this.depthAttachment=new hu(c,w)),d.checkFramebufferStatus(d.FRAMEBUFFER)!==d.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const c=this.context.gl,_=this.colorAttachment.get();if(_&&c.deleteTexture(_),this.depthAttachment){const A=this.depthAttachment.get();A&&c.deleteRenderbuffer(A)}c.deleteFramebuffer(this.framebuffer)}}class fr{constructor(c,_,A){this.blendFunction=c,this.blendColor=_,this.mask=A}}fr.Replace=[1,0],fr.disabled=new fr(fr.Replace,o.Color.transparent,[!1,!1,!1,!1]),fr.unblended=new fr(fr.Replace,o.Color.transparent,[!0,!0,!0,!0]),fr.alphaBlended=new fr([1,771],o.Color.transparent,[!0,!0,!0,!0]);class $s{constructor(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ou(this),this.clearDepth=new gc(this),this.clearStencil=new Il(this),this.colorMask=new Yr(this),this.depthMask=new Ho(this),this.stencilMask=new zn(this),this.stencilFunc=new Cs(this),this.stencilOp=new si(this),this.stencilTest=new _o(this),this.depthRange=new Ll(this),this.depthTest=new Wo(this),this.depthFunc=new ya(this),this.blend=new vo(this),this.blendFunc=new SA(this),this.blendColor=new qa(this),this.blendEquation=new Qo(this),this.cullFace=new Wi(this),this.cullFaceSide=new Qi(this),this.frontFace=new au(this),this.program=new Dl(this),this.activeTexture=new xo(this),this.viewport=new qo(this),this.bindFramebuffer=new mc(this),this.bindRenderbuffer=new lu(this),this.bindTexture=new Rl(this),this.bindVertexBuffer=new CA(this),this.bindElementBuffer=new Au(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Zo(this),this.pixelStoreUnpack=new Za(this),this.pixelStoreUnpackPremultiplyAlpha=new uu(this),this.pixelStoreUnpackFlipY=new cu(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,_){return new kl(this,c,_)}createVertexBuffer(c,_,A){return new TA(this,c,_,A)}createRenderbuffer(c,_,A){const h=this.gl,d=h.createRenderbuffer();return this.bindRenderbuffer.set(d),h.renderbufferStorage(h.RENDERBUFFER,c,_,A),this.bindRenderbuffer.set(null),d}createFramebuffer(c,_,A){return new va(this,c,_,A)}clear({color:c,depth:_}){const A=this.gl;let h=0;c&&(h|=A.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),_!==void 0&&(h|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),A.clear(h)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){M(c.blendFunction,fr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class $n{constructor(c,_,A){this.func=c,this.mask=_,this.range=A}}$n.ReadOnly=!1,$n.ReadWrite=!0,$n.disabled=new $n(519,$n.ReadOnly,[0,1]);const qn=7680;class br{constructor(c,_,A,h,d,w){this.test=c,this.ref=_,this.mask=A,this.fail=h,this.depthFail=d,this.pass=w}}br.disabled=new br({func:519,mask:0},0,0,qn,qn,qn);class pr{constructor(c,_,A){this.enable=c,this.mode=_,this.frontFace=A}}let Bl;function Yo(L,c,_,A,h,d,w){const b=L.context,C=b.gl,P=L.useProgram("collisionBox"),B=[];let V=0,W=0;for(let ve=0;ve<A.length;ve++){const $e=A[ve],Se=c.getTile($e),Ge=Se.getBucket(_);if(!Ge)continue;let xe=$e.posMatrix;h[0]===0&&h[1]===0||(xe=L.translatePosMatrix($e.posMatrix,Se,h,d));const y=w?Ge.textCollisionBox:Ge.iconCollisionBox,m=Ge.collisionCircleArray;if(m.length>0){const x=o.create(),E=xe;o.mul(x,Ge.placementInvProjMatrix,L.transform.glCoordMatrix),o.mul(x,x,Ge.placementViewportMatrix),B.push({circleArray:m,circleOffset:W,transform:E,invTransform:x,coord:$e}),V+=m.length/4,W=V}y&&P.draw(b,C.LINES,$n.disabled,br.disabled,L.colorModeForRenderPass(),pr.disabled,ii(xe,L.transform,Se),L.style.terrain&&L.style.terrain.getTerrainData($e),_.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,null,L.transform.zoom,null,null,y.collisionVertexBuffer)}if(!w||!B.length)return;const X=L.useProgram("collisionCircle"),ae=new o.CollisionCircleLayoutArray;ae.resize(4*V),ae._trim();let ne=0;for(const ve of B)for(let $e=0;$e<ve.circleArray.length/4;$e++){const Se=4*$e,Ge=ve.circleArray[Se+0],xe=ve.circleArray[Se+1],y=ve.circleArray[Se+2],m=ve.circleArray[Se+3];ae.emplace(ne++,Ge,xe,y,m,0),ae.emplace(ne++,Ge,xe,y,m,1),ae.emplace(ne++,Ge,xe,y,m,2),ae.emplace(ne++,Ge,xe,y,m,3)}(!Bl||Bl.length<2*V)&&(Bl=function(ve){const $e=2*ve,Se=new o.QuadTriangleArray;Se.resize($e),Se._trim();for(let Ge=0;Ge<$e;Ge++){const xe=6*Ge;Se.uint16[xe+0]=4*Ge+0,Se.uint16[xe+1]=4*Ge+1,Se.uint16[xe+2]=4*Ge+2,Se.uint16[xe+3]=4*Ge+2,Se.uint16[xe+4]=4*Ge+3,Se.uint16[xe+5]=4*Ge+0}return Se}(V));const ue=b.createIndexBuffer(Bl,!0),be=b.createVertexBuffer(ae,o.collisionCircleLayout.members,!0);for(const ve of B){const $e={u_matrix:ve.transform,u_inv_matrix:ve.invTransform,u_camera_to_center_distance:(Me=L.transform).cameraToCenterDistance,u_viewport_size:[Me.width,Me.height]};X.draw(b,C.TRIANGLES,$n.disabled,br.disabled,L.colorModeForRenderPass(),pr.disabled,$e,L.style.terrain&&L.style.terrain.getTerrainData(ve.coord),_.id,be,ue,o.SegmentVector.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,L.transform.zoom,null,null,null)}var Me;be.destroy(),ue.destroy()}pr.disabled=new pr(!1,1029,2305),pr.backCCW=new pr(!0,1029,2305);const yc=o.identity(new Float32Array(16));function Ya(L,c,_,A,h,d){const{horizontalAlign:w,verticalAlign:b}=o.getAnchorAlignment(L),C=-(w-.5)*c,P=-(b-.5)*_,B=o.evaluateVariableOffset(L,A);return new o.pointGeometry((C/h+B[0])*d,(P/h+B[1])*d)}function _c(L,c,_,A,h,d,w,b,C,P,B){const V=L.text.placedSymbolArray,W=L.text.dynamicLayoutVertexArray,X=L.icon.dynamicLayoutVertexArray,ae={};W.clear();for(let ne=0;ne<V.length;ne++){const ue=V.get(ne),be=L.allowVerticalPlacement&&!ue.placedOrientation,Me=ue.hidden||!ue.crossTileID||be?null:A[ue.crossTileID];if(Me){const ve=new o.pointGeometry(ue.anchorX,ue.anchorY),$e=Bn(ve,_?w:d,B),Se=$i(h.cameraToCenterDistance,$e.signedDistanceFromCamera);let Ge=o.evaluateSizeForFeature(L.textSizeData,C,ue)*Se/o.ONE_EM;_&&(Ge*=L.tilePixelRatio/b);const{width:xe,height:y,anchor:m,textOffset:x,textBoxScale:E}=Me,I=Ya(m,xe,y,x,E,Ge),R=_?Bn(ve.add(I),d,B).point:$e.point.add(c?I.rotate(-h.angle):I),O=L.allowVerticalPlacement&&ue.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let U=0;U<ue.numGlyphs;U++)o.addDynamicAttributes(W,R,O);P&&ue.associatedIconIndex>=0&&(ae[ue.associatedIconIndex]={shiftedAnchor:R,angle:O})}else yn(ue.numGlyphs,W)}if(P){X.clear();const ne=L.icon.placedSymbolArray;for(let ue=0;ue<ne.length;ue++){const be=ne.get(ue);if(be.hidden)yn(be.numGlyphs,X);else{const Me=ae[ue];if(Me)for(let ve=0;ve<be.numGlyphs;ve++)o.addDynamicAttributes(X,Me.shiftedAnchor,Me.angle);else yn(be.numGlyphs,X)}}L.icon.dynamicLayoutVertexBuffer.updateData(X)}L.text.dynamicLayoutVertexBuffer.updateData(W)}function fu(L,c,_){return _.iconsInText&&c?"symbolTextAndIcon":L?"symbolSDF":"symbolIcon"}function js(L,c,_,A,h,d,w,b,C,P,B,V){const W=L.context,X=W.gl,ae=L.transform,ne=b==="map",ue=C==="map",be=b!=="viewport"&&_.layout.get("symbol-placement")!=="point",Me=ne&&!ue&&!be,ve=!_.layout.get("symbol-sort-key").isConstant();let $e=!1;const Se=L.depthModeForSublayer(0,$n.ReadOnly),Ge=_.layout.get("text-variable-anchor"),xe=[];for(const y of A){const m=c.getTile(y),x=m.getBucket(_);if(!x)continue;const E=h?x.text:x.icon;if(!E||!E.segments.get().length)continue;const I=E.programConfigurations.get(_.id),R=h||x.sdfIcons,O=h?x.textSizeData:x.iconSizeData,U=ue||ae.pitch!==0,q=L.useProgram(fu(R,h,x),I),ee=o.evaluateSizeForZoom(O,ae.zoom),le=L.style.terrain&&L.style.terrain.getTerrainData(y);let de,Re,je,Be,Ke=[0,0],ft=null;if(h){if(Re=m.glyphAtlasTexture,je=X.LINEAR,de=m.glyphAtlasTexture.size,x.iconsInText){Ke=m.imageAtlasTexture.size,ft=m.imageAtlasTexture;const _n=O.kind==="composite"||O.kind==="camera";Be=U||L.options.rotating||L.options.zooming||_n?X.LINEAR:X.NEAREST}}else{const _n=_.layout.get("icon-size").constantOr(0)!==1||x.iconsNeedLinear;Re=m.imageAtlasTexture,je=R||L.options.rotating||L.options.zooming||_n||U?X.LINEAR:X.NEAREST,de=m.imageAtlasTexture.size}const ct=Fr(m,1,L.transform.zoom),st=Us(y.posMatrix,ue,ne,L.transform,ct),ot=bi(y.posMatrix,ue,ne,L.transform,ct),Je=Ge&&x.hasTextData(),Gt=_.layout.get("icon-text-fit")!=="none"&&Je&&x.hasIconData();if(be){const _n=L.style.terrain?(Dn,ar)=>L.style.terrain.getElevation(y,Dn,ar):null,En=_.layout.get("text-rotation-alignment")==="map";Di(x,y.posMatrix,L,h,st,ot,ue,P,En,_n)}const zt=L.translatePosMatrix(y.posMatrix,m,d,w),gt=be||h&&Ge||Gt?yc:st,vt=L.translatePosMatrix(ot,m,d,w,!0),Pn=R&&_.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let wn;wn=R?x.iconsInText?iu(O.kind,ee,Me,ue,L,zt,gt,vt,de,Ke):wA(O.kind,ee,Me,ue,L,zt,gt,vt,h,de,!0):xA(O.kind,ee,Me,ue,L,zt,gt,vt,h,de);const mn={program:q,buffers:E,uniformValues:wn,atlasTexture:Re,atlasTextureIcon:ft,atlasInterpolation:je,atlasInterpolationIcon:Be,isSDF:R,hasHalo:Pn};if(ve&&x.canOverlap){$e=!0;const _n=E.segments.get();for(const En of _n)xe.push({segments:new o.SegmentVector([En]),sortKey:En.sortKey,state:mn,terrainData:le})}else xe.push({segments:E.segments,sortKey:0,state:mn,terrainData:le})}$e&&xe.sort((y,m)=>y.sortKey-m.sortKey);for(const y of xe){const m=y.state;if(W.activeTexture.set(X.TEXTURE0),m.atlasTexture.bind(m.atlasInterpolation,X.CLAMP_TO_EDGE),m.atlasTextureIcon&&(W.activeTexture.set(X.TEXTURE1),m.atlasTextureIcon&&m.atlasTextureIcon.bind(m.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),m.isSDF){const x=m.uniformValues;m.hasHalo&&(x.u_is_halo=1,zl(m.buffers,y.segments,_,L,m.program,Se,B,V,x,y.terrainData)),x.u_is_halo=0}zl(m.buffers,y.segments,_,L,m.program,Se,B,V,m.uniformValues,y.terrainData)}}function zl(L,c,_,A,h,d,w,b,C,P){const B=A.context;h.draw(B,B.gl.TRIANGLES,d,w,b,pr.disabled,C,P,_.id,L.layoutVertexBuffer,L.indexBuffer,c,_.paint,A.transform.zoom,L.programConfigurations.get(_.id),L.dynamicLayoutVertexBuffer,L.opacityVertexBuffer)}function Xa(L,c,_,A,h,d,w){const b=L.context.gl,C=_.paint.get("fill-pattern"),P=C&&C.constantOr(1),B=_.getCrossfadeParameters();let V,W,X,ae,ne;w?(W=P&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=b.LINES):(W=P?"fillPattern":"fill",V=b.TRIANGLES);for(const ue of A){const be=c.getTile(ue);if(P&&!be.patternsLoaded())continue;const Me=be.getBucket(_);if(!Me)continue;const ve=Me.programConfigurations.get(_.id),$e=L.useProgram(W,ve),Se=L.style.terrain&&L.style.terrain.getTerrainData(ue);P&&(L.context.activeTexture.set(b.TEXTURE0),be.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),ve.updatePaintBuffers(B));const Ge=C.constantOr(null);if(Ge&&be.imageAtlas){const m=be.imageAtlas,x=m.patternPositions[Ge.to.toString()],E=m.patternPositions[Ge.from.toString()];x&&E&&ve.setConstantPatternPositions(x,E)}const xe=Se?ue:null,y=L.translatePosMatrix(xe?xe.posMatrix:ue.posMatrix,be,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor"));if(w){ae=Me.indexBuffer2,ne=Me.segments2;const m=[b.drawingBufferWidth,b.drawingBufferHeight];X=W==="fillOutlinePattern"&&P?Ml(y,L,B,be,m):ga(y,m)}else ae=Me.indexBuffer,ne=Me.segments,X=P?Qa(y,L,B,be):Wa(y);$e.draw(L.context,V,h,L.stencilModeForClipping(ue),d,pr.disabled,X,Se,_.id,Me.layoutVertexBuffer,ae,ne,_.paint,L.transform.zoom,ve)}}function xa(L,c,_,A,h,d,w){const b=L.context,C=b.gl,P=_.paint.get("fill-extrusion-pattern"),B=P.constantOr(1),V=_.getCrossfadeParameters(),W=_.paint.get("fill-extrusion-opacity");for(const X of A){const ae=c.getTile(X),ne=ae.getBucket(_);if(!ne)continue;const ue=L.style.terrain&&L.style.terrain.getTerrainData(X),be=ne.programConfigurations.get(_.id),Me=L.useProgram(B?"fillExtrusionPattern":"fillExtrusion",be);B&&(L.context.activeTexture.set(C.TEXTURE0),ae.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),be.updatePaintBuffers(V));const ve=P.constantOr(null);if(ve&&ae.imageAtlas){const xe=ae.imageAtlas,y=xe.patternPositions[ve.to.toString()],m=xe.patternPositions[ve.from.toString()];y&&m&&be.setConstantPatternPositions(y,m)}const $e=L.translatePosMatrix(X.posMatrix,ae,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),Se=_.paint.get("fill-extrusion-vertical-gradient"),Ge=B?Ss($e,L,Se,W,X,V,ae):jo($e,L,Se,W);Me.draw(b,b.gl.TRIANGLES,h,d,w,pr.backCCW,Ge,ue,_.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,_.paint,L.transform.zoom,be,L.style.terrain&&ne.centroidVertexBuffer)}}function Ol(L,c,_,A,h,d,w){const b=L.context,C=b.gl,P=_.fbo;if(!P)return;const B=L.useProgram("hillshade"),V=L.style.terrain&&L.style.terrain.getTerrainData(c);b.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,P.colorAttachment.get()),B.draw(b,C.TRIANGLES,h,d,w,pr.disabled,((W,X,ae,ne)=>{const ue=ae.paint.get("hillshade-shadow-color"),be=ae.paint.get("hillshade-highlight-color"),Me=ae.paint.get("hillshade-accent-color");let ve=ae.paint.get("hillshade-illumination-direction")*(Math.PI/180);ae.paint.get("hillshade-illumination-anchor")==="viewport"&&(ve-=W.transform.angle);const $e=!W.options.moving;return{u_matrix:ne?ne.posMatrix:W.transform.calculatePosMatrix(X.tileID.toUnwrapped(),$e),u_image:0,u_latrange:lt(0,X.tileID),u_light:[ae.paint.get("hillshade-exaggeration"),ve],u_shadow:ue,u_highlight:be,u_accent:Me}})(L,_,A,V?c:null),V,A.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}function Fl(L,c,_,A,h,d){const w=L.context,b=w.gl,C=c.dem;if(C&&C.data){const P=C.dim,B=C.stride,V=C.getPixels();if(w.activeTexture.set(b.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||L.getTileTexture(B),c.demTexture){const X=c.demTexture;X.update(V,{premultiply:!1}),X.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else c.demTexture=new j(w,V,b.RGBA,{premultiply:!1}),c.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);w.activeTexture.set(b.TEXTURE0);let W=c.fbo;if(!W){const X=new j(w,{width:P,height:P,data:null},b.RGBA);X.bind(b.LINEAR,b.CLAMP_TO_EDGE),W=c.fbo=w.createFramebuffer(P,P,!0),W.colorAttachment.set(X.texture)}w.bindFramebuffer.set(W.framebuffer),w.viewport.set([0,0,P,P]),L.useProgram("hillshadePrepare").draw(w,b.TRIANGLES,A,h,d,pr.disabled,((X,ae)=>{const ne=ae.stride,ue=o.create();return o.ortho(ue,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(ue,ue,[0,-o.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[ne,ne],u_zoom:X.overscaledZ,u_unpack:ae.getUnpackVector()}})(c.tileID,C),null,_.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function gr(L,c,_,A,h,d){const w=A.paint.get("raster-fade-duration");if(!d&&w>0){const b=o.exported.now(),C=(b-L.timeAdded)/w,P=c?(b-c.timeAdded)/w:-1,B=_.getSource(),V=h.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),W=!c||Math.abs(c.tileID.overscaledZ-V)>Math.abs(L.tileID.overscaledZ-V),X=W&&L.refreshedUponExpiration?1:o.clamp(W?C:1-P,0,1);return L.refreshedUponExpiration&&C>=1&&(L.refreshedUponExpiration=!1),c?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const MA=new o.Color(1,0,0,1),cs=new o.Color(0,1,0,1),du=new o.Color(0,0,1,1),Nl=new o.Color(1,0,1,1),vc=new o.Color(0,1,1,1);function Xr(L,c,_,A){oi(L,0,c+_/2,L.transform.width,_,A)}function zr(L,c,_,A){oi(L,c-_/2,0,_,L.transform.height,A)}function oi(L,c,_,A,h,d){const w=L.context,b=w.gl;b.enable(b.SCISSOR_TEST),b.scissor(c*L.pixelRatio,_*L.pixelRatio,A*L.pixelRatio,h*L.pixelRatio),w.clear({color:d}),b.disable(b.SCISSOR_TEST)}function pu(L,c,_){const A=L.context,h=A.gl,d=_.posMatrix,w=L.useProgram("debug"),b=$n.disabled,C=br.disabled,P=L.colorModeForRenderPass(),B="$debug",V=L.style.terrain&&L.style.terrain.getTerrainData(_);A.activeTexture.set(h.TEXTURE0),L.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE);const W=c.getTileByID(_.key).latestRawTileData,X=Math.floor((W&&W.byteLength||0)/1024),ae=c.getTile(_).tileSize,ne=512/Math.min(ae,512)*(_.overscaledZ/L.transform.zoom)*.5;let ue=_.canonical.toString();_.overscaledZ!==_.canonical.z&&(ue+=` => ${_.overscaledZ}`),function(be,Me){be.initDebugOverlayCanvas();const ve=be.debugOverlayCanvas,$e=be.context.gl,Se=be.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,ve.width,ve.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(Me,5,5),Se.strokeText(Me,5,5),be.debugOverlayTexture.update(ve),be.debugOverlayTexture.bind($e.LINEAR,$e.CLAMP_TO_EDGE)}(L,`${ue} ${X}kB`),w.draw(A,h.TRIANGLES,b,C,fr.alphaBlended,pr.disabled,ge(d,o.Color.transparent,ne),null,B,L.debugBuffer,L.quadTriangleIndexBuffer,L.debugSegments),w.draw(A,h.LINE_STRIP,b,C,P,pr.disabled,ge(d,o.Color.red),V,B,L.debugBuffer,L.tileBorderIndexBuffer,L.debugSegments)}function Hs(L,c,_){const A=L.context,h=A.gl,d=L.colorModeForRenderPass(),w=new $n(h.LEQUAL,$n.ReadWrite,L.depthRangeFor3D),b=L.useProgram("terrain"),C=c.getTerrainMesh(),P=c.getTerrainData(_.tileID);A.bindFramebuffer.set(null),A.viewport.set([0,0,L.width,L.height]),A.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,c.getRTTFramebuffer().colorAttachment.get());const B=L.transform.calculatePosMatrix(_.tileID.toUnwrapped());b.draw(A,h.TRIANGLES,w,br.disabled,d,pr.backCCW,{u_matrix:B,u_texture:0},P,"terrain",C.vertexBuffer,C.indexBuffer,C.segments)}function xc(L,c,_,A){const h=L.context,d=_.tileSize*c.qualityFactor;_.textures[A]||(_.textures[A]=L.getTileTexture(d)||new j(h,{width:d,height:d,data:null},h.gl.RGBA),_.textures[A].bind(h.gl.LINEAR,h.gl.CLAMP_TO_EDGE),A===0&&c.sourceCache.renderHistory.unshift(_.tileID.key));const w=c.getRTTFramebuffer();w.colorAttachment.set(_.textures[A].texture),h.bindFramebuffer.set(w.framebuffer),h.viewport.set([0,0,d,d])}class PA{constructor(c){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=c,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=c.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const c=this.painter.style,_=c.terrain;for(const A in c.sourceCaches){this._coordsDescendingInv[A]={};const h=c.sourceCaches[A].getVisibleCoordinates();for(const d of h){const w=_.sourceCache.getTerrainCoords(d);for(const b in w)this._coordsDescendingInv[A][b]||(this._coordsDescendingInv[A][b]=[]),this._coordsDescendingInv[A][b].push(w[b])}}for(const A of c._order){const h=c._layers[A],d=h.source;if(this._renderToTexture[h.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const w in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][w]=this._coordsDescendingInv[d][w].map(b=>b.key).sort().join()}}return this._renderableTiles.forEach(A=>{for(const h in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[h][A.tileID.key];d&&d!==A.textureCoords[h]&&A.clearTextures(this.painter),_.needsRerender(h,A.tileID)&&A.clearTextures(this.painter)}this._rerender[A.tileID.key]=!A.textures.length}),_.clearRerenderCache(),_.sourceCache.removeOutdated(this.painter),this}renderLayer(c){const _=c.type,A=this.painter,h=A.style._order,d=A.currentLayer,w=d+1===h.length;if(this._renderToTexture[_]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(h[d]),!w))return!0;if(this._renderToTexture[this._prevType]||_==="hillshade"||this._renderToTexture[_]&&w){this._prevType=_;const b=this._stacks.length-1,C=this._stacks[b]||[];for(const P of this._renderableTiles){if(xc(A,A.style.terrain,P,b),this._rerender[P.tileID.key]){A.context.clear({color:o.Color.transparent});for(let B=0;B<C.length;B++){const V=A.style._layers[C[B]],W=V.source?this._coordsDescendingInv[V.source][P.tileID.key]:[P.tileID];A._renderTileClippingMasks(V,W),A.renderLayer(A,A.style.sourceCaches[V.source],V,W),V.source&&(P.textureCoords[V.source]=this._coordsDescendingInvStr[V.source][P.tileID.key])}}Hs(A,A.style.terrain,P)}if(_==="hillshade"){this._stacks.push([h[d]]);for(const P of this._renderableTiles){const B=this._coordsDescendingInv[c.source][P.tileID.key];xc(A,A.style.terrain,P,this._stacks.length-1),A.context.clear({color:o.Color.transparent}),A._renderTileClippingMasks(c,B),A.renderLayer(A,A.style.sourceCaches[c.source],c,B),Hs(A,A.style.terrain,P)}return!0}return this._renderToTexture[_]}return!1}}const fi={symbol:function(L,c,_,A,h){if(L.renderPass!=="translucent")return;const d=br.disabled,w=L.colorModeForRenderPass();_.layout.get("text-variable-anchor")&&function(b,C,P,B,V,W,X){const ae=C.transform,ne=V==="map",ue=W==="map";for(const be of b){const Me=B.getTile(be),ve=Me.getBucket(P);if(!ve||!ve.text||!ve.text.segments.get().length)continue;const $e=o.evaluateSizeForZoom(ve.textSizeData,ae.zoom),Se=Fr(Me,1,C.transform.zoom),Ge=Us(be.posMatrix,ue,ne,C.transform,Se),xe=P.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if($e){const y=Math.pow(2,ae.zoom-Me.tileID.overscaledZ);_c(ve,ne,ue,X,ae,Ge,be.posMatrix,y,$e,xe,C.style.terrain?(m,x)=>C.style.terrain.getElevation(be,m,x):null)}}}(A,L,_,c,_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),h),_.paint.get("icon-opacity").constantOr(1)!==0&&js(L,c,_,A,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),d,w),_.paint.get("text-opacity").constantOr(1)!==0&&js(L,c,_,A,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),d,w),c.map.showCollisionBoxes&&(Yo(L,c,_,A,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),Yo(L,c,_,A,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))},circle:function(L,c,_,A){if(L.renderPass!=="translucent")return;const h=_.paint.get("circle-opacity"),d=_.paint.get("circle-stroke-width"),w=_.paint.get("circle-stroke-opacity"),b=!_.layout.get("circle-sort-key").isConstant();if(h.constantOr(1)===0&&(d.constantOr(1)===0||w.constantOr(1)===0))return;const C=L.context,P=C.gl,B=L.depthModeForSublayer(0,$n.ReadOnly),V=br.disabled,W=L.colorModeForRenderPass(),X=[];for(let ae=0;ae<A.length;ae++){const ne=A[ae],ue=c.getTile(ne),be=ue.getBucket(_);if(!be)continue;const Me=be.programConfigurations.get(_.id),ve=L.useProgram("circle",Me),$e=be.layoutVertexBuffer,Se=be.indexBuffer,Ge=L.style.terrain&&L.style.terrain.getTerrainData(ne),xe={programConfiguration:Me,program:ve,layoutVertexBuffer:$e,indexBuffer:Se,uniformValues:ma(L,ne,ue,_),terrainData:Ge};if(b){const y=be.segments.get();for(const m of y)X.push({segments:new o.SegmentVector([m]),sortKey:m.sortKey,state:xe})}else X.push({segments:be.segments,sortKey:0,state:xe})}b&&X.sort((ae,ne)=>ae.sortKey-ne.sortKey);for(const ae of X){const{programConfiguration:ne,program:ue,layoutVertexBuffer:be,indexBuffer:Me,uniformValues:ve,terrainData:$e}=ae.state;ue.draw(C,P.TRIANGLES,B,V,W,pr.disabled,ve,$e,_.id,be,Me,ae.segments,_.paint,L.transform.zoom,ne)}},heatmap:function(L,c,_,A){if(_.paint.get("heatmap-opacity")!==0)if(L.renderPass==="offscreen"){const h=L.context,d=h.gl,w=br.disabled,b=new fr([d.ONE,d.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(C,P,B){const V=C.gl;C.activeTexture.set(V.TEXTURE1),C.viewport.set([0,0,P.width/4,P.height/4]);let W=B.heatmapFbo;if(W)V.bindTexture(V.TEXTURE_2D,W.colorAttachment.get()),C.bindFramebuffer.set(W.framebuffer);else{const X=V.createTexture();V.bindTexture(V.TEXTURE_2D,X),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),W=B.heatmapFbo=C.createFramebuffer(P.width/4,P.height/4,!1),function(ae,ne,ue,be){const Me=ae.gl;Me.texImage2D(Me.TEXTURE_2D,0,Me.RGBA,ne.width/4,ne.height/4,0,Me.RGBA,ae.extRenderToTextureHalfFloat?ae.extTextureHalfFloat.HALF_FLOAT_OES:Me.UNSIGNED_BYTE,null),be.colorAttachment.set(ue)}(C,P,X,W)}})(h,L,_),h.clear({color:o.Color.transparent});for(let C=0;C<A.length;C++){const P=A[C];if(c.hasRenderableParent(P))continue;const B=c.getTile(P),V=B.getBucket(_);if(!V)continue;const W=V.programConfigurations.get(_.id),X=L.useProgram("heatmap",W),{zoom:ae}=L.transform;X.draw(h,d.TRIANGLES,$n.disabled,w,b,pr.disabled,Ne(P.posMatrix,B,ae,_.paint.get("heatmap-intensity")),null,_.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,_.paint,L.transform.zoom,W)}h.viewport.set([0,0,L.width,L.height])}else L.renderPass==="translucent"&&(L.context.setColorMode(L.colorModeForRenderPass()),function(h,d){const w=h.context,b=w.gl,C=d.heatmapFbo;if(!C)return;w.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,C.colorAttachment.get()),w.activeTexture.set(b.TEXTURE1);let P=d.colorRampTexture;P||(P=d.colorRampTexture=new j(w,d.colorRamp,b.RGBA)),P.bind(b.LINEAR,b.CLAMP_TO_EDGE),h.useProgram("heatmapTexture").draw(w,b.TRIANGLES,$n.disabled,br.disabled,h.colorModeForRenderPass(),pr.disabled,((B,V,W,X)=>{const ae=o.create();o.ortho(ae,0,B.width,B.height,0,0,1);const ne=B.context.gl;return{u_matrix:ae,u_world:[ne.drawingBufferWidth,ne.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(h,d),null,d.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments,d.paint,h.transform.zoom)}(L,_))},line:function(L,c,_,A){if(L.renderPass!=="translucent")return;const h=_.paint.get("line-opacity"),d=_.paint.get("line-width");if(h.constantOr(1)===0||d.constantOr(1)===0)return;const w=L.depthModeForSublayer(0,$n.ReadOnly),b=L.colorModeForRenderPass(),C=_.paint.get("line-dasharray"),P=_.paint.get("line-pattern"),B=P.constantOr(1),V=_.paint.get("line-gradient"),W=_.getCrossfadeParameters(),X=B?"linePattern":C?"lineSDF":V?"lineGradient":"line",ae=L.context,ne=ae.gl;let ue=!0;for(const be of A){const Me=c.getTile(be);if(B&&!Me.patternsLoaded())continue;const ve=Me.getBucket(_);if(!ve)continue;const $e=ve.programConfigurations.get(_.id),Se=L.context.program.get(),Ge=L.useProgram(X,$e),xe=ue||Ge.program!==Se,y=L.style.terrain&&L.style.terrain.getTerrainData(be),m=P.constantOr(null);if(m&&Me.imageAtlas){const I=Me.imageAtlas,R=I.patternPositions[m.to.toString()],O=I.patternPositions[m.from.toString()];R&&O&&$e.setConstantPatternPositions(R,O)}const x=y?be:null,E=B?Ln(L,Me,_,W,x):C?Dr(L,Me,_,C,W,x):V?Qt(L,Me,_,ve.lineClipsArray.length,x):bt(L,Me,_,x);if(B)ae.activeTexture.set(ne.TEXTURE0),Me.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),$e.updatePaintBuffers(W);else if(C&&(xe||L.lineAtlas.dirty))ae.activeTexture.set(ne.TEXTURE0),L.lineAtlas.bind(ae);else if(V){const I=ve.gradients[_.id];let R=I.texture;if(_.gradientVersion!==I.version){let O=256;if(_.stepInterpolant){const U=c.getSource().maxzoom,q=be.canonical.z===U?Math.ceil(1<<L.transform.maxZoom-be.canonical.z):1;O=o.clamp(o.nextPowerOfTwo(ve.maxLineLength/o.EXTENT*1024*q),256,ae.maxTextureSize)}I.gradient=o.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:I.gradient||void 0,clips:ve.lineClipsArray}),I.texture?I.texture.update(I.gradient):I.texture=new j(ae,I.gradient,ne.RGBA),I.version=_.gradientVersion,R=I.texture}ae.activeTexture.set(ne.TEXTURE0),R.bind(_.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}Ge.draw(ae,ne.TRIANGLES,w,L.stencilModeForClipping(be),b,pr.disabled,E,y,_.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,_.paint,L.transform.zoom,$e,ve.layoutVertexBuffer2),ue=!1}},fill:function(L,c,_,A){const h=_.paint.get("fill-color"),d=_.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const w=L.colorModeForRenderPass(),b=_.paint.get("fill-pattern"),C=L.opaquePassEnabledForLayer()&&!b.constantOr(1)&&h.constantOr(o.Color.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(L.renderPass===C){const P=L.depthModeForSublayer(1,L.renderPass==="opaque"?$n.ReadWrite:$n.ReadOnly);Xa(L,c,_,A,P,w,!1)}if(L.renderPass==="translucent"&&_.paint.get("fill-antialias")){const P=L.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,$n.ReadOnly);Xa(L,c,_,A,P,w,!0)}},"fill-extrusion":function(L,c,_,A){const h=_.paint.get("fill-extrusion-opacity");if(h!==0&&L.renderPass==="translucent"){const d=new $n(L.context.gl.LEQUAL,$n.ReadWrite,L.depthRangeFor3D);if(h!==1||_.paint.get("fill-extrusion-pattern").constantOr(1))xa(L,c,_,A,d,br.disabled,fr.disabled),xa(L,c,_,A,d,L.stencilModeFor3D(),L.colorModeForRenderPass());else{const w=L.colorModeForRenderPass();xa(L,c,_,A,d,br.disabled,w)}}},hillshade:function(L,c,_,A){if(L.renderPass!=="offscreen"&&L.renderPass!=="translucent")return;const h=L.context,d=L.depthModeForSublayer(0,$n.ReadOnly),w=L.colorModeForRenderPass(),[b,C]=L.renderPass==="translucent"?L.stencilConfigForOverlap(A):[{},A];for(const P of C){const B=c.getTile(P);B.needsHillshadePrepare!==void 0&&B.needsHillshadePrepare&&L.renderPass==="offscreen"?Fl(L,B,_,d,br.disabled,w):L.renderPass==="translucent"&&Ol(L,P,B,_,d,b[P.overscaledZ],w)}h.viewport.set([0,0,L.width,L.height])},raster:function(L,c,_,A){if(L.renderPass!=="translucent"||_.paint.get("raster-opacity")===0||!A.length)return;const h=L.context,d=h.gl,w=c.getSource(),b=L.useProgram("raster"),C=L.colorModeForRenderPass(),[P,B]=w instanceof Tt?[{},A]:L.stencilConfigForOverlap(A),V=B[B.length-1].overscaledZ,W=!L.options.moving;for(const X of B){const ae=L.depthModeForSublayer(X.overscaledZ-V,_.paint.get("raster-opacity")===1?$n.ReadWrite:$n.ReadOnly,d.LESS),ne=c.getTile(X);ne.registerFadeDuration(_.paint.get("raster-fade-duration"));const ue=c.findLoadedParent(X,0),be=gr(ne,ue,c,_,L.transform,L.style.terrain);let Me,ve;const $e=_.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),ne.texture.bind($e,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1),ue?(ue.texture.bind($e,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),Me=Math.pow(2,ue.tileID.overscaledZ-ne.tileID.overscaledZ),ve=[ne.tileID.canonical.x*Me%1,ne.tileID.canonical.y*Me%1]):ne.texture.bind($e,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Se=L.style.terrain&&L.style.terrain.getTerrainData(X),Ge=Se?X:null,xe=Ge?Ge.posMatrix:L.transform.calculatePosMatrix(X.toUnwrapped(),W),y=Gn(xe,ve||[0,0],Me||1,be,_);w instanceof Tt?b.draw(h,d.TRIANGLES,ae,br.disabled,C,pr.disabled,y,Se,_.id,w.boundsBuffer,L.quadTriangleIndexBuffer,w.boundsSegments):b.draw(h,d.TRIANGLES,ae,P[X.overscaledZ],C,pr.disabled,y,Se,_.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}},background:function(L,c,_,A){const h=_.paint.get("background-color"),d=_.paint.get("background-opacity");if(d===0)return;const w=L.context,b=w.gl,C=L.transform,P=C.tileSize,B=_.paint.get("background-pattern");if(L.isPatternMissing(B))return;const V=!B&&h.a===1&&d===1&&L.opaquePassEnabledForLayer()?"opaque":"translucent";if(L.renderPass!==V)return;const W=br.disabled,X=L.depthModeForSublayer(0,V==="opaque"?$n.ReadWrite:$n.ReadOnly),ae=L.colorModeForRenderPass(),ne=L.useProgram(B?"backgroundPattern":"background"),ue=A||C.coveringTiles({tileSize:P,terrain:L.style.terrain});B&&(w.activeTexture.set(b.TEXTURE0),L.imageManager.bind(L.context));const be=_.getCrossfadeParameters();for(const Me of ue){const ve=A?Me.posMatrix:L.transform.calculatePosMatrix(Me.toUnwrapped()),$e=B?bA(ve,d,L,B,{tileID:Me,tileSize:P},be):su(ve,d,h),Se=L.style.terrain&&L.style.terrain.getTerrainData(Me);ne.draw(w,b.TRIANGLES,X,W,ae,pr.disabled,$e,Se,_.id,L.tileExtentBuffer,L.quadTriangleIndexBuffer,L.tileExtentSegments)}},debug:function(L,c,_){for(let A=0;A<_.length;A++)pu(L,c,_[A])},custom:function(L,c,_){const A=L.context,h=_.implementation;if(L.renderPass==="offscreen"){const d=h.prerender;d&&(L.setCustomLayerDefaults(),A.setColorMode(L.colorModeForRenderPass()),d.call(h,A.gl,L.transform.customLayerMatrix()),A.setDirty(),L.setBaseState())}else if(L.renderPass==="translucent"){L.setCustomLayerDefaults(),A.setColorMode(L.colorModeForRenderPass()),A.setStencilMode(br.disabled);const d=h.renderingMode==="3d"?new $n(L.context.gl.LEQUAL,$n.ReadWrite,L.depthRangeFor3D):L.depthModeForSublayer(0,$n.ReadOnly);A.setDepthMode(d),h.render(A.gl,L.transform.customLayerMatrix()),A.setDirty(),L.setBaseState(),A.bindFramebuffer.set(null)}}};class Ei{constructor(c,_){this.context=new $s(c),this.transform=_,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.create(),renderTime:0},this.setup(),this.numSublayers=wt.maxUnderzooming+wt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new jt,this.gpuTimers={}}resize(c,_,A){if(this.width=c*A,this.height=_*A,this.pixelRatio=A,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const c=this.context,_=new o.PosArray;_.emplaceBack(0,0),_.emplaceBack(o.EXTENT,0),_.emplaceBack(0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(_,pn.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const A=new o.PosArray;A.emplaceBack(0,0),A.emplaceBack(o.EXTENT,0),A.emplaceBack(0,o.EXTENT),A.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=c.createVertexBuffer(A,pn.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const h=new o.RasterBoundsArray;h.emplaceBack(0,0,0,0),h.emplaceBack(o.EXTENT,0,o.EXTENT,0),h.emplaceBack(0,o.EXTENT,0,o.EXTENT),h.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(h,_t.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const d=new o.PosArray;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(d,pn.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const w=new o.LineStripIndexArray;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(w);const b=new o.TriangleIndexArray;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(b),this.emptyTexture=new j(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);const C=this.context.gl;this.stencilClearMode=new br({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO)}clearStencil(){const c=this.context,_=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const A=o.create();o.ortho(A,0,this.width,this.height,0,0,1),o.scale(A,A,[_.drawingBufferWidth,_.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,_.TRIANGLES,$n.disabled,this.stencilClearMode,fr.disabled,pr.disabled,Te(A),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,_){if(this.currentStencilSource===c.source||!c.isTileClipped()||!_||!_.length)return;this.currentStencilSource=c.source;const A=this.context,h=A.gl;this.nextStencilID+_.length>256&&this.clearStencil(),A.setColorMode(fr.disabled),A.setDepthMode($n.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of _){const b=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,C=this.style.terrain&&this.style.terrain.getTerrainData(w);d.draw(A,h.TRIANGLES,$n.disabled,new br({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),fr.disabled,pr.disabled,Te(w.posMatrix),C,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,_=this.context.gl;return new br({func:_.NOTEQUAL,mask:255},c,255,_.KEEP,_.KEEP,_.REPLACE)}stencilModeForClipping(c){const _=this.context.gl;return new br({func:_.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,_.KEEP,_.KEEP,_.REPLACE)}stencilConfigForOverlap(c){const _=this.context.gl,A=c.sort((w,b)=>b.overscaledZ-w.overscaledZ),h=A[A.length-1].overscaledZ,d=A[0].overscaledZ-h+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const w={};for(let b=0;b<d;b++)w[b+h]=new br({func:_.GEQUAL,mask:255},b+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=d,[w,A]}return[{[h]:br.disabled},A]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new fr([c.CONSTANT_COLOR,c.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fr.unblended:fr.alphaBlended}depthModeForSublayer(c,_,A){if(!this.opaquePassEnabledForLayer())return $n.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new $n(A||this.context.gl.LEQUAL,_,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,_){this.style=c,this.options=_,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const A=this.style._order,h=this.style.sourceCaches,d=this.style.terrain&&new PA(this);for(const P in h){const B=h[P];B.used&&B.prepare(this.context)}const w={},b={},C={};for(const P in h){const B=h[P];w[P]=B.getVisibleCoordinates(),b[P]=w[P].slice().reverse(),C[P]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let P=0;P<A.length;P++)if(this.style._layers[A[P]].is3D()){this.opaquePassCutoff=P;break}if(d){this.opaquePassCutoff=0;const P=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!o.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||P.length)&&(o.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,V){const W=B.context,X=W.gl,ae=fr.unblended,ne=new $n(X.LEQUAL,$n.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.sourceCache.getRenderableTiles(),Me=B.useProgram("terrainDepth");W.bindFramebuffer.set(V.getFramebuffer("depth").framebuffer),W.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),W.clear({color:o.Color.transparent,depth:1});for(const ve of be){const $e=V.getTerrainData(ve.tileID),Se=B.transform.calculatePosMatrix(ve.tileID.toUnwrapped());Me.draw(W,X.TRIANGLES,ne,br.disabled,ae,pr.backCCW,{u_matrix:Se},$e,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}W.bindFramebuffer.set(null),W.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain),function(B,V){const W=B.context,X=W.gl,ae=fr.unblended,ne=new $n(X.LEQUAL,$n.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.getCoordsTexture(),Me=V.sourceCache.getRenderableTiles(),ve=B.useProgram("terrainCoords");W.bindFramebuffer.set(V.getFramebuffer("coords").framebuffer),W.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),W.clear({color:o.Color.transparent,depth:1}),V.coordsIndex=[];for(const $e of Me){const Se=V.getTerrainData($e.tileID);W.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,be.texture);const Ge=B.transform.calculatePosMatrix($e.tileID.toUnwrapped());ve.draw(W,X.TRIANGLES,ne,br.disabled,ae,pr.backCCW,{u_matrix:Ge,u_terrain_coords_id:(255-V.coordsIndex.length)/255,u_texture:0},Se,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),V.coordsIndex.push($e.tileID.key)}W.bindFramebuffer.set(null),W.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const P of A){const B=this.style._layers[P];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const V=b[B.source];(B.type==="custom"||V.length)&&this.renderLayer(this,h[B.source],B,V)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:_.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=_.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!d)for(this.renderPass="opaque",this.currentLayer=A.length-1;this.currentLayer>=0;this.currentLayer--){const P=this.style._layers[A[this.currentLayer]],B=h[P.source],V=w[P.source];this._renderTileClippingMasks(P,V),this.renderLayer(this,B,P,V)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<A.length;this.currentLayer++){const P=this.style._layers[A[this.currentLayer]],B=h[P.source];if(d&&d.renderLayer(P))continue;const V=(P.type==="symbol"?C:b)[P.source];this._renderTileClippingMasks(P,w[P.source]),this.renderLayer(this,B,P,V)}if(this.options.showTileBoundaries){let P,B;Object.values(this.style._layers).forEach(V=>{V.source&&!V.isHidden(this.transform.zoom)&&(V.source!==(B&&B.id)&&(B=this.style.sourceCaches[V.source]),(!P||P.getSource().maxzoom<B.getSource().maxzoom)&&(P=B))}),P&&fi.debug(this,P,P.getVisibleCoordinates())}this.options.showPadding&&function(P){const B=P.transform.padding;Xr(P,P.transform.height-(B.top||0),3,MA),Xr(P,B.bottom||0,3,cs),zr(P,B.left||0,3,du),zr(P,P.transform.width-(B.right||0),3,Nl);const V=P.transform.centerPoint;(function(W,X,ae,ne){oi(W,X-1,ae-10,2,20,ne),oi(W,X-10,ae-1,20,2,ne)})(P,V.x,P.transform.height-V.y,vc)}(this),this.context.setDefault()}renderLayer(c,_,A,h){A.isHidden(this.transform.zoom)||(A.type==="background"||A.type==="custom"||(h||[]).length)&&(this.id=A.id,this.gpuTimingStart(A),fi[A.type](c,_,A,h,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const _=this.context.extTimerQuery;let A=this.gpuTimers[c.id];A||(A=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:_.createQueryEXT()}),A.calls++,_.beginQueryEXT(_.TIME_ELAPSED_EXT,A.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}queryGpuTimers(c){const _={};for(const A in c){const h=c[A],d=this.context.extTimerQuery,w=d.getQueryObjectEXT(h.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(h.query),_[A]=w}return _}translatePosMatrix(c,_,A,h,d){if(!A[0]&&!A[1])return c;const w=d?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(w){const P=Math.sin(w),B=Math.cos(w);A=[A[0]*B-A[1]*P,A[0]*P+A[1]*B]}const b=[d?A[0]:Fr(_,A[0],this.transform.zoom),d?A[1]:Fr(_,A[1],this.transform.zoom),0],C=new Float32Array(16);return o.translate(C,c,b),C}saveTileTexture(c){const _=this._tileTextures[c.size[0]];_?_.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const _=this._tileTextures[c];return _&&_.length>0?_.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const _=this.imageManager.getPattern(c.from.toString()),A=this.imageManager.getPattern(c.to.toString());return!_||!A}useProgram(c,_){this.cache=this.cache||{};const A=c+(_?_.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[A]||(this.cache[A]=new Ha(this.context,c,hi[c],_,Pl[c],this._showOverdrawInspector,this.style.terrain)),this.cache[A]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new j(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class hs{constructor(c,_){this.points=c,this.planes=_}static fromInvProjectionMatrix(c,_,A){const h=Math.pow(2,A),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const C=1/(b=o.transformMat4([],b,c))[3]/_*h;return o.mul$1(b,b,[C,C,1/b[3],C])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const C=o.sub([],d[b[0]],d[b[1]]),P=o.sub([],d[b[2]],d[b[1]]),B=o.normalize([],o.cross([],C,P)),V=-o.dot(B,d[b[1]]);return B.concat(V)});return new hs(d,w)}}class wa{constructor(c,_){this.min=c,this.max=_,this.center=o.scale$1([],o.add([],this.min,this.max),.5)}quadrant(c){const _=[c%2==0,c<2],A=o.clone$2(this.min),h=o.clone$2(this.max);for(let d=0;d<_.length;d++)A[d]=_[d]?this.min[d]:this.center[d],h[d]=_[d]?this.center[d]:this.max[d];return h[2]=this.max[2],new wa(A,h)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersects(c){const _=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let A=!0;for(let h=0;h<c.planes.length;h++){const d=c.planes[h];let w=0;for(let b=0;b<_.length;b++)o.dot$1(d,_[b])>=0&&w++;if(w===0)return 0;w!==_.length&&(A=!1)}if(A)return 2;for(let h=0;h<3;h++){let d=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let b=0;b<c.points.length;b++){const C=c.points[b][h]-this.min[h];d=Math.min(d,C),w=Math.max(w,C)}if(w<0||d>this.max[h]-this.min[h])return 0}return 1}}class Ki{constructor(c=0,_=0,A=0,h=0){if(isNaN(c)||c<0||isNaN(_)||_<0||isNaN(A)||A<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=_,this.left=A,this.right=h}interpolate(c,_,A){return _.top!=null&&c.top!=null&&(this.top=o.number(c.top,_.top,A)),_.bottom!=null&&c.bottom!=null&&(this.bottom=o.number(c.bottom,_.bottom,A)),_.left!=null&&c.left!=null&&(this.left=o.number(c.left,_.left,A)),_.right!=null&&c.right!=null&&(this.right=o.number(c.right,_.right,A)),this}getCenter(c,_){const A=o.clamp((this.left+c-this.right)/2,0,c),h=o.clamp((this.top+_-this.bottom)/2,0,_);return new o.pointGeometry(A,h)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Ki(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class bo{constructor(c,_,A,h,d){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=d===void 0||!!d,this._minZoom=c||0,this._maxZoom=_||22,this._minPitch=A??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ki,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const c=new bo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c._elevation=this._elevation,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){const _=-o.wrap(c,-180,180)*Math.PI/180;var A;this.angle!==_&&(this._unmodified=!1,this.angle=_,this._calcMatrices(),this.rotationMatrix=(A=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(A[1]=0,A[2]=0),A[0]=1,A[3]=1,A),function(h,d,w){var b=d[0],C=d[1],P=d[2],B=d[3],V=Math.sin(w),W=Math.cos(w);h[0]=b*W+P*V,h[1]=C*W+B*V,h[2]=b*-V+P*W,h[3]=C*-V+B*W}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const _=o.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==_&&(this._unmodified=!1,this._pitch=_,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(c){const _=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==_&&(this._unmodified=!1,this._zoom=_,this.scale=this.zoomScale(_),this.tileZoom=Math.floor(_),this.zoomFraction=_-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(c){c!==this._elevation&&(this._elevation=c,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,_,A){this._unmodified=!1,this._edgeInsets.interpolate(c,_,A),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const _=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,_)}getVisibleUnwrappedCoordinates(c){const _=[new o.UnwrappedTileID(0,c)];if(this._renderWorldCopies){const A=this.pointCoordinate(new o.pointGeometry(0,0)),h=this.pointCoordinate(new o.pointGeometry(this.width,0)),d=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),w=this.pointCoordinate(new o.pointGeometry(0,this.height)),b=Math.floor(Math.min(A.x,h.x,d.x,w.x)),C=Math.floor(Math.max(A.x,h.x,d.x,w.x)),P=1;for(let B=b-P;B<=C+P;B++)B!==0&&_.push(new o.UnwrappedTileID(B,c))}return _}coveringTiles(c){var _,A;let h=this.coveringZoomLevel(c);const d=h;if(c.minzoom!==void 0&&h<c.minzoom)return[];c.maxzoom!==void 0&&h>c.maxzoom&&(h=c.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),b=o.MercatorCoordinate.fromLngLat(this.center),C=Math.pow(2,h),P=[C*w.x,C*w.y,0],B=[C*b.x,C*b.y,0],V=hs.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h);let W=c.minzoom||0;!c.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(W=h);const X=c.terrain?2/Math.min(this.tileSize,c.tileSize)*this.tileSize:3,ae=ve=>({aabb:new wa([ve*C,0,0],[(ve+1)*C,C,0]),zoom:0,x:0,y:0,wrap:ve,fullyVisible:!1}),ne=[],ue=[],be=h,Me=c.reparseOverscaled?d:h;if(this._renderWorldCopies)for(let ve=1;ve<=3;ve++)ne.push(ae(-ve)),ne.push(ae(ve));for(ne.push(ae(0));ne.length>0;){const ve=ne.pop(),$e=ve.x,Se=ve.y;let Ge=ve.fullyVisible;if(!Ge){const I=ve.aabb.intersects(V);if(I===0)continue;Ge=I===2}const xe=c.terrain?P:B,y=ve.aabb.distanceX(xe),m=ve.aabb.distanceY(xe),x=Math.max(Math.abs(y),Math.abs(m)),E=X+(1<<be-ve.zoom)-2;if(ve.zoom===be||x>E&&ve.zoom>=W){const I=be-ve.zoom,R=P[0]-.5-($e<<I),O=P[1]-.5-(Se<<I);ue.push({tileID:new o.OverscaledTileID(ve.zoom===be?Me:ve.zoom,ve.wrap,ve.zoom,$e,Se),distanceSq:o.sqrLen([B[0]-.5-$e,B[1]-.5-Se]),tileDistanceToCamera:Math.sqrt(R*R+O*O)})}else for(let I=0;I<4;I++){const R=($e<<1)+I%2,O=(Se<<1)+(I>>1),U=ve.zoom+1;let q=ve.aabb.quadrant(I);if(c.terrain){const ee=new o.OverscaledTileID(U,ve.wrap,U,R,O),le=c.terrain.getMinMaxElevation(ee),de=(_=le.minElevation)!==null&&_!==void 0?_:this.elevation,Re=(A=le.maxElevation)!==null&&A!==void 0?A:this.elevation;q=new wa([q.min[0],q.min[1],de],[q.max[0],q.max[1],Re])}ne.push({aabb:q,zoom:U,x:R,y:O,wrap:ve.wrap,fullyVisible:Ge})}}return ue.sort((ve,$e)=>ve.distanceSq-$e.distanceSq).map(ve=>ve.tileID)}resize(c,_){this.width=c,this.height=_,this.pixelsToGLUnits=[2/c,-2/_],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const _=o.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.pointGeometry(o.mercatorXfromLng(c.lng)*this.worldSize,o.mercatorYfromLat(_)*this.worldSize)}unproject(c){return new o.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(c){this.freezeElevation||(this.elevation=c?this.getElevation(this._center,c):0)}getElevation(c,_){const A=o.MercatorCoordinate.fromLngLat(c),h=(1<<this.tileZoom)*o.EXTENT,d=A.x*h,w=A.y*h,b=Math.floor(d/o.EXTENT),C=Math.floor(w/o.EXTENT),P=new o.OverscaledTileID(this.tileZoom,0,this.tileZoom,b,C);return _.getElevation(P,d%o.EXTENT,w%o.EXTENT,o.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(c){const _=this.pointLocation(this.centerPoint,c),A=this.getElevation(_,c);if(!(this.elevation-A))return;const h=this.getCameraPosition(),d=o.MercatorCoordinate.fromLngLat(h.lngLat,h.altitude),w=o.MercatorCoordinate.fromLngLat(_,A),b=d.x-w.x,C=d.y-w.y,P=d.z-w.z,B=Math.sqrt(b*b+C*C+P*P),V=this.scaleZoom(this.cameraToCenterDistance/B/this.tileSize);this._elevation=A,this._center=_,this.zoom=V}setLocationAtPoint(c,_){const A=this.pointCoordinate(_),h=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(c),w=new o.MercatorCoordinate(d.x-(A.x-h.x),d.y-(A.y-h.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c,_){return _?this.coordinatePoint(this.locationCoordinate(c),this.getElevation(c,_),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(c))}pointLocation(c,_){return this.coordinateLocation(this.pointCoordinate(c,_))}locationCoordinate(c){return o.MercatorCoordinate.fromLngLat(c)}coordinateLocation(c){return c&&c.toLngLat()}pointCoordinate(c,_){if(_){const W=_.pointCoordinate(c);if(W!=null)return W}const A=[c.x,c.y,0,1],h=[c.x,c.y,1,1];o.transformMat4(A,A,this.pixelMatrixInverse),o.transformMat4(h,h,this.pixelMatrixInverse);const d=A[3],w=h[3],b=A[1]/d,C=h[1]/w,P=A[2]/d,B=h[2]/w,V=P===B?0:(0-P)/(B-P);return new o.MercatorCoordinate(o.number(A[0]/d,h[0]/w,V)/this.worldSize,o.number(b,C,V)/this.worldSize)}coordinatePoint(c,_=0,A=this.pixelMatrix){const h=[c.x*this.worldSize,c.y*this.worldSize,_,1];return o.transformMat4(h,h,A),new o.pointGeometry(h[0]/h[3],h[1]/h[3])}getBounds(){const c=Math.max(0,this.height/2-this.getHorizon());return new o.LngLatBounds().extend(this.pointLocation(new o.pointGeometry(0,c))).extend(this.pointLocation(new o.pointGeometry(this.width,c))).extend(this.pointLocation(new o.pointGeometry(this.width,this.height))).extend(this.pointLocation(new o.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(c,_=!1){const A=c.key,h=_?this._alignedPosMatrixCache:this._posMatrixCache;if(h[A])return h[A];const d=c.canonical,w=this.worldSize/this.zoomScale(d.z),b=d.x+Math.pow(2,d.z)*c.wrap,C=o.identity(new Float64Array(16));return o.translate(C,C,[b*w,d.y*w,0]),o.scale(C,C,[w/o.EXTENT,w/o.EXTENT,1]),o.multiply(C,_?this.alignedProjMatrix:this.projMatrix,C),h[A]=new Float32Array(C),h[A]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let c,_,A,h,d=-90,w=90,b=-180,C=180;const P=this.size,B=this._unmodified;if(this.latRange){const X=this.latRange;d=o.mercatorYfromLat(X[1])*this.worldSize,w=o.mercatorYfromLat(X[0])*this.worldSize,c=w-d<P.y?P.y/(w-d):0}if(this.lngRange){const X=this.lngRange;b=o.wrap(o.mercatorXfromLng(X[0])*this.worldSize,0,this.worldSize),C=o.wrap(o.mercatorXfromLng(X[1])*this.worldSize,0,this.worldSize),C<b&&(C+=this.worldSize),_=C-b<P.x?P.x/(C-b):0}const V=this.point,W=Math.max(_||0,c||0);if(W)return this.center=this.unproject(new o.pointGeometry(_?(C+b)/2:V.x,c?(w+d)/2:V.y)),this.zoom+=this.scaleZoom(W),this._unmodified=B,void(this._constraining=!1);if(this.latRange){const X=V.y,ae=P.y/2;X-ae<d&&(h=d+ae),X+ae>w&&(h=w-ae)}if(this.lngRange){const X=(b+C)/2,ae=o.wrap(V.x,X-this.worldSize/2,X+this.worldSize/2),ne=P.x/2;ae-ne<b&&(A=b+ne),ae+ne>C&&(A=C-ne)}A===void 0&&h===void 0||(this.center=this.unproject(new o.pointGeometry(A!==void 0?A:V.x,h!==void 0?h:V.y)).wrap()),this._unmodified=B,this._constraining=!1}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,_=this.point.x,A=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let h=o.identity(new Float64Array(16));o.scale(h,h,[this.width/2,-this.height/2,1]),o.translate(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=o.identity(new Float64Array(16)),o.scale(h,h,[1,-1,1]),o.translate(h,h,[-1,-1,0]),o.scale(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const d=Math.PI/2+this._pitch,w=this._fov*(.5+c.y/this.height),b=Math.sin(w)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-d-w,.01,Math.PI-.01)),C=this.getHorizon(),P=2*Math.atan(C/this.cameraToCenterDistance)*(.5+c.y/(2*C)),B=Math.sin(P)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-d-P,.01,Math.PI-.01)),V=Math.cos(Math.PI/2-this._pitch)*b+this.cameraToSeaLevelDistance,W=Math.cos(Math.PI/2-this._pitch)*B+this.cameraToSeaLevelDistance,X=1.01*Math.min(V,W),ae=this.height/50;h=new Float64Array(16),o.perspective(h,this._fov,this.width/this.height,ae,X),h[8]=2*-c.x/this.width,h[9]=2*c.y/this.height,o.scale(h,h,[1,-1,1]),o.translate(h,h,[0,0,-this.cameraToCenterDistance]),o.rotateX(h,h,this._pitch),o.rotateZ(h,h,this.angle),o.translate(h,h,[-_,-A,0]),this.mercatorMatrix=o.scale([],h,[this.worldSize,this.worldSize,this.worldSize]),o.scale(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,h),o.translate(h,h,[0,0,-this.elevation]),this.projMatrix=h,this.invProjMatrix=o.invert([],h),this.pixelMatrix3D=o.multiply(new Float64Array(16),this.labelPlaneMatrix,h);const ne=this.width%2/2,ue=this.height%2/2,be=Math.cos(this.angle),Me=Math.sin(this.angle),ve=_-Math.round(_)+be*ne+Me*ue,$e=A-Math.round(A)+be*ue+Me*ne,Se=new Float64Array(h);if(o.translate(Se,Se,[ve>.5?ve-1:ve,$e>.5?$e-1:$e,0]),this.alignedProjMatrix=Se,h=o.invert(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const c=this.pointCoordinate(new o.pointGeometry(0,0)),_=[c.x*this.worldSize,c.y*this.worldSize,0,1];return o.transformMat4(_,_,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,c))}getCameraQueryGeometry(c){const _=this.getCameraPoint();if(c.length===1)return[c[0],_];{let A=_.x,h=_.y,d=_.x,w=_.y;for(const b of c)A=Math.min(A,b.x),h=Math.min(h,b.y),d=Math.max(d,b.x),w=Math.max(w,b.y);return[new o.pointGeometry(A,h),new o.pointGeometry(d,h),new o.pointGeometry(d,w),new o.pointGeometry(A,w),new o.pointGeometry(A,h)]}}}class mi{constructor(c){this._hashName=c&&encodeURIComponent(c),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(_,A){let h=!1,d=null;const w=()=>{d=null,h&&(_(),d=setTimeout(w,300),h=!1)};return()=>(h=!0,d||w(),d)}(this._updateHashUnthrottled.bind(this))}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){const _=this._map.getCenter(),A=Math.round(100*this._map.getZoom())/100,h=Math.ceil((A*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,h),w=Math.round(_.lng*d)/d,b=Math.round(_.lat*d)/d,C=this._map.getBearing(),P=this._map.getPitch();let B="";if(B+=c?`/${w}/${b}/${A}`:`${A}/${b}/${w}`,(C||P)&&(B+="/"+Math.round(10*C)/10),P&&(B+=`/${Math.round(P)}`),this._hashName){const V=this._hashName;let W=!1;const X=window.location.hash.slice(1).split("&").map(ae=>{const ne=ae.split("=")[0];return ne===V?(W=!0,`${ne}=${B}`):ae}).filter(ae=>ae);return W||X.push(`${V}=${B}`),`#${X.join("&")}`}return`#${B}`}_getCurrentHash(){const c=window.location.hash.replace("#","");if(this._hashName){let _;return c.split("&").map(A=>A.split("=")).forEach(A=>{A[0]===this._hashName&&(_=A)}),(_&&_[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._getCurrentHash();if(c.length>=3&&!c.some(_=>isNaN(_))){const _=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:_,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,c)}catch{}}}const Ka={linearity:.3,easing:o.bezier(0,0,.3,1)},Ul=o.extend({deceleration:2500,maxSpeed:1400},Ka),Ja=o.extend({deceleration:20,maxSpeed:1400},Ka),Ws=o.extend({deceleration:1e3,maxSpeed:360},Ka),fs=o.extend({deceleration:1e3,maxSpeed:90},Ka);class wc{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,_=o.exported.now();for(;c.length>0&&_-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const _={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)_.zoom+=d.zoomDelta||0,_.bearing+=d.bearingDelta||0,_.pitch+=d.pitchDelta||0,d.panDelta&&_.pan._add(d.panDelta),d.around&&(_.around=d.around),d.pinchAround&&(_.pinchAround=d.pinchAround);const A=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(_.pan.mag()){const d=el(_.pan.mag(),A,o.extend({},Ul,c||{}));h.offset=_.pan.mult(d.amount/_.pan.mag()),h.center=this._map.transform.center,ba(h,d)}if(_.zoom){const d=el(_.zoom,A,Ja);h.zoom=this._map.transform.zoom+d.amount,ba(h,d)}if(_.bearing){const d=el(_.bearing,A,Ws);h.bearing=this._map.transform.bearing+o.clamp(d.amount,-179,179),ba(h,d)}if(_.pitch){const d=el(_.pitch,A,fs);h.pitch=this._map.transform.pitch+d.amount,ba(h,d)}if(h.zoom||h.bearing){const d=_.pinchAround===void 0?_.around:_.pinchAround;h.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),o.extend(h,{noMoveStart:!0})}}function ba(L,c){(!L.duration||L.duration<c.duration)&&(L.duration=c.duration,L.easing=c.easing)}function el(L,c,_){const{maxSpeed:A,linearity:h,deceleration:d}=_,w=o.clamp(L*h/(c/1e3),-A,A),b=Math.abs(w)/(d*h);return{easing:_.easing,duration:1e3*b,amount:w*(b/2)}}class ai extends o.Event{constructor(c,_,A,h={}){const d=k.mousePos(_.getCanvasContainer(),A),w=_.unproject(d);super(c,o.extend({point:d,lngLat:w,originalEvent:A},h)),this._defaultPrevented=!1,this.target=_}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ms extends o.Event{constructor(c,_,A){const h=c==="touchend"?A.changedTouches:A.touches,d=k.touchPos(_.getCanvasContainer(),h),w=d.map(C=>_.unproject(C)),b=d.reduce((C,P,B,V)=>C.add(P.div(V.length)),new o.pointGeometry(0,0));super(c,{points:d,point:b,lngLats:w,lngLat:_.unproject(b),originalEvent:A}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Ji extends o.Event{constructor(c,_,A){super(c,{originalEvent:A}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Vl{constructor(c,_){this._map=c,this._clickTolerance=_.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new Ji(c.type,this._map,c))}mousedown(c,_){return this._mousedownPos=_,this._firePreventable(new ai(c.type,this._map,c))}mouseup(c){this._map.fire(new ai(c.type,this._map,c))}click(c,_){this._mousedownPos&&this._mousedownPos.dist(_)>=this._clickTolerance||this._map.fire(new ai(c.type,this._map,c))}dblclick(c){return this._firePreventable(new ai(c.type,this._map,c))}mouseover(c){this._map.fire(new ai(c.type,this._map,c))}mouseout(c){this._map.fire(new ai(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Ms(c.type,this._map,c))}touchmove(c){this._map.fire(new Ms(c.type,this._map,c))}touchend(c){this._map.fire(new Ms(c.type,this._map,c))}touchcancel(c){this._map.fire(new Ms(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xo{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new ai(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ai("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new ai(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bc{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=_.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,_){this.isEnabled()&&c.shiftKey&&c.button===0&&(k.disableDrag(),this._startPos=this._lastPos=_,this._active=!0)}mousemoveWindow(c,_){if(!this._active)return;const A=_;if(this._lastPos.equals(A)||!this._box&&A.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=A,this._box||(this._box=k.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const d=Math.min(h.x,A.x),w=Math.max(h.x,A.x),b=Math.min(h.y,A.y),C=Math.max(h.y,A.y);k.setTransform(this._box,`translate(${d}px,${b}px)`),this._box.style.width=w-d+"px",this._box.style.height=C-b+"px"}mouseupWindow(c,_){if(!this._active||c.button!==0)return;const A=this._startPos,h=_;if(this.reset(),k.suppressClick(),A.x!==h.x||A.y!==h.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:d=>d.fitScreenCoordinates(A,h,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(k.remove(this._box),this._box=null),k.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,_){return this._map.fire(new o.Event(c,{originalEvent:_}))}}function Eo(L,c){if(L.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${L.length}, points ${c.length}`);const _={};for(let A=0;A<L.length;A++)_[L[A].identifier]=c[A];return _}class Gl{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,_,A){(this.centroid||A.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),A.length===this.numTouches&&(this.centroid=function(h){const d=new o.pointGeometry(0,0);for(const w of h)d._add(w);return d.div(h.length)}(_),this.touches=Eo(A,_)))}touchmove(c,_,A){if(this.aborted||!this.centroid)return;const h=Eo(A,_);for(const d in this.touches){const w=this.touches[d],b=h[d];(!b||b.dist(w)>30)&&(this.aborted=!0)}}touchend(c,_,A){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),A.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class tl{constructor(c){this.singleTap=new Gl(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,_,A){this.singleTap.touchstart(c,_,A)}touchmove(c,_,A){this.singleTap.touchmove(c,_,A)}touchend(c,_,A){const h=this.singleTap.touchend(c,_,A);if(h){const d=c.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(h)<30;if(d&&w||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class Th{constructor(){this._zoomIn=new tl({numTouches:1,numTaps:2}),this._zoomOut=new tl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,_,A){this._zoomIn.touchstart(c,_,A),this._zoomOut.touchstart(c,_,A)}touchmove(c,_,A){this._zoomIn.touchmove(c,_,A),this._zoomOut.touchmove(c,_,A)}touchend(c,_,A){const h=this._zoomIn.touchend(c,_,A),d=this._zoomOut.touchend(c,_,A);return h?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(h)},{originalEvent:c})}):d?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(d)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Sh={0:1,2:2};class nl{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(c,_){return!1}_move(c,_){return{}}mousedown(c,_){if(this._lastPoint)return;const A=k.mouseButton(c);this._correctButton(c,A)&&(this._lastPoint=_,this._eventButton=A)}mousemoveWindow(c,_){const A=this._lastPoint;if(A){if(c.preventDefault(),function(h,d){const w=Sh[d];return h.buttons===void 0||(h.buttons&w)!==w}(c,this._eventButton))this.reset();else if(this._moved||!(_.dist(A)<this._clickTolerance))return this._moved=!0,this._lastPoint=_,this._move(A,_)}}mouseupWindow(c){this._lastPoint&&k.mouseButton(c)===this._eventButton&&(this._moved&&k.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ea extends nl{mousedown(c,_){super.mousedown(c,_),this._lastPoint&&(this._active=!0)}_correctButton(c,_){return _===0&&!c.ctrlKey}_move(c,_){return{around:_,panDelta:_.sub(c)}}}class ds extends nl{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const A=.8*(_.x-c.x);if(A)return this._active=!0,{bearingDelta:A}}contextmenu(c){c.preventDefault()}}class Nt extends nl{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const A=-.5*(_.y-c.y);if(A)return this._active=!0,{pitchDelta:A}}contextmenu(c){c.preventDefault()}}class gu{constructor(c,_){this._minTouches=c.cooperativeGestures?2:1,this._clickTolerance=c.clickTolerance||1,this._map=_,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(c,_,A){return this._calculateTransform(c,_,A)}touchmove(c,_,A){if(this._map._cooperativeGestures&&(this._minTouches===2&&A.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(c,!1,A.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(A.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,_,A)}touchend(c,_,A){this._calculateTransform(c,_,A),this._active&&A.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,_,A){A.length>0&&(this._active=!0);const h=Eo(A,_),d=new o.pointGeometry(0,0),w=new o.pointGeometry(0,0);let b=0;for(const P in h){const B=h[P],V=this._touches[P];V&&(d._add(B),w._add(B.sub(V)),b++,h[P]=B)}if(this._touches=h,b<this._minTouches||!w.mag())return;const C=w.div(b);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(b),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ta{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(c){}_move(c,_,A){return{}}touchstart(c,_,A){this._firstTwoTouches||A.length<2||(this._firstTwoTouches=[A[0].identifier,A[1].identifier],this._start([_[0],_[1]]))}touchmove(c,_,A){if(!this._firstTwoTouches)return;c.preventDefault();const[h,d]=this._firstTwoTouches,w=Ko(A,_,h),b=Ko(A,_,d);if(!w||!b)return;const C=this._aroundCenter?null:w.add(b).div(2);return this._move([w,b],C,c)}touchend(c,_,A){if(!this._firstTwoTouches)return;const[h,d]=this._firstTwoTouches,w=Ko(A,_,h),b=Ko(A,_,d);w&&b||(this._active&&k.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ko(L,c,_){for(let A=0;A<L.length;A++)if(L[A].identifier===_)return c[A]}function mu(L,c){return Math.log(L/c)/Math.LN2}class Vt extends Ta{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,_){const A=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(mu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mu(this._distance,A),pinchAround:_}}}function kA(L,c){return 180*L.angleWith(c)/Math.PI}class $l extends Ta{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,_){const A=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:kA(this._vector,A),pinchAround:_}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const _=25/(Math.PI*this._minDiameter)*360,A=kA(c,this._startVector);return Math.abs(A)<_}}function IA(L){return Math.abs(L.y)>Math.abs(L.x)}class rl extends Ta{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,_,A){super.touchstart(c,_,A),this._currentTouchCount=A.length}_start(c){this._lastPoints=c,IA(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,_,A){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const h=c[0].sub(this._lastPoints[0]),d=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,d,A.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(h.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(c,_,A){if(this._valid!==void 0)return this._valid;const h=c.mag()>=2,d=_.mag()>=2;if(!h&&!d)return;if(!h||!d)return this._firstMove===void 0&&(this._firstMove=A),A-this._firstMove<100&&void 0;const w=c.y>0==_.y>0;return IA(c)&&IA(_)&&w}}const Qs={panStep:100,bearingStep:15,pitchStep:10};class yu{constructor(){const c=Qs;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let _=0,A=0,h=0,d=0,w=0;switch(c.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:c.shiftKey?A=-1:(c.preventDefault(),d=-1);break;case 39:c.shiftKey?A=1:(c.preventDefault(),d=1);break;case 38:c.shiftKey?h=1:(c.preventDefault(),w=-1);break;case 40:c.shiftKey?h=-1:(c.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(A=0,h=0),{cameraAnimation:b=>{const C=b.getZoom();b.easeTo({duration:300,easeId:"keyboardHandler",easing:Ch,zoom:_?Math.round(C)+_*(c.shiftKey?2:1):C,bearing:b.getBearing()+A*this._bearingStep,pitch:b.getPitch()+h*this._pitchStep,offset:[-d*this._panStep,-w*this._panStep],center:b.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ch(L){return L*(2-L)}const Ec=4.000244140625;class _u{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._handler=_,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;c.preventDefault()}let _=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const A=o.exported.now(),h=A-(this._lastWheelEventTime||0);this._lastWheelEventTime=A,_!==0&&_%Ec==0?this._type="wheel":_!==0&&Math.abs(_)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=_,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(h*_)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,_+=this._lastValue)),c.shiftKey&&_&&(_/=4),this._type&&(this._lastWheelEvent=c,this._delta-=_,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const _=k.mousePos(this._el,c);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(_)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>Ec?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&C!==0&&(C=1/C);const P=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(P*C))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,A=this._startZoom,h=this._easing;let d,w=!1;if(this._type==="wheel"&&A&&h){const b=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),C=h(b);d=o.number(A,_,C),b<1?this._frameId||(this._frameId=!0):w=!0}else d=_,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:d-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let _=o.ease;if(this._prevEase){const A=this._prevEase,h=(o.exported.now()-A.start)/A.duration,d=A.easing(h+.01)-A.easing(h),w=.27/Math.sqrt(d*d+1e-4)*.01,b=Math.sqrt(.0729-w*w);_=o.bezier(w,b,.25,1)}return this._prevEase={start:o.exported.now(),duration:c,easing:_},_}reset(){this._active=!1}}class vu{constructor(c,_){this._clickZoom=c,this._tapZoom=_}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class xu{constructor(){this.reset()}reset(){this._active=!1}dblclick(c,_){return c.preventDefault(),{cameraAnimation:A=>{A.easeTo({duration:300,zoom:A.getZoom()+(c.shiftKey?-1:1),around:A.unproject(_)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qs{constructor(){this._tap=new tl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(c,_,A){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?A.length>0&&(this._swipePoint=_[0],this._swipeTouch=A[0].identifier):this._tap.touchstart(c,_,A))}touchmove(c,_,A){if(this._tapTime){if(this._swipePoint){if(A[0].identifier!==this._swipeTouch)return;const h=_[0],d=h.y-this._swipePoint.y;return this._swipePoint=h,c.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(c,_,A)}touchend(c,_,A){this._tapTime?this._swipePoint&&A.length===0&&this.reset():this._tap.touchend(c,_,A)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bi{constructor(c,_,A){this._el=c,this._mousePan=_,this._touchPan=A}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class To{constructor(c,_,A){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=_,this._mousePitch=A}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class wu{constructor(c,_,A,h){this._el=c,this._touchZoom=_,this._touchRotate=A,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Sa=L=>L.zoom||L.drag||L.pitch||L.rotate;class Ur extends o.Event{}function jl(L){return L.panDelta&&L.panDelta.mag()||L.zoomDelta||L.bearingDelta||L.pitchDelta}class Tc{constructor(c,_){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wc(c),this._bearingSnap=_.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(_),o.bindAll(["handleEvent","handleWindowEvent"],this);const A=this._el;this._listeners=[[A,"touchstart",{passive:!0}],[A,"touchmove",{passive:!1}],[A,"touchend",void 0],[A,"touchcancel",void 0],[A,"mousedown",void 0],[A,"mousemove",void 0],[A,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[A,"mouseover",void 0],[A,"mouseout",void 0],[A,"dblclick",void 0],[A,"click",void 0],[A,"keydown",{capture:!1}],[A,"keyup",void 0],[A,"wheel",{passive:!1}],[A,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,d,w]of this._listeners)k.addEventListener(h,d,h===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[c,_,A]of this._listeners)k.removeEventListener(c,_,c===document?this.handleWindowEvent:this.handleEvent,A)}_addDefaultHandlers(c){const _=this._map,A=_.getCanvasContainer();this._add("mapEvent",new Vl(_,c));const h=_.boxZoom=new bc(_,c);this._add("boxZoom",h);const d=new Th,w=new xu;_.doubleClickZoom=new vu(w,d),this._add("tapZoom",d),this._add("clickZoom",w);const b=new qs;this._add("tapDragZoom",b);const C=_.touchPitch=new rl(_);this._add("touchPitch",C);const P=new ds(c),B=new Nt(c);_.dragRotate=new To(c,P,B),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const V=new Ea(c),W=new gu(c,_);_.dragPan=new Bi(A,V,W),this._add("mousePan",V),this._add("touchPan",W,["touchZoom","touchRotate"]);const X=new $l,ae=new Vt;_.touchZoomRotate=new wu(A,ae,X,b),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]);const ne=_.scrollZoom=new _u(_,this);this._add("scrollZoom",ne,["mousePan"]);const ue=_.keyboard=new yu;this._add("keyboard",ue),this._add("blockableMapEvent",new Xo(_));for(const be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[be]&&_[be].enable(c[be])}_add(c,_,A){this._handlers.push({handlerName:c,handler:_,allowed:A}),this._handlersById[c]=_}stop(c){if(!this._updatingCamera){for(const{handler:_}of this._handlers)_.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Sa(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,_,A){for(const h in c)if(h!==A&&(!_||_.indexOf(h)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const _=[];for(const A of c)this._el.contains(A.target)&&_.push(A);return _}handleEvent(c,_){if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const A=c.type==="renderFrame"?void 0:c,h={needsRenderFrame:!1},d={},w={},b=c.touches,C=b?this._getMapTouches(b):void 0,P=C?k.touchPos(this._el,C):k.mousePos(this._el,c);for(const{handlerName:W,handler:X,allowed:ae}of this._handlers){if(!X.isEnabled())continue;let ne;this._blockedByActive(w,ae,W)?X.reset():X[_||c.type]&&(ne=X[_||c.type](c,P,C),this.mergeHandlerResult(h,d,ne,W,A),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()),(ne||X.isActive())&&(w[W]=X)}const B={};for(const W in this._previousActiveHandlers)w[W]||(B[W]=A);this._previousActiveHandlers=w,(Object.keys(B).length||jl(h))&&(this._changes.push([h,d,B]),this._triggerRenderFrame()),(Object.keys(w).length||jl(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=h;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(c,_,A,h,d){if(!A)return;o.extend(c,A);const w={handlerName:h,originalEvent:A.originalEvent||d};A.zoomDelta!==void 0&&(_.zoom=w),A.panDelta!==void 0&&(_.drag=w),A.pitchDelta!==void 0&&(_.pitch=w),A.bearingDelta!==void 0&&(_.rotate=w)}_applyChanges(){const c={},_={},A={};for(const[h,d,w]of this._changes)h.panDelta&&(c.panDelta=(c.panDelta||new o.pointGeometry(0,0))._add(h.panDelta)),h.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(c.around=h.around),h.pinchAround!==void 0&&(c.pinchAround=h.pinchAround),h.noInertia&&(c.noInertia=h.noInertia),o.extend(_,d),o.extend(A,w);this._updateMapTransform(c,_,A),this._changes=[]}_updateMapTransform(c,_,A){const h=this._map,d=h.transform,w=h.style&&h.style.terrain;if(!(jl(c)||w&&this._drag))return this._fireEvents(_,A,!0);let{panDelta:b,zoomDelta:C,bearingDelta:P,pitchDelta:B,around:V,pinchAround:W}=c;W!==void 0&&(V=W),h._stop(!0),V=V||h.transform.centerPoint;const X=d.pointLocation(b?V.sub(b):V);P&&(d.bearing+=P),B&&(d.pitch+=B),C&&(d.zoom+=C),w?_.drag&&!this._drag?(this._drag={center:d.centerPoint,lngLat:d.pointLocation(V),point:V,handlerName:_.drag.handlerName},h.fire(new o.Event("freezeElevation",{freeze:!0}))):this._drag&&A[this._drag.handlerName]?(h.fire(new o.Event("freezeElevation",{freeze:!1})),this._drag=null):_.drag&&this._drag&&(d.center=d.pointLocation(d.centerPoint.sub(b))):d.setLocationAtPoint(X,V),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(_,A,!0)}_fireEvents(c,_,A){const h=Sa(this._eventsInProgress),d=Sa(c),w={};for(const B in c){const{originalEvent:V}=c[B];this._eventsInProgress[B]||(w[`${B}start`]=V),this._eventsInProgress[B]=c[B]}!h&&d&&this._fireEvent("movestart",d.originalEvent);for(const B in w)this._fireEvent(B,w[B]);d&&this._fireEvent("move",d.originalEvent);for(const B in c){const{originalEvent:V}=c[B];this._fireEvent(B,V)}const b={};let C;for(const B in this._eventsInProgress){const{handlerName:V,originalEvent:W}=this._eventsInProgress[B];this._handlersById[V].isActive()||(delete this._eventsInProgress[B],C=_[V]||W,b[`${B}end`]=C)}for(const B in b)this._fireEvent(B,b[B]);const P=Sa(this._eventsInProgress);if(A&&(h||d)&&!P){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;B?(V(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:C})):(this._map.fire(new o.Event("moveend",{originalEvent:C})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,_){this._map.fire(new o.Event(c,_?{originalEvent:_}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new Ur("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ps={extend:(L,...c)=>o.extend(L,...c),run(L){L()},logToElement(L,c=!1,_="log"){const A=window.document.getElementById(_);A&&(c&&(A.innerHTML=""),A.innerHTML+=`<br>${L}`)}};class Mr extends o.Evented{constructor(c,_){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=_.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,_){return this.jumpTo({center:c},_)}panBy(c,_,A){return c=o.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,o.extend({offset:c},_),A)}panTo(c,_,A){return this.easeTo(o.extend({center:c},_),A)}getZoom(){return this.transform.zoom}setZoom(c,_){return this.jumpTo({zoom:c},_),this}zoomTo(c,_,A){return this.easeTo(o.extend({zoom:c},_),A)}zoomIn(c,_){return this.zoomTo(this.getZoom()+1,c,_),this}zoomOut(c,_){return this.zoomTo(this.getZoom()-1,c,_),this}getBearing(){return this.transform.bearing}setBearing(c,_){return this.jumpTo({bearing:c},_),this}getPadding(){return this.transform.padding}setPadding(c,_){return this.jumpTo({padding:c},_),this}rotateTo(c,_,A){return this.easeTo(o.extend({bearing:c},_),A)}resetNorth(c,_){return this.rotateTo(0,o.extend({duration:1e3},c),_),this}resetNorthPitch(c,_){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},c),_),this}snapToNorth(c,_){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,_):this}getPitch(){return this.transform.pitch}setPitch(c,_){return this.jumpTo({pitch:c},_),this}cameraForBounds(c,_){c=o.LngLatBounds.convert(c);const A=_&&_.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),A,_)}_cameraForBoxAndBearing(c,_,A,h){const d={top:0,bottom:0,right:0,left:0};if(typeof(h=o.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const Se=h.padding;h.padding={top:Se,bottom:Se,right:Se,left:Se}}h.padding=o.extend(d,h.padding);const w=this.transform,b=w.padding,C=w.project(o.LngLat.convert(c)),P=w.project(o.LngLat.convert(_)),B=C.rotate(-A*Math.PI/180),V=P.rotate(-A*Math.PI/180),W=new o.pointGeometry(Math.max(B.x,V.x),Math.max(B.y,V.y)),X=new o.pointGeometry(Math.min(B.x,V.x),Math.min(B.y,V.y)),ae=W.sub(X),ne=(w.width-(b.left+b.right+h.padding.left+h.padding.right))/ae.x,ue=(w.height-(b.top+b.bottom+h.padding.top+h.padding.bottom))/ae.y;if(ue<0||ne<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const be=Math.min(w.scaleZoom(w.scale*Math.min(ne,ue)),h.maxZoom),Me=o.pointGeometry.convert(h.offset),ve=new o.pointGeometry((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(A*Math.PI/180),$e=Me.add(ve).mult(w.scale/w.zoomScale(be));return{center:w.unproject(C.add(P).div(2).sub($e)),zoom:be,bearing:A}}fitBounds(c,_,A){return this._fitInternal(this.cameraForBounds(c,_),_,A)}fitScreenCoordinates(c,_,A,h,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(c)),this.transform.pointLocation(o.pointGeometry.convert(_)),A,h),h,d)}_fitInternal(c,_,A){return c?(delete(_=o.extend(c,_)).padding,_.linear?this.easeTo(_,A):this.flyTo(_,A)):this}jumpTo(c,_){this.stop();const A=this.transform;let h=!1,d=!1,w=!1;return"zoom"in c&&A.zoom!==+c.zoom&&(h=!0,A.zoom=+c.zoom),c.center!==void 0&&(A.center=o.LngLat.convert(c.center)),"bearing"in c&&A.bearing!==+c.bearing&&(d=!0,A.bearing=+c.bearing),"pitch"in c&&A.pitch!==+c.pitch&&(w=!0,A.pitch=+c.pitch),c.padding==null||A.isPaddingEqual(c.padding)||(A.padding=c.padding),this.fire(new o.Event("movestart",_)).fire(new o.Event("move",_)),h&&this.fire(new o.Event("zoomstart",_)).fire(new o.Event("zoom",_)).fire(new o.Event("zoomend",_)),d&&this.fire(new o.Event("rotatestart",_)).fire(new o.Event("rotate",_)).fire(new o.Event("rotateend",_)),w&&this.fire(new o.Event("pitchstart",_)).fire(new o.Event("pitch",_)).fire(new o.Event("pitchend",_)),this.fire(new o.Event("moveend",_))}calculateCameraOptionsFromTo(c,_,A,h=0){const d=o.MercatorCoordinate.fromLngLat(c,_),w=o.MercatorCoordinate.fromLngLat(A,h),b=w.x-d.x,C=w.y-d.y,P=w.z-d.z,B=Math.hypot(b,C,P);if(B===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(b,C),W=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),X=180*Math.atan2(b,-C)/Math.PI;let ae=180*Math.acos(V/B)/Math.PI;return ae=P<0?90-ae:90+ae,{center:w.toLngLat(),zoom:W,pitch:ae,bearing:X}}easeTo(c,_){this._stop(!1,c.easeId),((c=o.extend({offset:[0,0],duration:500,easing:o.ease},c)).animate===!1||!c.essential&&o.exported.prefersReducedMotion)&&(c.duration=0);const A=this.transform,h=this.getZoom(),d=this.getBearing(),w=this.getPitch(),b=this.getPadding(),C="zoom"in c?+c.zoom:h,P="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:w,V="padding"in c?c.padding:A.padding,W=o.pointGeometry.convert(c.offset);let X=A.centerPoint.add(W);const ae=A.pointLocation(X),ne=o.LngLat.convert(c.center||ae);this._normalizeCenter(ne);const ue=A.project(ae),be=A.project(ne).sub(ue),Me=A.zoomScale(C-h);let ve,$e;c.around&&(ve=o.LngLat.convert(c.around),$e=A.locationPoint(ve));const Se={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||C!==h,this._rotating=this._rotating||d!==P,this._pitching=this._pitching||B!==w,this._padding=!A.isPaddingEqual(V),this._easeId=c.easeId,this._prepareEase(_,c.noMoveStart,Se),this._ease(Ge=>{if(this._zooming&&(A.zoom=o.number(h,C,Ge)),this._rotating&&(A.bearing=o.number(d,P,Ge)),this._pitching&&(A.pitch=o.number(w,B,Ge)),this._padding&&(A.interpolatePadding(b,V,Ge),X=A.centerPoint.add(W)),ve)A.setLocationAtPoint(ve,$e);else{const xe=A.zoomScale(A.zoom-h),y=C>h?Math.min(2,Me):Math.max(.5,Me),m=Math.pow(y,1-Ge),x=A.unproject(ue.add(be.mult(Ge*m)).mult(xe));A.setLocationAtPoint(A.renderWorldCopies?x.wrap():x,X)}this._fireMoveEvents(_)},Ge=>{this._afterEase(_,Ge)},c),this}_prepareEase(c,_,A={}){this._moving=!0,this.fire(new o.Event("freezeElevation",{freeze:!0})),_||A.moving||this.fire(new o.Event("movestart",c)),this._zooming&&!A.zooming&&this.fire(new o.Event("zoomstart",c)),this._rotating&&!A.rotating&&this.fire(new o.Event("rotatestart",c)),this._pitching&&!A.pitching&&this.fire(new o.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new o.Event("move",c)),this._zooming&&this.fire(new o.Event("zoom",c)),this._rotating&&this.fire(new o.Event("rotate",c)),this._pitching&&this.fire(new o.Event("pitch",c))}_afterEase(c,_){if(this._easeId&&_&&this._easeId===_)return;delete this._easeId,this.fire(new o.Event("freezeElevation",{freeze:!1}));const A=this._zooming,h=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,A&&this.fire(new o.Event("zoomend",c)),h&&this.fire(new o.Event("rotateend",c)),d&&this.fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c))}flyTo(c,_){if(!c.essential&&o.exported.prefersReducedMotion){const U=o.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(U,_)}this.stop(),c=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},c);const A=this.transform,h=this.getZoom(),d=this.getBearing(),w=this.getPitch(),b=this.getPadding(),C="zoom"in c?o.clamp(+c.zoom,A.minZoom,A.maxZoom):h,P="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:w,V="padding"in c?c.padding:A.padding,W=A.zoomScale(C-h),X=o.pointGeometry.convert(c.offset);let ae=A.centerPoint.add(X);const ne=A.pointLocation(ae),ue=o.LngLat.convert(c.center||ne);this._normalizeCenter(ue);const be=A.project(ne),Me=A.project(ue).sub(be);let ve=c.curve;const $e=Math.max(A.width,A.height),Se=$e/W,Ge=Me.mag();if("minZoom"in c){const U=o.clamp(Math.min(c.minZoom,h,C),A.minZoom,A.maxZoom),q=$e/A.zoomScale(U-h);ve=Math.sqrt(q/Ge*2)}const xe=ve*ve;function y(U){const q=(Se*Se-$e*$e+(U?-1:1)*xe*xe*Ge*Ge)/(2*(U?Se:$e)*xe*Ge);return Math.log(Math.sqrt(q*q+1)-q)}function m(U){return(Math.exp(U)-Math.exp(-U))/2}function x(U){return(Math.exp(U)+Math.exp(-U))/2}const E=y(0);let I=function(U){return x(E)/x(E+ve*U)},R=function(U){return $e*((x(E)*(m(q=E+ve*U)/x(q))-m(E))/xe)/Ge;var q},O=(y(1)-E)/ve;if(Math.abs(Ge)<1e-6||!isFinite(O)){if(Math.abs($e-Se)<1e-6)return this.easeTo(c,_);const U=Se<$e?-1:1;O=Math.abs(Math.log(Se/$e))/ve,R=function(){return 0},I=function(q){return Math.exp(U*ve*q)}}return c.duration="duration"in c?+c.duration:1e3*O/("screenSpeed"in c?+c.screenSpeed/ve:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=d!==P,this._pitching=B!==w,this._padding=!A.isPaddingEqual(V),this._prepareEase(_,!1),this._ease(U=>{const q=U*O,ee=1/I(q);A.zoom=U===1?C:h+A.scaleZoom(ee),this._rotating&&(A.bearing=o.number(d,P,U)),this._pitching&&(A.pitch=o.number(w,B,U)),this._padding&&(A.interpolatePadding(b,V,U),ae=A.centerPoint.add(X));const le=U===1?ue:A.unproject(be.add(Me.mult(R(q))).mult(ee));A.setLocationAtPoint(A.renderWorldCopies?le.wrap():le,ae),this._fireMoveEvents(_)},()=>this._afterEase(_),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,_){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const A=this._onEaseEnd;delete this._onEaseEnd,A.call(this,_)}if(!c){const A=this.handlers;A&&A.stop(!1)}return this}_ease(c,_,A){A.animate===!1||A.duration===0?(c(1),_()):(this._easeStart=o.exported.now(),this._easeOptions=A,this._onEaseFrame=c,this._onEaseEnd=_,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,_){c=o.wrap(c,-180,180);const A=Math.abs(c-_);return Math.abs(c-360-_)<A&&(c-=360),Math.abs(c+360-_)<A&&(c+=360),c}_normalizeCenter(c){const _=this.transform;if(!_.renderWorldCopies||_.lngRange)return;const A=c.lng-_.center.lng;c.lng+=A>180?-360:A<-180?360:0}}class il{constructor(c={}){this.options=c,o.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options&&this.options.compact,this._container=k.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=k.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=k.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){k.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,_){const A=this._map._getUIString(`AttributionControl.${_}`);c.title=A,c.setAttribute("aria-label",A)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const _=this._map.style.sourceCaches;for(const h in _){const d=_[h];if(d.used||d.usedForTerrain){const w=d.getSource();w.attribution&&c.indexOf(w.attribution)<0&&c.push(w.attribution)}}c=c.filter(h=>String(h).trim()),c.sort((h,d)=>h.length-d.length),c=c.filter((h,d)=>{for(let w=d+1;w<c.length;w++)if(c[w].indexOf(h)>=0)return!1;return!0});const A=c.join(" | ");A!==this._attribHTML&&(this._attribHTML=A,c.length?(this._innerContainer.innerHTML=A,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Hl{constructor(c={}){this.options=c,o.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=k.create("div","maplibregl-ctrl mapboxgl-ctrl");const _=k.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return _.target="_blank",_.rel="noopener nofollow",_.href="https://maplibre.org/",_.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),_.setAttribute("rel","noopener nofollow"),this._container.appendChild(_),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){k.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const c=this._container.children;if(c.length){const _=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&_.classList.add("maplibregl-compact","mapboxgl-compact"):_.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class bu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const _=++this._id;return this._queue.push({callback:c,id:_,cancelled:!1}),_}remove(c){const _=this._currentlyRunning,A=_?this._queue.concat(_):this._queue;for(const h of A)if(h.id===c)return void(h.cancelled=!0)}run(c=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const _=this._currentlyRunning=this._queue;this._queue=[];for(const A of _)if(!A.cancelled&&(A.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Sc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},Eu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Cc={showCompass:!0,showZoom:!0,visualizePitch:!1};class mr{constructor(c,_,A=!1){this._clickTolerance=10,this.element=_,this.mouseRotate=new ds({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,A&&(this.mousePitch=new Nt({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),k.addEventListener(_,"mousedown",this.mousedown),k.addEventListener(_,"touchstart",this.touchstart,{passive:!1}),k.addEventListener(_,"touchmove",this.touchmove),k.addEventListener(_,"touchend",this.touchend),k.addEventListener(_,"touchcancel",this.reset)}down(c,_){this.mouseRotate.mousedown(c,_),this.mousePitch&&this.mousePitch.mousedown(c,_),k.disableDrag()}move(c,_){const A=this.map,h=this.mouseRotate.mousemoveWindow(c,_);if(h&&h.bearingDelta&&A.setBearing(A.getBearing()+h.bearingDelta),this.mousePitch){const d=this.mousePitch.mousemoveWindow(c,_);d&&d.pitchDelta&&A.setPitch(A.getPitch()+d.pitchDelta)}}off(){const c=this.element;k.removeEventListener(c,"mousedown",this.mousedown),k.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),k.removeEventListener(c,"touchmove",this.touchmove),k.removeEventListener(c,"touchend",this.touchend),k.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){k.enableDrag(),k.removeEventListener(window,"mousemove",this.mousemove),k.removeEventListener(window,"mouseup",this.mouseup)}mousedown(c){this.down(o.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),k.mousePos(this.element,c)),k.addEventListener(window,"mousemove",this.mousemove),k.addEventListener(window,"mouseup",this.mouseup)}mousemove(c){this.move(c,k.mousePos(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=k.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=k.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Wl(L,c,_){if(L=new o.LngLat(L.lng,L.lat),c){const A=new o.LngLat(L.lng-360,L.lat),h=new o.LngLat(L.lng+360,L.lat),d=_.locationPoint(L).distSqr(c);_.locationPoint(A).distSqr(c)<d?L=A:_.locationPoint(h).distSqr(c)<d&&(L=h)}for(;Math.abs(L.lng-_.center.lng)>180;){const A=_.locationPoint(L);if(A.x>=0&&A.y>=0&&A.x<=_.width&&A.y<=_.height)break;L.lng>_.center.lng?L.lng-=360:L.lng+=360}return L}const Xt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Kt(L,c,_){const A=L.classList;for(const h in Xt)A.remove(`maplibregl-${_}-anchor-${h}`,`mapboxgl-${_}-anchor-${h}`);A.add(`maplibregl-${_}-anchor-${c}`,`mapboxgl-${_}-anchor-${c}`)}class fn extends o.Evented{constructor(c,_){if(super(),(c instanceof HTMLElement||_)&&(c=o.extend({element:c},_)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=o.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=k.create("div"),this._element.setAttribute("aria-label","Map marker");const A=k.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;A.setAttributeNS(null,"display","block"),A.setAttributeNS(null,"height",`${h}px`),A.setAttributeNS(null,"width",`${d}px`),A.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const w=k.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const b=k.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const C=k.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"transform","translate(3.0, 29.0)"),C.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Me of P){const ve=k.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",Me.rx),ve.setAttributeNS(null,"ry",Me.ry),C.appendChild(ve)}const B=k.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const V=k.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(V);const W=k.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"fill","#000000");const X=k.createNS("http://www.w3.org/2000/svg","path");X.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),W.appendChild(X);const ae=k.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ae.setAttributeNS(null,"fill","#FFFFFF");const ne=k.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=k.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const be=k.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#FFFFFF"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962"),ne.appendChild(ue),ne.appendChild(be),b.appendChild(C),b.appendChild(B),b.appendChild(W),b.appendChild(ae),b.appendChild(ne),A.appendChild(b),A.setAttributeNS(null,"height",h*this._scale+"px"),A.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(A),this._offset=o.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",A=>{A.preventDefault()}),this._element.addEventListener("mousedown",A=>{A.preventDefault()}),Kt(this._element,this._anchor,"marker"),this._popup=null}addTo(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),k.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=o.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const h=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(c){const _=c.code,A=c.charCode||c.keyCode;_!=="Space"&&_!=="Enter"&&A!==32&&A!==13||this.togglePopup()}_onMapClick(c){const _=c.originalEvent.target,A=this._element;this._popup&&(_===A||A.contains(_))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this}_update(c){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Wl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let A="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?A="rotateX(0deg)":this._pitchAlignment==="map"&&(A=`rotateX(${this._map.getPitch()}deg)`),c&&c.type!=="moveend"||(this._pos=this._pos.round()),k.setTransform(this._element,`${Xt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${A} ${_}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const h=this._map.unproject(this._pos),d=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=h.distanceTo(this._lngLat)>20*d?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(c){return this._offset=o.pointGeometry.convert(c),this._update(),this}_onMove(c){if(!this._isDragging){const _=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=_}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const es={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Jo,Hr=0,Zs=!1;const Ps={maxWidth:100,unit:"metric"};function Ys(L,c,_){const A=_&&_.maxWidth||100,h=L._container.clientHeight/2,d=L.unproject([0,h]),w=L.unproject([A,h]),b=d.distanceTo(w);if(_&&_.unit==="imperial"){const C=3.2808*b;C>5280?Ct(c,A,C/5280,L._getUIString("ScaleControl.Miles")):Ct(c,A,C,L._getUIString("ScaleControl.Feet"))}else _&&_.unit==="nautical"?Ct(c,A,b/1852,L._getUIString("ScaleControl.NauticalMiles")):b>=1e3?Ct(c,A,b/1e3,L._getUIString("ScaleControl.Kilometers")):Ct(c,A,b,L._getUIString("ScaleControl.Meters"))}function Ct(L,c,_,A){const h=function(d){const w=Math.pow(10,`${Math.floor(d)}`.length-1);let b=d/w;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(C){const P=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*P)/P}(b),w*b}(_);L.style.width=c*(h/_)+"px",L.innerHTML=`${h}&nbsp;${A}`}const Pt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Wr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function sl(L){if(L){if(typeof L=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(L,2)));return{center:new o.pointGeometry(0,0),top:new o.pointGeometry(0,L),"top-left":new o.pointGeometry(c,c),"top-right":new o.pointGeometry(-c,c),bottom:new o.pointGeometry(0,-L),"bottom-left":new o.pointGeometry(c,-c),"bottom-right":new o.pointGeometry(-c,-c),left:new o.pointGeometry(L,0),right:new o.pointGeometry(-L,0)}}if(L instanceof o.pointGeometry||Array.isArray(L)){const c=o.pointGeometry.convert(L);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:o.pointGeometry.convert(L.center||[0,0]),top:o.pointGeometry.convert(L.top||[0,0]),"top-left":o.pointGeometry.convert(L["top-left"]||[0,0]),"top-right":o.pointGeometry.convert(L["top-right"]||[0,0]),bottom:o.pointGeometry.convert(L.bottom||[0,0]),"bottom-left":o.pointGeometry.convert(L["bottom-left"]||[0,0]),"bottom-right":o.pointGeometry.convert(L["bottom-right"]||[0,0]),left:o.pointGeometry.convert(L.left||[0,0]),right:o.pointGeometry.convert(L.right||[0,0])}}return sl(new o.pointGeometry(0,0))}const Xs={supported:p,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Mr{constructor(L){var c;if(o.PerformanceUtils.mark(o.PerformanceMarkers.create),(L=o.extend({},Eu,L)).minZoom!=null&&L.maxZoom!=null&&L.minZoom>L.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(L.minPitch!=null&&L.maxPitch!=null&&L.minPitch>L.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(L.minPitch!=null&&L.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(L.maxPitch!=null&&L.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new bo(L.minZoom,L.maxZoom,L.minPitch,L.maxPitch,L.renderWorldCopies),{bearingSnap:L.bearingSnap}),this._interactive=L.interactive,this._cooperativeGestures=L.cooperativeGestures,this._maxTileCacheSize=L.maxTileCacheSize,this._failIfMajorPerformanceCaveat=L.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=L.preserveDrawingBuffer,this._antialias=L.antialias,this._trackResize=L.trackResize,this._bearingSnap=L.bearingSnap,this._refreshExpiredTiles=L.refreshExpiredTiles,this._fadeDuration=L.fadeDuration,this._crossSourceCollisions=L.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=L.collectResourceTiming,this._renderTaskQueue=new bu,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},Sc,L.locale),this._clickTolerance=L.clickTolerance,this._pixelRatio=(c=L.pixelRatio)!==null&&c!==void 0?c:devicePixelRatio,this._requestManager=new F(L.transformRequest),typeof L.container=="string"){if(this._container=document.getElementById(L.container),!this._container)throw new Error(`Container '${L.container}' not found.`)}else{if(!(L.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=L.container}if(L.maxBounds&&this.setMaxBounds(L.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Tc(this,L),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=L.hash&&new mi(typeof L.hash=="string"&&L.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:L.center,zoom:L.zoom,bearing:L.bearing,pitch:L.pitch}),L.bounds&&(this.resize(),this.fitBounds(L.bounds,o.extend({},L.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=L.localIdeographFontFamily,L.style&&this.setStyle(L.style,{localIdeographFontFamily:L.localIdeographFontFamily}),L.attributionControl&&this.addControl(new il({customAttribution:L.customAttribution})),L.maplibreLogo&&this.addControl(new Hl,L.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",_=>{this._update(_.dataType==="style"),this.fire(new o.Event(`${_.dataType}data`,_))}),this.on("dataloading",_=>{this.fire(new o.Event(`${_.dataType}dataloading`,_))}),this.on("dataabort",_=>{this.fire(new o.Event("sourcedataabort",_))})}_getMapId(){return this._mapId}addControl(L,c){if(c===void 0&&(c=L.getDefaultPosition?L.getDefaultPosition():"top-right"),!L||!L.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const _=L.onAdd(this);this._controls.push(L);const A=this._controlPositions[c];return c.indexOf("bottom")!==-1?A.insertBefore(_,A.firstChild):A.appendChild(_),this}removeControl(L){if(!L||!L.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(L);return c>-1&&this._controls.splice(c,1),L.onRemove(this),this}hasControl(L){return this._controls.indexOf(L)>-1}calculateCameraOptionsFromTo(L,c,_,A){return A==null&&this.style.terrain&&(A=this.transform.getElevation(_,this.style.terrain)),super.calculateCameraOptionsFromTo(L,c,_,A)}resize(L){const c=this._containerDimensions(),_=c[0],A=c[1];this._resizeCanvas(_,A,this.getPixelRatio()),this.transform.resize(_,A),this.painter.resize(_,A,this.getPixelRatio());const h=!this._moving;return h&&(this.stop(),this.fire(new o.Event("movestart",L)).fire(new o.Event("move",L))),this.fire(new o.Event("resize",L)),h&&this.fire(new o.Event("moveend",L)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(L){const[c,_]=this._containerDimensions();this._pixelRatio=L,this._resizeCanvas(c,_,L),this.painter.resize(c,_,L)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(L){return this.transform.setMaxBounds(o.LngLatBounds.convert(L)),this._update()}setMinZoom(L){if((L=L??-2)>=-2&&L<=this.transform.maxZoom)return this.transform.minZoom=L,this._update(),this.getZoom()<L&&this.setZoom(L),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(L){if((L=L??22)>=this.transform.minZoom)return this.transform.maxZoom=L,this._update(),this.getZoom()>L&&this.setZoom(L),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(L){if((L=L??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(L>=0&&L<=this.transform.maxPitch)return this.transform.minPitch=L,this._update(),this.getPitch()<L&&this.setPitch(L),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(L){if((L=L??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(L>=this.transform.minPitch)return this.transform.maxPitch=L,this._update(),this.getPitch()>L&&this.setPitch(L),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(L){return this.transform.renderWorldCopies=L,this._update()}project(L){return this.transform.locationPoint(o.LngLat.convert(L),this.style&&this.style.terrain)}unproject(L){return this.transform.pointLocation(o.pointGeometry.convert(L),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(L,c,_){if(L==="mouseenter"||L==="mouseover"){let A=!1;return{layer:c,listener:_,delegates:{mousemove:d=>{const w=this.getLayer(c)?this.queryRenderedFeatures(d.point,{layers:[c]}):[];w.length?A||(A=!0,_.call(this,new ai(L,this,d.originalEvent,{features:w}))):A=!1},mouseout:()=>{A=!1}}}}if(L==="mouseleave"||L==="mouseout"){let A=!1;return{layer:c,listener:_,delegates:{mousemove:w=>{(this.getLayer(c)?this.queryRenderedFeatures(w.point,{layers:[c]}):[]).length?A=!0:A&&(A=!1,_.call(this,new ai(L,this,w.originalEvent)))},mouseout:w=>{A&&(A=!1,_.call(this,new ai(L,this,w.originalEvent)))}}}}{const A=h=>{const d=this.getLayer(c)?this.queryRenderedFeatures(h.point,{layers:[c]}):[];d.length&&(h.features=d,_.call(this,h),delete h.features)};return{layer:c,listener:_,delegates:{[L]:A}}}}on(L,c,_){if(_===void 0)return super.on(L,c);const A=this._createDelegatedListener(L,c,_);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[L]=this._delegatedListeners[L]||[],this._delegatedListeners[L].push(A);for(const h in A.delegates)this.on(h,A.delegates[h]);return this}once(L,c,_){if(_===void 0)return super.once(L,c);const A=this._createDelegatedListener(L,c,_);for(const h in A.delegates)this.once(h,A.delegates[h]);return this}off(L,c,_){return _===void 0?super.off(L,c):(this._delegatedListeners&&this._delegatedListeners[L]&&(A=>{const h=this._delegatedListeners[L];for(let d=0;d<h.length;d++){const w=h[d];if(w.layer===c&&w.listener===_){for(const b in w.delegates)this.off(b,w.delegates[b]);return h.splice(d,1),this}}})(),this)}queryRenderedFeatures(L,c){if(!this.style)return[];let _;if(c!==void 0||L===void 0||L instanceof o.pointGeometry||Array.isArray(L)||(c=L,L=void 0),c=c||{},(L=L||[[0,0],[this.transform.width,this.transform.height]])instanceof o.pointGeometry||typeof L[0]=="number")_=[o.pointGeometry.convert(L)];else{const A=o.pointGeometry.convert(L[0]),h=o.pointGeometry.convert(L[1]);_=[A,new o.pointGeometry(h.x,A.y),h,new o.pointGeometry(A.x,h.y),A]}return this.style.queryRenderedFeatures(_,c,this.transform)}querySourceFeatures(L,c){return this.style.querySourceFeatures(L,c)}setStyle(L,c){return(c=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&L?(this._diffStyle(L,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(L,c))}setTransformRequest(L){return this._requestManager.setTransformRequest(L),this}_getUIString(L){const c=this._locale[L];if(c==null)throw new Error(`Missing UI string '${L}'`);return c}_updateStyle(L,c){return this.style&&(this.style.setEventedParent(null),this.style._remove()),L?(this.style=new Ce(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof L=="string"?this.style.loadURL(L):this.style.loadJSON(L),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ce(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(L,c){if(typeof L=="string"){const _=this._requestManager.transformRequest(L,o.ResourceType.Style);o.getJSON(_,(A,h)=>{A?this.fire(new o.ErrorEvent(A)):h&&this._updateDiff(h,c)})}else typeof L=="object"&&this._updateDiff(L,c)}_updateDiff(L,c){try{this.style.setState(L)&&this._update(!0)}catch(_){o.warnOnce(`Unable to perform style diff: ${_.message||_.error||_}.  Rebuilding the style from scratch.`),this._updateStyle(L,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")}addSource(L,c){return this._lazyInitEmptyStyle(),this.style.addSource(L,c),this._update(!0)}isSourceLoaded(L){const c=this.style&&this.style.sourceCaches[L];if(c!==void 0)return c.loaded();this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${L}'`)))}setTerrain(L){return this.style.setTerrain(L),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const L=this.style&&this.style.sourceCaches;for(const c in L){const _=L[c]._tiles;for(const A in _){const h=_[A];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}addSourceType(L,c,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(L,c,_)}removeSource(L){return this.style.removeSource(L),this._update(!0)}getSource(L){return this.style.getSource(L)}addImage(L,c,{pixelRatio:_=1,sdf:A=!1,stretchX:h,stretchY:d,content:w}={}){if(this._lazyInitEmptyStyle(),c instanceof HTMLImageElement||o.isImageBitmap(c)){const{width:b,height:C,data:P}=o.exported.getImageData(c);this.style.addImage(L,{data:new o.RGBAImage({width:b,height:C},P),pixelRatio:_,stretchX:h,stretchY:d,content:w,sdf:A,version:0})}else{if(c.width===void 0||c.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:b,height:C,data:P}=c,B=c;this.style.addImage(L,{data:new o.RGBAImage({width:b,height:C},new Uint8Array(P)),pixelRatio:_,stretchX:h,stretchY:d,content:w,sdf:A,version:0,userImage:B}),B.onAdd&&B.onAdd(this,L)}}}updateImage(L,c){const _=this.style.getImage(L);if(!_)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const A=c instanceof HTMLImageElement||o.isImageBitmap(c)?o.exported.getImageData(c):c,{width:h,height:d,data:w}=A;if(h===void 0||d===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==_.data.width||d!==_.data.height)return this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(c instanceof HTMLImageElement||o.isImageBitmap(c));_.data.replace(w,b),this.style.updateImage(L,_)}hasImage(L){return L?!!this.style.getImage(L):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(L){this.style.removeImage(L)}loadImage(L,c){o.getImage(this._requestManager.transformRequest(L,o.ResourceType.Image),c)}listImages(){return this.style.listImages()}addLayer(L,c){return this._lazyInitEmptyStyle(),this.style.addLayer(L,c),this._update(!0)}moveLayer(L,c){return this.style.moveLayer(L,c),this._update(!0)}removeLayer(L){return this.style.removeLayer(L),this._update(!0)}getLayer(L){return this.style.getLayer(L)}setLayerZoomRange(L,c,_){return this.style.setLayerZoomRange(L,c,_),this._update(!0)}setFilter(L,c,_={}){return this.style.setFilter(L,c,_),this._update(!0)}getFilter(L){return this.style.getFilter(L)}setPaintProperty(L,c,_,A={}){return this.style.setPaintProperty(L,c,_,A),this._update(!0)}getPaintProperty(L,c){return this.style.getPaintProperty(L,c)}setLayoutProperty(L,c,_,A={}){return this.style.setLayoutProperty(L,c,_,A),this._update(!0)}getLayoutProperty(L,c){return this.style.getLayoutProperty(L,c)}setLight(L,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(L,c),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(L,c){return this.style.setFeatureState(L,c),this._update()}removeFeatureState(L,c){return this.style.removeFeatureState(L,c),this._update()}getFeatureState(L){return this.style.getFeatureState(L)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let L=0,c=0;return this._container&&(L=this._container.clientWidth||400,c=this._container.clientHeight||300),[L,c]}_setupContainer(){const L=this._container;L.classList.add("maplibregl-map","mapboxgl-map");const c=this._canvasContainer=k.create("div","maplibregl-canvas-container mapboxgl-canvas-container",L);this._interactive&&c.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=k.create("canvas","maplibregl-canvas mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const _=this._containerDimensions();this._resizeCanvas(_[0],_[1],this.getPixelRatio());const A=this._controlContainer=k.create("div","maplibregl-control-container mapboxgl-control-container",L),h=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(d=>{h[d]=k.create("div",`maplibregl-ctrl-${d} mapboxgl-ctrl-${d}`,A)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const L=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=k.create("div","maplibregl-cooperative-gesture-screen",L);let c="Control",_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",c="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${_}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",A=>{A.key===c&&(this._metaPress=!0)}),document.addEventListener("keyup",A=>{A.key===c&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",A=>{this._onCooperativeGesture(A,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(L,c,_){this._canvas.width=_*L,this._canvas.height=_*c,this._canvas.style.width=`${L}px`,this._canvas.style.height=`${c}px`}_setupPainter(){const L=o.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl",L)||this._canvas.getContext("experimental-webgl",L);c?(this.painter=new Ei(c,this.transform),o.exported$1.testSupport(c)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(L){L.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:L}))}_contextRestored(L){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:L}))}_onMapScroll(L){if(L.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(L,c,_){return!c&&_<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(L){return this.style?(this._styleDirty=this._styleDirty||L,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(L){return this._update(),this._renderTaskQueue.add(L)}_cancelRenderFrame(L){this._renderTaskQueue.remove(L)}_render(L){let c,_=0;const A=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(c=A.createQueryEXT(),A.beginQueryEXT(A.TIME_ELAPSED_EXT,c),_=o.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(L),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const w=this.transform.zoom,b=o.exported.now();this.style.zoomHistory.update(w,b);const C=new o.EvaluationParameters(w,{now:b,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),P=C.crossFadingFactor();P===1&&P===this._crossFadingFactor||(h=!0,this._crossFadingFactor=P),this.style.update(C)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.load),this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const w=o.exported.now()-_;A.endQueryEXT(A.TIME_ELAPSED_EXT,c),setTimeout(()=>{const b=A.getQueryObjectEXT(c,A.QUERY_RESULT_EXT)/1e6;A.deleteQueryEXT(c),this.fire(new o.Event("gpu-timing-frame",{cpuTime:w,gpuTime:b}))},50)}if(this.listens("gpu-timing-layer")){const w=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(w);this.fire(new o.Event("gpu-timing-layer",{layerTimes:b}))},50)}const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const L=this.painter.context.gl.getExtension("WEBGL_lose_context");L&&L.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),k.remove(this._canvasContainer),k.remove(this._controlContainer),this._cooperativeGestures&&k.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),o.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=o.exported.frame(L=>{o.PerformanceUtils.frame(L),this._frame=null,this._render(L)}))}_onWindowOnline(){this._update()}_onWindowResize(L){this._trackResize&&this.resize({originalEvent:L})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(L){this._showTileBoundaries!==L&&(this._showTileBoundaries=L,this._update())}get showPadding(){return!!this._showPadding}set showPadding(L){this._showPadding!==L&&(this._showPadding=L,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(L){this._showCollisionBoxes!==L&&(this._showCollisionBoxes=L,L?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(L){this._showOverdrawInspector!==L&&(this._showOverdrawInspector=L,this._update())}get repaint(){return!!this._repaint}set repaint(L){this._repaint!==L&&(this._repaint=L,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(L){this._vertices=L,this._update()}_setCacheLimits(L,c){o.setCacheLimits(L,c)}get version(){return"2.4.0"}},NavigationControl:class{constructor(L){this.options=o.extend({},Cc,L),this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const L=this._map.getZoom(),c=L===this._map.getMaxZoom(),_=L===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const L=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=L}onAdd(L){return this._map=L,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new mr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){k.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(L,c){const _=k.create("button",L,this._container);return _.type="button",_.addEventListener("click",c),_}_setButtonTitle(L,c){const _=this._map._getUIString(`NavigationControl.${c}`);L.title=_,L.setAttribute("aria-label",_)}},GeolocateControl:class extends o.Evented{constructor(L){super(),this.options=o.extend({},es,L),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(L){var c;return this._map=L,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Jo!==void 0?c(Jo):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(_=>{Jo=_.state!=="denied",c(Jo)}):(Jo=!!window.navigator.geolocation,c(Jo)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),k.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Hr=0,Zs=!1}_isOutOfMapMaxBounds(L){const c=this._map.getMaxBounds(),_=L.coords;return c&&(_.longitude<c.getWest()||_.longitude>c.getEast()||_.latitude<c.getSouth()||_.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(L){if(this._map){if(this._isOutOfMapMaxBounds(L))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",L)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=L,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(L),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(L),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",L)),this._finish()}}_updateCamera(L){const c=new o.LngLat(L.coords.longitude,L.coords.latitude),_=L.coords.accuracy,A=this._map.getBearing(),h=o.extend({bearing:A},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(_),h,{geolocateSource:!0})}_updateMarker(L){if(L){const c=new o.LngLat(L.coords.longitude,L.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=L.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const L=this._map._container.clientHeight/2,c=this._map.unproject([0,L]),_=this._map.unproject([1,L]),A=c.distanceTo(_),h=Math.ceil(2*this._accuracy/A);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(L){if(this._map){if(this.options.trackUserLocation)if(L.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(L.code===3&&Zs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",L)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(L){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=k.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",L===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new fn(this._dotElement),this._circleElement=k.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new fn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Hr--,Zs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let L;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Hr++,Hr>1?(L={maximumAge:6e5,timeout:0},Zs=!0):(L=this.options.positionOptions,Zs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,L)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:il,LogoControl:Hl,ScaleControl:class{constructor(L){this.options=o.extend({},Ps,L),o.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Ys(this._map,this._container,this.options)}onAdd(L){return this._map=L,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",L.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){k.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(L){this.options.unit=L,Ys(this._map,this._container,this.options)}},FullscreenControl:class{constructor(L){this._fullscreen=!1,L&&L.container&&(L.container instanceof HTMLElement?this._container=L.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(L){return this._map=L,this._container||(this._container=this._map.getContainer()),this._controlContainer=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){k.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const L=this._fullscreenButton=k.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",L).setAttribute("aria-hidden","true"),L.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const L=this._getTitle();this._fullscreenButton.setAttribute("aria-label",L),this._fullscreenButton.title=L}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(L){this.options=L,o.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(L){return this._map=L,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=k.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){k.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends o.Evented{constructor(L){super(),this.options=o.extend(Object.create(Pt),L),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(L){return this._map&&this.remove(),this._map=L,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&k.remove(this._content),this._container&&(k.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(L){return this._lngLat=o.LngLat.convert(L),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(L){return this.setDOMContent(document.createTextNode(L))}setHTML(L){const c=document.createDocumentFragment(),_=document.createElement("body");let A;for(_.innerHTML=L;A=_.firstChild,A;)c.appendChild(A);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(L){return this.options.maxWidth=L,this._update(),this}setDOMContent(L){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=k.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(L),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(L){this._container&&this._container.classList.add(L)}removeClassName(L){this._container&&this._container.classList.remove(L)}setOffset(L){return this.options.offset=L,this._update(),this}toggleClassName(L){if(this._container)return this._container.classList.toggle(L)}_createCloseButton(){this.options.closeButton&&(this._closeButton=k.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(L){this._update(L.point)}_onMouseMove(L){this._update(L.point)}_onDrag(L){this._update(L.point)}_update(L){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=k.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=k.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(d=>this._container.classList.add(d)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Wl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!L))return;const c=this._pos=this._trackPointer&&L?L:this._map.project(this._lngLat);let _=this.options.anchor;const A=sl(this.options.offset);if(!_){const d=this._container.offsetWidth,w=this._container.offsetHeight;let b;b=c.y+A.bottom.y<w?["top"]:c.y>this._map.transform.height-w?["bottom"]:[],c.x<d/2?b.push("left"):c.x>this._map.transform.width-d/2&&b.push("right"),_=b.length===0?"bottom":b.join("-")}const h=c.add(A[_]).round();k.setTransform(this._container,`${Xt[_]} translate(${h.x}px,${h.y}px)`),Kt(this._container,_,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const L=this._container.querySelector(Wr);L&&L.focus()}_onClose(){this.remove()}},Marker:fn,Style:Ce,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,AJAXError:o.AJAXError,config:o.config,CanvasSource:In,GeoJSONSource:un,ImageSource:Tt,RasterDEMTileSource:Et,RasterTileSource:pt,VectorTileSource:Ze,VideoSource:Jt,prewarm:function(){lr().acquire(xt)},clearPrewarmedResources:function(){const L=xr;L&&(L.isPreloaded()&&L.numActive()===1?(L.release(xt),xr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return tr.workerCount},set workerCount(L){tr.workerCount=L},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(L){o.config.MAX_PARALLEL_IMAGE_REQUESTS=L},clearStorage(L){o.clearTileCache(L)},workerUrl:"",addProtocol(L,c){o.config.REGISTERED_PROTOCOLS[L]=c},removeProtocol(L){delete o.config.REGISTERED_PROTOCOLS[L]}};return ps.extend(Xs,{isSafari:o.isSafari,getPerformanceMetrics:o.PerformanceUtils.getPerformanceMetrics}),Xs});var l=i;return l})})(zB);var tY=zB.exports;const vl=B2(tY),nY="modulepreload",rY=function(t){return"/"+t},yP={},iY=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=rY(s),s in yP)return;yP[s]=!0;const l=s.endsWith(".css"),o=l?'[rel="stylesheet"]':"";if(!!r)for(let S=i.length-1;S>=0;S--){const M=i[S];if(M.href===s&&(!l||M.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const v=document.createElement("link");if(v.rel=l?"stylesheet":nY,l||(v.as="script",v.crossOrigin=""),v.href=s,document.head.appendChild(v),l)return new Promise((S,M)=>{v.addEventListener("load",S),v.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=s,window.dispatchEvent(l),!l.defaultPrevented)throw s})},sY=Ue.createContext(null);function oY(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function Fu(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Fu(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!Fu(t[i],e[i]))return!1;return!0}return!1}function aY(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function _P(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();Fu(n,r)||e.setProjection(n)}function vP(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function xP(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const lY=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function wP(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const l of lY)l in s&&(i[l]=s[l])}return i||r});return{...t,layers:n}}const bP={version:8,sources:{},layers:[]},EP={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},pw={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},TP={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},AY=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],uY=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class _d{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[TP[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[EP[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[pw[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=_d.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const l=i._resizeObserver;l&&(l.disconnect(),l.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:o}=e;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):r._updateViewState(o,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=bP}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||cY()||null,container:e,style:wP(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const S=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=S,n.gl)}const l=new this._MapClass(i);s.padding&&l.setPadding(s.padding),n.cursor&&(l.getCanvas().style.cursor=n.cursor),this._createShadowTransform(l);const o=l._render;l._render=S=>{this._inRender=!0,o.call(l,S),this._inRender=!1};const p=l._renderTaskQueue.run;l._renderTaskQueue.run=S=>{p.call(l._renderTaskQueue,S),this._onBeforeRepaint()},l.on("render",()=>this._onAfterRepaint());const v=l.fire;l.fire=this._fireEvent.bind(this,v),l.on("resize",()=>{this._renderTransform.resize(l.transform.width,l.transform.height)}),l.on("styledata",()=>{this._updateStyleComponents(this.props,{}),_P(l.transform,this._renderTransform)}),l.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const S in EP)l.on(S,this._onPointerEvent);for(const S in pw)l.on(S,this._onCameraEvent);for(const S in TP)l.on(S,this._onEvent);this._map=l}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n?.remove(),_d.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=aY(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:l,bearing:o}=i,p=r.isMoving();p&&(i.cameraElevationReference="sea");const v=xP(i,{...vP(r.transform),...e});if(p&&(i.cameraElevationReference="ground"),v&&n){const S=this._deferredEvents;S.move=!0,S.zoom||(S.zoom=s!==i.zoom),S.rotate||(S.rotate=o!==i.bearing),S.pitch||(S.pitch=l!==i.pitch)}return p||xP(r.transform,e),v}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of AY)if(s in e&&!Fu(e[s],n[s])){i=!0;const l=r[`set${s[0].toUpperCase()}${s.slice(1)}`];l?.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=bP,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(wP(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!Fu(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!Fu(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!Fu(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let l=!1;for(const o of uY){const p=(r=e[o])!==null&&r!==void 0?r:!0,v=(i=n[o])!==null&&i!==void 0?i:!0;Fu(p,v)||(l=!0,p?s[o].enable(p):s[o].disable())}return l}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,l=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,o=this._queryRenderedFeatures(e.point),p=o.length>0;!p&&l&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=o,p&&!l&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,l=typeof n=="string"?n:n.type;return l==="move"&&this._updateViewState(this.props,!1),l in pw&&(typeof n=="object"&&(n.viewState=vP(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{_P(this._renderTransform,n),e.transform=n}}}_d.savedMaps=[];function cY(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const hY=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function fY(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const l=e.queryTerrainElevation(r,i);return e.transform=s,l},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const l=e.queryRenderedFeatures(r,i);return e.transform=s,l}};for(const r of dY(e))!(r in n)&&!hY.includes(r)&&(n[r]=e[r].bind(e));return n}function dY(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const pY=typeof document<"u"?Ue.useLayoutEffect:Ue.useEffect,gY=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function mY(t,e){for(const r of gY)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const lv=Ue.createContext(null);function yY(t,e,n){const r=Ue.useContext(sY),[i,s]=Ue.useState(null),l=Ue.useRef(),{current:o}=Ue.useRef({mapLib:null,map:null});Ue.useEffect(()=>{const S=t.mapLib;let M=!0,k;return Promise.resolve(S||n).then(F=>{if(!M)return;if(!F)throw new Error("Invalid mapLib");const H="Map"in F?F:F.default;if(!H.Map)throw new Error("Invalid mapLib");if(mY(H,t),!H.supported||H.supported(t))t.reuseMaps&&(k=_d.reuse(t,l.current)),k||(k=new _d(H.Map,t,l.current)),o.map=fY(k),o.mapLib=H,s(k),r?.onMapMount(o.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(F=>{const{onError:H}=t;H?H({type:"error",target:null,originalEvent:null,error:F}):console.error(F)}),()=>{M=!1,k&&(r?.onMapUnmount(t.id),t.reuseMaps?k.recycle():k.destroy())}},[]),pY(()=>{i&&i.setProps(t)}),Ue.useImperativeHandle(e,()=>o.map,[i]);const p=Ue.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),v={height:"100%"};return Ue.createElement("div",{id:t.id,ref:l,style:p},i&&Ue.createElement(lv.Provider,{value:o},Ue.createElement("div",{"mapboxgl-children":"",style:v},t.children)))}const _Y=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Bf(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!_Y.test(r)?n[r]=`${i}px`:n[r]=i}}function vY(t,e){const{map:n,mapLib:r}=Ue.useContext(lv),i=Ue.useRef({props:t});i.current.props=t;const s=Ue.useMemo(()=>{let j=!1;Ue.Children.forEach(t.children,J=>{J&&(j=!0)});const ie={...t,element:j?document.createElement("div"):null},Y=new r.Marker(ie);return Y.setLngLat([t.longitude,t.latitude]),Y.getElement().addEventListener("click",J=>{var se,ce;(ce=(se=i.current.props).onClick)===null||ce===void 0||ce.call(se,{type:"click",target:Y,originalEvent:J})}),Y.on("dragstart",J=>{var se,ce;const me=J;me.lngLat=s.getLngLat(),(ce=(se=i.current.props).onDragStart)===null||ce===void 0||ce.call(se,me)}),Y.on("drag",J=>{var se,ce;const me=J;me.lngLat=s.getLngLat(),(ce=(se=i.current.props).onDrag)===null||ce===void 0||ce.call(se,me)}),Y.on("dragend",J=>{var se,ce;const me=J;me.lngLat=s.getLngLat(),(ce=(se=i.current.props).onDragEnd)===null||ce===void 0||ce.call(se,me)}),Y},[]);Ue.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:l,latitude:o,offset:p,style:v,draggable:S=!1,popup:M=null,rotation:k=0,rotationAlignment:F="auto",pitchAlignment:H="auto"}=t;return Ue.useEffect(()=>{Bf(s.getElement(),v)},[v]),Ue.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==l||s.getLngLat().lat!==o)&&s.setLngLat([l,o]),p&&!oY(s.getOffset(),p)&&s.setOffset(p),s.isDraggable()!==S&&s.setDraggable(S),s.getRotation()!==k&&s.setRotation(k),s.getRotationAlignment()!==F&&s.setRotationAlignment(F),s.getPitchAlignment()!==H&&s.setPitchAlignment(H),s.getPopup()!==M&&s.setPopup(M),VT.createPortal(t.children,s.getElement())}Ue.memo(Ue.forwardRef(vY));function SP(t){return new Set(t?t.trim().split(/\s+/):[])}function xY(t,e){const{map:n,mapLib:r}=Ue.useContext(lv),i=Ue.useMemo(()=>document.createElement("div"),[]),s=Ue.useRef({props:t});s.current.props=t;const l=Ue.useMemo(()=>{const o={...t},p=new r.Popup(o);return p.setLngLat([t.longitude,t.latitude]),p.once("open",v=>{var S,M;(M=(S=s.current.props).onOpen)===null||M===void 0||M.call(S,v)}),p},[]);if(Ue.useEffect(()=>{const o=p=>{var v,S;(S=(v=s.current.props).onClose)===null||S===void 0||S.call(v,p)};return l.on("close",o),l.setDOMContent(i).addTo(n.getMap()),()=>{l.off("close",o),l.isOpen()&&l.remove()}},[]),Ue.useEffect(()=>{Bf(l.getElement(),t.style)},[t.style]),Ue.useImperativeHandle(e,()=>l,[]),l.isOpen()&&((l.getLngLat().lng!==t.longitude||l.getLngLat().lat!==t.latitude)&&l.setLngLat([t.longitude,t.latitude]),t.offset&&!Fu(l.options.offset,t.offset)&&l.setOffset(t.offset),(l.options.anchor!==t.anchor||l.options.maxWidth!==t.maxWidth)&&(l.options.anchor=t.anchor,l.setMaxWidth(t.maxWidth)),l.options.className!==t.className)){const o=SP(l.options.className),p=SP(t.className);for(const v of o)p.has(v)||l.removeClassName(v);for(const v of p)o.has(v)||l.addClassName(v);l.options.className=t.className}return VT.createPortal(t.children,i)}Ue.memo(Ue.forwardRef(xY));function Rd(t,e,n,r){const i=Ue.useContext(lv),s=Ue.useMemo(()=>t(i),[]);return Ue.useEffect(()=>{const l=r||n||e,o=typeof e=="function"&&typeof n=="function"?e:null,p=typeof n=="function"?n:typeof e=="function"?e:null,{map:v}=i;return v.hasControl(s)||(v.addControl(s,l?.position),o&&o(i)),()=>{p&&p(i),v.hasControl(s)&&v.removeControl(s)}},[]),s}function wY(t){const e=Rd(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return Ue.useEffect(()=>{Bf(e._container,t.style)},[t.style]),null}Ue.memo(wY);function bY(t){const e=Rd(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return Ue.useEffect(()=>{Bf(e._controlContainer,t.style)},[t.style]),null}Ue.memo(bY);function EY(t,e){const n=Ue.useRef({props:t}),r=Rd(({mapLib:i})=>{const s=new i.GeolocateControl(t),l=s._setupUI;return s._setupUI=o=>{s._container.hasChildNodes()||l(o)},s.on("geolocate",o=>{var p,v;(v=(p=n.current.props).onGeolocate)===null||v===void 0||v.call(p,o)}),s.on("error",o=>{var p,v;(v=(p=n.current.props).onError)===null||v===void 0||v.call(p,o)}),s.on("outofmaxbounds",o=>{var p,v;(v=(p=n.current.props).onOutOfMaxBounds)===null||v===void 0||v.call(p,o)}),s.on("trackuserlocationstart",o=>{var p,v;(v=(p=n.current.props).onTrackUserLocationStart)===null||v===void 0||v.call(p,o)}),s.on("trackuserlocationend",o=>{var p,v;(v=(p=n.current.props).onTrackUserLocationEnd)===null||v===void 0||v.call(p,o)}),s},{position:t.position});return n.current.props=t,Ue.useImperativeHandle(e,()=>r,[]),Ue.useEffect(()=>{Bf(r._container,t.style)},[t.style]),null}Ue.memo(Ue.forwardRef(EY));function TY(t){const e=Rd(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return Ue.useEffect(()=>{Bf(e._container,t.style)},[t.style]),null}Ue.memo(TY);function SY(t){const e=Rd(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=Ue.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),Ue.useEffect(()=>{Bf(e._container,i)},[i]),null}Ue.memo(SY);const CY=iY(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),xl=(()=>Ue.forwardRef(function(e,n){return yY(e,n,CY)}))();function W_(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const AS=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),CP=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);CP&&parseFloat(CP[1]);const MY="3.4.14";function sc(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Ry=typeof process!="object"||String(process)!=="[object process]"||process.browser,PY=typeof window<"u"&&typeof window.orientation<"u",MP=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);MP&&parseFloat(MP[1]);function Qg(t){"@babel/helpers - typeof";return Qg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qg(t)}function kY(t,e){if(Qg(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Qg(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IY(t){var e=kY(t,"string");return Qg(e)==="symbol"?e:String(e)}function oe(t,e,n){return e=IY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class LY{constructor(e,n){oe(this,"name",void 0),oe(this,"workerThread",void 0),oe(this,"isRunning",!0),oe(this,"result",void 0),oe(this,"_resolve",()=>{}),oe(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){sc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){sc(this.isRunning),this.isRunning=!1,this._reject(e)}}let gw=class{terminate(){}};const mw=new Map;function DY(t){sc(t.source&&!t.url||!t.source&&t.url);let e=mw.get(t.source||t.url);return e||(t.url&&(e=RY(t.url),mw.set(t.url,e)),t.source&&(e=FB(t.source),mw.set(t.source,e))),sc(e),e}function RY(t){if(!t.startsWith("http"))return t;const e=BY(t);return FB(e)}function FB(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function BY(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function NB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(PP(t))r.add(t);else if(PP(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)NB(t[i],e,r)}}return n===void 0?Array.from(r):[]}function PP(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const yw=()=>{};class L3{static isSupported(){return typeof Worker<"u"&&Ry||typeof gw<"u"&&!Ry}constructor(e){oe(this,"name",void 0),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"terminated",!1),oe(this,"worker",void 0),oe(this,"onMessage",void 0),oe(this,"onError",void 0),oe(this,"_loadableURL","");const{name:n,source:r,url:i}=e;sc(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=yw,this.onError=s=>console.log(s),this.worker=Ry?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=yw,this.onError=yw,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||NB(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=DY({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new gw(r,{eval:!1})}else if(this.source)e=new gw(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class zY{static isSupported(){return L3.isSupported()}constructor(e){oe(this,"name","unnamed"),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"maxConcurrency",1),oe(this,"maxMobileConcurrency",1),oe(this,"onDebug",()=>{}),oe(this,"reuseWorkers",!0),oe(this,"props",{}),oe(this,"jobQueue",[]),oe(this,"idleQueue",[]),oe(this,"count",0),oe(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,l,o)=>s.done(o),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,l)=>s.error(l);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new LY(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new L3({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return PY?this.maxMobileConcurrency:this.maxConcurrency}}const OY={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Nu{static isSupported(){return L3.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Nu._workerFarm=Nu._workerFarm||new Nu({}),Nu._workerFarm.setProps(e),Nu._workerFarm}constructor(e){oe(this,"props",void 0),oe(this,"workerPools",new Map),this.props={...OY},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new zY({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}oe(Nu,"_workerFarm",void 0);const FY="latest";function NY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=FY);const l=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(l,"/dist/").concat(r)}return sc(i),i}function UY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:MY;sc(t,"no worker provided");const n=t.version;return!(!e||!n)}function VY(t,e){return!Nu.isSupported()||!Ry&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&e?.worker}async function GY(t,e,n,r,i){const s=t.id,l=NY(t,n),p=Nu.getWorkerFarm(n).getWorkerPool({name:s,url:l});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const v=await p.startJob("process-on-worker",$Y.bind(null,i));return v.postMessage("process",{input:e,options:n,context:r}),await(await v.result).result}async function $Y(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:l}=r;try{const o=await t(s,l);e.postMessage("done",{id:i,result:o})}catch(o){const p=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:p})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function jY(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function HY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=r.reduce((o,p)=>o+p.byteLength,0),s=new Uint8Array(i);let l=0;for(const o of r)s.set(o,l),l+=o.byteLength;return s.buffer}async function WY(t){const e=[];for await(const n of t)e.push(n);return HY(...e)}function kP(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let IP=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=kP(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(kP()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},QY=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof IP?i=e:i=new IP(n,r),this.stats[n]=i),i}};const qY="Queued Requests",ZY="Active Requests",YY="Cancelled Requests",XY="Queued Requests Ever",KY="Active Requests Ever",JY={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class eX{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};oe(this,"props",void 0),oe(this,"stats",void 0),oe(this,"activeRequestCount",0),oe(this,"requestQueue",[]),oe(this,"requestMap",new Map),oe(this,"deferredUpdate",null),this.props={...JY,...e},this.stats=new QY({id:this.props.id}),this.stats.get(qY),this.stats.get(ZY),this.stats.get(YY),this.stats.get(XY),this.stats.get(KY)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(s=>(r.resolve=s,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let tX="";const LP={};function nX(t){for(const e in LP)if(t.startsWith(e)){const n=LP[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(tX).concat(t)),t}function rX(t){return t&&typeof t=="object"&&t.isBuffer}function UB(t){if(rX(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function VB(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function iX(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const sX=t=>typeof t=="boolean",hg=t=>typeof t=="function",Mm=t=>t!==null&&typeof t=="object",DP=t=>Mm(t)&&t.constructor==={}.constructor,oX=t=>t&&typeof t[Symbol.iterator]=="function",aX=t=>t&&typeof t[Symbol.asyncIterator]=="function",zf=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Of=t=>typeof Blob<"u"&&t instanceof Blob,lX=t=>t&&typeof t=="object"&&t.isBuffer,AX=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Mm(t)&&hg(t.tee)&&hg(t.cancel)&&hg(t.getReader),uX=t=>Mm(t)&&hg(t.read)&&hg(t.pipe)&&sX(t.readable),GB=t=>AX(t)||uX(t),cX=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,hX=/^([-\w.]+\/[-\w.+]+)/;function fX(t){const e=hX.exec(t);return e?e[1]:t}function RP(t){const e=cX.exec(t);return e?e[1]:""}const $B=/\?.*/;function dX(t){const e=t.match($B);return e&&e[0]}function uS(t){return t.replace($B,"")}function Av(t){return zf(t)?t.url:Of(t)?t.name||"":typeof t=="string"?t:""}function cS(t){if(zf(t)){const e=t,n=e.headers.get("content-type")||"",r=uS(e.url);return fX(n)||RP(r)}return Of(t)?t.type||"":typeof t=="string"?RP(t):""}function pX(t){return zf(t)?t.headers["content-length"]||-1:Of(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function jB(t){if(zf(t))return t;const e={},n=pX(t);n>=0&&(e["content-length"]=String(n));const r=Av(t),i=cS(t);i&&(e["content-type"]=i);const s=await yX(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const l=new Response(t,{headers:e});return Object.defineProperty(l,"url",{value:r}),l}async function gX(t){if(!t.ok){const e=await mX(t);throw new Error(e)}}async function mX(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function yX(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var l;return r(s==null||(l=s.target)===null||l===void 0?void 0:l.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=_X(n);return"data:base64,".concat(r)}return null}function _X(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function BP(t,e){if(typeof t=="string"){t=nX(t);let n=e;return e!=null&&e.fetch&&typeof e?.fetch!="function"&&(n=e.fetch),await fetch(t,n)}return await jB(t)}function vX(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Pm(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||vX()}const B1=globalThis.window||globalThis.self||globalThis.global,bp=globalThis.process||{},HB=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Pm();function xX(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let wX=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=xX(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function bX(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function EX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function _w(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let Q_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Q_||(Q_={}));const TX=10;function zP(t){return typeof t!="string"?t:(t=t.toUpperCase(),Q_[t]||Q_.WHITE)}function SX(t,e,n){if(!Pm&&typeof t=="string"){if(e){const r=zP(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=zP(n);t="\x1B[".concat(r+TX,"m").concat(t,"\x1B[49m")}}return t}function CX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const l=i[s];typeof l=="function"&&(e.find(o=>s===o)||(i[s]=l.bind(t)))}}function q_(t,e){if(!t)throw new Error(e||"Assertion failed")}function n0(){let t;if(Pm()&&B1.performance){var e,n;t=B1==null||(e=B1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in bp){var r;const i=bp==null||(r=bp.hrtime)===null||r===void 0?void 0:r.call(bp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const r0={debug:Pm()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},MX={enabled:!0,level:0};function ul(){}const OP={},FP={once:!0};let hS=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=HB,this._startTs=n0(),this._deltaTs=n0(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new wX("__probe-".concat(this.id,"__"),MX),this.timeStamp("".concat(this.id," started")),CX(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((n0()-this._startTs).toPrecision(10))}getDelta(){return Number((n0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){q_(e,n)}warn(e){return this._getLogFunction(0,e,r0.warn,arguments,FP)}error(e){return this._getLogFunction(0,e,r0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,r0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,r0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,r0.debug||r0.info,arguments,FP)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||ul,r&&[r],{tag:LX(n)}):ul}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?Pm()?IX({image:i,message:s,scale:l}):kX():ul}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||ul)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=NP({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||ul)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=WB(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=NP({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,q_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=n0();const l=s.tag||s.message;if(s.once&&l)if(!OP[l])OP[l]=n0();else return ul;return n=PX(this.id,s.message,s),r.bind(console,n,...s.args)}return ul}};hS.VERSION=HB;function WB(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return q_(Number.isFinite(e)&&e>=0),e}function NP(t){const{logLevel:e,message:n}=t;t.logLevel=WB(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return q_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function PX(t,e,n){if(typeof e=="string"){const r=n.time?EX(bX(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=SX(e,n.color,n.background)}return e}function kX(t){return console.warn("removed"),ul}function IX(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=_w(s,n,r);console.log(...l)},s.src=e,ul}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(..._w(e,n,r)),ul;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(..._w(s,n,r)),s.src=e.toDataURL(),ul}return ul}function LX(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const UP=new hS({id:"loaders.gl"});class DX{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class RX{constructor(){oe(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const QB={fetch:null,mimeType:void 0,nothrow:!1,log:new RX,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:AS,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},BX={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function qB(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const ZB=()=>{const t=qB();return t.globalOptions=t.globalOptions||{...QB},t.globalOptions};function zX(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],OX(t,n),NX(e,t,r)}function OX(t,e){VP(t,null,QB,BX,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};VP(r,n.id,i,s,e)}}function VP(t,e,n,r,i){const s=e||"Top level",l=e?"".concat(e,"."):"";for(const o in t){const p=!e&&Mm(t[o]),v=o==="baseUri"&&!e,S=o==="workerUrl"&&e;if(!(o in n)&&!v&&!S){if(o in r)UP.warn("".concat(s," loader option '").concat(l).concat(o,"' no longer supported, use '").concat(r[o],"'"))();else if(!p){const M=FX(o,i);UP.warn("".concat(s," loader option '").concat(l).concat(o,"' not recognized. ").concat(M))()}}}}function FX(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const l=s.toLowerCase();(n.startsWith(l)||l.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function NX(t,e,n){const i={...t.options||{}};return UX(i,n),i.log===null&&(i.log=new DX),GP(i,ZB()),GP(i,e),i}function GP(t,e){for(const n in e)if(n in e){const r=e[n];DP(r)&&DP(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function UX(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function fS(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function dS(t){var e,n;W_(t,"null loader"),W_(fS(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const YB=()=>{const t=qB();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function VX(t){const e=YB();t=Array.isArray(t)?t:[t];for(const n of t){const r=dS(n);e.find(i=>r===i)||e.unshift(r)}}function GX(){return YB()}const $X=new hS({id:"loaders.gl"}),jX=/\.([^.]+)$/;async function HX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!XB(t))return null;let i=$P(t,e,{...n,nothrow:!0},r);if(i)return i;if(Of(t)&&(t=await t.slice(0,10).arrayBuffer(),i=$P(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(KB(t));return i}function $P(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!XB(t))return null;if(e&&!Array.isArray(e))return dS(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...GX()),QX(i);const s=WX(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(KB(t));return s}function WX(t,e,n,r){const i=Av(t),s=cS(t),l=uS(i)||r?.url;let o=null,p="";if(n!=null&&n.mimeType&&(o=vw(e,n?.mimeType),p="match forced by supplied MIME type ".concat(n?.mimeType)),o=o||qX(e,l),p=p||(o?"matched url ".concat(l):""),o=o||vw(e,s),p=p||(o?"matched MIME type ".concat(s):""),o=o||YX(e,t),p=p||(o?"matched initial data ".concat(JB(t)):""),o=o||vw(e,n?.fallbackMimeType),p=p||(o?"matched fallback MIME type ".concat(s):""),p){var v;$X.log(1,"selectLoader selected ".concat((v=o)===null||v===void 0?void 0:v.name,": ").concat(p,"."))}return o}function XB(t){return!(t instanceof Response&&t.status===204)}function KB(t){const e=Av(t),n=cS(t);let r="No valid loader found (";r+=e?"".concat(VB(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?JB(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function QX(t){for(const e of t)dS(e)}function qX(t,e){const n=e&&jX.exec(e),r=n&&n[1];return r?ZX(t,r):null}function ZX(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function vw(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function YX(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(XX(e,n))return n}else if(ArrayBuffer.isView(e)){if(jP(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&jP(e,0,n))return n;return null}function XX(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function jP(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>KX(t,e,n,i))}function KX(t,e,n,r){if(r instanceof ArrayBuffer)return jY(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=D3(t,e,r.length);return r===i;default:return!1}}function JB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?D3(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?D3(t,0,e):""}function D3(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const JX=256*1024;function*eK(t,e){const n=e?.chunkSize||JX;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),l=t.slice(r,r+s);r+=s,yield i.encode(l)}}const tK=256*1024;function nK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=tK}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),l=new Uint8Array(t,r,i);new Uint8Array(s).set(l),r+=i,yield s}}()}const rK=1024*1024;async function*iK(t,e){const n=e?.chunkSize||rK;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function HP(t,e){return AS?sK(t,e):oK(t)}async function*sK(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:l}=await i;if(s)return;yield UB(l)}}catch{n.releaseLock()}}async function*oK(t,e){for await(const n of t)yield UB(n)}function aK(t,e){if(typeof t=="string")return eK(t,e);if(t instanceof ArrayBuffer)return nK(t,e);if(Of(t))return iK(t,e);if(GB(t))return HP(t,e);if(zf(t))return HP(t.body,e);throw new Error("makeIterator")}const ez="Cannot convert supplied data type";function lK(t,e,n){if(e.text&&typeof t=="string")return t;if(lX(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(ez)}async function AK(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return lK(t,e);if(Of(t)&&(t=await jB(t)),zf(t)){const i=t;return await gX(i),e.binary?await i.arrayBuffer():await i.text()}if(GB(t)&&(t=aK(t,n)),oX(t)||aX(t))return WY(t);throw new Error(ez)}function tz(t,e){const n=ZB(),r=t||n;return typeof r.fetch=="function"?r.fetch:Mm(r.fetch)?i=>BP(i,r):e!=null&&e.fetch?e?.fetch:BP}function uK(t,e,n){if(n)return n;const r={fetch:tz(e,t),...t};if(r.url){const i=uS(r.url);r.baseUrl=i,r.queryString=dX(r.url),r.filename=VB(i),r.baseUrl=iX(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function cK(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function pS(t,e,n,r){sc(!r||typeof r=="object"),e&&!Array.isArray(e)&&!fS(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=Av(t),l=cK(e,r),o=await HX(t,l,n);return o?(n=zX(n,o,l,i),r=uK({url:i,parse:pS,loaders:l},n,r||null),await hK(o,t,n,r)):null}async function hK(t,e,n,r){if(UY(t),zf(e)){const i=e,{ok:s,redirected:l,status:o,statusText:p,type:v,url:S}=i,M=Object.fromEntries(i.headers.entries());r.response={headers:M,ok:s,redirected:l,status:o,statusText:p,type:v,url:S}}if(e=await AK(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(VY(t,n))return await GY(t,e,n,r,pS);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw sc(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Z_(t,e,n,r){!Array.isArray(e)&&!fS(e)&&(n=e,e=void 0);const i=tz(n);let s=t;return typeof t=="string"&&(s=await i(t)),Of(t)&&(s=await i(t)),await pS(s,e,n)}const fK="3.4.14",{_parseImageNode:dK}=globalThis,R3=typeof Image<"u",B3=typeof ImageBitmap<"u",pK=!!dK,z3=AS?!0:pK;function gK(t){switch(t){case"auto":return B3||R3||z3;case"imagebitmap":return B3;case"image":return R3;case"data":return z3;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function mK(){if(B3)return"imagebitmap";if(R3)return"image";if(z3)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function yK(t){const e=vK(t);if(!e)throw new Error("Not an image");return e}function _K(t){switch(yK(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function vK(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const xK=/^data:image\/svg\+xml/,wK=/\.svg((\?|#).*)?$/;function gS(t){return t&&(xK.test(t)||wK.test(t))}function bK(t,e){if(gS(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return nz(t,e)}function nz(t,e){if(gS(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function rz(t,e,n){const r=bK(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await EK(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function EK(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const TK={};let WP=!0;async function SK(t,e,n){let r;gS(n)?r=await rz(t,e,n):r=nz(t,n);const i=e&&e.imagebitmap;return await CK(r,i)}async function CK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((MK(e)||!WP)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),WP=!1}return await createImageBitmap(t)}function MK(t){for(const e in t||TK)return!1;return!0}function PK(t){return!DK(t,"ftyp",4)||!(t[8]&96)?null:kK(t)}function kK(t){switch(IK(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function IK(t,e,n){return String.fromCharCode(...t.slice(e,n))}function LK(t){return[...t].map(e=>e.charCodeAt(0))}function DK(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=LK(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const jA=!1,fg=!0;function iz(t){const e=km(t);return BK(e)||FK(e)||zK(e)||OK(e)||RK(e)}function RK(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=PK(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function BK(t){const e=km(t);return e.byteLength>=24&&e.getUint32(0,jA)===2303741511?{mimeType:"image/png",width:e.getUint32(16,jA),height:e.getUint32(20,jA)}:null}function zK(t){const e=km(t);return e.byteLength>=10&&e.getUint32(0,jA)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,fg),height:e.getUint16(8,fg)}:null}function OK(t){const e=km(t);return e.byteLength>=14&&e.getUint16(0,jA)===16973&&e.getUint32(2,fg)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,fg),height:e.getUint32(22,fg)}:null}function FK(t){const e=km(t);if(!(e.byteLength>=3&&e.getUint16(0,jA)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=NK();let s=2;for(;s+9<e.byteLength;){const l=e.getUint16(s,jA);if(i.has(l))return{mimeType:"image/jpeg",height:e.getUint16(s+5,jA),width:e.getUint16(s+7,jA)};if(!r.has(l))return null;s+=2,s+=e.getUint16(s,jA)}return null}function NK(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function km(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function UK(t,e){const{mimeType:n}=iz(t)||{},r=globalThis._parseImageNode;return W_(r),await r(t,n)}async function VK(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},l=GK(i);let o;switch(l){case"imagebitmap":o=await SK(t,e,s);break;case"image":o=await rz(t,e,s);break;case"data":o=await UK(t);break;default:W_(!1)}return i==="data"&&(o=_K(o)),o}function GK(t){switch(t){case"auto":case"data":return mK();default:return gK(t),t}}const $K=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],jK=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],HK={image:{type:"auto",decode:!0}},WK={id:"image",module:"images",name:"Images",version:fK,mimeTypes:jK,extensions:$K,parse:VK,tests:[t=>!!iz(new DataView(t))],options:HK};function sz(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Bd(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||sz()}const By={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},z1=By.window||By.self||By.global,Ep=By.process||{},oz=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Bd();const xw=globalThis;function QK(t){if(!t&&!Bd())return"Node";if(sz(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":xw.chrome?"Chrome":xw.safari?"Safari":xw.mozInnerScreenX?"Firefox":"Unknown"}function qK(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let ZK=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=qK(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function YK(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function XK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function ww(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let Y_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Y_||(Y_={}));function QP(t){return typeof t=="string"?Y_[t.toUpperCase()]||Y_.WHITE:t}function KK(t,e,n){return!Bd&&typeof t=="string"&&(e&&(e=QP(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=QP(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function JK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function X_(t,e){if(!t)throw new Error(e||"Assertion failed")}function i0(){let t;if(Bd&&"performance"in z1){var e,n;t=z1==null||(e=z1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Ep){var r;const i=Ep==null||(r=Ep.hrtime)===null||r===void 0?void 0:r.call(Ep);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const s0={debug:Bd&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},eJ={enabled:!0,level:0};function cl(){}const qP={},ZP={once:!0};let az=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",oz),oe(this,"_startTs",i0()),oe(this,"_deltaTs",i0()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new ZK("__probe-".concat(this.id,"__"),eJ),this.timeStamp("".concat(this.id," started")),JK(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((i0()-this._startTs).toPrecision(10))}getDelta(){return Number((i0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){X_(e,n)}warn(e){return this._getLogFunction(0,e,s0.warn,arguments,ZP)}error(e){return this._getLogFunction(0,e,s0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,s0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,s0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,s0.debug||s0.info,arguments,ZP)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||cl,r&&[r],{tag:iJ(n)}):cl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?Bd?rJ({image:i,message:s,scale:l}):nJ():cl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||cl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=YP({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||cl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=lz(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=YP({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,X_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=i0();const l=s.tag||s.message;if(s.once)if(!qP[l])qP[l]=i0();else return cl;return n=tJ(this.id,s.message,s),r.bind(console,n,...s.args)}return cl}};oe(az,"VERSION",oz);function lz(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return X_(Number.isFinite(e)&&e>=0),e}function YP(t){const{logLevel:e,message:n}=t;t.logLevel=lz(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return X_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function tJ(t,e,n){if(typeof e=="string"){const r=n.time?XK(YK(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=KK(e,n.color,n.background)}return e}function nJ(t){return console.warn("removed"),cl}function rJ(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=ww(s,n,r);console.log(...l)},s.src=e,cl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...ww(e,n,r)),cl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...ww(s,n,r)),s.src=e.toDataURL(),cl}return cl}function iJ(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const sr=new az({id:"deck"});let O3={};function sJ(t){O3=t}function uo(t,e,n,r){sr.level>0&&O3[t]&&O3[t].call(null,e,n,r)}function oJ(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const aJ={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:oJ,parseTextSync:JSON.parse};function lJ(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(sr.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:sr,_registerLoggers:sJ},VX([aJ,[WK,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const AJ=lJ(),Ar={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Ar,"IDENTITY",{get:()=>(sr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const rA={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},ff={common:0,meters:1,pixels:2},XP={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function uJ(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function zd(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||uJ()}const zy={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},O1=zy.window||zy.self||zy.global,Tp=zy.process||{},Az=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";zd();function cJ(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class hJ{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=cJ(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function fJ(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function dJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function bw(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let K_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(K_||(K_={}));function KP(t){return typeof t=="string"?K_[t.toUpperCase()]||K_.WHITE:t}function pJ(t,e,n){return!zd&&typeof t=="string"&&(e&&(e=KP(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=KP(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function gJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function J_(t,e){if(!t)throw new Error(e||"Assertion failed")}function o0(){let t;if(zd&&"performance"in O1){var e,n;t=O1==null||(e=O1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Tp){var r;const i=Tp==null||(r=Tp.hrtime)===null||r===void 0?void 0:r.call(Tp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const a0={debug:zd&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},mJ={enabled:!0,level:0};function hl(){}const JP={},ek={once:!0};class uz{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",Az),oe(this,"_startTs",o0()),oe(this,"_deltaTs",o0()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new hJ("__probe-".concat(this.id,"__"),mJ),this.timeStamp("".concat(this.id," started")),gJ(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((o0()-this._startTs).toPrecision(10))}getDelta(){return Number((o0()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){J_(e,n)}warn(e){return this._getLogFunction(0,e,a0.warn,arguments,ek)}error(e){return this._getLogFunction(0,e,a0.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,a0.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,a0.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,a0.debug||a0.info,arguments,ek)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||hl,r&&[r],{tag:xJ(n)}):hl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?zd?vJ({image:i,message:s,scale:l}):_J():hl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||hl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=tk({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||hl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=cz(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=tk({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,J_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=o0();const l=s.tag||s.message;if(s.once)if(!JP[l])JP[l]=o0();else return hl;return n=yJ(this.id,s.message,s),r.bind(console,n,...s.args)}return hl}}oe(uz,"VERSION",Az);function cz(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return J_(Number.isFinite(e)&&e>=0),e}function tk(t){const{logLevel:e,message:n}=t;t.logLevel=cz(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return J_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function yJ(t,e,n){if(typeof e=="string"){const r=n.time?dJ(fJ(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=pJ(e,n.color,n.background)}return e}function _J(t){return console.warn("removed"),hl}function vJ(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=bw(s,n,r);console.log(...l)},s.src=e,hl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...bw(e,n,r)),hl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...bw(s,n,r)),s.src=e.toDataURL(),hl}return hl}function xJ(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const vn=new uz({id:"luma.gl"});function Bo(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const wJ="Invalid WebGLRenderingContext",bJ="Requires WebGL2";function uv(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function cr(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function EJ(t){return cr(t)?t:null}function cv(t){return Bo(uv(t),wJ),t}function fo(t){return Bo(cr(t),bJ),t}const Yp={};function TJ(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function SJ(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function CJ(t,e){Yp[t]=!0,e!==void 0&&TJ(e)}function MJ(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Yp[r]=!0);while(r!==0);for(r in Yp)if(Yp[r])return delete Yp[r],parseInt(r,10);return 0}}const Im=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Im.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Im.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Ff=function(e){const n=this;this.gl=e,MJ(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,l){switch(s){case 34962:n.currentArrayBuffer=l;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=l;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,l){const p=n.currentVertexArrayObject.attribs[s];switch(l){case 34975:return p.buffer;case 34338:return p.enabled;case 34339:return p.size;case 34340:return p.stride;case 34341:return p.type;case 34922:return p.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,l,o,p,v,S){const M=n.currentVertexArrayObject;M.maxAttrib=Math.max(M.maxAttrib,s);const k=M.attribs[s];return k.buffer=n.currentArrayBuffer,k.size=l,k.type=o,k.normalized=p,k.stride=v,k.offset=S,k.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{SJ("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Ff.prototype.VERTEX_ARRAY_BINDING_OES=34229;Ff.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Im(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Ff.prototype.createVertexArrayOES=function(){const e=new Im(this);return this.vertexArrayObjects.push(e),e};Ff.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Ff.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Im&&e.hasBeenBound&&e.ext===this)};Ff.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){CJ(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let l=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let p=0;p<=o;p++){const v=s.attribs[p],S=i?i.attribs[p]:null;if((!i||v.enabled!==S.enabled)&&(v.enabled?r.enableVertexAttribArray.call(n,p):r.disableVertexAttribArray.call(n,p)),v.enabled){let M=!1;(!i||v.buffer!==S.buffer)&&(l!==v.buffer&&(r.bindBuffer.call(n,34962,v.buffer),l=v.buffer),M=!0),(M||v.cached!==S.cached)&&r.vertexAttribPointer.call(n,p,v.size,v.type,v.normalized,v.stride,v.offset)}}this.currentArrayBuffer!==l&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function PJ(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Ff(this)),this.__OESVertexArrayObject))}}const nk="OES_element_index",rk="WEBGL_draw_buffers",kJ="EXT_disjoint_timer_query",IJ="EXT_disjoint_timer_query_webgl2",LJ="EXT_texture_filter_anisotropic",ik="WEBGL_debug_renderer_info",DJ=35723,RJ=4352,BJ=36795,zJ=34047,OJ=37445,FJ=37446,ei=t=>cr(t)?void 0:0,NJ={3074:t=>cr(t)?void 0:36064,[DJ]:t=>cr(t)?void 0:RJ,35977:ei,32937:ei,[BJ]:(t,e)=>{const n=cr(t)?t.getExtension(IJ):t.getExtension(kJ);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[OJ]:(t,e)=>{const n=t.getExtension(ik);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[FJ]:(t,e)=>{const n=t.getExtension(ik);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[zJ]:(t,e)=>{const n=t.luma.extensions[LJ];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:ei,35071:ei,37447:ei,36063:(t,e)=>{if(!cr(t)){const n=t.getExtension(rk);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:ei,35374:ei,35377:ei,34852:t=>{if(!cr(t)){const e=t.getExtension(rk);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(nk)?2147483647:65535,33001:t=>t.getExtension(nk)?16777216:65535,33e3:t=>16777216,37157:ei,35373:ei,35657:ei,36183:ei,37137:ei,34045:ei,35978:ei,35979:ei,35968:ei,35376:ei,35375:ei,35659:ei,37154:ei,35371:ei,35658:ei,35076:ei,35077:ei,35380:ei};function UJ(t,e,n){const r=NJ[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const VJ="OES_vertex_array_object",hz="ANGLE_instanced_arrays",GJ="WEBGL_draw_buffers",$J="EXT_disjoint_timer_query",jJ="EXT_texture_filter_anisotropic",HJ="VertexArray requires WebGL2 or OES_vertex_array_object extension";function WJ(t,e){return{webgl2:cr(t),ext:t.getExtension(e)}}const fz={[VJ]:{meta:{suffix:"OES"},createVertexArray:()=>{Bo(!1,HJ)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[hz]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Bo(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[GJ]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Bo(!1)}},[$J]:{meta:{suffix:"EXT"},createQuery:()=>{Bo(!1)},deleteQuery:()=>{Bo(!1)},beginQuery:()=>{Bo(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},Ew={readBuffer:(t,e,n)=>{cr(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=WJ(t,hz);let l;switch(r){case 35069:l=i?void 0:!1;break;case 35070:l=!i&&!s?0:void 0;break}return l!==void 0?l:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!cr(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!cr(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[jJ];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:UJ,hint(t,e,n,r){return e(n,r)}};function QJ(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(PJ(t),qJ(t),YJ(t,fz),ZJ(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=QJ;function qJ(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function ZJ(t,e){let{target:n,target2:r}=e;Object.keys(Ew).forEach(i=>{if(typeof Ew[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},l=Ew[i].bind(null,t,s);n[i]=l,r[i]=l}})}function YJ(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&XJ(t,{extension:n,target:t.luma,target2:t})}function XJ(t,e){let{extension:n,target:r,target2:i}=e;const s=fz[n];Bo(s);const{meta:l={}}=s,{suffix:o=""}=l,p=t.getExtension(n);for(const v of Object.keys(s)){const S="".concat(v).concat(o);let M=null;v==="meta"||typeof t[v]=="function"||(p&&typeof p[S]=="function"?M=function(){return p[S](...arguments)}:typeof s[v]=="function"&&(M=s[v].bind(r))),M&&(r[v]=M,i[v]=M)}}const mS={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Bc=(t,e,n)=>e?t.enable(n):t.disable(n),sk=(t,e,n)=>t.hint(n,e),Ia=(t,e,n)=>t.pixelStorei(n,e),KJ=(t,e)=>{const n=cr(t)?36009:36160;return t.bindFramebuffer(n,e)},JJ=(t,e)=>t.bindFramebuffer(36008,e);function Sp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const eee={3042:Bc,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Bc,2885:(t,e)=>t.cullFace(e),2929:Bc,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Bc,35723:sk,36006:KJ,2886:(t,e)=>t.frontFace(e),33170:sk,2849:(t,e)=>t.lineWidth(e),32823:Bc,32824:"polygonOffset",10752:"polygonOffset",35977:Bc,32938:"sampleCoverage",32939:"sampleCoverage",3089:Bc,3088:(t,e)=>t.scissor(...e),2960:Bc,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Ia,3317:Ia,37440:Ia,37441:Ia,37443:Ia,3330:Ia,3332:Ia,3331:Ia,36010:JJ,3314:Ia,32878:Ia,3316:Ia,3315:Ia,32877:Ia,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Sp(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Sp(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Sp(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Sp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,l,o)},stencilOp:(t,e)=>{e=Sp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,l,o)},viewport:(t,e)=>t.viewport(...e)};function Ci(t,e,n){return e[t]!==void 0?e[t]:n[t]}const tee={blendEquation:(t,e,n)=>t.blendEquationSeparate(Ci(32777,e,n),Ci(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Ci(32969,e,n),Ci(32968,e,n),Ci(32971,e,n),Ci(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Ci(32824,e,n),Ci(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Ci(32938,e,n),Ci(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Ci(2962,e,n),Ci(2967,e,n),Ci(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Ci(34816,e,n),Ci(36003,e,n),Ci(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Ci(2964,e,n),Ci(2965,e,n),Ci(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Ci(34817,e,n),Ci(34818,e,n),Ci(34819,e,n))},ok={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},BA=(t,e)=>t.isEnabled(e),ak={3042:BA,2884:BA,2929:BA,3024:BA,32823:BA,32926:BA,32928:BA,3089:BA,2960:BA,35977:BA};function dz(t){for(const e in t)return!1;return!0}function nee(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function lk(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function ree(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,l=new Array(s),o=0;o<s;o++)l[o]=arguments[o];const{valueChanged:p,oldValue:v}=n(t.state._updateCache,...l);return p&&r(...l),v},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function iee(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class see{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?aee(e):Object.assign({},mS),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Bo(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];oc(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Bo(s!==void 0);const l=e[s],o=this.cache[s];nee(l,o)||(n=!0,r=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=l)}return{valueChanged:n,oldValue:r}}}function pz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Bo(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new see(t,{copyState:r}),iee(t);for(const s in ok){const l=ok[s];ree(t,s,l)}lk(t,"getParameter"),lk(t,"isEnabled")}return t.state.enable=n,t}function oee(t){t.state||pz(t,{copyState:!1}),t.state.push()}function Ak(t){Bo(t.state),t.state.pop()}function oc(t,e){if(Bo(uv(t),"setParameters requires a WebGL context"),dz(e))return;const n={};for(const i in e){const s=Number(i),l=eee[i];l&&(typeof l=="string"?n[l]=!0:l(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=tee[i];s(t,e,r)}}function aee(t,e){if(e=e||mS,typeof e=="number"){const i=e,s=ak[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=ak[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function lee(t){oc(t,mS)}function cA(t,e,n){if(dz(e))return n(t);const{nocatch:r=!0}=e;oee(t),oc(t,e);let i;if(r)i=n(t),Ak(t);else try{i=n(t)}finally{Ak(t)}return i}function vd(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function Tw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=vd(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return uee(e,r,i,s,n)}function Aee(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function uee(t,e,n,r,i){const s=uk(t[0],e,n);let l=ck(t[1],e,r,i),o=uk(t[0]+1,e,n);const p=o===n-1?o:o-1;o=ck(t[1]+1,e,r,i);let v;return i?(o=o===0?o:o+1,v=l,l=o):v=o===r-1?o:o-1,{x:s,y:l,width:Math.max(p-s+1,1),height:Math.max(v-l+1,1)}}function uk(t,e,n){return Math.min(Math.round(t*e),n-1)}function ck(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const yS=zd(),cee=yS&&typeof document<"u",gz={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function mz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Bo(yS,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},gz,t);const{width:e,height:n}=t;function r(o){if(t.throwOnError)throw new Error(o);return console.error(o),null}t.onError=r;let i;const{canvas:s}=t,l=pee({canvas:s,width:e,height:n,onError:r});return i=dee(l,t),i?(i=_S(i,t),gee(i),i):null}function _S(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||mee(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},gz,e);const{manageState:n,debug:r}=e;return n&&pz(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return vn.log(1,...s)()}}),yS&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),vn.level=Math.max(vn.level,1)):vn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function hee(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function fee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=Aee(e.useDevicePixels);yee(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function dee(t,e){const{onError:n}=e;let r=null;const i=p=>r=p.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:l=!0}=e;let o=null;return l&&(o=o||t.getContext("webgl2",e),o=o||t.getContext("experimental-webgl2",e)),s&&(o=o||t.getContext("webgl",e),o=o||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),o?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),o):n("Failed to create ".concat(l&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function pee(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(cee&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function gee(t){const e=cr(t)?"WebGL2":"WebGL1",n=hee(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";vn.info(1,"".concat(e).concat(i," context ").concat(r))()}function mee(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function yee(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(vn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let l=e;const o=Math.floor(r*l),p=Math.floor(i*l);t.canvas.width=o,t.canvas.height=p,(t.drawingBufferWidth!==o||t.drawingBufferHeight!==p)&&(vn.warn("Device pixel ratio clamped")(),l=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*l),t.canvas.height=Math.floor(i*l)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function hk(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let fk=class{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=hk(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(hk()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},_ee=class{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof fk?this.stats[n]=e:this.stats[n]=new fk(n,r)),this.stats[n]}};function yz(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function _z(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||yz()}const Sw=globalThis;function vee(t){if(!t&&!_z())return"Node";if(yz(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":Sw.chrome?"Chrome":Sw.safari?"Safari":Sw.mozInnerScreenX?"Firefox":"Unknown"}const dg="8.5.21",xee="set luma.log.level=1 (or higher) to trace rendering";class wee{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new _ee({id:e})),this.stats.get(e)}}const Yh=new wee;if(globalThis.luma&&globalThis.luma.VERSION!==dg)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(dg));globalThis.luma||(_z()&&vn.log(1,"luma.gl ".concat(dg," - ").concat(xee))(),globalThis.luma=globalThis.luma||{VERSION:dg,version:dg,log:vn,stats:Yh,globals:{modules:{},nodeIO:{}}});function bee(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function Eee(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function nn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Cw(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return nn(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function uh(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const Mw={};function mh(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Mw[t]=Mw[t]||1;const e=Mw[t]++;return"".concat(t,"-").concat(e)}function dk(t){return nn(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function xd(t){let e=!0;for(const n in t){e=!1;break}return e}function vz(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(l=>{s.methodName||(s[l]=()=>{throw vn.removed("Calling removed method ".concat(e,".").concat(l,": "),i)(),new Error(l)})})}const l0="Resource subclass must define virtual methods";let dc=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cv(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||mh(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=Cw(this.gl,e),nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=cr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,p="webgl2"in i?i.webgl2:i.webgl1;return s?p:o}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=cr(this.gl),l={},o=n||Object.keys(i);for(const p of o){const v=i[p];if(v&&(!("webgl2"in v)||s)&&(!("extension"in v)||this.gl.getExtension(v.extension))){const M=r?uh(this.gl,p):p;l[M]=this.getParameter(p,e),r&&v.type==="GLenum"&&(l[M]=uh(this.gl,l[M]))}}return l}setParameter(e,n){e=Cw(this.gl,e),nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=cr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=Cw(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return vz(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(l0)}_deleteHandle(){throw new Error(l0)}_bindHandle(e){throw new Error(l0)}_getOptsFromHandle(){throw new Error(l0)}_getParameter(e,n){throw new Error(l0)}_setParameter(e,n){throw new Error(l0)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Yh.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Yh.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=Yh.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=Yh.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const Tee="Failed to deduce GL constant from typed array";function F3(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Tee)}}function qg(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function See(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const l=n*i;s=s||new Uint8Array(l);for(let o=0;o<r/2;++o){const p=o*l,v=(r-o-1)*l;s.set(e.subarray(p,p+l)),e.copyWithin(p,v,v+l),e.set(s,v)}}function Cee(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),l=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let p=0;p<i;p++)for(let v=0;v<4;v++)l[(o*i+p)*4+v]=e[(o*2*n+p*2)*4+v];return{data:l,width:i,height:s}}function N3(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const o in r)if(o in e){const v=r[o]?"".concat(t,".").concat(r[o]):"N/A";vn.removed("".concat(t,".").concat(o),v)()}for(const o in i)if(o in e){const p=i[o];vn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(p))()}let l=null;for(const o in s)if(o in e){const p=s[o];vn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(p))(),l=l||Object.assign({},e),l[p]=e[o],delete l[o]}return l||e}const Mee={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Pee={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Ba{static getBytesPerElement(e){return qg(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return nn(e.size),qg(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Ba(Mee,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Ba.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Ba.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=N3("Accessor",e,Pee),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const pk=10,xz={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},kee={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:xz},Iee={removedProps:xz};class $r extends dc{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ba.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ba.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=N3("Buffer",e,kee),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=N3("Buffer",e,Iee),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Ba(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;nn(n);const l=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(l,this.handle),i!==0||s!==void 0?(fo(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(l,r,n),this.gl.bindBuffer(l,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:l}=this;return fo(l),l.bindBuffer(36662,n.handle),l.bindBuffer(36663,this.handle),l.copyBufferSubData(36662,36663,r,i,s),l.bindBuffer(36662,null),l.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};fo(this.gl);const s=qg(this.accessor.type||5126,{clamped:!1}),l=this._getAvailableElementCount(n),o=r;let p,v;e?(v=e.length,p=v-o):(p=Math.min(l,i||l),v=o+p);const S=Math.min(l,p);return i=i||S,nn(i<=S),e=e||new s(v),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(nn(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(pk,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;nn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,pk),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=F3(e);return nn(s),this.setAccessor(new Ba(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;nn(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=qg(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Ba(this.accessor,{type:F3(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return vn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return vn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return vn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return vn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Ba(this.accessor,e),this}}const vS={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},wz={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},bz={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function Lee(t,e){const n=vS[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=cr(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function Dee(t,e){const n=vS[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const Ree=[9729,9728],gk=globalThis.WebGLBuffer||function(){};class df extends dc{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&Lee(e,r),s=s&&(!i||Dee(e,r))),s}constructor(e,n){const{id:r=mh("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(J=>this.initialize(Object.assign({},e,{pixels:J,data:J}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:l=0,recreate:o=!1,parameters:p={},pixelStore:v={},textureUnit:S=void 0}=e;n||(n=i);let{width:M,height:k,dataFormat:F,type:H,compressed:j=!1,mipmaps:ie=!0}=e;const{depth:Y=0}=e;return{width:M,height:k,compressed:j,dataFormat:F,type:H}=this._deduceParameters({format:s,type:H,dataFormat:F,compressed:j,data:n,width:M,height:k}),this.width=M,this.height=k,this.depth=Y,this.format=s,this.type=H,this.dataFormat=F,this.border=l,this.textureUnit=S,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),ie&&this._isNPOT()&&(vn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),ie=!1,this._updateForNPOT(p)),this.mipmaps=ie,this.setImageData({data:n,width:M,height:k,depth:Y,format:s,type:H,dataFormat:F,border:l,mipmaps:ie,parameters:v,compressed:j}),ie&&this.generateMipmap(),this.setParameters(p),o&&(this.data=n),r&&(this._video={video:n,parameters:p,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(vn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),cA(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:l=this.border,offset:o=0,parameters:p={}}=e;let{data:v=null,type:S=this.type,width:M=this.width,height:k=this.height,dataFormat:F=this.dataFormat,compressed:H=!1}=e;v||(v=r),{type:S,dataFormat:F,compressed:H,width:M,height:k}=this._deduceParameters({format:s,type:S,dataFormat:F,compressed:H,data:v,width:M,height:k});const{gl:j}=this;j.bindTexture(this.target,this.handle);let ie=null;({data:v,dataType:ie}=this._getDataType({data:v,compressed:H}));let Y,J=0;if(cA(this.gl,p,()=>{switch(ie){case"null":j.texImage2D(n,i,s,M,k,l,F,S,v);break;case"typed-array":j.texImage2D(n,i,s,M,k,l,F,S,v,o);break;case"buffer":Y=fo(j),Y.bindBuffer(35052,v.handle||v),Y.texImage2D(n,i,s,M,k,l,F,S,o),Y.bindBuffer(35052,null);break;case"browser-object":cr(j)?j.texImage2D(n,i,s,M,k,l,F,S,v):j.texImage2D(n,i,s,F,S,v);break;case"compressed":for(const[se,ce]of v.entries())j.compressedTexImage2D(n,se,ce.format,ce.width,ce.height,l,ce.data),J+=ce.levelSize;break;default:nn(!1,"Unknown image data type")}}),ie==="compressed")this._trackAllocatedMemory(J,"Texture");else if(v&&v.byteLength)this._trackAllocatedMemory(v.byteLength,"Texture");else{const se=wz[this.dataFormat]||4,ce=bz[this.type]||1;this._trackAllocatedMemory(this.width*this.height*se*ce,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:l=0,width:o=this.width,height:p=this.height,level:v=0,format:S=this.format,type:M=this.type,dataFormat:k=this.dataFormat,compressed:F=!1,offset:H=0,border:j=this.border,parameters:ie={}}=e;if({type:M,dataFormat:k,compressed:F,width:o,height:p}=this._deduceParameters({format:S,type:M,dataFormat:k,compressed:F,data:i,width:o,height:p}),nn(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const Y=i;i=Y.data,o=Y.shape[0],p=Y.shape[1]}i instanceof $r&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),cA(this.gl,ie,()=>{if(F)this.gl.compressedTexSubImage2D(n,v,s,l,o,p,S,i);else if(i===null)this.gl.texSubImage2D(n,v,s,l,o,p,k,M,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,v,s,l,o,p,k,M,i,H);else if(i instanceof gk){const Y=fo(this.gl);Y.bindBuffer(35052,i),Y.texSubImage2D(n,v,s,l,o,p,k,M,H),Y.bindBuffer(35052,null)}else cr(this.gl)?fo(this.gl).texSubImage2D(n,v,s,l,o,p,k,M,i):this.gl.texSubImage2D(n,v,s,l,k,M,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return vn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof $r?{data:n.handle,dataType:"buffer"}:n instanceof gk?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:l,type:o,compressed:p}=e;const v=vS[n];return l=l||v&&v.dataFormat,o=o||v&&v.types[0],p=p||v&&v.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:l,type:o,compressed:p,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},nn(i,"Could not deduced texture size"),nn(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),nn(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:nn(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return cr(this.gl)||!this.width||!this.height?!1:!dk(this.width)||!dk(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:Ree.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let Bee="";function zee(t,e){return nn(typeof t=="string"),t=Bee+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class da extends df{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return df.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cv(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:zee(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const U3=[34069,34070,34071,34072,34073,34074];class Ez extends df{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};cv(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:l=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:l})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:l=0,format:o=6408,type:p=5121}=e;const{gl:v}=this,S=i||s,M=await Promise.all(U3.map(k=>{const F=S[k];return Promise.all(Array.isArray(F)?F:[F])}));this.bind(),U3.forEach((k,F)=>{M[F].length>1&&this.opts.mipmaps!==!1&&vn.warn("".concat(this.id," has mipmap and multiple LODs."))(),M[F].forEach((H,j)=>{n&&r?v.texImage2D(k,j,o,n,r,l,o,p,H):v.texImage2D(k,j,o,o,p,H)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:l,border:o=0,format:p=6408,type:v=5121}=e,{gl:S}=this,M=s||l;return this.bind(),M instanceof Promise?M.then(k=>this.setImageDataForFace(Object.assign({},e,{face:n,data:k,pixels:k}))):this.width||this.height?S.texImage2D(n,0,p,r,i,o,p,v,M):S.texImage2D(n,0,p,p,v,M),this}}Ez.FACES=U3;class Oee extends df{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return cr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};fo(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:l=1,border:o=0,format:p,type:v=5121,offset:S=0,data:M,parameters:k={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),cA(this.gl,k,()=>{ArrayBuffer.isView(M)&&this.gl.texImage3D(this.target,n,r,i,s,l,o,p,v,M),M instanceof $r&&(this.gl.bindBuffer(35052,M.handle),this.gl.texImage3D(this.target,n,r,i,s,l,o,p,v,S))}),M&&M.byteLength)this._trackAllocatedMemory(M.byteLength,"Texture");else{const F=wz[this.dataFormat]||4,H=bz[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*F*H,"Texture")}return this.loaded=!0,this}}const zh="EXT_color_buffer_float",mk={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:zh,bpp:2},33327:{gl2:zh,bpp:4},34842:{gl2:zh,bpp:8},33326:{gl2:zh,bpp:4},33328:{gl2:zh,bpp:8},34836:{gl2:zh,bpp:16},35898:{gl2:zh,bpp:4}};function Fee(t,e,n){const r=n[e];if(!r)return!1;const i=cr(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class I0 extends dc{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||Fee(e,n,mk)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return nn(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&cr(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*mk[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const Nee=256,Uee=1024,Vee=16384,yk=6144,_k=6145,vk=6146,xk=34041,Tz="clear: bad arguments";function xS(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let l=0;n&&(l|=Vee,n!==!0&&(s.clearColor=n)),r&&(l|=Nee,r!==!0&&(s.clearDepth=r)),i&&(l|=Uee,r!==!0&&(s.clearStencil=r)),nn(l!==0,Tz),cA(t,s,()=>{t.clear(l)})}function Gee(t){let{framebuffer:e=null,buffer:n=yk,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};fo(t),cA(t,{framebuffer:e},()=>{switch(n){case yk:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case _k:t.clearBufferfv(_k,0,[i]);break;case vk:t.clearBufferiv(vk,0,[i]);break;case xk:const[s,l]=i;t.clearBufferfi(xk,0,s,l);break;default:nn(!1,Tz)}})}function $ee(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return nn(!1),0}}function hv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:l=null,sourceWidth:o,sourceHeight:p,sourceType:v}=e;const{framebuffer:S,deleteFramebuffer:M}=Sz(t);nn(S);const{gl:k,handle:F,attachments:H}=S;o=o||S.width,p=p||S.height,s===36064&&F===null&&(s=1028),nn(H[s]),v=v||H[s].type,l=Hee(l,v,i,o,p),v=v||F3(l);const j=k.bindFramebuffer(36160,F);return k.readPixels(n,r,o,p,i,v,l),k.bindFramebuffer(36160,j||null),M&&S.delete(),l}function wk(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=hv(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=Cee({data:r,width:i,height:s}));See({data:r,width:i,height:s});const l=document.createElement("canvas");l.width=i,l.height=s;const o=l.getContext("2d"),p=o.createImageData(i,s);return p.data.set(r),o.putImageData(p,0,0),l.toDataURL()}function jee(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:l=6408}=n;let{targetX:o,targetY:p,targetZ:v,width:S,height:M}=n;const{framebuffer:k,deleteFramebuffer:F}=Sz(t);nn(k);const{gl:H,handle:j}=k,ie=typeof o<"u"||typeof p<"u"||typeof v<"u";o=o||0,p=p||0,v=v||0;const Y=H.bindFramebuffer(36160,j);nn(e);let J=null;if(e instanceof df&&(J=e,S=Number.isFinite(S)?S:J.width,M=Number.isFinite(M)?M:J.height,J.bind(0),e=J.target),!ie)H.copyTexImage2D(e,s,l,r,i,S,M,0);else switch(e){case 3553:case 34067:H.copyTexSubImage2D(e,s,o,p,r,i,S,M);break;case 35866:case 32879:fo(H).copyTexSubImage3D(e,s,o,p,v,r,i,S,M);break}return J&&J.unbind(),H.bindFramebuffer(36160,Y||null),F&&k.delete(),J}function Sz(t){return t instanceof os?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:ete(t),deleteFramebuffer:!0}}function Hee(t,e,n,r,i){if(t)return t;e=e||5121;const s=qg(e,{clamped:!1}),l=$ee(n);return new s(r*i*l)}const ti={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function Wee(t){const e=new da(t,{format:6408,type:5126,dataFormat:6408}),n=new os(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const Cz={[ti.WEBGL2]:[!1,!0],[ti.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[ti.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[ti.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[ti.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[ti.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[ti.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[ti.FLOAT_BLEND]:["EXT_float_blend"],[ti.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[ti.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[ti.TEXTURE_FLOAT]:["OES_texture_float",!0],[ti.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[ti.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[ti.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[ti.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[ti.COLOR_ATTACHMENT_RGBA32F]:[Wee,"EXT_color_buffer_float"],[ti.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[ti.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[ti.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[ti.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[ti.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[ti.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},Qee=2;function Mz(t,e){return wS(t,e)}function wS(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Pz(t,n))}function qee(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Cz)t.luma.caps[e]===void 0&&(t.luma.caps[e]=Pz(t,e));return t.luma.caps}function Pz(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=Zee(t,e)),t.luma.caps[e]||vn.log(Qee,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function Zee(t,e){const n=Cz[e];nn(n,e);let r;const i=cr(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:nn(!1);return r}const bk="Multiple render targets not supported";class os extends dc{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new os(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=fo(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=fo(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:l=!0,stencil:o=!1,check:p=!0,readBuffer:v=void 0,drawBuffers:S=void 0}=e;if(nn(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const M in i){const k=i[M];(Array.isArray(k)?k[0]:k).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,l,o,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:v,drawBuffers:S}),i&&p&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:l=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:l});const{gl:o}=this,p=o.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,p||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return nn(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&vn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(l=>{i[l]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const l in i){nn(l!==void 0,"Misspelled framebuffer binding point?");const o=Number(l),p=i[o];let v=p;if(!v)this._unattach(o);else if(v instanceof I0)this._attachRenderbuffer({attachment:o,renderbuffer:v});else if(Array.isArray(p)){const[S,M=0,k=0]=p;v=S,this._attachTexture({attachment:o,texture:S,layer:M,level:k})}else this._attachTexture({attachment:o,texture:v,layer:0,level:0});r&&v&&v.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(l=>!this.attachments[l]).forEach(l=>{delete this.attachments[l]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(Xee(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,l=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&xS(this.gl,{color:n,depth:r,stencil:i}),s.forEach((o,p)=>{Gee(this.gl,{drawBuffer:p,value:o})}),this.gl.bindFramebuffer(36160,l||null),this}readPixels(){return vn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return vn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return vn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return vn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return vn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return vn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:l}=e;const o=fo(this.gl),p=o.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&l===void 0?o.invalidateFramebuffer(36008,n):o.invalidateFramebuffer(36008,n,r,i,s,l),o.bindFramebuffer(36008,p),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=uh(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const l=n?uh(this.gl,s):s;i[l]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),l=e?uh(this.gl,s):s;r[l]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(wk(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>vn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=wk(this,{targetMaxHeight:100});return vn.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let l=null;return e&&(l=l||{},l[36064]=new da(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(l[36064])),n&&r?(l=l||{},l[33306]=new I0(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(l[33306])):n?(l=l||{},l[36096]=new I0(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(l[36096])):r&&nn(!1),l}_unattach(e){const n=this.attachments[e];n&&(n instanceof I0?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:l}=this;switch(l.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:fo(l).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const p=Yee(i);l.framebufferTexture2D(36160,n,p,r.handle,s);break;case 3553:l.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:nn(!1,"Illegal texture type")}l.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=EJ(this.gl);n?n.readBuffer(e):nn(e===36064||e===1029,bk),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=fo(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):nn(e.length===1&&(e[0]===36064||e[0]===1029),bk)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=qee(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function Yee(t){return t<34069?t+34069:t}function Xee(t){return(os.STATUS||{})[t]||"Framebuffer error ".concat(t)}const Kee=[36049,36048,33296,33298,33299,33300,33301,33302,33303];os.ATTACHMENT_PARAMETERS=Kee;function Jee(t,e){nn(t instanceof da||t instanceof Ez||t instanceof Oee);const n=t.constructor,{gl:r,width:i,height:s,format:l,type:o,dataFormat:p,border:v,mipmaps:S}=t,M=Object.assign({width:i,height:s,format:l,type:o,dataFormat:p,border:v,mipmaps:S},e);return new n(r,M)}function ete(t,e){const{gl:n,width:r,height:i,id:s}=t;return new os(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:t}}))}function Oy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const tte=35632,nte=35633;function rte(t){switch(t){case tte:return"fragment";case nte:return"vertex";default:return"unknown type"}}function ite(t,e,n,r){const i=t.split(/\r?\n/),s={},l={},o=r||Oy(e)||"(unnamed)",p="".concat(rte(n)," shader ").concat(o);for(let S=0;S<i.length;S++){const M=i[S];if(M.length<=1)continue;const k=M.split(":"),F=k[0],H=parseInt(k[2],10);if(isNaN(H))throw new Error("GLSL compilation error in ".concat(p,": ").concat(t));F!=="WARNING"?s[H]=M:l[H]=M}const v=ste(e);return{shaderName:p,errors:Ek(s,v),warnings:Ek(l,v)}}function Ek(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],l=s.split(":",3),o=l[0],p=parseInt(l[1],10)||0,v=s.substring(l.join(":").length+1).trim();n+=kz("^^^ ".concat(o,": ").concat(v,`

`),p)}}return n}function ste(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,l)=>{const o=String(l+e),p=o.length;return kz(o,i-p)+n+s})}function kz(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function Iz(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const ote="Shader: GLSL source code must be a JavaScript string";class Zg extends dc{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return nn(!1),"unknown"}}constructor(e,n){cv(e),nn(typeof n.source=="string",ote);const r=Oy(n.source,null)||n.id||mh("unnamed ".concat(Zg.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=Oy(n,null);r&&(this.id=mh(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Zg.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Oy(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:l}=ite(r,this.source,this.shaderType,this.id);throw vn.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),vn.warn("GLSL compilation warnings in ".concat(i,`
`).concat(l))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Pw extends Zg{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class kw extends Zg{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const ate={5126:li.bind(null,"uniform1fv",La,1,oo),35664:li.bind(null,"uniform2fv",La,2,oo),35665:li.bind(null,"uniform3fv",La,3,oo),35666:li.bind(null,"uniform4fv",La,4,oo),5124:li.bind(null,"uniform1iv",zc,1,oo),35667:li.bind(null,"uniform2iv",zc,2,oo),35668:li.bind(null,"uniform3iv",zc,3,oo),35669:li.bind(null,"uniform4iv",zc,4,oo),35670:li.bind(null,"uniform1iv",zc,1,oo),35671:li.bind(null,"uniform2iv",zc,2,oo),35672:li.bind(null,"uniform3iv",zc,3,oo),35673:li.bind(null,"uniform4iv",zc,4,oo),35674:li.bind(null,"uniformMatrix2fv",La,4,Du),35675:li.bind(null,"uniformMatrix3fv",La,9,Du),35676:li.bind(null,"uniformMatrix4fv",La,16,Du),35678:Ds,35680:Ds,5125:li.bind(null,"uniform1uiv",F1,1,oo),36294:li.bind(null,"uniform2uiv",F1,2,oo),36295:li.bind(null,"uniform3uiv",F1,3,oo),36296:li.bind(null,"uniform4uiv",F1,4,oo),35685:li.bind(null,"uniformMatrix2x3fv",La,6,Du),35686:li.bind(null,"uniformMatrix2x4fv",La,8,Du),35687:li.bind(null,"uniformMatrix3x2fv",La,6,Du),35688:li.bind(null,"uniformMatrix3x4fv",La,12,Du),35689:li.bind(null,"uniformMatrix4x2fv",La,8,Du),35690:li.bind(null,"uniformMatrix4x3fv",La,12,Du),35678:Ds,35680:Ds,35679:Ds,35682:Ds,36289:Ds,36292:Ds,36293:Ds,36298:Ds,36299:Ds,36300:Ds,36303:Ds,36306:Ds,36307:Ds,36308:Ds,36311:Ds},lte={},Ate={},ute={},Tk=[0];function bS(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(Tk[0]=t,t=Tk);const i=t.length;if(i%e&&vn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let l=0;l<i;l++)s[l]=t[l];return s}function La(t,e){return bS(t,e,Float32Array,lte)}function zc(t,e){return bS(t,e,Int32Array,Ate)}function F1(t,e){return bS(t,e,Uint32Array,ute)}function Sk(t,e,n){const r=ate[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function cte(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function hte(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!fte(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function fte(t){return Array.isArray(t)||ArrayBuffer.isView(t)?pte(t):isFinite(t)||t===!0||t===!1||t instanceof df||t instanceof I0?!0:t instanceof os?!!t.texture:!1}function dte(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function pte(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ds(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function li(t,e,n,r){let i=null,s=null;return(l,o,p)=>{const v=e(p,n),S=v.length;let M=!1;if(i===null)i=new Float32Array(S),s=S,M=!0;else{nn(s===S,"Uniform length cannot change.");for(let k=0;k<S;++k)if(v[k]!==i[k]){M=!0;break}}return M&&(r(l,t,o,v),i.set(v)),M}}function oo(t,e,n,r){t[e](n,r)}function Du(t,e,n,r){t[e](n,!1,r)}const gte=5120,mte=5121,yte=5122,_te=5123,Ck=0,N1=1,vte=2,xte=3,U1=4,wte=5,bte=6,ns=5126,Ete=35664,Tte=35665,Ste=35666,Cp=5124,Cte=35667,Mte=35668,Pte=35669,Mp=5125,kte=36294,Ite=36295,Lte=36296,Dte=35670,Rte=35671,Bte=35672,zte=35673,Ote=35674,Fte=35675,Nte=35676,Ute=35685,Vte=35686,Gte=35687,$te=35688,jte=35689,Hte=35690,V3={[ns]:[ns,1,"float"],[Ete]:[ns,2,"vec2"],[Tte]:[ns,3,"vec3"],[Ste]:[ns,4,"vec4"],[Cp]:[Cp,1,"int"],[Cte]:[Cp,2,"ivec2"],[Mte]:[Cp,3,"ivec3"],[Pte]:[Cp,4,"ivec4"],[Mp]:[Mp,1,"uint"],[kte]:[Mp,2,"uvec2"],[Ite]:[Mp,3,"uvec3"],[Lte]:[Mp,4,"uvec4"],[Dte]:[ns,1,"bool"],[Rte]:[ns,2,"bvec2"],[Bte]:[ns,3,"bvec3"],[zte]:[ns,4,"bvec4"],[Ote]:[ns,8,"mat2"],[Ute]:[ns,8,"mat2x3"],[Vte]:[ns,8,"mat2x4"],[Fte]:[ns,12,"mat3"],[Gte]:[ns,12,"mat3x2"],[$te]:[ns,12,"mat3x4"],[Nte]:[ns,16,"mat4"],[jte]:[ns,16,"mat4x2"],[Hte]:[ns,16,"mat4x3"]};function Wte(t){switch(t){case Ck:return Ck;case N1:return N1;case xte:return N1;case vte:return N1;case U1:return U1;case wte:return U1;case bte:return U1;default:return nn(!1),0}}function Mk(t){const e=V3[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function Lz(t,e){switch(t){case gte:case mte:case yte:case _te:t=ns;break}for(const n in V3){const[r,i,s]=V3[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class Qte{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getActiveAttrib(e.handle,i),p=n.getAttribLocation(e.handle,s);p>=0&&this._addAttribute(p,s,l,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!cr(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,l,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:l}=Mk(r),o={type:s,size:i*l};this._inferProperties(e,n,o);const p={location:e,name:n,accessor:new Ba(o)};this.attributeInfos.push(p),this.attributeInfosByLocation[e]=p,this.attributeInfosByName[p.name]=p}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:l}=Mk(r),o=new Ba({type:s,size:i*l}),p={location:e,name:n,accessor:o};this.varyingInfos.push(p),this.varyingInfosByName[p.name]=p}}const Pk=4,qte=35981,Zte=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Dz extends dc{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",Zte),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:l=qte}=e;return this.hash=n||"",this.vs=typeof r=="string"?new Pw(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new kw(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,nn(this.vs instanceof Pw),nn(this.fs instanceof kw),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(fo(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,l)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Qte(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:l,end:o,isIndexed:p=!1,indexType:v=5123,instanceCount:S=0,isInstanced:M=S>0,vertexArray:k=null,transformFeedback:F,framebuffer:H,parameters:j={},uniforms:ie,samplers:Y}=e;if((ie||Y)&&(vn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(ie||{})),vn.priority>=n){const J=H?H.id:"default",se="mode=".concat(uh(this.gl,r)," verts=").concat(i," ")+"instances=".concat(S," indexType=").concat(uh(this.gl,v)," ")+"isInstanced=".concat(M," isIndexed=").concat(p," ")+"Framebuffer=".concat(J);vn.log(n,se)()}return nn(k),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||M&&S===0?!1:(k.bindForDraw(i,S,()=>{if(H!==void 0&&(j=Object.assign({},j,{framebuffer:H})),F){const J=Wte(r);F.begin(J)}this._bindTextures(),cA(this.gl,j,()=>{p&&M?this.gl2.drawElementsInstanced(r,i,v,s,S):p&&cr(this.gl)&&!isNaN(l)&&!isNaN(o)?this.gl2.drawRangeElements(r,l,o,i,v,s):p?this.gl.drawElements(r,i,v,s):M?this.gl2.drawArraysInstanced(r,s,i,S):this.gl.drawArrays(r,s,i)}),F&&F.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vn.priority>=2&&hte(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,l=!1;if(s instanceof os&&(s=s.texture),s instanceof df)if(l=this.uniforms[n]!==r,l){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:p}=i;o.bind(p),s=p,this._textureUniforms[n]=o}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||l)&&dte(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new Pw({handle:i});break;case 35632:r.fs=new kw({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=mh(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),vn.time(Pk,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),vn.timeEnd(Pk,"linkProgram for ".concat(this._getName()))(),e.debug||vn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=cte(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=Sk(e,s,r),r.size>1)for(let l=0;l<r.size;l++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(l,"]")),this._uniformSetters["".concat(i,"[").concat(l,"]")]=Sk(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const Yte=34918,Xte=34919,Kte=35007,Jte=36795,ene=35976,tne=35887,nne=36202;class e2 extends dc{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=cr(e),i=wS(e,ti.TIMER_QUERY);let s=r||i;for(const l of n)switch(l){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:nn(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(Kte)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?nne:tne)}beginTransformFeedbackQuery(){return this.begin(ene)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,Xte);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(Jte)}getResult(){return this.gl2.getQueryParameter(this.handle,Yte)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return e2.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class Rz extends dc{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return cr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};fo(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,xd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:l}=this._getBufferParams(n);return r<0?(this.unused[e]=i,vn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,l,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof $r?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let V1=null;function rne(t){return(!V1||V1.byteLength<t)&&(V1=new ArrayBuffer(t)),V1}function ine(t,e){const n=rne(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function sne(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,l=i*s;let o=0;for(let p=r;o<s;o++)e[p++]=n[o];for(;o<l;)o<l-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+l-o),o=l);return e}const one="elements must be GL.ELEMENT_ARRAY_BUFFER";class Da extends dc{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?cr(e)||vee()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Da(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Da.MAX_ATTRIBUTES=Da.MAX_ATTRIBUTES||e.getParameter(34921),Da.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Da._setConstantFloatArray(e,n,r);break;case Int32Array:Da._setConstantIntArray(e,n,r);break;case Uint32Array:Da._setConstantUintArray(e,n,r);break;default:nn(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Da.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return nn(!e||e.target===34963,one),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:l,offset:o,normalized:p,integer:v,divisor:S}=r,{gl:M,gl2:k}=this;return e=Number(e),this.bind(()=>{M.bindBuffer(34962,n.handle),v?(nn(cr(M)),k.vertexAttribIPointer(e,i,s,l,o)):M.vertexAttribPointer(e,i,s,p,l,o),M.enableVertexAttribArray(e),k.vertexAttribDivisor(e,S||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Da.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let l=!this.buffer;if(this.buffer=this.buffer||new $r(this.gl,i),l=l||this.buffer.reallocate(i),l=l||!this._compareConstantArrayValues(r,this.bufferValue),l){const o=ine(n.constructor,s);sne({target:o,source:r,start:0,count:s}),this.buffer.subData(o),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:nn(!1)}}static _setConstantIntArray(e,n,r){switch(nn(cr(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:nn(!1)}}static _setConstantUintArray(e,n,r){switch(nn(cr(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:nn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return nn(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const ane="VertexArray: attributes must be Buffers or constants (i.e. typed array)",lne=/^(.+)__LOCATION_([0-9]+)$/,Ane=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class une{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Da(e),vz(this,"VertexArray","v6.0",Ane),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new $r(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof $r&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof $r&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:l,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(l)||l<0)return this.unused[e]=n,vn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const p=this._getAttributeInfo(o||l);if(!p)return s;const v=this.accessors[l]||{},S=Ba.resolve(p.accessor,v,r,i),{size:M,type:k}=S;return nn(Number.isFinite(M)&&Number.isFinite(k)),{location:l,accessor:S}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=lne.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof $r)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof $r){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof $r){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(ane)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Da.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Da.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,l=s>0;if(e.isInstanced=e.isInstanced||l,r instanceof $r){const o=r;if(l){const p=o.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,p)}else{const p=o.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,p)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function cne(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let l=0;l<t.length&&l<n;++l)l>0&&(i+=",".concat(l%r===0?" ":"")),i+=Yg(t[l],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function Yg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return cne(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function kk(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;nn(n);const s=".*_.*",l=".*Matrix",o=n._uniformSetters,p={},v=Object.keys(o).sort();let S=0;for(const F of v)!F.match(s)&&!F.match(l)&&Iw({table:p,header:e,uniforms:r,uniformName:F,undefinedOnly:i})&&S++;for(const F of v)F.match(l)&&Iw({table:p,header:e,uniforms:r,uniformName:F,undefinedOnly:i})&&S++;for(const F of v)p[F]||Iw({table:p,header:e,uniforms:r,uniformName:F,undefinedOnly:i})&&S++;let M=0;const k={};if(!i)for(const F in r){const H=r[F];p[F]||(M++,k[F]={Type:"NOT USED: ".concat(H),[e]:Yg(H)})}return{table:p,count:S,unusedTable:k,unusedCount:M}}function Iw(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const l=r[i],o=hne(l);return!s||!o?(e[i]={[n]:o?Yg(l):"N/A","Uniform Type":o?l:"NOT PROVIDED"},!0):!1}function hne(t){return t!=null}function fne(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=Ik(e,e.elements,null,n));const i=e.values;for(const s in i){const l=e._getAttributeInfo(s);if(l){let o="".concat(s,": ").concat(l.name);const p=e.accessors[l.location];p&&(o="".concat(s,": ").concat(dne(l.name,p))),r[o]=Ik(e,i[s],p,n)}}return r}function Ik(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",l=1,o=0,p=0,v,S,M;if(n&&(s=n.type,l=n.size,s=String(s).replace("Array",""),v=s.indexOf("nt")!==-1),e instanceof $r){const k=e,{data:F,changed:H}=k.getDebugData();S=H?"*":"",M=F,p=k.byteLength,o=p/F.BYTES_PER_ELEMENT/l;let j;if(n){const ie=n.divisor>0;j="".concat(ie?"I ":"P "," ").concat(o," (x").concat(l,"=").concat(p," bytes ").concat(uh(i,s),")")}else v=!0,j="".concat(p," bytes");return{[r]:"".concat(S).concat(Yg(M,{size:l,isInteger:v})),"Format ":j}}return M=e,l=e.length,s=String(e.constructor.name).replace("Array",""),v=s.indexOf("nt")!==-1,{[r]:"".concat(Yg(M,{size:l,isInteger:v})," (constant)"),"Format ":"".concat(l,"x").concat(s," (constant)")}}function dne(t,e){const{type:n,size:r}=e,i=Lz(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function pne(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=Lk(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=Lk(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function Lk(t){const{type:e,size:n}=t.accessor,r=Lz(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}function gne(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function mne(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||gne()}const Dk=mne()&&typeof document<"u";let yne=0;class _ne{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=ie=>mz(ie),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:l=()=>{},onError:o,gl:p=null,glOptions:v={},debug:S=!1,createFramebuffer:M=!1,autoResizeViewport:k=!0,autoResizeDrawingBuffer:F=!0,stats:H=Yh.get("animation-loop-".concat(yne++))}=e;let{useDevicePixels:j=!0}=e;"useDevicePixelRatio"in e&&(vn.deprecated("useDevicePixelRatio","useDevicePixels")(),j=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:l,onError:o,gl:p,glOptions:v,debug:S,createFramebuffer:M},this.gl=p,this.needsRedraw=null,this.timeline=null,this.stats=H,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:k,autoResizeDrawingBuffer:F,useDevicePixels:j}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return nn(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=e2.isSupported(this.gl,["timers"])?new e2(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return vn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Dk?new Promise((e,n)=>{if(Dk&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):Eee(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):bee(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?_S(this.props.gl,e):this.onCreateContext(e),!uv(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");lee(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&fee(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new os(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Lm="vs",ES="fs";function Va(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Lw={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function vne(t){const e={};for(const n in t){const r=t[n],i=xne(r);e[n]=i}return e}function xne(t){let e=Rk(t);return e==="object"?t?"type"in t?Object.assign({},t,Lw[t.type]):"value"in t?(e=Rk(t.value),Object.assign({type:e},t,Lw[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Lw[e])}function Rk(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const wne="vs",bne="fs";class Bk{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:l,getUniforms:o,deprecations:p=[],defines:v={},inject:S={},vertexShader:M,fragmentShader:k}=e;Va(typeof n=="string"),this.name=n,this.vs=r||M,this.fs=i||k,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(p),this.defines=v,this.injections=Ene(S),l&&(this.uniforms=vne(l))}getModuleSource(e){let n;switch(e){case wne:n=this.vs||"";break;case bne:n=this.fs||"";break;default:Va(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Va(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function Ene(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function Tne(t){return Sne(zz(t))}function Sne(t){const e={},n={};return Bz({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function Bz(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&Bz({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function zz(t,e){return t.map(n=>(n instanceof Bk||(Va(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Va(n.name,"shader module has no name"),n=new Bk(n),n.dependencies=zz(n.dependencies)),n))}function Cne(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const Mne=7936,Pne=7937,kne=7938,Ine=35724,TS={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},jh={};Object.keys(TS).forEach(t=>{jh[t]=t});function Lne(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Dne(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Mne),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Pne);return{gpuVendor:Rne(n,r),vendor:n,renderer:r,version:t.getParameter(kne),shadingLanguageVersion:t.getParameter(Ine)}}function Rne(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Dw={};function zk(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=TS[e];if(Va(r,e),!Cne(n))return!0;if(e in Dw)return Dw[e];const i=r[0],s=n.behavior||"enable",l="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=t.createShader(35633);t.shaderSource(o,l),t.compileShader(o);const p=t.getShaderParameter(o,35713);return t.deleteShader(o),Dw[e]=p,p}function Bne(t,e){const n=TS[e];Va(n,e);const r=Lne(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return Va(i===!1||i===!0),i}function G1(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Bne(t,n))}function zne(t){switch(Dne(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function One(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return G1(t,jh.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),G1(t,jh.GLSL_DERIVATIVES)&&zk(t,jh.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),G1(t,jh.GLSL_FRAG_DATA)&&zk(t,jh.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),G1(t,jh.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const Fne=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,Nne=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Une={[Lm]:Fne,[ES]:Nne},Fy="__LUMA_INJECT_DECLARATIONS__",Ok=/void\s+main\s*\([^)]*\)\s*\{\n?/,Fk=/}\n?[^{}]*$/,Rw=[];function Nk(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Lm;for(const s in n){const l=n[s];l.sort((p,v)=>p.order-v.order),Rw.length=l.length;for(let p=0,v=l.length;p<v;++p)Rw[p]=l[p].injection;const o="".concat(Rw.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(Fy,o));break;case"vs:#main-start":i&&(t=t.replace(Ok,p=>p+o));break;case"vs:#main-end":i&&(t=t.replace(Fk,p=>o+p));break;case"fs:#decl":i||(t=t.replace(Fy,o));break;case"fs:#main-start":i||(t=t.replace(Ok,p=>p+o));break;case"fs:#main-end":i||(t=t.replace(Fk,p=>o+p));break;default:t=t.replace(s,p=>p+o)}}return t=t.replace(Fy,""),r&&(t=t.replace(/\}\s*$/,s=>s+Une[e])),t}function G3(t){const e={};return Va(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function wd(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const Oz=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Vne=[...Oz,[wd("attribute"),"in $1"],[wd("varying"),"out $1"]],Gne=[...Oz,[wd("varying"),"in $1"]],Fz=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],$ne=[...Fz,[wd("in"),"attribute $1"],[wd("out"),"varying $1"]],jne=[...Fz,[wd("in"),"varying $1"]],$3="gl_FragColor",j3=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Hne=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Wne(t,e,n){switch(e){case 300:return n?t2(t,Vne):Qne(t);case 100:return n?t2(t,$ne):qne(t);default:throw new Error("unknown GLSL version ".concat(e))}}function t2(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function Qne(t){t=t2(t,Gne);const e=t.match(j3);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat($3,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(Hne,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat($3,"\\b"),"g"),n)}return t}function qne(t){t=t2(t,jne);const e=t.match(j3);if(e){const n=e[1];t=t.replace(j3,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),$3)}return t}const Zne=`

`.concat(Fy,`

`),Nz={[Lm]:"vertex",[ES]:"fragment"},Yne=`precision highp float;

`;function Xne(t,e){const{vs:n,fs:r}=e,i=Tne(e.modules||[]);return{gl:t,vs:Uk(t,Object.assign({},e,{source:n,type:Lm,modules:i})),fs:Uk(t,Object.assign({},e,{source:r,type:ES,modules:i})),getUniforms:Kne(i)}}function Uk(t,e){let{id:n,source:r,type:i,modules:s,defines:l={},hookFunctions:o=[],inject:p={},transpileToGLSL100:v=!1,prologue:S=!0,log:M}=e;Va(typeof r=="string","shader source must be a string");const k=i===Lm,F=r.split(`
`);let H=100,j="",ie=r;F[0].indexOf("#version ")===0?(H=300,j=F[0],ie=F.slice(1).join(`
`)):j="#version ".concat(H);const Y={};s.forEach(He=>{Object.assign(Y,He.getDefines())}),Object.assign(Y,l);let J=S?"".concat(j,`
`).concat(ere({id:n,source:r,type:i}),`
`).concat(Jne({type:i}),`
`).concat(zne(t),`
`).concat(One(t),`
`).concat(tre(Y),`
`).concat(k?"":Yne,`
`):"".concat(j,`
`);const se=rre(o),ce={},me={},Ee={};for(const He in p){const Qe=typeof p[He]=="string"?{injection:p[He],order:0}:p[He],Ye=He.match(/^(v|f)s:(#)?([\w-]+)$/);if(Ye){const nt=Ye[2],Fe=Ye[3];nt?Fe==="decl"?me[He]=[Qe]:Ee[He]=[Qe]:ce[He]=[Qe]}else Ee[He]=[Qe]}for(const He of s){M&&He.checkDeprecations(ie,M);const Qe=He.getModuleSource(i,H);J+=Qe;const Ye=He.injections[i];for(const nt in Ye){const Fe=nt.match(/^(v|f)s:#([\w-]+)$/);if(Fe){const Ze=Fe[2]==="decl"?me:Ee;Ze[nt]=Ze[nt]||[],Ze[nt].push(Ye[nt])}else ce[nt]=ce[nt]||[],ce[nt].push(Ye[nt])}}return J+=Zne,J=Nk(J,i,me),J+=nre(se[i],ce),J+=ie,J=Nk(J,i,Ee),J=Wne(J,v?100:H,k),J}function Kne(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function Jne(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(Nz[e].toUpperCase(),`
`)}function ere(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(Nz[r],`

`):""}function tre(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function nre(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((l,o)=>l.order-o.order);for(const l of s)n+="  ".concat(l.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function rre(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),l=n.replace(/\(.+/,"");e[i][l]=Object.assign(r,{signature:s})}),e}const ire="void main() {gl_FragColor = vec4(0);}",Uz=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,sre=`#version 300 es
`.concat(Uz);function Vz(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const l=s.split(";")[0];return{qualifier:r,type:i,name:l}}function Gz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?sre:e>300?"#version ".concat(e,`
`).concat(Uz):ire;const s=lre(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function ore(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Va(!1),null}}function are(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Va(!1),null}}function lre(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Va(!1),null}}const Are=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,ure={name:"fp32",vs:Are,fs:null};function Xg(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const zo={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function cre(t,{precision:e=zo.precision}={}){return t=hre(t),"".concat(parseFloat(t.toPrecision(e)))}function pf(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Xc(t,e,n){return dre(t,r=>Math.max(e,Math.min(n,r)))}function wl(t,e,n){return pf(t)?t.map((r,i)=>wl(r,e[i],n)):n*e+(1-n)*t}function qu(t,e,n){const r=zo.EPSILON;n&&(zo.EPSILON=n);try{if(t===e)return!0;if(pf(t)&&pf(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!qu(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=zo.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{zo.EPSILON=r}}function hre(t){return Math.round(t/zo.EPSILON)*zo.EPSILON}function fre(t){return t.clone?t.clone():new Array(t.length)}function dre(t,e,n){if(pf(t)){const r=t;n=n||fre(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function pre(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class SS extends pre(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:pf(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(zo)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+cre(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!qu(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(zo.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function gre(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function qr(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function pg(t,e,n=""){if(zo.debug&&!gre(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class $z extends SS{get x(){return this[0]}set x(e){this[0]=qr(e)}get y(){return this[1]}set y(e){this[1]=qr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return qr(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return qr(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Xg(e>=0&&e<this.ELEMENTS,"index is out of range"),qr(this[e])}setComponent(e,n){return Xg(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var gg=1e-6,fA=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function mre(){var t=new fA(2);return fA!=Float32Array&&(t[0]=0,t[1]=0),t}function H3(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function yre(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function _re(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function vre(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function xre(t,e){return t[0]=-e[0],t[1]=-e[1],t}function jz(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function wre(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function bre(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var Ere=yre;(function(){var t=mre();return function(e,n,r,i,s,l){var o,p;for(n||(n=2),r||(r=0),i?p=Math.min(i*n+r,e.length):p=e.length,o=r;o<p;o+=n)t[0]=e[o],t[1]=e[o+1],s(t,t,l),e[o]=t[0],e[o+1]=t[1];return e}})();function Tre(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function Hz(t,e,n){const r=e[0],i=e[1],s=e[2],l=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/l,t[1]=(n[1]*r+n[5]*i+n[9]*s)/l,t[2]=(n[2]*r+n[6]*i+n[10]*s)/l,t}function Sre(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function Cre(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function Wz(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*s,t[1]=n[1]*r+n[4]*i+n[7]*s,t[2]=n[2]*r+n[5]*i+n[8]*s,t[3]=e[3],t}function Qz(){var t=new fA(3);return fA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Mre(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Vk(t,e,n){var r=new fA(3);return r[0]=t,r[1]=e,r[2]=n,r}function Pre(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function kre(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function Ire(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Lre(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Dre(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function qz(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ny(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[0],o=n[1],p=n[2];return t[0]=i*p-s*o,t[1]=s*l-r*p,t[2]=r*o-i*l,t}function Rre(t,e,n,r){var i=e[0],s=e[1],l=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=l+r*(n[2]-l),t}function CS(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[3]*r+n[7]*i+n[11]*s+n[15];return l=l||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/l,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/l,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/l,t}function Zz(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function Yz(t,e,n){var r=n[0],i=n[1],s=n[2],l=n[3],o=e[0],p=e[1],v=e[2],S=i*v-s*p,M=s*o-r*v,k=r*p-i*o,F=i*k-s*M,H=s*S-r*k,j=r*M-i*S,ie=l*2;return S*=ie,M*=ie,k*=ie,F*=2,H*=2,j*=2,t[0]=o+S+F,t[1]=p+M+H,t[2]=v+k+j,t}function Bre(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function zre(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Ore(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Fre(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],l=e[1],o=e[2],p=Math.sqrt(n*n+r*r+i*i),v=Math.sqrt(s*s+l*l+o*o),S=p*v,M=S&&qz(t,e)/S;return Math.acos(Math.min(Math.max(M,-1),1))}var Xz=Pre,Nre=kre,Kz=Mre,Bw=Ire;(function(){var t=Qz();return function(e,n,r,i,s,l){var o,p;for(n||(n=3),r||(r=0),i?p=Math.min(i*n+r,e.length):p=e.length,o=r;o<p;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,l),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const zw=[0,0,0];let $1;class An extends $z{static get ZERO(){return $1||($1=new An(0,0,0),Object.freeze($1)),$1}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&pf(e)?this.copy(e):(zo.debug&&(qr(e),qr(n),qr(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return zo.debug&&(qr(e.x),qr(e.y),qr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=qr(e)}angle(e){return Fre(this,e)}cross(e){return Ny(this,this,e),this.check()}rotateX({radians:e,origin:n=zw}){return Bre(this,this,n,e),this.check()}rotateY({radians:e,origin:n=zw}){return zre(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=zw}){return Ore(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return CS(this,this,e),this.check()}transformAsVector(e){return Hz(this,this,e),this.check()}transformByMatrix3(e){return Zz(this,this,e),this.check()}transformByMatrix2(e){return Sre(this,this,e),this.check()}transformByQuaternion(e){return Yz(this,this,e),this.check()}}let j1;class MS extends $z{static get ZERO(){return j1||(j1=new MS(0,0,0,0),Object.freeze(j1)),j1}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),pf(e)&&arguments.length===1?this.copy(e):(zo.debug&&(qr(e),qr(n),qr(r),qr(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return zo.debug&&(qr(e.x),qr(e.y),qr(e.z),qr(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=qr(e)}get w(){return this[3]}set w(e){this[3]=qr(e)}transform(e){return CS(this,this,e),this.check()}transformByMatrix3(e){return Wz(this,this,e),this.check()}transformByMatrix2(e){return Cre(this,this,e),this.check()}transformByQuaternion(e){return Yz(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class Jz extends SS{toString(){let e="[";if(zo.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=qr(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function Ure(){var t=new fA(9);return fA!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Vre(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Gre(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],o=e[5],p=e[6],v=e[7],S=e[8],M=S*l-o*v,k=-S*s+o*p,F=v*s-l*p,H=n*M+r*k+i*F;return H?(H=1/H,t[0]=M*H,t[1]=(-S*r+i*v)*H,t[2]=(o*r-i*l)*H,t[3]=k*H,t[4]=(S*n-i*p)*H,t[5]=(-o*n+i*s)*H,t[6]=F*H,t[7]=(-v*n+r*p)*H,t[8]=(l*n-r*s)*H,t):null}function $re(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],l=t[5],o=t[6],p=t[7],v=t[8];return e*(v*s-l*p)+n*(-v*i+l*o)+r*(p*i-s*o)}function Gk(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],v=e[6],S=e[7],M=e[8],k=n[0],F=n[1],H=n[2],j=n[3],ie=n[4],Y=n[5],J=n[6],se=n[7],ce=n[8];return t[0]=k*r+F*l+H*v,t[1]=k*i+F*o+H*S,t[2]=k*s+F*p+H*M,t[3]=j*r+ie*l+Y*v,t[4]=j*i+ie*o+Y*S,t[5]=j*s+ie*p+Y*M,t[6]=J*r+se*l+ce*v,t[7]=J*i+se*o+ce*S,t[8]=J*s+se*p+ce*M,t}function jre(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],v=e[6],S=e[7],M=e[8],k=n[0],F=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=l,t[4]=o,t[5]=p,t[6]=k*r+F*l+v,t[7]=k*i+F*o+S,t[8]=k*s+F*p+M,t}function Hre(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],v=e[6],S=e[7],M=e[8],k=Math.sin(n),F=Math.cos(n);return t[0]=F*r+k*l,t[1]=F*i+k*o,t[2]=F*s+k*p,t[3]=F*l-k*r,t[4]=F*o-k*i,t[5]=F*p-k*s,t[6]=v,t[7]=S,t[8]=M,t}function $k(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Wre(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n+n,o=r+r,p=i+i,v=n*l,S=r*l,M=r*o,k=i*l,F=i*o,H=i*p,j=s*l,ie=s*o,Y=s*p;return t[0]=1-M-H,t[3]=S-Y,t[6]=k+ie,t[1]=S+Y,t[4]=1-v-H,t[7]=F-j,t[2]=k-ie,t[5]=F+j,t[8]=1-v-M,t}var W3;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(W3||(W3={}));const Qre=Object.freeze([1,0,0,0,1,0,0,0,1]);class zs extends Jz{static get IDENTITY(){return Zre()}static get ZERO(){return qre()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return W3}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(Qre)}fromObject(e){return this.check()}fromQuaternion(e){return Wre(this,e),this.check()}set(e,n,r,i,s,l,o,p,v){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=l,this[6]=o,this[7]=p,this[8]=v,this.check()}setRowMajor(e,n,r,i,s,l,o,p,v){return this[0]=e,this[1]=i,this[2]=o,this[3]=n,this[4]=s,this[5]=p,this[6]=r,this[7]=l,this[8]=v,this.check()}determinant(){return $re(this)}transpose(){return Vre(this,this),this.check()}invert(){return Gre(this,this),this.check()}multiplyLeft(e){return Gk(this,e,this),this.check()}multiplyRight(e){return Gk(this,this,e),this.check()}rotate(e){return Hre(this,this,e),this.check()}scale(e){return Array.isArray(e)?$k(this,this,e):$k(this,this,[e,e]),this.check()}translate(e){return jre(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=wre(n||[-0,-0],e,this);break;case 3:r=Zz(n||[-0,-0,-0],e,this);break;case 4:r=Wz(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return pg(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let H1,W1;function qre(){return H1||(H1=new zs([0,0,0,0,0,0,0,0,0]),Object.freeze(H1)),H1}function Zre(){return W1||(W1=new zs,Object.freeze(W1)),W1}function Yre(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Xre(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],l=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=l,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Q3(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],o=e[5],p=e[6],v=e[7],S=e[8],M=e[9],k=e[10],F=e[11],H=e[12],j=e[13],ie=e[14],Y=e[15],J=n*o-r*l,se=n*p-i*l,ce=n*v-s*l,me=r*p-i*o,Ee=r*v-s*o,He=i*v-s*p,Qe=S*j-M*H,Ye=S*ie-k*H,nt=S*Y-F*H,Fe=M*ie-k*j,tt=M*Y-F*j,Ze=k*Y-F*ie,pt=J*Ze-se*tt+ce*Fe+me*nt-Ee*Ye+He*Qe;return pt?(pt=1/pt,t[0]=(o*Ze-p*tt+v*Fe)*pt,t[1]=(i*tt-r*Ze-s*Fe)*pt,t[2]=(j*He-ie*Ee+Y*me)*pt,t[3]=(k*Ee-M*He-F*me)*pt,t[4]=(p*nt-l*Ze-v*Ye)*pt,t[5]=(n*Ze-i*nt+s*Ye)*pt,t[6]=(ie*ce-H*He-Y*se)*pt,t[7]=(S*He-k*ce+F*se)*pt,t[8]=(l*tt-o*nt+v*Qe)*pt,t[9]=(r*nt-n*tt-s*Qe)*pt,t[10]=(H*Ee-j*ce+Y*J)*pt,t[11]=(M*ce-S*Ee-F*J)*pt,t[12]=(o*Ye-l*Fe-p*Qe)*pt,t[13]=(n*Fe-r*Ye+i*Qe)*pt,t[14]=(j*se-H*me-ie*J)*pt,t[15]=(S*me-M*se+k*J)*pt,t):null}function Kre(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],l=t[5],o=t[6],p=t[7],v=t[8],S=t[9],M=t[10],k=t[11],F=t[12],H=t[13],j=t[14],ie=t[15],Y=e*l-n*s,J=e*o-r*s,se=e*p-i*s,ce=n*o-r*l,me=n*p-i*l,Ee=r*p-i*o,He=v*H-S*F,Qe=v*j-M*F,Ye=v*ie-k*F,nt=S*j-M*H,Fe=S*ie-k*H,tt=M*ie-k*j;return Y*tt-J*Fe+se*nt+ce*Ye-me*Qe+Ee*He}function ef(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],p=e[5],v=e[6],S=e[7],M=e[8],k=e[9],F=e[10],H=e[11],j=e[12],ie=e[13],Y=e[14],J=e[15],se=n[0],ce=n[1],me=n[2],Ee=n[3];return t[0]=se*r+ce*o+me*M+Ee*j,t[1]=se*i+ce*p+me*k+Ee*ie,t[2]=se*s+ce*v+me*F+Ee*Y,t[3]=se*l+ce*S+me*H+Ee*J,se=n[4],ce=n[5],me=n[6],Ee=n[7],t[4]=se*r+ce*o+me*M+Ee*j,t[5]=se*i+ce*p+me*k+Ee*ie,t[6]=se*s+ce*v+me*F+Ee*Y,t[7]=se*l+ce*S+me*H+Ee*J,se=n[8],ce=n[9],me=n[10],Ee=n[11],t[8]=se*r+ce*o+me*M+Ee*j,t[9]=se*i+ce*p+me*k+Ee*ie,t[10]=se*s+ce*v+me*F+Ee*Y,t[11]=se*l+ce*S+me*H+Ee*J,se=n[12],ce=n[13],me=n[14],Ee=n[15],t[12]=se*r+ce*o+me*M+Ee*j,t[13]=se*i+ce*p+me*k+Ee*ie,t[14]=se*s+ce*v+me*F+Ee*Y,t[15]=se*l+ce*S+me*H+Ee*J,t}function n2(t,e,n){var r=n[0],i=n[1],s=n[2],l,o,p,v,S,M,k,F,H,j,ie,Y;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(l=e[0],o=e[1],p=e[2],v=e[3],S=e[4],M=e[5],k=e[6],F=e[7],H=e[8],j=e[9],ie=e[10],Y=e[11],t[0]=l,t[1]=o,t[2]=p,t[3]=v,t[4]=S,t[5]=M,t[6]=k,t[7]=F,t[8]=H,t[9]=j,t[10]=ie,t[11]=Y,t[12]=l*r+S*i+H*s+e[12],t[13]=o*r+M*i+j*s+e[13],t[14]=p*r+k*i+ie*s+e[14],t[15]=v*r+F*i+Y*s+e[15]),t}function PS(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Jre(t,e,n,r){var i=r[0],s=r[1],l=r[2],o=Math.hypot(i,s,l),p,v,S,M,k,F,H,j,ie,Y,J,se,ce,me,Ee,He,Qe,Ye,nt,Fe,tt,Ze,pt,Yt;return o<gg?null:(o=1/o,i*=o,s*=o,l*=o,p=Math.sin(n),v=Math.cos(n),S=1-v,M=e[0],k=e[1],F=e[2],H=e[3],j=e[4],ie=e[5],Y=e[6],J=e[7],se=e[8],ce=e[9],me=e[10],Ee=e[11],He=i*i*S+v,Qe=s*i*S+l*p,Ye=l*i*S-s*p,nt=i*s*S-l*p,Fe=s*s*S+v,tt=l*s*S+i*p,Ze=i*l*S+s*p,pt=s*l*S-i*p,Yt=l*l*S+v,t[0]=M*He+j*Qe+se*Ye,t[1]=k*He+ie*Qe+ce*Ye,t[2]=F*He+Y*Qe+me*Ye,t[3]=H*He+J*Qe+Ee*Ye,t[4]=M*nt+j*Fe+se*tt,t[5]=k*nt+ie*Fe+ce*tt,t[6]=F*nt+Y*Fe+me*tt,t[7]=H*nt+J*Fe+Ee*tt,t[8]=M*Ze+j*pt+se*Yt,t[9]=k*Ze+ie*pt+ce*Yt,t[10]=F*Ze+Y*pt+me*Yt,t[11]=H*Ze+J*pt+Ee*Yt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function eO(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],l=e[5],o=e[6],p=e[7],v=e[8],S=e[9],M=e[10],k=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+v*r,t[5]=l*i+S*r,t[6]=o*i+M*r,t[7]=p*i+k*r,t[8]=v*i-s*r,t[9]=S*i-l*r,t[10]=M*i-o*r,t[11]=k*i-p*r,t}function eie(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],l=e[1],o=e[2],p=e[3],v=e[8],S=e[9],M=e[10],k=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-v*r,t[1]=l*i-S*r,t[2]=o*i-M*r,t[3]=p*i-k*r,t[8]=s*r+v*i,t[9]=l*r+S*i,t[10]=o*r+M*i,t[11]=p*r+k*i,t}function tO(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],l=e[1],o=e[2],p=e[3],v=e[4],S=e[5],M=e[6],k=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+v*r,t[1]=l*i+S*r,t[2]=o*i+M*r,t[3]=p*i+k*r,t[4]=v*i-s*r,t[5]=S*i-l*r,t[6]=M*i-o*r,t[7]=k*i-p*r,t}function tie(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],l=e[5],o=e[6],p=e[8],v=e[9],S=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,l,o),t[2]=Math.hypot(p,v,S),t}function nie(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n+n,o=r+r,p=i+i,v=n*l,S=r*l,M=r*o,k=i*l,F=i*o,H=i*p,j=s*l,ie=s*o,Y=s*p;return t[0]=1-M-H,t[1]=S+Y,t[2]=k-ie,t[3]=0,t[4]=S-Y,t[5]=1-v-H,t[6]=F+j,t[7]=0,t[8]=k+ie,t[9]=F-j,t[10]=1-v-M,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rie(t,e,n,r,i,s,l){var o=1/(n-e),p=1/(i-r),v=1/(s-l);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*p,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*p,t[10]=(l+s)*v,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*s*2*v,t[15]=0,t}function iie(t,e,n,r,i){var s=1/Math.tan(e/2),l;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(l=1/(r-i),t[10]=(i+r)*l,t[14]=2*i*r*l):(t[10]=-1,t[14]=-2*r),t}var sie=iie;function oie(t,e,n,r,i,s,l){var o=1/(e-n),p=1/(r-i),v=1/(s-l);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*p,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*v,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*p,t[14]=(l+s)*v,t[15]=1,t}var aie=oie;function lie(t,e,n,r){var i,s,l,o,p,v,S,M,k,F,H=e[0],j=e[1],ie=e[2],Y=r[0],J=r[1],se=r[2],ce=n[0],me=n[1],Ee=n[2];return Math.abs(H-ce)<gg&&Math.abs(j-me)<gg&&Math.abs(ie-Ee)<gg?Yre(t):(S=H-ce,M=j-me,k=ie-Ee,F=1/Math.hypot(S,M,k),S*=F,M*=F,k*=F,i=J*k-se*M,s=se*S-Y*k,l=Y*M-J*S,F=Math.hypot(i,s,l),F?(F=1/F,i*=F,s*=F,l*=F):(i=0,s=0,l=0),o=M*l-k*s,p=k*i-S*l,v=S*s-M*i,F=Math.hypot(o,p,v),F?(F=1/F,o*=F,p*=F,v*=F):(o=0,p=0,v=0),t[0]=i,t[1]=o,t[2]=S,t[3]=0,t[4]=s,t[5]=p,t[6]=M,t[7]=0,t[8]=l,t[9]=v,t[10]=k,t[11]=0,t[12]=-(i*H+s*j+l*ie),t[13]=-(o*H+p*j+v*ie),t[14]=-(S*H+M*j+k*ie),t[15]=1,t)}function Aie(){var t=new fA(4);return fA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function uie(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function kS(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function cie(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function hie(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function fie(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n*n+r*r+i*i+s*s;return l>0&&(l=1/Math.sqrt(l)),t[0]=n*l,t[1]=r*l,t[2]=i*l,t[3]=s*l,t}function die(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function pie(t,e,n,r){var i=e[0],s=e[1],l=e[2],o=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=l+r*(n[2]-l),t[3]=o+r*(n[3]-o),t}function Od(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*l,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*l,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*l,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*l,t}function gie(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[0],o=n[1],p=n[2],v=n[3],S=v*r+o*s-p*i,M=v*i+p*r-l*s,k=v*s+l*i-o*r,F=-l*r-o*i-p*s;return t[0]=S*v+F*-l+M*-p-k*-o,t[1]=M*v+F*-o+k*-l-S*-p,t[2]=k*v+F*-p+S*-o-M*-l,t[3]=e[3],t}(function(){var t=Aie();return function(e,n,r,i,s,l){var o,p;for(n||(n=4),r||(r=0),i?p=Math.min(i*n+r,e.length):p=e.length,o=r;o<p;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,l),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var q3;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(q3||(q3={}));const mie=45*Math.PI/180,yie=1,Ow=.1,Fw=500,_ie=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ca extends Jz{static get IDENTITY(){return xie()}static get ZERO(){return vie()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return q3}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,l,o,p,v,S,M,k,F,H,j,ie){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=l,this[6]=o,this[7]=p,this[8]=v,this[9]=S,this[10]=M,this[11]=k,this[12]=F,this[13]=H,this[14]=j,this[15]=ie,this.check()}setRowMajor(e,n,r,i,s,l,o,p,v,S,M,k,F,H,j,ie){return this[0]=e,this[1]=s,this[2]=v,this[3]=F,this[4]=n,this[5]=l,this[6]=S,this[7]=H,this[8]=r,this[9]=o,this[10]=M,this[11]=j,this[12]=i,this[13]=p,this[14]=k,this[15]=ie,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(_ie)}fromObject(e){return this.check()}fromQuaternion(e){return nie(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:l=Ow,far:o=Fw}=e;return o===1/0?wie(this,n,r,i,s,l):rie(this,n,r,i,s,l,o),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return lie(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:l=Ow,far:o=Fw}=e;return aie(this,n,r,i,s,l,o),this.check()}orthographic(e){const{fovy:n=mie,aspect:r=yie,focalDistance:i=1,near:s=Ow,far:l=Fw}=e;jk(n);const o=n/2,p=i*Math.tan(o),v=p*r;return this.ortho({left:-v,right:v,bottom:-p,top:p,near:s,far:l})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return jk(n),sie(this,n,r,i,s),this.check()}determinant(){return Kre(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*l,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*l,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*l,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*l,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*l,e}transpose(){return Xre(this,this),this.check()}invert(){return Q3(this,this),this.check()}multiplyLeft(e){return ef(this,e,this),this.check()}multiplyRight(e){return ef(this,this,e),this.check()}rotateX(e){return eO(this,this,e),this.check()}rotateY(e){return eie(this,this,e),this.check()}rotateZ(e){return tO(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Jre(this,this,e,n),this.check()}scale(e){return PS(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return n2(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Od(n||[-0,-0,-0,-0],e,this),pg(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=bre(n||[-0,-0],e,this);break;case 3:i=CS(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return pg(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=Tre(n||[-0,-0],e,this);break;case 3:r=Hz(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return pg(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Q1,q1;function vie(){return Q1||(Q1=new ca([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Q1)),Q1}function xie(){return q1||(q1=new ca,Object.freeze(q1)),q1}function jk(t){if(t>Math.PI*2)throw Error("expected radians")}function wie(t,e,n,r,i,s){const l=2*s/(n-e),o=2*s/(i-r),p=(n+e)/(n-e),v=(i+r)/(i-r),S=-1,M=-1,k=-2*s;return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=p,t[9]=v,t[10]=S,t[11]=M,t[12]=0,t[13]=0,t[14]=k,t[15]=0,t}function Hk(){var t=new fA(4);return fA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function bie(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function nO(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Wk(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=n[0],p=n[1],v=n[2],S=n[3];return t[0]=r*S+l*o+i*v-s*p,t[1]=i*S+l*p+s*o-r*v,t[2]=s*S+l*v+r*p-i*o,t[3]=l*S-r*o-i*p-s*v,t}function Eie(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],o=Math.sin(n),p=Math.cos(n);return t[0]=r*p+l*o,t[1]=i*p+s*o,t[2]=s*p-i*o,t[3]=l*p-r*o,t}function Tie(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],o=Math.sin(n),p=Math.cos(n);return t[0]=r*p-s*o,t[1]=i*p+l*o,t[2]=s*p+r*o,t[3]=l*p-i*o,t}function Sie(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],l=e[3],o=Math.sin(n),p=Math.cos(n);return t[0]=r*p+i*o,t[1]=i*p-r*o,t[2]=s*p+l*o,t[3]=l*p-s*o,t}function Cie(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function Uy(t,e,n,r){var i=e[0],s=e[1],l=e[2],o=e[3],p=n[0],v=n[1],S=n[2],M=n[3],k,F,H,j,ie;return F=i*p+s*v+l*S+o*M,F<0&&(F=-F,p=-p,v=-v,S=-S,M=-M),1-F>gg?(k=Math.acos(F),H=Math.sin(k),j=Math.sin((1-r)*k)/H,ie=Math.sin(r*k)/H):(j=1-r,ie=r),t[0]=j*i+ie*p,t[1]=j*s+ie*v,t[2]=j*l+ie*S,t[3]=j*o+ie*M,t}function Mie(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n*n+r*r+i*i+s*s,o=l?1/l:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-i*o,t[3]=s*o,t}function Pie(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function rO(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,l=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[l*3+l]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+l]-e[l*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[l]=(e[l*3+i]+e[i*3+l])*r}return t}var kie=uie,Iie=kS,Lie=die,Die=pie,Rie=cie,Bie=hie,iO=fie,zie=function(){var t=Qz(),e=Vk(1,0,0),n=Vk(0,1,0);return function(r,i,s){var l=qz(i,s);return l<-.999999?(Ny(t,e,i),Kz(t)<1e-6&&Ny(t,n,i),Dre(t,t),nO(r,t,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Ny(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+l,iO(r,r))}}();(function(){var t=Hk(),e=Hk();return function(n,r,i,s,l,o){return Uy(t,r,l,o),Uy(e,i,s,o),Uy(n,t,e,2*o*(1-o)),n}})();(function(){var t=Ure();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],iO(e,rO(e,t))}})();const Oie=[0,0,0,1];class Qk extends SS{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return rO(this,e),this.check()}fromAxisRotation(e,n){return nO(this,e,n),this.check()}identity(){return bie(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=qr(e)}get y(){return this[1]}set y(e){this[1]=qr(e)}get z(){return this[2]}set z(e){this[2]=qr(e)}get w(){return this[3]}set w(e){this[3]=qr(e)}len(){return Rie(this)}lengthSquared(){return Bie(this)}dot(e){return Lie(this,e)}rotationTo(e,n){return zie(this,e,n),this.check()}add(e){return kie(this,this,e),this.check()}calculateW(){return Cie(this,this),this.check()}conjugate(){return Pie(this,this),this.check()}invert(){return Mie(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(Die(this,e,n,r),this.check())}multiplyRight(e){return Wk(this,this,e),this.check()}multiplyLeft(e){return Wk(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return Eie(this,this,e),this.check()}rotateY(e){return Tie(this,this,e),this.check()}rotateZ(e){return Sie(this,this,e),this.check()}scale(e){return Iie(this,this,e),this.check()}slerp(e,n,r){let i,s,l;switch(arguments.length){case 1:({start:i=Oie,target:s,ratio:l}=e);break;case 2:i=this,s=e,l=n;break;default:i=e,s=n,l=r}return Uy(this,i,s,l),this.check()}transformVector4(e,n=new MS){return gie(n,e,this),pg(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const sO={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},qk=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,Fie={lightSources:{}};function Nw(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function Nie(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=Nw(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,l)=>{i["lighting_uPointLight[".concat(l,"].color")]=Nw(s),i["lighting_uPointLight[".concat(l,"].position")]=s.position,i["lighting_uPointLight[".concat(l,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,l)=>{i["lighting_uDirectionalLight[".concat(l,"].color")]=Nw(s),i["lighting_uDirectionalLight[".concat(l,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function oO(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fie;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},Nie({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return oO({lightSources:e})}return{}}const aO={name:"lights",vs:qk,fs:qk,getUniforms:oO,defines:{MAX_LIGHTS:3}},Uie=new Uint8Array([0,255,255,255]),Vie={pickingSelectedColor:null,pickingHighlightColor:Uie,pickingActive:!1,pickingAttribute:!1};function Gie(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Vie;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const $ie=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,jie=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,Hie={name:"picking",vs:$ie,fs:jie,getUniforms:Gie},lO=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,Wie={};function Qie(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function AO(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Wie;if(!("material"in t))return{};const{material:e}=t;return e?Qie(e):{lighting_uEnabled:!1}}const qie={name:"gouraud-lighting",dependencies:[aO],vs:lO,defines:{LIGHTING_VERTEX:1},getUniforms:AO},Zie={name:"phong-lighting",dependencies:[aO],fs:lO,defines:{LIGHTING_FRAGMENT:1},getUniforms:AO},Yie=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,Xie={name:"transform",vs:Yie,fs:null};class Dm{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Dm(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:l=[],bufferMode:o=35981,transpileToGLSL100:p=!1}=e,v=this._getModuleList(e.modules),S=this._getHash(n),M=this._getHash(r),k=v.map(se=>this._getHash(se.name)).sort(),F=l.map(se=>this._getHash(se)),H=Object.keys(i).sort(),j=Object.keys(s).sort(),ie=[],Y=[];for(const se of H)ie.push(this._getHash(se)),ie.push(this._getHash(i[se]));for(const se of j)Y.push(this._getHash(se)),Y.push(this._getHash(s[se]));const J="".concat(S,"/").concat(M,"D").concat(ie.join("/"),"M").concat(k.join("/"),"I").concat(Y.join("/"),"V").concat(F.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(p?"T":"");if(!this._programCache[J]){const se=Xne(this.gl,{vs:n,fs:r,modules:v,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:p});this._programCache[J]=new Dz(this.gl,{hash:J,vs:se.vs,fs:se.fs,varyings:l,bufferMode:o}),this._getUniforms[J]=se.getUniforms||(ce=>{}),this._useCounts[J]=0}return this._useCounts[J]++,this._programCache[J]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,l=this._defaultModules.length;s<l;++s){const o=this._defaultModules[s],p=o.name;n[i++]=o,r[p]=!0}for(let s=0,l=e.length;s<l;++s){const o=e[s],p=o.name;r[p]||(n[i++]=o,r[p]=!0)}return n.length=i,n}}const Kie={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Jie(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const l=e.attributes[s],o=ese(s,n);if(s==="indices")i=l;else if(l.constant)r[o]=l.value;else{const p=l.value,v={...l};delete v.value,r[o]=[new $r(t,p),v],tse(s,v)}}if(i){const s=i.value||i;nn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const l={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new $r(t,{data:s,target:34963}),l]}return r}function ese(t,e){const{attributeMap:n=Kie}=e||{};return n&&n[t]||t}function tse(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}nn(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const A0=2,nse=1e4,rse="Model needs drawMode and vertexCount",Zk=()=>{},ise={};class ac{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=mh("model")}=n;nn(uv(e)),this.id=r,this.gl=e,this.id=n.id||mh("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Dm.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:v,transpileToGLSL100:S}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:v,transpileToGLSL100:S},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},nn(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),rse)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:v,transpileToGLSL100:S}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:p,bufferMode:v,transpileToGLSL100:S},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return nn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return nn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=Jie(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(xd(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return xS(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:l=this.transformFeedback,parameters:o={},vertexArray:p=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let v;vn.priority>=A0&&(v=this._logDrawCallStart(A0));const S=this.vertexArray.getDrawParams(),{isIndexed:M=S.isIndexed,indexType:k=S.indexType,indexOffset:F=S.indexOffset,vertexArrayInstanced:H=S.isInstanced}=this.props;H&&!this.isInstanced&&vn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:j,instanceCount:ie}=this,{onBeforeRender:Y=Zk,onAfterRender:J=Zk}=this.props;Y(),this.program.setUniforms(this.uniforms);const se=this.program.draw(Object.assign(ise,e,{logPriority:v,uniforms:null,framebuffer:r,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:p,transformFeedback:l,isIndexed:M,indexType:k,isInstanced:j,instanceCount:ie,offset:M?F:0}));return J(),vn.priority>=A0&&this._logDrawCallEnd(v,p,r),se}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{35977:n})),i.forEach(l=>l.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(l=>l.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return vn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:l,defines:o,varyings:p,bufferMode:v,transpileToGLSL100:S}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:l,defines:o,varyings:p,bufferMode:v,transpileToGLSL100:S}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}nn(n instanceof Dz,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new une(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof $r&&n.delete()}}_setAnimationProps(e){this.animated&&nn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(xd(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new Rz(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:nse;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),vn.group(A0,">>> DRAWING MODEL ".concat(this.id),{collapsed:vn.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=fne({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:l,unusedTable:o,unusedCount:p}=kk({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:v,count:S}=kk({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});S>0&&vn.log("MISSING UNIFORMS",Object.keys(v))(),p>0&&vn.log("UNUSED UNIFORMS",Object.keys(o))();const M=pne(this.vertexArray.configuration);vn.table(e,s)(),vn.table(e,l)(),vn.table(e+1,M)(),i&&i.log({logLevel:A0,message:"Rendered to ".concat(i.id)}),vn.groupEnd(A0)()}}class sse{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof $r?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&nn(cr(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const l=n[s],{byteLength:o,usage:p,accessor:v}=l;r[i]=this._createNewBuffer(i,{byteLength:o,usage:p,accessor:v})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new Rz(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],nn(r[s]instanceof $r)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new $r(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const ose="transform_uSampler_",r2="transform_uSize_",Yk="transform_position";function ase(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,l=Object.keys(n).length,o=null;const p={};let v=e,S={};if(l>0||r){const M=v.split(`
`),k=M.slice();if(M.forEach((F,H,j)=>{if(l>0){const ie=hse(F,n);if(ie){const{updatedLine:Y,inject:J}=ie;k[H]=Y,S=G3([S,J]),Object.assign(p,ie.samplerTextureMap),l--}}r&&!o&&(o=cse(F,r))}),r){nn(i);const F="".concat(r2).concat(r),H="uniform vec2 ".concat(F,`;
`),j="     vec2 ".concat(Yk," = transform_getPos(").concat(F,`);
     gl_Position = vec4(`).concat(Yk,`, 0, 1.);
`);S=G3([S,{"vs:#decl":H,"vs:#main-start":j}])}v=k.join(`
`)}return{vs:v,targetTextureType:o,inject:S,samplerTextureMap:p}}function lse(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,l;n&&({width:s,height:l}=r,i["".concat(r2).concat(n)]=[s,l]);for(const o in e)({width:s,height:l}=e[o]),i["".concat(r2).concat(o)]=[s,l];return i}function Ase(t){return Vz(t,["attribute","in"])}function use(t){const e="".concat(ose).concat(t),n="".concat(r2).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function cse(t,e){const n=Vz(t,["varying","out"]);return n&&n.name===e?n.type:null}function hse(t,e){const n={},r=Ase(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const l="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:p,uniformDeclerations:v}=use(s),S=ore(i),M="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(p,").").concat(S,`;
`);return n[o]=s,{updatedLine:l,inject:{"vs:#decl":v,"vs:#main-start":M},samplerTextureMap:n}}return null}const fse={10241:9728,10240:9728,10242:33071,10243:33071},dse="transform_output";class pse{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],l=Object.assign({},n,e.attributes),o=Object.assign({},e.uniforms),p=Object.assign({},e.parameters);let v=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){l.transform_elementID=this.elementIDBuffer;for(const M in this.samplerTextureMap){const k=this.samplerTextureMap[M];o[M]=r[k]}this._setSourceTextureParameters();const S=lse({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,S)}return this.hasTargetTexture&&(v=!1,p.viewport=[0,0,i.width,i.height]),{attributes:l,framebuffer:i,uniforms:o,discard:v,parameters:p}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=hv(n);if(!e)return r;const i=r.constructor,s=are(this.targetTextureType),l=new i(r.length*s/4);let o=0;for(let p=0;p<r.length;p+=4)for(let v=0;v<s;v++)l[o++]=r[p+v];return l}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof da)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new $r(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:l,height:o}=s,{framebuffer:p}=e;p?(p.update({attachments:{36064:s},resizeAttachments:!1}),p.resize({width:l,height:o})):e.framebuffer=new os(this.gl,{id:"transform-framebuffer",width:l,height:o,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(fse)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=Jee(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:l,inject:o,samplerTextureMap:p}=ase({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),v=G3([e.inject||{},o]);this.targetTextureType=l,this.samplerTextureMap=p;const S=e._fs||Gz({version:Iz(i),input:this.targetTextureVarying,inputType:l,output:dse}),M=this.hasSourceTextures||this.targetTextureVarying?[Xie].concat(e.modules||[]):e.modules;return{vs:i,fs:S,modules:M,uniforms:s,inject:v}}}let IS=class{static isSupported(e){return cr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();nn(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new ac(n,Object.assign({},e,{fs:e.fs||Gz({version:Iz(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){gse(n)&&(this.bufferTransform=new sse(e,n)),mse(n)&&(this.textureTransform=new pse(e,n)),nn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}};function gse(t){return!!(!xd(t.feedbackBuffers)||!xd(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function mse(t){return!!(!xd(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const Xk={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Zu{static get DRAW_MODE(){return Xk}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=mh("geometry"),drawMode:r=Xk.TRIANGLES,attributes:i={},indices:s=null,vertexCount:l=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=l||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,nn(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(nn(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:l,size:o,constant:p}=s;!p&&l&&o>=1&&(r=Math.min(r,l.length/o))}return nn(Number.isFinite(r)),r}}let yse=1,_se=1;class uO{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,l=yse++,o={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(l,o),l}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:l}=i;s.setTime(this.getTime(l))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=_se++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const vse=[255,255,255],xse=1;let wse=0;class cO{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","ambient");const{color:n=vse}=e,{intensity:r=xse}=e;this.id=e.id||"ambient-".concat(wse++),this.color=n,this.intensity=r}}const bse=[255,255,255],Ese=1,Tse=[0,0,-1];let Sse=0;class Z3{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","directional"),oe(this,"direction",void 0),oe(this,"shadow",void 0);const{color:n=bse}=e,{intensity:r=Ese}=e,{direction:i=Tse}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(Sse++),this.color=n,this.intensity=r,this.type="directional",this.direction=new An(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class Cse{constructor(e,n={id:"pass"}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class LS extends Cse{constructor(...e){super(...e),oe(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return oc(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:l,clearStack:o=!0,clearCanvas:p=!0}=e;e.pass=e.pass||"unknown";const v=this.gl;p&&Pse(v,n),o&&(this._lastRenderIndex=-1);const S=[];for(const M of i){const k=s&&s[M.id];l?.(M);const F=this._getDrawLayerParams(M,e),H=M.subViewports||[M];for(const j of H){const ie=this._drawLayersInViewport(v,{target:n,moduleParameters:r,viewport:j,view:k,pass:e.pass,layers:e.layers},F);S.push(ie)}}return S}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:l,effects:o,moduleParameters:p},v=!1){const S=[],M=hO(this._lastRenderIndex+1),k={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:l},F={};for(let H=0;H<n.length;H++){const j=n[H],ie=this._shouldDrawLayer(j,k,s,F),Y={shouldDrawLayer:ie};ie&&!v&&(Y.layerRenderIndex=M(j,ie),Y.moduleParameters=this._getModuleParameters(j,o,r,p),Y.layerParameters=this.getLayerParameters(j,H,e)),S[H]=Y}return S}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:l,view:o},p){const v=Mse(e,{moduleParameters:r,target:s,viewport:l});if(o&&o.props.clear){const M=o.props.clear===!0?{color:!0,depth:!0}:o.props.clear;cA(e,{scissorTest:!0,scissor:v},()=>xS(e,M))}const S={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};oc(e,{viewport:v});for(let M=0;M<n.length;M++){const k=n[M],{shouldDrawLayer:F,layerRenderIndex:H,moduleParameters:j,layerParameters:ie}=p[M];if(F&&k.props.pickable&&S.pickableCount++,k.isComposite)S.compositeCount++;else if(F){S.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,H),j.viewport=l;try{k._drawLayer({moduleParameters:j,uniforms:{layerIndex:H},parameters:ie})}catch(Y){k.raiseError(Y,"drawing ".concat(k," to ").concat(i))}}}return S}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let l=e.parent;for(;l;){if(!l.props.visible||!l.filterSubLayer(n))return!1;n.layer=l,l=l.parent}if(r){const o=n.layer.id;if(o in i||(i[o]=r(n)),!i[o])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const l=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:vd(this.gl)});if(n)for(const p of n){var o;Object.assign(l,(o=p.getModuleParameters)===null||o===void 0?void 0:o.call(p,e))}return Object.assign(l,this.getModuleParameters(e,n),i)}}function hO(t=0,e={}){const n={},r=(i,s)=>{const l=i.props._offset,o=i.id,p=i.parent&&i.parent.id;let v;if(p&&!(p in e)&&r(i.parent,!1),p in n){const S=n[p]=n[p]||hO(e[p],e);v=S(i,s),n[o]=S}else Number.isFinite(l)?(v=l+(e[p]||0),n[o]=null):v=t;return s&&v>=t&&(t=v+1),e[o]=v,v};return r}function Mse(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||vd(t),l=i?n.height:t.drawingBufferHeight,o=r;return[o.x*s,l-(o.y+o.height)*s,o.width*s,o.height*s]}function Pse(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;oc(t,{viewport:[0,0,n,r]}),t.clear(16640)}class kse extends LS{constructor(e,n){super(e,n),oe(this,"shadowMap",void 0),oe(this,"depthBuffer",void 0),oe(this,"fbo",void 0),this.shadowMap=new da(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new I0(e,{format:33189,width:1,height:1}),this.fbo=new os(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;cA(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=vd(this.gl),s=r.width*i,l=r.height*i;(s!==n.width||l!==n.height)&&n.resize({width:s,height:l}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const fO="#define SMOOTH_EDGE_RADIUS 0.5",Ise=`
`.concat(fO,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),Lse=`
`.concat(fO,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),Dse={name:"geometry",vs:Ise,fs:Lse},Rse=Object.keys(Ar).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Ar[t],";")).join(""),Bse=Object.keys(rA).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(rA[t],";")).join(""),zse=Object.keys(ff).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(ff[t],";")).join(""),Ose="".concat(Rse,`
`).concat(Bse,`
`).concat(zse,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function Fse(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Rm(t){let e={},n;return r=>{for(const i in r)if(!Fse(r[i],e[i])){n=t(r),e=r;break}return n}}const Kk=[0,0,0,0],Nse=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],dO=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Use=[0,0,0],pO=[0,0,0],Vse=Rm(jse);function gO(t,e,n=pO){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===Ar.LNGLAT_OFFSETS||e===Ar.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case rA.WEB_MERCATOR:(e===Ar.LNGLAT||e===Ar.CARTESIAN)&&(i=[0,0,0],s=!1);break;case rA.WEB_MERCATOR_AUTO_OFFSET:e===Ar.LNGLAT?r=i:e===Ar.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case rA.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case rA.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function Gse(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:l}=t,o=Kk,p=Kk,v=t.cameraPosition;const{geospatialOrigin:S,shaderCoordinateOrigin:M,offsetMode:k}=gO(t,e,n);return k&&(p=t.projectPosition(S||M),v=[v[0]-p[0],v[1]-p[1],v[2]-p[2]],p[3]=1,o=Od([],p,l),s=r||s,l=ef([],i,s),l=ef([],l,Nse)),{viewMatrix:s,viewProjectionMatrix:l,projectionCenter:o,originCommon:p,cameraPosCommon:v,shaderCoordinateOrigin:M,geospatialOrigin:S}}function $se({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Ar.DEFAULT,coordinateOrigin:i=pO,autoWrapLongitude:s=!1}){r===Ar.DEFAULT&&(r=t.isGeospatial?Ar.LNGLAT:Ar.CARTESIAN);const l=Vse({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return l.project_uWrapLongitude=s,l.project_uModelMatrix=n||dO,l}function jse({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:l,cameraPosCommon:o,shaderCoordinateOrigin:p,geospatialOrigin:v}=Gse(t,n,r),S=t.getDistanceScales(),M=[t.width*e,t.height*e],k=Od([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,F={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:p,project_uCommonOrigin:l.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:M,project_uDevicePixelRatio:e,project_uFocalDistance:k,project_uCommonUnitsPerMeter:S.unitsPerMeter,project_uCommonUnitsPerWorldUnit:S.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Use,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:dO,project_uCameraPosition:o};if(v){const H=t.getDistanceScales(v);switch(n){case Ar.METER_OFFSETS:F.project_uCommonUnitsPerWorldUnit=H.unitsPerMeter,F.project_uCommonUnitsPerWorldUnit2=H.unitsPerMeter2;break;case Ar.LNGLAT:case Ar.LNGLAT_OFFSETS:t._pseudoMeters||(F.project_uCommonUnitsPerMeter=H.unitsPerMeter),F.project_uCommonUnitsPerWorldUnit=H.unitsPerDegree,F.project_uCommonUnitsPerWorldUnit2=H.unitsPerDegree2;break;case Ar.CARTESIAN:F.project_uCommonUnitsPerWorldUnit=[1,1,H.unitsPerMeter[2]],F.project_uCommonUnitsPerWorldUnit2=[0,0,H.unitsPerMeter2[2]];break}}return F}const Hse={};function Wse(t=Hse){return"viewport"in t?$se(t):{}}const DS={name:"project",dependencies:[ure,Dse],vs:Ose,getUniforms:Wse};function Qse(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function X0(t,e){const n=Od([],e,t);return kS(n,n,1/n[3]),n}function Jk(t,e){const n=t%e;return n<0?e+n:n}function qse(t,e,n){return n*e+(1-n)*t}function Y3(t,e,n){return t<e?e:t>n?n:t}function Zse(t){return Math.log(t)*Math.LOG2E}const RS=Math.log2||Zse;function lc(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const iA=Math.PI,mO=iA/4,bl=iA/180,X3=180/iA,bd=512,i2=4003e4,Z1=85.051129,Yse=1.5;function eI(t){return Math.pow(2,t)}function yO(t){return RS(t)}function dA(t){const[e,n]=t;lc(Number.isFinite(e)),lc(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*bl,i=n*bl,s=bd*(r+iA)/(2*iA),l=bd*(iA+Math.log(Math.tan(mO+i*.5)))/(2*iA);return[s,l]}function gf(t){const[e,n]=t,r=e/bd*(2*iA)-iA,i=2*(Math.atan(Math.exp(n/bd*(2*iA)-iA))-mO);return[r*X3,i*X3]}function Xse(t){const{latitude:e}=t;lc(Number.isFinite(e));const n=Math.cos(e*bl);return yO(i2*n)-9}function Vy(t){const e=Math.cos(t*bl);return bd/i2/e}function K3(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;lc(Number.isFinite(e)&&Number.isFinite(n));const i=bd,s=Math.cos(e*bl),l=i/360,o=l/s,p=i/i2/s,v={unitsPerMeter:[p,p,p],metersPerUnit:[1/p,1/p,1/p],unitsPerDegree:[l,o,p],degreesPerUnit:[1/l,1/o,1/p]};if(r){const S=bl*Math.tan(e*bl)/s,M=l*S/2,k=i/i2*S,F=k/o*p;v.unitsPerDegree2=[0,M,k],v.unitsPerMeter2=[F,0,F]}return v}function _O(t,e){const[n,r,i]=t,[s,l,o]=e,{unitsPerMeter:p,unitsPerMeter2:v}=K3({longitude:n,latitude:r,highPrecision:!0}),S=dA(t);S[0]+=s*(p[0]+v[0]*l),S[1]+=l*(p[1]+v[1]*l);const M=gf(S),k=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[M[0],M[1],k]:M}function Kse(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:l}=t,o=Qse();n2(o,o,[0,0,-i]),eO(o,o,-n*bl),tO(o,o,r*bl);const p=s/e;return PS(o,o,[p,p,p]),l&&n2(o,o,Lre([],l)),o}function Jse(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:l,scale:o,nearZMultiplier:p=1,farZMultiplier:v=1}=t;let{fovy:S=s2(Yse)}=t;r!==void 0&&(S=s2(r));const M=S*bl,k=i*bl,F=vO(S);let H=F;l&&(H+=l[2]*o/Math.cos(k)/n);const j=M*(.5+(s?s[1]:0)/n),ie=Math.sin(j)*H/Math.sin(Y3(Math.PI/2-k-j,.01,Math.PI-.01)),Y=Math.sin(k)*ie+H,J=H*10,se=Math.min(Y*v,J);return{fov:M,aspect:e/n,focalDistance:F,near:p,far:se}}function s2(t){return 2*Math.atan(.5/t)*X3}function vO(t){return .5/Math.tan(.5*t*bl)}function xO(t,e){const[n,r,i=0]=t;return lc(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),X0(e,[n,r,i,1])}function BS(t,e,n=0){const[r,i,s]=t;if(lc(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return X0(e,[r,i,s,1]);const l=X0(e,[r,i,0,1]),o=X0(e,[r,i,1,1]),p=l[2],v=o[2],S=p===v?0:((n||0)-p)/(v-p);return jz([],l,o,S)}function eoe(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:l=[0,0]}=t,[[o,p],[v,S]]=r,M=toe(t.padding),k=dA([o,Y3(S,-Z1,Z1)]),F=dA([v,Y3(p,-Z1,Z1)]),H=[Math.max(Math.abs(F[0]-k[0]),i),Math.max(Math.abs(F[1]-k[1]),i)],j=[e-M.left-M.right-Math.abs(l[0])*2,n-M.top-M.bottom-Math.abs(l[1])*2];lc(j[0]>0&&j[1]>0);const ie=j[0]/H[0],Y=j[1]/H[1],J=(M.right-M.left)/2/ie,se=(M.top-M.bottom)/2/Y,ce=[(F[0]+k[0])/2+J,(F[1]+k[1])/2+se],me=gf(ce),Ee=Math.min(s,RS(Math.abs(Math.min(ie,Y))));return lc(Number.isFinite(Ee)),{longitude:me[0],latitude:me[1],zoom:Ee}}function toe(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(lc(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const tI=Math.PI/180;function noe(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},l=i([0,r],s),o=i([n,r],s);let p,v;const S=t.fovy?.5*t.fovy*tI:Math.atan(.5/t.altitude),M=(90-t.pitch)*tI;return S>M-.01?(p=nI(t,0,e),v=nI(t,n,e)):(p=i([0,0],s),v=i([n,0],s)),[l,o,v,p]}function nI(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=X0(r,[e,0,1,1]),s=X0(r,[e,t.height,1,1]),o=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),p=jz([],i,s,o),v=gf(p);return v.push(n),v}const rI=512;function roe(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:l,bearing:o=0}=t;(i<-180||i>180)&&(i=Jk(i+180,360)-180),(o<-180||o>180)&&(o=Jk(o+180,360)-180);const p=RS(n/rI);if(l<=p)l=p,s=0;else{const v=n/2/Math.pow(2,l),S=gf([0,v])[1];if(s<S)s=S;else{const M=gf([0,rI-v])[1];s>M&&(s=M)}}return{width:e,height:n,longitude:i,latitude:s,zoom:l,pitch:r,bearing:o}}const wO=.01,ioe=["longitude","latitude","zoom"],bO={curve:1.414,speed:1.2};function soe(t,e,n,r){const{startZoom:i,startCenterXY:s,uDelta:l,w0:o,u1:p,S:v,rho:S,rho2:M,r0:k}=EO(t,e,r);if(p<wO){const ce={};for(const me of ioe){const Ee=t[me],He=e[me];ce[me]=qse(Ee,He,n)}return ce}const F=n*v,H=Math.cosh(k)/Math.cosh(k+S*F),j=o*((Math.cosh(k)*Math.tanh(k+S*F)-Math.sinh(k))/M)/p,ie=1/H,Y=i+yO(ie),J=_re([],l,j);H3(J,J,s);const se=gf(J);return{longitude:se[0],latitude:se[1],zoom:Y}}function ooe(t,e,n){const r={...bO,...n},{screenSpeed:i,speed:s,maxDuration:l}=r,{S:o,rho:p}=EO(t,e,r),v=1e3*o;let S;return Number.isFinite(i)?S=v/(i/p):S=v/s,Number.isFinite(l)&&S>l?0:S}function EO(t,e,n){n=Object.assign({},bO,n);const r=n.curve,i=t.zoom,s=[t.longitude,t.latitude],l=eI(i),o=e.zoom,p=[e.longitude,e.latitude],v=eI(o-i),S=dA(s),M=dA(p),k=Ere([],M,S),F=Math.max(t.width,t.height),H=F/v,j=vre(k)*l,ie=Math.max(j,wO),Y=r*r,J=(H*H-F*F+Y*Y*ie*ie)/(2*F*Y*ie),se=(H*H-F*F-Y*Y*ie*ie)/(2*H*Y*ie),ce=Math.log(Math.sqrt(J*J+1)-J),me=Math.log(Math.sqrt(se*se+1)-se),Ee=(me-ce)/r;return{startZoom:i,startCenterXY:S,uDelta:k,w0:F,u1:j,S:Ee,rho:r,rho2:Y,r0:ce,r1:me}}const aoe=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,loe=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,Aoe=Rm(doe),uoe=Rm(poe),coe=[0,0,0,1],hoe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function foe(t,e){const[n,r,i]=t,s=BS([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function doe({viewport:t,center:e}){return new ca(t.viewProjectionMatrix).invert().transform(e)}function poe({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(l=>foe(l,r));for(const l of e){const o=l.clone().translate(new An(t.center).negate()),p=s.map(S=>o.transform(S)),v=new ca().ortho({left:Math.min(...p.map(S=>S[0])),right:Math.max(...p.map(S=>S[0])),bottom:Math.min(...p.map(S=>S[1])),top:Math.max(...p.map(S=>S[1])),near:Math.min(...p.map(S=>-S[2])),far:Math.max(...p.map(S=>-S[2]))});n.push(v.multiplyRight(l))}return n}function goe(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||coe,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=Aoe({viewport:t.viewport,center:e.project_uCenter}),s=[],l=uoe({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let o=0;o<t.shadowMatrices.length;o++){const p=l[o],v=p.clone().translate(new An(t.viewport.center).negate());e.project_uCoordinateSystem===Ar.LNGLAT&&e.project_uProjectionMode===rA.WEB_MERCATOR?(l[o]=v,s[o]=i):(l[o]=p.clone().multiplyRight(hoe),s[o]=v.transform(i))}for(let o=0;o<l.length;o++)r["shadow_uViewProjectionMatrices[".concat(o,"]")]=l[o],r["shadow_uProjectCenters[".concat(o,"]")]=s[o],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(o)]=t.shadowMaps[o]:r["shadow_uShadowMap".concat(o)]=t.dummyShadowMap;return r}const Uw={name:"shadow",dependencies:[DS],vs:aoe,fs:loe,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?goe(t,e):{}},moe={color:[255,255,255],intensity:1},iI=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],yoe=[0,0,0,200/255];class zS{constructor(e={}){oe(this,"id","lighting-effect"),oe(this,"props",void 0),oe(this,"shadowColor",yoe),oe(this,"shadow",void 0),oe(this,"ambientLight",void 0),oe(this,"directionalLights",void 0),oe(this,"pointLights",void 0),oe(this,"shadowPasses",[]),oe(this,"shadowMaps",[]),oe(this,"dummyShadowMap",null),oe(this,"programManager",void 0),oe(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:l}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Dm.getDefaultProgramManager(e),Uw&&this.programManager.addDefaultModule(Uw)),this.dummyShadowMap||(this.dummyShadowMap=new da(e,{width:1,height:1}));for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:l,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Uw),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new ca().lookAt({eye:new An(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new kse(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new cO(moe),this.directionalLights.push(new Z3(iI[0]),new Z3(iI[1])))}}class _oe{constructor(e={}){oe(this,"_pool",[]),oe(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:l=!1,initialize:o=!1,maxCount:p}){const v=i||e&&e.constructor||Float32Array,S=n*r+s;if(ArrayBuffer.isView(e)){if(S<=e.length)return e;if(S*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new v(e.buffer,0,S)}let M=1/0;p&&(M=p*r+s);const k=this._allocate(v,S,o,M);return e&&l?k.set(e):o||k.fill(0,0,4),this._release(e),k}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const l=this._pool,o=e.BYTES_PER_ELEMENT*s,p=l.findIndex(v=>v.byteLength>=o);if(p>=0){const v=new e(l.splice(p,1)[0],0,s);return r&&v.fill(0),v}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(l=>l.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const Ed=new _oe;function Xp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function voe(t){return[t[12],t[13],t[14]]}function xoe(t){return{left:u0(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:u0(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:u0(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:u0(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:u0(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:u0(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const sI=new An;function u0(t,e,n,r){sI.set(t,e,n);const i=sI.len();return{distance:r/i,normal:new An(-t/i,-e/i,-n/i)}}function woe(t){return t-Math.fround(t)}let Pp;function Vw(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Pp=Ed.allocate(Pp,s,{type:Float32Array,size:n*2});let l=r,o=0;for(;l<i;){for(let p=0;p<n;p++){const v=t[l++];Pp[o+p]=v,Pp[o+p+n]=woe(v)}o+=n*2}return Pp.subarray(0,s*n*2)}function boe(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const Eoe=Math.PI/180,Toe=Xp(),oI=[0,0,0],Soe={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function Coe({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:l,far:o}){const p=t/e,v=n?new ca().orthographic({fovy:r,aspect:p,focalDistance:i,near:l,far:o}):new ca().perspective({fovy:r,aspect:p,near:l,far:o});if(s){const{left:S=0,right:M=0,top:k=0,bottom:F=0}=s,H=Xc((S+t-M)/2,0,t)-t/2,j=Xc((k+e-F)/2,0,e)-e/2;v[8]-=H*2/t,v[9]+=j*2/e}return v}class Nf{constructor(e={}){oe(this,"id",void 0),oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"padding",void 0),oe(this,"isGeospatial",void 0),oe(this,"zoom",void 0),oe(this,"focalDistance",void 0),oe(this,"position",void 0),oe(this,"modelMatrix",void 0),oe(this,"distanceScales",void 0),oe(this,"scale",void 0),oe(this,"center",void 0),oe(this,"cameraPosition",void 0),oe(this,"projectionMatrix",void 0),oe(this,"viewMatrix",void 0),oe(this,"viewMatrixUncentered",void 0),oe(this,"viewMatrixInverse",void 0),oe(this,"viewProjectionMatrix",void 0),oe(this,"pixelProjectionMatrix",void 0),oe(this,"pixelUnprojectionMatrix",void 0),oe(this,"resolution",void 0),oe(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Soe,this.focalDistance=e.focalDistance||1,this.position=e.position||oI,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?rA.WEB_MERCATOR:rA.WEB_MERCATOR_AUTO_OFFSET:rA.IDENTITY}equals(e){return e instanceof Nf?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&qu(e.projectionMatrix,this.projectionMatrix)&&qu(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=xO(r,this.pixelProjectionMatrix),[s,l]=i,o=n?l:this.height-l;return e.length===2?[s,o]:[s,o,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,l]=e,o=n?s:this.height-s,p=r&&r*this.distanceScales.unitsPerMeter[2],v=BS([i,o,l],this.pixelUnprojectionMatrix,p),[S,M,k]=this.unprojectPosition(v);return Number.isFinite(l)?[S,M,k]:Number.isFinite(r)?[S,M,r]:[S,M]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=dA(e);return n[1]=Xc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?gf(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),l=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],l[0]),Math.min(r[1],i[1],s[1],l[1]),Math.max(r[0],i[0],s[0],l[0]),Math.max(r[1],i[1],s[1],l[1])]}getDistanceScales(e){return e?K3({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,xoe(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=Xse({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||K3({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:l}=e;let o=oI;if(s&&(o=l?new ca(l).transformAsVector(s,[]):s),this.isGeospatial){const p=this.projectPosition([n,r,0]);this.center=new An(o).scale(this.distanceScales.unitsPerMeter).add(p)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:n=Toe,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:l=75,near:o=.1,far:p=1e3,padding:v=null,focalDistance:S=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new ca().multiplyRight(n).translate(new An(this.center).negate()),this.projectionMatrix=r||Coe({width:this.width,height:this.height,orthographic:i,fovyRadians:s||l*Eoe,focalDistance:S,padding:v,near:o,far:p});const M=Xp();ef(M,M,this.projectionMatrix),ef(M,M,this.viewMatrix),this.viewProjectionMatrix=M,this.viewMatrixInverse=Q3([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=voe(this.viewMatrixInverse);const k=Xp(),F=Xp();PS(k,k,[this.width/2,-this.height/2,1]),n2(k,k,[1,-1,0]),ef(F,k,this.viewProjectionMatrix),this.pixelProjectionMatrix=F,this.pixelUnprojectionMatrix=Q3(Xp(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||sr.warn("Pixel project matrix not invertible")()}}oe(Nf,"displayName","Viewport");class Ac extends Nf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:l=0,nearZMultiplier:o=.1,farZMultiplier:p=1.01,nearZ:v,farZ:S,orthographic:M=!1,projectionMatrix:k,repeat:F=!1,worldOffset:H=0,position:j,padding:ie,legacyMeterSizes:Y=!1}=e;let{width:J,height:se,altitude:ce=1.5}=e;const me=Math.pow(2,i);J=J||1,se=se||1;let Ee,He=null;if(k)ce=k[5]/2,Ee=s2(ce);else{e.fovy?(Ee=e.fovy,ce=vO(Ee)):Ee=s2(ce);let Ye;if(ie){const{top:nt=0,bottom:Fe=0}=ie;Ye=[0,Xc((nt+se-Fe)/2,0,se)-se/2]}He=Jse({width:J,height:se,scale:me,center:j&&[0,0,j[2]*Vy(n)],offset:Ye,pitch:s,fovy:Ee,nearZMultiplier:o,farZMultiplier:p}),Number.isFinite(v)&&(He.near=v),Number.isFinite(S)&&(He.far=S)}let Qe=Kse({height:se,pitch:s,bearing:l,scale:me,altitude:ce});H&&(Qe=new ca().translate([512*H,0,0]).multiplyLeft(Qe)),super({...e,width:J,height:se,viewMatrix:Qe,longitude:r,latitude:n,zoom:i,...He,fovy:Ee,focalDistance:ce}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"pitch",void 0),oe(this,"bearing",void 0),oe(this,"altitude",void 0),oe(this,"fovy",void 0),oe(this,"orthographic",void 0),oe(this,"_subViewports",void 0),oe(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=l,this.altitude=ce,this.fovy=Ee,this.orthographic=M,this._subViewports=F?[]:null,this._pseudoMeters=Y,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new Ac({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Vy(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Vy(r);return[n,r,i]}addMetersToLngLat(e,n){return _O(e,n)}panByPosition(e,n){const r=BS(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=H3([],i,xre([],r)),l=H3([],this.center,s),[o,p]=this.unprojectFlat(l);return{longitude:o,latitude:p}}getBounds(e={}){const n=noe(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:l,zoom:o}=eoe({width:r,height:i,bounds:e,...n});return new Ac({width:r,height:i,longitude:s,latitude:l,zoom:o})}}oe(Ac,"displayName","WebMercatorViewport");const aI=[0,0,0];function Gw(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Ac){const[i,s,l=0]=t,o=e.getDistanceScales([i,s]);r[2]=l*o.unitsPerMeter[2]}return r}function Moe(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:l}=t;return i===Ar.DEFAULT&&(i=e.isGeospatial?Ar.LNGLAT:Ar.CARTESIAN),s===void 0&&(s=i),l===void 0&&(l=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:l}}function TO(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[l,o,p=0]=t;switch(n&&([l,o,p]=Od([],[l,o,p,1],n)),r){case Ar.LNGLAT:return Gw([l,o,p],e,s);case Ar.LNGLAT_OFFSETS:return Gw([l+i[0],o+i[1],p+(i[2]||0)],e,s);case Ar.METER_OFFSETS:return Gw(_O(i,[l,o,p]),e,s);case Ar.CARTESIAN:default:return e.isGeospatial?[l+i[0],o+i[1],p+i[2]]:e.projectPosition([l,o,p])}}function Poe(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:l,fromCoordinateOrigin:o}=Moe(e),{autoOffset:p=!0}=e,{geospatialOrigin:v=aI,shaderCoordinateOrigin:S=aI,offsetMode:M=!1}=p?gO(n,r,i):{},k=TO(t,{viewport:n,modelMatrix:s,coordinateSystem:l,coordinateOrigin:o,offsetMode:M});if(M){const F=n.projectPosition(v||S);Xz(k,k,F)}return k}const mf=Math.PI/180,koe=1e3*60*60*24,Ioe=2440588,Loe=2451545,o2=mf*23.4397,Doe=357.5291,Roe=.98560028,Boe=280.147,zoe=360.9856235;function Ooe(t,e,n){const r=mf*-n,i=mf*e,s=Noe(t),l=Qoe(s),o=joe(s,r)-l.rightAscension;return{azimuth:Goe(o,i,l.declination),altitude:$oe(o,i,l.declination)}}function lI(t,e,n){const{azimuth:r,altitude:i}=Ooe(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function Foe(t){return(typeof t=="number"?t:t.getTime())/koe-.5+Ioe}function Noe(t){return Foe(t)-Loe}function Uoe(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(o2)-Math.tan(e)*Math.sin(o2),Math.cos(n))}function Voe(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(o2)+Math.cos(e)*Math.sin(o2)*Math.sin(n))}function Goe(t,e,n){const r=t,i=e,s=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(s)*Math.cos(i))}function $oe(t,e,n){const r=t,i=e,s=n;return Math.asin(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(r))}function joe(t,e){return mf*(Boe+zoe*t)-e}function Hoe(t){return mf*(Doe+Roe*t)}function Woe(t){const e=t,n=mf*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),r=mf*102.9372;return e+n+r+Math.PI}function Qoe(t){const e=Hoe(t),n=Woe(e);return{declination:Voe(n,0),rightAscension:Uoe(n,0)}}class qoe extends Z3{constructor(e){super(e),oe(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[i,s,l]=lI(this.timestamp,0,0);this.direction=[i,-l,s]}else{const{latitude:i,longitude:s}=n;this.direction=lI(this.timestamp,i,s)}return this}}const AI={blendFunc:[1,0,32771,0],blendEquation:32774};class SO extends LS{constructor(...e){super(...e),oe(this,"pickZ",void 0),oe(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:l,deviceRect:{x:o,y:p,width:v,height:S},cullRect:M,effects:k,pass:F="picking",pickZ:H,moduleParameters:j}){const ie=this.gl;this.pickZ=H;const Y=this._resetColorEncoder(H),J=cA(ie,{scissorTest:!0,scissor:[o,p,v,S],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...AI,blend:!H},()=>super.render({target:l,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:M,effects:k?.filter(ce=>ce.useInPicking),pass:F,isPicking:!0,moduleParameters:j}));return this._colorEncoderState=null,{decodePickingColor:Y&&Yoe.bind(null,Y),stats:J}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:l}=e.props;return this._colorEncoderState?s&&l.includes("draw")&&(Object.assign(i,AI),i.blend=!0,i.blendColor=Zoe(this._colorEncoderState,e,r)):i.blend=!1,l.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function Zoe(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,l=r.get(e);return l?(l.viewports.push(n),s=l.a):(s=r.size+1,s<=255?(l={a:s,layer:e,viewports:[n]},r.set(e,l),i[s]=l):(sr.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function Yoe(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const d0={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},a2=Symbol.for("component"),ch=Symbol.for("propTypes"),$w=Symbol.for("deprecatedProps"),K0=Symbol.for("asyncPropDefaults"),yf=Symbol.for("asyncPropOriginal"),Kc=Symbol.for("asyncPropResolved");function _f(t,e=()=>!0){return Array.isArray(t)?CO(t,e,[]):e(t)?[t]:[]}function CO(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?CO(i,e,n):e(i)&&n.push(i)}return n}function Xoe({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let l=0;for(let o=n;l<i;l++)t[o++]=e[l];for(;l<s;)l<s-l?(t.copyWithin(n+l,n,n+l),l*=2):(t.copyWithin(n+l,n,n+s-l),l=s);return t}function uI(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class cI{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=uI(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(uI()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class MO{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof cI?this.stats[n]=e:this.stats[n]=new cI(n,r)),this.stats[n]}}class Koe{constructor(e,n,r){oe(this,"id",void 0),oe(this,"context",void 0),oe(this,"isLoaded",void 0),oe(this,"persistent",void 0),oe(this,"_loadCount",0),oe(this,"_subscribers",new Set),oe(this,"_data",void 0),oe(this,"_loader",void 0),oe(this,"_error",void 0),oe(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Z_(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class Joe{constructor({gl:e,protocol:n}){oe(this,"protocol",void 0),oe(this,"_context",void 0),oe(this,"_resources",void 0),oe(this,"_consumers",void 0),oe(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new Koe(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:l}=this;e.startsWith(l)&&(e=e.replace(l,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=s[e];if(this._track(r,i,o,n),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,l=s[e]=s[e]||{},o=l[n]||{},p=o.resourceId&&this._resources[o.resourceId];p&&(p.unsubscribe(o),this.prune()),r&&(l[n]=o,o.onChange=i,o.resourceId=r.id,r.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const eae=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Uf={name:"project32",dependencies:[DS],vs:eae},Vf={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...Hie},tae=[DS],nae=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function rae(t){const e=Dm.getDefaultProgramManager(t);for(const n of tae)e.addDefaultModule(n);for(const n of nae)e.addShaderHook(n);return e}const iae="layerManager.setLayers",sae="layerManager.activateViewport";class oae{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){oe(this,"layers",void 0),oe(this,"context",void 0),oe(this,"resourceManager",void 0),oe(this,"_lastRenderedLayers",[]),oe(this,"_needsRedraw",!1),oe(this,"_needsUpdate",!1),oe(this,"_nextLayers",null),oe(this,"_debug",!1),oe(this,"activateViewport",l=>{uo(sae,this,l),l&&(this.context.viewport=l)}),this.layers=[],this.resourceManager=new Joe({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&rae(e),stats:r||new MO({id:"deck.gl"}),viewport:i||new Nf({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new uO,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){uo(iae,this,n,e),this._lastRenderedLayers=e;const r=_f(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const l of e)r[l.id]?sr.warn("Multiple old layers with same id ".concat(l.id))():r[l.id]=l;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const l of i)if(l.hasUniformTransition()){s="Uniform transition in ".concat(l);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&sr.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let l=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),l=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}l&&this._updateSublayersRecursively(l,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=d0.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=d0.MATCHED,n!==e&&(e.lifecycle=d0.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=d0.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=d0.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function sA(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!sA(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!sA(t[s],e[s],n-1))return!1;return!0}return!1}class aae{constructor(e){oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"views",void 0),oe(this,"viewState",void 0),oe(this,"controllers",void 0),oe(this,"timeline",void 0),oe(this,"_viewports",void 0),oe(this,"_viewportMap",void 0),oe(this,"_isUpdating",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_needsUpdate",void 0),oe(this,"_eventManager",void 0),oe(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const l=r[s];if(l.containsPixel(i)){const o=e.slice();return o[0]-=l.x,o[1]-=l.y,l.unproject(o,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=_f(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!sA(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):sr.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var l;return(l=this.getView(e.id))===null||l===void 0?void 0:l.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const l={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,l)),i&&i.setProps(l),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],l=this.getViewState(s),o=s.makeViewport({viewState:l,width:this.width,height:this.height});let p=n[s.id];const v=!!s.controller;v&&!p&&(r=!0),(r||!v)&&p&&(p.finalize(),p=null),this.controllers[s.id]=this._updateController(s,l,o,p),o&&this._viewports.unshift(o)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const lae=/([0-9]+\.?[0-9]*)(%|px)/;function Oc(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=lae.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Fc(t,e){return t.relative?Math.round(t.position*e):t.position}function Ni(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class El{constructor(e){oe(this,"id",void 0),oe(this,"viewportInstance",void 0),oe(this,"_x",void 0),oe(this,"_y",void 0),oe(this,"_width",void 0),oe(this,"_height",void 0),oe(this,"_padding",void 0),oe(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:l="100%",padding:o=null,viewportInstance:p}=e||{};Ni(!p||p instanceof Nf),this.viewportInstance=p,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Oc(r),this._y=Oc(i),this._width=Oc(s),this._height=Oc(l),this._padding=o&&{left:Oc(o.left||0),right:Oc(o.right||0),top:Oc(o.top||0),bottom:Oc(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&sA(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Fc(this._x,e),y:Fc(this._y,n),width:Fc(this._width,e),height:Fc(this._height,n)};return this._padding&&(r.padding={left:Fc(this._padding.left,e),top:Fc(this._padding.top,n),right:Fc(this._padding.right,e),bottom:Fc(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let Bm=class{constructor(e){oe(this,"_inProgress",void 0),oe(this,"_handle",void 0),oe(this,"_timeline",void 0),oe(this,"time",void 0),oe(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const hI=()=>{},J3={BREAK:1,SNAP_TO_END:2,IGNORE:3},Aae=t=>t,uae=J3.BREAK;class cae{constructor(e){oe(this,"getControllerState",void 0),oe(this,"props",void 0),oe(this,"propsInTransition",void 0),oe(this,"transition",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:l,duration:o,easing:p}}=n,v=p(r/o),S=i.interpolateProps(s,l,v);this.propsInTransition=this.getControllerState({...this.props,...S}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Bm(e.timeline),this.onViewStateChange=e.onViewStateChange||hI,this.onStateChange=e.onStateChange||hI}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:l}=this.transition.settings;i={...r,...s===J3.SNAP_TO_END?l:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===J3.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,l=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(l===0)return;const o=s.initializeProps(e,i);this.propsInTransition={};const p={duration:l,easing:n.transitionEasing||Aae,interpolator:s,interruption:n.transitionInterruption||uae,startProps:o.start,endProps:o.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(p),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class PO{constructor(e){oe(this,"_propsToCompare",void 0),oe(this,"_propsToExtract",void 0),oe(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!qu(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Ni(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const hae=["longitude","latitude","zoom","bearing","pitch"],fae=["longitude","latitude","zoom"];class kO extends PO{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:hae,required:fae},super(r.transitionProps),oe(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const l=i(e),o=i(n),p=l.unproject(s);r.start.around=s,Object.assign(r.end,{around:o.project(p),aroundPosition:p,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=wl(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,wl(e.around,n.around,r)))}return i}}const Nc={transitionDuration:0},dae=300,Y1=t=>1-(1-t)*(1-t),c0={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Oh={};class pae{constructor(e){oe(this,"props",void 0),oe(this,"state",{}),oe(this,"transitionManager",void 0),oe(this,"eventManager",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"makeViewport",void 0),oe(this,"_controllerState",void 0),oe(this,"_events",{}),oe(this,"_interactionState",{isDragging:!1}),oe(this,"_customEvents",[]),oe(this,"_eventStartBlocked",null),oe(this,"_panMove",!1),oe(this,"invertPan",!1),oe(this,"dragMode","rotate"),oe(this,"inertia",0),oe(this,"scrollZoom",!0),oe(this,"dragPan",!0),oe(this,"dragRotate",!0),oe(this,"doubleClickZoom",!0),oe(this,"touchZoom",!0),oe(this,"touchRotate",!1),oe(this,"keyboard",!0),this.transitionManager=new cae({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?dae:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:l=!0,touchZoom:o=!0,touchRotate:p=!1,keyboard:v=!0}=e,S=!!this.onViewStateChange;this.toggleEvents(c0.WHEEL,S&&r),this.toggleEvents(c0.PAN,S),this.toggleEvents(c0.PINCH,S&&(o||p)),this.toggleEvents(c0.TRIPLE_PAN,S&&p),this.toggleEvents(c0.DOUBLE_TAP,S&&l),this.toggleEvents(c0.KEYBOARD,S&&v),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=l,this.touchZoom=o,this.touchRotate=p,this.keyboard=v}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const l=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:l})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Nc,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Nc,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Y1},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Nc,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Y1},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let l=2/(1+Math.exp(-Math.abs(s*r)));s<0&&l!==0&&(l=1/l);const o=this.controllerState.zoom({pos:n,scale:l});return this.updateViewport(o,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Nc,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Nc,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Y1},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Oh._startPinchRotation=e.rotation,Oh._lastPinchEvent=e,this.updateViewport(r,Nc,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Oh._startPinchRotation-r})}return this.updateViewport(n,Nc,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Oh._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Oh;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const l=Math.log2(e.scale),o=(l-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),p=Math.pow(2,l+o*n/2);s=s.zoom({pos:i,scale:p}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Y1},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Oh._startPinchRotation=null,Oh._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:l}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let p;const v={};switch(e.srcEvent.code){case"Minus":p=n?o.zoomOut(r).zoomOut(r):o.zoomOut(r),v.isZooming=!0;break;case"Equal":p=n?o.zoomIn(r).zoomIn(r):o.zoomIn(r),v.isZooming=!0;break;case"ArrowLeft":n?(p=o.rotateLeft(s),v.isRotating=!0):(p=o.moveLeft(i),v.isPanning=!0);break;case"ArrowRight":n?(p=o.rotateRight(s),v.isRotating=!0):(p=o.moveRight(i),v.isPanning=!0);break;case"ArrowUp":n?(p=o.rotateUp(l),v.isRotating=!0):(p=o.moveUp(i),v.isPanning=!0);break;case"ArrowDown":n?(p=o.rotateDown(l),v.isRotating=!0):(p=o.moveDown(i),v.isPanning=!0);break;default:return!1}return this.updateViewport(p,this._getTransitionProps(),v),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Nc:e?{...n,transitionInterpolator:new kO({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class gae{constructor(e,n){oe(this,"_viewportProps",void 0),oe(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const fI=5,mae=1.2;class yae extends gae{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:l,bearing:o=0,pitch:p=0,altitude:v=1.5,position:S=[0,0,0],maxZoom:M=20,minZoom:k=0,maxPitch:F=60,minPitch:H=0,startPanLngLat:j,startZoomLngLat:ie,startRotatePos:Y,startBearing:J,startPitch:se,startZoom:ce,normalize:me=!0}=e;Ni(Number.isFinite(s)),Ni(Number.isFinite(i)),Ni(Number.isFinite(l)),super({width:n,height:r,latitude:i,longitude:s,zoom:l,bearing:o,pitch:p,altitude:v,maxZoom:M,minZoom:k,maxPitch:F,minPitch:H,normalize:me,position:S},{startPanLngLat:j,startZoomLngLat:ie,startRotatePos:Y,startBearing:J,startPitch:se,startZoom:ce}),oe(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:l}=this.getState();if(!i||s===void 0||l===void 0)return this;let o;return e?o=this._getNewRotation(e,i,l,s):o={bearing:s+n,pitch:l+r},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:l,minZoom:o}=this.getViewportProps();let p=i+Math.log2(r);p=Xc(p,o,l);const v=this.makeViewport({...this.getViewportProps(),zoom:p});return this._getUpdatedState({zoom:p,...v.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Xc(i,r,n);const{maxPitch:s,minPitch:l,pitch:o}=e;e.pitch=Xc(o,l,s);const{normalize:p=!0}=e;return p&&Object.assign(e,roe(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],l=e[1]-n[1],o=e[1],p=n[1],{width:v,height:S}=this.getViewportProps(),M=s/v;let k=0;l>0?Math.abs(S-p)>fI&&(k=l/(p-S)*mae):l<0&&p>fI&&(k=1-o/p),k=Xc(k,-1,1);const{minPitch:F,maxPitch:H}=this.getViewportProps(),j=i+180*M;let ie=r;return k>0?ie=r+k*(H-r):k<0&&(ie=r-k*(F-r)),{pitch:ie,bearing:j}}}class _ae extends pae{constructor(...e){super(...e),oe(this,"ControllerState",yae),oe(this,"transition",{transitionDuration:300,transitionInterpolator:new kO({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),oe(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Yu extends El{get ViewportType(){return Ac}get ControllerType(){return _ae}}oe(Yu,"displayName","MapView");const vae=new zS;function xae(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class wae{constructor(){oe(this,"effects",void 0),oe(this,"_resolvedEffects",[]),oe(this,"_defaultEffects",[]),oe(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>xae(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(sA(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof zS)||this._resolvedEffects.push(vae),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class bae extends LS{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const Eae="deckRenderer.renderLayers";class Tae{constructor(e){oe(this,"gl",void 0),oe(this,"layerFilter",void 0),oe(this,"drawPickingColors",void 0),oe(this,"drawLayersPass",void 0),oe(this,"pickLayersPass",void 0),oe(this,"renderCount",void 0),oe(this,"_needsRedraw",void 0),oe(this,"renderBuffers",void 0),oe(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new bae(e),this.pickLayersPass=new SO(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||os.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,uo(Eae,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new os(this.gl),new os(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const l=s.postRender(this.gl,i);i.inputBuffer=l,i.swapBuffer=l===r[0]?r[1]:r[0]}}}const Sae={pickedColor:null,pickedObjectIndex:-1};function Cae({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:l,y:o,width:p,height:v}=s;let S=i*i,M=-1,k=0;for(let F=0;F<v;F++){const H=F+o-r,j=H*H;if(j>S)k+=4*p;else for(let ie=0;ie<p;ie++){if(t[k+3]-1>=0){const J=ie+l-n,se=J*J+j;se<=S&&(S=se,M=k)}k+=4}}if(M>=0){const F=t.slice(M,M+4),H=e(F);if(H){const j=Math.floor(M/4/p),ie=M/4-j*p;return{...H,pickedColor:F,pickedX:l+ie,pickedY:o+j}}sr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Sae}function Mae({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),l=s.join(",");if(!n.has(l)){const o=e(s);o?n.set(l,{...o,color:s}):sr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function IO({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let l=e[0];e.length>1&&(l=kae(t?.pickedViewports||e,{x:r,y:i}));let o;if(l){const p=[r-l.x,i-l.y];s!==void 0&&(p[2]=s),o=l.unproject(p)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function Pae(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:l,pickedObjectIndex:o}=e,p=l?[l]:[];if(r==="hover"){const M=n.index,k=n.layerId,F=l?l.props.id:null;if(F!==k||o!==M){if(F!==k){const H=i.find(j=>j.props.id===k);H&&p.unshift(H)}n.layerId=F,n.index=o,n.info=null}}const v=IO(t),S=new Map;return S.set(null,v),p.forEach(M=>{let k={...v};M===l&&(k.color=s,k.index=o,k.picked=!0),k=LO({layer:M,info:k,mode:r});const F=k.layer;M===l&&r==="hover"&&(n.info=k),S.set(F.id,k),r==="hover"&&F.updateAutoHighlight(k)}),S}function LO({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function kae(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class Iae{constructor(e){oe(this,"gl",void 0),oe(this,"pickingFBO",void 0),oe(this,"depthFBO",void 0),oe(this,"pickLayersPass",void 0),oe(this,"layerFilter",void 0),oe(this,"lastPickedInfo",void 0),oe(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new SO(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const l=s&&s.layer&&s.layer.id,o=s&&s.viewport&&s.viewport.id,p=l?r.find(k=>k.id===l):null,v=o&&i.find(k=>k.id===o)||i[0],S=v&&v.unproject([e-v.x,n-v.y]);return{...s,...{x:e,y:n,viewport:v,coordinate:S,layer:p}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new os(r),os.isSupported(r,{colorBufferFloat:!0}))){const i=new os(r);i.attach({36064:new da(r,{format:cr(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:l=0,depth:o=1,mode:p="query",unproject3D:v,onViewportActive:S,effects:M}){const k=this._getPickable(e),F=vd(this.gl);if(!k)return{result:[],emptyInfo:IO({viewports:r,x:i,y:s,pixelRatio:F})};this._resizeBuffer();const H=Tw(this.gl,[i,s],!0),j=[H.x+Math.floor(H.width/2),H.y+Math.floor(H.height/2)],ie=Math.round(l*F),{width:Y,height:J}=this.pickingFBO,se=this._getPickingRect({deviceX:j[0],deviceY:j[1],deviceRadius:ie,deviceWidth:Y,deviceHeight:J}),ce={x:i-l,y:s-l,width:l*2+1,height:l*2+1};let me;const Ee=[],He=new Set;for(let Qe=0;Qe<o;Qe++){let Ye;if(se){const Fe=this._drawAndSample({layers:k,views:n,viewports:r,onViewportActive:S,deviceRect:se,cullRect:ce,effects:M,pass:"picking:".concat(p)});Ye=Cae({...Fe,deviceX:j[0],deviceY:j[1],deviceRadius:ie,deviceRect:se})}else Ye={pickedColor:null,pickedObjectIndex:-1};let nt;if(Ye.pickedLayer&&v&&this.depthFBO){const{pickedColors:Fe}=this._drawAndSample({layers:[Ye.pickedLayer],views:n,viewports:r,onViewportActive:S,deviceRect:{x:Ye.pickedX,y:Ye.pickedY,width:1,height:1},cullRect:ce,effects:M,pass:"picking:".concat(p,":z")},!0);Fe[3]&&(nt=Fe[0])}Ye.pickedLayer&&Qe+1<o&&(He.add(Ye.pickedLayer),Ye.pickedLayer.disablePickingIndex(Ye.pickedObjectIndex)),me=Pae({pickInfo:Ye,lastPickedInfo:this.lastPickedInfo,mode:p,layers:k,viewports:r,x:i,y:s,z:nt,pixelRatio:F});for(const Fe of me.values())Fe.layer&&Ee.push(Fe);if(!Ye.pickedColor)break}for(const Qe of He)Qe.restorePickingColors();return{result:Ee,emptyInfo:me.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:l=1,height:o=1,mode:p="query",maxObjects:v=null,onViewportActive:S,effects:M}){const k=this._getPickable(e);if(!k)return[];this._resizeBuffer();const F=vd(this.gl),H=Tw(this.gl,[i,s],!0),j=H.x,ie=H.y+H.height,Y=Tw(this.gl,[i+l,s+o],!0),J=Y.x+Y.width,se=Y.y,ce={x:j,y:se,width:J-j,height:ie-se},me=this._drawAndSample({layers:k,views:n,viewports:r,onViewportActive:S,deviceRect:ce,cullRect:{x:i,y:s,width:l,height:o},effects:M,pass:"picking:".concat(p)}),Ee=Mae(me),He=new Map,Qe=Number.isFinite(v);for(let Ye=0;Ye<Ee.length&&!(Qe&&v&&He.size>=v);Ye++){const nt=Ee[Ye];let Fe={color:nt.pickedColor,layer:null,index:nt.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:F};Fe=LO({layer:nt.pickedLayer,info:Fe,mode:p}),He.has(Fe.object)||He.set(Fe.object,Fe)}return Array.from(He.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:l,effects:o,pass:p},v=!1){const S=v?this.depthFBO:this.pickingFBO,M={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:S,deviceRect:s,cullRect:l,effects:o,pass:p,pickZ:v,preRenderStats:{}};for(const J of o)J.useInPicking&&(M.preRenderStats[J.id]=J.preRender(this.gl,M));const{decodePickingColor:k}=this.pickLayersPass.render(M),{x:F,y:H,width:j,height:ie}=s,Y=new(v?Float32Array:Uint8Array)(j*ie*4);return hv(S,{sourceX:F,sourceY:H,sourceWidth:j,sourceHeight:ie,target:Y}),{pickedColors:Y,decodePickingColor:k}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const l=Math.max(0,e-r),o=Math.max(0,n-r),p=Math.min(i,e+r+1)-l,v=Math.min(s,n+r+1)-o;return p<=0||v<=0?null:{x:l,y:o,width:p,height:v}}}const Lae={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Dae{constructor(e){oe(this,"el",null),oe(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Lae),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var DO={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],l=n.createElement("div"),o="function",p=Math.round,v=Math.abs,S=Date.now;function M(ge,Te,Ne){return setTimeout(se(ge,Ne),Te)}function k(ge,Te,Ne){return Array.isArray(ge)?(F(ge,Ne[Te],Ne),!0):!1}function F(ge,Te,Ne){var lt;if(ge)if(ge.forEach)ge.forEach(Te,Ne);else if(ge.length!==i)for(lt=0;lt<ge.length;)Te.call(Ne,ge[lt],lt,ge),lt++;else for(lt in ge)ge.hasOwnProperty(lt)&&Te.call(Ne,ge[lt],lt,ge)}function H(ge,Te,Ne){var lt="DEPRECATED METHOD: "+Te+`
`+Ne+` AT 
`;return function(){var bt=new Error("get-stack-trace"),Qt=bt&&bt.stack?bt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ln=e.console&&(e.console.warn||e.console.log);return Ln&&Ln.call(e.console,lt,Qt),ge.apply(this,arguments)}}var j;typeof Object.assign!="function"?j=function(Te){if(Te===i||Te===null)throw new TypeError("Cannot convert undefined or null to object");for(var Ne=Object(Te),lt=1;lt<arguments.length;lt++){var bt=arguments[lt];if(bt!==i&&bt!==null)for(var Qt in bt)bt.hasOwnProperty(Qt)&&(Ne[Qt]=bt[Qt])}return Ne}:j=Object.assign;var ie=H(function(Te,Ne,lt){for(var bt=Object.keys(Ne),Qt=0;Qt<bt.length;)(!lt||lt&&Te[bt[Qt]]===i)&&(Te[bt[Qt]]=Ne[bt[Qt]]),Qt++;return Te},"extend","Use `assign`."),Y=H(function(Te,Ne){return ie(Te,Ne,!0)},"merge","Use `assign`.");function J(ge,Te,Ne){var lt=Te.prototype,bt;bt=ge.prototype=Object.create(lt),bt.constructor=ge,bt._super=lt,Ne&&j(bt,Ne)}function se(ge,Te){return function(){return ge.apply(Te,arguments)}}function ce(ge,Te){return typeof ge==o?ge.apply(Te&&Te[0]||i,Te):ge}function me(ge,Te){return ge===i?Te:ge}function Ee(ge,Te,Ne){F(nt(Te),function(lt){ge.addEventListener(lt,Ne,!1)})}function He(ge,Te,Ne){F(nt(Te),function(lt){ge.removeEventListener(lt,Ne,!1)})}function Qe(ge,Te){for(;ge;){if(ge==Te)return!0;ge=ge.parentNode}return!1}function Ye(ge,Te){return ge.indexOf(Te)>-1}function nt(ge){return ge.trim().split(/\s+/g)}function Fe(ge,Te,Ne){if(ge.indexOf&&!Ne)return ge.indexOf(Te);for(var lt=0;lt<ge.length;){if(Ne&&ge[lt][Ne]==Te||!Ne&&ge[lt]===Te)return lt;lt++}return-1}function tt(ge){return Array.prototype.slice.call(ge,0)}function Ze(ge,Te,Ne){for(var lt=[],bt=[],Qt=0;Qt<ge.length;){var Ln=Te?ge[Qt][Te]:ge[Qt];Fe(bt,Ln)<0&&lt.push(ge[Qt]),bt[Qt]=Ln,Qt++}return Ne&&(Te?lt=lt.sort(function(en,Br){return en[Te]>Br[Te]}):lt=lt.sort()),lt}function pt(ge,Te){for(var Ne,lt,bt=Te[0].toUpperCase()+Te.slice(1),Qt=0;Qt<s.length;){if(Ne=s[Qt],lt=Ne?Ne+bt:Te,lt in ge)return lt;Qt++}return i}var Yt=1;function Et(){return Yt++}function un(ge){var Te=ge.ownerDocument||ge;return Te.defaultView||Te.parentWindow||e}var _t=/mobile|tablet|ip(ad|hone|od)|android/i,Tt="ontouchstart"in e,Jt=pt(e,"PointerEvent")!==i,In=Tt&&_t.test(navigator.userAgent),Tn="touch",kr="pen",er="mouse",or="kinect",hr=25,Un=1,Cr=2,wt=4,rn=8,Mn=1,xt=2,tr=4,Hn=8,xr=16,lr=xt|tr,nr=Hn|xr,ri=lr|nr,Vn=["x","y"],ki=["clientX","clientY"];function Qn(ge,Te){var Ne=this;this.manager=ge,this.callback=Te,this.element=ge.element,this.target=ge.options.inputTarget,this.domHandler=function(lt){ce(ge.options.enable,[ge])&&Ne.handler(lt)},this.init()}Qn.prototype={handler:function(){},init:function(){this.evEl&&Ee(this.element,this.evEl,this.domHandler),this.evTarget&&Ee(this.target,this.evTarget,this.domHandler),this.evWin&&Ee(un(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&He(this.element,this.evEl,this.domHandler),this.evTarget&&He(this.target,this.evTarget,this.domHandler),this.evWin&&He(un(this.element),this.evWin,this.domHandler)}};function Gi(ge){var Te,Ne=ge.options.inputClass;return Ne?Te=Ne:Jt?Te=Xe:In?Te=Hi:Tt?Te=K:Te=Sn,new Te(ge,yo)}function yo(ge,Te,Ne){var lt=Ne.pointers.length,bt=Ne.changedPointers.length,Qt=Te&Un&&lt-bt===0,Ln=Te&(wt|rn)&&lt-bt===0;Ne.isFirst=!!Qt,Ne.isFinal=!!Ln,Qt&&(ge.session={}),Ne.eventType=Te,jr(ge,Ne),ge.emit("hammer.input",Ne),ge.recognize(Ne),ge.session.prevInput=Ne}function jr(ge,Te){var Ne=ge.session,lt=Te.pointers,bt=lt.length;Ne.firstInput||(Ne.firstInput=ls(Te)),bt>1&&!Ne.firstMultiple?Ne.firstMultiple=ls(Te):bt===1&&(Ne.firstMultiple=!1);var Qt=Ne.firstInput,Ln=Ne.firstMultiple,Dr=Ln?Ln.center:Qt.center,en=Te.center=ht(lt);Te.timeStamp=S(),Te.deltaTime=Te.timeStamp-Qt.timeStamp,Te.angle=Bn(Dr,en),Te.distance=bi(Dr,en),Ii(Ne,Te),Te.offsetDirection=Us(Te.deltaX,Te.deltaY);var Br=It(Te.deltaTime,Te.deltaX,Te.deltaY);Te.overallVelocityX=Br.x,Te.overallVelocityY=Br.y,Te.overallVelocity=v(Br.x)>v(Br.y)?Br.x:Br.y,Te.scale=Ln?Li(Ln.pointers,lt):1,Te.rotation=Ln?$i(Ln.pointers,lt):0,Te.maxPointers=Ne.prevInput?Te.pointers.length>Ne.prevInput.maxPointers?Te.pointers.length:Ne.prevInput.maxPointers:Te.pointers.length,$o(Ne,Te);var Gn=ge.element;Qe(Te.srcEvent.target,Gn)&&(Gn=Te.srcEvent.target),Te.target=Gn}function Ii(ge,Te){var Ne=Te.center,lt=ge.offsetDelta||{},bt=ge.prevDelta||{},Qt=ge.prevInput||{};(Te.eventType===Un||Qt.eventType===wt)&&(bt=ge.prevDelta={x:Qt.deltaX||0,y:Qt.deltaY||0},lt=ge.offsetDelta={x:Ne.x,y:Ne.y}),Te.deltaX=bt.x+(Ne.x-lt.x),Te.deltaY=bt.y+(Ne.y-lt.y)}function $o(ge,Te){var Ne=ge.lastInterval||Te,lt=Te.timeStamp-Ne.timeStamp,bt,Qt,Ln,Dr;if(Te.eventType!=rn&&(lt>hr||Ne.velocity===i)){var en=Te.deltaX-Ne.deltaX,Br=Te.deltaY-Ne.deltaY,Gn=It(lt,en,Br);Qt=Gn.x,Ln=Gn.y,bt=v(Gn.x)>v(Gn.y)?Gn.x:Gn.y,Dr=Us(en,Br),ge.lastInterval=Te}else bt=Ne.velocity,Qt=Ne.velocityX,Ln=Ne.velocityY,Dr=Ne.direction;Te.velocity=bt,Te.velocityX=Qt,Te.velocityY=Ln,Te.direction=Dr}function ls(ge){for(var Te=[],Ne=0;Ne<ge.pointers.length;)Te[Ne]={clientX:p(ge.pointers[Ne].clientX),clientY:p(ge.pointers[Ne].clientY)},Ne++;return{timeStamp:S(),pointers:Te,center:ht(Te),deltaX:ge.deltaX,deltaY:ge.deltaY}}function ht(ge){var Te=ge.length;if(Te===1)return{x:p(ge[0].clientX),y:p(ge[0].clientY)};for(var Ne=0,lt=0,bt=0;bt<Te;)Ne+=ge[bt].clientX,lt+=ge[bt].clientY,bt++;return{x:p(Ne/Te),y:p(lt/Te)}}function It(ge,Te,Ne){return{x:Te/ge||0,y:Ne/ge||0}}function Us(ge,Te){return ge===Te?Mn:v(ge)>=v(Te)?ge<0?xt:tr:Te<0?Hn:xr}function bi(ge,Te,Ne){Ne||(Ne=Vn);var lt=Te[Ne[0]]-ge[Ne[0]],bt=Te[Ne[1]]-ge[Ne[1]];return Math.sqrt(lt*lt+bt*bt)}function Bn(ge,Te,Ne){Ne||(Ne=Vn);var lt=Te[Ne[0]]-ge[Ne[0]],bt=Te[Ne[1]]-ge[Ne[1]];return Math.atan2(bt,lt)*180/Math.PI}function $i(ge,Te){return Bn(Te[1],Te[0],ki)+Bn(ge[1],ge[0],ki)}function Li(ge,Te){return bi(Te[0],Te[1],ki)/bi(ge[0],ge[1],ki)}var Di={mousedown:Un,mousemove:Cr,mouseup:wt},As="mousedown",Lt="mousemove mouseup";function Sn(){this.evEl=As,this.evWin=Lt,this.pressed=!1,Qn.apply(this,arguments)}J(Sn,Qn,{handler:function(Te){var Ne=Di[Te.type];Ne&Un&&Te.button===0&&(this.pressed=!0),Ne&Cr&&Te.which!==1&&(Ne=wt),this.pressed&&(Ne&wt&&(this.pressed=!1),this.callback(this.manager,Ne,{pointers:[Te],changedPointers:[Te],pointerType:er,srcEvent:Te}))}});var bn={pointerdown:Un,pointermove:Cr,pointerup:wt,pointercancel:rn,pointerout:rn},Rr={2:Tn,3:kr,4:er,5:or},Ts="pointerdown",yn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ts="MSPointerDown",yn="MSPointerMove MSPointerUp MSPointerCancel");function Xe(){this.evEl=Ts,this.evWin=yn,Qn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}J(Xe,Qn,{handler:function(Te){var Ne=this.store,lt=!1,bt=Te.type.toLowerCase().replace("ms",""),Qt=bn[bt],Ln=Rr[Te.pointerType]||Te.pointerType,Dr=Ln==Tn,en=Fe(Ne,Te.pointerId,"pointerId");Qt&Un&&(Te.button===0||Dr)?en<0&&(Ne.push(Te),en=Ne.length-1):Qt&(wt|rn)&&(lt=!0),!(en<0)&&(Ne[en]=Te,this.callback(this.manager,Qt,{pointers:Ne,changedPointers:[Te],pointerType:Ln,srcEvent:Te}),lt&&Ne.splice(en,1))}});var Zr={touchstart:Un,touchmove:Cr,touchend:wt,touchcancel:rn},Vs="touchstart",Fr="touchstart touchmove touchend touchcancel";function ci(){this.evTarget=Vs,this.evWin=Fr,this.started=!1,Qn.apply(this,arguments)}J(ci,Qn,{handler:function(Te){var Ne=Zr[Te.type];if(Ne===Un&&(this.started=!0),!!this.started){var lt=Yn.call(this,Te,Ne);Ne&(wt|rn)&&lt[0].length-lt[1].length===0&&(this.started=!1),this.callback(this.manager,Ne,{pointers:lt[0],changedPointers:lt[1],pointerType:Tn,srcEvent:Te})}}});function Yn(ge,Te){var Ne=tt(ge.touches),lt=tt(ge.changedTouches);return Te&(wt|rn)&&(Ne=Ze(Ne.concat(lt),"identifier",!0)),[Ne,lt]}var Gs={touchstart:Un,touchmove:Cr,touchend:wt,touchcancel:rn},ji="touchstart touchmove touchend touchcancel";function Hi(){this.evTarget=ji,this.targetIds={},Qn.apply(this,arguments)}J(Hi,Qn,{handler:function(Te){var Ne=Gs[Te.type],lt=Ri.call(this,Te,Ne);lt&&this.callback(this.manager,Ne,{pointers:lt[0],changedPointers:lt[1],pointerType:Tn,srcEvent:Te})}});function Ri(ge,Te){var Ne=tt(ge.touches),lt=this.targetIds;if(Te&(Un|Cr)&&Ne.length===1)return lt[Ne[0].identifier]=!0,[Ne,Ne];var bt,Qt,Ln=tt(ge.changedTouches),Dr=[],en=this.target;if(Qt=Ne.filter(function(Br){return Qe(Br.target,en)}),Te===Un)for(bt=0;bt<Qt.length;)lt[Qt[bt].identifier]=!0,bt++;for(bt=0;bt<Ln.length;)lt[Ln[bt].identifier]&&Dr.push(Ln[bt]),Te&(wt|rn)&&delete lt[Ln[bt].identifier],bt++;if(Dr.length)return[Ze(Qt.concat(Dr),"identifier",!0),Dr]}var us=2500,Nr=25;function K(){Qn.apply(this,arguments);var ge=se(this.handler,this);this.touch=new Hi(this.manager,ge),this.mouse=new Sn(this.manager,ge),this.primaryTouch=null,this.lastTouches=[]}J(K,Qn,{handler:function(Te,Ne,lt){var bt=lt.pointerType==Tn,Qt=lt.pointerType==er;if(!(Qt&&lt.sourceCapabilities&&lt.sourceCapabilities.firesTouchEvents)){if(bt)Q.call(this,Ne,lt);else if(Qt&&fe.call(this,lt))return;this.callback(Te,Ne,lt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Q(ge,Te){ge&Un?(this.primaryTouch=Te.changedPointers[0].identifier,te.call(this,Te)):ge&(wt|rn)&&te.call(this,Te)}function te(ge){var Te=ge.changedPointers[0];if(Te.identifier===this.primaryTouch){var Ne={x:Te.clientX,y:Te.clientY};this.lastTouches.push(Ne);var lt=this.lastTouches,bt=function(){var Qt=lt.indexOf(Ne);Qt>-1&&lt.splice(Qt,1)};setTimeout(bt,us)}}function fe(ge){for(var Te=ge.srcEvent.clientX,Ne=ge.srcEvent.clientY,lt=0;lt<this.lastTouches.length;lt++){var bt=this.lastTouches[lt],Qt=Math.abs(Te-bt.x),Ln=Math.abs(Ne-bt.y);if(Qt<=Nr&&Ln<=Nr)return!0}return!1}var a=pt(l.style,"touchAction"),G=a!==i,Le="compute",ke="auto",Pe="manipulation",Ie="none",qe="pan-x",At="pan-y",We=Rt();function dt(ge,Te){this.manager=ge,this.set(Te)}dt.prototype={set:function(ge){ge==Le&&(ge=this.compute()),G&&this.manager.element.style&&We[ge]&&(this.manager.element.style[a]=ge),this.actions=ge.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ge=[];return F(this.manager.recognizers,function(Te){ce(Te.options.enable,[Te])&&(ge=ge.concat(Te.getTouchAction()))}),Dt(ge.join(" "))},preventDefaults:function(ge){var Te=ge.srcEvent,Ne=ge.offsetDirection;if(this.manager.session.prevented){Te.preventDefault();return}var lt=this.actions,bt=Ye(lt,Ie)&&!We[Ie],Qt=Ye(lt,At)&&!We[At],Ln=Ye(lt,qe)&&!We[qe];if(bt){var Dr=ge.pointers.length===1,en=ge.distance<2,Br=ge.deltaTime<250;if(Dr&&en&&Br)return}if(!(Ln&&Qt)&&(bt||Qt&&Ne&lr||Ln&&Ne&nr))return this.preventSrc(Te)},preventSrc:function(ge){this.manager.session.prevented=!0,ge.preventDefault()}};function Dt(ge){if(Ye(ge,Ie))return Ie;var Te=Ye(ge,qe),Ne=Ye(ge,At);return Te&&Ne?Ie:Te||Ne?Te?qe:At:Ye(ge,Pe)?Pe:ke}function Rt(){if(!G)return!1;var ge={},Te=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ne){ge[Ne]=Te?e.CSS.supports("touch-action",Ne):!0}),ge}var sn=1,jt=2,pn=4,qt=8,an=qt,xn=16,Ft=32;function Oe(ge){this.options=j({},this.defaults,ge||{}),this.id=Et(),this.manager=null,this.options.enable=me(this.options.enable,!0),this.state=sn,this.simultaneous={},this.requireFail=[]}Oe.prototype={defaults:{},set:function(ge){return j(this.options,ge),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ge){if(k(ge,"recognizeWith",this))return this;var Te=this.simultaneous;return ge=cn(ge,this),Te[ge.id]||(Te[ge.id]=ge,ge.recognizeWith(this)),this},dropRecognizeWith:function(ge){return k(ge,"dropRecognizeWith",this)?this:(ge=cn(ge,this),delete this.simultaneous[ge.id],this)},requireFailure:function(ge){if(k(ge,"requireFailure",this))return this;var Te=this.requireFail;return ge=cn(ge,this),Fe(Te,ge)===-1&&(Te.push(ge),ge.requireFailure(this)),this},dropRequireFailure:function(ge){if(k(ge,"dropRequireFailure",this))return this;ge=cn(ge,this);var Te=Fe(this.requireFail,ge);return Te>-1&&this.requireFail.splice(Te,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ge){return!!this.simultaneous[ge.id]},emit:function(ge){var Te=this,Ne=this.state;function lt(bt){Te.manager.emit(bt,ge)}Ne<qt&&lt(Te.options.event+Mt(Ne)),lt(Te.options.event),ge.additionalEvent&&lt(ge.additionalEvent),Ne>=qt&&lt(Te.options.event+Mt(Ne))},tryEmit:function(ge){if(this.canEmit())return this.emit(ge);this.state=Ft},canEmit:function(){for(var ge=0;ge<this.requireFail.length;){if(!(this.requireFail[ge].state&(Ft|sn)))return!1;ge++}return!0},recognize:function(ge){var Te=j({},ge);if(!ce(this.options.enable,[this,Te])){this.reset(),this.state=Ft;return}this.state&(an|xn|Ft)&&(this.state=sn),this.state=this.process(Te),this.state&(jt|pn|qt|xn)&&this.tryEmit(Te)},process:function(ge){},getTouchAction:function(){},reset:function(){}};function Mt(ge){return ge&xn?"cancel":ge&qt?"end":ge&pn?"move":ge&jt?"start":""}function Ce(ge){return ge==xr?"down":ge==Hn?"up":ge==xt?"left":ge==tr?"right":""}function cn(ge,Te){var Ne=Te.manager;return Ne?Ne.get(ge):ge}function hi(){Oe.apply(this,arguments)}J(hi,Oe,{defaults:{pointers:1},attrTest:function(ge){var Te=this.options.pointers;return Te===0||ge.pointers.length===Te},process:function(ge){var Te=this.state,Ne=ge.eventType,lt=Te&(jt|pn),bt=this.attrTest(ge);return lt&&(Ne&rn||!bt)?Te|xn:lt||bt?Ne&wt?Te|qt:Te&jt?Te|pn:jt:Ft}});function rr(){hi.apply(this,arguments),this.pX=null,this.pY=null}J(rr,hi,{defaults:{event:"pan",threshold:10,pointers:1,direction:ri},getTouchAction:function(){var ge=this.options.direction,Te=[];return ge&lr&&Te.push(At),ge&nr&&Te.push(qe),Te},directionTest:function(ge){var Te=this.options,Ne=!0,lt=ge.distance,bt=ge.direction,Qt=ge.deltaX,Ln=ge.deltaY;return bt&Te.direction||(Te.direction&lr?(bt=Qt===0?Mn:Qt<0?xt:tr,Ne=Qt!=this.pX,lt=Math.abs(ge.deltaX)):(bt=Ln===0?Mn:Ln<0?Hn:xr,Ne=Ln!=this.pY,lt=Math.abs(ge.deltaY))),ge.direction=bt,Ne&&lt>Te.threshold&&bt&Te.direction},attrTest:function(ge){return hi.prototype.attrTest.call(this,ge)&&(this.state&jt||!(this.state&jt)&&this.directionTest(ge))},emit:function(ge){this.pX=ge.deltaX,this.pY=ge.deltaY;var Te=Ce(ge.direction);Te&&(ge.additionalEvent=this.options.event+Te),this._super.emit.call(this,ge)}});function pa(){hi.apply(this,arguments)}J(pa,hi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.scale-1)>this.options.threshold||this.state&jt)},emit:function(ge){if(ge.scale!==1){var Te=ge.scale<1?"in":"out";ge.additionalEvent=this.options.event+Te}this._super.emit.call(this,ge)}});function De(){Oe.apply(this,arguments),this._timer=null,this._input=null}J(De,Oe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ke]},process:function(ge){var Te=this.options,Ne=ge.pointers.length===Te.pointers,lt=ge.distance<Te.threshold,bt=ge.deltaTime>Te.time;if(this._input=ge,!lt||!Ne||ge.eventType&(wt|rn)&&!bt)this.reset();else if(ge.eventType&Un)this.reset(),this._timer=M(function(){this.state=an,this.tryEmit()},Te.time,this);else if(ge.eventType&wt)return an;return Ft},reset:function(){clearTimeout(this._timer)},emit:function(ge){this.state===an&&(ge&&ge.eventType&wt?this.manager.emit(this.options.event+"up",ge):(this._input.timeStamp=S(),this.manager.emit(this.options.event,this._input)))}});function Ha(){hi.apply(this,arguments)}J(Ha,hi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.rotation)>this.options.threshold||this.state&jt)}});function we(){hi.apply(this,arguments)}J(we,hi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:lr|nr,pointers:1},getTouchAction:function(){return rr.prototype.getTouchAction.call(this)},attrTest:function(ge){var Te=this.options.direction,Ne;return Te&(lr|nr)?Ne=ge.overallVelocity:Te&lr?Ne=ge.overallVelocityX:Te&nr&&(Ne=ge.overallVelocityY),this._super.attrTest.call(this,ge)&&Te&ge.offsetDirection&&ge.distance>this.options.threshold&&ge.maxPointers==this.options.pointers&&v(Ne)>this.options.velocity&&ge.eventType&wt},emit:function(ge){var Te=Ce(ge.offsetDirection);Te&&this.manager.emit(this.options.event+Te,ge),this.manager.emit(this.options.event,ge)}});function jo(){Oe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}J(jo,Oe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(ge){var Te=this.options,Ne=ge.pointers.length===Te.pointers,lt=ge.distance<Te.threshold,bt=ge.deltaTime<Te.time;if(this.reset(),ge.eventType&Un&&this.count===0)return this.failTimeout();if(lt&&bt&&Ne){if(ge.eventType!=wt)return this.failTimeout();var Qt=this.pTime?ge.timeStamp-this.pTime<Te.interval:!0,Ln=!this.pCenter||bi(this.pCenter,ge.center)<Te.posThreshold;this.pTime=ge.timeStamp,this.pCenter=ge.center,!Ln||!Qt?this.count=1:this.count+=1,this._input=ge;var Dr=this.count%Te.taps;if(Dr===0)return this.hasRequireFailures()?(this._timer=M(function(){this.state=an,this.tryEmit()},Te.interval,this),jt):an}return Ft},failTimeout:function(){return this._timer=M(function(){this.state=Ft},this.options.interval,this),Ft},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==an&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ss(ge,Te){return Te=Te||{},Te.recognizers=me(Te.recognizers,Ss.defaults.preset),new ga(ge,Te)}Ss.VERSION="2.0.7",Ss.defaults={domEvents:!1,touchAction:Le,enable:!0,inputTarget:null,inputClass:null,preset:[[Ha,{enable:!1}],[pa,{enable:!1},["rotate"]],[we,{direction:lr}],[rr,{direction:lr},["swipe"]],[jo],[jo,{event:"doubletap",taps:2},["tap"]],[De]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Wa=1,Qa=2;function ga(ge,Te){this.options=j({},Ss.defaults,Te||{}),this.options.inputTarget=this.options.inputTarget||ge,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ge,this.input=Gi(this),this.touchAction=new dt(this,this.options.touchAction),Ml(this,!0),F(this.options.recognizers,function(Ne){var lt=this.add(new Ne[0](Ne[1]));Ne[2]&&lt.recognizeWith(Ne[2]),Ne[3]&&lt.requireFailure(Ne[3])},this)}ga.prototype={set:function(ge){return j(this.options,ge),ge.touchAction&&this.touchAction.update(),ge.inputTarget&&(this.input.destroy(),this.input.target=ge.inputTarget,this.input.init()),this},stop:function(ge){this.session.stopped=ge?Qa:Wa},recognize:function(ge){var Te=this.session;if(!Te.stopped){this.touchAction.preventDefaults(ge);var Ne,lt=this.recognizers,bt=Te.curRecognizer;(!bt||bt&&bt.state&an)&&(bt=Te.curRecognizer=null);for(var Qt=0;Qt<lt.length;)Ne=lt[Qt],Te.stopped!==Qa&&(!bt||Ne==bt||Ne.canRecognizeWith(bt))?Ne.recognize(ge):Ne.reset(),!bt&&Ne.state&(jt|pn|qt)&&(bt=Te.curRecognizer=Ne),Qt++}},get:function(ge){if(ge instanceof Oe)return ge;for(var Te=this.recognizers,Ne=0;Ne<Te.length;Ne++)if(Te[Ne].options.event==ge)return Te[Ne];return null},add:function(ge){if(k(ge,"add",this))return this;var Te=this.get(ge.options.event);return Te&&this.remove(Te),this.recognizers.push(ge),ge.manager=this,this.touchAction.update(),ge},remove:function(ge){if(k(ge,"remove",this))return this;if(ge=this.get(ge),ge){var Te=this.recognizers,Ne=Fe(Te,ge);Ne!==-1&&(Te.splice(Ne,1),this.touchAction.update())}return this},on:function(ge,Te){if(ge!==i&&Te!==i){var Ne=this.handlers;return F(nt(ge),function(lt){Ne[lt]=Ne[lt]||[],Ne[lt].push(Te)}),this}},off:function(ge,Te){if(ge!==i){var Ne=this.handlers;return F(nt(ge),function(lt){Te?Ne[lt]&&Ne[lt].splice(Fe(Ne[lt],Te),1):delete Ne[lt]}),this}},emit:function(ge,Te){this.options.domEvents&&ma(ge,Te);var Ne=this.handlers[ge]&&this.handlers[ge].slice();if(!(!Ne||!Ne.length)){Te.type=ge,Te.preventDefault=function(){Te.srcEvent.preventDefault()};for(var lt=0;lt<Ne.length;)Ne[lt](Te),lt++}},destroy:function(){this.element&&Ml(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Ml(ge,Te){var Ne=ge.element;if(Ne.style){var lt;F(ge.options.cssProps,function(bt,Qt){lt=pt(Ne.style,Qt),Te?(ge.oldCssProps[lt]=Ne.style[lt],Ne.style[lt]=bt):Ne.style[lt]=ge.oldCssProps[lt]||""}),Te||(ge.oldCssProps={})}}function ma(ge,Te){var Ne=n.createEvent("Event");Ne.initEvent(ge,!0,!0),Ne.gesture=Te,Te.target.dispatchEvent(Ne)}j(Ss,{INPUT_START:Un,INPUT_MOVE:Cr,INPUT_END:wt,INPUT_CANCEL:rn,STATE_POSSIBLE:sn,STATE_BEGAN:jt,STATE_CHANGED:pn,STATE_ENDED:qt,STATE_RECOGNIZED:an,STATE_CANCELLED:xn,STATE_FAILED:Ft,DIRECTION_NONE:Mn,DIRECTION_LEFT:xt,DIRECTION_RIGHT:tr,DIRECTION_UP:Hn,DIRECTION_DOWN:xr,DIRECTION_HORIZONTAL:lr,DIRECTION_VERTICAL:nr,DIRECTION_ALL:ri,Manager:ga,Input:Qn,TouchAction:dt,TouchInput:Hi,MouseInput:Sn,PointerEventInput:Xe,TouchMouseInput:K,SingleTouchInput:ci,Recognizer:Oe,AttrRecognizer:hi,Tap:jo,Pan:rr,Swipe:we,Pinch:pa,Rotate:Ha,Press:De,on:Ee,off:He,each:F,merge:Y,extend:ie,assign:j,inherit:J,bindFn:se,prefixed:pt});var ii=typeof e<"u"?e:typeof self<"u"?self:{};ii.Hammer=Ss,typeof i=="function"&&i.amd?i(function(){return Ss}):t.exports?t.exports=Ss:e[r]=Ss})(window,document,"Hammer")})(DO);var zm=DO.exports;const Rae=B2(zm),zA=tL({__proto__:null,default:Rae},[zm]),RO=1,BO=2,eE=4,Bae={mousedown:RO,mousemove:BO,mouseup:eE};function zae(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function Oae(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(zae(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function Fae(t){t.prototype.handler=function(n){let r=Bae[n.type];r&RO&&n.button>=0&&(this.pressed=!0),r&BO&&n.which===0&&(r=eE),this.pressed&&(r&eE&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}Oae(zm.PointerEventInput);Fae(zm.MouseInput);const Nae=zm.Manager;class fv{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const Uae=zA?[[zA.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[zA.Rotate,{enable:!1}],[zA.Pinch,{enable:!1}],[zA.Swipe,{enable:!1}],[zA.Pan,{threshold:0,enable:!1}],[zA.Press,{enable:!1}],[zA.Tap,{event:"doubletap",taps:2,enable:!1}],[zA.Tap,{event:"anytap",enable:!1}],[zA.Tap,{enable:!1}]]:null,dI={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Vae={doubletap:["tap"]},Gae={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},OS={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},$ae={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},pI={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},jae=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",L0=typeof window<"u"?window:global;let tE=!1;try{const t={get passive(){return tE=!0,!0}};L0.addEventListener("test",null,t),L0.removeEventListener("test",null)}catch{tE=!1}const Hae=jae.indexOf("firefox")!==-1,{WHEEL_EVENTS:Wae}=OS,gI="wheel",mI=4.000244140625,Qae=40,qae=.25;class Zae extends fv{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;L0.WheelEvent&&(Hae&&i.deltaMode===L0.WheelEvent.DOM_DELTA_PIXEL&&(s/=L0.devicePixelRatio),i.deltaMode===L0.WheelEvent.DOM_DELTA_LINE&&(s*=Qae)),s!==0&&s%mI===0&&(s=Math.floor(s/mI)),i.shiftKey&&s&&(s=s*qae),this.callback({type:gI,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(Wae),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,tE?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===gI&&(this.options.enable=n)}}const{MOUSE_EVENTS:Yae}=OS,yI="pointermove",_I="pointerover",vI="pointerout",xI="pointerenter",wI="pointerleave";class Xae extends fv{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(Yae),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===yI&&(this.enableMoveEvent=n),e===_I&&(this.enableOverEvent=n),e===vI&&(this.enableOutEvent=n),e===xI&&(this.enableEnterEvent=n),e===wI&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(_I,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(vI,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(xI,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(wI,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(yI,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:Kae}=OS,bI="keydown",EI="keyup";class Jae extends fv{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:bI,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:EI,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Kae),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===bI&&(this.enableDownEvent=n),e===EI&&(this.enableUpEvent=n)}}const TI="contextmenu";class ele extends fv{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:TI,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===TI&&(this.options.enable=n)}}const nE=1,l2=2,rE=4,tle={pointerdown:nE,pointermove:l2,pointerup:rE,mousedown:nE,mousemove:l2,mouseup:rE},nle=1,rle=2,ile=3,sle=0,ole=1,ale=2,lle=1,Ale=2,ule=4;function cle(t){const e=tle[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,l=!1,o=!1;return e===rE||e===l2&&!Number.isFinite(n)?(s=i===nle,l=i===rle,o=i===ile):e===l2?(s=!!(n&lle),l=!!(n&ule),o=!!(n&Ale)):e===nE&&(s=r===sle,l=r===ole,o=r===ale),{leftButton:s,middleButton:l,rightButton:o}}function hle(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,l={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:l}}const jw={srcElement:"root",priority:0};class fle{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:l,handlersByElement:o}=this;let p=jw;typeof r=="string"||r&&r.addEventListener?p={...jw,srcElement:r}:r&&(p={...jw,...r});let v=o.get(p.srcElement);v||(v=[],o.set(p.srcElement,v));const S={type:e,handler:n,srcElement:p.srcElement,priority:p.priority};i&&(S.once=!0),s&&(S.passive=!0),l.push(S),this._active=this._active||!S.passive;let M=v.length-1;for(;M>=0&&!(v[M].priority>=S.priority);)M--;v.splice(M+1,0,S)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const l=r[s];if(l.type===e&&l.handler===n){r.splice(s,1);const o=i.get(l.srcElement);o.splice(o.indexOf(l),1),o.length===0&&i.delete(l.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},l=()=>{e.handled=!0,i=!0},o=[];for(let p=0;p<r.length;p++){const{type:v,handler:S,once:M}=r[p];if(S({...e,type:v,stopPropagation:s,stopImmediatePropagation:l}),M&&o.push(r[p]),i)break}for(let p=0;p<o.length;p++){const{type:v,handler:S}=o[p];this.remove(v,S)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...cle(e),...hle(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const dle={events:null,recognizers:null,recognizerOptions:{},Manager:Nae,touchAction:"none",tabIndex:0};class ple{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,l=Gae[s.type];l&&this.manager.emit(l,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...dle,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||Uae}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(dI).forEach(i=>{const s=this.manager.get(i);s&&dI[i].forEach(l=>{s.recognizeWith(l)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const l=n.recognizerOptions[i];delete l.enable,s.set(l)}}this.wheelInput=new Zae(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Xae(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Jae(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new ele(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=Vae[e];s&&!this.options.recognizers&&s.forEach(l=>{const o=r.get(l);n?(o.requireFailure(e),i.dropRequireFailure(l)):o.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const S in e)this._addEventHandler(S,e[S],r,i,s);return}const{manager:l,events:o}=this,p=pI[e]||e;let v=o.get(p);v||(v=new fle(this),o.set(p,v),v.recognizerName=$ae[p]||p,l&&l.on(p,v.handleEvent)),v.add(e,n,r,i,s),v.isEmpty()||this._toggleRecognizer(v.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const l in e)this._removeEventHandler(l,e[l]);return}const{events:r}=this,i=pI[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:l}=s;let o=!1;for(const p of r.values())if(p.recognizerName===l&&!p.isEmpty()){o=!0;break}o||this._toggleRecognizer(l,!1)}}}function Fh(){}const gle=({isDragging:t})=>t?"grabbing":"grab",zO={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Fh,onResize:Fh,onViewStateChange:Fh,onInteractionStateChange:Fh,onBeforeRender:Fh,onAfterRender:Fh,onLoad:Fh,onError:t=>sr.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:gle,getTooltip:null,debug:!1,drawPickingColors:!1};class vf{constructor(e){oe(this,"props",void 0),oe(this,"width",0),oe(this,"height",0),oe(this,"userData",{}),oe(this,"canvas",null),oe(this,"viewManager",null),oe(this,"layerManager",null),oe(this,"effectManager",null),oe(this,"deckRenderer",null),oe(this,"deckPicker",null),oe(this,"eventManager",null),oe(this,"tooltip",null),oe(this,"metrics",void 0),oe(this,"animationLoop",void 0),oe(this,"stats",void 0),oe(this,"viewState",void 0),oe(this,"cursorState",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_pickRequest",void 0),oe(this,"_lastPointerDownInfo",null),oe(this,"_metricsCounter",void 0),oe(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),oe(this,"_onEvent",n=>{const r=XP[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),l=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=l,p=o&&(o[r.handler]||o.props[r.handler]),v=this.props[r.handler];let S=!1;p&&(S=p.call(o,l,n)),!S&&v&&v(l,n)}),oe(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...zO,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&sr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),QK()==="IE"&&sr.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new MO({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Ed.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,l,o,p;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(l=this.deckPicker)===null||l===void 0||l.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(p=this.tooltip)===null||p===void 0||p.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var v;(v=this.canvas.parentElement)===null||v===void 0||v.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&sr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&sr.removed("onLayerClick","onClick")(),e.initialViewState&&!sA(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),l=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||l,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Ni(this.viewManager),this.viewManager.views}getViewports(e){return Ni(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Ni(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Ni(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var l,o;this.width=i,this.height=s,(l=this.viewManager)===null||l===void 0||l.setProps({width:i,height:s}),(o=this.layerManager)===null||o===void 0||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:l,onError:o,onBeforeRender:p,onAfterRender:v,useDevicePixels:S}=e;return new _ne({width:n,height:r,useDevicePixels:S,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:M=>mz({...s,...M,canvas:this.canvas,debug:l,onContextLost:()=>this._onContextLost()}),onInitialize:M=>this._setGLContext(M.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:p,onAfterRender:v,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Yu({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,l=!1;for(const o of r){var n;s=o,l=((n=o.layer)===null||n===void 0?void 0:n.onHover(o,e.event))||l}if(!l&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,_S(e,{enable:!0,copyState:!0})),this.tooltip=new Dae(this.canvas),oc(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new uO;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new ple(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in XP)this.eventManager.on(i,this._onEvent);this.viewManager=new aae({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new oae(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new wae,this.deckRenderer=new Tae(e),this.deckPicker=new Iae(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;oc(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),sr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=Yh.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}oe(vf,"defaultProps",zO);oe(vf,"VERSION",AJ);class Hw{constructor(e,n){oe(this,"opts",void 0),oe(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const l=n.elementOffset||0;for(let o=0;o<i;++o)s[o]=r[l+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function mle(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function Gy(t){return t.stride||t.size*t.bytesPerElement}function OO(t,e){e.offset&&sr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Gy(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function yle(t,e){const n=OO(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class _le{constructor(e,n,r){oe(this,"gl",void 0),oe(this,"id",void 0),oe(this,"size",void 0),oe(this,"settings",void 0),oe(this,"value",void 0),oe(this,"doublePrecision",void 0),oe(this,"_buffer",void 0),oe(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:l}=n;l=Number.isFinite(l)?[l]:l||new Array(this.size).fill(0);let o;s?o=5126:!i&&n.isIndexed?o=e&&Mz(e,ti.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let p=mle(i||o||5126);this.doublePrecision=s,s&&n.fp64===!1&&(p=Float32Array),this.value=null,this.settings={...n,defaultType:p,defaultValue:l,logicalType:i,type:o,size:this.size,bytesPerElement:p.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new $r(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Gy(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Ed.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=yle(this.getAccessor(),n||{});return r[e]=new Hw(this,s.high),r["".concat(e,"64Low")]=i?new Hw(this,s.low):new Float32Array(this.size),r}if(n){const r=OO(this.getAccessor(),n);return{[e]:new Hw(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const l=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let p=0;p<s;)for(let v=0;v<i;v++){const S=n[p++];S<l[v]&&(l[v]=S),S>o[v]&&(o[v]=S)}e=[l,o]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof $r?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const l=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(l?2:1),i.stride=Gy(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=Gy(i);const{buffer:l,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Vw(s,i));const p=s.byteLength+o+i.stride*2;l.byteLength<p&&l.reallocate(p),l.setAccessor(null),l.subData({data:s,offset:o}),i.type=r.type||l.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Vw(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=Ed.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:l,byteOffset:o}=this;return l.byteLength<s.byteLength+o&&(l.reallocate(s.byteLength+o),n&&i&&l.subData({data:i instanceof Float64Array?Vw(i,this):i,offset:o})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&sr.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let l=s;for(;--l>=0;)n[r+l]=i[l];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let l=s;for(;--l>=0;)n[r+l]=Number.isFinite(e[l])?e[l]:i[l]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const SI=[],CI=[];function Fd(t,e=0,n=1/0){let r=SI;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(CI.length=t.length,r=CI):r=SI,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function FO(t){return t&&t[Symbol.asyncIterator]}function NO(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:l}=e,o=t.BYTES_PER_ELEMENT,p=r?r/o:n,v=i?i/o:0,S=Math.floor((t.length-v)/p);return(M,{index:k,target:F})=>{if(!s){const Y=k*p+v;for(let J=0;J<n;J++)F[J]=t[Y+J];return F}const H=s[k],j=s[k+1]||S;let ie;if(l){ie=new Array(j-H);for(let Y=H;Y<j;Y++){const J=Y*p+v;F=new Array(n);for(let se=0;se<n;se++)F[se]=t[J+se];ie[Y-H]=F}}else if(p===n)ie=t.subarray(H*n+v,j*n+v);else{ie=new t.constructor((j-H)*n);let Y=0;for(let J=H;J<j;J++){const se=J*p+v;for(let ce=0;ce<n;ce++)ie[Y++]=t[se+ce]}}return ie}}const vle=[],$y=[[0,1/0]];function xle(t,e){if(t===$y||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const l=t[s];l[1]<e[0]?(n.push(l),i=s+1):l[0]>e[1]?n.push(l):e=[Math.min(l[0],e[0]),Math.max(l[1],e[1])]}return n.splice(i,0,e),n}function Ww(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,l=t.end||n.length,o=e.length,p=l-r;if(o>p){n.set(e.subarray(0,p),r);return}if(n.set(e,r),!s)return;let v=o;for(;v<p;){const S=s(v,e);for(let M=0;M<i;M++)n[r+v]=S[M]||0,v++}}function wle({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return Ww({source:t,target:e,size:n,getData:r}),e;let l=0,o=0;const p=r&&((S,M)=>r(S+o,M)),v=Math.min(i.length,s.length);for(let S=1;S<v;S++){const M=i[S]*n,k=s[S]*n;Ww({source:t.subarray(l,M),target:e,start:o,end:k,size:n,getData:p}),l=M,o=k}return o<e.length&&Ww({source:[],target:e,start:o,size:n,getData:p}),e}const ble={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function UO(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...ble[n],...e,...t,type:n}}function VO(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function GO(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function $O(t){t.push(t.shift())}function FS(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,l=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*l}function jO({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=l=>l}){const l=n.doublePrecision&&n.value instanceof Float64Array?2:1,o=n.size*l,p=n.byteOffset,v=n.startIndices,S=i&&v,M=FS(n,e),k=n.isConstant;if(!S&&r>=M)return;const F=k?n.value:n.getBuffer().getData({srcByteOffset:p});if(n.settings.normalized&&!k){const Y=s;s=(J,se)=>n.normalizeConstant(Y(J,se))}const H=k?(Y,J)=>s(F,J):(Y,J)=>s(F.subarray(Y,Y+o),J),j=t.getData({length:r}),ie=new Float32Array(M);wle({source:j,target:ie,sourceStartIndices:i,targetStartIndices:v,size:o,getData:H}),t.byteLength<ie.byteLength+p&&t.reallocate(ie.byteLength+p),t.subData({data:ie,offset:p})}class NS extends _le{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:$y}),oe(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return UO(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=xle(this.state.updateRanges,[r,i])}else this.state.updateRanges=$y}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=vle}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==$y),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:l,noAlloc:o}}=this;let p=!0;if(l){for(const[v,S]of s)l.call(i,this,{data:n,startRow:v,endRow:S,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[v,S]of s){const M=Number.isFinite(v)?this.getVertexOffset(v):0,k=Number.isFinite(S)?this.getVertexOffset(S):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:M,endOffset:k})}this._checkAttributeArray()}else p=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),p}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const l=e;Ni(ArrayBuffer.isView(l.value),"invalid ".concat(i.accessor));const o=!!l.size&&l.size!==this.size;return r.binaryAccessor=NO(l.value,{size:l.size||this.size,stride:l.stride,offset:l.offset,startIndices:n,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:l}){if(e.constant)return;const{settings:o,state:p,value:v,size:S,startIndices:M}=e,{accessor:k,transform:F}=o,H=p.binaryAccessor||(typeof k=="function"?k:s[k]);Ni(typeof H=="function",'accessor "'.concat(k,'" is not a function'));let j=e.getVertexOffset(r);const{iterable:ie,objectInfo:Y}=Fd(n,r,i);for(const J of ie){Y.index++;let se=H(J,Y);if(F&&(se=F.call(this,se)),M){const ce=(Y.index<M.length-1?M[Y.index+1]:l)-M[Y.index];if(se&&Array.isArray(se[0])){let me=j;for(const Ee of se)e._normalizeValue(Ee,v,me),me+=S}else se&&se.length>S?v.set(se,j):(e._normalizeValue(se,Y.target,0),Xoe({target:v,source:Y.target,start:j,count:ce}));j+=ce*S}else e._normalizeValue(se,v,j),j+=S}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class Ele{constructor({gl:e,attribute:n,timeline:r}){oe(this,"gl",void 0),oe(this,"type","interpolation"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.transition=new Bm(r),this.attribute=n,this.attributeInTransition=new NS(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=Sle(e,n);const i={byteLength:0,usage:35050};this.buffers=[new $r(e,i),new $r(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;$O(i);const l={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)jO({buffer:o,...l});this.currentStartIndices=s.startIndices,this.currentLength=FS(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:VO(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const Tle=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function Sle(t,e){const n=GO(e.size);return new IS(t,{vs:Tle,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class Cle{constructor({gl:e,attribute:n,timeline:r}){oe(this,"gl",void 0),oe(this,"type","spring"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"texture",void 0),oe(this,"framebuffer",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Bm(r),this.attribute=n,this.attributeInTransition=new NS(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=Ple(e),this.framebuffer=kle(e,this.texture),this.transform=Mle(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new $r(e,i),new $r(e,i),new $r(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,l={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)jO({buffer:o,...l});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=FS(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:VO(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const l=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:l.stiffness,damping:l.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),$O(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),hv(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function Mle(t,e,n){const r=GO(e.size);return new IS(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function Ple(t){return new da(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function kle(t,e){return new os(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const Ile={interpolation:Ele,spring:Cle};class Lle{constructor(e,{id:n,timeline:r}){oe(this,"id",void 0),oe(this,"isSupported",void 0),oe(this,"gl",void 0),oe(this,"timeline",void 0),oe(this,"transitions",void 0),oe(this,"needsRedraw",void 0),oe(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=IS.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],l=s.getTransitionSetting(n);l&&this._updateAttribute(i,s,l)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){sr.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const l=Ile[r.type];l?this.transitions[e]=new l({attribute:n,timeline:this.timeline,gl:this.gl}):(sr.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const MI="attributeManager.invalidate",Dle="attributeManager.updateStart",Rle="attributeManager.updateEnd",Ble="attribute.updateStart",zle="attribute.allocate",Ole="attribute.updateEnd";class Fle{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"attributes",void 0),oe(this,"updateTriggers",void 0),oe(this,"needsRedraw",void 0),oe(this,"userData",void 0),oe(this,"stats",void 0),oe(this,"attributeTransitionManager",void 0),oe(this,"mergeBoundsMemoized",Rm(boe)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Lle(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);uo(MI,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);uo(MI,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:l={},context:o={}}){let p=!1;uo(Dle,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const v in this.attributes){const S=this.attributes[v],M=S.settings.accessor;S.startIndices=r,S.numInstances=n,s[v]&&sr.removed("props.".concat(v),"data.attributes.".concat(v))(),S.setExternalBuffer(l[v])||S.setBinaryValue(typeof M=="string"?l[M]:void 0,e.startIndices)||typeof M=="string"&&!l[M]&&S.setConstantValue(s[M])||S.needsUpdate()&&(p=!0,this._updateAttribute({attribute:S,numInstances:n,data:e,props:s,context:o})),this.needsRedraw=this.needsRedraw||S.needsRedraw()}p&&uo(Rle,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const l=n[s];l.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=l)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new NS(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(l=>{const o=r[l];o&&o.setNeedsUpdate(o.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(uo(Ble,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&uo(zle,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,uo(Ole,n,r))}}class Nle extends Bm{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,l=s(e/i);this._value=wl(n,r,l)}}const PI=1e-5;function kI(t,e,n,r,i){const s=e-t,o=(n-e)*i,p=-s*r;return o+p+s+e}function Ule(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let l=0;l<n.length;l++)s[l]=kI(t[l],e[l],n[l],r,i);return s}return kI(t,e,n,r,i)}function II(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class Vle extends Bm{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:l=e}=this;let o=Ule(s,l,n,r,i);const p=II(o,n),v=II(o,l);p<PI&&v<PI&&(o=n,this.end()),this._prevValue=l,this._currValue=o}}const Gle={interpolation:Nle,spring:Vle};class $le{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const p=s.get(e),{value:v=p.settings.fromValue}=p;n=v,this.remove(e)}if(i=UO(i),!i)return;const l=Gle[i.type];if(!l){sr.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new l(this.timeline);o.start({...i,fromValue:n,toValue:r}),s.set(e,o)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function jle(t){const e=t[ch];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function Hle(t,e){const n=HO({newProps:t,oldProps:e,propTypes:t[ch],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=Qle(t,e);let i=!1;return r||(i=qle(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Zle(t,e),transitionsChanged:Wle(t,e)}}function Wle(t,e){if(!t.transitions)return!1;const n={},r=t[ch];let i=!1;for(const s in t.transitions){const l=r[s],o=l&&l.type;(o==="number"||o==="color"||o==="array")&&iE(t[s],e[s],l)&&(n[s]=!0,i=!0)}return i?n:!1}function HO({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const l=iE(t[s],e[s],r[s]);if(l)return"".concat(i,".").concat(s," ").concat(l)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const l=iE(t[s],e[s],r[s]);if(l)return"".concat(i,".").concat(s," ").concat(l)}}return!1}function iE(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function Qle(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function qle(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&LI(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&LI(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function Zle(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function LI(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},HO({oldProps:i,newProps:r,triggerName:n})}const Yle="count(): argument not an object",Xle="count(): argument not a container";function Kle(t){if(!eAe(t))throw new Error(Yle);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Jle(t))return Object.keys(t).length;throw new Error(Xle)}function Jle(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function eAe(t){return t!==null&&typeof t=="object"}function sE(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const tAe={10241:9987,10240:9729,10242:33071,10243:33071},oE={};function nAe(t,e,n,r){if(n instanceof da)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new da(e,{...n,parameters:{...tAe,...i,...r}});return oE[s.id]=t,s}function rAe(t,e){!e||!(e instanceof da)||oE[e.id]===t&&(e.delete(),delete oE[e.id])}const iAe={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||aE(t)&&(t.length===3||t.length===4)},equal(t,e,n){return sA(t,e,1)}},accessor:{validate(t,e){const n=A2(t);return n==="function"||n===A2(e.value)},equal(t,e,n){return typeof e=="function"?!0:sA(t,e,1)}},array:{validate(t,e){return e.optional&&!t||aE(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?sA(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?sA(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:nAe(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{rAe(n.id,t)}}};function sAe(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const l=s?.deprecatedFor;if(l)r[i]=Array.isArray(l)?l:[l];else{const o=oAe(i,s);e[i]=o,n[i]=o.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function oAe(t,e){switch(A2(e)){case"object":return kp(t,e);case"array":return kp(t,{type:"array",value:e,compare:!1});case"boolean":return kp(t,{type:"boolean",value:e});case"number":return kp(t,{type:"number",value:e});case"function":return kp(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function kp(t,e){return"type"in e?{name:t,...iAe[e.type],...e}:"value"in e?{name:t,type:A2(e.value),...e}:{name:t,type:"object",value:e}}function aE(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function A2(t){return aE(t)?"array":t===null?"null":typeof t}function aAe(t,e){let n;for(let s=e.length-1;s>=0;s--){const l=e[s];"extensions"in l&&(n=l.extensions)}const r=lE(t.constructor,n),i=Object.create(r);i[a2]=t,i[yf]={},i[Kc]={};for(let s=0;s<e.length;++s){const l=e[s];for(const o in l)i[o]=l[o]}return Object.freeze(i),i}const lAe="_mergedDefaultProps";function lE(t,e){let n=lAe;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=WO(t,n);return r||(t[n]=AAe(t,e||[]))}function AAe(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=lE(r),s=WO(t,"defaultProps")||{},l=sAe(s),o=Object.assign(Object.create(null),i,l.defaultProps),p=Object.assign(Object.create(null),i?.[ch],l.propTypes),v=Object.assign(Object.create(null),i?.[$w],l.deprecatedProps);for(const S of e){const M=lE(S.constructor);M&&(Object.assign(o,M),Object.assign(p,M[ch]),Object.assign(v,M[$w]))}return uAe(o,t),hAe(o,p),cAe(o,v),o[ch]=p,o[$w]=v,e.length===0&&!US(t,"_propTypes")&&(t._propTypes=p),o}function uAe(t,e){const n=dAe(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function cAe(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])US(this,s)||(this[s]=r);sr.deprecated(i,e[n].join("/"))()}})}function hAe(t,e){const n={},r={};for(const i in e){const s=e[i],{name:l,value:o}=s;s.async&&(n[l]=o,r[l]=fAe(l))}t[K0]=n,t[yf]={},Object.defineProperties(t,r)}function fAe(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||FO(e)?this[yf][t]=e:this[Kc][t]=e},get(){if(this[Kc]){if(t in this[Kc])return this[Kc][t]||this[K0][t];if(t in this[yf]){const e=this[a2]&&this[a2].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[K0][t]}}return this[K0][t]}}}function US(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function WO(t,e){return US(t,e)&&t[e]}function dAe(t){const e=t.componentName;return e||sr.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let pAe=0;class VS{constructor(...e){oe(this,"id",void 0),oe(this,"props",void 0),oe(this,"count",void 0),this.props=aAe(this,e),this.id=this.props.id,this.count=pAe++}clone(e){const{props:n}=this,r={};for(const i in n[K0])i in n[Kc]?r[i]=n[Kc][i]:i in n[yf]&&(r[i]=n[yf][i]);return new this.constructor({...n,...r,...e})}}oe(VS,"componentName","Component");oe(VS,"defaultProps",{});const gAe=Object.freeze({});class mAe{constructor(e){oe(this,"component",void 0),oe(this,"onAsyncPropUpdated",void 0),oe(this,"asyncProps",void 0),oe(this,"oldProps",void 0),oe(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||gAe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[a2]||this.component;const n=e[Kc]||{},r=e[yf]||e,i=e[K0]||{};for(const s in n){const l=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,l),n[s]=this.getAsyncProp(s)}for(const s in r){const l=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,l)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(FO(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],l=0;for await(const o of n){if(!this.component)return;const{dataTransform:p}=this.component.props;p?s=p(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:l,endRow:s.length}]}),l=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[ch];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class yAe extends mAe{constructor({attributeManager:e,layer:n}){super(n),oe(this,"attributeManager",void 0),oe(this,"needsRedraw",void 0),oe(this,"needsUpdate",void 0),oe(this,"subLayers",void 0),oe(this,"usesPickingColorCache",void 0),oe(this,"hasPickingBuffer",void 0),oe(this,"changeFlags",void 0),oe(this,"viewport",void 0),oe(this,"uniformTransitions",void 0),oe(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r?.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const _Ae="layer.changeFlag",vAe="layer.initialize",xAe="layer.update",wAe="layer.finalize",bAe="layer.matched",DI=2**24-1,EAe=Object.freeze([]),TAe=Rm(({oldViewport:t,viewport:e})=>t.equals(e));let OA=new Uint8ClampedArray(0);const SAe={data:{type:"data",value:EAe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:l}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var o;i={...i,fetch:{...(o=i)===null||o===void 0?void 0:o.fetch,signal:s}}}let p=l.contains(t);return!p&&!i&&(l.add({resourceId:t,data:Z_(t,r),persistent:!1}),p=!0),p?l.subscribe({resourceId:t,onChange:v=>{var S;return(S=n.internalState)===null||S===void 0?void 0:S.reloadAsyncProp(e,v)},consumerId:n.id,requestId:e}):Z_(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Ar.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class mA extends VS{constructor(...e){super(...e),oe(this,"internalState",null),oe(this,"lifecycle",d0.NO_STATE),oe(this,"context",void 0),oe(this,"state",void 0),oe(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Ni(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=TO(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,l]=xO(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,l]}unproject(e){return Ni(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Ni(this.internalState);const r=this.internalState.viewport||this.context.viewport;return Poe(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Ar.DEFAULT||e===Ar.LNGLAT||e===Ar.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Ni(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Kle(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=sE(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,l=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==l){this.internalState.hasPickingBuffer=l;const{pickingColors:o,instancePickingColors:p}=n.attributes,v=o||p;v&&(l&&v.constant&&(v.constant=!1,n.invalidate(v.id)),!v.value&&!l&&(v.constant=!0,v.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,l;(s=this.context)===null||s===void 0||(l=s.onError)===null||l===void 0||l.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!TAe({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(OA.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>DI&&sr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),OA=Ed.allocate(OA,n,{size:3,copy:!0,maxCount:Math.max(n,DI)});const i=Math.floor(OA.length/3),s=[];for(let l=r;l<i;l++)this.encodePickingColor(l,s),OA[l*3+0]=s[0],OA[l*3+1]=s[1],OA[l*3+2]=s[2]}e.value=OA.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,l=s&&n.attributes&&n.attributes[s.id];if(l&&l.value){const o=l.value,p=this.encodePickingColor(e);for(let v=0;v<n.length;v++){const S=s.getVertexOffset(v);o[S]===p[0]&&o[S+1]===p[1]&&o[S+2]===p[2]&&this._disablePickingIndex(v)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),l=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(l-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==OA.buffer&&(r.value=OA.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Ni(!this.internalState),Ni(Number.isFinite(this.props.coordinateSystem)),uo(vAe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new yAe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(sr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new $le(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){uo(bAe,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(uo(xAe,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,l=this._updateUniformTransition();i.propsInTransition=l,r.viewport=i.viewport||s,this.props=l;try{const o=this._getUpdateParams(),p=this.getModels();if(r.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const S of this.props.extensions)S.updateState.call(this,o,S);const v=this.getModels()[0]!==p[0];this._postUpdate(o,v)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){uo(wAe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const l=this.props.opacity;n.opacity=Math.pow(l,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:o}=this.props,p=o&&o(n)||[0,0];oc(s.gl,{polygonOffset:p}),cA(s.gl,r,()=>{const v={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const S of this.props.extensions)S.draw.call(this,v,S);this.draw(v)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const l=e[i],o=n[i];l&&Array.isArray(o)&&(n.dataChanged=Array.isArray(l)?o.concat(l):l,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&uo(_Ae,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=Hle(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){jle(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Fle(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:l,highlightedObjectIndex:o,highlightColor:p}=r;if(n||i.autoHighlight!==l||i.highlightedObjectIndex!==o||i.highlightColor!==p){const v={};l||(v.pickingSelectedColor=null),Array.isArray(p)&&(v.pickingHighlightColor=p),(n||o!==i.highlightedObjectIndex)&&(v.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(v)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}oe(mA,"defaultProps",SAe);oe(mA,"layerName","Layer");const CAe="compositeLayer.renderLayers";class Sr extends mA{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:l,getPolygonOffset:o,highlightedObjectIndex:p,autoHighlight:v,highlightColor:S,coordinateSystem:M,coordinateOrigin:k,wrapLongitude:F,positionFormat:H,modelMatrix:j,extensions:ie,fetch:Y,operation:J,_subLayerProps:se}=this.props,ce={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:l,getPolygonOffset:o,highlightedObjectIndex:p,autoHighlight:v,highlightColor:S,coordinateSystem:M,coordinateOrigin:k,wrapLongitude:F,positionFormat:H,modelMatrix:j,extensions:ie,fetch:Y,operation:J},me=se&&e.id&&se[e.id],Ee=me&&me.updateTriggers,He=e.id||"sublayer";if(me){const Qe=this.props[ch],Ye=e.type?e.type._propTypes:{};for(const nt in me){const Fe=Ye[nt]||Qe[nt];Fe&&Fe.type==="accessor"&&(me[nt]=this.getSubLayerAccessor(me[nt]))}}Object.assign(ce,e,me),ce.id="".concat(this.props.id,"-").concat(He),ce.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...Ee};for(const Qe of ie){const Ye=Qe.getSubLayerProps.call(this,Qe);Ye&&Object.assign(ce,Ye,{updateTriggers:Object.assign(ce.updateTriggers,Ye.updateTriggers)})}return ce}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=_f(s,Boolean),this.internalState.subLayers=r}uo(CAe,this,i,r);for(const s of r)s.parent=this}}oe(Sr,"layerName","CompositeLayer");const X1=Math.PI/180,RI=180/Math.PI,jy=6370972,D0=256;function MAe(){const t=D0/jy,e=Math.PI/180*D0;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class PAe extends Nf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,nearZMultiplier:s=.1,farZMultiplier:l=2,resolution:o=10}=e;let{height:p,altitude:v=1.5}=e;p=p||1,v=Math.max(.75,v);const S=new ca().lookAt({eye:[0,-v,0],up:[0,0,1]}),M=Math.pow(2,i);S.rotateX(n*X1),S.rotateZ(-r*X1),S.scale(M/p);const k=Math.atan(.5/v),F=D0*2*M/p;super({...e,height:p,viewMatrix:S,longitude:r,latitude:n,zoom:i,distanceScales:MAe(),fovyRadians:k*2,focalDistance:v,near:s,far:Math.min(2,1/F+1)*v*l}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"resolution",void 0),this.latitude=n,this.longitude=r,this.resolution=o}get projectionMode(){return rA.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),l=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],s[0],i[0],l[0]),Math.min(r[1],s[1],i[1],l[1]),Math.max(r[0],s[0],i[0],l[0]),Math.max(r[1],s[1],i[1],l[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,l]=e,o=n?s:this.height-s,{pixelUnprojectionMatrix:p}=this;let v;if(Number.isFinite(l))v=Qw(p,[i,o,l,1]);else{const F=Qw(p,[i,o,-1,1]),H=Qw(p,[i,o,1,1]),j=((r||0)/jy+1)*D0,ie=Bw(Xz([],F,H)),Y=Bw(F),J=Bw(H),ce=4*((4*Y*J-(ie-Y-J)**2)/16)/ie,me=Math.sqrt(Y-ce),Ee=Math.sqrt(Math.max(0,j*j-ce)),He=(me-Ee)/Math.sqrt(ie);v=Rre([],F,H,He)}const[S,M,k]=this.unprojectPosition(v);return Number.isFinite(l)?[S,M,k]:Number.isFinite(r)?[S,M,r]:[S,M]}projectPosition(e){const[n,r,i=0]=e,s=n*X1,l=r*X1,o=Math.cos(l),p=(i/jy+1)*D0;return[Math.sin(s)*o*p,-Math.cos(s)*o*p,Math.sin(l)*p]}unprojectPosition(e){const[n,r,i]=e,s=Kz(e),l=Math.asin(i/s),p=Math.atan2(n,-r)*RI,v=l*RI,S=(s/D0-1)*jy;return[p,v,S]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const r=this.unproject(n);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function Qw(t,e){const n=Od([],e,t);return kS(n,n,1/n[3]),n}class GS{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){oe(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&sA(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],l=this.props[i];r[i]=l,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof l=="function"&&(r[i]=this.getSubLayerAccessor(l)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}oe(GS,"defaultProps",{});oe(GS,"extensionName","LayerExtension");const qw={bearing:0,pitch:0,position:[0,0,0]},kAe={speed:1.2,curve:1.414};class yh extends PO{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),oe(this,"opts",void 0),this.opts={...kAe,...e}}interpolateProps(e,n,r){const i=soe(e,n,r,this.opts);for(const s in qw)i[s]=wl(e[s]||qw[s],n[s]||qw[s],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=ooe(e,n,this.opts)),r}}class QO{constructor(e){oe(this,"opts",void 0),oe(this,"typedArrayManager",void 0),oe(this,"indexStarts",[0]),oe(this,"vertexStarts",[0]),oe(this,"vertexCount",0),oe(this,"instanceCount",0),oe(this,"attributes",void 0),oe(this,"_attributeDefs",void 0),oe(this,"data",void 0),oe(this,"getGeometry",void 0),oe(this,"geometryBuffer",void 0),oe(this,"buffers",void 0),oe(this,"positionSize",void 0),oe(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=Ed,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:l,dataChanged:o,normalize:p=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(l==="XY"?2:3),this.buffers=r,this.normalize=p,s&&(Ni(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),p||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(o))for(const v of o)this._rebuildGeometry(v);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?NO(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:l}=this;for(const o in s)if(o in i)l.release(r[o]),r[o]=null;else{const p=s[o];p.copy=n,r[o]=l.allocate(r[o],e,p)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:l,objectInfo:o}=Fd(i,n,r);for(const p of l){o.index++;const v=s?s(p,o):null;e(v,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:l}=this,{startRow:o=0,endRow:p=1/0}=e||{},v={};if(e||(n=[0],r=[0]),this.normalize||!l)this._forEachGeometry((M,k)=>{const F=M&&this.normalizeGeometry(M);v[k]=F,r[k+1]=r[k]+(F?this.getGeometrySize(F):0)},o,p),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(l))i=i||l.length/this.positionSize;else if(l instanceof $r){const M=l.accessor.stride||this.positionSize*4;i=i||l.byteLength/M}else if(l.buffer){const M=l.stride||this.positionSize*4;i=i||l.buffer.byteLength/M}else if(l.value){const M=l.value,k=l.stride/M.BYTES_PER_ELEMENT||this.positionSize;i=i||M.length/k}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const S={};this._forEachGeometry((M,k)=>{const F=v[k]||M;S.vertexStart=r[k],S.indexStart=n[k];const H=k<r.length-1?r[k+1]:i;S.geometrySize=H-r[k],S.geometryIndex=k,this.updateGeometryAttributes(F,S)},o,p),this.vertexCount=n[n.length-1]}}const IAe=new Uint16Array([0,2,1,0,3,2]),LAe=new Float32Array([0,1,0,0,1,0,1,1]);function DAe(t,e){if(!e)return RAe(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,s=Math.ceil(r/e)+1,l=(i-1)*(s-1)*6,o=new Uint32Array(l),p=new Float32Array(i*s*2),v=new Float64Array(i*s*3);let S=0,M=0;for(let k=0;k<i;k++){const F=k/(i-1);for(let H=0;H<s;H++){const j=H/(s-1),ie=BAe(t,F,j);v[S*3+0]=ie[0],v[S*3+1]=ie[1],v[S*3+2]=ie[2]||0,p[S*2+0]=F,p[S*2+1]=1-j,k>0&&H>0&&(o[M++]=S-s,o[M++]=S-s-1,o[M++]=S-1,o[M++]=S-s,o[M++]=S-1,o[M++]=S),S++}}return{vertexCount:l,positions:v,indices:o,texCoords:p}}function RAe(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:IAe,texCoords:LAe}}function BAe(t,e,n){return wl(wl(t[0],t[1],n),wl(t[3],t[2],n),e)}const zAe=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,OAe=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,FAe=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(OAe,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),NAe={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Ar.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class Om extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:zAe,fs:FAe,modules:[Uf,Vf]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){const i=this.getAttributeManager();if(r.extensionsChanged){var s;const{gl:l}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(l),i.invalidateAll()}if(e.bounds!==n.bounds){const l=this.state.mesh,o=this._createMesh();this.state.model.setVertexCount(o.vertexCount);for(const p in o)l&&l[p]!==o[p]&&i.invalidate(p);this.setState({mesh:o,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:s}=n;r.index=0;const l=UAe(r.color),o=[Math.floor(l[0]*i),Math.floor(l[1]*s)];return r.bitmap={size:{width:i,height:s},uv:l,pixel:o},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return BI(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),DAe(n,this.context.viewport.resolution)}_getModel(e){return e?new ac(e,{...this.getShaders(),id:this.props.id,geometry:new Zu({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:s,bounds:l,disablePicking:o}=this.state,{image:p,desaturate:v,transparentColor:S,tintColor:M}=this.props;r.pickingActive&&o||p&&i&&i.setUniforms(n).setUniforms({bitmapTexture:p,desaturate:v,transparentColor:S.map(k=>k/255),tintColor:M.slice(0,3).map(k=>k/255),coordinateConversion:s,bounds:l}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=Ar;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:s}=this.props;if(!BI(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const l=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&l===n)return{coordinateConversion:-1,bounds:s};if(i===n&&l===e){const o=dA([s[0],s[1]]),p=dA([s[2],s[3]]);return{coordinateConversion:1,bounds:[o[0],o[1],p[0],p[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}oe(Om,"layerName","BitmapLayer");oe(Om,"defaultProps",NAe);function UAe(t){const[e,n,r]=t,i=(r&240)/256,s=(r&15)/16;return[(e+s)/256,(n+i)/256]}function BI(t){return Number.isFinite(t[0])}const VAe=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,GAe=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,$Ae=1024,jAe=4,zI=()=>{},OI={10241:9987,10240:9729,10242:33071,10243:33071};function HAe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function WAe(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),l=Math.floor(e.height*i);return i===1?{data:e,width:s,height:l}:(t.canvas.height=l,t.canvas.width=s,t.clearRect(0,0,s,l),t.drawImage(e,0,0,e.width,e.height,0,0,s,l),{data:t.canvas,width:s,height:l})}function Kg(t){return t&&(t.id||t.url)}function QAe(t,e,n,r){const i=t.width,s=t.height,l=new da(t.gl,{width:e,height:n,parameters:r});return jee(t,l,{targetY:0,width:i,height:s}),t.delete(),l}function FI(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],l=Kg(i);t[l]={...i,x:s,y:n}}}function qAe({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:l}){let o=[];for(let p=0;p<t.length;p++){const v=t[p],S=Kg(v);if(!n[S]){const{height:M,width:k}=v;r+k+e>l&&(FI(n,o,i),r=0,i=s+i+e,s=0,o=[]),o.push({icon:v,xOffset:r}),r=r+k+e,s=Math.max(s,M)}}return o.length>0&&FI(n,o,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:l,canvasHeight:HAe(s+i+e)}}function ZAe(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Fd(t);for(const l of i){s.index++;const o=e(l,s),p=Kg(o);if(!o)throw new Error("Icon is missing.");if(!o.url)throw new Error("Icon url is missing.");!r[p]&&(!n[p]||o.url!==n[p].url)&&(r[p]={...o,source:l,sourceIndex:s.index})}return r}class YAe{constructor(e,{onUpdate:n=zI,onError:r=zI}){oe(this,"gl",void 0),oe(this,"onUpdate",void 0),oe(this,"onError",void 0),oe(this,"_loadOptions",null),oe(this,"_texture",null),oe(this,"_externalTexture",null),oe(this,"_mapping",{}),oe(this,"_textureParameters",null),oe(this,"_pendingCount",0),oe(this,"_autoPacking",!1),oe(this,"_xOffset",0),oe(this,"_yOffset",0),oe(this,"_rowHeight",0),oe(this,"_buffer",jAe),oe(this,"_canvasWidth",$Ae),oe(this,"_canvasHeight",0),oe(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Kg(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var l;(l=this._texture)===null||l===void 0||l.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(ZAe(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:l,rowHeight:o,canvasHeight:p}=qAe({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=s,this._yOffset=l,this._canvasHeight=p,this._texture||(this._texture=new da(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||OI})),this._texture.height!==this._canvasHeight&&(this._texture=QAe(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||OI)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,Z_(r.url,this._loadOptions).then(i=>{const s=Kg(r),l=this._mapping[s],{x:o,y:p,width:v,height:S}=l,{data:M,width:k,height:F}=WAe(n,i,v,S);this._texture.setSubImageData({data:M,x:o+(v-k)/2,y:p+(S-F)/2,width:k,height:F}),l.width=k,l.height=F,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const qO=[0,0,0,255],XAe={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:qO},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class dv extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:VAe,fs:GAe,modules:[Uf,Vf]})}initializeState(){this.state={iconManager:new YAe(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:qO},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:l,iconMapping:o,data:p,getIcon:v,textureParameters:S}=n,{iconManager:M}=this.state,k=l||this.internalState.isAsyncPropLoading("iconAtlas");if(M.setProps({loadOptions:n.loadOptions,autoPacking:!k,iconAtlas:l,iconMapping:k?o:null,textureParameters:S}),k?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&M.packIcons(p,v),i.extensionsChanged){var F;const{gl:H}=this.context;(F=this.state.model)===null||F===void 0||F.delete(),this.state.model=this._getModel(H),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:l,alphaCutoff:o}=this.props,{iconManager:p}=this.state,v=p.getTexture();v&&this.state.model.setUniforms(e).setUniforms({iconsTexture:v,iconsTextureDim:[v.width,v.height],sizeUnits:ff[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:l,alphaCutoff:o}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new ac(e,{...this.getShaders(),id:this.props.id,geometry:new Zu({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):sr.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}oe(dv,"defaultProps",XAe);oe(dv,"layerName","IconLayer");const KAe=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,JAe=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,NI=[0,0,0,255],eue={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:NI},getLineColor:{type:"accessor",value:NI},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class $S extends mA{getShaders(){return super.getShaders({vs:KAe,fs:JAe,modules:[Uf,Vf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:l,filled:o,billboard:p,antialiasing:v,lineWidthUnits:S,lineWidthScale:M,lineWidthMinPixels:k,lineWidthMaxPixels:F}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:l?1:0,filled:o,billboard:p,antialiasing:v,radiusUnits:ff[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:ff[S],lineWidthScale:M,lineWidthMinPixels:k,lineWidthMaxPixels:F}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new ac(e,{...this.getShaders(),id:this.props.id,geometry:new Zu({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}oe($S,"defaultProps",eue);oe($S,"layerName","ScatterplotLayer");const ZO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function YO(t,e,n={}){return tue(t,n)!==e?(rue(t,n),!0):!1}function tue(t,e={}){return Math.sign(nue(t,e))}function nue(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let l=n,o=r-i;l<r;l+=i)s+=(t[l]-t[o])*(t[l+1]+t[o+1]),o=l;return s/2}function rue(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,l=Math.floor(s/2);for(let o=0;o<l;++o){const p=n+o*i,v=n+(s-1-o)*i;for(let S=0;S<i;++S){const M=t[p+S];t[p+S]=t[v+S],t[v+S]=M}}}function oA(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function AE(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Jg(t,e,n,r,i=[]){const s=r+e*n;for(let l=0;l<n;l++)i[l]=t[s+l];return i}function uE(t,e,n,r,i=[]){let s,l;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),l=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),l=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),l=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),l=0;else return null;for(let o=0;o<t.length;o++)i[o]=(l&1)===o?r[l]:s*(e[o]-t[o])+t[o];return i}function Hy(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function XO(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:l=0,endIndex:o=t.length}=e||{},p=(o-l)/n;let v=[];const S=[v],M=Jg(t,0,n,l);let k,F;const H=JO(M,i,s,[]),j=[];oA(v,M);for(let ie=1;ie<p;ie++){for(k=Jg(t,ie,n,l,k),F=Hy(k,H);F;){uE(M,k,F,H,j);const Y=Hy(j,H);Y&&(uE(M,j,Y,H,j),F=Y),oA(v,j),AE(M,j),sue(H,i,F),r&&v.length>n&&(v=[],S.push(v),oA(v,M)),F=Hy(k,H)}oA(v,k),AE(M,k)}return r?S:S[0]}const UI=0,iue=1;function K1(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function KO(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:l=!1}=n||{},o=[],p=[{pos:t,types:l?new Array(t.length/r).fill(iue):null,holes:e||[]}],v=[[],[]];let S=[];for(;p.length;){const{pos:M,types:k,holes:F}=p.shift();oue(M,r,F[0]||M.length,v),S=JO(v[0],i,s,S);const H=Hy(v[1],S);if(H){let j=VI(M,k,r,0,F[0]||M.length,S,H);const ie={pos:j[0].pos,types:j[0].types,holes:[]},Y={pos:j[1].pos,types:j[1].types,holes:[]};p.push(ie,Y);for(let J=0;J<F.length;J++)j=VI(M,k,r,F[J],F[J+1]||M.length,S,H),j[0]&&(ie.holes.push(ie.pos.length),ie.pos=K1(ie.pos,j[0].pos),l&&(ie.types=K1(ie.types,j[0].types))),j[1]&&(Y.holes.push(Y.pos.length),Y.pos=K1(Y.pos,j[1].pos),l&&(Y.types=K1(Y.types,j[1].types)))}else{const j={positions:M};l&&(j.edgeTypes=k),F.length&&(j.holeIndices=F),o.push(j)}}return o}function VI(t,e,n,r,i,s,l){const o=(i-r)/n,p=[],v=[],S=[],M=[],k=[];let F,H,j;const ie=Jg(t,o-1,n,r);let Y=Math.sign(l&8?ie[1]-s[3]:ie[0]-s[2]),J=e&&e[o-1],se=0,ce=0;for(let me=0;me<o;me++)F=Jg(t,me,n,r,F),H=Math.sign(l&8?F[1]-s[3]:F[0]-s[2]),j=e&&e[r/n+me],H&&Y&&Y!==H&&(uE(ie,F,l,s,k),oA(p,k)&&S.push(J),oA(v,k)&&M.push(J)),H<=0?(oA(p,F)&&S.push(j),se-=H):S.length&&(S[S.length-1]=UI),H>=0?(oA(v,F)&&M.push(j),ce+=H):M.length&&(M[M.length-1]=UI),AE(ie,F),Y=H,J=j;return[se?{pos:p,types:e&&S}:null,ce?{pos:v,types:e&&M}:null]}function JO(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function sue(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function oue(t,e,n,r){let i=1/0,s=-1/0,l=1/0,o=-1/0;for(let p=0;p<n;p+=e){const v=t[p],S=t[p+1];i=v<i?v:i,s=v>s?v:s,l=S<l?S:l,o=S>o?S:o}return r[0][0]=i,r[0][1]=l,r[1][0]=s,r[1][1]=o,r}const aue=85.051129;function lue(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},l=t.slice(r,i);eF(l,n,0,i-r);const o=XO(l,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const p of o)tF(p,n);return o}function Aue(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const l=[],o=[];let p=0,v=0;for(let M=0;M<=e.length;M++){const k=e[M]||t.length,F=v,H=uue(t,r,p,k);for(let j=H;j<k;j++)l[v++]=t[j];for(let j=p;j<H;j++)l[v++]=t[j];eF(l,r,F,v),cue(l,r,F,v,n?.maxLatitude),p=k,o[M]=v}o.pop();const S=KO(l,o,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const M of S)tF(M.positions,r);return S}function uue(t,e,n,r){let i=-1,s=-1;for(let l=n+1;l<r;l+=e){const o=Math.abs(t[l]);o>i&&(i=o,s=l-1)}return s}function cue(t,e,n,r,i=aue){const s=t[n],l=t[r-e];if(Math.abs(s-l)>180){const o=Jg(t,0,e,n);o[0]+=Math.round((l-s)/360)*360,oA(t,o),o[1]=Math.sign(o[1])*i,oA(t,o),o[0]=s,oA(t,o)}}function eF(t,e,n,r){let i=t[0],s;for(let l=n;l<r;l+=e){s=t[l];const o=s-i;(o>180||o<-180)&&(s-=Math.round(o/360)*360),t[l]=i=s}}function tF(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function hue(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let l=0;l<t.length;l++)for(let o=0;o<e;o++)i[l*e+o]=t[l][o]||0}else i=t;return n?XO(i,{size:e,gridResolution:n}):r?lue(i,{size:e}):i}const fue=1,due=2,Zw=4;class pue extends QO{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?hue(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(GI(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&GI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:l}=n;r.fill(0,s,s+l),i?(r[s]=Zw,r[s+l-2]=Zw):(r[s]+=fue,r[s+l-2]+=due),r[s+l-1]=Zw}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,l=new Array(3);for(let o=i,p=0;p<s;o++,p++)this.getPointOnPath(e,p,l),r[o*3]=l[0],r[o*3+1]=l[1],r[o*3+2]=l[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function GI(t){return Array.isArray(t[0])}const gue=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,mue=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,nF=[0,0,0,255],yue={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:nF},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Yw={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class pv extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:gue,fs:mue,modules:[Uf,Vf]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Yw,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Yw,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Yw,defaultValue:nF},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new pue({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:o}=this.state,p=n.data.attributes||{};o.updateGeometry({data:n.data,geometryBuffer:p.getPath,buffers:p,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var l;const{gl:o}=this.context;(l=this.state.model)===null||l===void 0||l.delete(),this.state.model=this._getModel(o),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:l,widthScale:o,widthMinPixels:p,widthMaxPixels:v}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:ff[l],widthScale:o,miterLimit:s,widthMinPixels:p,widthMaxPixels:v}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new ac(e,{...this.getShaders(),id:this.props.id,geometry:new Zu({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}oe(pv,"defaultProps",yue);oe(pv,"layerName","PathLayer");var jS={exports:{}};jS.exports=gv;jS.exports.default=gv;function gv(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=rF(t,0,i,n,!0),l=[];if(!s||s.next===s.prev)return l;var o,p,v,S,M,k,F;if(r&&(s=bue(t,e,s,n)),t.length>80*n){o=v=t[0],p=S=t[1];for(var H=n;H<i;H+=n)M=t[H],k=t[H+1],M<o&&(o=M),k<p&&(p=k),M>v&&(v=M),k>S&&(S=k);F=Math.max(v-o,S-p),F=F!==0?32767/F:0}return em(s,l,n,o,p,F,0),l}function rF(t,e,n,r,i){var s,l;if(i===fE(t,e,n,r)>0)for(s=e;s<n;s+=r)l=$I(s,t[s],t[s+1],l);else for(s=n-r;s>=e;s-=r)l=$I(s,t[s],t[s+1],l);return l&&mv(l,l.next)&&(nm(l),l=l.next),l}function xf(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(mv(n,n.next)||vi(n.prev,n,n.next)===0)){if(nm(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function em(t,e,n,r,i,s,l){if(t){!l&&s&&Mue(t,r,i,s);for(var o=t,p,v;t.prev!==t.next;){if(p=t.prev,v=t.next,s?vue(t,r,i,s):_ue(t)){e.push(p.i/n|0),e.push(t.i/n|0),e.push(v.i/n|0),nm(t),t=v.next,o=v.next;continue}if(t=v,t===o){l?l===1?(t=xue(xf(t),e,n),em(t,e,n,r,i,s,2)):l===2&&wue(t,e,n,r,i,s):em(xf(t),e,n,r,i,s,1);break}}}}function _ue(t){var e=t.prev,n=t,r=t.next;if(vi(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,l=r.x,o=e.y,p=n.y,v=r.y,S=i<s?i<l?i:l:s<l?s:l,M=o<p?o<v?o:v:p<v?p:v,k=i>s?i>l?i:l:s>l?s:l,F=o>p?o>v?o:v:p>v?p:v,H=r.next;H!==e;){if(H.x>=S&&H.x<=k&&H.y>=M&&H.y<=F&&R0(i,o,s,p,l,v,H.x,H.y)&&vi(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function vue(t,e,n,r){var i=t.prev,s=t,l=t.next;if(vi(i,s,l)>=0)return!1;for(var o=i.x,p=s.x,v=l.x,S=i.y,M=s.y,k=l.y,F=o<p?o<v?o:v:p<v?p:v,H=S<M?S<k?S:k:M<k?M:k,j=o>p?o>v?o:v:p>v?p:v,ie=S>M?S>k?S:k:M>k?M:k,Y=cE(F,H,e,n,r),J=cE(j,ie,e,n,r),se=t.prevZ,ce=t.nextZ;se&&se.z>=Y&&ce&&ce.z<=J;){if(se.x>=F&&se.x<=j&&se.y>=H&&se.y<=ie&&se!==i&&se!==l&&R0(o,S,p,M,v,k,se.x,se.y)&&vi(se.prev,se,se.next)>=0||(se=se.prevZ,ce.x>=F&&ce.x<=j&&ce.y>=H&&ce.y<=ie&&ce!==i&&ce!==l&&R0(o,S,p,M,v,k,ce.x,ce.y)&&vi(ce.prev,ce,ce.next)>=0))return!1;ce=ce.nextZ}for(;se&&se.z>=Y;){if(se.x>=F&&se.x<=j&&se.y>=H&&se.y<=ie&&se!==i&&se!==l&&R0(o,S,p,M,v,k,se.x,se.y)&&vi(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;ce&&ce.z<=J;){if(ce.x>=F&&ce.x<=j&&ce.y>=H&&ce.y<=ie&&ce!==i&&ce!==l&&R0(o,S,p,M,v,k,ce.x,ce.y)&&vi(ce.prev,ce,ce.next)>=0)return!1;ce=ce.nextZ}return!0}function xue(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!mv(i,s)&&iF(i,r,r.next,s)&&tm(i,s)&&tm(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),nm(r),nm(r.next),r=t=s),r=r.next}while(r!==t);return xf(r)}function wue(t,e,n,r,i,s){var l=t;do{for(var o=l.next.next;o!==l.prev;){if(l.i!==o.i&&Iue(l,o)){var p=sF(l,o);l=xf(l,l.next),p=xf(p,p.next),em(l,e,n,r,i,s,0),em(p,e,n,r,i,s,0);return}o=o.next}l=l.next}while(l!==t)}function bue(t,e,n,r){var i=[],s,l,o,p,v;for(s=0,l=e.length;s<l;s++)o=e[s]*r,p=s<l-1?e[s+1]*r:t.length,v=rF(t,o,p,r,!1),v===v.next&&(v.steiner=!0),i.push(kue(v));for(i.sort(Eue),s=0;s<i.length;s++)n=Tue(i[s],n);return n}function Eue(t,e){return t.x-e.x}function Tue(t,e){var n=Sue(t,e);if(!n)return e;var r=sF(n,t);return xf(r,r.next),xf(n,n.next)}function Sue(t,e){var n=e,r=t.x,i=t.y,s=-1/0,l;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var o=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>s&&(s=o,l=n.x<n.next.x?n:n.next,o===r))return l}n=n.next}while(n!==e);if(!l)return null;var p=l,v=l.x,S=l.y,M=1/0,k;n=l;do r>=n.x&&n.x>=v&&r!==n.x&&R0(i<S?r:s,i,v,S,i<S?s:r,i,n.x,n.y)&&(k=Math.abs(i-n.y)/(r-n.x),tm(n,t)&&(k<M||k===M&&(n.x>l.x||n.x===l.x&&Cue(l,n)))&&(l=n,M=k)),n=n.next;while(n!==p);return l}function Cue(t,e){return vi(t.prev,t,e.prev)<0&&vi(e.next,t,t.next)<0}function Mue(t,e,n,r){var i=t;do i.z===0&&(i.z=cE(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,Pue(i)}function Pue(t){var e,n,r,i,s,l,o,p,v=1;do{for(n=t,t=null,s=null,l=0;n;){for(l++,r=n,o=0,e=0;e<v&&(o++,r=r.nextZ,!!r);e++);for(p=v;o>0||p>0&&r;)o!==0&&(p===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,p--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,v*=2}while(l>1);return t}function cE(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function kue(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function R0(t,e,n,r,i,s,l,o){return(i-l)*(e-o)>=(t-l)*(s-o)&&(t-l)*(r-o)>=(n-l)*(e-o)&&(n-l)*(s-o)>=(i-l)*(r-o)}function Iue(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Lue(t,e)&&(tm(t,e)&&tm(e,t)&&Due(t,e)&&(vi(t.prev,t,e.prev)||vi(t,e.prev,e))||mv(t,e)&&vi(t.prev,t,t.next)>0&&vi(e.prev,e,e.next)>0)}function vi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function mv(t,e){return t.x===e.x&&t.y===e.y}function iF(t,e,n,r){var i=ey(vi(t,e,n)),s=ey(vi(t,e,r)),l=ey(vi(n,r,t)),o=ey(vi(n,r,e));return!!(i!==s&&l!==o||i===0&&J1(t,n,e)||s===0&&J1(t,r,e)||l===0&&J1(n,t,r)||o===0&&J1(n,e,r))}function J1(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function ey(t){return t>0?1:t<0?-1:0}function Lue(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&iF(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function tm(t,e){return vi(t.prev,t,t.next)<0?vi(t,e,t.next)>=0&&vi(t,t.prev,e)>=0:vi(t,e,t.prev)<0||vi(t,t.next,e)<0}function Due(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function sF(t,e){var n=new hE(t.i,t.x,t.y),r=new hE(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function $I(t,e,n,r){var i=new hE(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function nm(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function hE(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}gv.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,l=Math.abs(fE(t,0,s,n));if(i)for(var o=0,p=e.length;o<p;o++){var v=e[o]*n,S=o<p-1?e[o+1]*n:t.length;l-=Math.abs(fE(t,v,S,n))}var M=0;for(o=0;o<r.length;o+=3){var k=r[o]*n,F=r[o+1]*n,H=r[o+2]*n;M+=Math.abs((t[k]-t[H])*(t[F+1]-t[k+1])-(t[k]-t[F])*(t[H+1]-t[k+1]))}return l===0&&M===0?0:Math.abs((M-l)/l)};function fE(t,e,n,r){for(var i=0,s=e,l=n-r;s<n;s+=r)i+=(t[l]-t[s])*(t[s+1]+t[l+1]),l=s;return i}gv.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var l=0;l<e;l++)n.vertices.push(t[i][s][l]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var Rue=jS.exports;const Bue=B2(Rue),ty=ZO.CLOCKWISE,jI=ZO.COUNTER_CLOCKWISE,Jc={isClosed:!0};function zue(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function Kp(t){return"positions"in t?t.positions:t}function Wy(t){return"holeIndices"in t?t.holeIndices:null}function Oue(t){return Array.isArray(t[0])}function Fue(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function Nue(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Uue(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function HI(t,e,n,r,i){let s=e;const l=n.length;for(let o=0;o<l;o++)for(let p=0;p<r;p++)t[s++]=n[o][p]||0;if(!Nue(n))for(let o=0;o<r;o++)t[s++]=n[0][o]||0;return Jc.start=e,Jc.end=s,Jc.size=r,YO(t,i,Jc),s}function WI(t,e,n,r,i=0,s,l){s=s||n.length;const o=s-i;if(o<=0)return e;let p=e;for(let v=0;v<o;v++)t[p++]=n[i+v];if(!Uue(n,r,i,s))for(let v=0;v<r;v++)t[p++]=n[i+v];return Jc.start=e,Jc.end=p,Jc.size=r,YO(t,l,Jc),p}function oF(t,e){zue(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let l=0;for(let o=0;o<=s.length;o++)l=WI(n,l,i,e,s[o-1],s[o],o===0?ty:jI),r.push(l);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!Oue(t))return WI(n,0,t,e,0,n.length,ty),n;if(!Fue(t)){let i=0;for(const[s,l]of t.entries())i=HI(n,i,l,e,s===0?ty:jI),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return HI(n,0,t,e,ty),n}function Xw(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const l=(s+1)%r;i+=t[s*3+e]*t[l*3+n],i-=t[l*3+e]*t[s*3+n]}return Math.abs(i/2)}function QI(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const l=s*3,o=t[l+0],p=t[l+1],v=t[l+2];t[l+e]=o,t[l+n]=p,t[l+r]=v}}function Vue(t,e,n,r){let i=Wy(t);i&&(i=i.map(o=>o/e));let s=Kp(t);const l=r&&e===3;if(n){const o=s.length;s=s.slice();const p=[];for(let v=0;v<o;v+=e){p[0]=s[v],p[1]=s[v+1],l&&(p[2]=s[v+2]);const S=n(p);s[v]=S[0],s[v+1]=S[1],l&&(s[v+2]=S[2])}}if(l){const o=Xw(s,0,1),p=Xw(s,0,2),v=Xw(s,1,2);if(!o&&!p&&!v)return[];o>p&&o>v||(p>v?(n||(s=s.slice()),QI(s,0,2,1)):(n||(s=s.slice()),QI(s,2,0,1)))}return Bue(s,i,e)}class Gue extends QO{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=oF(e,this.positionSize);return this.opts.resolution?KO(Kp(n),Wy(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Aue(Kp(n),Wy(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(qI(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return Kp(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&qI(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:l,typedArrayManager:o}=this;let p=s.indices;if(!p||!e)return;let v=i;const S=Vue(e,this.positionSize,this.opts.preproject,this.opts.full3d);p=o.allocate(p,i+S.length,{copy:!0});for(let M=0;M<S.length;M++)p[v++]=S[M]+r;l[n+1]=i+S.length,s.indices=p}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const l=Kp(e);for(let o=n,p=0;p<r;o++,p++){const v=l[p*s],S=l[p*s+1],M=s>2?l[p*s+2]:0;i[o*3]=v,i[o*3+1]=S,i[o*3+2]=M}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,l=e&&Wy(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),l)for(let o=0;o<l.length;o++)s[n+l[o]/i-1]=0;s[n+r-1]=0}}function qI(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const aF=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,$ue=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(aF,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),jue=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(aF,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Hue=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,u2=[0,0,0,255],Wue={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:u2},getLineColor:{type:"accessor",value:u2},material:!0},ny={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class yv extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?$ue:jue,fs:Hue,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Uf,qie,Vf]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===Ar.DEFAULT&&(r=Ar.LNGLAT);let s;r===Ar.LNGLAT&&(i?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new Gue({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||wS(e,ti.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const l=this.getAttributeManager(),o=!0;l.remove(["instancePickingColors"]),l.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:ny,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,transition:ny,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ny,accessor:"getFillColor",defaultValue:u2,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:ny,accessor:"getLineColor",defaultValue:u2,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(p,{index:v,target:S})=>this.encodePickingColor(p&&p.__source?p.__source.index:v,S),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:l,sideModel:o,polygonTesselator:p}=this.state,v={...e,extruded:!!n,elevationScale:s};o&&(o.setInstanceCount(p.instanceCount-1),o.setUniforms(v),i&&(o.setDrawMode(3),o.setUniforms({isWireframe:!0}).draw()),r&&(o.setDrawMode(6),o.setUniforms({isWireframe:!1}).draw())),l&&(l.setVertexCount(p.vertexCount),l.setUniforms(v).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var o;(o=this.state.models)===null||o===void 0||o.forEach(p=>p.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,l=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:l.getPolygon,buffers:l,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,l;if(r){const o=this.getShaders("top");o.defines.NON_INSTANCED_MODEL=1,s=new ac(e,{...o,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(l=new ac(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Zu({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),l.userData.excludeAttributes={indices:!0}),{models:[l,s].filter(Boolean),topModel:s,sideModel:l}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}oe(yv,"defaultProps",Wue);oe(yv,"layerName","SolidPolygonLayer");function lF({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,l=t.length;let o=l,p=l;for(let k=0;k<l;k++){const F=e(t[k]);if(o>k&&F>=i&&(o=k),F>=s){p=k;break}}let v=o;const M=p-o!==r.length?t.slice(p):void 0;for(let k=0;k<r.length;k++)t[v++]=r[k];if(M){for(let k=0;k<M.length;k++)t[v++]=M[k];t.length=v}return{startRow:o,endRow:o+r.length}}const AF=[0,0,0,255],Que=[0,0,0,255],que={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:Que},getLineColor:{type:"accessor",value:AF},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class Nd extends Sr{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&sr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(s=>lF({data:r,getIndex:l=>l.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:s}=this.props,l=[],o=i==="XY"?2:3,{startRow:p,endRow:v}=e,{iterable:S,objectInfo:M}=Fd(n,p,v);for(const k of S){M.index++;let F=r(k,M);s&&(F=oF(F,o));const{holeIndices:H}=F,j=F.positions||F;if(H)for(let ie=0;ie<=H.length;ie++){const Y=j.slice(H[ie-1]||0,H[ie]||j.length);l.push(this.getSubLayerRow({path:Y},k,M.index))}else l.push(this.getSubLayerRow({path:j},k,M.index))}return l}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:s,wireframe:l,_normalize:o,_windingOrder:p,elevationScale:v,transitions:S,positionFormat:M}=this.props,{lineWidthUnits:k,lineWidthScale:F,lineWidthMinPixels:H,lineWidthMaxPixels:j,lineJointRounded:ie,lineMiterLimit:Y,lineDashJustified:J}=this.props,{getFillColor:se,getLineColor:ce,getLineWidth:me,getLineDashArray:Ee,getElevation:He,getPolygon:Qe,updateTriggers:Ye,material:nt}=this.props,{paths:Fe,pathsDiff:tt}=this.state,Ze=this.getSubLayerClass("fill",yv),pt=this.getSubLayerClass("stroke",pv),Yt=this.shouldRenderSubLayer("fill",Fe)&&new Ze({_dataDiff:n,extruded:s,elevationScale:v,filled:i,wireframe:l,_normalize:o,_windingOrder:p,getElevation:He,getFillColor:se,getLineColor:s&&l?ce:AF,material:nt,transitions:S},this.getSubLayerProps({id:"fill",updateTriggers:Ye&&{getPolygon:Ye.getPolygon,getElevation:Ye.getElevation,getFillColor:Ye.getFillColor,lineColors:s&&l,getLineColor:Ye.getLineColor}}),{data:e,positionFormat:M,getPolygon:Qe}),Et=!s&&r&&this.shouldRenderSubLayer("stroke",Fe)&&new pt({_dataDiff:tt&&(()=>tt),widthUnits:k,widthScale:F,widthMinPixels:H,widthMaxPixels:j,jointRounded:ie,miterLimit:Y,dashJustified:J,_pathType:"loop",transitions:S&&{getWidth:S.getLineWidth,getColor:S.getLineColor,getPath:S.getPolygon},getColor:this.getSubLayerAccessor(ce),getWidth:this.getSubLayerAccessor(me),getDashArray:this.getSubLayerAccessor(Ee)},this.getSubLayerProps({id:"stroke",updateTriggers:Ye&&{getWidth:Ye.getLineWidth,getColor:Ye.getLineColor,getDashArray:Ye.getLineDashArray}}),{data:Fe,positionFormat:M,getPath:un=>un.path});return[!s&&Yt,Et,s&&Yt]}}oe(Nd,"layerName","PolygonLayer");oe(Nd,"defaultProps",que);function Zue(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?Yue(t,r,n):null}function Yue(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function Xue(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let l=0;l<i.length;l++)e(i[l],s),n[r][l*3+0]=s[0],n[r][l*3+1]=s[1],n[r][l*3+2]=s[2]}return n}const Kue=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Kw=192/256,ZI=[],Jue={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class HS extends dv{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:Kue}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&sr.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,l=i?Math.max(r,Kw*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Kw,outlineBuffer:l,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:o}=this.state;o.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Kw}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):ZI}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):ZI}}oe(HS,"defaultProps",Jue);oe(HS,"layerName","MultiIconLayer");const mg=1e20;class ece{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:l="normal",fontStyle:o="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const p=this.size=e+n*4,v=this._createCanvas(p),S=this.ctx=v.getContext("2d",{willReadFrequently:!0});S.font=`${o} ${l} ${e}px ${s}`,S.textBaseline="alphabetic",S.textAlign="left",S.fillStyle="black",this.gridOuter=new Float64Array(p*p),this.gridInner=new Float64Array(p*p),this.f=new Float64Array(p),this.z=new Float64Array(p+1),this.v=new Uint16Array(p)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:l}=this.ctx.measureText(e),o=Math.ceil(r),p=0,v=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(l-s))),S=Math.min(this.size-this.buffer,o+Math.ceil(i)),M=v+2*this.buffer,k=S+2*this.buffer,F=Math.max(M*k,0),H=new Uint8ClampedArray(F),j={data:H,width:M,height:k,glyphWidth:v,glyphHeight:S,glyphTop:o,glyphLeft:p,glyphAdvance:n};if(v===0||S===0)return j;const{ctx:ie,buffer:Y,gridInner:J,gridOuter:se}=this;ie.clearRect(Y,Y,v,S),ie.fillText(e,Y,Y+o);const ce=ie.getImageData(Y,Y,v,S);se.fill(mg,0,F),J.fill(0,0,F);for(let me=0;me<S;me++)for(let Ee=0;Ee<v;Ee++){const He=ce.data[4*(me*v+Ee)+3]/255;if(He===0)continue;const Qe=(me+Y)*M+Ee+Y;if(He===1)se[Qe]=0,J[Qe]=mg;else{const Ye=.5-He;se[Qe]=Ye>0?Ye*Ye:0,J[Qe]=Ye<0?Ye*Ye:0}}YI(se,0,0,M,k,M,this.f,this.v,this.z),YI(J,Y,Y,v,S,M,this.f,this.v,this.z);for(let me=0;me<F;me++){const Ee=Math.sqrt(se[me])-Math.sqrt(J[me]);H[me]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return j}}function YI(t,e,n,r,i,s,l,o,p){for(let v=e;v<e+r;v++)XI(t,n*s+v,s,i,l,o,p);for(let v=n;v<n+i;v++)XI(t,v*s+e,1,r,l,o,p)}function XI(t,e,n,r,i,s,l){s[0]=0,l[0]=-mg,l[1]=mg,i[0]=t[e];for(let o=1,p=0,v=0;o<r;o++){i[o]=t[e+o*n];const S=o*o;do{const M=s[p];v=(i[o]-i[M]+S-M*M)/(o-M)/2}while(v<=l[p]&&--p>-1);p++,s[p]=o,l[p]=v,l[p+1]=mg}for(let o=0,p=0;o<r;o++){for(;l[p+1]<o;)p++;const v=s[p],S=o-v;t[e+o*n]=i[v]+S*S}}const tce=32,nce=[];function rce(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function ice({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:l=0,yOffset:o=0}){let p=0,v=l;const S=n+r*2;for(const M of t)if(!s[M]){const k=e(M);v+k+r*2>i&&(v=0,p++),s[M]={x:v+r,y:o+p*S+r,width:k,height:S,layoutWidth:k,layoutHeight:n},v+=k+r*2}return{mapping:s,xOffset:v,yOffset:o+p*S,canvasHeight:rce(o+(p+1)*S)}}function uF(t,e,n,r){let i=0;for(let l=e;l<n;l++){var s;const o=t[l];i+=((s=r[o])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function cF(t,e,n,r,i,s){let l=e,o=0;for(let p=e;p<n;p++){const v=uF(t,p,p+1,i);o+v>r&&(l<p&&s.push(p),l=p,o=0),o+=v}return o}function sce(t,e,n,r,i,s){let l=e,o=e,p=e,v=0;for(let S=e;S<n;S++)if((t[S]===" "||t[S+1]===" "||S+1===n)&&(p=S+1),p>o){let M=uF(t,o,p,i);v+M>r&&(l<o&&(s.push(o),l=o,v=0),M>r&&(M=cF(t,o,p,r,i,s),l=s[s.length-1])),o=p,v+=M}return v}function oce(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const l=[];return e==="break-all"?cF(t,i,s,n,r,l):sce(t,i,s,n,r,l),l}function ace(t,e,n,r,i,s){let l=0,o=0;for(let p=e;p<n;p++){const v=t[p],S=r[v];S?(o||(o=S.layoutHeight),i[p]=l+S.layoutWidth/2,l+=S.layoutWidth):(sr.warn("Missing character: ".concat(v," (").concat(v.codePointAt(0),")"))(),i[p]=l,l+=tce)}s[0]=l,s[1]=o}function lce(t,e,n,r,i){const s=Array.from(t),l=s.length,o=new Array(l),p=new Array(l),v=new Array(l),S=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,M=[0,0],k=[0,0];let F=0,H=0,j=0;for(let Y=0;Y<=l;Y++){const J=s[Y];if((J===`
`||Y===l)&&(j=Y),j>H){const se=S?oce(s,n,r,i,H,j):nce;for(let ce=0;ce<=se.length;ce++){const me=ce===0?H:se[ce-1],Ee=ce<se.length?se[ce]:j;ace(s,me,Ee,i,o,k);for(let He=me;He<Ee;He++){var ie;const Qe=s[He],Ye=((ie=i[Qe])===null||ie===void 0?void 0:ie.layoutOffsetY)||0;p[He]=F+k[1]/2+Ye,v[He]=k[0]}F=F+k[1]*e,M[0]=Math.max(M[0],k[0])}H=j}J===`
`&&(o[H]=0,p[H]=0,v[H]=0,H++)}return M[1]=F,{x:o,y:p,rowWidth:v,size:M}}function Ace({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const l=t.BYTES_PER_ELEMENT,o=n?n/l:1,p=r?r/l:0,v=i[e]||Math.ceil((t.length-p)/o),S=s&&new Set,M=new Array(e);let k=t;if(o>1||p>0){const F=t.constructor;k=new F(v);for(let H=0;H<v;H++)k[H]=t[H*o+p]}for(let F=0;F<e;F++){const H=i[F],j=i[F+1]||v,ie=k.subarray(H,j);M[F]=String.fromCodePoint.apply(null,ie),S&&ie.forEach(S.add,S)}if(S)for(const F of S)s.add(String.fromCodePoint(F));return{texts:M,characterCount:v}}class hF{constructor(e=5){oe(this,"limit",void 0),oe(this,"_cache",{}),oe(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function uce(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const J0={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:uce(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},KI=1024,JI=.9,e6=1.2,fF=3;let c2=new hF(fF);function cce(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=c2.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function hce(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function t6(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function fce(t){sr.assert(Number.isFinite(t)&&t>=fF,"Invalid cache limit"),c2=new hF(t)}class dce{constructor(){oe(this,"props",{...J0}),oe(this,"_key",void 0),oe(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*e6+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=cce(this._key,this.props.characterSet),r=c2.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,c2.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:l,sdf:o,radius:p,cutoff:v}=this.props;let S=n&&n.data;S||(S=document.createElement("canvas"),S.width=KI);const M=S.getContext("2d",{willReadFrequently:!0});t6(M,r,s,i);const{mapping:k,canvasHeight:F,xOffset:H,yOffset:j}=ice({getFontWidth:ie=>M.measureText(ie).width,fontHeight:s*e6,buffer:l,characterSet:e,maxCanvasWidth:KI,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(S.height!==F){const ie=M.getImageData(0,0,S.width,S.height);S.height=F,M.putImageData(ie,0,0)}if(t6(M,r,s,i),o){const ie=new ece({fontSize:s,buffer:l,radius:p,cutoff:v,fontFamily:r,fontWeight:"".concat(i)});for(const Y of e){const{data:J,width:se,height:ce,glyphTop:me}=ie.draw(Y);k[Y].width=se,k[Y].layoutOffsetY=s*JI-me;const Ee=M.createImageData(se,ce);hce(J,Ee),M.putImageData(Ee,k[Y].x,k[Y].y)}}else for(const ie of e)M.fillText(ie,k[ie].x,k[ie].y+l+s*JI);return{xOffset:H,yOffset:j,mapping:k,data:S,width:S.width,height:S.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:l,cutoff:o}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(l," ").concat(o):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const pce=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,gce=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,mce={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class WS extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:pce,fs:gce,modules:[Uf,Vf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:l,getLineWidth:o}=this.props;let{padding:p}=this.props;p.length<4&&(p=[p[0],p[1],p[0],p[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!o,padding:p,sizeUnits:ff[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:l}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new ac(e,{...this.getShaders(),id:this.props.id,geometry:new Zu({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}oe(WS,"defaultProps",mce);oe(WS,"layerName","TextBackgroundLayer");const n6={start:1,middle:0,end:-1},r6={top:1,center:0,bottom:-1},Jw=[0,0,0,255],yce=1,_ce={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Jw},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:J0.characterSet},fontFamily:J0.fontFamily,fontWeight:J0.fontWeight,lineHeight:yce,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Jw},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Jw},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class QS extends Sr{constructor(...e){super(...e),oe(this,"state",void 0),oe(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:l}=this.state.fontAtlasManager.props;i/=l,s/=l;const{getTextAnchor:o,getAlignmentBaseline:p}=this.props,v=n6[typeof o=="function"?o(n,r):o],S=r6[typeof p=="function"?p(n,r):p];return[(v-1)*i/2,(S-1)*s/2,i,s]}),oe(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:l,y:o,rowWidth:p,size:[v,S]}=this.transformParagraph(n,r),M=n6[typeof i=="function"?i(n,r):i],k=r6[typeof s=="function"?s(n,r):s],F=l.length,H=new Array(F*2);let j=0;for(let ie=0;ie<F;ie++){const Y=(1-M)*(v-p[ie])/2;H[j++]=(M-1)*v/2+Y+l[ie],H[j++]=(k-1)*S/2+o[ie]}return H})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new dce},this.props.maxWidth>0&&sr.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,l={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(l),!0;for(const o in l)if(l[o]!==i.props[o])return i.setProps(l),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,l=n.startIndices,o;const p=r==="auto"&&new Set;if(i&&l){const{texts:v,characterCount:S}=Ace({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:l,characterSet:p});o=S,s=(M,{index:k})=>v[k]}else{const{iterable:v,objectInfo:S}=Fd(n);l=[0],o=0;for(const M of v){S.index++;const k=Array.from(s(M,S)||"");p&&k.forEach(p.add,p),o+=k.length,l.push(o)}}this.setState({getText:s,startIndices:l,numInstances:o,characterSet:p||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:l,lineHeight:o,maxWidth:p}=this.props,v=s(e,n)||"";return lce(v,o,l,p*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:l},styleVersion:o}=this.state,{data:p,_dataDiff:v,getPosition:S,getColor:M,getSize:k,getAngle:F,getPixelOffset:H,getBackgroundColor:j,getBorderColor:ie,getBorderWidth:Y,backgroundPadding:J,background:se,billboard:ce,fontSettings:me,outlineWidth:Ee,outlineColor:He,sizeScale:Qe,sizeUnits:Ye,sizeMinPixels:nt,sizeMaxPixels:Fe,transitions:tt,updateTriggers:Ze}=this.props,pt=this.getSubLayerClass("characters",HS),Yt=this.getSubLayerClass("background",WS);return[se&&new Yt({getFillColor:j,getLineColor:ie,getLineWidth:Y,padding:J,getPosition:S,getSize:k,getAngle:F,getPixelOffset:H,billboard:ce,sizeScale:Qe,sizeUnits:Ye,sizeMinPixels:nt,sizeMaxPixels:Fe,transitions:tt&&{getPosition:tt.getPosition,getAngle:tt.getAngle,getSize:tt.getSize,getFillColor:tt.getBackgroundColor,getLineColor:tt.getBorderColor,getLineWidth:tt.getBorderWidth,getPixelOffset:tt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Ze.getPosition,getAngle:Ze.getAngle,getSize:Ze.getSize,getFillColor:Ze.getBackgroundColor,getLineColor:Ze.getBorderColor,getLineWidth:Ze.getBorderWidth,getPixelOffset:Ze.getPixelOffset,getBoundingRect:{getText:Ze.getText,getTextAnchor:Ze.getTextAnchor,getAlignmentBaseline:Ze.getAlignmentBaseline,styleVersion:o}}}),{data:p.attributes&&p.attributes.background?{length:p.length,attributes:p.attributes.background}:p,_dataDiff:v,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new pt({sdf:me.sdf,smoothing:Number.isFinite(me.smoothing)?me.smoothing:J0.smoothing,outlineWidth:Ee/(me.radius||J0.radius),outlineColor:He,iconAtlas:s,iconMapping:l,getPosition:S,getColor:M,getSize:k,getAngle:F,getPixelOffset:H,billboard:ce,sizeScale:Qe*i,sizeUnits:Ye,sizeMinPixels:nt*i,sizeMaxPixels:Fe*i,transitions:tt&&{getPosition:tt.getPosition,getAngle:tt.getAngle,getColor:tt.getColor,getSize:tt.getSize,getPixelOffset:tt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Ze.getText,getPosition:Ze.getPosition,getAngle:Ze.getAngle,getColor:Ze.getColor,getSize:Ze.getSize,getPixelOffset:Ze.getPixelOffset,getIconOffsets:{getTextAnchor:Ze.getTextAnchor,getAlignmentBaseline:Ze.getAlignmentBaseline,styleVersion:o}}}),{data:p,_dataDiff:v,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){fce(e)}}oe(QS,"defaultProps",_ce);oe(QS,"layerName","TextLayer");const Qy={circle:{type:$S,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:dv,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:QS,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},qy={type:pv,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},dE={type:yv,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Ip({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function eb(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const l=e[s];let o=t.props[s];s.startsWith("get")&&(o=t.getSubLayerAccessor(o),i.updateTriggers[l]=r[s],n&&(i.transitions[l]=n[s])),i[l]=o}return i}function vce(t){if(Array.isArray(t))return t;switch(sr.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return sr.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function i6(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let l=i;l<s;l++){const o=t[l],{geometry:p}=o;if(p)if(p.type==="GeometryCollection"){sr.assert(Array.isArray(p.geometries),"GeoJSON does not have geometries array");const{geometries:v}=p;for(let S=0;S<v.length;S++){const M=v[S];s6(M,r,e,o,l)}}else s6(p,r,e,o,l)}return r}function s6(t,e,n,r,i){const{type:s,coordinates:l}=t,{pointFeatures:o,lineFeatures:p,polygonFeatures:v,polygonOutlineFeatures:S}=e;if(!wce(s,l)){sr.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":o.push(n({geometry:t},r,i));break;case"MultiPoint":l.forEach(M=>{o.push(n({geometry:{type:"Point",coordinates:M}},r,i))});break;case"LineString":p.push(n({geometry:t},r,i));break;case"MultiLineString":l.forEach(M=>{p.push(n({geometry:{type:"LineString",coordinates:M}},r,i))});break;case"Polygon":v.push(n({geometry:t},r,i)),l.forEach(M=>{S.push(n({geometry:{type:"LineString",coordinates:M}},r,i))});break;case"MultiPolygon":l.forEach(M=>{v.push(n({geometry:{type:"Polygon",coordinates:M}},r,i)),M.forEach(k=>{S.push(n({geometry:{type:"LineString",coordinates:k}},r,i))})});break}}const xce={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function wce(t,e){let n=xce[t];for(sr.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function dF(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function ry(t){return t.geometry.coordinates}function bce(t,e){const n=dF(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:l}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=ry,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=ry,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=ry,n.polygonsOutline.data=l,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=ry,n}function Ece(t,e){const n=dF(),{points:r,lines:i,polygons:s}=t,l=Xue(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:l.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:l.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:l.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:l.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const Tce=["points","linestrings","polygons"],Sce={...Ip(Qy.circle),...Ip(Qy.icon),...Ip(Qy.text),...Ip(qy),...Ip(dE),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class ha extends Sr{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=Ece(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=vce(e.data),i=this.getSubLayerRow.bind(this);let s={};const l={};if(Array.isArray(n.dataChanged)){const p=this.state.features;for(const v in p)s[v]=p[v].slice(),l[v]=[];for(const v of n.dataChanged){const S=i6(r,i,v);for(const M in p)l[M].push(lF({data:s[M],getIndex:k=>k.__source.index,dataRange:v,replace:S[M]}))}}else s=i6(r,i);const o=bce(s,l);this.setState({features:s,featuresDiff:l,layerProps:o})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=Tce.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,dE.type);if(s){const l=eb(this,dE.props),o=e&&n;return o||delete l.getLineColor,l.updateTriggers.lineColors=o,new s(l,this.getSubLayerProps({id:i,updateTriggers:l.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",l=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,qy.type),o=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,qy.type);if(l||o){const p=eb(this,qy.props);return[l&&new l(p,this.getSubLayerProps({id:i,updateTriggers:p.updateTriggers}),r.polygonsOutline),o&&new o(p,this.getSubLayerProps({id:s,updateTriggers:p.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(o=>o.__source.index===i));const s=new Set(e.split("+")),l=[];for(const o of s){const p="points-".concat(o),v=Qy[o],S=v&&this.shouldRenderSubLayer(p,n.points.data)&&this.getSubLayerClass(p,v.type);if(S){const M=eb(this,v.props);let k=n.points;if(o==="text"&&r){const{instancePickingColors:F,...H}=k.data.attributes;k={...k,data:{...k.data,attributes:H}}}l.push(new S(M,this.getSubLayerProps({id:p,updateTriggers:M.updateTriggers,highlightedObjectIndex:i}),k))}}return l}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:l}=i,o=Zue(s,l);return e(o,i)}}}oe(ha,"layerName","GeoJsonLayer");oe(ha,"defaultProps",Sce);class Cce{constructor(e){oe(this,"index",void 0),oe(this,"isVisible",void 0),oe(this,"isSelected",void 0),oe(this,"parent",void 0),oe(this,"children",void 0),oe(this,"content",void 0),oe(this,"state",void 0),oe(this,"layers",void 0),oe(this,"id",void 0),oe(this,"zoom",void 0),oe(this,"userData",void 0),oe(this,"boundingBox",void 0),oe(this,"_abortController",void 0),oe(this,"_loader",void 0),oe(this,"_loaderId",void 0),oe(this,"_isLoaded",void 0),oe(this,"_isCancelled",void 0),oe(this,"_needsReload",void 0),oe(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:s,id:l,bbox:o,userData:p,zoom:v}=this,S=this._loaderId;this._abortController=new AbortController;const{signal:M}=this._abortController,k=await n.scheduleRequest(this,j=>j.isSelected?1:-1);if(!k){this._isCancelled=!0;return}if(this._isCancelled){k.done();return}let F=null,H;try{F=await e({index:s,id:l,bbox:o,userData:p,zoom:v,signal:M})}catch(j){H=j||!0}finally{k.done()}if(S===this._loaderId){if(this._loader=void 0,this.content=F,this._isCancelled&&!F){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,H?i(H,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const co={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},o6=new An,Mce=new An;class qS{constructor(e=[0,0,0],n=[0,0,0],r){oe(this,"center",void 0),oe(this,"halfDiagonal",void 0),oe(this,"minimum",void 0),oe(this,"maximum",void 0),r=r||o6.copy(e).add(n).scale(.5),this.center=new An(r),this.halfDiagonal=new An(n).subtract(this.center),this.minimum=new An(e),this.maximum=new An(n)}clone(){return new qS(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=Mce.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),s=this.center.dot(r)+e.distance;return s-i>0?co.INSIDE:s+i<0?co.OUTSIDE:co.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=o6.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,s;return s=Math.abs(n.x)-r.x,s>0&&(i+=s*s),s=Math.abs(n.y)-r.y,s>0&&(i+=s*s),s=Math.abs(n.z)-r.z,s>0&&(i+=s*s),i}}const Lp=new An,a6=new An;class ZS{constructor(e=[0,0,0],n=0){oe(this,"center",void 0),oe(this,"radius",void 0),this.radius=-0,this.center=new An,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Lp.from(n),this.center=new An().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new ZS(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,s=e.radius,l=Lp.copy(i).subtract(n),o=l.magnitude();if(r>=o+s)return this.clone();if(s>=o+r)return e.clone();const p=(r+o+s)*.5;return a6.copy(l).scale((-r+p)/o).add(n),this.center.copy(a6),this.radius=p,this}expand(e){const r=Lp.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=tie(Lp,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Lp.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,s=e.normal.dot(n)+e.distance;return s<-r?co.OUTSIDE:s<r?co.INTERSECTING:co.INSIDE}}const Pce=new An,kce=new An,iy=new An,sy=new An,oy=new An,Ice=new An,Lce=new An,Ru={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class YS{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){oe(this,"center",void 0),oe(this,"halfAxes",void 0),this.center=new An().from(e),this.halfAxes=new zs(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new An(e).len(),new An(n).len(),new An(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new An(e).normalize(),s=new An(n).normalize(),l=new An(r).normalize();return new Qk().fromMatrix3(new zs([...i,...s,...l]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new Qk(r),s=new zs().fromQuaternion(i);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new An().from(e),this.halfAxes=s,this}clone(){return new YS(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new ZS){const n=this.halfAxes,r=n.getColumn(0,iy),i=n.getColumn(1,sy),s=n.getColumn(2,oy),l=Pce.copy(r).add(i).add(s);return e.center.copy(this.center),e.radius=l.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,s=r.x,l=r.y,o=r.z,p=Math.abs(s*i[Ru.COLUMN0ROW0]+l*i[Ru.COLUMN0ROW1]+o*i[Ru.COLUMN0ROW2])+Math.abs(s*i[Ru.COLUMN1ROW0]+l*i[Ru.COLUMN1ROW1]+o*i[Ru.COLUMN1ROW2])+Math.abs(s*i[Ru.COLUMN2ROW0]+l*i[Ru.COLUMN2ROW1]+o*i[Ru.COLUMN2ROW2]),v=r.dot(n)+e.distance;return v<=-p?co.OUTSIDE:v>=p?co.INSIDE:co.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=kce.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,iy),s=r.getColumn(1,sy),l=r.getColumn(2,oy),o=i.magnitude(),p=s.magnitude(),v=l.magnitude();i.normalize(),s.normalize(),l.normalize();let S=0,M;return M=Math.abs(n.dot(i))-o,M>0&&(S+=M*M),M=Math.abs(n.dot(s))-p,M>0&&(S+=M*M),M=Math.abs(n.dot(l))-v,M>0&&(S+=M*M),S}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const l=this.center,o=this.halfAxes,p=o.getColumn(0,iy),v=o.getColumn(1,sy),S=o.getColumn(2,oy),M=Ice.copy(p).add(v).add(S).add(l),k=Lce.copy(M).subtract(e);let F=n.dot(k);return i=Math.min(F,i),s=Math.max(F,s),M.copy(l).add(p).add(v).subtract(S),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),M.copy(l).add(p).subtract(v).add(S),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),M.copy(l).add(p).subtract(v).subtract(S),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),l.copy(M).subtract(p).add(v).add(S),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),l.copy(M).subtract(p).add(v).subtract(S),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),l.copy(M).subtract(p).subtract(v).add(S),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),l.copy(M).subtract(p).subtract(v).subtract(S),k.copy(M).subtract(e),F=n.dot(k),i=Math.min(F,i),s=Math.max(F,s),r[0]=i,r[1]=s,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,iy);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,sy);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,oy);return i.transformAsPoint(e),this.halfAxes=new zs([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const l6=new An,A6=new An;class Td{constructor(e=[0,0,1],n=0){oe(this,"normal",void 0),oe(this,"distance",void 0),this.normal=new An,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return Xg(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=l6.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),Xg(qu(this.normal.len(),1)),this.distance=i,this}clone(){return new Td(this.normal,this.distance)}equals(e){return qu(this.distance,e.distance)&&qu(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=A6.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=l6.from(e);const r=this.getPointDistance(e),i=A6.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const u6=[new An([1,0,0]),new An([0,1,0]),new An([0,0,1])],c6=new An,Dce=new An;new Td(new An(1,0,0),0);class ju{constructor(e=[]){oe(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*u6.length;const n=e.center,r=e.radius;let i=0;for(const s of u6){let l=this.planes[i],o=this.planes[i+1];l||(l=this.planes[i]=new Td),o||(o=this.planes[i+1]=new Td);const p=c6.copy(s).scale(-r).add(n);-s.dot(p),l.fromPointNormal(p,s);const v=c6.copy(s).scale(r).add(n),S=Dce.copy(s).negate();-S.dot(v),o.fromPointNormal(v,S),i+=2}return this}computeVisibility(e){let n=co.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case co.OUTSIDE:return co.OUTSIDE;case co.INTERSECTING:n=co.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(Xg(Number.isFinite(n),"parentPlaneMask is required."),n===ju.MASK_OUTSIDE||n===ju.MASK_INSIDE)return n;let r=ju.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const l=s<31?1<<s:0;if(s<31&&!(n&l))continue;const o=i[s],p=e.intersectPlane(o);if(p===co.OUTSIDE)return ju.MASK_OUTSIDE;p===co.INTERSECTING&&(r|=l)}return r}}oe(ju,"MASK_OUTSIDE",4294967295);oe(ju,"MASK_INSIDE",0);oe(ju,"MASK_INDETERMINATE",2147483647);new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;const UA=new zs,Rce=new zs,Bce=new zs,ay=new zs,h6=new zs;function zce(t,e={}){const n=sO.EPSILON20,r=10;let i=0,s=0;const l=Rce,o=Bce;l.identity(),o.copy(t);const p=n*Oce(o);for(;s<r&&Fce(o)>p;)Nce(o,ay),h6.copy(ay).transpose(),o.multiplyRight(ay),o.multiplyLeft(h6),l.multiplyRight(ay),++i>2&&(++s,i=0);return e.unitary=l.toTarget(e.unitary),e.diagonal=o.toTarget(e.diagonal),e}function Oce(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const pE=[1,0,0],gE=[2,2,1];function Fce(t){let e=0;for(let n=0;n<3;++n){const r=t[UA.getElementIndex(gE[n],pE[n])];e+=2*r*r}return Math.sqrt(e)}function Nce(t,e){const n=sO.EPSILON15;let r=0,i=1;for(let v=0;v<3;++v){const S=Math.abs(t[UA.getElementIndex(gE[v],pE[v])]);S>r&&(i=v,r=S)}const s=pE[i],l=gE[i];let o=1,p=0;if(Math.abs(t[UA.getElementIndex(l,s)])>n){const v=t[UA.getElementIndex(l,l)],S=t[UA.getElementIndex(s,s)],M=t[UA.getElementIndex(l,s)],k=(v-S)/2/M;let F;k<0?F=-1/(-k+Math.sqrt(1+k*k)):F=1/(k+Math.sqrt(1+k*k)),o=1/Math.sqrt(1+F*F),p=F*o}return zs.IDENTITY.to(e),e[UA.getElementIndex(s,s)]=e[UA.getElementIndex(l,l)]=o,e[UA.getElementIndex(l,s)]=p,e[UA.getElementIndex(s,l)]=-p,e}const Uc=new An,Uce=new An,Vce=new An,Gce=new An,$ce=new An,jce=new zs,Hce={diagonal:new zs,unitary:new zs};function Wce(t,e=new YS){if(!t||t.length===0)return e.halfAxes=new zs([0,0,0,0,0,0,0,0,0]),e.center=new An,e;const n=t.length,r=new An(0,0,0);for(const Ye of t)r.add(Ye);const i=1/n;r.multiplyByScalar(i);let s=0,l=0,o=0,p=0,v=0,S=0;for(const Ye of t){const nt=Uc.copy(Ye).subtract(r);s+=nt.x*nt.x,l+=nt.x*nt.y,o+=nt.x*nt.z,p+=nt.y*nt.y,v+=nt.y*nt.z,S+=nt.z*nt.z}s*=i,l*=i,o*=i,p*=i,v*=i,S*=i;const M=jce;M[0]=s,M[1]=l,M[2]=o,M[3]=l,M[4]=p,M[5]=v,M[6]=o,M[7]=v,M[8]=S;const{unitary:k}=zce(M,Hce),F=e.halfAxes.copy(k);let H=F.getColumn(0,Vce),j=F.getColumn(1,Gce),ie=F.getColumn(2,$ce),Y=-Number.MAX_VALUE,J=-Number.MAX_VALUE,se=-Number.MAX_VALUE,ce=Number.MAX_VALUE,me=Number.MAX_VALUE,Ee=Number.MAX_VALUE;for(const Ye of t)Uc.copy(Ye),Y=Math.max(Uc.dot(H),Y),J=Math.max(Uc.dot(j),J),se=Math.max(Uc.dot(ie),se),ce=Math.min(Uc.dot(H),ce),me=Math.min(Uc.dot(j),me),Ee=Math.min(Uc.dot(ie),Ee);H=H.multiplyByScalar(.5*(ce+Y)),j=j.multiplyByScalar(.5*(me+J)),ie=ie.multiplyByScalar(.5*(Ee+se)),e.center.copy(H).add(j).add(ie);const He=Uce.set(Y-ce,J-me,se-Ee).multiplyByScalar(.5),Qe=new zs([He[0],0,0,0,He[1],0,0,0,He[2]]);return e.halfAxes.multiplyRight(Qe),e}const B0=512,f6=3,pF=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],gF=pF.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),Qce=gF.concat([[.25,.5],[.75,.5]]);class z0{constructor(e,n,r){oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"z",void 0),oe(this,"childVisible",void 0),oe(this,"selected",void 0),oe(this,"_children",void 0),this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new z0(e,n,r),new z0(e,n+1,r),new z0(e+1,n,r),new z0(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:s,maxZ:l,bounds:o,offset:p,project:v}=e,S=this.getBoundingVolume(i,p,v);if(o&&!this.insideBounds(o)||r.computeVisibility(S)<0)return!1;if(!this.childVisible){let{z:k}=this;if(k<l&&k>=s){const F=S.distanceTo(n.cameraPosition)*n.scale/n.height;k+=Math.floor(Math.log2(F))}if(k>=l)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const k of this.children)k.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const s=Math.pow(2,this.z),l=B0/s;return this.x*l<r&&this.y*l<i&&(this.x+1)*l>e&&(this.y+1)*l>n}getBoundingVolume(e,n,r){if(r){const p=this.z<1?Qce:this.z<2?gF:pF,v=[];for(const S of p){const M=yE(this.x+S[0],this.y+S[1],this.z);M[2]=e[0],v.push(r(M)),e[0]!==e[1]&&(M[2]=e[1],v.push(r(M)))}return Wce(v)}const i=Math.pow(2,this.z),s=B0/i,l=this.x*s+n*B0,o=B0-(this.y+1)*s;return new qS([l,o,e[0]],[l+s,o+s,e[1]])}}function qce(t,e,n,r){const i=t instanceof PAe&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:F,distance:H})=>new Td(F.clone().negate(),H)),l=new ju(s),o=t.distanceScales.unitsPerMeter[2],p=n&&n[0]*o||0,v=n&&n[1]*o||0,S=t instanceof Ac&&t.pitch<=60?e:0;if(r){const[F,H,j,ie]=r,Y=dA([F,ie]),J=dA([j,H]);r=[Y[0],B0-Y[1],J[0],B0-J[1]]}const M=new z0(0,0,0),k={viewport:t,project:i,cullingVolume:l,elevationBounds:[p,v],minZ:S,maxZ:e,bounds:r,offset:0};if(M.update(k),t instanceof Ac&&t.subViewports&&t.subViewports.length>1){for(k.offset=-1;M.update(k)&&!(--k.offset<-f6););for(k.offset=1;M.update(k)&&!(++k.offset>f6););}return M.getSelected()}const uc=512,Zce=[-1/0,-1/0,1/0,1/0],Yce={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function mF(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function Xce(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function Kce(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const s=Xce(r)%t.length;t=t[s]}let i=t;for(const s of Object.keys(n)){const l=new RegExp("{".concat(s,"}"),"g");i=i.replace(l,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function Jce(t,e,n){let r;if(e&&e.length===2){const[i,s]=e,l=t.getBounds({z:i}),o=t.getBounds({z:s});r=[Math.min(l[0],o[0]),Math.min(l[1],o[1]),Math.max(l[2],o[2]),Math.max(l[3],o[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function ehe({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(i=>mE(i,e,n))}function mE(t,e,n){if(!Array.isArray(e)){const s=n.x-t.x,l=n.y-t.y,{width:o,height:p}=n,v={targetZ:e},S=t.unproject([s,l],v),M=t.unproject([s+o,l],v),k=t.unproject([s,l+p],v),F=t.unproject([s+o,l+p],v);return[Math.min(S[0],M[0],k[0],F[0]),Math.min(S[1],M[1],k[1],F[1]),Math.max(S[0],M[0],k[0],F[0]),Math.max(S[1],M[1],k[1],F[1])]}const r=mE(t,e[0],n),i=mE(t,e[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function the(t,e,n){return n?mF(t,n).map(i=>i*e/uc):t.map(r=>r*e/uc)}function XS(t,e){return Math.pow(2,t)*uc/e}function yE(t,e,n){const r=XS(n,uc),i=t/r*360-180,s=Math.PI-2*Math.PI*e/r,l=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[i,l]}function d6(t,e,n,r){const i=XS(n,r);return[t/i*uc,e/i*uc]}function nhe(t,e,n,r,i=uc){if(t.isGeospatial){const[v,S]=yE(e,n,r),[M,k]=yE(e+1,n+1,r);return{west:v,north:S,east:M,south:k}}const[s,l]=d6(e,n,r,i),[o,p]=d6(e+1,n+1,r,i);return{left:s,top:l,right:o,bottom:p}}function rhe(t,e,n,r,i){const s=Jce(t,null,r),l=XS(e,n),[o,p,v,S]=the(s,l,i),M=[];for(let k=Math.floor(o);k<v;k++)for(let F=Math.floor(p);F<S;F++)M.push({x:k,y:F,z:e});return M}function ihe({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:s=uc,modelMatrix:l,modelMatrixInverse:o,zoomOffset:p=0}){let v=t.isGeospatial?Math.round(t.zoom+Math.log2(uc/s))+p:Math.ceil(t.zoom)+p;if(typeof n=="number"&&Number.isFinite(n)&&v<n){if(!i)return[];v=n}typeof e=="number"&&Number.isFinite(e)&&v>e&&(v=e);let S=i;return l&&o&&i&&!t.isGeospatial&&(S=mF(i,l)),t.isGeospatial?qce(t,v,r,i):rhe(t,v,s,S||Zce,o)}function she(t){let e={},n;return r=>{for(const i in r)if(!ohe(r[i],e[i])){n=t(r),e=r;break}return n}}function ohe(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}const p6=1,_v=2,ahe="never",lhe="no-overlap",KS="best-available",Ahe=5,uhe={[KS]:fhe,[lhe]:dhe,[ahe]:()=>{}},che={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class hhe{constructor(e){oe(this,"opts",void 0),oe(this,"_requestScheduler",void 0),oe(this,"_cache",void 0),oe(this,"_dirty",void 0),oe(this,"_tiles",void 0),oe(this,"_cacheByteSize",void 0),oe(this,"_viewport",void 0),oe(this,"_zRange",void 0),oe(this,"_selectedTiles",void 0),oe(this,"_frameNumber",void 0),oe(this,"_modelMatrix",void 0),oe(this,"_modelMatrixInverse",void 0),oe(this,"_maxZoom",void 0),oe(this,"_minZoom",void 0),oe(this,"onTileLoad",void 0),oe(this,"_getCullBounds",she(ehe)),this.opts={...che,...e},this.onTileLoad=n=>{var r,i;(r=(i=this.opts).onTileLoad)===null||r===void 0||r.call(i,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new eX({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new ca,this._modelMatrixInverse=new ca,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={}){const i=new ca(r),s=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!qu(this._zRange,n)||s){s&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const o=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=o.map(p=>this._getTile(p,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(o=>this._getTile(o.index,!0)));const l=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),l&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const r=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:i}=e;for(const[s,l,o,p]of r){let v;if("west"in i)v=i.west<o&&i.east>s&&i.south<p&&i.north>l;else{const S=Math.min(i.top,i.bottom),M=Math.max(i.top,i.bottom);v=i.left<o&&i.right>s&&S<p&&M>l}if(v)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:l}){const{tileSize:o,extent:p,zoomOffset:v}=this.opts;return ihe({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:o,extent:p,modelMatrix:s,modelMatrixInverse:l,zoomOffset:v})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:nhe(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||KS,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:uhe[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:Ahe*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[p,v]of e){if(!v.isVisible&&!v.isSelected){var l,o;this._cacheByteSize-=n.maxCacheByteSize?v.byteLength:0,e.delete(p),(l=(o=this.opts).onTileUnload)===null||l===void 0||l.call(o,v)}if(e.size<=r&&this._cacheByteSize<=i)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((p,v)=>p.zoom-v.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),s=!1;return!i&&n?(i=new Cce(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),s=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(s=!0),i&&s&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function fhe(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!yF(e)&&JS(e);for(const e of t)e.isVisible=!!(e.state&_v)}function dhe(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&yF(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=!!(n.state&_v),n.children&&(n.isVisible||n.state&p6))for(const r of n.children)r.state=p6;else n.isSelected&&JS(n)}function yF(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=_v,!0;e=e.parent}return!1}function JS(t){for(const e of t.children)e.isLoaded||e.content?e.state|=_v:JS(e)}const phe={TilesetClass:hhe,data:{type:"data",value:[]},dataComparator:Yce.equal,renderSubLayers:{type:"function",value:t=>new ha(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:KS,zRange:null,maxRequests:6,zoomOffset:0};class Fm extends Sr{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,r;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(r=n.selectedTiles)===null||r===void 0?void 0:r.every(i=>i.isLoaded&&i.layers&&i.layers.every(s=>s.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:s,maxZoom:l,minZoom:o,maxRequests:p,zoomOffset:v}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:l,minZoom:o,tileSize:e,refinementStrategy:i,extent:s,maxRequests:p,zoomOffset:v,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:s}=e,l=this.state.isLoaded!==s,o=this.state.frameNumber!==i;s&&(l||o)&&this._onViewportLoad(),o&&this.setState({frameNumber:i}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?Kce(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const r=n.props.tile;return e.picked&&(e.tile=r),e.sourceTile=r,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const r of n.layers)r.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=_f(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}}oe(Fm,"defaultProps",phe);oe(Fm,"layerName","TileLayer");const tb=Math.PI/180,ly=new Float32Array(16),g6=new Float32Array(12);function m6(t,e,n){const r=e[0]*tb,i=e[1]*tb,s=e[2]*tb,l=Math.sin(s),o=Math.sin(r),p=Math.sin(i),v=Math.cos(s),S=Math.cos(r),M=Math.cos(i),k=n[0],F=n[1],H=n[2];t[0]=k*M*S,t[1]=k*p*S,t[2]=k*-o,t[3]=F*(-p*v+M*o*l),t[4]=F*(M*v+p*o*l),t[5]=F*S*l,t[6]=H*(p*l+M*o*v),t[7]=H*(-M*l+p*o*v),t[8]=H*S*v}function y6(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const ghe={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:s,getTranslation:l,getTransformMatrix:o}=this.props,p=Array.isArray(o),v=p&&o.length===16,S=Array.isArray(s),M=Array.isArray(i),k=Array.isArray(l),F=v||!p&&!!o(r[0]);F?t.constant=v:t.constant=M&&S&&k;const H=t.value;if(t.constant){let j;F?(ly.set(o),j=y6(ly)):(j=g6,m6(j,i,s),j.set(l,9)),t.value=new Float32Array(j)}else{let j=e*t.size;const{iterable:ie,objectInfo:Y}=Fd(r,e,n);for(const J of ie){Y.index++;let se;if(F)ly.set(v?o:o(J,Y)),se=y6(ly);else{se=g6;const ce=M?i:i(J,Y),me=S?s:s(J,Y);m6(se,ce,me),se.set(k?l:l(J,Y),9)}H[j++]=se[0],H[j++]=se[1],H[j++]=se[2],H[j++]=se[3],H[j++]=se[4],H[j++]=se[5],H[j++]=se[6],H[j++]=se[7],H[j++]=se[8],H[j++]=se[9],H[j++]=se[10],H[j++]=se[11]}}}};function mhe(t,e){return e===Ar.CARTESIAN||e===Ar.METER_OFFSETS||e===Ar.DEFAULT&&!t.isGeospatial}const yhe=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,_he=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function _F(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,l=-1/0;const o=t.POSITION?t.POSITION.value:[],p=o&&o.length;for(let v=0;v<p;v+=3){const S=o[v],M=o[v+1],k=o[v+2];e=S<e?S:e,n=M<n?M:n,r=k<r?k:r,i=S>i?S:i,s=M>s?M:s,l=k>l?k:l}return[[e,n,r],[i,s,l]]}function vhe(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class O0{constructor(e,n){oe(this,"fields",void 0),oe(this,"metadata",void 0),vhe(Array.isArray(e)),xhe(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const l of r)e[l]=!0;const s=this.fields.filter(l=>e[l.name]);return new O0(s,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n.map(s=>this.fields[s]).filter(Boolean);return new O0(i,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof O0){const l=e;n=l.fields,r=_6(_6(new Map,this.metadata),l.metadata)}else n=e;const i=Object.create(null);for(const l of this.fields)i[l.name]=l;for(const l of n)i[l.name]=l;const s=Object.values(i);return new O0(s,r)}}function xhe(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function _6(t,e){return new Map([...t||new Map,...e||new Map])}class yg{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"nullable",void 0),oe(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new yg(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Mi=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),vF,xF,wF;class e4{static isNull(e){return e&&e.typeId===Mi.Null}static isInt(e){return e&&e.typeId===Mi.Int}static isFloat(e){return e&&e.typeId===Mi.Float}static isBinary(e){return e&&e.typeId===Mi.Binary}static isUtf8(e){return e&&e.typeId===Mi.Utf8}static isBool(e){return e&&e.typeId===Mi.Bool}static isDecimal(e){return e&&e.typeId===Mi.Decimal}static isDate(e){return e&&e.typeId===Mi.Date}static isTime(e){return e&&e.typeId===Mi.Time}static isTimestamp(e){return e&&e.typeId===Mi.Timestamp}static isInterval(e){return e&&e.typeId===Mi.Interval}static isList(e){return e&&e.typeId===Mi.List}static isStruct(e){return e&&e.typeId===Mi.Struct}static isUnion(e){return e&&e.typeId===Mi.Union}static isFixedSizeBinary(e){return e&&e.typeId===Mi.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Mi.FixedSizeList}static isMap(e){return e&&e.typeId===Mi.Map}static isDictionary(e){return e&&e.typeId===Mi.Dictionary}get typeId(){return Mi.NONE}compareTo(e){return this===e}}vF=Symbol.toStringTag;class Ud extends e4{constructor(e,n){super(),oe(this,"isSigned",void 0),oe(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Mi.Int}get[vF](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class whe extends Ud{constructor(){super(!0,8)}}class bhe extends Ud{constructor(){super(!0,16)}}class Ehe extends Ud{constructor(){super(!0,32)}}class The extends Ud{constructor(){super(!1,8)}}class She extends Ud{constructor(){super(!1,16)}}class Che extends Ud{constructor(){super(!1,32)}}const bF={HALF:16,SINGLE:32,DOUBLE:64};xF=Symbol.toStringTag;class EF extends e4{constructor(e){super(),oe(this,"precision",void 0),this.precision=e}get typeId(){return Mi.Float}get[xF](){return"Float"}toString(){return"Float".concat(this.precision)}}class Mhe extends EF{constructor(){super(bF.SINGLE)}}class Phe extends EF{constructor(){super(bF.DOUBLE)}}wF=Symbol.toStringTag;class khe extends e4{constructor(e,n){super(),oe(this,"listSize",void 0),oe(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Mi.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[wF](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function Ihe(t){switch(t.constructor){case Int8Array:return new whe;case Uint8Array:return new The;case Int16Array:return new bhe;case Uint16Array:return new She;case Int32Array:return new Ehe;case Uint32Array:return new Che;case Float32Array:return new Mhe;case Float64Array:return new Phe;default:throw new Error("array type not supported")}}function v6(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),sr.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function x6(t,e){if(t.attributes)return v6(t.attributes,e),t instanceof Zu?t:new Zu(t);if(t.positions||t.POSITION)return v6(t,e),new Zu({attributes:t});throw Error("Invalid mesh")}const Lhe=[0,0,0,255],Dhe={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Lhe},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class vv extends mA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){const e=!cr(this.context.gl),n={};return Mz(this.context.gl,ti.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:yhe,fs:_he,modules:[Uf,Zie,Vf],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:r}=this.props;if(!r)return null;if(n=(e=r.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:i}=x6(r,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,n=_F(i)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:ghe}),this.setState({emptyTexture:new da(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const l=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(l.NORMAL||l.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!s||mhe(n,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new ac(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:x6(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return n.setUniforms({sampler:r||i,hasTexture:!!r}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:!!e})}}oe(vv,"defaultProps",Dhe);oe(vv,"layerName","SimpleMeshLayer");const Rhe={inject:{"vs:#decl":`
attribute vec2 instanceDashArrays;
attribute float instanceDashOffsets;
varying vec2 vDashArray;
varying float vDashOffset;
`,"vs:#main-end":`
vDashArray = instanceDashArrays;
vDashOffset = instanceDashOffsets / width.x;
`,"fs:#decl":`
uniform float dashAlignMode;
uniform float capType;
uniform bool dashGapPickable;
varying vec2 vDashArray;
varying float vDashOffset;

float round(float x) {
  return floor(x + 0.5);
}
`,"fs:#main-start":`
  float solidLength = vDashArray.x;
  float gapLength = vDashArray.y;
  float unitLength = solidLength + gapLength;

  float offset;

  if (unitLength > 0.0) {
    if (dashAlignMode == 0.0) {
      offset = vDashOffset;
    } else {
      unitLength = vPathLength / round(vPathLength / unitLength);
      offset = solidLength / 2.0;
    }

    float unitOffset = mod(vPathPosition.y + offset, unitLength);

    if (gapLength > 0.0 && unitOffset > solidLength) {
      if (capType <= 0.5) {
        if (!(dashGapPickable && picking_uActive)) {
          discard;
        }
      } else {
        float distToEnd = length(vec2(
          min(unitOffset - solidLength, unitLength - unitOffset),
          vPathPosition.x
        ));
        if (distToEnd > 1.0) {
          if (!(dashGapPickable && picking_uActive)) {
            discard;
          }
        }
      }
    }
  }
`}},Bhe={inject:{"vs:#decl":`
attribute float instanceOffsets;
`,"vs:DECKGL_FILTER_SIZE":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  size *= offsetWidth;
`,"vs:#main-end":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  float offsetDir = sign(instanceOffsets);
  vPathPosition.x = (vPathPosition.x + offsetDir) * offsetWidth - offsetDir;
  vPathPosition.y *= offsetWidth;
  vPathLength *= offsetWidth;
`,"fs:#main-start":`
  float isInside;
  isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);
  if (isInside == 0.0) {
    discard;
  }
`}},zhe={getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1};class Vd extends GS{constructor({dash:e=!1,offset:n=!1,highPrecisionDash:r=!1}={}){super({dash:e||r,offset:n,highPrecisionDash:r})}isEnabled(e){return"pathTesselator"in e.state}getShaders(e){if(!e.isEnabled(this))return null;let n={};return e.opts.dash&&(n=sE(n,Rhe)),e.opts.offset&&(n=sE(n,Bhe)),n}initializeState(e,n){const r=this.getAttributeManager();!r||!n.isEnabled(this)||(n.opts.dash&&r.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"}}),n.opts.highPrecisionDash&&r.addInstanced({instanceDashOffsets:{size:1,accessor:"getPath",transform:n.getDashOffsets.bind(this)}}),n.opts.offset&&r.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}updateState(e,n){if(!n.isEnabled(this))return;const r={};n.opts.dash&&(r.dashAlignMode=this.props.dashJustified?1:0,r.dashGapPickable=!!this.props.dashGapPickable),this.state.model.setUniforms(r)}getDashOffsets(e){const n=[0],r=this.props.positionFormat==="XY"?2:3,i=Array.isArray(e[0]),s=i?e.length:e.length/r;let l,o;for(let p=0;p<s-1;p++)l=i?e[p]:e.slice(p*r,p*r+r),l=this.projectPosition(l),p>0&&(n[p]=n[p-1]+Nre(o,l)),o=l;return n}}oe(Vd,"defaultProps",zhe);oe(Vd,"extensionName","PathStyleExtension");const Ohe=typeof window<"u"?Ue.useLayoutEffect:Ue.useEffect,Fhe=Ohe;function h2(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const Nhe={position:"absolute",zIndex:-1};function TF(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>TF(n,e));if(xv(t)){if(Uhe(t))return e.style=Nhe,Ue.cloneElement(t,e);if(Vhe(t))return Ue.cloneElement(t,e)}return t}function xv(t){return t&&typeof t=="object"&&"type"in t||!1}function Uhe(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function Vhe(t){const e=t.type;return e&&e.deckGLViewProps}function _E(t){if(typeof t=="function")return Ue.createElement(El,{},t);if(Array.isArray(t))return t.map(_E);if(xv(t)){if(t.type===Ue.Fragment)return _E(t.props.children);if(h2(t.type,El))return t}return t}function Ghe({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return Ue.Children.forEach(_E(t),l=>{if(xv(l)){const o=l.type;if(h2(o,mA)){const p=$he(o,l.props);i.push(p)}else r.push(l);if(h2(o,El)&&o!==El&&l.props.id){const p=new o(l.props);s[p.id]=p}}else l&&r.push(l)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(l=>{s[l.id]=l}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function $he(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function jhe({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const l of t){let o=s,p=l;xv(l)&&h2(l.type,El)&&(o=l.props.id||s,p=l.props.children);const v=r.getViewport(o),S=r.getViewState(o);if(v){S.padding=v.padding;const{x:M,y:k,width:F,height:H}=v;p=TF(p,{x:M,y:k,width:F,height:H,viewport:v,viewState:S}),i[o]||(i[o]={viewport:v,children:[]}),i[o].children.push(p)}}return Object.keys(i).map(l=>{const{viewport:o,children:p}=i[l],{x:v,y:S,width:M,height:k}=o,F={position:"absolute",left:v,top:S,width:M,height:k},H="view-".concat(l),j=Ue.createElement("div",{key:H,id:H,style:F},...p);if(n){const ie={viewport:o,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:Y=>{Y.viewId=l,e._onViewStateChange(Y)}};return Ue.createElement(n,{key:H,value:ie},j)}return j})}const Hhe={mixBlendMode:null};function Whe({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in Hhe?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function Qhe(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function SF(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function qhe(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():SF(t)}});return r}const CF=Ue.forwardRef((t,e)=>{const[n,r]=Ue.useState(0),s=Ue.useRef({control:null,version:n,forceUpdate:()=>r(me=>me+1)}).current,l=Ue.useRef(null),o=Ue.useRef(null),p=Ue.useMemo(()=>Ghe(t),[t.layers,t.views,t.children]);let v=!0;const S=me=>{var Ee;return v&&t.viewState?(s.viewStateUpdateRequested=me,null):(s.viewStateUpdateRequested=null,(Ee=t.onViewStateChange)===null||Ee===void 0?void 0:Ee.call(t,me))},M=me=>{if(v)s.interactionStateUpdateRequested=me;else{var Ee;s.interactionStateUpdateRequested=null,(Ee=t.onInteractionStateChange)===null||Ee===void 0||Ee.call(t,me)}},k=Ue.useMemo(()=>{const me={...t,style:null,width:"100%",height:"100%",parent:l.current,canvas:o.current,layers:p.layers,views:p.views,onViewStateChange:S,onInteractionStateChange:M};return delete me._customRender,s.deck&&s.deck.setProps(me),me},[t]);Ue.useEffect(()=>{const me=t.Deck||vf;return s.deck=qhe(s,me,{...k,parent:l.current,canvas:o.current}),()=>{var Ee;return(Ee=s.deck)===null||Ee===void 0?void 0:Ee.finalize()}},[]),Fhe(()=>{SF(s);const{viewStateUpdateRequested:me,interactionStateUpdateRequested:Ee}=s;me&&S(me),Ee&&M(Ee)}),Ue.useImperativeHandle(e,()=>Qhe(s),[]);const F=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:H,width:j,height:ie,id:Y,style:J}=t,{containerStyle:se,canvasStyle:ce}=Ue.useMemo(()=>Whe({width:j,height:ie,style:J}),[j,ie,J]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===F||s.version!==n){s.lastRenderedViewports=F,s.version=n;const me=jhe({children:p.children,deck:s.deck,ContextProvider:H}),Ee=Ue.createElement("canvas",{key:"canvas",id:Y||"deckgl-overlay",ref:o,style:ce});s.control=Ue.createElement("div",{id:"".concat(Y||"deckgl","-wrapper"),ref:l,style:se},[Ee,me])}return v=!1,s.control});CF.defaultProps=vf.defaultProps;const t4=CF;function MF(t,e,n){if(t!==null)for(var r,i,s,l,o,p,v,S=0,M=0,k,F=t.type,H=F==="FeatureCollection",j=F==="Feature",ie=H?t.features.length:1,Y=0;Y<ie;Y++){v=H?t.features[Y].geometry:j?t.geometry:t,k=v?v.type==="GeometryCollection":!1,o=k?v.geometries.length:1;for(var J=0;J<o;J++){var se=0,ce=0;if(l=k?v.geometries[J]:v,l!==null){p=l.coordinates;var me=l.type;switch(S=n&&(me==="Polygon"||me==="MultiPolygon")?1:0,me){case null:break;case"Point":if(e(p,M,Y,se,ce)===!1)return!1;M++,se++;break;case"LineString":case"MultiPoint":for(r=0;r<p.length;r++){if(e(p[r],M,Y,se,ce)===!1)return!1;M++,me==="MultiPoint"&&se++}me==="LineString"&&se++;break;case"Polygon":case"MultiLineString":for(r=0;r<p.length;r++){for(i=0;i<p[r].length-S;i++){if(e(p[r][i],M,Y,se,ce)===!1)return!1;M++}me==="MultiLineString"&&se++,me==="Polygon"&&ce++}me==="Polygon"&&se++;break;case"MultiPolygon":for(r=0;r<p.length;r++){for(ce=0,i=0;i<p[r].length;i++){for(s=0;s<p[r][i].length-S;s++){if(e(p[r][i][s],M,Y,se,ce)===!1)return!1;M++}ce++}se++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(MF(l.geometries[r],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function f2(t){var e=[1/0,1/0,-1/0,-1/0];return MF(t,function(n){e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])}),e}f2.default=f2;function Zhe(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function Yhe(t,e,n){n===void 0&&(n={});for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<s[s.length-1].length;l++)if(s[s.length-1][l]!==s[0][l])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:t};return Zhe(o,e,n)}function Xhe(t,e){e===void 0&&(e={});var n=Number(t[0]),r=Number(t[1]),i=Number(t[2]),s=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var l=[n,r],o=[n,s],p=[i,s],v=[i,r];return Yhe([[l,v,p,o,l]],e.properties,{bbox:t,id:e.id})}function Khe(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function Jhe(t,e,n){if(n===void 0&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!w6(t[0])||!w6(t[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:t};return Khe(r,e,n)}function w6(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function efe(t,e){e===void 0&&(e={});var n=f2(t),r=(n[0]+n[2])/2,i=(n[1]+n[3])/2;return Jhe([r,i],e.properties,e)}function tfe(t,e){var n,r,i,s,l,o,p,v,S,M,k=0,F=t.type==="FeatureCollection",H=t.type==="Feature",j=F?t.features.length:1;for(n=0;n<j;n++){for(o=F?t.features[n].geometry:H?t.geometry:t,v=F?t.features[n].properties:H?t.properties:{},S=F?t.features[n].bbox:H?t.bbox:void 0,M=F?t.features[n].id:H?t.id:void 0,p=o?o.type==="GeometryCollection":!1,l=p?o.geometries.length:1,i=0;i<l;i++){if(s=p?o.geometries[i]:o,s===null){if(e(null,k,v,S,M)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,k,v,S,M)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(e(s.geometries[r],k,v,S,M)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}k++}}function nfe(t,e,n){var r=n;return tfe(t,function(i,s,l,o,p){s===0&&n===void 0?r=i:r=e(r,i,s,l,o,p)}),r}var b6=6378137;function E6(t){return nfe(t,function(e,n){return e+rfe(n)},0)}function rfe(t){var e=0,n;switch(t.type){case"Polygon":return T6(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)e+=T6(t.coordinates[n]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function T6(t){var e=0;if(t&&t.length>0){e+=Math.abs(S6(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(S6(t[n]))}return e}function S6(t){var e,n,r,i,s,l,o,p=0,v=t.length;if(v>2){for(o=0;o<v;o++)o===v-2?(i=v-2,s=v-1,l=0):o===v-1?(i=v-1,s=0,l=1):(i=o,s=o+1,l=o+2),e=t[i],n=t[s],r=t[l],p+=(nb(r[0])-nb(e[0]))*Math.sin(nb(n[1]));p=p*b6*b6/2}return p}function nb(t){return t*Math.PI/180}function d2(){this._=null}function wv(t){t.U=t.C=t.L=t.R=t.P=t.N=null}d2.prototype={constructor:d2,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=C6(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Dp(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Rp(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(Rp(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Dp(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,r=t.L,i=t.R,s,l;if(r?i?s=C6(i):s=r:s=i,e?e.L===t?e.L=s:e.R=s:this._=s,r&&i?(l=s.C,s.C=t.C,s.L=r,r.U=s,s!==i?(e=s.U,s.U=t.U,t=s.R,e.L=t,s.R=i,i.U=s):(s.U=e,e=s,t=s.R)):(l=t.C,t=s),t&&(t.U=e),!l){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(n=e.R,n.C&&(n.C=!1,e.C=!0,Dp(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,Rp(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,Dp(this,e),t=this._;break}}else if(n=e.L,n.C&&(n.C=!1,e.C=!0,Rp(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,Dp(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,Rp(this,e),t=this._;break}n.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}}};function Dp(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function Rp(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function C6(t){for(;t.L;)t=t.L;return t}function Jp(t,e,n,r){var i=[null,null],s=Ao.push(i)-1;return i.left=t,i.right=e,n&&p2(i,t,e,n),r&&p2(i,e,t,r),za[t.index].halfedges.push(s),za[e.index].halfedges.push(s),i}function Bp(t,e,n){var r=[e,n];return r.left=t,r}function p2(t,e,n,r){!t[0]&&!t[1]?(t[0]=r,t.left=e,t.right=n):t.left===n?t[1]=r:t[0]=r}function ife(t,e,n,r,i){var s=t[0],l=t[1],o=s[0],p=s[1],v=l[0],S=l[1],M=0,k=1,F=v-o,H=S-p,j;if(j=e-o,!(!F&&j>0)){if(j/=F,F<0){if(j<M)return;j<k&&(k=j)}else if(F>0){if(j>k)return;j>M&&(M=j)}if(j=r-o,!(!F&&j<0)){if(j/=F,F<0){if(j>k)return;j>M&&(M=j)}else if(F>0){if(j<M)return;j<k&&(k=j)}if(j=n-p,!(!H&&j>0)){if(j/=H,H<0){if(j<M)return;j<k&&(k=j)}else if(H>0){if(j>k)return;j>M&&(M=j)}if(j=i-p,!(!H&&j<0)){if(j/=H,H<0){if(j>k)return;j>M&&(M=j)}else if(H>0){if(j<M)return;j<k&&(k=j)}return!(M>0)&&!(k<1)||(M>0&&(t[0]=[o+M*F,p+M*H]),k<1&&(t[1]=[o+k*F,p+k*H])),!0}}}}}function sfe(t,e,n,r,i){var s=t[1];if(s)return!0;var l=t[0],o=t.left,p=t.right,v=o[0],S=o[1],M=p[0],k=p[1],F=(v+M)/2,H=(S+k)/2,j,ie;if(k===S){if(F<e||F>=r)return;if(v>M){if(!l)l=[F,n];else if(l[1]>=i)return;s=[F,i]}else{if(!l)l=[F,i];else if(l[1]<n)return;s=[F,n]}}else if(j=(v-M)/(k-S),ie=H-j*F,j<-1||j>1)if(v>M){if(!l)l=[(n-ie)/j,n];else if(l[1]>=i)return;s=[(i-ie)/j,i]}else{if(!l)l=[(i-ie)/j,i];else if(l[1]<n)return;s=[(n-ie)/j,n]}else if(S<k){if(!l)l=[e,j*e+ie];else if(l[0]>=r)return;s=[r,j*r+ie]}else{if(!l)l=[r,j*r+ie];else if(l[0]<e)return;s=[e,j*e+ie]}return t[0]=l,t[1]=s,!0}function ofe(t,e,n,r){for(var i=Ao.length,s;i--;)(!sfe(s=Ao[i],t,e,n,r)||!ife(s,t,e,n,r)||!(Math.abs(s[0][0]-s[1][0])>pi||Math.abs(s[0][1]-s[1][1])>pi))&&delete Ao[i]}function afe(t){return za[t.index]={site:t,halfedges:[]}}function lfe(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function PF(t,e){return e[+(e.left!==t.site)]}function Afe(t,e){return e[+(e.left===t.site)]}function ufe(){for(var t=0,e=za.length,n,r,i,s;t<e;++t)if((n=za[t])&&(s=(r=n.halfedges).length)){var l=new Array(s),o=new Array(s);for(i=0;i<s;++i)l[i]=i,o[i]=lfe(n,Ao[r[i]]);for(l.sort(function(p,v){return o[v]-o[p]}),i=0;i<s;++i)o[i]=r[l[i]];for(i=0;i<s;++i)r[i]=o[i]}}function cfe(t,e,n,r){var i=za.length,s,l,o,p,v,S,M,k,F,H,j,ie,Y=!0;for(s=0;s<i;++s)if(l=za[s]){for(o=l.site,v=l.halfedges,p=v.length;p--;)Ao[v[p]]||v.splice(p,1);for(p=0,S=v.length;p<S;)H=Afe(l,Ao[v[p]]),j=H[0],ie=H[1],M=PF(l,Ao[v[++p%S]]),k=M[0],F=M[1],(Math.abs(j-k)>pi||Math.abs(ie-F)>pi)&&(v.splice(p,0,Ao.push(Bp(o,H,Math.abs(j-t)<pi&&r-ie>pi?[t,Math.abs(k-t)<pi?F:r]:Math.abs(ie-r)<pi&&n-j>pi?[Math.abs(F-r)<pi?k:n,r]:Math.abs(j-n)<pi&&ie-e>pi?[n,Math.abs(k-n)<pi?F:e]:Math.abs(ie-e)<pi&&j-t>pi?[Math.abs(F-e)<pi?k:t,e]:null))-1),++S);S&&(Y=!1)}if(Y){var J,se,ce,me=1/0;for(s=0,Y=null;s<i;++s)(l=za[s])&&(o=l.site,J=o[0]-t,se=o[1]-e,ce=J*J+se*se,ce<me&&(me=ce,Y=l));if(Y){var Ee=[t,e],He=[t,r],Qe=[n,r],Ye=[n,e];Y.halfedges.push(Ao.push(Bp(o=Y.site,Ee,He))-1,Ao.push(Bp(o,He,Qe))-1,Ao.push(Bp(o,Qe,Ye))-1,Ao.push(Bp(o,Ye,Ee))-1)}}for(s=0;s<i;++s)(l=za[s])&&(l.halfedges.length||delete za[s])}var kF=[],n4;function hfe(){wv(this),this.x=this.y=this.arc=this.site=this.cy=null}function F0(t){var e=t.P,n=t.N;if(!(!e||!n)){var r=e.site,i=t.site,s=n.site;if(r!==s){var l=i[0],o=i[1],p=r[0]-l,v=r[1]-o,S=s[0]-l,M=s[1]-o,k=2*(p*M-v*S);if(!(k>=-mfe)){var F=p*p+v*v,H=S*S+M*M,j=(M*F-v*H)/k,ie=(p*H-S*F)/k,Y=kF.pop()||new hfe;Y.arc=t,Y.site=i,Y.x=j+l,Y.y=(Y.cy=ie+o)+Math.sqrt(j*j+ie*ie),t.circle=Y;for(var J=null,se=rm._;se;)if(Y.y<se.y||Y.y===se.y&&Y.x<=se.x)if(se.L)se=se.L;else{J=se.P;break}else if(se.R)se=se.R;else{J=se;break}rm.insert(J,Y),J||(n4=Y)}}}}function ed(t){var e=t.circle;e&&(e.P||(n4=e.N),rm.remove(e),kF.push(e),wv(e),t.circle=null)}var IF=[];function ffe(){wv(this),this.edge=this.site=this.circle=null}function M6(t){var e=IF.pop()||new ffe;return e.site=t,e}function rb(t){ed(t),td.remove(t),IF.push(t),wv(t)}function dfe(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],s=t.P,l=t.N,o=[t];rb(t);for(var p=s;p.circle&&Math.abs(n-p.circle.x)<pi&&Math.abs(r-p.circle.cy)<pi;)s=p.P,o.unshift(p),rb(p),p=s;o.unshift(p),ed(p);for(var v=l;v.circle&&Math.abs(n-v.circle.x)<pi&&Math.abs(r-v.circle.cy)<pi;)l=v.N,o.push(v),rb(v),v=l;o.push(v),ed(v);var S=o.length,M;for(M=1;M<S;++M)v=o[M],p=o[M-1],p2(v.edge,p.site,v.site,i);p=o[0],v=o[S-1],v.edge=Jp(p.site,v.site,null,i),F0(p),F0(v)}function pfe(t){for(var e=t[0],n=t[1],r,i,s,l,o=td._;o;)if(s=LF(o,n)-e,s>pi)o=o.L;else if(l=e-gfe(o,n),l>pi){if(!o.R){r=o;break}o=o.R}else{s>-pi?(r=o.P,i=o):l>-pi?(r=o,i=o.N):r=i=o;break}afe(t);var p=M6(t);if(td.insert(r,p),!(!r&&!i)){if(r===i){ed(r),i=M6(r.site),td.insert(p,i),p.edge=i.edge=Jp(r.site,p.site),F0(r),F0(i);return}if(!i){p.edge=Jp(r.site,p.site);return}ed(r),ed(i);var v=r.site,S=v[0],M=v[1],k=t[0]-S,F=t[1]-M,H=i.site,j=H[0]-S,ie=H[1]-M,Y=2*(k*ie-F*j),J=k*k+F*F,se=j*j+ie*ie,ce=[(ie*J-F*se)/Y+S,(k*se-j*J)/Y+M];p2(i.edge,v,H,ce),p.edge=Jp(v,t,null,ce),i.edge=Jp(t,H,null,ce),F0(r),F0(i)}}function LF(t,e){var n=t.site,r=n[0],i=n[1],s=i-e;if(!s)return r;var l=t.P;if(!l)return-1/0;n=l.site;var o=n[0],p=n[1],v=p-e;if(!v)return o;var S=o-r,M=1/s-1/v,k=S/v;return M?(-k+Math.sqrt(k*k-2*M*(S*S/(-2*v)-p+v/2+i-s/2)))/M+r:(r+o)/2}function gfe(t,e){var n=t.N;if(n)return LF(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var pi=1e-6,mfe=1e-12,td,za,rm,Ao;function yfe(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function _fe(t,e){return e[1]-t[1]||e[0]-t[0]}function P6(t,e){var n=t.sort(_fe).pop(),r,i,s;for(Ao=[],za=new Array(t.length),td=new d2,rm=new d2;;)if(s=n4,n&&(!s||n[1]<s.y||n[1]===s.y&&n[0]<s.x))(n[0]!==r||n[1]!==i)&&(pfe(n),r=n[0],i=n[1]),n=t.pop();else if(s)dfe(s.arc);else break;if(ufe(),e){var l=+e[0][0],o=+e[0][1],p=+e[1][0],v=+e[1][1];ofe(l,o,p,v),cfe(l,o,p,v)}this.edges=Ao,this.cells=za,td=rm=Ao=za=null}P6.prototype={constructor:P6,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(r){return PF(e,t[r])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(o=(s=n.halfedges).length)for(var i=n.site,s,l=-1,o,p,v=e[s[o-1]],S=v.left===i?v.right:v.left;++l<o;)p=S,v=e[s[l]],S=v.left===i?v.right:v.left,p&&S&&r<p.index&&r<S.index&&yfe(i,p,S)<0&&t.push([i.data,p.data,S.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r=this,i,s=r._found||0,l=r.cells.length,o;!(o=r.cells[s]);)if(++s>=l)return null;var p=t-o.site[0],v=e-o.site[1],S=p*p+v*v;do o=r.cells[i=s],s=null,o.halfedges.forEach(function(M){var k=r.edges[M],F=k.left;if(!((F===o.site||!F)&&!(F=k.right))){var H=t-F[0],j=e-F[1],ie=H*H+j*j;ie<S&&(S=ie,s=F.index)}});while(s!==null);return r._found=i,n==null||S<=n*n?o.site:null}};/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function vfe(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(v){return function(S){return p([v,S])}}function p(v){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=v[0]&2?i.return:v[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,v[1])).done)return s;switch(i=0,s&&(v=[v[0]&2,s.value]),v[0]){case 0:case 1:s=v;break;case 4:return n.label++,{value:v[1],done:!1};case 5:n.label++,i=v[1],v=[0];continue;case 7:v=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(v[0]===6||v[0]===2)){n=0;continue}if(v[0]===3&&(!s||v[1]>s[0]&&v[1]<s[3])){n.label=v[1];break}if(v[0]===6&&n.label<s[1]){n.label=s[1],s=v;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(v);break}s[2]&&n.ops.pop(),n.trys.pop();continue}v=e.call(t,n)}catch(S){v=[6,S],i=0}finally{r=s=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}}var _h=function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t}();function xfe(t,e){return t>e?1:t<e?-1:0}function Qc(t,e,n){for(var r=new _h(null,null),i=r,s=r;;){var l=n(t,e.key);if(l<0){if(e.left===null)break;if(n(t,e.left.key)<0){var o=e.left;if(e.left=o.right,o.right=e,e=o,e.left===null)break}s.left=e,s=e,e=e.left}else if(l>0){if(e.right===null)break;if(n(t,e.right.key)>0){var o=e.right;if(e.right=o.left,o.left=e,e=o,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function ib(t,e,n,r){var i=new _h(t,e);if(n===null)return i.left=i.right=null,i;n=Qc(t,n,r);var s=r(t,n.key);return s<0?(i.left=n.left,i.right=n,n.left=null):s>=0&&(i.right=n.right,i.left=n,n.right=null),i}function k6(t,e,n){var r=null,i=null;if(e){e=Qc(t,e,n);var s=n(e.key,t);s===0?(r=e.left,i=e.right):s<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function wfe(t,e,n){return e===null?t:(t===null||(e=Qc(t.key,e,n),e.left=t),e)}function vE(t,e,n,r,i){if(t){r(""+e+(n?"└── ":"├── ")+i(t)+`
`);var s=e+(n?"    ":"│   ");t.left&&vE(t.left,s,!1,r,i),t.right&&vE(t.right,s,!0,r,i)}}var r4=function(){function t(e){e===void 0&&(e=xfe),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=ib(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var r=new _h(e,n);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,s=Qc(e,this._root,i),l=i(e,s.key);return l===0?this._root=s:(l<0?(r.left=s.left,r.right=s,s.left=null):l>0&&(r.right=s.right,r.left=s,s.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,r){var i;if(n===null)return null;n=Qc(e,n,r);var s=r(e,n.key);return s===0?(n.left===null?i=n.right:(i=Qc(e,n.left,r),i.right=n.right),this._size--,i):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Qc(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return n;i<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=Qc(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return!0;i<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var r=this._root,i=[],s=!1;!s;)r!==null?(i.push(r),r=r.left):i.length!==0?(r=i.pop(),e.call(n,r),r=r.right):s=!0;return this},t.prototype.range=function(e,n,r,i){for(var s=[],l=this._comparator,o=this._root,p;s.length!==0||o;)if(o)s.push(o),o=o.left;else{if(o=s.pop(),p=l(o.key,n),p>0)break;if(l(o.key,e)>=0&&r.call(i,o))return this;o=o.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var r=n.key;return e.push(r)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var r=n.data;return e.push(r)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,r=!1,i=0,s=[];!r;)if(n)s.push(n),n=n.left;else if(s.length>0){if(n=s.pop(),i===e)return n;i++,n=n.right}else r=!0;return null},t.prototype.next=function(e){var n=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?(r=n,n=n.left):n=n.right}return r},t.prototype.prev=function(e){var n=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?n=n.left:(r=n,n=n.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return Efe(this._root)},t.prototype.load=function(e,n,r){n===void 0&&(n=[]),r===void 0&&(r=!1);var i=e.length,s=this._comparator;if(r&&bE(e,n,0,i-1,s),this._root===null)this._root=xE(e,n,0,i),this._size=i;else{var l=Tfe(this.toList(),bfe(e,n),s);i=this._size+i,this._root=wE({head:l},0,i)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var n=[];return vE(this._root,"",!0,function(r){return n.push(r)},e),n.join("")},t.prototype.update=function(e,n,r){var i=this._comparator,s=k6(e,this._root,i),l=s.left,o=s.right;i(e,n)<0?o=ib(n,r,o,i):l=ib(n,r,l,i),this._root=wfe(l,o,i)},t.prototype.split=function(e){return k6(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e,n,r;return vfe(this,function(i){switch(i.label){case 0:e=this._root,n=[],r=!1,i.label=1;case 1:return r?[3,6]:e===null?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return n.length===0?[3,4]:(e=n.pop(),[4,e]);case 3:return i.sent(),e=e.right,[3,5];case 4:r=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},t}();function xE(t,e,n,r){var i=r-n;if(i>0){var s=n+Math.floor(i/2),l=t[s],o=e[s],p=new _h(l,o);return p.left=xE(t,e,n,s),p.right=xE(t,e,s+1,r),p}return null}function bfe(t,e){for(var n=new _h(null,null),r=n,i=0;i<t.length;i++)r=r.next=new _h(t[i],e[i]);return r.next=null,n.next}function Efe(t){for(var e=t,n=[],r=!1,i=new _h(null,null),s=i;!r;)e?(n.push(e),e=e.left):n.length>0?(e=s=s.next=n.pop(),e=e.right):r=!0;return s.next=null,i.next}function wE(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),s=wE(t,e,i),l=t.head;return l.left=s,t.head=t.head.next,l.right=wE(t,i+1,n),l}return null}function Tfe(t,e,n){for(var r=new _h(null,null),i=r,s=t,l=e;s!==null&&l!==null;)n(s.key,l.key)<0?(i.next=s,s=s.next):(i.next=l,l=l.next),i=i.next;return s!==null?i.next=s:l!==null&&(i.next=l),r.next}function bE(t,e,n,r,i){if(!(n>=r)){for(var s=t[n+r>>1],l=n-1,o=r+1;;){do l++;while(i(t[l],s)<0);do o--;while(i(t[o],s)>0);if(l>=o)break;var p=t[l];t[l]=t[o],t[o]=p,p=e[l],e[l]=e[o],e[o]=p}bE(t,e,n,o,i),bE(t,e,o+1,r,i)}}const zp=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,EE=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x,i=t.ll.y<e.ll.y?e.ll.y:t.ll.y,s=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:n,y:i},ur:{x:r,y:s}}};let eh=Number.EPSILON;eh===void 0&&(eh=Math.pow(2,-52));const Sfe=eh*eh,I6=(t,e)=>{if(-eh<t&&t<eh&&-eh<e&&e<eh)return 0;const n=t-e;return n*n<Sfe*t*e?0:t<e?-1:1};class Cfe{constructor(){this.reset()}reset(){this.xRounder=new L6,this.yRounder=new L6}round(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}class L6{constructor(){this.tree=new r4,this.round(0)}round(e){const n=this.tree.add(e),r=this.tree.prev(n);if(r!==null&&I6(n.key,r.key)===0)return this.tree.remove(e),r.key;const i=this.tree.next(n);return i!==null&&I6(n.key,i.key)===0?(this.tree.remove(e),i.key):e}}const im=new Cfe,Zy=(t,e)=>t.x*e.y-t.y*e.x,DF=(t,e)=>t.x*e.x+t.y*e.y,D6=(t,e,n)=>{const r=dQ(t.x,t.y,e.x,e.y,n.x,n.y);return r>0?-1:r<0?1:0},g2=t=>Math.sqrt(DF(t,t)),Mfe=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return Zy(i,r)/g2(i)/g2(r)},Pfe=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return DF(i,r)/g2(i)/g2(r)},R6=(t,e,n)=>e.y===0?null:{x:t.x+e.x/e.y*(n-t.y),y:n},B6=(t,e,n)=>e.x===0?null:{x:n,y:t.y+e.y/e.x*(n-t.x)},kfe=(t,e,n,r)=>{if(e.x===0)return B6(n,r,t.x);if(r.x===0)return B6(t,e,n.x);if(e.y===0)return R6(n,r,t.y);if(r.y===0)return R6(t,e,n.y);const i=Zy(e,r);if(i==0)return null;const s={x:n.x-t.x,y:n.y-t.y},l=Zy(s,e)/i,o=Zy(s,r)/i,p=t.x+o*e.x,v=n.x+l*r.x,S=t.y+o*e.y,M=n.y+l*r.y,k=(p+v)/2,F=(S+M)/2;return{x:k,y:F}};class fl{static compare(e,n){const r=fl.comparePoints(e.point,n.point);return r!==0?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:hh.compare(e.segment,n.segment))}static comparePoints(e,n){return e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0}constructor(e,n){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const n=e.point.events;for(let r=0,i=n.length;r<i;r++){const s=n[r];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let n=0;n<e;n++){const r=this.point.events[n];if(r.segment.consumedBy===void 0)for(let i=n+1;i<e;i++){const s=this.point.events[i];s.consumedBy===void 0&&r.otherSE.point.events===s.otherSE.point.events&&r.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const e=[];for(let n=0,r=this.point.events.length;n<r;n++){const i=this.point.events[n];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&e.push(i)}return e}getLeftmostComparator(e){const n=new Map,r=i=>{const s=i.otherSE;n.set(i,{sine:Mfe(this.point,e.point,s.point),cosine:Pfe(this.point,e.point,s.point)})};return(i,s)=>{n.has(i)||r(i),n.has(s)||r(s);const{sine:l,cosine:o}=n.get(i),{sine:p,cosine:v}=n.get(s);return l>=0&&p>=0?o<v?1:o>v?-1:0:l<0&&p<0?o<v?-1:o>v?1:0:p<l?-1:p>l?1:0}}}let Ife=0;class hh{static compare(e,n){const r=e.leftSE.point.x,i=n.leftSE.point.x,s=e.rightSE.point.x,l=n.rightSE.point.x;if(l<r)return 1;if(s<i)return-1;const o=e.leftSE.point.y,p=n.leftSE.point.y,v=e.rightSE.point.y,S=n.rightSE.point.y;if(r<i){if(p<o&&p<v)return 1;if(p>o&&p>v)return-1;const M=e.comparePoint(n.leftSE.point);if(M<0)return 1;if(M>0)return-1;const k=n.comparePoint(e.rightSE.point);return k!==0?k:-1}if(r>i){if(o<p&&o<S)return-1;if(o>p&&o>S)return 1;const M=n.comparePoint(e.leftSE.point);if(M!==0)return M;const k=e.comparePoint(n.rightSE.point);return k<0?1:k>0?-1:1}if(o<p)return-1;if(o>p)return 1;if(s<l){const M=n.comparePoint(e.rightSE.point);if(M!==0)return M}if(s>l){const M=e.comparePoint(n.rightSE.point);if(M<0)return 1;if(M>0)return-1}if(s!==l){const M=v-o,k=s-r,F=S-p,H=l-i;if(M>k&&F<H)return 1;if(M<k&&F>H)return-1}return s>l?1:s<l||v<S?-1:v>S?1:e.id<n.id?-1:e.id>n.id?1:0}constructor(e,n,r,i){this.id=++Ife,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=i}static fromRing(e,n,r){let i,s,l;const o=fl.comparePoints(e,n);if(o<0)i=e,s=n,l=1;else if(o>0)i=n,s=e,l=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const p=new fl(i,!0),v=new fl(s,!1);return new hh(p,v,[r],[l])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<n?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const n=this.leftSE.point,r=this.rightSE.point,i=this.vector();if(n.x===r.x)return e.x===n.x?0:e.x<n.x?1:-1;const s=(e.y-n.y)/i.y,l=n.x+s*i.x;if(e.x===l)return 0;const o=(e.x-n.x)/i.x,p=n.y+o*i.y;return e.y===p?0:e.y<p?-1:1}getIntersection(e){const n=this.bbox(),r=e.bbox(),i=EE(n,r);if(i===null)return null;const s=this.leftSE.point,l=this.rightSE.point,o=e.leftSE.point,p=e.rightSE.point,v=zp(n,o)&&this.comparePoint(o)===0,S=zp(r,s)&&e.comparePoint(s)===0,M=zp(n,p)&&this.comparePoint(p)===0,k=zp(r,l)&&e.comparePoint(l)===0;if(S&&v)return k&&!M?l:!k&&M?p:null;if(S)return M&&s.x===p.x&&s.y===p.y?null:s;if(v)return k&&l.x===o.x&&l.y===o.y?null:o;if(k&&M)return null;if(k)return l;if(M)return p;const F=kfe(s,this.vector(),o,e.vector());return F===null||!zp(i,F)?null:im.round(F.x,F.y)}split(e){const n=[],r=e.events!==void 0,i=new fl(e,!0),s=new fl(e,!1),l=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(i);const o=new hh(i,l,this.rings.slice(),this.windings.slice());return fl.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),fl.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),s.checkForConsuming()),n}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,r=this.windings.length;n<r;n++)this.windings[n]*=-1}consume(e){let n=this,r=e;for(;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=hh.compare(n,r);if(i!==0){if(i>0){const s=n;n=r,r=s}if(n.prev===r){const s=n;n=r,r=s}for(let s=0,l=r.rings.length;s<l;s++){const o=r.rings[s],p=r.windings[s],v=n.rings.indexOf(o);v===-1?(n.rings.push(o),n.windings.push(p)):n.windings[v]+=p}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let o=0,p=this.rings.length;o<p;o++){const v=this.rings[o],S=this.windings[o],M=n.indexOf(v);M===-1?(n.push(v),r.push(S)):r[M]+=S}const s=[],l=[];for(let o=0,p=n.length;o<p;o++){if(r[o]===0)continue;const v=n[o],S=v.poly;if(l.indexOf(S)===-1)if(v.isExterior)s.push(S);else{l.indexOf(S)===-1&&l.push(S);const M=s.indexOf(v.poly);M!==-1&&s.splice(M,1)}}for(let o=0,p=s.length;o<p;o++){const v=s[o].multiPoly;i.indexOf(v)===-1&&i.push(v)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(aA.type){case"union":{const r=e.length===0,i=n.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;e.length<n.length?(r=e.length,i=n.length):(r=n.length,i=e.length),this._isInResult=i===aA.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(e.length-n.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(e)!==r(n);break}default:throw new Error(`Unrecognized operation type found ${aA.type}`)}return this._isInResult}}class z6{constructor(e,n,r){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=im.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let s=i;for(let l=1,o=e.length;l<o;l++){if(typeof e[l][0]!="number"||typeof e[l][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let p=im.round(e[l][0],e[l][1]);p.x===s.x&&p.y===s.y||(this.segments.push(hh.fromRing(s,p,this)),p.x<this.bbox.ll.x&&(this.bbox.ll.x=p.x),p.y<this.bbox.ll.y&&(this.bbox.ll.y=p.y),p.x>this.bbox.ur.x&&(this.bbox.ur.x=p.x),p.y>this.bbox.ur.y&&(this.bbox.ur.y=p.y),s=p)}(i.x!==s.x||i.y!==s.y)&&this.segments.push(hh.fromRing(s,i,this))}getSweepEvents(){const e=[];for(let n=0,r=this.segments.length;n<r;n++){const i=this.segments[n];e.push(i.leftSE),e.push(i.rightSE)}return e}}class Lfe{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new z6(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,i=e.length;r<i;r++){const s=new z6(e[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getSweepEvents();for(let s=0,l=i.length;s<l;s++)e.push(i[s])}return e}}class O6{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let r=0,i=e.length;r<i;r++){const s=new Lfe(e[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getSweepEvents();for(let s=0,l=i.length;s<l;s++)e.push(i[s])}return e}}class m2{static factory(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.isInResult()||s.ringOut)continue;let l=null,o=s.leftSE,p=s.rightSE;const v=[o],S=o.point,M=[];for(;l=o,o=p,v.push(o),o.point!==S;)for(;;){const k=o.getAvailableLinkedEvents();if(k.length===0){const j=v[0].point,ie=v[v.length-1].point;throw new Error(`Unable to complete output ring starting at [${j.x}, ${j.y}]. Last matching segment found ends at [${ie.x}, ${ie.y}].`)}if(k.length===1){p=k[0].otherSE;break}let F=null;for(let j=0,ie=M.length;j<ie;j++)if(M[j].point===o.point){F=j;break}if(F!==null){const j=M.splice(F)[0],ie=v.splice(j.index);ie.unshift(ie[0].otherSE),n.push(new m2(ie.reverse()));continue}M.push({index:v.length,point:o.point});const H=o.getLeftmostComparator(l);p=k.sort(H)[0].otherSE;break}n.push(new m2(v))}return n}constructor(e){this.events=e;for(let n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const n=[e];for(let v=1,S=this.events.length-1;v<S;v++){const M=this.events[v].point,k=this.events[v+1].point;D6(M,e,k)!==0&&(n.push(M),e=M)}if(n.length===1)return null;const r=n[0],i=n[1];D6(r,e,i)===0&&n.shift(),n.push(n[0]);const s=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:n.length-1,o=this.isExteriorRing()?n.length:-1,p=[];for(let v=l;v!=o;v+=s)p.push([n[v].x,n[v].y]);return p}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let i=1,s=this.events.length;i<s;i++){const l=this.events[i];fl.compare(e,l)>0&&(e=l)}let n=e.segment.prevInResult(),r=n?n.prevInResult():null;for(;;){if(!n)return null;if(!r)return n.ringOut;if(r.ringOut!==n.ringOut)return r.ringOut.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut.enclosingRing();n=r.prevInResult(),r=n?n.prevInResult():null}}}class F6{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getGeom();i!==null&&e.push(i)}return e}}class Dfe{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.poly)if(s.isExteriorRing())n.push(new F6(s));else{const l=s.enclosingRing();l.poly||n.push(new F6(l)),l.poly.addInterior(s)}}return n}}class Rfe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hh.compare;this.queue=e,this.tree=new r4(n),this.segments=[]}process(e){const n=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),r;const i=e.isLeft?this.tree.add(n):this.tree.find(n);if(!i)throw new Error(`Unable to find segment #${n.id} [${n.leftSE.point.x}, ${n.leftSE.point.y}] -> [${n.rightSE.point.x}, ${n.rightSE.point.y}] in SweepLine tree.`);let s=i,l=i,o,p;for(;o===void 0;)s=this.tree.prev(s),s===null?o=null:s.key.consumedBy===void 0&&(o=s.key);for(;p===void 0;)l=this.tree.next(l),l===null?p=null:l.key.consumedBy===void 0&&(p=l.key);if(e.isLeft){let v=null;if(o){const M=o.getIntersection(n);if(M!==null&&(n.isAnEndpoint(M)||(v=M),!o.isAnEndpoint(M))){const k=this._splitSafely(o,M);for(let F=0,H=k.length;F<H;F++)r.push(k[F])}}let S=null;if(p){const M=p.getIntersection(n);if(M!==null&&(n.isAnEndpoint(M)||(S=M),!p.isAnEndpoint(M))){const k=this._splitSafely(p,M);for(let F=0,H=k.length;F<H;F++)r.push(k[F])}}if(v!==null||S!==null){let M=null;v===null?M=S:S===null?M=v:M=fl.comparePoints(v,S)<=0?v:S,this.queue.remove(n.rightSE),r.push(n.rightSE);const k=n.split(M);for(let F=0,H=k.length;F<H;F++)r.push(k[F])}r.length>0?(this.tree.remove(n),r.push(e)):(this.segments.push(n),n.prev=o)}else{if(o&&p){const v=o.getIntersection(p);if(v!==null){if(!o.isAnEndpoint(v)){const S=this._splitSafely(o,v);for(let M=0,k=S.length;M<k;M++)r.push(S[M])}if(!p.isAnEndpoint(v)){const S=this._splitSafely(p,v);for(let M=0,k=S.length;M<k;M++)r.push(S[M])}}}this.tree.remove(n)}return r}_splitSafely(e,n){this.tree.remove(e);const r=e.rightSE;this.queue.remove(r);const i=e.split(n);return i.push(r),e.consumedBy===void 0&&this.tree.add(e),i}}const N6=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Bfe=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class zfe{run(e,n,r){aA.type=e,im.reset();const i=[new O6(n,!0)];for(let M=0,k=r.length;M<k;M++)i.push(new O6(r[M],!1));if(aA.numMultiPolys=i.length,aA.type==="difference"){const M=i[0];let k=1;for(;k<i.length;)EE(i[k].bbox,M.bbox)!==null?k++:i.splice(k,1)}if(aA.type==="intersection")for(let M=0,k=i.length;M<k;M++){const F=i[M];for(let H=M+1,j=i.length;H<j;H++)if(EE(F.bbox,i[H].bbox)===null)return[]}const s=new r4(fl.compare);for(let M=0,k=i.length;M<k;M++){const F=i[M].getSweepEvents();for(let H=0,j=F.length;H<j;H++)if(s.insert(F[H]),s.size>N6)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const l=new Rfe(s);let o=s.size,p=s.pop();for(;p;){const M=p.key;if(s.size===o){const F=M.segment;throw new Error(`Unable to pop() ${M.isLeft?"left":"right"} SweepEvent [${M.point.x}, ${M.point.y}] from segment #${F.id} [${F.leftSE.point.x}, ${F.leftSE.point.y}] -> [${F.rightSE.point.x}, ${F.rightSE.point.y}] from queue.`)}if(s.size>N6)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(l.segments.length>Bfe)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const k=l.process(M);for(let F=0,H=k.length;F<H;F++){const j=k[F];j.consumedBy===void 0&&s.insert(j)}o=s.size,p=s.pop()}im.reset();const v=m2.factory(l.segments);return new Dfe(v).getGeom()}}const aA=new zfe,Ofe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return aA.run("union",t,n)},Ffe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return aA.run("intersection",t,n)},Nfe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return aA.run("xor",t,n)},Ufe=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return aA.run("difference",t,n)};var Vfe={union:Ofe,intersection:Ffe,xor:Nfe,difference:Ufe};function RF(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function Gfe(t,e,n){n===void 0&&(n={});for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var l=0;l<s[s.length-1].length;l++)if(s[s.length-1][l]!==s[0][l])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:t};return RF(o,e,n)}function $fe(t,e,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:t};return RF(r,e,n)}function U6(t){return t.type==="Feature"?t.geometry:t}function V6(t,e,n){n===void 0&&(n={});var r=U6(t),i=U6(e),s=Vfe.intersection(r.coordinates,i.coordinates);return s.length===0?null:s.length===1?Gfe(s[0],n.properties):$fe(s,n.properties)}function BF(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function jfe(t){return t.length===1&&(t=Hfe(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function Hfe(t){return function(e,n){return BF(t(e),n)}}jfe(BF);function sm(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var sb=Array.prototype.slice;function Wfe(t){return t}var Yy=1,Xy=2,TE=3,Ay=4,G6=1e-6;function Qfe(t){return"translate("+(t+.5)+",0)"}function qfe(t){return"translate(0,"+(t+.5)+")"}function Zfe(t){return function(e){return+t(e)}}function Yfe(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function Xfe(){return!this.__axis}function i4(t,e){var n=[],r=null,i=null,s=6,l=6,o=3,p=t===Yy||t===Ay?-1:1,v=t===Ay||t===Xy?"x":"y",S=t===Yy||t===TE?Qfe:qfe;function M(k){var F=r??(e.ticks?e.ticks.apply(e,n):e.domain()),H=i??(e.tickFormat?e.tickFormat.apply(e,n):Wfe),j=Math.max(s,0)+o,ie=e.range(),Y=+ie[0]+.5,J=+ie[ie.length-1]+.5,se=(e.bandwidth?Yfe:Zfe)(e.copy()),ce=k.selection?k.selection():k,me=ce.selectAll(".domain").data([null]),Ee=ce.selectAll(".tick").data(F,e).order(),He=Ee.exit(),Qe=Ee.enter().append("g").attr("class","tick"),Ye=Ee.select("line"),nt=Ee.select("text");me=me.merge(me.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Ee=Ee.merge(Qe),Ye=Ye.merge(Qe.append("line").attr("stroke","currentColor").attr(v+"2",p*s)),nt=nt.merge(Qe.append("text").attr("fill","currentColor").attr(v,p*j).attr("dy",t===Yy?"0em":t===TE?"0.71em":"0.32em")),k!==ce&&(me=me.transition(k),Ee=Ee.transition(k),Ye=Ye.transition(k),nt=nt.transition(k),He=He.transition(k).attr("opacity",G6).attr("transform",function(Fe){return isFinite(Fe=se(Fe))?S(Fe):this.getAttribute("transform")}),Qe.attr("opacity",G6).attr("transform",function(Fe){var tt=this.parentNode.__axis;return S(tt&&isFinite(tt=tt(Fe))?tt:se(Fe))})),He.remove(),me.attr("d",t===Ay||t==Xy?l?"M"+p*l+","+Y+"H0.5V"+J+"H"+p*l:"M0.5,"+Y+"V"+J:l?"M"+Y+","+p*l+"V0.5H"+J+"V"+p*l:"M"+Y+",0.5H"+J),Ee.attr("opacity",1).attr("transform",function(Fe){return S(se(Fe))}),Ye.attr(v+"2",p*s),nt.attr(v,p*j).text(H),ce.filter(Xfe).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Xy?"start":t===Ay?"end":"middle"),ce.each(function(){this.__axis=se})}return M.scale=function(k){return arguments.length?(e=k,M):e},M.ticks=function(){return n=sb.call(arguments),M},M.tickArguments=function(k){return arguments.length?(n=k==null?[]:sb.call(k),M):n.slice()},M.tickValues=function(k){return arguments.length?(r=k==null?null:sb.call(k),M):r&&r.slice()},M.tickFormat=function(k){return arguments.length?(i=k,M):i},M.tickSize=function(k){return arguments.length?(s=l=+k,M):s},M.tickSizeInner=function(k){return arguments.length?(s=+k,M):s},M.tickSizeOuter=function(k){return arguments.length?(l=+k,M):l},M.tickPadding=function(k){return arguments.length?(o=+k,M):o},M}function Kfe(t){return i4(Yy,t)}function zF(t){return i4(Xy,t)}function Jfe(t){return i4(TE,t)}var e0e={value:function(){}};function OF(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ky(n)}function Ky(t){this._=t}function t0e(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ky.prototype=OF.prototype={constructor:Ky,on:function(t,e){var n=this._,r=t0e(t+"",n),i,s=-1,l=r.length;if(arguments.length<2){for(;++s<l;)if((i=(t=r[s]).type)&&(i=n0e(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<l;)if(i=(t=r[s]).type)n[i]=$6(n[i],t.name,e);else if(e==null)for(i in n)n[i]=$6(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ky(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function n0e(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function $6(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=e0e,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var SE="http://www.w3.org/1999/xhtml";const j6={svg:"http://www.w3.org/2000/svg",xhtml:SE,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function bv(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),j6.hasOwnProperty(e)?{space:j6[e],local:t}:t}function r0e(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===SE&&e.documentElement.namespaceURI===SE?e.createElement(t):e.createElementNS(n,t)}}function i0e(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function FF(t){var e=bv(t);return(e.local?i0e:r0e)(e)}function s0e(){}function s4(t){return t==null?s0e:function(){return this.querySelector(t)}}function o0e(t){typeof t!="function"&&(t=s4(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=new Array(l),p,v,S=0;S<l;++S)(p=s[S])&&(v=t.call(p,p.__data__,S,s))&&("__data__"in p&&(v.__data__=p.__data__),o[S]=v);return new pA(r,this._parents)}function a0e(){return[]}function NF(t){return t==null?a0e:function(){return this.querySelectorAll(t)}}function l0e(t){typeof t!="function"&&(t=NF(t));for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var l=e[s],o=l.length,p,v=0;v<o;++v)(p=l[v])&&(r.push(t.call(p,p.__data__,v,l)),i.push(p));return new pA(r,i)}function UF(t){return function(){return this.matches(t)}}function A0e(t){typeof t!="function"&&(t=UF(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,v=0;v<l;++v)(p=s[v])&&t.call(p,p.__data__,v,s)&&o.push(p);return new pA(r,this._parents)}function VF(t){return new Array(t.length)}function u0e(){return new pA(this._enter||this._groups.map(VF),this._parents)}function y2(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}y2.prototype={constructor:y2,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function c0e(t){return function(){return t}}var H6="$";function h0e(t,e,n,r,i,s){for(var l=0,o,p=e.length,v=s.length;l<v;++l)(o=e[l])?(o.__data__=s[l],r[l]=o):n[l]=new y2(t,s[l]);for(;l<p;++l)(o=e[l])&&(i[l]=o)}function f0e(t,e,n,r,i,s,l){var o,p,v={},S=e.length,M=s.length,k=new Array(S),F;for(o=0;o<S;++o)(p=e[o])&&(k[o]=F=H6+l.call(p,p.__data__,o,e),F in v?i[o]=p:v[F]=p);for(o=0;o<M;++o)F=H6+l.call(t,s[o],o,s),(p=v[F])?(r[o]=p,p.__data__=s[o],v[F]=null):n[o]=new y2(t,s[o]);for(o=0;o<S;++o)(p=e[o])&&v[k[o]]===p&&(i[o]=p)}function d0e(t,e){if(!t)return F=new Array(this.size()),v=-1,this.each(function(Ee){F[++v]=Ee}),F;var n=e?f0e:h0e,r=this._parents,i=this._groups;typeof t!="function"&&(t=c0e(t));for(var s=i.length,l=new Array(s),o=new Array(s),p=new Array(s),v=0;v<s;++v){var S=r[v],M=i[v],k=M.length,F=t.call(S,S&&S.__data__,v,r),H=F.length,j=o[v]=new Array(H),ie=l[v]=new Array(H),Y=p[v]=new Array(k);n(S,M,j,ie,Y,F,e);for(var J=0,se=0,ce,me;J<H;++J)if(ce=j[J]){for(J>=se&&(se=J+1);!(me=ie[se])&&++se<H;);ce._next=me||null}}return l=new pA(l,r),l._enter=o,l._exit=p,l}function p0e(){return new pA(this._exit||this._groups.map(VF),this._parents)}function g0e(t,e,n){var r=this.enter(),i=this,s=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(i=e(i)),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function m0e(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),l=new Array(r),o=0;o<s;++o)for(var p=e[o],v=n[o],S=p.length,M=l[o]=new Array(S),k,F=0;F<S;++F)(k=p[F]||v[F])&&(M[F]=k);for(;o<r;++o)l[o]=e[o];return new pA(l,this._parents)}function y0e(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],l;--i>=0;)(l=r[i])&&(s&&l.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(l,s),s=l);return this}function _0e(t){t||(t=v0e);function e(M,k){return M&&k?t(M.__data__,k.__data__):!M-!k}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var l=n[s],o=l.length,p=i[s]=new Array(o),v,S=0;S<o;++S)(v=l[S])&&(p[S]=v);p.sort(e)}return new pA(i,this._parents).order()}function v0e(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function x0e(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function w0e(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function b0e(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var l=r[i];if(l)return l}return null}function E0e(){var t=0;return this.each(function(){++t}),t}function T0e(){return!this.node()}function S0e(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,l=i.length,o;s<l;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this}function C0e(t){return function(){this.removeAttribute(t)}}function M0e(t){return function(){this.removeAttributeNS(t.space,t.local)}}function P0e(t,e){return function(){this.setAttribute(t,e)}}function k0e(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function I0e(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function L0e(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function D0e(t,e){var n=bv(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?M0e:C0e:typeof e=="function"?n.local?L0e:I0e:n.local?k0e:P0e)(n,e))}function GF(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function R0e(t){return function(){this.style.removeProperty(t)}}function B0e(t,e,n){return function(){this.style.setProperty(t,e,n)}}function z0e(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function O0e(t,e,n){return arguments.length>1?this.each((e==null?R0e:typeof e=="function"?z0e:B0e)(t,e,n??"")):Sd(this.node(),t)}function Sd(t,e){return t.style.getPropertyValue(e)||GF(t).getComputedStyle(t,null).getPropertyValue(e)}function F0e(t){return function(){delete this[t]}}function N0e(t,e){return function(){this[t]=e}}function U0e(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function V0e(t,e){return arguments.length>1?this.each((e==null?F0e:typeof e=="function"?U0e:N0e)(t,e)):this.node()[t]}function $F(t){return t.trim().split(/^|\s+/)}function o4(t){return t.classList||new jF(t)}function jF(t){this._node=t,this._names=$F(t.getAttribute("class")||"")}jF.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function HF(t,e){for(var n=o4(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function WF(t,e){for(var n=o4(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function G0e(t){return function(){HF(this,t)}}function $0e(t){return function(){WF(this,t)}}function j0e(t,e){return function(){(e.apply(this,arguments)?HF:WF)(this,t)}}function H0e(t,e){var n=$F(t+"");if(arguments.length<2){for(var r=o4(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?j0e:e?G0e:$0e)(n,e))}function W0e(){this.textContent=""}function Q0e(t){return function(){this.textContent=t}}function q0e(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Z0e(t){return arguments.length?this.each(t==null?W0e:(typeof t=="function"?q0e:Q0e)(t)):this.node().textContent}function Y0e(){this.innerHTML=""}function X0e(t){return function(){this.innerHTML=t}}function K0e(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function J0e(t){return arguments.length?this.each(t==null?Y0e:(typeof t=="function"?K0e:X0e)(t)):this.node().innerHTML}function ede(){this.nextSibling&&this.parentNode.appendChild(this)}function tde(){return this.each(ede)}function nde(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rde(){return this.each(nde)}function ide(t){var e=typeof t=="function"?t:FF(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function sde(){return null}function ode(t,e){var n=typeof t=="function"?t:FF(t),r=e==null?sde:typeof e=="function"?e:s4(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ade(){var t=this.parentNode;t&&t.removeChild(this)}function lde(){return this.each(ade)}function Ade(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ude(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function cde(t){return this.select(t?ude:Ade)}function hde(t){return arguments.length?this.property("__data__",t):this.node().__data__}var QF={};if(typeof document<"u"){var fde=document.documentElement;"onmouseenter"in fde||(QF={mouseenter:"mouseover",mouseleave:"mouseout"})}function dde(t,e,n){return t=qF(t,e,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&t.call(this,r)}}function qF(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function pde(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function gde(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.capture):e[++r]=s;++r?e.length=r:delete this.__on}}}function mde(t,e,n){var r=QF.hasOwnProperty(t.type)?dde:qF;return function(i,s,l){var o=this.__on,p,v=r(e,s,l);if(o){for(var S=0,M=o.length;S<M;++S)if((p=o[S]).type===t.type&&p.name===t.name){this.removeEventListener(p.type,p.listener,p.capture),this.addEventListener(p.type,p.listener=v,p.capture=n),p.value=e;return}}this.addEventListener(t.type,v,n),p={type:t.type,name:t.name,value:e,listener:v,capture:n},o?o.push(p):this.__on=[p]}}function yde(t,e,n){var r=pde(t+""),i,s=r.length,l;if(arguments.length<2){var o=this.node().__on;if(o){for(var p=0,v=o.length,S;p<v;++p)for(i=0,S=o[p];i<s;++i)if((l=r[i]).type===S.type&&l.name===S.name)return S.value}return}for(o=e?mde:gde,n==null&&(n=!1),i=0;i<s;++i)this.each(o(r[i],e,n));return this}function ZF(t,e,n){var r=GF(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function _de(t,e){return function(){return ZF(this,t,e)}}function vde(t,e){return function(){return ZF(this,t,e.apply(this,arguments))}}function xde(t,e){return this.each((typeof e=="function"?vde:_de)(t,e))}var wde=[null];function pA(t,e){this._groups=t,this._parents=e}function Nm(){return new pA([[document.documentElement]],wde)}pA.prototype=Nm.prototype={constructor:pA,select:o0e,selectAll:l0e,filter:A0e,data:d0e,enter:u0e,exit:p0e,join:g0e,merge:m0e,order:y0e,sort:_0e,call:x0e,nodes:w0e,node:b0e,size:E0e,empty:T0e,each:S0e,attr:D0e,style:O0e,property:V0e,classed:H0e,text:Z0e,html:J0e,raise:tde,lower:rde,append:ide,insert:ode,remove:lde,clone:cde,datum:hde,on:yde,dispatch:xde};function Um(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Ev(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Gf(){}var om=.7,_2=1/om,nd="\\s*([+-]?\\d+)\\s*",am="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",JA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bde=/^#([0-9a-f]{3,8})$/,Ede=new RegExp("^rgb\\("+[nd,nd,nd]+"\\)$"),Tde=new RegExp("^rgb\\("+[JA,JA,JA]+"\\)$"),Sde=new RegExp("^rgba\\("+[nd,nd,nd,am]+"\\)$"),Cde=new RegExp("^rgba\\("+[JA,JA,JA,am]+"\\)$"),Mde=new RegExp("^hsl\\("+[am,JA,JA]+"\\)$"),Pde=new RegExp("^hsla\\("+[am,JA,JA,am]+"\\)$"),W6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Um(Gf,wf,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Q6,formatHex:Q6,formatHsl:kde,formatRgb:q6,toString:q6});function Q6(){return this.rgb().formatHex()}function kde(){return XF(this).formatHsl()}function q6(){return this.rgb().formatRgb()}function wf(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=bde.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Z6(e):n===3?new Oo(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?uy(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?uy(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ede.exec(t))?new Oo(e[1],e[2],e[3],1):(e=Tde.exec(t))?new Oo(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Sde.exec(t))?uy(e[1],e[2],e[3],e[4]):(e=Cde.exec(t))?uy(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Mde.exec(t))?K6(e[1],e[2]/100,e[3]/100,1):(e=Pde.exec(t))?K6(e[1],e[2]/100,e[3]/100,e[4]):W6.hasOwnProperty(t)?Z6(W6[t]):t==="transparent"?new Oo(NaN,NaN,NaN,0):null}function Z6(t){return new Oo(t>>16&255,t>>8&255,t&255,1)}function uy(t,e,n,r){return r<=0&&(t=e=n=NaN),new Oo(t,e,n,r)}function YF(t){return t instanceof Gf||(t=wf(t)),t?(t=t.rgb(),new Oo(t.r,t.g,t.b,t.opacity)):new Oo}function CE(t,e,n,r){return arguments.length===1?YF(t):new Oo(t,e,n,r??1)}function Oo(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Um(Oo,CE,Ev(Gf,{brighter:function(t){return t=t==null?_2:Math.pow(_2,t),new Oo(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?om:Math.pow(om,t),new Oo(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Y6,formatHex:Y6,formatRgb:X6,toString:X6}));function Y6(){return"#"+ob(this.r)+ob(this.g)+ob(this.b)}function X6(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function ob(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function K6(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new HA(t,e,n,r)}function XF(t){if(t instanceof HA)return new HA(t.h,t.s,t.l,t.opacity);if(t instanceof Gf||(t=wf(t)),!t)return new HA;if(t instanceof HA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,p=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=p<.5?s+i:2-s-i,l*=60):o=p>0&&p<1?0:l,new HA(l,o,p,t.opacity)}function ME(t,e,n,r){return arguments.length===1?XF(t):new HA(t,e,n,r??1)}function HA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Um(HA,ME,Ev(Gf,{brighter:function(t){return t=t==null?_2:Math.pow(_2,t),new HA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?om:Math.pow(om,t),new HA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Oo(ab(t>=240?t-240:t+120,i,r),ab(t,i,r),ab(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function ab(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var Ide=Math.PI/180,Lde=180/Math.PI,v2=18,KF=.96422,JF=1,e7=.82521,t7=4/29,rd=6/29,n7=3*rd*rd,Dde=rd*rd*rd;function r7(t){if(t instanceof eu)return new eu(t.l,t.a,t.b,t.opacity);if(t instanceof Hu)return i7(t);t instanceof Oo||(t=YF(t));var e=cb(t.r),n=cb(t.g),r=cb(t.b),i=lb((.2225045*e+.7168786*n+.0606169*r)/JF),s,l;return e===n&&n===r?s=l=i:(s=lb((.4360747*e+.3850649*n+.1430804*r)/KF),l=lb((.0139322*e+.0971045*n+.7141733*r)/e7)),new eu(116*i-16,500*(s-i),200*(i-l),t.opacity)}function lm(t,e,n,r){return arguments.length===1?r7(t):new eu(t,e,n,r??1)}function eu(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}Um(eu,lm,Ev(Gf,{brighter:function(t){return new eu(this.l+v2*(t??1),this.a,this.b,this.opacity)},darker:function(t){return new eu(this.l-v2*(t??1),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=KF*Ab(e),t=JF*Ab(t),n=e7*Ab(n),new Oo(ub(3.1338561*e-1.6168667*t-.4906146*n),ub(-.9787684*e+1.9161415*t+.033454*n),ub(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function lb(t){return t>Dde?Math.pow(t,1/3):t/n7+t7}function Ab(t){return t>rd?t*t*t:n7*(t-t7)}function ub(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function cb(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Rde(t){if(t instanceof Hu)return new Hu(t.h,t.c,t.l,t.opacity);if(t instanceof eu||(t=r7(t)),t.a===0&&t.b===0)return new Hu(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Lde;return new Hu(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Bde(t,e,n,r){return arguments.length===1?Rde(t):new Hu(t,e,n,r??1)}function Hu(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function i7(t){if(isNaN(t.h))return new eu(t.l,0,0,t.opacity);var e=t.h*Ide;return new eu(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Um(Hu,Bde,Ev(Gf,{brighter:function(t){return new Hu(this.h,this.c,this.l+v2*(t??1),this.opacity)},darker:function(t){return new Hu(this.h,this.c,this.l-v2*(t??1),this.opacity)},rgb:function(){return i7(this).rgb()}}));function s7(t){return function(){return t}}function zde(t,e){return function(n){return t+n*e}}function Ode(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Fde(t){return(t=+t)==1?N0:function(e,n){return n-e?Ode(e,n,t):s7(isNaN(e)?n:e)}}function N0(t,e){var n=e-t;return n?zde(t,n):s7(isNaN(t)?e:t)}const J6=function t(e){var n=Fde(e);function r(i,s){var l=n((i=CE(i)).r,(s=CE(s)).r),o=n(i.g,s.g),p=n(i.b,s.b),v=N0(i.opacity,s.opacity);return function(S){return i.r=l(S),i.g=o(S),i.b=p(S),i.opacity=v(S),i+""}}return r.gamma=t,r}(1);function jc(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var PE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hb=new RegExp(PE.source,"g");function Nde(t){return function(){return t}}function Ude(t){return function(e){return t(e)+""}}function Vde(t,e){var n=PE.lastIndex=hb.lastIndex=0,r,i,s,l=-1,o=[],p=[];for(t=t+"",e=e+"";(r=PE.exec(t))&&(i=hb.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,p.push({i:l,x:jc(r,i)})),n=hb.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?p[0]?Ude(p[0].x):Nde(e):(e=p.length,function(v){for(var S=0,M;S<e;++S)o[(M=p[S]).i]=M.x(v);return o.join("")})}var e8=180/Math.PI,kE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function o7(t,e,n,r,i,s){var l,o,p;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(p=t*n+e*r)&&(n-=t*p,r-=e*p),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,p/=o),t*r<e*n&&(t=-t,e=-e,p=-p,l=-l),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*e8,skewX:Math.atan(p)*e8,scaleX:l,scaleY:o}}var Op,fb,t8,cy;function Gde(t){return t==="none"?kE:(Op||(Op=document.createElement("DIV"),fb=document.documentElement,t8=document.defaultView),Op.style.transform=t,t=t8.getComputedStyle(fb.appendChild(Op),null).getPropertyValue("transform"),fb.removeChild(Op),t=t.slice(7,-1).split(","),o7(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function $de(t){return t==null||(cy||(cy=document.createElementNS("http://www.w3.org/2000/svg","g")),cy.setAttribute("transform",t),!(t=cy.transform.baseVal.consolidate()))?kE:(t=t.matrix,o7(t.a,t.b,t.c,t.d,t.e,t.f))}function a7(t,e,n,r){function i(v){return v.length?v.pop()+" ":""}function s(v,S,M,k,F,H){if(v!==M||S!==k){var j=F.push("translate(",null,e,null,n);H.push({i:j-4,x:jc(v,M)},{i:j-2,x:jc(S,k)})}else(M||k)&&F.push("translate("+M+e+k+n)}function l(v,S,M,k){v!==S?(v-S>180?S+=360:S-v>180&&(v+=360),k.push({i:M.push(i(M)+"rotate(",null,r)-2,x:jc(v,S)})):S&&M.push(i(M)+"rotate("+S+r)}function o(v,S,M,k){v!==S?k.push({i:M.push(i(M)+"skewX(",null,r)-2,x:jc(v,S)}):S&&M.push(i(M)+"skewX("+S+r)}function p(v,S,M,k,F,H){if(v!==M||S!==k){var j=F.push(i(F)+"scale(",null,",",null,")");H.push({i:j-4,x:jc(v,M)},{i:j-2,x:jc(S,k)})}else(M!==1||k!==1)&&F.push(i(F)+"scale("+M+","+k+")")}return function(v,S){var M=[],k=[];return v=t(v),S=t(S),s(v.translateX,v.translateY,S.translateX,S.translateY,M,k),l(v.rotate,S.rotate,M,k),o(v.skewX,S.skewX,M,k),p(v.scaleX,v.scaleY,S.scaleX,S.scaleY,M,k),v=S=null,function(F){for(var H=-1,j=k.length,ie;++H<j;)M[(ie=k[H]).i]=ie.x(F);return M.join("")}}}var jde=a7(Gde,"px, ","px)","deg)"),Hde=a7($de,", ",")",")");function Wde(t,e){var n=N0((t=lm(t)).l,(e=lm(e)).l),r=N0(t.a,e.a),i=N0(t.b,e.b),s=N0(t.opacity,e.opacity);return function(l){return t.l=n(l),t.a=r(l),t.b=i(l),t.opacity=s(l),t+""}}var Cd=0,eg=0,Fp=0,l7=1e3,x2,tg,w2=0,bf=0,Tv=0,Am=typeof performance=="object"&&performance.now?performance:Date,A7=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Sv(){return bf||(A7(Qde),bf=Am.now()+Tv)}function Qde(){bf=0}function b2(){this._call=this._time=this._next=null}b2.prototype=u7.prototype={constructor:b2,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Sv():+n)+(e==null?0:+e),!this._next&&tg!==this&&(tg?tg._next=this:x2=this,tg=this),this._call=t,this._time=n,IE()},stop:function(){this._call&&(this._call=null,this._time=1/0,IE())}};function u7(t,e,n){var r=new b2;return r.restart(t,e,n),r}function qde(){Sv(),++Cd;for(var t=x2,e;t;)(e=bf-t._time)>=0&&t._call.call(null,e),t=t._next;--Cd}function n8(){bf=(w2=Am.now())+Tv,Cd=eg=0;try{qde()}finally{Cd=0,Yde(),bf=0}}function Zde(){var t=Am.now(),e=t-w2;e>l7&&(Tv-=e,w2=t)}function Yde(){for(var t,e=x2,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:x2=n);tg=t,IE(r)}function IE(t){if(!Cd){eg&&(eg=clearTimeout(eg));var e=t-bf;e>24?(t<1/0&&(eg=setTimeout(n8,t-Am.now()-Tv)),Fp&&(Fp=clearInterval(Fp))):(Fp||(w2=Am.now(),Fp=setInterval(Zde,l7)),Cd=1,A7(n8))}}function r8(t,e,n){var r=new b2;return e=e==null?0:+e,r.restart(function(i){r.stop(),t(i+e)},e,n),r}var Xde=OF("start","end","cancel","interrupt"),Kde=[],c7=0,i8=1,LE=2,Jy=3,s8=4,DE=5,e_=6;function Cv(t,e,n,r,i,s){var l=t.__transition;if(!l)t.__transition={};else if(n in l)return;Jde(t,n,{name:e,index:r,group:i,on:Xde,tween:Kde,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:c7})}function a4(t,e){var n=yA(t,e);if(n.state>c7)throw new Error("too late; already scheduled");return n}function pc(t,e){var n=yA(t,e);if(n.state>Jy)throw new Error("too late; already running");return n}function yA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Jde(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=u7(s,0,n.time);function s(v){n.state=i8,n.timer.restart(l,n.delay,n.time),n.delay<=v&&l(v-n.delay)}function l(v){var S,M,k,F;if(n.state!==i8)return p();for(S in r)if(F=r[S],F.name===n.name){if(F.state===Jy)return r8(l);F.state===s8?(F.state=e_,F.timer.stop(),F.on.call("interrupt",t,t.__data__,F.index,F.group),delete r[S]):+S<e&&(F.state=e_,F.timer.stop(),F.on.call("cancel",t,t.__data__,F.index,F.group),delete r[S])}if(r8(function(){n.state===Jy&&(n.state=s8,n.timer.restart(o,n.delay,n.time),o(v))}),n.state=LE,n.on.call("start",t,t.__data__,n.index,n.group),n.state===LE){for(n.state=Jy,i=new Array(k=n.tween.length),S=0,M=-1;S<k;++S)(F=n.tween[S].value.call(t,t.__data__,n.index,n.group))&&(i[++M]=F);i.length=M+1}}function o(v){for(var S=v<n.duration?n.ease.call(null,v/n.duration):(n.timer.restart(p),n.state=DE,1),M=-1,k=i.length;++M<k;)i[M].call(t,S);n.state===DE&&(n.on.call("end",t,t.__data__,n.index,n.group),p())}function p(){n.state=e_,n.timer.stop(),delete r[e];for(var v in r)return;delete t.__transition}}function epe(t,e){var n=t.__transition,r,i,s=!0,l;if(n){e=e==null?null:e+"";for(l in n){if((r=n[l]).name!==e){s=!1;continue}i=r.state>LE&&r.state<DE,r.state=e_,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[l]}s&&delete t.__transition}}function tpe(t){return this.each(function(){epe(this,t)})}function npe(t,e){var n,r;return function(){var i=pc(this,t),s=i.tween;if(s!==n){r=n=s;for(var l=0,o=r.length;l<o;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function rpe(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=pc(this,t),l=s.tween;if(l!==r){i=(r=l).slice();for(var o={name:e,value:n},p=0,v=i.length;p<v;++p)if(i[p].name===e){i[p]=o;break}p===v&&i.push(o)}s.tween=i}}function ipe(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=yA(this.node(),n).tween,i=0,s=r.length,l;i<s;++i)if((l=r[i]).name===t)return l.value;return null}return this.each((e==null?npe:rpe)(n,t,e))}function l4(t,e,n){var r=t._id;return t.each(function(){var i=pc(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return yA(i,r).value[e]}}function h7(t,e){var n;return(typeof e=="number"?jc:e instanceof wf?J6:(n=wf(e))?(e=n,J6):Vde)(t,e)}function spe(t){return function(){this.removeAttribute(t)}}function ope(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ape(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttribute(t);return l===i?null:l===r?s:s=e(r=l,n)}}function lpe(t,e,n){var r,i=n+"",s;return function(){var l=this.getAttributeNS(t.space,t.local);return l===i?null:l===r?s:s=e(r=l,n)}}function Ape(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttribute(t):(l=this.getAttribute(t),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function upe(t,e,n){var r,i,s;return function(){var l,o=n(this),p;return o==null?void this.removeAttributeNS(t.space,t.local):(l=this.getAttributeNS(t.space,t.local),p=o+"",l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o)))}}function cpe(t,e){var n=bv(t),r=n==="transform"?Hde:h7;return this.attrTween(t,typeof e=="function"?(n.local?upe:Ape)(n,r,l4(this,"attr."+t,e)):e==null?(n.local?ope:spe)(n):(n.local?lpe:ape)(n,r,e))}function hpe(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function fpe(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function dpe(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&fpe(t,s)),n}return i._value=e,i}function ppe(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&hpe(t,s)),n}return i._value=e,i}function gpe(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=bv(t);return this.tween(n,(r.local?dpe:ppe)(r,e))}function mpe(t,e){return function(){a4(this,t).delay=+e.apply(this,arguments)}}function ype(t,e){return e=+e,function(){a4(this,t).delay=e}}function _pe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?mpe:ype)(e,t)):yA(this.node(),e).delay}function vpe(t,e){return function(){pc(this,t).duration=+e.apply(this,arguments)}}function xpe(t,e){return e=+e,function(){pc(this,t).duration=e}}function wpe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?vpe:xpe)(e,t)):yA(this.node(),e).duration}function bpe(t,e){if(typeof e!="function")throw new Error;return function(){pc(this,t).ease=e}}function Epe(t){var e=this._id;return arguments.length?this.each(bpe(e,t)):yA(this.node(),e).ease}function Tpe(t){typeof t!="function"&&(t=UF(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],l=s.length,o=r[i]=[],p,v=0;v<l;++v)(p=s[v])&&t.call(p,p.__data__,v,s)&&o.push(p);return new cc(r,this._parents,this._name,this._id)}function Spe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),l=new Array(r),o=0;o<s;++o)for(var p=e[o],v=n[o],S=p.length,M=l[o]=new Array(S),k,F=0;F<S;++F)(k=p[F]||v[F])&&(M[F]=k);for(;o<r;++o)l[o]=e[o];return new cc(l,this._parents,this._name,this._id)}function Cpe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Mpe(t,e,n){var r,i,s=Cpe(e)?a4:pc;return function(){var l=s(this,t),o=l.on;o!==r&&(i=(r=o).copy()).on(e,n),l.on=i}}function Ppe(t,e){var n=this._id;return arguments.length<2?yA(this.node(),n).on.on(t):this.each(Mpe(n,t,e))}function kpe(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Ipe(){return this.on("end.remove",kpe(this._id))}function Lpe(t){var e=this._name,n=this._id;typeof t!="function"&&(t=s4(t));for(var r=this._groups,i=r.length,s=new Array(i),l=0;l<i;++l)for(var o=r[l],p=o.length,v=s[l]=new Array(p),S,M,k=0;k<p;++k)(S=o[k])&&(M=t.call(S,S.__data__,k,o))&&("__data__"in S&&(M.__data__=S.__data__),v[k]=M,Cv(v[k],e,n,k,v,yA(S,n)));return new cc(s,this._parents,e,n)}function Dpe(t){var e=this._name,n=this._id;typeof t!="function"&&(t=NF(t));for(var r=this._groups,i=r.length,s=[],l=[],o=0;o<i;++o)for(var p=r[o],v=p.length,S,M=0;M<v;++M)if(S=p[M]){for(var k=t.call(S,S.__data__,M,p),F,H=yA(S,n),j=0,ie=k.length;j<ie;++j)(F=k[j])&&Cv(F,e,n,j,k,H);s.push(k),l.push(S)}return new cc(s,l,e,n)}var Rpe=Nm.prototype.constructor;function Bpe(){return new Rpe(this._groups,this._parents)}function zpe(t,e){var n,r,i;return function(){var s=Sd(this,t),l=(this.style.removeProperty(t),Sd(this,t));return s===l?null:s===n&&l===r?i:i=e(n=s,r=l)}}function f7(t){return function(){this.style.removeProperty(t)}}function Ope(t,e,n){var r,i=n+"",s;return function(){var l=Sd(this,t);return l===i?null:l===r?s:s=e(r=l,n)}}function Fpe(t,e,n){var r,i,s;return function(){var l=Sd(this,t),o=n(this),p=o+"";return o==null&&(p=o=(this.style.removeProperty(t),Sd(this,t))),l===p?null:l===r&&p===i?s:(i=p,s=e(r=l,o))}}function Npe(t,e){var n,r,i,s="style."+e,l="end."+s,o;return function(){var p=pc(this,t),v=p.on,S=p.value[s]==null?o||(o=f7(e)):void 0;(v!==n||i!==S)&&(r=(n=v).copy()).on(l,i=S),p.on=r}}function Upe(t,e,n){var r=(t+="")=="transform"?jde:h7;return e==null?this.styleTween(t,zpe(t,r)).on("end.style."+t,f7(t)):typeof e=="function"?this.styleTween(t,Fpe(t,r,l4(this,"style."+t,e))).each(Npe(this._id,t)):this.styleTween(t,Ope(t,r,e),n).on("end.style."+t,null)}function Vpe(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Gpe(t,e,n){var r,i;function s(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&Vpe(t,l,n)),r}return s._value=e,s}function $pe(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Gpe(t,e,n??""))}function jpe(t){return function(){this.textContent=t}}function Hpe(t){return function(){var e=t(this);this.textContent=e??""}}function Wpe(t){return this.tween("text",typeof t=="function"?Hpe(l4(this,"text",t)):jpe(t==null?"":t+""))}function Qpe(t){return function(e){this.textContent=t.call(this,e)}}function qpe(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Qpe(i)),e}return r._value=t,r}function Zpe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,qpe(t))}function Ype(){for(var t=this._name,e=this._id,n=d7(),r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,v=0;v<o;++v)if(p=l[v]){var S=yA(p,e);Cv(p,t,n,v,l,{time:S.time+S.delay+S.duration,delay:0,duration:S.duration,ease:S.ease})}return new cc(r,this._parents,t,n)}function Xpe(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,l){var o={value:l},p={value:function(){--i===0&&s()}};n.each(function(){var v=pc(this,r),S=v.on;S!==t&&(e=(t=S).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(p)),v.on=e})})}var Kpe=0;function cc(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function d7(){return++Kpe}var h0=Nm.prototype;cc.prototype={constructor:cc,select:Lpe,selectAll:Dpe,filter:Tpe,merge:Spe,selection:Bpe,transition:Ype,call:h0.call,nodes:h0.nodes,node:h0.node,size:h0.size,empty:h0.empty,each:h0.each,on:Ppe,attr:cpe,attrTween:gpe,style:Upe,styleTween:$pe,text:Wpe,textTween:Zpe,remove:Ipe,tween:ipe,delay:_pe,duration:wpe,ease:Epe,end:Xpe};function Jpe(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var RE={time:null,delay:0,duration:250,ease:Jpe};function ege(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return RE.time=Sv(),RE;return n}function tge(t){var e,n;t instanceof cc?(e=t._id,t=t._name):(e=d7(),(n=RE).time=Sv(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],o=l.length,p,v=0;v<o;++v)(p=l[v])&&Cv(p,t,e,v,l,n||ege(p,e));return new cc(r,this._parents,t,e)}Nm.prototype.interrupt=tpe;Nm.prototype.transition=tge;var BE=Math.PI,zE=2*BE,Hh=1e-6,nge=zE-Hh;function OE(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function p7(){return new OE}OE.prototype=p7.prototype={constructor:OE,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var s=this._x1,l=this._y1,o=n-t,p=r-e,v=s-t,S=l-e,M=v*v+S*S;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(M>Hh)if(!(Math.abs(S*o-p*v)>Hh)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var k=n-s,F=r-l,H=o*o+p*p,j=k*k+F*F,ie=Math.sqrt(H),Y=Math.sqrt(M),J=i*Math.tan((BE-Math.acos((H+M-j)/(2*ie*Y)))/2),se=J/Y,ce=J/ie;Math.abs(se-1)>Hh&&(this._+="L"+(t+se*v)+","+(e+se*S)),this._+="A"+i+","+i+",0,0,"+ +(S*k>v*F)+","+(this._x1=t+ce*o)+","+(this._y1=e+ce*p)}},arc:function(t,e,n,r,i,s){t=+t,e=+e,n=+n,s=!!s;var l=n*Math.cos(r),o=n*Math.sin(r),p=t+l,v=e+o,S=1^s,M=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+p+","+v:(Math.abs(this._x1-p)>Hh||Math.abs(this._y1-v)>Hh)&&(this._+="L"+p+","+v),n&&(M<0&&(M=M%zE+zE),M>nge?this._+="A"+n+","+n+",0,1,"+S+","+(t-l)+","+(e-o)+"A"+n+","+n+",0,1,"+S+","+(this._x1=p)+","+(this._y1=v):M>Hh&&(this._+="A"+n+","+n+",0,"+ +(M>=BE)+","+S+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Al="$";function E2(){}E2.prototype=T2.prototype={constructor:E2,has:function(t){return Al+t in this},get:function(t){return this[Al+t]},set:function(t,e){return this[Al+t]=e,this},remove:function(t){var e=Al+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Al&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Al&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Al&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Al&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Al&&++t;return t},empty:function(){for(var t in this)if(t[0]===Al)return!1;return!0},each:function(t){for(var e in this)e[0]===Al&&t(this[e],e.slice(1),this)}};function T2(t,e){var n=new E2;if(t instanceof E2)t.each(function(o,p){n.set(p,o)});else if(Array.isArray(t)){var r=-1,i=t.length,s;if(e==null)for(;++r<i;)n.set(r,t[r]);else for(;++r<i;)n.set(e(s=t[r],r,t),s)}else if(t)for(var l in t)n.set(l,t[l]);return n}function o8(){}var Nh=T2.prototype;o8.prototype={constructor:o8,has:Nh.has,add:function(t){return t+="",this[Al+t]=t,this},remove:Nh.remove,clear:Nh.clear,values:Nh.keys,size:Nh.size,empty:Nh.empty,each:Nh.each};function rge(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function S2(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function ige(t){return t=S2(Math.abs(t)),t?t[1]:NaN}function sge(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],p=0;i>0&&o>0&&(p+o+1>r&&(o=Math.max(1,r-p)),s.push(n.substring(i-=o,i+o)),!((p+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function oge(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var age=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function FE(t){if(!(e=age.exec(t)))throw new Error("invalid format: "+t);var e;return new A4({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}FE.prototype=A4.prototype;function A4(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}A4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function lge(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var g7;function Age(t,e){var n=S2(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(g7=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+S2(t,Math.max(0,e+s-1))[0]}function a8(t,e){var n=S2(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const l8={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:rge,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return a8(t*100,e)},r:a8,s:Age,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function A8(t){return t}var u8=Array.prototype.map,c8=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function uge(t){var e=t.grouping===void 0||t.thousands===void 0?A8:sge(u8.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?A8:oge(u8.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function v(M){M=FE(M);var k=M.fill,F=M.align,H=M.sign,j=M.symbol,ie=M.zero,Y=M.width,J=M.comma,se=M.precision,ce=M.trim,me=M.type;me==="n"?(J=!0,me="g"):l8[me]||(se===void 0&&(se=12),ce=!0,me="g"),(ie||k==="0"&&F==="=")&&(ie=!0,k="0",F="=");var Ee=j==="$"?n:j==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",He=j==="$"?r:/[%p]/.test(me)?l:"",Qe=l8[me],Ye=/[defgprs%]/.test(me);se=se===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function nt(Fe){var tt=Ee,Ze=He,pt,Yt,Et;if(me==="c")Ze=Qe(Fe)+Ze,Fe="";else{Fe=+Fe;var un=Fe<0||1/Fe<0;if(Fe=isNaN(Fe)?p:Qe(Math.abs(Fe),se),ce&&(Fe=lge(Fe)),un&&+Fe==0&&H!=="+"&&(un=!1),tt=(un?H==="("?H:o:H==="-"||H==="("?"":H)+tt,Ze=(me==="s"?c8[8+g7/3]:"")+Ze+(un&&H==="("?")":""),Ye){for(pt=-1,Yt=Fe.length;++pt<Yt;)if(Et=Fe.charCodeAt(pt),48>Et||Et>57){Ze=(Et===46?i+Fe.slice(pt+1):Fe.slice(pt))+Ze,Fe=Fe.slice(0,pt);break}}}J&&!ie&&(Fe=e(Fe,1/0));var _t=tt.length+Fe.length+Ze.length,Tt=_t<Y?new Array(Y-_t+1).join(k):"";switch(J&&ie&&(Fe=e(Tt+Fe,Tt.length?Y-Ze.length:1/0),Tt=""),F){case"<":Fe=tt+Fe+Ze+Tt;break;case"=":Fe=tt+Tt+Fe+Ze;break;case"^":Fe=Tt.slice(0,_t=Tt.length>>1)+tt+Fe+Ze+Tt.slice(_t);break;default:Fe=Tt+tt+Fe+Ze;break}return s(Fe)}return nt.toString=function(){return M+""},nt}function S(M,k){var F=v((M=FE(M),M.type="f",M)),H=Math.max(-8,Math.min(8,Math.floor(ige(k)/3)))*3,j=Math.pow(10,-H),ie=c8[8+H/3];return function(Y){return F(j*Y)+ie}}return{format:v,formatPrefix:S}}var hy,Md;cge({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function cge(t){return hy=uge(t),Md=hy.format,hy.formatPrefix,hy}function Gd(){return Math.random()}(function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,arguments.length===1?(i=r,r=0):i-=r,function(){return e()*i+r}}return n.source=t,n})(Gd);const hge=function t(e){function n(r,i){var s,l;return r=r==null?0:+r,i=i==null?1:+i,function(){var o;if(s!=null)o=s,s=null;else do s=e()*2-1,o=e()*2-1,l=s*s+o*o;while(!l||l>1);return r+i*o*Math.sqrt(-2*Math.log(l)/l)}}return n.source=t,n}(Gd);(function t(e){function n(){var r=hge.source(e).apply(this,arguments);return function(){return Math.exp(r())}}return n.source=t,n})(Gd);const fge=function t(e){function n(r){return function(){for(var i=0,s=0;s<r;++s)i+=e();return i}}return n.source=t,n}(Gd);(function t(e){function n(r){var i=fge.source(e)(r);return function(){return i()/r}}return n.source=t,n})(Gd);(function t(e){function n(r){return function(){return-Math.log(1-e())/r}}return n.source=t,n})(Gd);function m7(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function dge(t){return t.length===1&&(t=pge(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function pge(t){return function(e,n){return m7(t(e),n)}}var gge=dge(m7),mge=gge.right;function yge(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var NE=Math.sqrt(50),UE=Math.sqrt(10),VE=Math.sqrt(2);function _ge(t,e,n){var r,i=-1,s,l,o;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(s=t,t=e,e=s),(o=t_(t,e,n))===0||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),l=new Array(s=Math.ceil(e-t+1));++i<s;)l[i]=(t+i)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),l=new Array(s=Math.ceil(t-e+1));++i<s;)l[i]=(t-i)/o;return r&&l.reverse(),l}function t_(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=NE?10:s>=UE?5:s>=VE?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=NE?10:s>=UE?5:s>=VE?2:1)}function vge(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=NE?i*=10:s>=UE?i*=5:s>=VE&&(i*=2),e<t?-i:i}function u4(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var y7=Array.prototype,xge=y7.map,GE=y7.slice,h8={name:"implicit"};function _7(){var t=T2(),e=[],n=[],r=h8;function i(s){var l=s+"",o=t.get(l);if(!o){if(r!==h8)return r;t.set(l,o=e.push(s))}return n[(o-1)%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=T2();for(var l=-1,o=s.length,p,v;++l<o;)t.has(v=(p=s[l])+"")||t.set(v,e.push(p));return i},i.range=function(s){return arguments.length?(n=GE.call(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return _7(e,n).unknown(r)},u4.apply(i,arguments),i}function v7(){var t=_7().unknown(void 0),e=t.domain,n=t.range,r=[0,1],i,s,l=!1,o=0,p=0,v=.5;delete t.unknown;function S(){var M=e().length,k=r[1]<r[0],F=r[k-0],H=r[1-k];i=(H-F)/Math.max(1,M-o+p*2),l&&(i=Math.floor(i)),F+=(H-F-i*(M-o))*v,s=i*(1-o),l&&(F=Math.round(F),s=Math.round(s));var j=yge(M).map(function(ie){return F+i*ie});return n(k?j.reverse():j)}return t.domain=function(M){return arguments.length?(e(M),S()):e()},t.range=function(M){return arguments.length?(r=[+M[0],+M[1]],S()):r.slice()},t.rangeRound=function(M){return r=[+M[0],+M[1]],l=!0,S()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(M){return arguments.length?(l=!!M,S()):l},t.padding=function(M){return arguments.length?(o=Math.min(1,p=+M),S()):o},t.paddingInner=function(M){return arguments.length?(o=Math.min(1,M),S()):o},t.paddingOuter=function(M){return arguments.length?(p=+M,S()):p},t.align=function(M){return arguments.length?(v=Math.max(0,Math.min(1,M)),S()):v},t.copy=function(){return v7(e(),r).round(l).paddingInner(o).paddingOuter(p).align(v)},u4.apply(S(),arguments)}function x7(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return x7(e())},t}function C2(){return x7(v7.apply(null,arguments).paddingInner(1))}function c4(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function w7(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Vm(){}var um=.7,M2=1/um,id="\\s*([+-]?\\d+)\\s*",cm="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",tu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wge=/^#([0-9a-f]{3,8})$/,bge=new RegExp("^rgb\\("+[id,id,id]+"\\)$"),Ege=new RegExp("^rgb\\("+[tu,tu,tu]+"\\)$"),Tge=new RegExp("^rgba\\("+[id,id,id,cm]+"\\)$"),Sge=new RegExp("^rgba\\("+[tu,tu,tu,cm]+"\\)$"),Cge=new RegExp("^hsl\\("+[cm,tu,tu]+"\\)$"),Mge=new RegExp("^hsla\\("+[cm,tu,tu,cm]+"\\)$"),f8={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};c4(Vm,hm,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:d8,formatHex:d8,formatHsl:Pge,formatRgb:p8,toString:p8});function d8(){return this.rgb().formatHex()}function Pge(){return b7(this).formatHsl()}function p8(){return this.rgb().formatRgb()}function hm(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=wge.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?g8(e):n===3?new Na(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?fy(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?fy(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=bge.exec(t))?new Na(e[1],e[2],e[3],1):(e=Ege.exec(t))?new Na(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Tge.exec(t))?fy(e[1],e[2],e[3],e[4]):(e=Sge.exec(t))?fy(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Cge.exec(t))?_8(e[1],e[2]/100,e[3]/100,1):(e=Mge.exec(t))?_8(e[1],e[2]/100,e[3]/100,e[4]):f8.hasOwnProperty(t)?g8(f8[t]):t==="transparent"?new Na(NaN,NaN,NaN,0):null}function g8(t){return new Na(t>>16&255,t>>8&255,t&255,1)}function fy(t,e,n,r){return r<=0&&(t=e=n=NaN),new Na(t,e,n,r)}function kge(t){return t instanceof Vm||(t=hm(t)),t?(t=t.rgb(),new Na(t.r,t.g,t.b,t.opacity)):new Na}function $E(t,e,n,r){return arguments.length===1?kge(t):new Na(t,e,n,r??1)}function Na(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}c4(Na,$E,w7(Vm,{brighter:function(t){return t=t==null?M2:Math.pow(M2,t),new Na(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?um:Math.pow(um,t),new Na(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:m8,formatHex:m8,formatRgb:y8,toString:y8}));function m8(){return"#"+db(this.r)+db(this.g)+db(this.b)}function y8(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function db(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function _8(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new WA(t,e,n,r)}function b7(t){if(t instanceof WA)return new WA(t.h,t.s,t.l,t.opacity);if(t instanceof Vm||(t=hm(t)),!t)return new WA;if(t instanceof WA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,p=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=p<.5?s+i:2-s-i,l*=60):o=p>0&&p<1?0:l,new WA(l,o,p,t.opacity)}function Ige(t,e,n,r){return arguments.length===1?b7(t):new WA(t,e,n,r??1)}function WA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}c4(WA,Ige,w7(Vm,{brighter:function(t){return t=t==null?M2:Math.pow(M2,t),new WA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?um:Math.pow(um,t),new WA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Na(pb(t>=240?t-240:t+120,i,r),pb(t,i,r),pb(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function pb(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function h4(t){return function(){return t}}function Lge(t,e){return function(n){return t+n*e}}function Dge(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Rge(t){return(t=+t)==1?E7:function(e,n){return n-e?Dge(e,n,t):h4(isNaN(e)?n:e)}}function E7(t,e){var n=e-t;return n?Lge(t,n):h4(isNaN(t)?e:t)}const v8=function t(e){var n=Rge(e);function r(i,s){var l=n((i=$E(i)).r,(s=$E(s)).r),o=n(i.g,s.g),p=n(i.b,s.b),v=E7(i.opacity,s.opacity);return function(S){return i.r=l(S),i.g=o(S),i.b=p(S),i.opacity=v(S),i+""}}return r.gamma=t,r}(1);function Bge(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function zge(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Oge(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),l;for(l=0;l<r;++l)i[l]=f4(t[l],e[l]);for(;l<n;++l)s[l]=e[l];return function(o){for(l=0;l<r;++l)s[l]=i[l](o);return s}}function Fge(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function P2(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Nge(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=f4(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var jE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gb=new RegExp(jE.source,"g");function Uge(t){return function(){return t}}function Vge(t){return function(e){return t(e)+""}}function Gge(t,e){var n=jE.lastIndex=gb.lastIndex=0,r,i,s,l=-1,o=[],p=[];for(t=t+"",e=e+"";(r=jE.exec(t))&&(i=gb.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,p.push({i:l,x:P2(r,i)})),n=gb.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?p[0]?Vge(p[0].x):Uge(e):(e=p.length,function(v){for(var S=0,M;S<e;++S)o[(M=p[S]).i]=M.x(v);return o.join("")})}function f4(t,e){var n=typeof e,r;return e==null||n==="boolean"?h4(e):(n==="number"?P2:n==="string"?(r=hm(e))?(e=r,v8):Gge:e instanceof hm?v8:e instanceof Date?Fge:zge(e)?Bge:Array.isArray(e)?Oge:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Nge:P2)(t,e)}function $ge(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function jge(t){return function(){return t}}function Hge(t){return+t}var x8=[0,1];function U0(t){return t}function HE(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:jge(isNaN(e)?NaN:.5)}function w8(t){var e=t[0],n=t[t.length-1],r;return e>n&&(r=e,e=n,n=r),function(i){return Math.max(e,Math.min(n,i))}}function Wge(t,e,n){var r=t[0],i=t[1],s=e[0],l=e[1];return i<r?(r=HE(i,r),s=n(l,s)):(r=HE(r,i),s=n(s,l)),function(o){return s(r(o))}}function Qge(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=HE(t[l],t[l+1]),s[l]=n(e[l],e[l+1]);return function(o){var p=mge(t,o,1,r)-1;return s[p](i[p](o))}}function qge(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Zge(){var t=x8,e=x8,n=f4,r,i,s,l=U0,o,p,v;function S(){return o=Math.min(t.length,e.length)>2?Qge:Wge,p=v=null,M}function M(k){return isNaN(k=+k)?s:(p||(p=o(t.map(r),e,n)))(r(l(k)))}return M.invert=function(k){return l(i((v||(v=o(e,t.map(r),P2)))(k)))},M.domain=function(k){return arguments.length?(t=xge.call(k,Hge),l===U0||(l=w8(t)),S()):t.slice()},M.range=function(k){return arguments.length?(e=GE.call(k),S()):e.slice()},M.rangeRound=function(k){return e=GE.call(k),n=$ge,S()},M.clamp=function(k){return arguments.length?(l=k?w8(t):U0,M):l!==U0},M.interpolate=function(k){return arguments.length?(n=k,S()):n},M.unknown=function(k){return arguments.length?(s=k,M):s},function(k,F){return r=k,i=F,S()}}function Yge(t,e){return Zge()(t,e)}function Xge(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function k2(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Pd(t){return t=k2(Math.abs(t)),t?t[1]:NaN}function Kge(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],p=0;i>0&&o>0&&(p+o+1>r&&(o=Math.max(1,r-p)),s.push(n.substring(i-=o,i+o)),!((p+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function Jge(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var eme=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function I2(t){if(!(e=eme.exec(t)))throw new Error("invalid format: "+t);var e;return new d4({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}I2.prototype=d4.prototype;function d4(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}d4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function tme(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var T7;function nme(t,e){var n=k2(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(T7=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+k2(t,Math.max(0,e+s-1))[0]}function b8(t,e){var n=k2(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const E8={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Xge,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return b8(t*100,e)},r:b8,s:nme,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function T8(t){return t}var S8=Array.prototype.map,C8=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function rme(t){var e=t.grouping===void 0||t.thousands===void 0?T8:Kge(S8.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?T8:Jge(S8.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",p=t.nan===void 0?"NaN":t.nan+"";function v(M){M=I2(M);var k=M.fill,F=M.align,H=M.sign,j=M.symbol,ie=M.zero,Y=M.width,J=M.comma,se=M.precision,ce=M.trim,me=M.type;me==="n"?(J=!0,me="g"):E8[me]||(se===void 0&&(se=12),ce=!0,me="g"),(ie||k==="0"&&F==="=")&&(ie=!0,k="0",F="=");var Ee=j==="$"?n:j==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",He=j==="$"?r:/[%p]/.test(me)?l:"",Qe=E8[me],Ye=/[defgprs%]/.test(me);se=se===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function nt(Fe){var tt=Ee,Ze=He,pt,Yt,Et;if(me==="c")Ze=Qe(Fe)+Ze,Fe="";else{Fe=+Fe;var un=Fe<0||1/Fe<0;if(Fe=isNaN(Fe)?p:Qe(Math.abs(Fe),se),ce&&(Fe=tme(Fe)),un&&+Fe==0&&H!=="+"&&(un=!1),tt=(un?H==="("?H:o:H==="-"||H==="("?"":H)+tt,Ze=(me==="s"?C8[8+T7/3]:"")+Ze+(un&&H==="("?")":""),Ye){for(pt=-1,Yt=Fe.length;++pt<Yt;)if(Et=Fe.charCodeAt(pt),48>Et||Et>57){Ze=(Et===46?i+Fe.slice(pt+1):Fe.slice(pt))+Ze,Fe=Fe.slice(0,pt);break}}}J&&!ie&&(Fe=e(Fe,1/0));var _t=tt.length+Fe.length+Ze.length,Tt=_t<Y?new Array(Y-_t+1).join(k):"";switch(J&&ie&&(Fe=e(Tt+Fe,Tt.length?Y-Ze.length:1/0),Tt=""),F){case"<":Fe=tt+Fe+Ze+Tt;break;case"=":Fe=tt+Tt+Fe+Ze;break;case"^":Fe=Tt.slice(0,_t=Tt.length>>1)+tt+Fe+Ze+Tt.slice(_t);break;default:Fe=Tt+tt+Fe+Ze;break}return s(Fe)}return nt.toString=function(){return M+""},nt}function S(M,k){var F=v((M=I2(M),M.type="f",M)),H=Math.max(-8,Math.min(8,Math.floor(Pd(k)/3)))*3,j=Math.pow(10,-H),ie=C8[8+H/3];return function(Y){return F(j*Y)+ie}}return{format:v,formatPrefix:S}}var dy,S7,C7;ime({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function ime(t){return dy=rme(t),S7=dy.format,C7=dy.formatPrefix,dy}function sme(t){return Math.max(0,-Pd(Math.abs(t)))}function ome(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Pd(e)/3)))*3-Pd(Math.abs(t)))}function ame(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Pd(e)-Pd(t))+1}function lme(t,e,n,r){var i=vge(t,e,n),s;switch(r=I2(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=ome(i,l))&&(r.precision=s),C7(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=ame(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=sme(i))&&(r.precision=s-(r.type==="%")*2);break}}return S7(r)}function Ame(t){var e=t.domain;return t.ticks=function(n){var r=e();return _ge(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return lme(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,l=r[i],o=r[s],p;return o<l&&(p=l,l=o,o=p,p=i,i=s,s=p),p=t_(l,o,n),p>0?(l=Math.floor(l/p)*p,o=Math.ceil(o/p)*p,p=t_(l,o,n)):p<0&&(l=Math.ceil(l*p)/p,o=Math.floor(o*p)/p,p=t_(l,o,n)),p>0?(r[i]=Math.floor(l/p)*p,r[s]=Math.ceil(o/p)*p,e(r)):p<0&&(r[i]=Math.ceil(l*p)/p,r[s]=Math.floor(o*p)/p,e(r)),t},t}function lA(){var t=Yge(U0,U0);return t.copy=function(){return qge(t,lA())},u4.apply(t,arguments),Ame(t)}function Mv(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}function Pv(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const ume=Pv(Mv("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));Pv(Mv("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));Pv(Mv("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));Pv(Mv("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Vc(t){return function(){return t}}var M8=Math.abs,ao=Math.atan2,Uh=Math.cos,cme=Math.max,mb=Math.min,FA=Math.sin,V0=Math.sqrt,na=1e-12,fm=Math.PI,L2=fm/2,hme=2*fm;function fme(t){return t>1?0:t<-1?fm:Math.acos(t)}function P8(t){return t>=1?L2:t<=-1?-L2:Math.asin(t)}function dme(t){return t.innerRadius}function pme(t){return t.outerRadius}function gme(t){return t.startAngle}function mme(t){return t.endAngle}function yme(t){return t&&t.padAngle}function _me(t,e,n,r,i,s,l,o){var p=n-t,v=r-e,S=l-i,M=o-s,k=M*p-S*v;if(!(k*k<na))return k=(S*(e-s)-M*(t-i))/k,[t+k*p,e+k*v]}function py(t,e,n,r,i,s,l){var o=t-n,p=e-r,v=(l?s:-s)/V0(o*o+p*p),S=v*p,M=-v*o,k=t+S,F=e+M,H=n+S,j=r+M,ie=(k+H)/2,Y=(F+j)/2,J=H-k,se=j-F,ce=J*J+se*se,me=i-s,Ee=k*j-H*F,He=(se<0?-1:1)*V0(cme(0,me*me*ce-Ee*Ee)),Qe=(Ee*se-J*He)/ce,Ye=(-Ee*J-se*He)/ce,nt=(Ee*se+J*He)/ce,Fe=(-Ee*J+se*He)/ce,tt=Qe-ie,Ze=Ye-Y,pt=nt-ie,Yt=Fe-Y;return tt*tt+Ze*Ze>pt*pt+Yt*Yt&&(Qe=nt,Ye=Fe),{cx:Qe,cy:Ye,x01:-S,y01:-M,x11:Qe*(i/me-1),y11:Ye*(i/me-1)}}function M7(){var t=dme,e=pme,n=Vc(0),r=null,i=gme,s=mme,l=yme,o=null;function p(){var v,S,M=+t.apply(this,arguments),k=+e.apply(this,arguments),F=i.apply(this,arguments)-L2,H=s.apply(this,arguments)-L2,j=M8(H-F),ie=H>F;if(o||(o=v=p7()),k<M&&(S=k,k=M,M=S),!(k>na))o.moveTo(0,0);else if(j>hme-na)o.moveTo(k*Uh(F),k*FA(F)),o.arc(0,0,k,F,H,!ie),M>na&&(o.moveTo(M*Uh(H),M*FA(H)),o.arc(0,0,M,H,F,ie));else{var Y=F,J=H,se=F,ce=H,me=j,Ee=j,He=l.apply(this,arguments)/2,Qe=He>na&&(r?+r.apply(this,arguments):V0(M*M+k*k)),Ye=mb(M8(k-M)/2,+n.apply(this,arguments)),nt=Ye,Fe=Ye,tt,Ze;if(Qe>na){var pt=P8(Qe/M*FA(He)),Yt=P8(Qe/k*FA(He));(me-=pt*2)>na?(pt*=ie?1:-1,se+=pt,ce-=pt):(me=0,se=ce=(F+H)/2),(Ee-=Yt*2)>na?(Yt*=ie?1:-1,Y+=Yt,J-=Yt):(Ee=0,Y=J=(F+H)/2)}var Et=k*Uh(Y),un=k*FA(Y),_t=M*Uh(ce),Tt=M*FA(ce);if(Ye>na){var Jt=k*Uh(J),In=k*FA(J),Tn=M*Uh(se),kr=M*FA(se),er;if(j<fm&&(er=_me(Et,un,Tn,kr,Jt,In,_t,Tt))){var or=Et-er[0],hr=un-er[1],Un=Jt-er[0],Cr=In-er[1],wt=1/FA(fme((or*Un+hr*Cr)/(V0(or*or+hr*hr)*V0(Un*Un+Cr*Cr)))/2),rn=V0(er[0]*er[0]+er[1]*er[1]);nt=mb(Ye,(M-rn)/(wt-1)),Fe=mb(Ye,(k-rn)/(wt+1))}}Ee>na?Fe>na?(tt=py(Tn,kr,Et,un,k,Fe,ie),Ze=py(Jt,In,_t,Tt,k,Fe,ie),o.moveTo(tt.cx+tt.x01,tt.cy+tt.y01),Fe<Ye?o.arc(tt.cx,tt.cy,Fe,ao(tt.y01,tt.x01),ao(Ze.y01,Ze.x01),!ie):(o.arc(tt.cx,tt.cy,Fe,ao(tt.y01,tt.x01),ao(tt.y11,tt.x11),!ie),o.arc(0,0,k,ao(tt.cy+tt.y11,tt.cx+tt.x11),ao(Ze.cy+Ze.y11,Ze.cx+Ze.x11),!ie),o.arc(Ze.cx,Ze.cy,Fe,ao(Ze.y11,Ze.x11),ao(Ze.y01,Ze.x01),!ie))):(o.moveTo(Et,un),o.arc(0,0,k,Y,J,!ie)):o.moveTo(Et,un),!(M>na)||!(me>na)?o.lineTo(_t,Tt):nt>na?(tt=py(_t,Tt,Jt,In,M,-nt,ie),Ze=py(Et,un,Tn,kr,M,-nt,ie),o.lineTo(tt.cx+tt.x01,tt.cy+tt.y01),nt<Ye?o.arc(tt.cx,tt.cy,nt,ao(tt.y01,tt.x01),ao(Ze.y01,Ze.x01),!ie):(o.arc(tt.cx,tt.cy,nt,ao(tt.y01,tt.x01),ao(tt.y11,tt.x11),!ie),o.arc(0,0,M,ao(tt.cy+tt.y11,tt.cx+tt.x11),ao(Ze.cy+Ze.y11,Ze.cx+Ze.x11),ie),o.arc(Ze.cx,Ze.cy,nt,ao(Ze.y11,Ze.x11),ao(Ze.y01,Ze.x01),!ie))):o.arc(0,0,M,ce,se,ie)}if(o.closePath(),v)return o=null,v+""||null}return p.centroid=function(){var v=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,S=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-fm/2;return[Uh(S)*v,FA(S)*v]},p.innerRadius=function(v){return arguments.length?(t=typeof v=="function"?v:Vc(+v),p):t},p.outerRadius=function(v){return arguments.length?(e=typeof v=="function"?v:Vc(+v),p):e},p.cornerRadius=function(v){return arguments.length?(n=typeof v=="function"?v:Vc(+v),p):n},p.padRadius=function(v){return arguments.length?(r=v==null?null:typeof v=="function"?v:Vc(+v),p):r},p.startAngle=function(v){return arguments.length?(i=typeof v=="function"?v:Vc(+v),p):i},p.endAngle=function(v){return arguments.length?(s=typeof v=="function"?v:Vc(+v),p):s},p.padAngle=function(v){return arguments.length?(l=typeof v=="function"?v:Vc(+v),p):l},p.context=function(v){return arguments.length?(o=v??null,p):o},p}function ng(t,e,n){this.k=t,this.x=e,this.y=n}ng.prototype={constructor:ng,scale:function(t){return t===1?this:new ng(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ng(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};ng.prototype;function P7(t,e,n,r,i,s){var l=i||0,o=s||0,p=n||0,v=e||function(){return"#fff"},S=r,M;function k(F){k.el=F,k.setProperties()}return k.setProperties=function(){this.el&&(k.svgGroup||(k.svgGroup=k.el.append("g")),k.svgGroup.attr("transform","translate("+l+","+o+")"),k.svgGroup.selectAll("g").data(t).enter().append("g").selectAll("rect").data(function(F,H){return F.map(function(j){return{r:H,v:j}})}).enter().append("rect").datum(function(F,H){return F.c=H,F}),k.svgGroup.selectAll("g").selectAll("rect").attr("x",function(F){return p/t[F.r].length*F.c}).attr("y",function(F){return F.r*M}).attr("width",function(F){return p/t[F.r].length}).attr("height",M).attr("fill",function(F){return v(F.v)}),S&&k.svgGroup.attr("id",S))},k.data=function(F){return arguments.length?(t=F,M=p/t.length,k.setProperties(),k):t},k.x=function(F){return arguments.length?(l=F,k.setProperties(),k):l},k.y=function(F){return arguments.length?(o=F,k.setProperties(),k):o},k.size=function(F){return arguments.length?(p=F,t&&(M=p/t.length,k.setProperties()),k):p},k.scale=function(F){return arguments.length?(v=F,t&&k.setProperties(),k):v},k.id=function(F){return arguments.length?(S=F,k.setProperties(),k):S},k}function vme(t,e,n,r,i,s){var l=P7(t,e,n,r,i,s);function o(p,v,S,M){var k=lA().domain([0,M]).range([-Math.PI/6,Math.PI/6]),F=lA().domain([0,S]).range([v,0]),H=M7().innerRadius(F(p.r+1)).outerRadius(F(p.r)).startAngle(k(p.c)).endAngle(k(p.c+1));return H()}return l.setProperties=function(){var p=l.data(),v=l.size(),S=l.scale(),M=l.id(),k=l.x(),F=l.y();l.el&&(l.svgGroup||(l.svgGroup=l.el.append("g")),l.svgGroup.attr("transform","translate("+k+","+F+")"),l.svgGroup.selectAll("g").data(p).enter().append("g").selectAll("path").data(function(H,j){return H.map(function(ie){return{r:j,v:ie}})}).enter().append("path").datum(function(H,j){return H.c=j,H}),l.svgGroup.selectAll("g").selectAll("path").attr("transform","translate("+v/2+","+v+")").attr("d",function(H){return o(H,v,p.length,p[H.r].length)}).attr("fill",function(H){return S(H.v)}),M&&l.svgGroup.attr("id",M))},l}var xme=1e-9;function wme(t,e){var n=t||2,r=e||2,i=lA(),s=lA(),l=p();function o(v,S){for(var M=S??v.u,k=S!=null?v:v.v,F=0;F<l.length-1&&i(M)<1-(F+1)/r-xme;)F++;for(var H=l[F].length>1?(l[F][1].v-l[F][0].v)/2:0,j=0;j<l[F].length-1&&k>l[F][j].v+H;)j++;return l[F][j]}function p(){var v=[],S;s.nice(Math.pow(n,r-1)),i.nice(r),v[0]=[],v[0].push({u:i.invert((r-1)/r),v:s.invert(.5)});for(var M=1;M<r;M++){v[M]=[],S=2*Math.pow(n,M);for(var k=1;k<S;k+=2)v[M].push({u:i.invert(1-(M+1)/r),v:s.invert(k/S)})}return v}return o.range=function(){return[].concat.apply([],l)},o.tree=function(){return l},o.data=o.tree,o.branching=function(v){return arguments.length?(n=Math.max(1,v),l=p(),o):n},o.layers=function(v){return arguments.length?(r=Math.max(1,v),l=p(),o):r},o.uncertaintyDomain=function(v){return arguments.length?(i.domain(v),l=p(),o):i.domain()},o.valueDomain=function(v){return arguments.length?(s.domain(v),l=p(),o):s.domain()},o}function bme(t,e,n){var r=e||ume,i=n||function(p,v){var S=v!=null?{v:p,u:v}:{v:p.v,u:p.u};return S},s=t;function l(p,v){var S=lm(wf(p)),M=lm(wf(v));return Math.sqrt(Math.pow(S.l-M.l,2)+Math.pow(S.a-M.a,2)+Math.pow(S.b-M.b,2))}function o(p,v){var S=i(p,v),M=[0,1],k=[0,1];i.uncertaintyDomain&&(M=i.uncertaintyDomain()),i.valueDomain&&(k=i.valueDomain());var F=lA().domain(M).range([0,1]),H=lA().domain(k).range([0,1]),j=r(H(S.v));switch(s){case"usl":default:j=Wde(j,"#fff")(F(S.u));break;case"us":j=ME(j);var ie=lA().domain([0,1]).range([j.s,0]);j.s=ie(F(S.u));break;case"ul":j=ME(j);var Y=lA().domain([0,1]).range([j.l,1]);j.l=Y(F(S.u));break}return j}return o.colorList=function(){return this.quantize().range().map(function(p){return o(p)})},o.colorDists=function(){for(var p=this.colorList(),v=new Array(p.length),S,M=new Array(2),k,F=0;F<v.length;F++){v[F]=new Array(p.length);for(var H=0;H<v[F].length;H++)k=l(p[F],p[H]),v[F][H]=k,F!=H&&(F==0&&H==1||k<S)&&(S=k,M=[p[F],p[H]])}return v.minDist=S,v.minPair=M,v},o.mode=function(p){return arguments.length?(s=p,o):s},o.range=function(p){return arguments.length?(r=p,o):r},o.quantize=function(p){return arguments.length?(i=p,o):i},o}function Eme(t,e,n,r,i,s,l){var o=null,p=i,v=t||null,S=e||200,M=n||30,k=r||null,F=s||0,H=l||0;function j(ie){o=ie,j.setProperties()}return j.setProperties=function(){if(o){var ie=v.domain?v.domain():[0,1],Y=S/v.range().length,J=(ie[1]-ie[0])/v.range().length,se=sm(ie[0],ie[1]+J,J),ce=C2().range([0,S]).domain(se).round(!0);o.attr("class","legend").attr("transform","translate("+F+","+H+")");var me=o.selectAll("rect").data(v.range());me.enter().append("rect").merge(me).attr("x",function(Qe,Ye){return Ye*Y}).attr("y",0).attr("height",M).attr("width",Y).attr("fill",function(Qe){return Qe});var Ee=o.select("g.legend > g");Ee.empty()&&(Ee=o.append("g")),Ee.attr("transform","translate(0, "+M+")").call(Jfe(ce).tickFormat(Md(k||"")));var He=o.select("g.legend > text");He.empty()&&(He=o.append("text")),He.style("text-anchor","middle").style("font-size",13).attr("transform","translate("+S/2+", "+(M+30)+")").text(p)}},j.title=function(ie){return arguments.length?(p=ie,j.setProperties(),j):p},j.scale=function(ie){return arguments.length?(v=ie,j.setProperties(),j):v},j.size=function(ie){return arguments.length?(S=ie,j.setProperties(),j):S},j.height=function(ie){return arguments.length?(M=ie,j.setProperties(),j):M},j.format=function(ie){return arguments.length?(k=ie,j.setProperties(),j):k},j.x=function(ie){return arguments.length?(F=ie,j.setProperties(),j):F},j.y=function(ie){return arguments.length?(H=ie,j.setProperties(),j):H},j}function Tme(t,e,n,r,i,s,l){var o=null,p=r||"Uncertainty",v=i||"Value",S=t||null,M=e||200,k=n||null,F=s||0,H=l||0,j=null,ie=P7(),Y=function(J){o=J,Y.setProperties(),o.call(ie)};return Y.setProperties=function(){if(o){var J=j;J||(J=S.quantize().data());for(var se=[],ce=0;ce<J.length;ce++)se[ce]=J[J.length-ce-1];ie.y(1),ie.data(se),ie.scale(S),ie.size(M),o.attr("class","legend").attr("transform","translate("+F+","+H+")");var me=S&&S.quantize?S.quantize().uncertaintyDomain():[0,1],Ee=(me[1]-me[0])/se.length,He=sm(me[0],me[1]+Ee,Ee),Qe=S&&S.quantize?S.quantize().valueDomain():[0,1],Ye=(Qe[1]-Qe[0])/se.length,nt=sm(Qe[0],Qe[1]+Ye,Ye),Fe=C2().range([0,M]).domain(nt);o.append("g").call(Kfe(Fe).tickFormat(Md(k||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+M/2+", -25)").text(v);var tt=C2().range([0,M]).domain(He);o.append("g").attr("transform","translate("+M+", 0)").call(zF(tt).tickFormat(Md(k||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(M+40)+", "+M/2+")rotate(90)").text(p)}},Y.data=function(J){return arguments.length?(j=J,Y.setProperties(),Y):j},Y.scale=function(J){return arguments.length?(S=J,Y.setProperties(),Y):S},Y.size=function(J){return arguments.length?(M=J,Y.setProperties(),Y):M},Y.format=function(J){return arguments.length?(k=J,Y.setProperties(),Y):k},Y.x=function(J){return arguments.length?(F=J,Y.setProperties(),Y):F},Y.y=function(J){return arguments.length?(H=J,Y.setProperties(),Y):H},Y.utitle=function(J){return arguments.length?(p=J,Y.setProperties(),Y):p},Y.vtitle=function(J){return arguments.length?(v=J,Y.setProperties(),Y):v},Y}function Sme(t,e,n,r,i,s,l){var o=null,p=r||"Uncertainty",v=i||"Value",S=t||null,M=e||200,k=n||null,F=s||0,H=l||0,j=null,ie=vme(),Y=function(J){o=J,Y.setProperties(),o.call(ie)};return Y.setProperties=function(){if(o){var J=j;J||(J=S.quantize().data());for(var se=[],ce=0;ce<J.length;ce++)se[ce]=J[J.length-ce-1];ie.data(se),ie.scale(S),ie.size(M),o.attr("class","legend").attr("transform","translate("+F+","+H+")");var me=S&&S.quantize?S.quantize().uncertaintyDomain():[0,1],Ee=(me[1]-me[0])/se.length,He=sm(me[0],me[1]+Ee,Ee),Qe=C2().range([0,M]).domain(He),Ye=M/180;o.append("g").attr("transform","translate("+(M+6*Ye)+","+28*Ye+")rotate(30)").call(zF(Qe).tickFormat(Md(k||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(M+10*Ye)+","+(40*Ye+M/2)+")rotate(-60)").text(p);var nt=S&&S.quantize?S.quantize().valueDomain():[0,1],Fe=(nt[1]-nt[0])/se[0].length,tt=sm(nt[0],nt[1]+Fe,Fe),Ze=lA().range([0,M]).domain(nt),pt=k?Md(k):Ze.tickFormat(tt.length),Yt=lA().domain(nt).range([-30,30]),Et=3*Ye,un=M7().innerRadius(M+Et).outerRadius(M+Et+1).startAngle(-Math.PI/6).endAngle(Math.PI/6),_t=o.append("g").attr("transform","translate("+M/2+","+(M-Et)+")");_t.append("path").attr("fill","black").attr("stroke","transparent").attr("d",un);var Tt=_t.selectAll(".arc-label").data(tt).enter().append("g").attr("class","arc-label").attr("transform",function(Jt){return"rotate("+Yt(Jt)+")translate(0,"+(-M-Et)+")"});Tt.append("text").style("font-size","11").style("text-anchor","middle").attr("y",-10).text(pt),Tt.append("line").attr("x1",.5).attr("x2",.5).attr("y1",-6).attr("y2",0).attr("stroke","#000"),o.append("text").style("text-anchor","middle").style("font-size",13).attr("x",M/2).attr("y",-30).text(v)}},Y.data=function(J){return arguments.length?(j=J,Y.setProperties(),Y):j},Y.scale=function(J){return arguments.length?(S=J,Y.setProperties(),Y):S},Y.size=function(J){return arguments.length?(M=J,Y.setProperties(),Y):M},Y.format=function(J){return arguments.length?(k=J,Y.setProperties(),Y):k},Y.x=function(J){return arguments.length?(F=J,Y.setProperties(),Y):F},Y.y=function(J){return arguments.length?(H=J,Y.setProperties(),Y):H},Y.utitle=function(J){return arguments.length?(p=J,Y.setProperties(),Y):p},Y.vtitle=function(J){return arguments.length?(v=J,Y.setProperties(),Y):v},Y}const Cme=Object.freeze(Object.defineProperty({__proto__:null,arcmapLegend:Sme,heatmapLegend:Tme,simpleLegend:Eme},Symbol.toStringTag,{value:"Module"}));var nu=Cme;function k7(t,e){return t+e}function oa(t,e=1,n=1){if(typeof t=="function")return l=>oa(t(l),e,n);Array.isArray(t)&&(t=uf(...t).toString());const{l:r,c:i,h:s}=BM(t);return BM(r+18*n,i+18*e,s).toString()}function I7(t,e,n){let r={};return n||(n=[]),Object.keys(t).forEach(i=>{if(n.includes(i))return;let s=t[i],l={};Object.keys(s).forEach(o=>{e(s[o])&&(l[o]=s[o])}),r[i]=l}),r}function Mme(t,e){return t.reduce(function(n,r){return n[e(r)]=r,n},{})}const kv=t=>!!(t.properties||{}).id,kd=t=>!kv(t),k8=t=>t.toLocaleString("default",{month:"long"})+" "+t.toLocaleString("default",{year:"numeric"}),yb=t=>Ome[t.properties.LandUse.constructor===Array?t.properties.LandUse[0]:t.properties.LandUse],Pme=1e-9;function kme(t,e){let n=t||2,r=e||2;const i=ur(),s=ur();let l=p();function o(v,S){var M=S??v.u,k=S!=null?v:v.v;let F=0;for(;F<l.length-1&&i(M)<1-(F+1)/r-Pme;)F++;const H=l[F].length>1?(l[F][1].v-l[F][0].v)/2:0;let j=0;for(;j<l[F].length-1&&k>l[F][j].v+H;)j++;return l[F][j]}function p(){const v=[];let S;s.nice(Math.pow(n,r-1)),i.nice(r),v[0]=[],v[0].push({u:i.invert((r-1)/r),v:s.invert(.5)});for(let M=1;M<=r;M++){v[M-1]=[],S=2*Math.pow(n,M);for(let k=1;k<S;k+=2)v[M-1].push({u:i.invert(1-M/r),v:s.invert(k/S)})}return v}return o.range=()=>[].concat.apply([],l),o.tree=()=>l,o.data=o.tree,o.branching=function(v){return arguments.length?(n=Math.max(1,v),l=p(),o):n},o.layers=function(v){return arguments.length?(r=Math.max(1,v),l=p(),o):r},o.uncertaintyDomain=function(v){return arguments.length?(i.domain(v),l=p(),o):i.domain()},o.valueDomain=function(v){return arguments.length?(s.domain(v),l=p(),o):s.domain()},o}const _b=t=>t.replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),VA=7,vb=(t,e=0,n=1/VA)=>{let r=e==0?n:n/2;return Math.abs(t-e)<r?0:1},Iv=(t,e,n=!0,r=!0)=>{const i=Object.keys(t);for(const s of i){const l=t[s],o=l.value.range||[0,1],p=l.variance.range||[1,0],v=l.value.color||AP,S=l.variance.color||AP;if(typeof l.value.domain=="function")if(n){const j=Object.values(e).slice(-1)[0];l.value.domain=Rc(Object.values(j).map(l.value.domain))}else l.value.domain=Rc(e.features.map(l.value.domain));if(typeof l.value.domain=="string")if(n){const j=Object.values(e).slice(-1)[0];l.value.domain=Rc(Object.values(j).map(ie=>ie[l.value.domain]))}else l.value.domain=Rc(e.features.map(j=>j.properties[l.value.domain]));if(typeof l.variance.domain=="function")if(n){const j=Object.values(e).slice(-1)[0];l.variance.domain=Rc(Object.values(j).map(l.variance.domain))}else l.variance.domain=Rc(e.features.map(l.variance.domain));if(typeof l.variance.domain=="string")if(n){const j=Object.values(e).slice(-1)[0];l.variance.domain=Rc(Object.values(j).map(ie=>ie[l.variance.domain]))}else l.variance.domain=Rc(e.features.map(j=>j.properties[l.variance.domain]));const M=ur().domain(l.value.domain).range(o),k=ur().domain(l.variance.domain).range(p);l.scaleLinear=M.copy().clamp(!0);const F=ss().domain(l.value.domain).range(ph(VA).map(j=>j/(VA-1)*(o[1]-o[0])+o[0]));l.scaleLinearVar=k.copy().clamp(!0);const H=ss().domain(l.variance.domain).range(ph(VA).map(j=>j/(VA-1)*(p[1]-p[0])+p[0]));l.colorsLinear=j=>v(M(j)),l.colorsStepped=ss().domain(l.value.domain).range(OM(j=>v(ur([0,1]).range(o)(j)),VA)),l.colorsLinearVar=j=>S(k(j)),l.colorsSteppedVar=ss().domain(l.variance.domain).range(OM(j=>S(ur([0,1]).range(p)(j)),VA)),l.vsup=bme().quantize((r?wme():kme()).branching(2).layers(r?4:3).valueDomain(l.value.domain).uncertaintyDomain(l.variance.domain)).range(v),l.interpColor=(j,ie=!1,Y=!0,J=1/VA)=>[..._b((Y?l.colorsStepped:l.colorsLinear)(j)),...ie?[vb(F(j),l.value.zero||0,J)*255]:[]],l.interpColorVar=(j,ie=!1,Y=!0,J=1/VA)=>[..._b((Y?l.colorsSteppedVar:l.colorsLinearVar)(j)),...ie?[vb(H(j),l.variance.zero||0,J)*255]:[]],l.interpVsup=(j,ie,Y=!1,J=1/VA)=>[..._b(l.vsup(j,ie)),...Y?[vb(l.scaleStepped(j),l.value.zero||0,J)*255]:[]]}return t},p4=(t,e,n,r)=>{const i=Math.sqrt(3)/2,s=n,l=t,o=e,p=[[s+l,0+o],[s/2+l,s*i+o],[-s/2+l,s*i+o],[-s+l,0+o],[-s/2+l,-s*i+o],[s/2+l,-s*i+o]];return function(v){v.selectAll("path.area").data([p]).enter().append("path").attr("d",j_()).attr("fill",r)}},L7=(t,e,n,r,i=.2)=>{const s=Math.sqrt(3)/2;let l=n;const o=t,p=e,v=[[l+o,0+p],[l/2+o,l*s+p],[-l/2+o,l*s+p],[-l+o,0+p],[-l/2+o,-l*s+p],[l/2+o,-l*s+p]];l=n*(1-i);const S=[[l/2+o,-l*s+p],[-l/2+o,-l*s+p],[-l+o,0+p],[-l/2+o,l*s+p],[l/2+o,l*s+p],[l+o,0+p]],M=j_()(v),k=j_()(S);return function(F){F.append("path").attr("d",M+" "+k).attr("fill",r)}};function Lv(t,e,n="Title",r=".2s"){return ur().range([55/255,1]),i=>i.call(s=>{const l=t.scaleLinear.invert;s.selectAll(".some").data(sa).enter().append("g").attr("transform",(o,p)=>`translate(${p*60},0)`).each(function(o){Gr(this).selectAll(".others").data(o.filter(p=>p[2]>-1)).enter().append("svg:image").attr("xlink:href",e).attr("x",(p,v)=>p[0]*20).attr("y",(p,v)=>-p[1]*20+15).attr("width",16).attr("height",16)}).append("text").attr("x",8).attr("y",0).style("font-size","10px").attr("text-anchor","middle").text((o,p)=>p==0?`<${_r(r)(l((p+1)/sa.length))}`:p==sa.length-1?`>${_r(r)(l(p/sa.length))}`:`${_r(r)(l(p/sa.length))} — ${_r(r)(l((p+1)/sa.length))}`),s.append("text").attr("text-anchor","middle").attr("x",60*3.5+(30-20)*2).attr("y",-15).style("font-weight","bold").text(n)})}function Dv(t,e){const n=ur().range([.21568627450980393,1]);return r=>r.call(i=>{t.scaleLinearVar.invert,i.selectAll(".budy").data(sa).enter().append("g").attr("transform",(s,l)=>`translate(${l*60},0)`).call(s=>{s.append("g").each(function(l){Gr(this).selectAll(".others").data(sa[1].filter(o=>o[2]>-1)).enter().append("svg:image").attr("xlink:href",e).attr("x",(o,p)=>o[0]*20).attr("y",(o,p)=>-o[1]*20).attr("width",16).attr("height",16)}).attr("opacity",(l,o)=>n(1-o/(sa.length-1)))}).append("text").attr("x",8).attr("y",25).style("font-size","10px").attr("text-anchor","middle").text((s,l)=>l==0?"Low":l==sa.length-1?"High":""),i.append("text").attr("text-anchor","middle").attr("x",60*3.5+(30-20)*2).attr("y",40).text("Variance")})}function Ef(t,e="Title",n=!1,r=".2s"){const i=[.4,.65],s=[.3,1],l=M=>ur().range([0,(i[1]-i[0])/i[1]])(ur().range(s)(M)),o=7,p=20,v=p*2+10,S=ur().range([l(0),l(1)]);return M=>M.call(k=>{const F=ur().range(t.scaleLinear.domain());let H=ur().range([F(1/(o*2)),F(1-1/(o*2))]);k.append("g").selectAll(".asdf").data(ph(o).map(j=>j/(o-1))).enter().append("g").attr("transform",(j,ie)=>`translate(${ie*v},0)`).each(function(j,ie){Gr(this).call(L7(0,20,p,uf(...t.interpColor(H(j),!n)),S(1)))}).append("text").style("font-size","10px").attr("text-anchor","middle").attr("x",0).attr("y",0).text((j,ie)=>ie==0?`<${_r(r)(F((ie+1)/o))}`:ie==o-1?`>${_r(r)(F(ie/o))}`:`${_r(r)(F(ie/o))} — ${_r(r)(F((ie+1)/o))}`),k.append("text").attr("text-anchor","middle").attr("x",p*3+v*2).attr("y",-15).style("font-weight","bold").text(e)})}function Rv(t){const e=[.4,.65],n=[.3,1],r=p=>ur().range([0,(e[1]-e[0])/e[1]])(ur().range(n)(p)),i=7,s=20,l=s*2+10,o=ur().range([r(0),r(1)]);return p=>p.call(v=>{const S=t.scaleLinear.invert;t.scaleLinearVar.invert;let M=ur().range([S(1/(i*2)),S(1-1/(i*2))]);v.append("g").selectAll(".asdf").data(ph(i).map(k=>k/(i-1))).enter().append("g").attr("transform",(k,F)=>`translate(${F*l},${s*2})`).each(function(k,F){Gr(this).call(L7(0,0,s,uf(...t.interpColor(M(0))),o(1-k)))}).append("text").style("font-size","10px").attr("text-anchor","middle").attr("x",0).attr("y",s+10).text((k,F)=>F==0?"Low":F==i-1?"High":""),v.append("text").attr("text-anchor","middle").attr("x",s*3+l*2).attr("y",s*4).text("Variance")})}function Ime(t,e,n,r,i,s){let l=i||0,o=s||0,p=n||0,v=e||(()=>"#fff"),S=r,M;function k(F){k.el=F,k.setProperties()}return k.setProperties=function(){this.el&&(k.svgGroup||(k.svgGroup=k.el.append("g")),k.svgGroup.attr("transform",`translate(${l},${o})`),k.svgGroup.selectAll("g").data(t).enter().append("g").selectAll("rect").data((F,H)=>F.map(j=>({r:H,v:j}))).enter().append("rect").datum(function(F,H){return F.c=H,F}),k.svgGroup.selectAll("g").selectAll("rect").attr("x",F=>p/t[F.r].length*F.c).attr("y",F=>F.r*M).attr("width",F=>p/t[F.r].length).attr("height",M).attr("fill",F=>v(F.v)),S&&k.svgGroup.attr("id",S))},k.data=function(F){return arguments.length?(t=F,M=p/t.length,k.setProperties(),k):t},k.x=function(F){return arguments.length?(l=F,k.setProperties(),k):l},k.y=function(F){return arguments.length?(o=F,k.setProperties(),k):o},k.size=function(F){return arguments.length?(p=F,t&&(M=p/t.length,k.setProperties()),k):p},k.scale=function(F){return arguments.length?(v=F,t&&k.setProperties(),k):v},k.id=function(F){return arguments.length?(S=F,k.setProperties(),k):S},k}function Lme(t,e,n,r,i,s){const l=Ime(t,e,n,r,i,s);function o(p,v,S,M){const k=ur().domain([0,M]).range([-Math.PI/6,Math.PI/6]),F=ur().domain([0,S]).range([v,0]);return $_().innerRadius(F(p.r+1)).outerRadius(F(p.r)).startAngle(k(p.c)).endAngle(k(p.c+1))()}return l.setProperties=function(){var p=l.data(),v=l.size(),S=l.scale(),M=l.id(),k=l.x(),F=l.y();l.el&&(l.svgGroup||(l.svgGroup=l.el.append("g")),l.svgGroup.attr("transform",`translate(${k},${F})`),l.svgGroup.selectAll("g").data(p).enter().append("g").selectAll("path").data((H,j)=>H.map(ie=>({r:j,v:ie}))).enter().append("path").datum(function(H,j){return H.c=j,H}),l.svgGroup.selectAll("g").selectAll("path").attr("transform",`translate(${v/2},${v})`).attr("d",H=>o(H,v,p.length,p[H.r].length)).attr("fill",H=>S(H.v)),M&&l.svgGroup.attr("id",M))},l}function Bv(t,e,n,r,i,s,l){let o=null,p=r||"Uncertainty",v=i||"Value",S=t||null,M=e||200,k=n||".2s",F=s||0,H=l||0,j=null;const ie=Lme();var Y=function(J){o=J,Y.setProperties(),o.call(ie)};return Y.setProperties=function(){if(!o)return;let J=j;J||(J=S.quantize().data());const se=[];for(let _t=0;_t<J.length;_t++)se[_t]=J[J.length-_t-1];ie.data(se),ie.scale(S),ie.size(M),o.attr("class","legend").attr("transform",`translate(${F},${H})`);var ce=S&&S.quantize?S.quantize().uncertaintyDomain():[0,1];const me=(ce[1]-ce[0])/se.length;ph(ce[0],ce[1]+me,me);const Ee=Fa().range([0,M]).domain(["Low","","High"]),He=M/180;o.append("g").attr("transform",`translate(${M+6*He},${28*He})rotate(30)`).call(lf(Ee)),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(M+10*He)+","+(40*He+M/2)+")rotate(-60)").text(p);var Qe=S&&S.quantize?S.quantize().valueDomain():[0,1];const Ye=(Qe[1]-Qe[0])/se[0].length,nt=ph(Qe[0],Qe[1]+Ye,Ye),Fe=ur().range([0,M]).domain(Qe),tt=k?_r(k):Fe.tickFormat(nt.length),Ze=ur().domain(Qe).range([-30,30]),pt=3*He,Yt=$_().innerRadius(M+pt).outerRadius(M+pt+1).startAngle(-Math.PI/6).endAngle(Math.PI/6),Et=o.append("g").attr("transform",`translate(${M/2},${M-pt})`);Et.append("path").attr("fill","black").attr("stroke","transparent").attr("d",Yt);const un=Et.selectAll(".arc-label").data(nt).enter().append("g").attr("class","arc-label").attr("transform",_t=>"rotate("+Ze(_t)+")translate(0,"+(-M-pt)+")");un.append("text").style("font-size","11").style("text-anchor","middle").attr("y",-10).text(tt),un.append("line").attr("x1",.5).attr("x2",.5).attr("y1",-6).attr("y2",0).attr("stroke","#000"),o.append("text").style("text-anchor","middle").style("font-size",13).attr("x",M/2).attr("y",-30).text(v)},Y.data=function(J){return arguments.length?(j=J,Y.setProperties(),Y):j},Y.scale=function(J){return arguments.length?(S=J,Y.setProperties(),Y):S},Y.size=function(J){return arguments.length?(M=J,Y.setProperties(),Y):M},Y.format=function(J){return arguments.length?(k=J,Y.setProperties(),Y):k},Y.x=function(J){return arguments.length?(F=J,Y.setProperties(),Y):F},Y.y=function(J){return arguments.length?(H=J,Y.setProperties(),Y):H},Y.utitle=function(J){return arguments.length?(p=J,Y.setProperties(),Y):p},Y.vtitle=function(J){return arguments.length?(v=J,Y.setProperties(),Y):v},Y}function Dme(t,e){const n=e,r=JSON.stringify(t,null,2),i=new Blob([r],{type:"application/json"}),s=URL.createObjectURL(i),l=document.createElement("a");l.href=s,l.download=n+".json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)}function Rme(){let t=new Date,e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),i=t.getHours(),s=t.getMinutes(),l=t.getSeconds();return e+"-"+n+"-"+r+"-"+i+"-"+s+"-"+l}function D7(t){const e=Xhe(f2(t)),[n,r]=efe(e).geometry.coordinates;for(let i of e.geometry.coordinates[0])i[0]+=(i[0]-n)*2,i[1]+=(i[1]-r)*2;return e}const sa=[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]],dm={longitude:-121.046040643251,latitude:37.53320315272563,zoom:7.3252675985610685,minZoom:7,maxZoom:15,pitch:50.85,bearing:32.58};new yh;new yh;new yh;new yh;new yh;new yh;const Bme=new cO({color:[255,255,255],intensity:1.7}),zme=new qoe({timestamp:Date.UTC(2019,6,1,22),color:[255,255,255],intensity:.8}),Ome={0:"Settlement",1:"Exchange",2:"Project",3:"Non-Project"},Ro={0:"bl_h000",1:"CS3_ALT3_2022med_L2020ADV",2:"LTO_BA_EXP1_2022MED"},I8={0:"Scenario 1",1:"Scenario 2",2:"Scenario 3"},Eh=new zS({ambientLight:Bme,dirLight:zme}),Fme={longitude:-119.99582643167989,latitude:37.88453894208306,zoom:10.364947995424346,pitch:49.903969287830776,bearing:28.126875},R7={longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:10,pitch:50.85,bearing:32.58},Nme={party:{value:{domain:[-100,100],color:oa(YR(["red","purple","blue"]),-1,.2)},variance:{domain:[0,2e3]}},votes:{value:{domain:[0,42508]},variance:{domain:[0,1]}},population:{value:{domain:[0,200],color:aZ},variance:{domain:[0,8e5]}},poc:{value:{domain:[0,50],color:oa(nZ,.5,-.3)},variance:{domain:[0,100]}}},Ume={power:{value:{domain:[0,300]},variance:{domain:[0,100],range:[0,1]}},personnel:{value:{domain:[0,100]},variance:{domain:[0,1]}}},Vme={fire:{value:{domain:[0,300],color:oa(t=>iZ(ur([.4,1])(t)),-.5,.5)},variance:{domain:"FireVar"}},personnel:{value:{domain:[0,1]},variance:{domain:[0,1]}},gr2:{value:{domain:[0,.75],color:oa(t=>bB(ur([.2,1])(t)),1,.8)},variance:{domain:[0,1]}}},Gme={groundwater:{value:{domain:[-300,700],color:oa(t=>bB(ur([.75,1])(t)),-.5,.5)},variance:{domain:[0,1e4]}},demand:{value:{domain:[0,150],color:oa(fw,1,1)},variance:{domain:[0,650]}},unmetDemand:{value:{domain:[-150,0],range:[1,0],color:oa(fw,0,0)},variance:{domain:[0,650]}},unmetDemandPositive:{value:{domain:[0,150],color:oa(fw,0,0)},variance:{domain:[0,650]}},difference:{value:{domain:[-30,30],color:oa(eZ,0,0),zero:.5},variance:{domain:[0,650]}}},zv=I7(await(await fetch("./assets/hex_5_6.json")).json(),t=>t.DemandBaseline),L8=I7(await(await fetch("./assets/square_5_6.json")).json(),t=>t.DemandBaseline),xb=await(await fetch("./assets/averages.json")).json(),sd=await(await fetch("./assets/demand_geo_small.json")).json(),hc=await(await fetch("./assets/election_hex_3_4.json")).json(),Gm=await(await fetch("./assets/election_square_3_4.json")).json(),$m=await(await fetch("./assets/precinct_geo.json")).json(),g4=await(await fetch("./assets/wildfire_hex_7_9.json")).json(),B7=await(await fetch("./assets/groundwater_geo.json")).json();await(await fetch("./assets/fire_hex_7_9.json")).json();const $me=await(await fetch("./assets/precinct_geo.json")).json(),D8=await(await fetch("./assets/county_geo.json")).json(),z7=D7(B7),jme=D7($m);function m4(){const[t,e]=Ue.useState(1);return{curOption:t,setCurOption:e}}const Lr=Iv(Gme,zv),Wn=Iv(Nme,hc,!0,!1);Iv(Ume,{});const dl=Iv(Vme,g4);ur().domain([9,14]).range([0,1]).clamp(!0);const _g=Kq().domain([new Date("10/31/1921"),new Date("9/30/2021")]).range([0,1199]).invert;function O7({curOption:t}){const e=Ue.useRef(),n=Ue.useRef(),r=Ue.useRef({});Ue.useEffect(()=>{e.current=document.querySelector("#main-tooltip"),n.current=document.querySelector("#secondary-tooltip")},[]);const i=Ue.useCallback(p=>{e.current.classList.add("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>GEOID</b> ${p.properties.GEOID}</div>
      <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
      <div><b>Percent Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
    `},[]),s=Ue.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),p.properties.pct_dem_lead?e.current.innerHTML=`        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
        <div><b>% Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
      `:e.current.innerHTML=`        <div><b>County Subdiv.</b> ${p.properties["county_subdivision_dec_Geographic Area Name"]}</div>
        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>% PoC</b> ${100-p.properties["county_subdivision_dec_Percent White"]}</div>
        <div><b>Pop. / Km2</b> ${p.properties["Population per Sqkm"]}</div>
      `},[]),l=Ue.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),e.current.innerHTML=`    <div><b>% PoC</b> ${p.properties.PoC}</div>
    <div><b>% PoC Var</b> ${p.properties.PoCVar}</div>
      <div><b>Pop. Den</b> ${p.properties.PopSqKm}</div>
      <div><b>Pop. Den Var</b> ${p.properties.PopSqKmVar}</div>
      <div><b>% Dem. Lead</b> ${p.properties.DemLead}</div>
      <div><b>% Dem. Lead Var</b> ${p.properties.DemLeadVar}</div>
      <div><b>Num. of County Subdivs</b> ${p.properties.CountyRgs.length}</div>
      <div><b>Num. of Precincts</b> ${p.properties.PrecinctRgs.length}</div>
      `},[]);return Ue.useCallback(({object:p})=>{if(!p){r.current&&(n.current.classList.remove("active"),kd(r.current)&&e.current.classList.remove("active"),r.current=p);return}kd(p)?l(p):kv(p)?i(p):s(p),r.current=p},[])}var kt=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(K){return e.locateFile?e.locateFile(K,i):i+K}var l;document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",l=function(Q,te,fe){var a=new XMLHttpRequest;a.open("GET",Q,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status==200||a.status==0&&a.response){te(a.response);return}var Le=Rr(Q);if(Le){te(Le.buffer);return}fe()},a.onerror=fe,a.send(null)};var o=e.print||console.log.bind(console),p=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var v=0,S=function(K){v=K},M=function(){return v},k=8;function F(K,Q,te,fe){switch(te=te||"i8",te.charAt(te.length-1)==="*"&&(te="i32"),te){case"i1":tt[K>>0]=Q;break;case"i8":tt[K>>0]=Q;break;case"i16":pt[K>>1]=Q;break;case"i32":Yt[K>>2]=Q;break;case"i64":Ii=[Q>>>0,(jr=Q,+tr(jr)>=1?jr>0?(lr(+xr(jr/4294967296),4294967295)|0)>>>0:~~+Hn((jr-+(~~jr>>>0))/4294967296)>>>0:0)],Yt[K>>2]=Ii[0],Yt[K+4>>2]=Ii[1];break;case"float":Et[K>>2]=Q;break;case"double":un[K>>3]=Q;break;default:Nr("invalid type for setValue: "+te)}}function H(K,Q,te){switch(Q=Q||"i8",Q.charAt(Q.length-1)==="*"&&(Q="i32"),Q){case"i1":return tt[K>>0];case"i8":return tt[K>>0];case"i16":return pt[K>>1];case"i32":return Yt[K>>2];case"i64":return Yt[K>>2];case"float":return Et[K>>2];case"double":return un[K>>3];default:Nr("invalid type for getValue: "+Q)}return null}var j=!1;function ie(K,Q){K||Nr("Assertion failed: "+Q)}function Y(K){var Q=e["_"+K];return ie(Q,"Cannot call unknown function "+K+", make sure it is exported"),Q}function J(K,Q,te,fe,a){var G={string:function(dt){var Dt=0;if(dt!=null&&dt!==0){var Rt=(dt.length<<2)+1;Dt=Vs(Rt),Qe(dt,Dt,Rt)}return Dt},array:function(dt){var Dt=Vs(dt.length);return Ye(dt,Dt),Dt}};function Le(dt){return Q==="string"?Ee(dt):Q==="boolean"?!!dt:dt}var ke=Y(K),Pe=[],Ie=0;if(fe)for(var qe=0;qe<fe.length;qe++){var At=G[te[qe]];At?(Ie===0&&(Ie=ci()),Pe[qe]=At(fe[qe])):Pe[qe]=fe[qe]}var We=ke.apply(null,Pe);return We=Le(We),Ie!==0&&Fr(Ie),We}function se(K,Q,te,fe){te=te||[];var a=te.every(function(Le){return Le==="number"}),G=Q!=="string";return G&&a&&!fe?Y(K):function(){return J(K,Q,te,arguments)}}var ce=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function me(K,Q,te){for(var fe=Q+te,a=Q;K[a]&&!(a>=fe);)++a;if(a-Q>16&&K.subarray&&ce)return ce.decode(K.subarray(Q,a));for(var G="";Q<a;){var Le=K[Q++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var ke=K[Q++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|ke);continue}var Pe=K[Q++]&63;if((Le&240)==224?Le=(Le&15)<<12|ke<<6|Pe:Le=(Le&7)<<18|ke<<12|Pe<<6|K[Q++]&63,Le<65536)G+=String.fromCharCode(Le);else{var Ie=Le-65536;G+=String.fromCharCode(55296|Ie>>10,56320|Ie&1023)}}return G}function Ee(K,Q){return K?me(Ze,K,Q):""}function He(K,Q,te,fe){if(!(fe>0))return 0;for(var a=te,G=te+fe-1,Le=0;Le<K.length;++Le){var ke=K.charCodeAt(Le);if(ke>=55296&&ke<=57343){var Pe=K.charCodeAt(++Le);ke=65536+((ke&1023)<<10)|Pe&1023}if(ke<=127){if(te>=G)break;Q[te++]=ke}else if(ke<=2047){if(te+1>=G)break;Q[te++]=192|ke>>6,Q[te++]=128|ke&63}else if(ke<=65535){if(te+2>=G)break;Q[te++]=224|ke>>12,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}else{if(te+3>=G)break;Q[te++]=240|ke>>18,Q[te++]=128|ke>>12&63,Q[te++]=128|ke>>6&63,Q[te++]=128|ke&63}}return Q[te]=0,te-a}function Qe(K,Q,te){return He(K,Ze,Q,te)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Ye(K,Q){tt.set(K,Q)}function nt(K,Q){return K%Q>0&&(K+=Q-K%Q),K}var Fe,tt,Ze,pt,Yt,Et,un;function _t(K){Fe=K,e.HEAP8=tt=new Int8Array(K),e.HEAP16=pt=new Int16Array(K),e.HEAP32=Yt=new Int32Array(K),e.HEAPU8=Ze=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Et=new Float32Array(K),e.HEAPF64=un=new Float64Array(K)}var Tt=5266928,Jt=24016,In=e.TOTAL_MEMORY||33554432;e.buffer?Fe=e.buffer:Fe=new ArrayBuffer(In),In=Fe.byteLength,_t(Fe),Yt[Jt>>2]=Tt;function Tn(K){for(;K.length>0;){var Q=K.shift();if(typeof Q=="function"){Q();continue}var te=Q.func;typeof te=="number"?Q.arg===void 0?e.dynCall_v(te):e.dynCall_vi(te,Q.arg):te(Q.arg===void 0?null:Q.arg)}}var kr=[],er=[],or=[],hr=[];function Un(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Mn(e.preRun.shift());Tn(kr)}function Cr(){Tn(er)}function wt(){Tn(or)}function rn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)xt(e.postRun.shift());Tn(hr)}function Mn(K){kr.unshift(K)}function xt(K){hr.unshift(K)}var tr=Math.abs,Hn=Math.ceil,xr=Math.floor,lr=Math.min,nr=0,ri=null;function Vn(K){nr++,e.monitorRunDependencies&&e.monitorRunDependencies(nr)}function ki(K){if(nr--,e.monitorRunDependencies&&e.monitorRunDependencies(nr),nr==0&&ri){var Q=ri;ri=null,Q()}}e.preloadedImages={},e.preloadedAudios={};var Qn=null,Gi="data:application/octet-stream;base64,";function yo(K){return String.prototype.startsWith?K.startsWith(Gi):K.indexOf(Gi)===0}var jr,Ii;Qn="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var $o=24032;function ls(K){return K}function ht(K){var Q=/\b__Z[\w\d_]+/g;return K.replace(Q,function(te){var fe=te;return te===fe?te:fe+" ["+te+"]"})}function It(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(Q){K=Q}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Us(){var K=It();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ht(K)}function bi(K,Q,te,fe){Nr("Assertion failed: "+Ee(K)+", at: "+[Q?Ee(Q):"unknown filename",te,fe?Ee(fe):"unknown function"])}function Bn(){return tt.length}function $i(K,Q,te){Ze.set(Ze.subarray(Q,Q+te),K)}function Li(K){return e.___errno_location&&(Yt[e.___errno_location()>>2]=K),K}function Di(K){Nr("OOM")}function As(K){try{var Q=new ArrayBuffer(K);return Q.byteLength!=K?void 0:(new Int8Array(Q).set(tt),Zr(Q),_t(Q),1)}catch{}}function Lt(K){var Q=Bn(),te=16777216,fe=2147483648-te;if(K>fe)return!1;for(var a=16777216,G=Math.max(Q,a);G<K;)G<=536870912?G=nt(2*G,te):G=Math.min(nt((3*G+2147483648)/4,te),fe);var Le=As(G);return!!Le}var Sn=typeof atob=="function"?atob:function(K){var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",te="",fe,a,G,Le,ke,Pe,Ie,qe=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=Q.indexOf(K.charAt(qe++)),ke=Q.indexOf(K.charAt(qe++)),Pe=Q.indexOf(K.charAt(qe++)),Ie=Q.indexOf(K.charAt(qe++)),fe=Le<<2|ke>>4,a=(ke&15)<<4|Pe>>2,G=(Pe&3)<<6|Ie,te=te+String.fromCharCode(fe),Pe!==64&&(te=te+String.fromCharCode(a)),Ie!==64&&(te=te+String.fromCharCode(G));while(qe<K.length);return te};function bn(K){try{for(var Q=Sn(K),te=new Uint8Array(Q.length),fe=0;fe<Q.length;++fe)te[fe]=Q.charCodeAt(fe);return te}catch{throw new Error("Converting base64 string to bytes failed.")}}function Rr(K){if(yo(K))return bn(K.slice(Gi.length))}var Ts={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},yn={a:Nr,b:S,c:M,d:bi,e:Li,f:Bn,g:$i,h:Lt,i:Di,j:ls,k:ht,l:As,m:It,n:Us,o:$o,p:Jt},Xe=function(K,Q,te){"almost asm";var fe=new K.Int8Array(te),a=new K.Int32Array(te);new K.Uint8Array(te),new K.Float32Array(te);var G=new K.Float64Array(te),Le=Q.p|0,ke=K.Math.floor,Pe=K.Math.abs,Ie=K.Math.sqrt,qe=K.Math.pow,At=K.Math.cos,We=K.Math.sin,dt=K.Math.tan,Dt=K.Math.acos,Rt=K.Math.asin,sn=K.Math.atan,jt=K.Math.atan2,pn=K.Math.ceil,qt=K.Math.imul,an=K.Math.min,xn=K.Math.clz32,Ft=Q.b,Oe=Q.c,Mt=Q.d,Ce=Q.e,cn=Q.f,hi=Q.g,rr=Q.h,pa=Q.i,De=24048;function Ha(A){return fe=new Int8Array(A),a=new Int32Array(A),G=new Float64Array(A),te=A,!0}function we(A){A=A|0;var h=0;return h=De,De=De+A|0,De=De+15&-16,h|0}function jo(){return De|0}function Ss(A){A=A|0,De=A}function Wa(A,h){A=A|0,De=A}function Qa(A){return A=A|0,(qt(A*3|0,A+1|0)|0)+1|0}function ga(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0;ma(A,h,d,w,0)|0&&(C=(qt(d*3|0,d+1|0)|0)+1|0,L(w|0,0,C<<3|0)|0,b=es(C,4)|0,b&&(ii(A,h,d,w,b,C,0),fn(b)))}function Ml(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0;if(ma(A,h,d,w,b)|0){if(C=(qt(d*3|0,d+1|0)|0)+1|0,L(w|0,0,C<<3|0)|0,b|0){L(b|0,0,C<<2|0)|0,ii(A,h,d,w,b,C,0);return}b=es(C,4)|0,b&&(ii(A,h,d,w,b,C,0),fn(b))}}function ma(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0;if(ue=De,De=De+16|0,ne=ue,C=w,a[C>>2]=A,a[C+4>>2]=h,C=(b|0)!=0,C&&(a[b>>2]=0),zr(A,h)|0)return ne=1,De=ue,ne|0;a[ne>>2]=0;e:do if((d|0)>=1)if(C)for(W=0,X=1,ae=1,P=0,C=A;;){if(!(P|W)){if(C=ge(C,h,4,ne)|0,h=Oe()|0,(C|0)==0&(h|0)==0){C=2;break e}if(zr(C,h)|0){C=1;break e}}if(C=ge(C,h,a[16+(W<<2)>>2]|0,ne)|0,h=Oe()|0,(C|0)==0&(h|0)==0){C=2;break e}if(A=w+(ae<<3)|0,a[A>>2]=C,a[A+4>>2]=h,a[b+(ae<<2)>>2]=X,P=P+1|0,A=(P|0)==(X|0),B=W+1|0,V=(B|0)==6,zr(C,h)|0){C=1;break e}if(X=X+(V&A&1)|0,(X|0)>(d|0)){C=0;break}else W=A?V?0:B:W,ae=ae+1|0,P=A?0:P}else for(W=0,X=1,ae=1,P=0,C=A;;){if(!(P|W)){if(C=ge(C,h,4,ne)|0,h=Oe()|0,(C|0)==0&(h|0)==0){C=2;break e}if(zr(C,h)|0){C=1;break e}}if(C=ge(C,h,a[16+(W<<2)>>2]|0,ne)|0,h=Oe()|0,(C|0)==0&(h|0)==0){C=2;break e}if(A=w+(ae<<3)|0,a[A>>2]=C,a[A+4>>2]=h,P=P+1|0,A=(P|0)==(X|0),B=W+1|0,V=(B|0)==6,zr(C,h)|0){C=1;break e}if(X=X+(V&A&1)|0,(X|0)>(d|0)){C=0;break}else W=A?V?0:B:W,ae=ae+1|0,P=A?0:P}else C=0;while(0);return ne=C,De=ue,ne|0}function ii(A,h,d,w,b,C,P){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0,C=C|0,P=P|0;var B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0;if(ae=De,De=De+16|0,X=ae,(A|0)==0&(h|0)==0){De=ae;return}if(B=Ys(A|0,h|0,C|0,((C|0)<0)<<31>>31|0)|0,Oe()|0,V=w+(B<<3)|0,ne=V,ue=a[ne>>2]|0,ne=a[ne+4>>2]|0,W=(ue|0)==(A|0)&(ne|0)==(h|0),!((ue|0)==0&(ne|0)==0|W))do B=(B+1|0)%(C|0)|0,V=w+(B<<3)|0,ue=V,ne=a[ue>>2]|0,ue=a[ue+4>>2]|0,W=(ne|0)==(A|0)&(ue|0)==(h|0);while(!((ne|0)==0&(ue|0)==0|W));if(B=b+(B<<2)|0,W&&(a[B>>2]|0)<=(P|0)){De=ae;return}if(ue=V,a[ue>>2]=A,a[ue+4>>2]=h,a[B>>2]=P,(P|0)>=(d|0)){De=ae;return}ue=P+1|0,a[X>>2]=0,ne=ge(A,h,2,X)|0,ii(ne,Oe()|0,d,w,b,C,ue),a[X>>2]=0,ne=ge(A,h,3,X)|0,ii(ne,Oe()|0,d,w,b,C,ue),a[X>>2]=0,ne=ge(A,h,1,X)|0,ii(ne,Oe()|0,d,w,b,C,ue),a[X>>2]=0,ne=ge(A,h,5,X)|0,ii(ne,Oe()|0,d,w,b,C,ue),a[X>>2]=0,ne=ge(A,h,4,X)|0,ii(ne,Oe()|0,d,w,b,C,ue),a[X>>2]=0,ne=ge(A,h,6,X)|0,ii(ne,Oe()|0,d,w,b,C,ue),De=ae}function ge(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0;if((a[w>>2]|0)>0){b=0;do d=Wi(d)|0,b=b+1|0;while((b|0)<(a[w>>2]|0))}B=Ct(A|0,h|0,45)|0,Oe()|0,V=B&127,C=fi(A,h)|0,b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)P=6;else for(;;){if(ae=(15-b|0)*3|0,ne=Ct(A|0,h|0,ae|0)|0,Oe()|0,ne=ne&7,ue=(mi(b)|0)==0,b=b+-1|0,X=Pt(7,0,ae|0)|0,h=h&~(Oe()|0),ae=Pt(a[(ue?464:48)+(ne*28|0)+(d<<2)>>2]|0,0,ae|0)|0,W=Oe()|0,d=a[(ue?672:256)+(ne*28|0)+(d<<2)>>2]|0,A=ae|A&~X,h=W|h,!d){d=0;break e}if(!b){P=6;break}}while(0);(P|0)==6&&(ue=a[880+(V*28|0)+(d<<2)>>2]|0,ne=Pt(ue|0,0,45)|0,A=ne|A,h=Oe()|0|h&-1040385,d=a[4304+(V*28|0)+(d<<2)>>2]|0,(ue&127|0)==127&&(ue=Pt(a[880+(V*28|0)+20>>2]|0,0,45)|0,h=Oe()|0|h&-1040385,d=a[4304+(V*28|0)+20>>2]|0,A=hs(ue|A,h)|0,h=Oe()|0,a[w>>2]=(a[w>>2]|0)+1)),P=Ct(A|0,h|0,45)|0,Oe()|0,P=P&127;e:do if(en(P)|0){t:do if((fi(A,h)|0)==1){if((V|0)!=(P|0))if(iu(P,a[7728+(V*28|0)>>2]|0)|0){A=Ki(A,h)|0,C=1,h=Oe()|0;break}else{A=hs(A,h)|0,C=1,h=Oe()|0;break}switch(C|0){case 5:{A=Ki(A,h)|0,h=Oe()|0,a[w>>2]=(a[w>>2]|0)+5,C=0;break t}case 3:{A=hs(A,h)|0,h=Oe()|0,a[w>>2]=(a[w>>2]|0)+1,C=0;break t}default:return ne=0,ue=0,Ft(ne|0),ue|0}}else C=0;while(0);if((d|0)>0){b=0;do A=Ei(A,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}if((V|0)!=(P|0)){if(!(Br(P)|0)){if((C|0)!=0|(fi(A,h)|0)!=5)break;a[w>>2]=(a[w>>2]|0)+1;break}switch(B&127){case 8:case 118:break e}(fi(A,h)|0)!=3&&(a[w>>2]=(a[w>>2]|0)+1)}}else if((d|0)>0){b=0;do A=hs(A,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}while(0);return a[w>>2]=((a[w>>2]|0)+d|0)%6|0,ne=h,ue=A,Ft(ne|0),ue|0}function Te(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0;if(ae=De,De=De+16|0,X=ae,!d)return X=w,a[X>>2]=A,a[X+4>>2]=h,X=0,De=ae,X|0;a[X>>2]=0;e:do if(zr(A,h)|0)A=1;else{if(C=(d|0)>0,C){b=0,W=A;do{if(W=ge(W,h,4,X)|0,h=Oe()|0,(W|0)==0&(h|0)==0){A=2;break e}if(b=b+1|0,zr(W,h)|0){A=1;break e}}while((b|0)<(d|0));if(V=w,a[V>>2]=W,a[V+4>>2]=h,V=d+-1|0,C){C=0,P=1,b=W,A=h;do{if(b=ge(b,A,2,X)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=w+(P<<3)|0,a[B>>2]=b,a[B+4>>2]=A,P=P+1|0,zr(b,A)|0){A=1;break e}C=C+1|0}while((C|0)<(d|0));B=0,C=P;do{if(b=ge(b,A,3,X)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(P=w+(C<<3)|0,a[P>>2]=b,a[P+4>>2]=A,C=C+1|0,zr(b,A)|0){A=1;break e}B=B+1|0}while((B|0)<(d|0));P=0;do{if(b=ge(b,A,1,X)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=w+(C<<3)|0,a[B>>2]=b,a[B+4>>2]=A,C=C+1|0,zr(b,A)|0){A=1;break e}P=P+1|0}while((P|0)<(d|0));P=0;do{if(b=ge(b,A,5,X)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=w+(C<<3)|0,a[B>>2]=b,a[B+4>>2]=A,C=C+1|0,zr(b,A)|0){A=1;break e}P=P+1|0}while((P|0)<(d|0));P=0;do{if(b=ge(b,A,4,X)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if(B=w+(C<<3)|0,a[B>>2]=b,a[B+4>>2]=A,C=C+1|0,zr(b,A)|0){A=1;break e}P=P+1|0}while((P|0)<(d|0));for(P=0;;){if(b=ge(b,A,6,X)|0,A=Oe()|0,(b|0)==0&(A|0)==0){A=2;break e}if((P|0)!=(V|0))if(B=w+(C<<3)|0,a[B>>2]=b,a[B+4>>2]=A,!(zr(b,A)|0))C=C+1|0;else{A=1;break e}if(P=P+1|0,(P|0)>=(d|0)){P=W,C=h;break}}}else P=W,b=W,C=h,A=h}else P=w,a[P>>2]=A,a[P+4>>2]=h,P=A,b=A,C=h,A=h;A=((P|0)!=(b|0)|(C|0)!=(A|0))&1}while(0);return X=A,De=ae,X|0}function Ne(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0;if(C=De,De=De+48|0,b=C+8|0,w=C,B=A,P=a[B+4>>2]|0,d=w,a[d>>2]=a[B>>2],a[d+4>>2]=P,rl(w,b),b=Xn(b,h)|0,h=a[w>>2]|0,w=a[A+8>>2]|0,(w|0)<=0)return B=h,P=(b|0)<(B|0),B=P?B:b,B=B+12|0,De=C,B|0;d=a[A+12>>2]|0,A=0;do h=(a[d+(A<<3)>>2]|0)+h|0,A=A+1|0;while((A|0)<(w|0));return B=(b|0)<(h|0),B=B?h:b,B=B+12|0,De=C,B|0}function lt(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0;if(B=De,De=De+48|0,w=B+8|0,b=B,!(bt(A,h,d)|0)){De=B;return}if(V=A,C=a[V+4>>2]|0,P=b,a[P>>2]=a[V>>2],a[P+4>>2]=C,rl(b,w),P=Xn(w,h)|0,h=a[b>>2]|0,C=a[A+8>>2]|0,(C|0)>0){b=a[A+12>>2]|0,w=0;do h=(a[b+(w<<3)>>2]|0)+h|0,w=w+1|0;while((w|0)!=(C|0))}if(h=(P|0)<(h|0)?h:P,(h|0)<=-12){De=B;return}V=h+11|0,L(d|0,0,(((V|0)>0?V:0)<<3)+8|0)|0,De=B}function bt(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0,Ge=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0;if(de=De,De=De+112|0,U=de+80|0,V=de+72|0,q=de,ee=de+56|0,W=A+8|0,le=Kt((a[W>>2]<<5)+32|0)|0,le||Mt(22848,22448,800,22456),Qs(A,le),C=A,w=a[C+4>>2]|0,B=V,a[B>>2]=a[C>>2],a[B+4>>2]=w,rl(V,U),B=Xn(U,h)|0,w=a[V>>2]|0,C=a[W>>2]|0,(C|0)>0){P=a[A+12>>2]|0,b=0;do w=(a[P+(b<<3)>>2]|0)+w|0,b=b+1|0;while((b|0)!=(C|0))}if(B=(B|0)<(w|0)?w:B,O=B+12|0,b=es(O,8)|0,X=es(O,8)|0,a[U>>2]=0,I=A,R=a[I+4>>2]|0,w=V,a[w>>2]=a[I>>2],a[w+4>>2]=R,w=Qt(V,O,h,U,b,X)|0,w|0)return fn(b),fn(X),fn(le),le=w,De=de,le|0;e:do if((a[W>>2]|0)>0){for(C=A+12|0,w=0;P=Qt((a[C>>2]|0)+(w<<3)|0,O,h,U,b,X)|0,w=w+1|0,!(P|0);)if((w|0)>=(a[W>>2]|0))break e;return fn(b),fn(X),fn(le),le=P,De=de,le|0}while(0);(B|0)>-12&&L(X|0,0,((O|0)>1?O:1)<<3|0)|0;e:do if((a[U>>2]|0)>0){R=((O|0)<0)<<31>>31,xe=b,y=X,m=b,x=b,E=X,I=b,w=b,ve=b,$e=X,Se=X,Ge=X,b=X;t:for(;;){for(Me=a[U>>2]|0,ue=0,be=0,C=0;;){P=q,B=P+56|0;do a[P>>2]=0,P=P+4|0;while((P|0)<(B|0));if(h=xe+(ue<<3)|0,V=a[h>>2]|0,h=a[h+4>>2]|0,ma(V,h,1,q,0)|0){P=q,B=P+56|0;do a[P>>2]=0,P=P+4|0;while((P|0)<(B|0));P=es(7,4)|0,P|0&&(ii(V,h,1,q,P,7,0),fn(P))}ne=0;do{ae=q+(ne<<3)|0,X=a[ae>>2]|0,ae=a[ae+4>>2]|0;n:do if(!((X|0)==0&(ae|0)==0)){if(V=Ys(X|0,ae|0,O|0,R|0)|0,Oe()|0,P=d+(V<<3)|0,B=P,h=a[B>>2]|0,B=a[B+4>>2]|0,!((h|0)==0&(B|0)==0))for(W=0;;){if((W|0)>(O|0))break t;if((h|0)==(X|0)&(B|0)==(ae|0))break n;if(V=(V+1|0)%(O|0)|0,P=d+(V<<3)|0,B=P,h=a[B>>2]|0,B=a[B+4>>2]|0,(h|0)==0&(B|0)==0)break;W=W+1|0}(X|0)==0&(ae|0)==0||(Ws(X,ae,ee),yu(A,le,ee)|0&&(W=P,a[W>>2]=X,a[W+4>>2]=ae,W=y+(C<<3)|0,a[W>>2]=X,a[W+4>>2]=ae,C=C+1|0))}while(0);ne=ne+1|0}while(ne>>>0<7);if(be=be+1|0,(be|0)>=(Me|0))break;ue=ue+1|0}if((Me|0)>0&&L(m|0,0,Me<<3|0)|0,a[U>>2]=C,(C|0)>0)X=b,ae=Ge,ne=I,ue=Se,be=$e,Me=y,b=ve,Ge=w,Se=x,$e=m,ve=X,w=ae,I=E,E=ne,x=ue,m=be,y=xe,xe=Me;else break e}return fn(x),fn(E),fn(le),le=-1,De=de,le|0}else w=X;while(0);return fn(le),fn(b),fn(w),le=0,De=de,le|0}function Qt(A,h,d,w,b,C){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0,C=C|0;var P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0,Ge=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0,U=0;if(R=De,De=De+48|0,m=R+32|0,x=R+16|0,E=R,P=a[A>>2]|0,(P|0)<=0)return I=0,De=R,I|0;$e=A+4|0,Se=m+8|0,Ge=x+8|0,xe=E+8|0,y=((h|0)<0)<<31>>31,ve=0;e:for(;;){B=a[$e>>2]|0,be=B+(ve<<4)|0,a[m>>2]=a[be>>2],a[m+4>>2]=a[be+4>>2],a[m+8>>2]=a[be+8>>2],a[m+12>>2]=a[be+12>>2],(ve|0)==(P+-1|0)?(a[x>>2]=a[B>>2],a[x+4>>2]=a[B+4>>2],a[x+8>>2]=a[B+8>>2],a[x+12>>2]=a[B+12>>2]):(be=B+(ve+1<<4)|0,a[x>>2]=a[be>>2],a[x+4>>2]=a[be+4>>2],a[x+8>>2]=a[be+8>>2],a[x+12>>2]=a[be+12>>2]),be=ou(m,x,d)|0;t:do if((be|0)>0){Me=+(be|0),ue=0;n:for(;;){U=+(be-ue|0),O=+(ue|0),G[E>>3]=+G[m>>3]*U/Me+ +G[x>>3]*O/Me,G[xe>>3]=+G[Se>>3]*U/Me+ +G[Ge>>3]*O/Me,ae=Ka(E,d)|0,ne=Oe()|0,B=Ys(ae|0,ne|0,h|0,y|0)|0,Oe()|0,P=C+(B<<3)|0,V=P,W=a[V>>2]|0,V=a[V+4>>2]|0;r:do if((W|0)==0&(V|0)==0)I=14;else for(X=0;;){if((X|0)>(h|0)){P=1;break r}if((W|0)==(ae|0)&(V|0)==(ne|0)){P=7;break r}if(B=(B+1|0)%(h|0)|0,P=C+(B<<3)|0,V=P,W=a[V>>2]|0,V=a[V+4>>2]|0,(W|0)==0&(V|0)==0){I=14;break}else X=X+1|0}while(0);switch((I|0)==14&&(I=0,(ae|0)==0&(ne|0)==0?P=7:(a[P>>2]=ae,a[P+4>>2]=ne,P=a[w>>2]|0,X=b+(P<<3)|0,a[X>>2]=ae,a[X+4>>2]=ne,a[w>>2]=P+1,P=0)),P&7){case 7:case 0:break;default:break n}if(ue=ue+1|0,(be|0)<=(ue|0)){I=8;break t}}if(P|0){P=-1,I=20;break e}}else I=8;while(0);if((I|0)==8&&(I=0),ve=ve+1|0,P=a[A>>2]|0,(ve|0)>=(P|0)){P=0,I=20;break}}return(I|0)==20?(De=R,P|0):0}function Ln(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0,W=0;if(W=De,De=De+176|0,V=W,(h|0)<1){Mr(d,0,0),De=W;return}P=A,P=Ct(a[P>>2]|0,a[P+4>>2]|0,52)|0,Oe()|0,Mr(d,(h|0)>6?h:6,P&15),P=0;do{if(w=A+(P<<3)|0,fs(a[w>>2]|0,a[w+4>>2]|0,V),w=a[V>>2]|0,(w|0)>0){B=0;do C=V+8+(B<<4)|0,B=B+1|0,w=V+8+(((B|0)%(w|0)|0)<<4)|0,b=Eu(d,w,C)|0,b?bu(d,b)|0:Sc(d,C,w)|0,w=a[V>>2]|0;while((B|0)<(w|0))}P=P+1|0}while((P|0)!=(h|0));De=W}function Dr(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0;if(C=De,De=De+32|0,w=C,b=C+16|0,Ln(A,h,b),a[d>>2]=0,a[d+4>>2]=0,a[d+8>>2]=0,A=Hl(b)|0,!A){Ea(d)|0,il(b),De=C;return}do{h=Th(d)|0;do Sh(h,A)|0,P=A+16|0,a[w>>2]=a[P>>2],a[w+4>>2]=a[P+4>>2],a[w+8>>2]=a[P+8>>2],a[w+12>>2]=a[P+12>>2],bu(b,A)|0,A=Cc(b,w)|0;while(A|0);A=Hl(b)|0}while(A|0);Ea(d)|0,il(b),De=C}function en(A){return A=A|0,a[7728+(A*28|0)+16>>2]|0}function Br(A){return A=A|0,(A|0)==4|(A|0)==117|0}function Gn(A){return A=A|0,a[11152+((a[A>>2]|0)*216|0)+((a[A+4>>2]|0)*72|0)+((a[A+8>>2]|0)*24|0)+(a[A+12>>2]<<3)>>2]|0}function vA(A){return A=A|0,a[11152+((a[A>>2]|0)*216|0)+((a[A+4>>2]|0)*72|0)+((a[A+8>>2]|0)*24|0)+(a[A+12>>2]<<3)+4>>2]|0}function xA(A,h){A=A|0,h=h|0,A=7728+(A*28|0)|0,a[h>>2]=a[A>>2],a[h+4>>2]=a[A+4>>2],a[h+8>>2]=a[A+8>>2],a[h+12>>2]=a[A+12>>2]}function wA(A,h){A=A|0,h=h|0;var d=0,w=0;if(h>>>0>20)return h=-1,h|0;do if((a[11152+(h*216|0)>>2]|0)!=(A|0))if((a[11152+(h*216|0)+8>>2]|0)!=(A|0))if((a[11152+(h*216|0)+16>>2]|0)!=(A|0))if((a[11152+(h*216|0)+24>>2]|0)!=(A|0))if((a[11152+(h*216|0)+32>>2]|0)!=(A|0))if((a[11152+(h*216|0)+40>>2]|0)!=(A|0))if((a[11152+(h*216|0)+48>>2]|0)!=(A|0))if((a[11152+(h*216|0)+56>>2]|0)!=(A|0))if((a[11152+(h*216|0)+64>>2]|0)!=(A|0))if((a[11152+(h*216|0)+72>>2]|0)!=(A|0))if((a[11152+(h*216|0)+80>>2]|0)!=(A|0))if((a[11152+(h*216|0)+88>>2]|0)!=(A|0))if((a[11152+(h*216|0)+96>>2]|0)!=(A|0))if((a[11152+(h*216|0)+104>>2]|0)!=(A|0))if((a[11152+(h*216|0)+112>>2]|0)!=(A|0))if((a[11152+(h*216|0)+120>>2]|0)!=(A|0))if((a[11152+(h*216|0)+128>>2]|0)!=(A|0))if((a[11152+(h*216|0)+136>>2]|0)==(A|0))A=2,d=1,w=2;else{if((a[11152+(h*216|0)+144>>2]|0)==(A|0)){A=0,d=2,w=0;break}if((a[11152+(h*216|0)+152>>2]|0)==(A|0)){A=0,d=2,w=1;break}if((a[11152+(h*216|0)+160>>2]|0)==(A|0)){A=0,d=2,w=2;break}if((a[11152+(h*216|0)+168>>2]|0)==(A|0)){A=1,d=2,w=0;break}if((a[11152+(h*216|0)+176>>2]|0)==(A|0)){A=1,d=2,w=1;break}if((a[11152+(h*216|0)+184>>2]|0)==(A|0)){A=1,d=2,w=2;break}if((a[11152+(h*216|0)+192>>2]|0)==(A|0)){A=2,d=2,w=0;break}if((a[11152+(h*216|0)+200>>2]|0)==(A|0)){A=2,d=2,w=1;break}if((a[11152+(h*216|0)+208>>2]|0)==(A|0)){A=2,d=2,w=2;break}else A=-1;return A|0}else A=2,d=1,w=1;else A=2,d=1,w=0;else A=1,d=1,w=2;else A=1,d=1,w=1;else A=1,d=1,w=0;else A=0,d=1,w=2;else A=0,d=1,w=1;else A=0,d=1,w=0;else A=2,d=0,w=2;else A=2,d=0,w=1;else A=2,d=0,w=0;else A=1,d=0,w=2;else A=1,d=0,w=1;else A=1,d=0,w=0;else A=0,d=0,w=2;else A=0,d=0,w=1;else A=0,d=0,w=0;while(0);return h=a[11152+(h*216|0)+(d*72|0)+(A*24|0)+(w<<3)+4>>2]|0,h|0}function iu(A,h){return A=A|0,h=h|0,(a[7728+(A*28|0)+20>>2]|0)==(h|0)?(h=1,h|0):(h=(a[7728+(A*28|0)+24>>2]|0)==(h|0),h|0)}function su(A,h){return A=A|0,h=h|0,a[880+(A*28|0)+(h<<2)>>2]|0}function bA(A,h){return A=A|0,h=h|0,(a[880+(A*28|0)>>2]|0)==(h|0)?(h=0,h|0):(a[880+(A*28|0)+4>>2]|0)==(h|0)?(h=1,h|0):(a[880+(A*28|0)+8>>2]|0)==(h|0)?(h=2,h|0):(a[880+(A*28|0)+12>>2]|0)==(h|0)?(h=3,h|0):(a[880+(A*28|0)+16>>2]|0)==(h|0)?(h=4,h|0):(a[880+(A*28|0)+20>>2]|0)==(h|0)?(h=5,h|0):((a[880+(A*28|0)+24>>2]|0)==(h|0)?6:7)|0}function Pl(){return 122}function kl(A){A=A|0;var h=0,d=0,w=0;h=0;do Pt(h|0,0,45)|0,w=Oe()|0|134225919,d=A+(h<<3)|0,a[d>>2]=-1,a[d+4>>2]=w,h=h+1|0;while((h|0)!=122)}function EA(A){return A=A|0,+G[A+16>>3]<+G[A+24>>3]|0}function TA(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;return d=+G[h>>3],!(d>=+G[A+8>>3])||!(d<=+G[A>>3])?(h=0,h|0):(w=+G[A+16>>3],d=+G[A+24>>3],b=+G[h+8>>3],h=b>=d,A=b<=w&1,w<d?h&&(A=1):h||(A=0),h=(A|0)!=0,h|0)}function Xn(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0;P=De,De=De+288|0,d=P+264|0,w=P+96|0,b=P,C=b,B=C+96|0;do a[C>>2]=0,C=C+4|0;while((C|0)<(B|0));return ai(h,b),C=b,B=a[C>>2]|0,C=a[C+4>>2]|0,Ws(B,C,d),fs(B,C,w),V=+qn(d,w+8|0),G[d>>3]=+G[A>>3],C=d+8|0,G[C>>3]=+G[A+16>>3],G[w>>3]=+G[A+8>>3],B=w+8|0,G[B>>3]=+G[A+24>>3],W=+qn(d,w),B=~~+pn(+(W*W/+Wr(+ +Pe(+((+G[C>>3]-+G[B>>3])/(+G[d>>3]-+G[w>>3]))),3)/(V*(V*2.59807621135)*.8))),De=P,(B|0?B:1)|0}function ou(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0,W=0;B=De,De=De+288|0,w=B+264|0,b=B+96|0,C=B,P=C,V=P+96|0;do a[P>>2]=0,P=P+4|0;while((P|0)<(V|0));return ai(d,C),V=C,P=a[V>>2]|0,V=a[V+4>>2]|0,Ws(P,V,w),fs(P,V,b),W=+qn(w,b+8|0),V=~~+pn(+(+qn(A,h)/(W*2))),De=B,(V|0?V:1)|0}function gc(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0,a[A>>2]=h,a[A+4>>2]=d,a[A+8>>2]=w}function Il(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0;ae=h+8|0,a[ae>>2]=0,V=+G[A>>3],P=+Pe(+V),W=+G[A+8>>3],B=+Pe(+W)/.8660254037844386,P=P+B*.5,d=~~P,A=~~B,P=P-+(d|0),B=B-+(A|0);do if(P<.5)if(P<.3333333333333333)if(a[h>>2]=d,B<(P+1)*.5){a[h+4>>2]=A;break}else{A=A+1|0,a[h+4>>2]=A;break}else if(ne=1-P,A=(!(B<ne)&1)+A|0,a[h+4>>2]=A,ne<=B&B<P*2){d=d+1|0,a[h>>2]=d;break}else{a[h>>2]=d;break}else{if(!(P<.6666666666666666))if(d=d+1|0,a[h>>2]=d,B<P*.5){a[h+4>>2]=A;break}else{A=A+1|0,a[h+4>>2]=A;break}if(B<1-P){if(a[h+4>>2]=A,P*2+-1<B){a[h>>2]=d;break}}else A=A+1|0,a[h+4>>2]=A;d=d+1|0,a[h>>2]=d}while(0);do if(V<0)if(A&1){X=(A+1|0)/2|0,X=Hr(d|0,((d|0)<0)<<31>>31|0,X|0,((X|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-((+(X>>>0)+4294967296*+(Oe()|0))*2+1)),a[h>>2]=d;break}else{X=(A|0)/2|0,X=Hr(d|0,((d|0)<0)<<31>>31|0,X|0,((X|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-(+(X>>>0)+4294967296*+(Oe()|0))*2),a[h>>2]=d;break}while(0);X=h+4|0,W<0&&(d=d-((A<<1|1|0)/2|0)|0,a[h>>2]=d,A=0-A|0,a[X>>2]=A),w=A-d|0,(d|0)<0?(b=0-d|0,a[X>>2]=w,a[ae>>2]=b,a[h>>2]=0,A=w,d=0):b=0,(A|0)<0&&(d=d-A|0,a[h>>2]=d,b=b-A|0,a[ae>>2]=b,a[X>>2]=0,A=0),C=d-b|0,w=A-b|0,(b|0)<0&&(a[h>>2]=C,a[X>>2]=w,a[ae>>2]=0,A=w,d=C,b=0),w=(A|0)<(d|0)?A:d,w=(b|0)<(w|0)?b:w,!((w|0)<=0)&&(a[h>>2]=d-w,a[X>>2]=A-w,a[ae>>2]=b-w)}function Yr(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0;h=a[A>>2]|0,P=A+4|0,d=a[P>>2]|0,(h|0)<0&&(d=d-h|0,a[P>>2]=d,C=A+8|0,a[C>>2]=(a[C>>2]|0)-h,a[A>>2]=0,h=0),(d|0)<0?(h=h-d|0,a[A>>2]=h,C=A+8|0,b=(a[C>>2]|0)-d|0,a[C>>2]=b,a[P>>2]=0,d=0):(b=A+8|0,C=b,b=a[b>>2]|0),(b|0)<0&&(h=h-b|0,a[A>>2]=h,d=d-b|0,a[P>>2]=d,a[C>>2]=0,b=0),w=(d|0)<(h|0)?d:h,w=(b|0)<(w|0)?b:w,!((w|0)<=0)&&(a[A>>2]=h-w,a[P>>2]=d-w,a[C>>2]=b-w)}function Ho(A,h){A=A|0,h=h|0;var d=0,w=0;w=a[A+8>>2]|0,d=+((a[A+4>>2]|0)-w|0),G[h>>3]=+((a[A>>2]|0)-w|0)-d*.5,G[h+8>>3]=d*.8660254037844386}function zn(A,h,d){A=A|0,h=h|0,d=d|0,a[d>>2]=(a[h>>2]|0)+(a[A>>2]|0),a[d+4>>2]=(a[h+4>>2]|0)+(a[A+4>>2]|0),a[d+8>>2]=(a[h+8>>2]|0)+(a[A+8>>2]|0)}function Cs(A,h,d){A=A|0,h=h|0,d=d|0,a[d>>2]=(a[A>>2]|0)-(a[h>>2]|0),a[d+4>>2]=(a[A+4>>2]|0)-(a[h+4>>2]|0),a[d+8>>2]=(a[A+8>>2]|0)-(a[h+8>>2]|0)}function si(A,h){A=A|0,h=h|0;var d=0,w=0;d=qt(a[A>>2]|0,h)|0,a[A>>2]=d,d=A+4|0,w=qt(a[d>>2]|0,h)|0,a[d>>2]=w,A=A+8|0,h=qt(a[A>>2]|0,h)|0,a[A>>2]=h}function _o(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;P=a[A>>2]|0,B=(P|0)<0,w=(a[A+4>>2]|0)-(B?P:0)|0,C=(w|0)<0,b=(C?0-w|0:0)+((a[A+8>>2]|0)-(B?P:0))|0,d=(b|0)<0,A=d?0:b,h=(C?0:w)-(d?b:0)|0,b=(B?0:P)-(C?w:0)-(d?b:0)|0,d=(h|0)<(b|0)?h:b,d=(A|0)<(d|0)?A:d,w=(d|0)>0,A=A-(w?d:0)|0,h=h-(w?d:0)|0;e:do switch(b-(w?d:0)|0){case 0:switch(h|0){case 0:return B=A|0?(A|0)==1?1:7:0,B|0;case 1:return B=A|0?(A|0)==1?3:7:2,B|0;default:break e}case 1:switch(h|0){case 0:return B=A|0?(A|0)==1?5:7:4,B|0;case 1:{if(!A)A=6;else break e;return A|0}default:break e}}while(0);return B=7,B|0}function Ll(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;P=A+8|0,d=a[P>>2]|0,h=(a[A>>2]|0)-d|0,B=A+4|0,d=(a[B>>2]|0)-d|0,w=Xt(+((h*3|0)-d|0)/7)|0,a[A>>2]=w,h=Xt(+((d<<1)+h|0)/7)|0,a[B>>2]=h,a[P>>2]=0,d=h-w|0,(w|0)<0?(C=0-w|0,a[B>>2]=d,a[P>>2]=C,a[A>>2]=0,h=d,w=0,d=C):d=0,(h|0)<0&&(w=w-h|0,a[A>>2]=w,d=d-h|0,a[P>>2]=d,a[B>>2]=0,h=0),C=w-d|0,b=h-d|0,(d|0)<0?(a[A>>2]=C,a[B>>2]=b,a[P>>2]=0,h=b,b=C,d=0):b=w,w=(h|0)<(b|0)?h:b,w=(d|0)<(w|0)?d:w,!((w|0)<=0)&&(a[A>>2]=b-w,a[B>>2]=h-w,a[P>>2]=d-w)}function Wo(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;P=A+8|0,d=a[P>>2]|0,h=(a[A>>2]|0)-d|0,B=A+4|0,d=(a[B>>2]|0)-d|0,w=Xt(+((h<<1)+d|0)/7)|0,a[A>>2]=w,h=Xt(+((d*3|0)-h|0)/7)|0,a[B>>2]=h,a[P>>2]=0,d=h-w|0,(w|0)<0?(C=0-w|0,a[B>>2]=d,a[P>>2]=C,a[A>>2]=0,h=d,w=0,d=C):d=0,(h|0)<0&&(w=w-h|0,a[A>>2]=w,d=d-h|0,a[P>>2]=d,a[B>>2]=0,h=0),C=w-d|0,b=h-d|0,(d|0)<0?(a[A>>2]=C,a[B>>2]=b,a[P>>2]=0,h=b,b=C,d=0):b=w,w=(h|0)<(b|0)?h:b,w=(d|0)<(w|0)?d:w,!((w|0)<=0)&&(a[A>>2]=b-w,a[B>>2]=h-w,a[P>>2]=d-w)}function ya(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;h=a[A>>2]|0,P=A+4|0,d=a[P>>2]|0,B=A+8|0,w=a[B>>2]|0,b=d+(h*3|0)|0,a[A>>2]=b,d=w+(d*3|0)|0,a[P>>2]=d,h=(w*3|0)+h|0,a[B>>2]=h,w=d-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=w,a[B>>2]=h,a[A>>2]=0,d=w,w=0):w=b,(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),C=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=C,a[P>>2]=b,a[B>>2]=0,w=C,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[P>>2]=b-d,a[B>>2]=h-d)}function vo(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;b=a[A>>2]|0,P=A+4|0,h=a[P>>2]|0,B=A+8|0,d=a[B>>2]|0,w=(h*3|0)+b|0,b=d+(b*3|0)|0,a[A>>2]=b,a[P>>2]=w,h=(d*3|0)+h|0,a[B>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=d,a[B>>2]=h,a[A>>2]=0,b=0):d=w,(d|0)<0&&(b=b-d|0,a[A>>2]=b,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),C=b-h|0,w=d-h|0,(h|0)<0?(a[A>>2]=C,a[P>>2]=w,a[B>>2]=0,b=C,h=0):w=d,d=(w|0)<(b|0)?w:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=b-d,a[P>>2]=w-d,a[B>>2]=h-d)}function SA(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0;(h+-1|0)>>>0>=6||(b=(a[15472+(h*12|0)>>2]|0)+(a[A>>2]|0)|0,a[A>>2]=b,B=A+4|0,w=(a[15472+(h*12|0)+4>>2]|0)+(a[B>>2]|0)|0,a[B>>2]=w,P=A+8|0,h=(a[15472+(h*12|0)+8>>2]|0)+(a[P>>2]|0)|0,a[P>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[B>>2]=d,a[P>>2]=h,a[A>>2]=0,w=0):(d=w,w=b),(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[P>>2]=h,a[B>>2]=0,d=0),C=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=C,a[B>>2]=b,a[P>>2]=0,w=C,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[B>>2]=b-d,a[P>>2]=h-d))}function qa(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;b=a[A>>2]|0,P=A+4|0,h=a[P>>2]|0,B=A+8|0,d=a[B>>2]|0,w=h+b|0,b=d+b|0,a[A>>2]=b,a[P>>2]=w,h=d+h|0,a[B>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=d,a[B>>2]=h,a[A>>2]=0,w=0):(d=w,w=b),(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),C=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=C,a[P>>2]=b,a[B>>2]=0,w=C,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[P>>2]=b-d,a[B>>2]=h-d)}function Qo(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;h=a[A>>2]|0,P=A+4|0,w=a[P>>2]|0,B=A+8|0,d=a[B>>2]|0,b=w+h|0,a[A>>2]=b,w=d+w|0,a[P>>2]=w,h=d+h|0,a[B>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=d,a[B>>2]=h,a[A>>2]=0,w=0):(d=w,w=b),(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),C=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=C,a[P>>2]=b,a[B>>2]=0,w=C,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[P>>2]=b-d,a[B>>2]=h-d)}function Wi(A){switch(A=A|0,A|0){case 1:{A=5;break}case 5:{A=4;break}case 4:{A=6;break}case 6:{A=2;break}case 2:{A=3;break}case 3:{A=1;break}}return A|0}function Qi(A){switch(A=A|0,A|0){case 1:{A=3;break}case 3:{A=2;break}case 2:{A=6;break}case 6:{A=4;break}case 4:{A=5;break}case 5:{A=1;break}}return A|0}function au(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;h=a[A>>2]|0,P=A+4|0,d=a[P>>2]|0,B=A+8|0,w=a[B>>2]|0,b=d+(h<<1)|0,a[A>>2]=b,d=w+(d<<1)|0,a[P>>2]=d,h=(w<<1)+h|0,a[B>>2]=h,w=d-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=w,a[B>>2]=h,a[A>>2]=0,d=w,w=0):w=b,(d|0)<0&&(w=w-d|0,a[A>>2]=w,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),C=w-h|0,b=d-h|0,(h|0)<0?(a[A>>2]=C,a[P>>2]=b,a[B>>2]=0,w=C,h=0):b=d,d=(b|0)<(w|0)?b:w,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=w-d,a[P>>2]=b-d,a[B>>2]=h-d)}function Dl(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;b=a[A>>2]|0,P=A+4|0,h=a[P>>2]|0,B=A+8|0,d=a[B>>2]|0,w=(h<<1)+b|0,b=d+(b<<1)|0,a[A>>2]=b,a[P>>2]=w,h=(d<<1)+h|0,a[B>>2]=h,d=w-b|0,(b|0)<0?(h=h-b|0,a[P>>2]=d,a[B>>2]=h,a[A>>2]=0,b=0):d=w,(d|0)<0&&(b=b-d|0,a[A>>2]=b,h=h-d|0,a[B>>2]=h,a[P>>2]=0,d=0),C=b-h|0,w=d-h|0,(h|0)<0?(a[A>>2]=C,a[P>>2]=w,a[B>>2]=0,b=C,h=0):w=d,d=(w|0)<(b|0)?w:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[A>>2]=b-d,a[P>>2]=w-d,a[B>>2]=h-d)}function xo(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0;return P=(a[A>>2]|0)-(a[h>>2]|0)|0,B=(P|0)<0,w=(a[A+4>>2]|0)-(a[h+4>>2]|0)-(B?P:0)|0,C=(w|0)<0,b=(B?0-P|0:0)+(a[A+8>>2]|0)-(a[h+8>>2]|0)+(C?0-w|0:0)|0,A=(b|0)<0,h=A?0:b,d=(C?0:w)-(A?b:0)|0,b=(B?0:P)-(C?w:0)-(A?b:0)|0,A=(d|0)<(b|0)?d:b,A=(h|0)<(A|0)?h:A,w=(A|0)>0,h=h-(w?A:0)|0,d=d-(w?A:0)|0,A=b-(w?A:0)|0,A=(A|0)>-1?A:0-A|0,d=(d|0)>-1?d:0-d|0,h=(h|0)>-1?h:0-h|0,h=(d|0)>(h|0)?d:h,((A|0)>(h|0)?A:h)|0}function qo(A,h){A=A|0,h=h|0;var d=0;d=a[A+8>>2]|0,a[h>>2]=(a[A>>2]|0)-d,a[h+4>>2]=(a[A+4>>2]|0)-d}function mc(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0;w=a[A>>2]|0,a[h>>2]=w,A=a[A+4>>2]|0,P=h+4|0,a[P>>2]=A,B=h+8|0,a[B>>2]=0,d=A-w|0,(w|0)<0?(A=0-w|0,a[P>>2]=d,a[B>>2]=A,a[h>>2]=0,w=0):(d=A,A=0),(d|0)<0&&(w=w-d|0,a[h>>2]=w,A=A-d|0,a[B>>2]=A,a[P>>2]=0,d=0),C=w-A|0,b=d-A|0,(A|0)<0?(a[h>>2]=C,a[P>>2]=b,a[B>>2]=0,d=b,b=C,A=0):b=w,w=(d|0)<(b|0)?d:b,w=(A|0)<(w|0)?A:w,!((w|0)<=0)&&(a[h>>2]=b-w,a[P>>2]=d-w,a[B>>2]=A-w)}function lu(A){A=A|0;var h=0,d=0,w=0,b=0;h=A+8|0,b=a[h>>2]|0,d=b-(a[A>>2]|0)|0,a[A>>2]=d,w=A+4|0,A=(a[w>>2]|0)-b|0,a[w>>2]=A,a[h>>2]=0-(A+d)}function Rl(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;d=a[A>>2]|0,h=0-d|0,a[A>>2]=h,P=A+8|0,a[P>>2]=0,B=A+4|0,w=a[B>>2]|0,b=w+d|0,(d|0)>0?(a[B>>2]=b,a[P>>2]=d,a[A>>2]=0,h=0,w=b):d=0,(w|0)<0?(C=h-w|0,a[A>>2]=C,d=d-w|0,a[P>>2]=d,a[B>>2]=0,b=C-d|0,h=0-d|0,(d|0)<0?(a[A>>2]=b,a[B>>2]=h,a[P>>2]=0,w=h,d=0):(w=0,b=C)):b=h,h=(w|0)<(b|0)?w:b,h=(d|0)<(h|0)?d:h,!((h|0)<=0)&&(a[A>>2]=b-h,a[B>>2]=w-h,a[P>>2]=d-h)}function CA(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;w=De,De=De+16|0,b=w,Au(A,h,d,b),Il(b,d+4|0),De=w}function Au(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0,B=0,V=0;if(V=De,De=De+32|0,C=V,jl(A,C),a[d>>2]=0,b=+Ur(15888,C),P=+Ur(15912,C),P<b&&(a[d>>2]=1,b=P),P=+Ur(15936,C),P<b&&(a[d>>2]=2,b=P),P=+Ur(15960,C),P<b&&(a[d>>2]=3,b=P),P=+Ur(15984,C),P<b&&(a[d>>2]=4,b=P),P=+Ur(16008,C),P<b&&(a[d>>2]=5,b=P),P=+Ur(16032,C),P<b&&(a[d>>2]=6,b=P),P=+Ur(16056,C),P<b&&(a[d>>2]=7,b=P),P=+Ur(16080,C),P<b&&(a[d>>2]=8,b=P),P=+Ur(16104,C),P<b&&(a[d>>2]=9,b=P),P=+Ur(16128,C),P<b&&(a[d>>2]=10,b=P),P=+Ur(16152,C),P<b&&(a[d>>2]=11,b=P),P=+Ur(16176,C),P<b&&(a[d>>2]=12,b=P),P=+Ur(16200,C),P<b&&(a[d>>2]=13,b=P),P=+Ur(16224,C),P<b&&(a[d>>2]=14,b=P),P=+Ur(16248,C),P<b&&(a[d>>2]=15,b=P),P=+Ur(16272,C),P<b&&(a[d>>2]=16,b=P),P=+Ur(16296,C),P<b&&(a[d>>2]=17,b=P),P=+Ur(16320,C),P<b&&(a[d>>2]=18,b=P),P=+Ur(16344,C),P<b&&(a[d>>2]=19,b=P),P=+Dt(+(1-b*.5)),P<1e-16){a[w>>2]=0,a[w+4>>2]=0,a[w+8>>2]=0,a[w+12>>2]=0,De=V;return}if(d=a[d>>2]|0,b=+G[16368+(d*24|0)>>3],b=+fr(b-+fr(+pr(15568+(d<<4)|0,A))),mi(h)|0?B=+fr(b+-.3334731722518321):B=b,b=+dt(+P)/.381966011250105,(h|0)>0){C=0;do b=b*2.6457513110645907,C=C+1|0;while((C|0)!=(h|0))}P=+At(+B)*b,G[w>>3]=P,B=+We(+B)*b,G[w+8>>3]=B,De=V}function Zo(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0;if(C=+To(A),C<1e-16){h=15568+(h<<4)|0,a[b>>2]=a[h>>2],a[b+4>>2]=a[h+4>>2],a[b+8>>2]=a[h+8>>2],a[b+12>>2]=a[h+12>>2];return}if(P=+jt(+ +G[A+8>>3],+ +G[A>>3]),(d|0)>0){A=0;do C=C/2.6457513110645907,A=A+1|0;while((A|0)!=(d|0))}w?(C=C/3,d=(mi(d)|0)==0,C=+sn(+((d?C:C/2.6457513110645907)*.381966011250105))):(C=+sn(+(C*.381966011250105)),mi(d)|0&&(P=+fr(P+.3334731722518321))),Bl(15568+(h<<4)|0,+fr(+G[16368+(h*24|0)>>3]-P),C,b)}function Za(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;w=De,De=De+16|0,b=w,Ho(A+4|0,b),Zo(b,a[A>>2]|0,h,0,d),De=w}function uu(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0,Ge=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0;if(ee=De,De=De+272|0,C=ee+256|0,Se=ee+240|0,O=ee,U=ee+224|0,q=ee+208|0,Ge=ee+176|0,xe=ee+160|0,y=ee+192|0,m=ee+144|0,x=ee+128|0,E=ee+112|0,I=ee+96|0,R=ee+80|0,a[C>>2]=h,a[Se>>2]=a[A>>2],a[Se+4>>2]=a[A+4>>2],a[Se+8>>2]=a[A+8>>2],a[Se+12>>2]=a[A+12>>2],cu(Se,C,O),a[b>>2]=0,Se=w+d+((w|0)==5&1)|0,(Se|0)<=(d|0)){De=ee;return}V=a[C>>2]|0,W=U+4|0,X=Ge+4|0,ae=d+5|0,ne=16848+(V<<2)|0,ue=16928+(V<<2)|0,be=x+8|0,Me=E+8|0,ve=I+8|0,$e=q+4|0,B=d;e:for(;;){P=O+(((B|0)%5|0)<<4)|0,a[q>>2]=a[P>>2],a[q+4>>2]=a[P+4>>2],a[q+8>>2]=a[P+8>>2],a[q+12>>2]=a[P+12>>2];do;while((wo(q,V,0,1)|0)==2);if((B|0)>(d|0)&(mi(h)|0)!=0){if(a[Ge>>2]=a[q>>2],a[Ge+4>>2]=a[q+4>>2],a[Ge+8>>2]=a[q+8>>2],a[Ge+12>>2]=a[q+12>>2],Ho(W,xe),w=a[Ge>>2]|0,C=a[17008+(w*80|0)+(a[U>>2]<<2)>>2]|0,a[Ge>>2]=a[18608+(w*80|0)+(C*20|0)>>2],P=a[18608+(w*80|0)+(C*20|0)+16>>2]|0,(P|0)>0){A=0;do qa(X),A=A+1|0;while((A|0)<(P|0))}switch(P=18608+(w*80|0)+(C*20|0)+4|0,a[y>>2]=a[P>>2],a[y+4>>2]=a[P+4>>2],a[y+8>>2]=a[P+8>>2],si(y,(a[ne>>2]|0)*3|0),zn(X,y,X),Yr(X),Ho(X,m),le=+(a[ue>>2]|0),G[x>>3]=le*3,G[be>>3]=0,de=le*-1.5,G[E>>3]=de,G[Me>>3]=le*2.598076211353316,G[I>>3]=de,G[ve>>3]=le*-2.598076211353316,a[17008+((a[Ge>>2]|0)*80|0)+(a[q>>2]<<2)>>2]|0){case 1:{A=E,w=x;break}case 3:{A=I,w=E;break}case 2:{A=x,w=I;break}default:{A=12;break e}}wu(xe,m,w,A,R),Zo(R,a[Ge>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1}if((B|0)<(ae|0)&&(Ho($e,Ge),Zo(Ge,a[q>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1),a[U>>2]=a[q>>2],a[U+4>>2]=a[q+4>>2],a[U+8>>2]=a[q+8>>2],a[U+12>>2]=a[q+12>>2],B=B+1|0,(B|0)>=(Se|0)){A=3;break}}if((A|0)==3){De=ee;return}else(A|0)==12&&Mt(22474,22521,581,22531)}function cu(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0;V=De,De=De+128|0,w=V+64|0,b=V,C=w,P=20208,B=C+60|0;do a[C>>2]=a[P>>2],C=C+4|0,P=P+4|0;while((C|0)<(B|0));C=b,P=20272,B=C+60|0;do a[C>>2]=a[P>>2],C=C+4|0,P=P+4|0;while((C|0)<(B|0));B=(mi(a[h>>2]|0)|0)==0,w=B?w:b,b=A+4|0,au(b),Dl(b),mi(a[h>>2]|0)|0&&(vo(b),a[h>>2]=(a[h>>2]|0)+1),a[d>>2]=a[A>>2],h=d+4|0,zn(b,w,h),Yr(h),a[d+16>>2]=a[A>>2],h=d+20|0,zn(b,w+12|0,h),Yr(h),a[d+32>>2]=a[A>>2],h=d+36|0,zn(b,w+24|0,h),Yr(h),a[d+48>>2]=a[A>>2],h=d+52|0,zn(b,w+36|0,h),Yr(h),a[d+64>>2]=a[A>>2],d=d+68|0,zn(b,w+48|0,d),Yr(d),De=V}function wo(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0;if(be=De,De=De+32|0,ne=be+12|0,B=be,ue=A+4|0,ae=a[16928+(h<<2)>>2]|0,X=(w|0)!=0,ae=X?ae*3|0:ae,b=a[ue>>2]|0,W=A+8|0,P=a[W>>2]|0,X){if(C=A+12|0,w=a[C>>2]|0,b=P+b+w|0,(b|0)==(ae|0))return ue=1,De=be,ue|0;V=C}else V=A+12|0,w=a[V>>2]|0,b=P+b+w|0;if((b|0)<=(ae|0))return ue=0,De=be,ue|0;do if((w|0)>0){if(w=a[A>>2]|0,(P|0)>0){C=18608+(w*80|0)+60|0,w=A;break}w=18608+(w*80|0)+40|0,d?(gc(ne,ae,0,0),Cs(ue,ne,B),Qo(B),zn(B,ne,ue),C=w,w=A):(C=w,w=A)}else C=18608+((a[A>>2]|0)*80|0)+20|0,w=A;while(0);if(a[w>>2]=a[C>>2],b=C+16|0,(a[b>>2]|0)>0){w=0;do qa(ue),w=w+1|0;while((w|0)<(a[b>>2]|0))}return A=C+4|0,a[ne>>2]=a[A>>2],a[ne+4>>2]=a[A+4>>2],a[ne+8>>2]=a[A+8>>2],h=a[16848+(h<<2)>>2]|0,si(ne,X?h*3|0:h),zn(ue,ne,ue),Yr(ue),X?w=((a[W>>2]|0)+(a[ue>>2]|0)+(a[V>>2]|0)|0)==(ae|0)?1:2:w=2,ue=w,De=be,ue|0}function _a(A,h){A=A|0,h=h|0;var d=0;do d=wo(A,h,0,1)|0;while((d|0)==2);return d|0}function hu(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0,Ge=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0;if(I=De,De=De+240|0,C=I+224|0,y=I+208|0,m=I,x=I+192|0,E=I+176|0,ve=I+160|0,$e=I+144|0,Se=I+128|0,Ge=I+112|0,xe=I+96|0,a[C>>2]=h,a[y>>2]=a[A>>2],a[y+4>>2]=a[A+4>>2],a[y+8>>2]=a[A+8>>2],a[y+12>>2]=a[A+12>>2],va(y,C,m),a[b>>2]=0,Me=w+d+((w|0)==6&1)|0,(Me|0)<=(d|0)){De=I;return}V=a[C>>2]|0,W=d+6|0,X=16928+(V<<2)|0,ae=$e+8|0,ne=Se+8|0,ue=Ge+8|0,be=x+4|0,P=0,B=d,w=-1;e:for(;;){if(C=(B|0)%6|0,A=m+(C<<4)|0,a[x>>2]=a[A>>2],a[x+4>>2]=a[A+4>>2],a[x+8>>2]=a[A+8>>2],a[x+12>>2]=a[A+12>>2],A=P,P=wo(x,V,0,1)|0,(B|0)>(d|0)&(mi(h)|0)!=0&&(A|0)!=1&&(a[x>>2]|0)!=(w|0)){switch(Ho(m+(((C+5|0)%6|0)<<4)+4|0,E),Ho(m+(C<<4)+4|0,ve),R=+(a[X>>2]|0),G[$e>>3]=R*3,G[ae>>3]=0,O=R*-1.5,G[Se>>3]=O,G[ne>>3]=R*2.598076211353316,G[Ge>>3]=O,G[ue>>3]=R*-2.598076211353316,C=a[y>>2]|0,a[17008+(C*80|0)+(((w|0)==(C|0)?a[x>>2]|0:w)<<2)>>2]|0){case 1:{A=Se,w=$e;break}case 3:{A=Ge,w=Se;break}case 2:{A=$e,w=Ge;break}default:{A=8;break e}}wu(E,ve,w,A,xe),!(Sa(E,xe)|0)&&!(Sa(ve,xe)|0)&&(Zo(xe,a[y>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1)}if((B|0)<(W|0)&&(Ho(be,E),Zo(E,a[x>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1),B=B+1|0,(B|0)>=(Me|0)){A=3;break}else w=a[x>>2]|0}if((A|0)==3){De=I;return}else(A|0)==8&&Mt(22557,22521,746,22602)}function va(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0;V=De,De=De+160|0,w=V+80|0,b=V,C=w,P=20336,B=C+72|0;do a[C>>2]=a[P>>2],C=C+4|0,P=P+4|0;while((C|0)<(B|0));C=b,P=20416,B=C+72|0;do a[C>>2]=a[P>>2],C=C+4|0,P=P+4|0;while((C|0)<(B|0));B=(mi(a[h>>2]|0)|0)==0,w=B?w:b,b=A+4|0,au(b),Dl(b),mi(a[h>>2]|0)|0&&(vo(b),a[h>>2]=(a[h>>2]|0)+1),a[d>>2]=a[A>>2],h=d+4|0,zn(b,w,h),Yr(h),a[d+16>>2]=a[A>>2],h=d+20|0,zn(b,w+12|0,h),Yr(h),a[d+32>>2]=a[A>>2],h=d+36|0,zn(b,w+24|0,h),Yr(h),a[d+48>>2]=a[A>>2],h=d+52|0,zn(b,w+36|0,h),Yr(h),a[d+64>>2]=a[A>>2],h=d+68|0,zn(b,w+48|0,h),Yr(h),a[d+80>>2]=a[A>>2],d=d+84|0,zn(b,w+60|0,d),Yr(d),De=V}function fr(A){A=+A;var h=0;return h=A<0?A+6.283185307179586:A,+(A>=6.283185307179586?h+-6.283185307179586:h)}function $s(A,h){return A=A|0,h=h|0,+Pe(+(+G[A>>3]-+G[h>>3]))<17453292519943298e-27?(h=+Pe(+(+G[A+8>>3]-+G[h+8>>3]))<17453292519943298e-27,h|0):(h=0,h|0)}function $n(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0;return b=+G[h>>3],w=+G[A>>3],C=+We(+((b-w)*.5)),d=+We(+((+G[h+8>>3]-+G[A+8>>3])*.5)),d=C*C+d*(+At(+b)*+At(+w)*d),+(+jt(+ +Ie(+d),+ +Ie(+(1-d)))*2)}function qn(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0;return b=+G[h>>3],w=+G[A>>3],C=+We(+((b-w)*.5)),d=+We(+((+G[h+8>>3]-+G[A+8>>3])*.5)),d=C*C+d*(+At(+b)*+At(+w)*d),+(+jt(+ +Ie(+d),+ +Ie(+(1-d)))*2*6371.007180918475)}function br(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0;return b=+G[h>>3],w=+G[A>>3],C=+We(+((b-w)*.5)),d=+We(+((+G[h+8>>3]-+G[A+8>>3])*.5)),d=C*C+d*(+At(+b)*+At(+w)*d),+(+jt(+ +Ie(+d),+ +Ie(+(1-d)))*2*6371.007180918475*1e3)}function pr(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0;return C=+G[h>>3],w=+At(+C),b=+G[h+8>>3]-+G[A+8>>3],P=w*+We(+b),d=+G[A>>3],+ +jt(+P,+(+We(+C)*+At(+d)-+At(+b)*(w*+We(+d))))}function Bl(A,h,d,w){A=A|0,h=+h,d=+d,w=w|0;var b=0,C=0,P=0,B=0;if(d<1e-16){a[w>>2]=a[A>>2],a[w+4>>2]=a[A+4>>2],a[w+8>>2]=a[A+8>>2],a[w+12>>2]=a[A+12>>2];return}C=h<0?h+6.283185307179586:h,C=h>=6.283185307179586?C+-6.283185307179586:C;do if(C<1e-16)h=+G[A>>3]+d,G[w>>3]=h,b=w;else{if(b=+Pe(+(C+-3.141592653589793))<1e-16,h=+G[A>>3],b){h=h-d,G[w>>3]=h,b=w;break}if(P=+At(+d),d=+We(+d),h=P*+We(+h)+ +At(+C)*(d*+At(+h)),h=h>1?1:h,h=+Rt(+(h<-1?-1:h)),G[w>>3]=h,+Pe(+(h+-1.5707963267948966))<1e-16){G[w>>3]=1.5707963267948966,G[w+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[w>>3]=-1.5707963267948966,G[w+8>>3]=0;return}if(B=+At(+h),C=d*+We(+C)/B,d=+G[A>>3],h=(P-+We(+h)*+We(+d))/+At(+d)/B,P=C>1?1:C,h=h>1?1:h,h=+G[A+8>>3]+ +jt(+(P<-1?-1:P),+(h<-1?-1:h)),h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[w+8>>3]=h;return}while(0);if(+Pe(+(h+-1.5707963267948966))<1e-16){G[b>>3]=1.5707963267948966,G[w+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[b>>3]=-1.5707963267948966,G[w+8>>3]=0;return}if(h=+G[A+8>>3],h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[w+8>>3]=h}function Yo(A){return A=A|0,+ +G[20496+(A<<3)>>3]}function yc(A){return A=A|0,+ +G[20624+(A<<3)>>3]}function Ya(A){return A=A|0,+ +G[20752+(A<<3)>>3]}function _c(A){return A=A|0,+ +G[20880+(A<<3)>>3]}function fu(A){A=A|0;var h=0;return h=21008+(A<<3)|0,A=a[h>>2]|0,Ft(a[h+4>>2]|0),A|0}function js(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0;return ne=+G[h>>3],X=+G[A>>3],V=+We(+((ne-X)*.5)),C=+G[h+8>>3],W=+G[A+8>>3],P=+We(+((C-W)*.5)),B=+At(+X),ae=+At(+ne),P=V*V+P*(ae*B*P),P=+jt(+ +Ie(+P),+ +Ie(+(1-P)))*2,V=+G[d>>3],ne=+We(+((V-ne)*.5)),w=+G[d+8>>3],C=+We(+((w-C)*.5)),b=+At(+V),C=ne*ne+C*(ae*b*C),C=+jt(+ +Ie(+C),+ +Ie(+(1-C)))*2,V=+We(+((X-V)*.5)),w=+We(+((W-w)*.5)),w=V*V+w*(B*b*w),w=+jt(+ +Ie(+w),+ +Ie(+(1-w)))*2,b=(P+C+w)*.5,+(+sn(+ +Ie(+(+dt(+(b*.5))*+dt(+((b-P)*.5))*+dt(+((b-C)*.5))*+dt(+((b-w)*.5)))))*4)}function zl(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0;if(C=De,De=De+192|0,w=C+168|0,b=C,Ws(A,h,w),fs(A,h,b),h=a[b>>2]|0,(h|0)<=0)return d=0,De=C,+d;if(d=+js(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,w)+0,(h|0)==1)return De=C,+d;A=1;do P=A,A=A+1|0,d=d+ +js(b+8+(P<<4)|0,b+8+(((A|0)%(h|0)|0)<<4)|0,w);while((A|0)<(h|0));return De=C,+d}function Xa(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0;if(C=De,De=De+192|0,w=C+168|0,b=C,Ws(A,h,w),fs(A,h,b),h=a[b>>2]|0,(h|0)>0){if(d=+js(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,w)+0,(h|0)!=1){A=1;do P=A,A=A+1|0,d=d+ +js(b+8+(P<<4)|0,b+8+(((A|0)%(h|0)|0)<<4)|0,w);while((A|0)<(h|0))}}else d=0;return De=C,+(d*6371.007180918475*6371.007180918475)}function xa(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0;if(C=De,De=De+192|0,w=C+168|0,b=C,Ws(A,h,w),fs(A,h,b),h=a[b>>2]|0,(h|0)>0){if(d=+js(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,w)+0,(h|0)!=1){A=1;do P=A,A=A+1|0,d=d+ +js(b+8+(P<<4)|0,b+8+(((A|0)%(h|0)|0)<<4)|0,w);while((A|0)<(h|0))}}else d=0;return De=C,+(d*6371.007180918475*6371.007180918475*1e3*1e3)}function Ol(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0;if(P=De,De=De+176|0,C=P,tl(A,h,C),A=a[C>>2]|0,(A|0)<=1)return b=0,De=P,+b;h=A+-1|0,A=0,d=0,w=+G[C+8>>3],b=+G[C+16>>3];do A=A+1|0,V=w,w=+G[C+8+(A<<4)>>3],W=+We(+((w-V)*.5)),B=b,b=+G[C+8+(A<<4)+8>>3],B=+We(+((b-B)*.5)),B=W*W+B*(+At(+w)*+At(+V)*B),d=d+ +jt(+ +Ie(+B),+ +Ie(+(1-B)))*2;while((A|0)<(h|0));return De=P,+d}function Fl(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0;if(P=De,De=De+176|0,C=P,tl(A,h,C),A=a[C>>2]|0,(A|0)<=1)return b=0,De=P,+b;h=A+-1|0,A=0,d=0,w=+G[C+8>>3],b=+G[C+16>>3];do A=A+1|0,V=w,w=+G[C+8+(A<<4)>>3],W=+We(+((w-V)*.5)),B=b,b=+G[C+8+(A<<4)+8>>3],B=+We(+((b-B)*.5)),B=W*W+B*(+At(+V)*+At(+w)*B),d=d+ +jt(+ +Ie(+B),+ +Ie(+(1-B)))*2;while((A|0)!=(h|0));return W=d*6371.007180918475,De=P,+W}function gr(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0;if(P=De,De=De+176|0,C=P,tl(A,h,C),A=a[C>>2]|0,(A|0)<=1)return b=0,De=P,+b;h=A+-1|0,A=0,d=0,w=+G[C+8>>3],b=+G[C+16>>3];do A=A+1|0,V=w,w=+G[C+8+(A<<4)>>3],W=+We(+((w-V)*.5)),B=b,b=+G[C+8+(A<<4)+8>>3],B=+We(+((b-B)*.5)),B=W*W+B*(+At(+V)*+At(+w)*B),d=d+ +jt(+ +Ie(+B),+ +Ie(+(1-B)))*2;while((A|0)!=(h|0));return W=d*6371.007180918475*1e3,De=P,+W}function MA(A,h){return A=A|0,h=h|0,h=Ct(A|0,h|0,52)|0,Oe()|0,h&15|0}function cs(A,h){return A=A|0,h=h|0,h=Ct(A|0,h|0,45)|0,Oe()|0,h&127|0}function du(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0;if(!(!0&(h&-16777216|0)==134217728)||(P=Ct(A|0,h|0,45)|0,Oe()|0,P=P&127,P>>>0>121))return h=0,h|0;d=Ct(A|0,h|0,52)|0,Oe()|0,d=d&15;do if(d|0){for(b=1,w=0;;){if(C=Ct(A|0,h|0,(15-b|0)*3|0)|0,Oe()|0,C=C&7,(C|0)!=0&(w^1))if((C|0)==1&(en(P)|0)!=0){B=0,w=13;break}else w=1;if((C|0)==7){B=0,w=13;break}if(b>>>0<d>>>0)b=b+1|0;else{w=9;break}}if((w|0)==9){if((d|0)==15)B=1;else break;return B|0}else if((w|0)==13)return B|0}while(0);for(;;){if(B=Ct(A|0,h|0,(14-d|0)*3|0)|0,Oe()|0,!((B&7|0)==7&!0)){B=0,w=13;break}if(d>>>0<14)d=d+1|0;else{B=1,w=13;break}}return(w|0)==13?B|0:0}function Nl(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;if(w=Ct(A|0,h|0,52)|0,Oe()|0,w=w&15,(w|0)>=(d|0)){if((w|0)!=(d|0))if(d>>>0<=15){if(b=Pt(d|0,0,52)|0,A=b|A,h=Oe()|0|h&-15728641,(w|0)>(d|0))do b=Pt(7,0,(14-d|0)*3|0)|0,d=d+1|0,A=b|A,h=Oe()|0|h;while((d|0)<(w|0))}else h=0,A=0}else h=0,A=0;return Ft(h|0),A|0}function vc(A,h,d){return A=A|0,h=h|0,d=d|0,A=Ct(A|0,h|0,52)|0,Oe()|0,A=A&15,(d|0)<16&(A|0)<=(d|0)?(d=$l(7,d-A|0)|0,d|0):(d=0,d|0)}function Xr(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0,B=0,V=0,W=0,X=0;if(P=Ct(A|0,h|0,52)|0,Oe()|0,P=P&15,!!((d|0)<16&(P|0)<=(d|0))){if((P|0)==(d|0)){d=w,a[d>>2]=A,a[d+4>>2]=h;return}if(V=$l(7,d-P|0)|0,W=(V|0)/7|0,B=Ct(A|0,h|0,45)|0,Oe()|0,!(en(B&127)|0))C=0;else{e:do if(!P)b=0;else for(C=1;;){if(b=Ct(A|0,h|0,(15-C|0)*3|0)|0,Oe()|0,b=b&7,b|0)break e;if(C>>>0<P>>>0)C=C+1|0;else{b=0;break}}while(0);C=(b|0)==0}if(X=Pt(P+1|0,0,52)|0,b=Oe()|0|h&-15728641,B=(14-P|0)*3|0,h=Pt(7,0,B|0)|0,h=(X|A)&~h,P=b&~(Oe()|0),Xr(h,P,d,w),b=w+(W<<3)|0,!C){X=Pt(1,0,B|0)|0,Xr(X|h,Oe()|0|P,d,b),X=b+(W<<3)|0,V=Pt(2,0,B|0)|0,Xr(V|h,Oe()|0|P,d,X),X=X+(W<<3)|0,V=Pt(3,0,B|0)|0,Xr(V|h,Oe()|0|P,d,X),X=X+(W<<3)|0,V=Pt(4,0,B|0)|0,Xr(V|h,Oe()|0|P,d,X),X=X+(W<<3)|0,V=Pt(5,0,B|0)|0,Xr(V|h,Oe()|0|P,d,X),V=Pt(6,0,B|0)|0,Xr(V|h,Oe()|0|P,d,X+(W<<3)|0);return}C=b+(W<<3)|0,(V|0)>6&&(V=b+8|0,X=(C>>>0>V>>>0?C:V)+-1+(0-b)|0,L(b|0,0,X+8&-8|0)|0,b=V+(X>>>3<<3)|0),X=Pt(2,0,B|0)|0,Xr(X|h,Oe()|0|P,d,b),X=b+(W<<3)|0,V=Pt(3,0,B|0)|0,Xr(V|h,Oe()|0|P,d,X),X=X+(W<<3)|0,V=Pt(4,0,B|0)|0,Xr(V|h,Oe()|0|P,d,X),X=X+(W<<3)|0,V=Pt(5,0,B|0)|0,Xr(V|h,Oe()|0|P,d,X),V=Pt(6,0,B|0)|0,Xr(V|h,Oe()|0|P,d,X+(W<<3)|0)}}function zr(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;if(b=Ct(A|0,h|0,45)|0,Oe()|0,!(en(b&127)|0))return b=0,b|0;b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)d=0;else for(w=1;;){if(d=Ct(A|0,h|0,(15-w|0)*3|0)|0,Oe()|0,d=d&7,d|0)break e;if(w>>>0<b>>>0)w=w+1|0;else{d=0;break}}while(0);return b=(d|0)==0&1,b|0}function oi(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;if(w=Ct(A|0,h|0,52)|0,Oe()|0,w=w&15,(d|0)<16&(w|0)<=(d|0)){if((w|0)!=(d|0)&&(b=Pt(d|0,0,52)|0,A=b|A,h=Oe()|0|h&-15728641,(w|0)<(d|0)))do b=Pt(7,0,(14-w|0)*3|0)|0,w=w+1|0,A=A&~b,h=h&~(Oe()|0);while((w|0)<(d|0))}else h=0,A=0;return Ft(h|0),A|0}function pu(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0,Ge=0,xe=0,y=0,m=0,x=0,E=0;if(!d)return x=0,x|0;if(b=A,w=a[b>>2]|0,b=a[b+4>>2]|0,!0&(b&15728640|0)==0){if((d|0)<=0||(x=h,a[x>>2]=w,a[x+4>>2]=b,(d|0)==1))return x=0,x|0;w=1;do y=A+(w<<3)|0,m=a[y+4>>2]|0,x=h+(w<<3)|0,a[x>>2]=a[y>>2],a[x+4>>2]=m,w=w+1|0;while((w|0)!=(d|0));return w=0,w|0}if(y=d<<3,m=Kt(y)|0,!m)return x=-3,x|0;if(Xs(m|0,A|0,y|0)|0,xe=es(d,8)|0,!xe)return fn(m),x=-3,x|0;w=d;e:for(;;){P=m,X=a[P>>2]|0,P=a[P+4>>2]|0,Se=Ct(X|0,P|0,52)|0,Oe()|0,Se=Se&15,Ge=Se+-1|0,$e=(w|0)>0;t:do if($e){if(ve=((w|0)<0)<<31>>31,be=Pt(Ge|0,0,52)|0,Me=Oe()|0,Ge>>>0>15)for(b=0,A=X,d=P;;){if(!((A|0)==0&(d|0)==0)){if(C=Ct(A|0,d|0,52)|0,Oe()|0,C=C&15,B=(C|0)<(Ge|0),C=(C|0)==(Ge|0),W=B?0:C?A:0,A=B?0:C?d:0,d=Ys(W|0,A|0,w|0,ve|0)|0,Oe()|0,C=xe+(d<<3)|0,B=C,V=a[B>>2]|0,B=a[B+4>>2]|0,(V|0)==0&(B|0)==0)d=W;else for(be=0,ue=d,ne=B,d=W;;){if((be|0)>(w|0)){x=41;break e}if((V|0)==(d|0)&(ne&-117440513|0)==(A|0)){W=Ct(V|0,ne|0,56)|0,Oe()|0,W=W&7,ae=W+1|0,Me=Ct(V|0,ne|0,45)|0,Oe()|0;n:do if(!(en(Me&127)|0))B=7;else{if(V=Ct(V|0,ne|0,52)|0,Oe()|0,V=V&15,!V){B=6;break}for(B=1;;){if(Me=Pt(7,0,(15-B|0)*3|0)|0,!((Me&d|0)==0&((Oe()|0)&A|0)==0)){B=7;break n}if(B>>>0<V>>>0)B=B+1|0;else{B=6;break}}}while(0);if((W+2|0)>>>0>B>>>0){x=51;break e}Me=Pt(ae|0,0,56)|0,A=Oe()|0|A&-117440513,B=C,a[B>>2]=0,a[B+4>>2]=0,B=ue,d=Me|d}else B=(ue+1|0)%(w|0)|0;if(C=xe+(B<<3)|0,ne=C,V=a[ne>>2]|0,ne=a[ne+4>>2]|0,(V|0)==0&(ne|0)==0)break;be=be+1|0,ue=B}Me=C,a[Me>>2]=d,a[Me+4>>2]=A}if(b=b+1|0,(b|0)>=(w|0))break t;d=m+(b<<3)|0,A=a[d>>2]|0,d=a[d+4>>2]|0}for(b=0,A=X,d=P;;){if(!((A|0)==0&(d|0)==0)){if(B=Ct(A|0,d|0,52)|0,Oe()|0,B=B&15,(B|0)>=(Ge|0)){if((B|0)!=(Ge|0)&&(A=A|be,d=d&-15728641|Me,B>>>0>=Se>>>0)){C=Ge;do ue=Pt(7,0,(14-C|0)*3|0)|0,C=C+1|0,A=ue|A,d=Oe()|0|d;while(C>>>0<B>>>0)}}else A=0,d=0;if(B=Ys(A|0,d|0,w|0,ve|0)|0,Oe()|0,C=xe+(B<<3)|0,V=C,W=a[V>>2]|0,V=a[V+4>>2]|0,!((W|0)==0&(V|0)==0))for(ue=0;;){if((ue|0)>(w|0)){x=41;break e}if((W|0)==(A|0)&(V&-117440513|0)==(d|0)){ae=Ct(W|0,V|0,56)|0,Oe()|0,ae=ae&7,ne=ae+1|0,E=Ct(W|0,V|0,45)|0,Oe()|0;n:do if(!(en(E&127)|0))V=7;else{if(W=Ct(W|0,V|0,52)|0,Oe()|0,W=W&15,!W){V=6;break}for(V=1;;){if(E=Pt(7,0,(15-V|0)*3|0)|0,!((E&A|0)==0&((Oe()|0)&d|0)==0)){V=7;break n}if(V>>>0<W>>>0)V=V+1|0;else{V=6;break}}}while(0);if((ae+2|0)>>>0>V>>>0){x=51;break e}E=Pt(ne|0,0,56)|0,d=Oe()|0|d&-117440513,ne=C,a[ne>>2]=0,a[ne+4>>2]=0,A=E|A}else B=(B+1|0)%(w|0)|0;if(C=xe+(B<<3)|0,V=C,W=a[V>>2]|0,V=a[V+4>>2]|0,(W|0)==0&(V|0)==0)break;ue=ue+1|0}E=C,a[E>>2]=A,a[E+4>>2]=d}if(b=b+1|0,(b|0)>=(w|0))break t;d=m+(b<<3)|0,A=a[d>>2]|0,d=a[d+4>>2]|0}}while(0);if((w+5|0)>>>0<11){x=99;break}if(Me=es((w|0)/6|0,8)|0,!Me){x=58;break}t:do if($e){ue=0,ne=0;do{if(B=xe+(ue<<3)|0,A=B,b=a[A>>2]|0,A=a[A+4>>2]|0,!((b|0)==0&(A|0)==0)){V=Ct(b|0,A|0,56)|0,Oe()|0,V=V&7,d=V+1|0,W=A&-117440513,E=Ct(b|0,A|0,45)|0,Oe()|0;n:do if(en(E&127)|0){if(ae=Ct(b|0,A|0,52)|0,Oe()|0,ae=ae&15,ae|0)for(C=1;;){if(E=Pt(7,0,(15-C|0)*3|0)|0,!((b&E|0)==0&(W&(Oe()|0)|0)==0))break n;if(C>>>0<ae>>>0)C=C+1|0;else break}A=Pt(d|0,0,56)|0,b=A|b,A=Oe()|0|W,d=B,a[d>>2]=b,a[d+4>>2]=A,d=V+2|0}while(0);(d|0)==7&&(E=Me+(ne<<3)|0,a[E>>2]=b,a[E+4>>2]=A&-117440513,ne=ne+1|0)}ue=ue+1|0}while((ue|0)!=(w|0));if($e){if(be=((w|0)<0)<<31>>31,ae=Pt(Ge|0,0,52)|0,ue=Oe()|0,Ge>>>0>15)for(A=0,b=0;;){do if(!((X|0)==0&(P|0)==0)){for(V=Ct(X|0,P|0,52)|0,Oe()|0,V=V&15,C=(V|0)<(Ge|0),V=(V|0)==(Ge|0),B=C?0:V?X:0,V=C?0:V?P:0,C=Ys(B|0,V|0,w|0,be|0)|0,Oe()|0,d=0;;){if((d|0)>(w|0)){x=98;break e}if(E=xe+(C<<3)|0,W=a[E+4>>2]|0,(W&-117440513|0)==(V|0)&&(a[E>>2]|0)==(B|0)){x=70;break}if(C=(C+1|0)%(w|0)|0,E=xe+(C<<3)|0,(a[E>>2]|0)==(B|0)&&(a[E+4>>2]|0)==(V|0))break;d=d+1|0}if((x|0)==70&&(x=0,!0&(W&117440512|0)==100663296))break;E=h+(b<<3)|0,a[E>>2]=X,a[E+4>>2]=P,b=b+1|0}while(0);if(A=A+1|0,(A|0)>=(w|0)){w=ne;break t}P=m+(A<<3)|0,X=a[P>>2]|0,P=a[P+4>>2]|0}for(A=0,b=0;;){do if(!((X|0)==0&(P|0)==0)){if(V=Ct(X|0,P|0,52)|0,Oe()|0,V=V&15,(V|0)>=(Ge|0))if((V|0)!=(Ge|0))if(d=X|ae,C=P&-15728641|ue,V>>>0<Se>>>0)V=C;else{B=Ge;do E=Pt(7,0,(14-B|0)*3|0)|0,B=B+1|0,d=E|d,C=Oe()|0|C;while(B>>>0<V>>>0);V=C}else d=X,V=P;else d=0,V=0;for(B=Ys(d|0,V|0,w|0,be|0)|0,Oe()|0,C=0;;){if((C|0)>(w|0)){x=98;break e}if(E=xe+(B<<3)|0,W=a[E+4>>2]|0,(W&-117440513|0)==(V|0)&&(a[E>>2]|0)==(d|0)){x=93;break}if(B=(B+1|0)%(w|0)|0,E=xe+(B<<3)|0,(a[E>>2]|0)==(d|0)&&(a[E+4>>2]|0)==(V|0))break;C=C+1|0}if((x|0)==93&&(x=0,!0&(W&117440512|0)==100663296))break;E=h+(b<<3)|0,a[E>>2]=X,a[E+4>>2]=P,b=b+1|0}while(0);if(A=A+1|0,(A|0)>=(w|0)){w=ne;break t}P=m+(A<<3)|0,X=a[P>>2]|0,P=a[P+4>>2]|0}}else b=0,w=ne}else b=0,w=0;while(0);if(L(xe|0,0,y|0)|0,Xs(m|0,Me|0,w<<3|0)|0,fn(Me),w)h=h+(b<<3)|0;else break}return(x|0)==41?(fn(m),fn(xe),E=-1,E|0):(x|0)==51?(fn(m),fn(xe),E=-2,E|0):(x|0)==58?(fn(m),fn(xe),E=-3,E|0):(x|0)==98?(fn(Me),fn(m),fn(xe),E=-1,E|0):((x|0)==99&&Xs(h|0,m|0,w<<3|0)|0,fn(m),fn(xe),E=0,E|0)}function Hs(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0,B=0,V=0,W=0,X=0;if((h|0)<=0)return b=0,b|0;if((b|0)>=16){for(C=0;;){if(X=A+(C<<3)|0,!((a[X>>2]|0)==0&(a[X+4>>2]|0)==0)){C=14;break}if(C=C+1|0,(C|0)>=(h|0)){P=0,C=16;break}}if((C|0)==14)return((w|0)>0?-2:-1)|0;if((C|0)==16)return P|0}C=0,X=0;e:for(;;){W=A+(X<<3)|0,B=W,P=a[B>>2]|0,B=a[B+4>>2]|0;do if(!((P|0)==0&(B|0)==0)){if((C|0)>=(w|0)){P=-1,C=16;break e}if(V=Ct(P|0,B|0,52)|0,Oe()|0,V=V&15,(V|0)>(b|0)){P=-2,C=16;break e}if((V|0)==(b|0)){W=d+(C<<3)|0,a[W>>2]=P,a[W+4>>2]=B,C=C+1|0;break}if(P=($l(7,b-V|0)|0)+C|0,(P|0)>(w|0)){P=-1,C=16;break e}Xr(a[W>>2]|0,a[W+4>>2]|0,b,d+(C<<3)|0),C=P}while(0);if(X=X+1|0,(X|0)>=(h|0)){P=0,C=16;break}}return(C|0)==16?P|0:0}function xc(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0;if((h|0)<=0)return d=0,d|0;if((d|0)>=16){for(w=0;;){if(P=A+(w<<3)|0,!((a[P>>2]|0)==0&(a[P+4>>2]|0)==0)){w=-1,b=13;break}if(w=w+1|0,(w|0)>=(h|0)){w=0,b=13;break}}if((b|0)==13)return w|0}w=0,P=0;e:for(;;){b=A+(P<<3)|0,C=a[b>>2]|0,b=a[b+4>>2]|0;do if(!((C|0)==0&(b|0)==0)){if(b=Ct(C|0,b|0,52)|0,Oe()|0,b=b&15,(b|0)>(d|0)){w=-1,b=13;break e}if((b|0)==(d|0)){w=w+1|0;break}else{w=($l(7,d-b|0)|0)+w|0;break}}while(0);if(P=P+1|0,(P|0)>=(h|0)){b=13;break}}return(b|0)==13?w|0:0}function PA(A,h){return A=A|0,h=h|0,h=Ct(A|0,h|0,52)|0,Oe()|0,h&1|0}function fi(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;if(b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15,!b)return b=0,b|0;for(w=1;;){if(d=Ct(A|0,h|0,(15-w|0)*3|0)|0,Oe()|0,d=d&7,d|0){w=5;break}if(w>>>0<b>>>0)w=w+1|0;else{d=0,w=5;break}}return(w|0)==5?d|0:0}function Ei(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0;if(V=Ct(A|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=A,Ft(B|0),V|0;for(B=1,d=0;;){C=(15-B|0)*3|0,w=Pt(7,0,C|0)|0,b=Oe()|0,P=Ct(A|0,h|0,C|0)|0,Oe()|0,C=Pt(Wi(P&7)|0,0,C|0)|0,P=Oe()|0,A=C|A&~w,h=P|h&~b;e:do if(!d)if((C&w|0)==0&(P&b|0)==0)d=0;else if(w=Ct(A|0,h|0,52)|0,Oe()|0,w=w&15,!w)d=1;else{d=1;t:for(;;){switch(P=Ct(A|0,h|0,(15-d|0)*3|0)|0,Oe()|0,P&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<w>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(P=(15-d|0)*3|0,b=Ct(A|0,h|0,P|0)|0,Oe()|0,C=Pt(7,0,P|0)|0,h=h&~(Oe()|0),P=Pt(Wi(b&7)|0,0,P|0)|0,A=A&~C|P,h=h|(Oe()|0),d>>>0<w>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ft(h|0),A|0}function hs(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0;if(w=Ct(A|0,h|0,52)|0,Oe()|0,w=w&15,!w)return d=h,w=A,Ft(d|0),w|0;for(d=1;C=(15-d|0)*3|0,P=Ct(A|0,h|0,C|0)|0,Oe()|0,b=Pt(7,0,C|0)|0,h=h&~(Oe()|0),C=Pt(Wi(P&7)|0,0,C|0)|0,A=C|A&~b,h=Oe()|0|h,d>>>0<w>>>0;)d=d+1|0;return Ft(h|0),A|0}function wa(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0;if(V=Ct(A|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=A,Ft(B|0),V|0;for(B=1,d=0;;){C=(15-B|0)*3|0,w=Pt(7,0,C|0)|0,b=Oe()|0,P=Ct(A|0,h|0,C|0)|0,Oe()|0,C=Pt(Qi(P&7)|0,0,C|0)|0,P=Oe()|0,A=C|A&~w,h=P|h&~b;e:do if(!d)if((C&w|0)==0&(P&b|0)==0)d=0;else if(w=Ct(A|0,h|0,52)|0,Oe()|0,w=w&15,!w)d=1;else{d=1;t:for(;;){switch(P=Ct(A|0,h|0,(15-d|0)*3|0)|0,Oe()|0,P&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<w>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(b=(15-d|0)*3|0,C=Pt(7,0,b|0)|0,P=h&~(Oe()|0),h=Ct(A|0,h|0,b|0)|0,Oe()|0,h=Pt(Qi(h&7)|0,0,b|0)|0,A=A&~C|h,h=P|(Oe()|0),d>>>0<w>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ft(h|0),A|0}function Ki(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0;if(w=Ct(A|0,h|0,52)|0,Oe()|0,w=w&15,!w)return d=h,w=A,Ft(d|0),w|0;for(d=1;P=(15-d|0)*3|0,C=Pt(7,0,P|0)|0,b=h&~(Oe()|0),h=Ct(A|0,h|0,P|0)|0,Oe()|0,h=Pt(Qi(h&7)|0,0,P|0)|0,A=h|A&~C,h=Oe()|0|b,d>>>0<w>>>0;)d=d+1|0;return Ft(h|0),A|0}function bo(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0;if(V=De,De=De+64|0,B=V+40|0,w=V+24|0,b=V+12|0,C=V,Pt(h|0,0,52)|0,d=Oe()|0|134225919,!h)return(a[A+4>>2]|0)>2||(a[A+8>>2]|0)>2||(a[A+12>>2]|0)>2?(P=0,B=0,Ft(P|0),De=V,B|0):(Pt(Gn(A)|0,0,45)|0,P=Oe()|0|d,B=-1,Ft(P|0),De=V,B|0);if(a[B>>2]=a[A>>2],a[B+4>>2]=a[A+4>>2],a[B+8>>2]=a[A+8>>2],a[B+12>>2]=a[A+12>>2],P=B+4|0,(h|0)>0)for(A=-1;a[w>>2]=a[P>>2],a[w+4>>2]=a[P+4>>2],a[w+8>>2]=a[P+8>>2],h&1?(Ll(P),a[b>>2]=a[P>>2],a[b+4>>2]=a[P+4>>2],a[b+8>>2]=a[P+8>>2],ya(b)):(Wo(P),a[b>>2]=a[P>>2],a[b+4>>2]=a[P+4>>2],a[b+8>>2]=a[P+8>>2],vo(b)),Cs(w,b,C),Yr(C),X=(15-h|0)*3|0,W=Pt(7,0,X|0)|0,d=d&~(Oe()|0),X=Pt(_o(C)|0,0,X|0)|0,A=X|A&~W,d=Oe()|0|d,(h|0)>1;)h=h+-1|0;else A=-1;e:do if((a[P>>2]|0)<=2&&(a[B+8>>2]|0)<=2&&(a[B+12>>2]|0)<=2){if(w=Gn(B)|0,h=Pt(w|0,0,45)|0,h=h|A,A=Oe()|0|d&-1040385,C=vA(B)|0,!(en(w)|0)){if((C|0)<=0)break;for(b=0;;){if(w=Ct(h|0,A|0,52)|0,Oe()|0,w=w&15,w)for(d=1;X=(15-d|0)*3|0,B=Ct(h|0,A|0,X|0)|0,Oe()|0,W=Pt(7,0,X|0)|0,A=A&~(Oe()|0),X=Pt(Wi(B&7)|0,0,X|0)|0,h=h&~W|X,A=A|(Oe()|0),d>>>0<w>>>0;)d=d+1|0;if(b=b+1|0,(b|0)==(C|0))break e}}b=Ct(h|0,A|0,52)|0,Oe()|0,b=b&15;t:do if(b){d=1;n:for(;;){switch(X=Ct(h|0,A|0,(15-d|0)*3|0)|0,Oe()|0,X&7){case 1:break n;case 0:break;default:break t}if(d>>>0<b>>>0)d=d+1|0;else break t}if(iu(w,a[B>>2]|0)|0)for(d=1;B=(15-d|0)*3|0,W=Pt(7,0,B|0)|0,X=A&~(Oe()|0),A=Ct(h|0,A|0,B|0)|0,Oe()|0,A=Pt(Qi(A&7)|0,0,B|0)|0,h=h&~W|A,A=X|(Oe()|0),d>>>0<b>>>0;)d=d+1|0;else for(d=1;X=(15-d|0)*3|0,B=Ct(h|0,A|0,X|0)|0,Oe()|0,W=Pt(7,0,X|0)|0,A=A&~(Oe()|0),X=Pt(Wi(B&7)|0,0,X|0)|0,h=h&~W|X,A=A|(Oe()|0),d>>>0<b>>>0;)d=d+1|0}while(0);if((C|0)>0){d=0;do h=Ei(h,A)|0,A=Oe()|0,d=d+1|0;while((d|0)!=(C|0))}}else h=0,A=0;while(0);return W=A,X=h,Ft(W|0),De=V,X|0}function mi(A){return A=A|0,(A|0)%2|0|0}function Ka(A,h){A=A|0,h=h|0;var d=0,w=0;return w=De,De=De+16|0,d=w,h>>>0<=15&&(a[A+4>>2]&2146435072|0)!=2146435072&&(a[A+8+4>>2]&2146435072|0)!=2146435072?(CA(A,h,d),h=bo(d,h)|0,A=Oe()|0):(A=0,h=0),Ft(A|0),De=w,h|0}function Ul(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0;if(b=d+4|0,C=Ct(A|0,h|0,52)|0,Oe()|0,C=C&15,P=Ct(A|0,h|0,45)|0,Oe()|0,w=(C|0)==0,en(P&127)|0){if(w)return P=1,P|0;w=1}else{if(w)return P=0,P|0;!(a[b>>2]|0)&&!(a[d+8>>2]|0)?w=(a[d+12>>2]|0)!=0&1:w=1}for(d=1;d&1?ya(b):vo(b),P=Ct(A|0,h|0,(15-d|0)*3|0)|0,Oe()|0,SA(b,P&7),d>>>0<C>>>0;)d=d+1|0;return w|0}function Ja(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0;X=De,De=De+16|0,V=X,W=Ct(A|0,h|0,45)|0,Oe()|0,W=W&127;e:do if(en(W)|0&&(C=Ct(A|0,h|0,52)|0,Oe()|0,C=C&15,(C|0)!=0)){w=1;t:for(;;){switch(B=Ct(A|0,h|0,(15-w|0)*3|0)|0,Oe()|0,B&7){case 5:break t;case 0:break;default:{w=h;break e}}if(w>>>0<C>>>0)w=w+1|0;else{w=h;break e}}for(b=1,w=h;h=(15-b|0)*3|0,P=Pt(7,0,h|0)|0,B=w&~(Oe()|0),w=Ct(A|0,w|0,h|0)|0,Oe()|0,w=Pt(Qi(w&7)|0,0,h|0)|0,A=A&~P|w,w=B|(Oe()|0),b>>>0<C>>>0;)b=b+1|0}else w=h;while(0);if(B=7728+(W*28|0)|0,a[d>>2]=a[B>>2],a[d+4>>2]=a[B+4>>2],a[d+8>>2]=a[B+8>>2],a[d+12>>2]=a[B+12>>2],!(Ul(A,w,d)|0)){De=X;return}if(P=d+4|0,a[V>>2]=a[P>>2],a[V+4>>2]=a[P+4>>2],a[V+8>>2]=a[P+8>>2],C=Ct(A|0,w|0,52)|0,Oe()|0,B=C&15,C&1?(vo(P),C=B+1|0):C=B,!(en(W)|0))w=0;else{e:do if(!B)w=0;else for(h=1;;){if(b=Ct(A|0,w|0,(15-h|0)*3|0)|0,Oe()|0,b=b&7,b|0){w=b;break e}if(h>>>0<B>>>0)h=h+1|0;else{w=0;break}}while(0);w=(w|0)==4&1}if(!(wo(d,C,w,0)|0))(C|0)!=(B|0)&&(a[P>>2]=a[V>>2],a[P+4>>2]=a[V+4>>2],a[P+8>>2]=a[V+8>>2]);else{if(en(W)|0)do;while(wo(d,C,0,0)|0);(C|0)!=(B|0)&&Wo(P)}De=X}function Ws(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;w=De,De=De+16|0,b=w,Ja(A,h,b),h=Ct(A|0,h|0,52)|0,Oe()|0,Za(b,h&15,d),De=w}function fs(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0;P=De,De=De+16|0,C=P,Ja(A,h,C),w=Ct(A|0,h|0,45)|0,Oe()|0,w=(en(w&127)|0)==0,b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!w){if(b|0)for(w=1;;){if(B=Pt(7,0,(15-w|0)*3|0)|0,!((B&A|0)==0&((Oe()|0)&h|0)==0))break e;if(w>>>0<b>>>0)w=w+1|0;else break}uu(C,b,0,5,d),De=P;return}while(0);hu(C,b,0,6,d),De=P}function wc(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;if(w=Ct(A|0,h|0,45)|0,Oe()|0,!(en(w&127)|0))return w=2,w|0;if(w=Ct(A|0,h|0,52)|0,Oe()|0,w=w&15,!w)return w=5,w|0;for(d=1;;){if(b=Pt(7,0,(15-d|0)*3|0)|0,!((b&A|0)==0&((Oe()|0)&h|0)==0)){d=2,A=6;break}if(d>>>0<w>>>0)d=d+1|0;else{d=5,A=6;break}}return(A|0)==6?d|0:0}function ba(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0;ae=De,De=De+128|0,W=ae+112|0,C=ae+96|0,X=ae,b=Ct(A|0,h|0,52)|0,Oe()|0,B=b&15,a[W>>2]=B,P=Ct(A|0,h|0,45)|0,Oe()|0,P=P&127;e:do if(en(P)|0){if(B|0)for(w=1;;){if(V=Pt(7,0,(15-w|0)*3|0)|0,!((V&A|0)==0&((Oe()|0)&h|0)==0)){b=0;break e}if(w>>>0<B>>>0)w=w+1|0;else break}if(b&1)b=1;else{V=Pt(B+1|0,0,52)|0,X=Oe()|0|h&-15728641,W=Pt(7,0,(14-B|0)*3|0)|0,ba((V|A)&~W,X&~(Oe()|0),d),De=ae;return}}else b=0;while(0);Ja(A,h,C),b?(cu(C,W,X),V=5):(va(C,W,X),V=6);e:do if(en(P)|0)if(!B)w=20;else for(w=1;;){if(P=Pt(7,0,(15-w|0)*3|0)|0,!((P&A|0)==0&((Oe()|0)&h|0)==0)){w=8;break e}if(w>>>0<B>>>0)w=w+1|0;else{w=20;break}}else w=8;while(0);if(L(d|0,-1,w|0)|0,b){b=0;do{for(C=X+(b<<4)|0,_a(C,a[W>>2]|0)|0,C=a[C>>2]|0,w=0;P=d+(w<<2)|0,B=a[P>>2]|0,!((B|0)==-1|(B|0)==(C|0));)w=w+1|0;a[P>>2]=C,b=b+1|0}while((b|0)!=(V|0))}else{b=0;do{for(C=X+(b<<4)|0,wo(C,a[W>>2]|0,0,1)|0,C=a[C>>2]|0,w=0;P=d+(w<<2)|0,B=a[P>>2]|0,!((B|0)==-1|(B|0)==(C|0));)w=w+1|0;a[P>>2]=C,b=b+1|0}while((b|0)!=(V|0))}De=ae}function el(){return 12}function ai(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0;if(Pt(A|0,0,52)|0,B=Oe()|0|134225919,(A|0)<1){w=0,d=0;do en(w)|0&&(Pt(w|0,0,45)|0,P=B|(Oe()|0),A=h+(d<<3)|0,a[A>>2]=-1,a[A+4>>2]=P,d=d+1|0),w=w+1|0;while((w|0)!=122);return}P=0,d=0;do{if(en(P)|0){for(Pt(P|0,0,45)|0,w=1,b=-1,C=B|(Oe()|0);V=Pt(7,0,(15-w|0)*3|0)|0,b=b&~V,C=C&~(Oe()|0),(w|0)!=(A|0);)w=w+1|0;V=h+(d<<3)|0,a[V>>2]=b,a[V+4>>2]=C,d=d+1|0}P=P+1|0}while((P|0)!=122)}function Ms(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0,B=0,V=0,W=0;if(B=De,De=De+64|0,P=B,(A|0)==(d|0)&(h|0)==(w|0)|(!1|(h&2013265920|0)!=134217728|(!1|(w&2013265920|0)!=134217728))||(b=Ct(A|0,h|0,52)|0,Oe()|0,b=b&15,C=Ct(d|0,w|0,52)|0,Oe()|0,(b|0)!=(C&15|0)))return P=0,De=B,P|0;if(C=b+-1|0,b>>>0>1&&(W=Nl(A,h,C)|0,V=Oe()|0,C=Nl(d,w,C)|0,(W|0)==(C|0)&(V|0)==(Oe()|0))&&(C=(b^15)*3|0,b=Ct(A|0,h|0,C|0)|0,Oe()|0,b=b&7,C=Ct(d|0,w|0,C|0)|0,Oe()|0,C=C&7,(b|0)==0|(C|0)==0||(a[21136+(b<<2)>>2]|0)==(C|0)||(a[21168+(b<<2)>>2]|0)==(C|0)))return W=1,De=B,W|0;b=P,C=b+56|0;do a[b>>2]=0,b=b+4|0;while((b|0)<(C|0));return ga(A,h,1,P),W=P,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0))&&(W=P+8|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))&&(W=P+16|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))&&(W=P+24|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))&&(W=P+32|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))&&(W=P+40|0,!((a[W>>2]|0)==(d|0)&&(a[W+4>>2]|0)==(w|0)))?(b=P+48|0,b=((a[b>>2]|0)==(d|0)?(a[b+4>>2]|0)==(w|0):0)&1):b=1,W=b,De=B,W|0}function Ji(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0,B=0,V=0,W=0,X=0;if(W=De,De=De+16|0,P=W,!(Ms(A,h,d,w)|0))return B=0,V=0,Ft(B|0),De=W,V|0;for(B=h&-2130706433,b=(zr(A,h)|0)==0,b=b?1:2;a[P>>2]=0,X=ge(A,h,b,P)|0,C=b+1|0,!((X|0)==(d|0)&(Oe()|0)==(w|0));)if(C>>>0<7)b=C;else{b=0,A=0,V=6;break}return(V|0)==6?(Ft(b|0),De=W,A|0):(X=Pt(b|0,0,56)|0,V=B|(Oe()|0)|268435456,X=A|X,Ft(V|0),De=W,X|0)}function Vl(A,h){A=A|0,h=h|0;var d=0;return d=!0&(h&2013265920|0)==268435456,Ft((d?h&-2130706433|134217728:0)|0),(d?A:0)|0}function Xo(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;return w=De,De=De+16|0,d=w,!0&(h&2013265920|0)==268435456?(b=Ct(A|0,h|0,56)|0,Oe()|0,a[d>>2]=0,d=ge(A,h&-2130706433|134217728,b&7,d)|0,h=Oe()|0,Ft(h|0),De=w,d|0):(h=0,d=0,Ft(h|0),De=w,d|0)}function bc(A,h){A=A|0,h=h|0;var d=0;if(!(!0&(h&2013265920|0)==268435456))return d=0,d|0;switch(d=Ct(A|0,h|0,56)|0,Oe()|0,d&7){case 0:case 7:return d=0,d|0}return d=h&-2130706433|134217728,!0&(h&117440512|0)==16777216&(zr(A,d)|0)!=0?(d=0,d|0):(d=du(A,d)|0,d|0)}function Eo(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0;C=De,De=De+16|0,w=C,P=!0&(h&2013265920|0)==268435456,b=h&-2130706433|134217728,B=d,a[B>>2]=P?A:0,a[B+4>>2]=P?b:0,P?(h=Ct(A|0,h|0,56)|0,Oe()|0,a[w>>2]=0,A=ge(A,b,h&7,w)|0,h=Oe()|0):(A=0,h=0),B=d+8|0,a[B>>2]=A,a[B+4>>2]=h,De=C}function Gl(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;b=(zr(A,h)|0)==0,h=h&-2130706433,w=d,a[w>>2]=b?A:0,a[w+4>>2]=b?h|285212672:0,w=d+8|0,a[w>>2]=A,a[w+4>>2]=h|301989888,w=d+16|0,a[w>>2]=A,a[w+4>>2]=h|318767104,w=d+24|0,a[w>>2]=A,a[w+4>>2]=h|335544320,w=d+32|0,a[w>>2]=A,a[w+4>>2]=h|352321536,d=d+40|0,a[d>>2]=A,a[d+4>>2]=h|369098752}function tl(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0;if(P=De,De=De+16|0,C=P,w=Ct(A|0,h|0,56)|0,Oe()|0,B=!0&(h&2013265920|0)==268435456,b=B?A:0,A=B?h&-2130706433|134217728:0,h=ps(b,A,w&7)|0,(h|0)==-1){a[d>>2]=0,De=P;return}Ja(b,A,C),w=Ct(b|0,A|0,52)|0,Oe()|0,w=w&15,zr(b,A)|0?uu(C,w,h,2,d):hu(C,w,h,2,d),De=P}function Th(A){A=A|0;var h=0,d=0,w=0;return h=es(1,12)|0,h||Mt(22691,22646,49,22704),d=A+4|0,w=a[d>>2]|0,w|0?(w=w+8|0,a[w>>2]=h,a[d>>2]=h,h|0):(a[A>>2]|0&&Mt(22721,22646,61,22744),w=A,a[w>>2]=h,a[d>>2]=h,h|0)}function Sh(A,h){A=A|0,h=h|0;var d=0,w=0;return w=Kt(24)|0,w||Mt(22758,22646,78,22772),a[w>>2]=a[h>>2],a[w+4>>2]=a[h+4>>2],a[w+8>>2]=a[h+8>>2],a[w+12>>2]=a[h+12>>2],a[w+16>>2]=0,h=A+4|0,d=a[h>>2]|0,d|0?(a[d+16>>2]=w,a[h>>2]=w,w|0):(a[A>>2]|0&&Mt(22787,22646,82,22772),a[A>>2]=w,a[h>>2]=w,w|0)}function nl(A){A=A|0;var h=0,d=0,w=0,b=0;if(A)for(w=1;;){if(h=a[A>>2]|0,h|0)do{if(d=a[h>>2]|0,d|0)do b=d,d=a[d+16>>2]|0,fn(b);while(d|0);b=h,h=a[h+8>>2]|0,fn(b)}while(h|0);if(h=A,A=a[A+8>>2]|0,w||fn(h),A)w=0;else break}}function Ea(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0,Ge=0,xe=0,y=0,m=0,x=0,E=0,I=0,R=0,O=0,U=0,q=0,ee=0,le=0,de=0;if(b=A+8|0,a[b>>2]|0)return de=1,de|0;if(w=a[A>>2]|0,!w)return de=0,de|0;h=w,d=0;do d=d+1|0,h=a[h+8>>2]|0;while(h|0);if(d>>>0<2)return de=0,de|0;ee=Kt(d<<2)|0,ee||Mt(22807,22646,317,22826),q=Kt(d<<5)|0,q||Mt(22848,22646,321,22826),a[A>>2]=0,m=A+4|0,a[m>>2]=0,a[b>>2]=0,d=0,U=0,y=0,ae=0;e:for(;;){if(X=a[w>>2]|0,X){C=0,P=X;do{if(V=+G[P+8>>3],h=P,P=a[P+16>>2]|0,W=(P|0)==0,b=W?X:P,B=+G[b+8>>3],+Pe(+(V-B))>3.141592653589793){de=14;break}C=C+(B-V)*(+G[h>>3]+ +G[b>>3])}while(!W);if((de|0)==14){de=0,C=0,h=X;do xe=+G[h+8>>3],O=h+16|0,R=a[O>>2]|0,R=R|0?R:X,Ge=+G[R+8>>3],C=C+(+G[h>>3]+ +G[R>>3])*((Ge<0?Ge+6.283185307179586:Ge)-(xe<0?xe+6.283185307179586:xe)),h=a[(h|0?O:w)>>2]|0;while(h|0)}C>0?(a[ee+(U<<2)>>2]=w,U=U+1|0,b=y,h=ae):de=19}else de=19;if((de|0)==19){de=0;do if(d){if(h=d+8|0,a[h>>2]|0){de=21;break e}if(d=es(1,12)|0,!d){de=23;break e}a[h>>2]=d,b=d+4|0,P=d,h=ae}else if(ae){b=m,P=ae+8|0,h=w,d=A;break}else if(a[A>>2]|0){de=27;break e}else{b=m,P=A,h=w,d=A;break}while(0);if(a[P>>2]=w,a[b>>2]=w,P=q+(y<<5)|0,W=a[w>>2]|0,W){for(X=q+(y<<5)+8|0,G[X>>3]=17976931348623157e292,ae=q+(y<<5)+24|0,G[ae>>3]=17976931348623157e292,G[P>>3]=-17976931348623157e292,ne=q+(y<<5)+16|0,G[ne>>3]=-17976931348623157e292,$e=17976931348623157e292,Se=-17976931348623157e292,b=0,ue=W,V=17976931348623157e292,Me=17976931348623157e292,ve=-17976931348623157e292,B=-17976931348623157e292;C=+G[ue>>3],xe=+G[ue+8>>3],ue=a[ue+16>>2]|0,be=(ue|0)==0,Ge=+G[(be?W:ue)+8>>3],C<V&&(G[X>>3]=C,V=C),xe<Me&&(G[ae>>3]=xe,Me=xe),C>ve?G[P>>3]=C:C=ve,xe>B&&(G[ne>>3]=xe,B=xe),$e=xe>0&xe<$e?xe:$e,Se=xe<0&xe>Se?xe:Se,b=b|+Pe(+(xe-Ge))>3.141592653589793,!be;)ve=C;b&&(G[ne>>3]=Se,G[ae>>3]=$e)}else a[P>>2]=0,a[P+4>>2]=0,a[P+8>>2]=0,a[P+12>>2]=0,a[P+16>>2]=0,a[P+20>>2]=0,a[P+24>>2]=0,a[P+28>>2]=0;b=y+1|0}if(O=w+8|0,w=a[O>>2]|0,a[O>>2]=0,w)y=b,ae=h;else{de=45;break}}if((de|0)==21)Mt(22624,22646,35,22658);else if((de|0)==23)Mt(22678,22646,37,22658);else if((de|0)==27)Mt(22721,22646,61,22744);else if((de|0)==45){e:do if((U|0)>0){for(O=(b|0)==0,I=b<<2,R=(A|0)==0,E=0,h=0;;){if(x=a[ee+(E<<2)>>2]|0,O)de=73;else{if(y=Kt(I)|0,!y){de=50;break}if(m=Kt(I)|0,!m){de=52;break}t:do if(R)d=0;else{for(b=0,d=0,P=A;w=q+(b<<5)|0,ds(a[P>>2]|0,w,a[x>>2]|0)|0?(a[y+(d<<2)>>2]=P,a[m+(d<<2)>>2]=w,be=d+1|0):be=d,P=a[P+8>>2]|0,P;)b=b+1|0,d=be;if((be|0)>0)if(w=a[y>>2]|0,(be|0)==1)d=w;else for(ne=0,ue=-1,d=w,ae=w;;){for(W=a[ae>>2]|0,w=0,P=0;b=a[a[y+(P<<2)>>2]>>2]|0,(b|0)==(W|0)?X=w:X=w+((ds(b,a[m+(P<<2)>>2]|0,a[W>>2]|0)|0)&1)|0,P=P+1|0,(P|0)!=(be|0);)w=X;if(b=(X|0)>(ue|0),d=b?ae:d,w=ne+1|0,(w|0)==(be|0))break t;ne=w,ue=b?X:ue,ae=a[y+(w<<2)>>2]|0}else d=0}while(0);if(fn(y),fn(m),d){if(b=d+4|0,w=a[b>>2]|0,w)d=w+8|0;else if(a[d>>2]|0){de=70;break}a[d>>2]=x,a[b>>2]=x}else de=73}if((de|0)==73){if(de=0,h=a[x>>2]|0,h|0)do m=h,h=a[h+16>>2]|0,fn(m);while(h|0);fn(x),h=2}if(E=E+1|0,(E|0)>=(U|0)){le=h;break e}}(de|0)==50?Mt(22863,22646,249,22882):(de|0)==52?Mt(22901,22646,252,22882):(de|0)==70&&Mt(22721,22646,61,22744)}else le=0;while(0);return fn(ee),fn(q),de=le,de|0}return 0}function ds(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0;if(!(TA(h,d)|0)||(h=EA(h)|0,W=+G[d>>3],w=+G[d+8>>3],w=h&w<0?w+6.283185307179586:w,A=a[A>>2]|0,!A))return A=0,A|0;if(h){h=0,d=A;e:for(;;){for(;P=+G[d>>3],V=+G[d+8>>3],d=d+16|0,X=a[d>>2]|0,X=X|0?X:A,C=+G[X>>3],b=+G[X+8>>3],P>C?(B=P,P=V):(B=C,C=P,P=b,b=V),!!(W<C|W>B);)if(d=a[d>>2]|0,!d){d=22;break e}if(V=b<0?b+6.283185307179586:b,P=P<0?P+6.283185307179586:P,w=P==w|V==w?w+-2220446049250313e-31:w,V=V+(W-C)/(B-C)*(P-V),(V<0?V+6.283185307179586:V)>w&&(h=h^1),d=a[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}else{h=0,d=A;e:for(;;){for(;P=+G[d>>3],V=+G[d+8>>3],d=d+16|0,X=a[d>>2]|0,X=X|0?X:A,C=+G[X>>3],b=+G[X+8>>3],P>C?(B=P,P=V):(B=C,C=P,P=b,b=V),!!(W<C|W>B);)if(d=a[d>>2]|0,!d){d=22;break e}if(w=P==w|b==w?w+-2220446049250313e-31:w,b+(W-C)/(B-C)*(P-b)>w&&(h=h^1),d=a[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}return 0}function Nt(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0;if(Se=De,De=De+32|0,$e=Se+16|0,ve=Se,C=Ct(A|0,h|0,52)|0,Oe()|0,C=C&15,ue=Ct(d|0,w|0,52)|0,Oe()|0,(C|0)!=(ue&15|0))return $e=1,De=Se,$e|0;if(W=Ct(A|0,h|0,45)|0,Oe()|0,W=W&127,X=Ct(d|0,w|0,45)|0,Oe()|0,X=X&127,ue=(W|0)!=(X|0),ue){if(B=bA(W,X)|0,(B|0)==7)return $e=2,De=Se,$e|0;V=bA(X,W)|0,(V|0)==7?Mt(22925,22949,151,22959):(be=B,P=V)}else be=0,P=0;ae=en(W)|0,ne=en(X)|0,a[$e>>2]=0,a[$e+4>>2]=0,a[$e+8>>2]=0,a[$e+12>>2]=0;do if(be){if(X=a[4304+(W*28|0)+(be<<2)>>2]|0,B=(X|0)>0,ne)if(B){W=0,V=d,B=w;do V=wa(V,B)|0,B=Oe()|0,P=Qi(P)|0,(P|0)==1&&(P=Qi(1)|0),W=W+1|0;while((W|0)!=(X|0));X=P,W=V,V=B}else X=P,W=d,V=w;else if(B){W=0,V=d,B=w;do V=Ki(V,B)|0,B=Oe()|0,P=Qi(P)|0,W=W+1|0;while((W|0)!=(X|0));X=P,W=V,V=B}else X=P,W=d,V=w;if(Ul(W,V,$e)|0,ue||Mt(22972,22949,181,22959),B=(ae|0)!=0,P=(ne|0)!=0,B&P&&Mt(22999,22949,182,22959),B){if(P=fi(A,h)|0,fe[22032+(P*7|0)+be>>0]|0){C=3;break}V=a[21200+(P*28|0)+(be<<2)>>2]|0,W=V,Me=26}else if(P){if(P=fi(W,V)|0,fe[22032+(P*7|0)+X>>0]|0){C=4;break}W=0,V=a[21200+(X*28|0)+(P<<2)>>2]|0,Me=26}else P=0;if((Me|0)==26)if((V|0)<=-1&&Mt(23030,22949,212,22959),(W|0)<=-1&&Mt(23053,22949,213,22959),(V|0)>0){B=$e+4|0,P=0;do Qo(B),P=P+1|0;while((P|0)!=(V|0));P=W}else P=W;if(a[ve>>2]=0,a[ve+4>>2]=0,a[ve+8>>2]=0,SA(ve,be),C|0)for(;mi(C)|0?ya(ve):vo(ve),(C|0)>1;)C=C+-1|0;if((P|0)>0){C=0;do Qo(ve),C=C+1|0;while((C|0)!=(P|0))}Me=$e+4|0,zn(Me,ve,Me),Yr(Me),Me=50}else if(Ul(d,w,$e)|0,(ae|0)!=0&(ne|0)!=0)if((X|0)!=(W|0)&&Mt(23077,22949,243,22959),P=fi(A,h)|0,C=fi(d,w)|0,fe[22032+(P*7|0)+C>>0]|0)C=5;else if(P=a[21200+(P*28|0)+(C<<2)>>2]|0,(P|0)>0){B=$e+4|0,C=0;do Qo(B),C=C+1|0;while((C|0)!=(P|0));Me=50}else Me=50;else Me=50;while(0);return(Me|0)==50&&(C=$e+4|0,a[b>>2]=a[C>>2],a[b+4>>2]=a[C+4>>2],a[b+8>>2]=a[C+8>>2],C=0),$e=C,De=Se,$e|0}function gu(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0;if(be=De,De=De+48|0,P=be+36|0,B=be+24|0,V=be+12|0,W=be,C=Ct(A|0,h|0,52)|0,Oe()|0,C=C&15,ne=Ct(A|0,h|0,45)|0,Oe()|0,ne=ne&127,X=en(ne)|0,Pt(C|0,0,52)|0,ve=Oe()|0|134225919,Me=w,a[Me>>2]=-1,a[Me+4>>2]=ve,!C)return(a[d>>2]|0)>1||(a[d+4>>2]|0)>1||(a[d+8>>2]|0)>1||(b=su(ne,_o(d)|0)|0,(b|0)==127)?(ve=1,De=be,ve|0):(ue=Pt(b|0,0,45)|0,Me=Oe()|0,ne=w,Me=a[ne+4>>2]&-1040385|Me,ve=w,a[ve>>2]=a[ne>>2]|ue,a[ve+4>>2]=Me,ve=0,De=be,ve|0);for(a[P>>2]=a[d>>2],a[P+4>>2]=a[d+4>>2],a[P+8>>2]=a[d+8>>2];a[B>>2]=a[P>>2],a[B+4>>2]=a[P+4>>2],a[B+8>>2]=a[P+8>>2],mi(C)|0?(Ll(P),a[V>>2]=a[P>>2],a[V+4>>2]=a[P+4>>2],a[V+8>>2]=a[P+8>>2],ya(V)):(Wo(P),a[V>>2]=a[P>>2],a[V+4>>2]=a[P+4>>2],a[V+8>>2]=a[P+8>>2],vo(V)),Cs(B,V,W),Yr(W),Me=w,$e=a[Me>>2]|0,Me=a[Me+4>>2]|0,Se=(15-C|0)*3|0,d=Pt(7,0,Se|0)|0,Me=Me&~(Oe()|0),Se=Pt(_o(W)|0,0,Se|0)|0,Me=Oe()|0|Me,ve=w,a[ve>>2]=Se|$e&~d,a[ve+4>>2]=Me,(C|0)>1;)C=C+-1|0;e:do if((a[P>>2]|0)<=1&&(a[P+4>>2]|0)<=1&&(a[P+8>>2]|0)<=1){C=_o(P)|0,B=su(ne,C)|0,(B|0)==127?W=0:W=en(B)|0;t:do if(C){if(X){if(P=21408+((fi(A,h)|0)*28|0)+(C<<2)|0,P=a[P>>2]|0,(P|0)>0){d=0;do C=Wi(C)|0,d=d+1|0;while((d|0)!=(P|0))}if((C|0)==1){b=3;break e}d=su(ne,C)|0,(d|0)==127&&Mt(23104,22949,376,23134),en(d)|0?Mt(23147,22949,377,23134):(ue=P,ae=C,b=d)}else ue=0,ae=C,b=B;if(V=a[4304+(ne*28|0)+(ae<<2)>>2]|0,(V|0)<=-1&&Mt(23178,22949,384,23134),!W){if((ue|0)<=-1&&Mt(23030,22949,417,23134),ue|0){P=w,C=0,d=a[P>>2]|0,P=a[P+4>>2]|0;do d=hs(d,P)|0,P=Oe()|0,Se=w,a[Se>>2]=d,a[Se+4>>2]=P,C=C+1|0;while((C|0)<(ue|0))}if((V|0)<=0){C=54;break}for(P=w,C=0,d=a[P>>2]|0,P=a[P+4>>2]|0;;)if(d=hs(d,P)|0,P=Oe()|0,Se=w,a[Se>>2]=d,a[Se+4>>2]=P,C=C+1|0,(C|0)==(V|0)){C=54;break t}}if(B=bA(b,ne)|0,(B|0)==7&&Mt(22925,22949,393,23134),C=w,d=a[C>>2]|0,C=a[C+4>>2]|0,(V|0)>0){P=0;do d=hs(d,C)|0,C=Oe()|0,Se=w,a[Se>>2]=d,a[Se+4>>2]=C,P=P+1|0;while((P|0)!=(V|0))}if(d=fi(d,C)|0,Se=Br(b)|0,d=a[(Se?21824:21616)+(B*28|0)+(d<<2)>>2]|0,(d|0)<=-1&&Mt(23030,22949,412,23134),!d)C=54;else{B=w,C=0,P=a[B>>2]|0,B=a[B+4>>2]|0;do P=Ei(P,B)|0,B=Oe()|0,Se=w,a[Se>>2]=P,a[Se+4>>2]=B,C=C+1|0;while((C|0)<(d|0));C=54}}else if((X|0)!=0&(W|0)!=0)if(Se=fi(A,h)|0,C=w,C=21408+(Se*28|0)+((fi(a[C>>2]|0,a[C+4>>2]|0)|0)<<2)|0,C=a[C>>2]|0,(C|0)<=-1&&Mt(23201,22949,433,23134),!C)b=B,C=55;else{P=w,b=0,d=a[P>>2]|0,P=a[P+4>>2]|0;do d=hs(d,P)|0,P=Oe()|0,Se=w,a[Se>>2]=d,a[Se+4>>2]=P,b=b+1|0;while((b|0)<(C|0));b=B,C=54}else b=B,C=54;while(0);if((C|0)==54&&W&&(C=55),(C|0)==55&&(Se=w,(fi(a[Se>>2]|0,a[Se+4>>2]|0)|0)==1)){b=4;break}Se=w,ve=a[Se>>2]|0,Se=a[Se+4>>2]&-1040385,$e=Pt(b|0,0,45)|0,Se=Se|(Oe()|0),b=w,a[b>>2]=ve|$e,a[b+4>>2]=Se,b=0}else b=2;while(0);return Se=b,De=be,Se|0}function Ta(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0;return P=De,De=De+16|0,C=P,A=Nt(A,h,d,w,C)|0,A||(qo(C,b),A=0),De=P,A|0}function Ko(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0;return b=De,De=De+16|0,C=b,mc(d,C),w=gu(A,h,C,w)|0,De=b,w|0}function mu(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0;return P=De,De=De+32|0,b=P+12|0,C=P,!(Nt(A,h,A,h,b)|0)&&!(Nt(A,h,d,w,C)|0)?A=xo(b,C)|0:A=-1,De=P,A|0}function Vt(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0,P=0;return P=De,De=De+32|0,b=P+12|0,C=P,!(Nt(A,h,A,h,b)|0)&&!(Nt(A,h,d,w,C)|0)?A=xo(b,C)|0:A=-1,De=P,(A>>>31^1)+A|0}function kA(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0,Ge=0,xe=0,y=0,m=0;if(y=De,De=De+48|0,C=y+24|0,P=y+12|0,xe=y,!(Nt(A,h,A,h,C)|0)&&!(Nt(A,h,d,w,P)|0)){if(Ge=xo(C,P)|0,(Ge|0)<0)return xe=Ge,De=y,xe|0;for(a[C>>2]=0,a[C+4>>2]=0,a[C+8>>2]=0,a[P>>2]=0,a[P+4>>2]=0,a[P+8>>2]=0,Nt(A,h,A,h,C)|0,Nt(A,h,d,w,P)|0,lu(C),lu(P),Ge?(X=a[C>>2]|0,ue=+(Ge|0),ve=C+4|0,ae=a[ve>>2]|0,$e=C+8|0,ne=a[$e>>2]|0,Se=C,d=X,w=ae,C=ne,be=+((a[P>>2]|0)-X|0)/ue,Me=+((a[P+4>>2]|0)-ae|0)/ue,ue=+((a[P+8>>2]|0)-ne|0)/ue):(w=C+4|0,ne=C+8|0,ve=w,$e=ne,Se=C,d=a[C>>2]|0,w=a[w>>2]|0,C=a[ne>>2]|0,be=0,Me=0,ue=0),a[xe>>2]=d,ne=xe+4|0,a[ne>>2]=w,ae=xe+8|0,a[ae>>2]=C,X=0;;){V=+(X|0),m=be*V+ +(d|0),B=Me*V+ +(a[ve>>2]|0),V=ue*V+ +(a[$e>>2]|0),w=~~+sl(+m),P=~~+sl(+B),d=~~+sl(+V),m=+Pe(+(+(w|0)-m)),B=+Pe(+(+(P|0)-B)),V=+Pe(+(+(d|0)-V));do if(m>B&m>V)w=0-(P+d)|0,C=P;else if(W=0-w|0,B>V){C=W-d|0;break}else{C=P,d=W-P|0;break}while(0);if(a[xe>>2]=w,a[ne>>2]=C,a[ae>>2]=d,Rl(xe),gu(A,h,xe,b+(X<<3)|0)|0,(X|0)==(Ge|0))break;X=X+1|0,d=a[Se>>2]|0}return xe=0,De=y,xe|0}return xe=-1,De=y,xe|0}function $l(A,h){A=A|0,h=h|0;var d=0;if(!h)return d=1,d|0;d=A,A=1;do A=qt(h&1|0?d:1,A)|0,h=h>>1,d=qt(d,d)|0;while(h|0);return A|0}function IA(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0;if(!(TA(h,d)|0)||(h=EA(h)|0,ne=+G[d>>3],w=+G[d+8>>3],w=h&w<0?w+6.283185307179586:w,ae=a[A>>2]|0,(ae|0)<=0))return ae=0,ae|0;if(X=a[A+4>>2]|0,h){h=0,d=-1,A=0;e:for(;;){for(W=A;P=+G[X+(W<<4)>>3],V=+G[X+(W<<4)+8>>3],A=(d+2|0)%(ae|0)|0,C=+G[X+(A<<4)>>3],b=+G[X+(A<<4)+8>>3],P>C?(B=P,P=V):(B=C,C=P,P=b,b=V),!!(ne<C|ne>B);)if(d=W+1|0,(d|0)<(ae|0))A=W,W=d,d=A;else{d=22;break e}if(V=b<0?b+6.283185307179586:b,P=P<0?P+6.283185307179586:P,w=P==w|V==w?w+-2220446049250313e-31:w,V=V+(ne-C)/(B-C)*(P-V),(V<0?V+6.283185307179586:V)>w&&(h=h^1),A=W+1|0,(A|0)>=(ae|0)){d=22;break}else d=W}if((d|0)==22)return h|0}else{h=0,d=-1,A=0;e:for(;;){for(W=A;P=+G[X+(W<<4)>>3],V=+G[X+(W<<4)+8>>3],A=(d+2|0)%(ae|0)|0,C=+G[X+(A<<4)>>3],b=+G[X+(A<<4)+8>>3],P>C?(B=P,P=V):(B=C,C=P,P=b,b=V),!!(ne<C|ne>B);)if(d=W+1|0,(d|0)<(ae|0))A=W,W=d,d=A;else{d=22;break e}if(w=P==w|b==w?w+-2220446049250313e-31:w,b+(ne-C)/(B-C)*(P-b)>w&&(h=h^1),A=W+1|0,(A|0)>=(ae|0)){d=22;break}else d=W}if((d|0)==22)return h|0}return 0}function rl(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0;if(be=a[A>>2]|0,!be){a[h>>2]=0,a[h+4>>2]=0,a[h+8>>2]=0,a[h+12>>2]=0,a[h+16>>2]=0,a[h+20>>2]=0,a[h+24>>2]=0,a[h+28>>2]=0;return}if(Me=h+8|0,G[Me>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,$e=h+16|0,G[$e>>3]=-17976931348623157e292,!((be|0)<=0)){for(ne=a[A+4>>2]|0,W=17976931348623157e292,X=-17976931348623157e292,ae=0,A=-1,C=17976931348623157e292,P=17976931348623157e292,V=-17976931348623157e292,w=-17976931348623157e292,ue=0;d=+G[ne+(ue<<4)>>3],B=+G[ne+(ue<<4)+8>>3],A=A+2|0,b=+G[ne+(((A|0)==(be|0)?0:A)<<4)+8>>3],d<C&&(G[Me>>3]=d,C=d),B<P&&(G[ve>>3]=B,P=B),d>V?G[h>>3]=d:d=V,B>w&&(G[$e>>3]=B,w=B),W=B>0&B<W?B:W,X=B<0&B>X?B:X,ae=ae|+Pe(+(B-b))>3.141592653589793,A=ue+1|0,(A|0)!=(be|0);)Se=ue,V=d,ue=A,A=Se;ae&&(G[$e>>3]=X,G[ve>>3]=W)}}function Qs(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0,Ge=0,xe=0,y=0,m=0,x=0;if(be=a[A>>2]|0,be){if(Me=h+8|0,G[Me>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,$e=h+16|0,G[$e>>3]=-17976931348623157e292,(be|0)>0){for(b=a[A+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,w=0,d=-1,V=17976931348623157e292,W=17976931348623157e292,ae=-17976931348623157e292,P=-17976931348623157e292,Se=0;C=+G[b+(Se<<4)>>3],X=+G[b+(Se<<4)+8>>3],m=d+2|0,B=+G[b+(((m|0)==(be|0)?0:m)<<4)+8>>3],C<V&&(G[Me>>3]=C,V=C),X<W&&(G[ve>>3]=X,W=X),C>ae?G[h>>3]=C:C=ae,X>P&&(G[$e>>3]=X,P=X),ne=X>0&X<ne?X:ne,ue=X<0&X>ue?X:ue,w=w|+Pe(+(X-B))>3.141592653589793,d=Se+1|0,(d|0)!=(be|0);)m=Se,ae=C,Se=d,d=m;w&&(G[$e>>3]=ue,G[ve>>3]=ne)}}else a[h>>2]=0,a[h+4>>2]=0,a[h+8>>2]=0,a[h+12>>2]=0,a[h+16>>2]=0,a[h+20>>2]=0,a[h+24>>2]=0,a[h+28>>2]=0;if(m=A+8|0,d=a[m>>2]|0,!((d|0)<=0)){y=A+12|0,xe=0;do if(b=a[y>>2]|0,w=xe,xe=xe+1|0,ve=h+(xe<<5)|0,$e=a[b+(w<<3)>>2]|0,$e){if(Se=h+(xe<<5)+8|0,G[Se>>3]=17976931348623157e292,A=h+(xe<<5)+24|0,G[A>>3]=17976931348623157e292,G[ve>>3]=-17976931348623157e292,Ge=h+(xe<<5)+16|0,G[Ge>>3]=-17976931348623157e292,($e|0)>0){for(be=a[b+(w<<3)+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,b=0,w=-1,Me=0,V=17976931348623157e292,W=17976931348623157e292,X=-17976931348623157e292,P=-17976931348623157e292;C=+G[be+(Me<<4)>>3],ae=+G[be+(Me<<4)+8>>3],w=w+2|0,B=+G[be+(((w|0)==($e|0)?0:w)<<4)+8>>3],C<V&&(G[Se>>3]=C,V=C),ae<W&&(G[A>>3]=ae,W=ae),C>X?G[ve>>3]=C:C=X,ae>P&&(G[Ge>>3]=ae,P=ae),ne=ae>0&ae<ne?ae:ne,ue=ae<0&ae>ue?ae:ue,b=b|+Pe(+(ae-B))>3.141592653589793,w=Me+1|0,(w|0)!=($e|0);)x=Me,Me=w,X=C,w=x;b&&(G[Ge>>3]=ue,G[A>>3]=ne)}}else a[ve>>2]=0,a[ve+4>>2]=0,a[ve+8>>2]=0,a[ve+12>>2]=0,a[ve+16>>2]=0,a[ve+20>>2]=0,a[ve+24>>2]=0,a[ve+28>>2]=0,d=a[m>>2]|0;while((xe|0)<(d|0))}}function yu(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0;if(!(IA(A,h,d)|0))return b=0,b|0;if(b=A+8|0,(a[b>>2]|0)<=0)return b=1,b|0;for(w=A+12|0,A=0;;){if(C=A,A=A+1|0,IA((a[w>>2]|0)+(C<<3)|0,h+(A<<5)|0,d)|0){A=0,w=6;break}if((A|0)>=(a[b>>2]|0)){A=1,w=6;break}}return(w|0)==6?A|0:0}function Ch(){return 8}function Ec(){return 16}function _u(){return 168}function vu(){return 8}function xu(){return 16}function qs(){return 12}function Bi(){return 8}function To(A){A=A|0;var h=0,d=0;return d=+G[A>>3],h=+G[A+8>>3],+ +Ie(+(d*d+h*h))}function wu(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0;W=+G[A>>3],V=+G[h>>3]-W,B=+G[A+8>>3],P=+G[h+8>>3]-B,ae=+G[d>>3],C=+G[w>>3]-ae,ne=+G[d+8>>3],X=+G[w+8>>3]-ne,C=(C*(B-ne)-(W-ae)*X)/(V*X-P*C),G[b>>3]=W+V*C,G[b+8>>3]=B+P*C}function Sa(A,h){return A=A|0,h=h|0,+G[A>>3]!=+G[h>>3]?(h=0,h|0):(h=+G[A+8>>3]==+G[h+8>>3],h|0)}function Ur(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;return b=+G[A>>3]-+G[h>>3],w=+G[A+8>>3]-+G[h+8>>3],d=+G[A+16>>3]-+G[h+16>>3],+(b*b+w*w+d*d)}function jl(A,h){A=A|0,h=h|0;var d=0,w=0,b=0;d=+G[A>>3],w=+At(+d),d=+We(+d),G[h+16>>3]=d,d=+G[A+8>>3],b=w*+At(+d),G[h>>3]=b,d=w*+We(+d),G[h+8>>3]=d}function Tc(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0;if(W=De,De=De+32|0,b=W+16|0,C=W,Ja(A,h,b),P=cs(A,h)|0,V=fi(A,h)|0,xA(P,C),h=wA(P,a[b>>2]|0)|0,!(en(P)|0))return V=h,De=W,V|0;do switch(P|0){case 4:{A=0,d=14;break}case 14:{A=1,d=14;break}case 24:{A=2,d=14;break}case 38:{A=3,d=14;break}case 49:{A=4,d=14;break}case 58:{A=5,d=14;break}case 63:{A=6,d=14;break}case 72:{A=7,d=14;break}case 83:{A=8,d=14;break}case 97:{A=9,d=14;break}case 107:{A=10,d=14;break}case 117:{A=11,d=14;break}default:B=0,w=0}while(0);return(d|0)==14&&(B=a[22096+(A*24|0)+8>>2]|0,w=a[22096+(A*24|0)+16>>2]|0),A=a[b>>2]|0,(A|0)!=(a[C>>2]|0)&&(P=Br(P)|0,A=a[b>>2]|0,P|(A|0)==(w|0)&&(h=(h+1|0)%6|0)),(V|0)==3&(A|0)==(w|0)?(V=(h+5|0)%6|0,De=W,V|0):(V|0)==5&(A|0)==(B|0)?(V=(h+1|0)%6|0,De=W,V|0):(V=h,De=W,V|0)}function ps(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;return w=zr(A,h)|0,(d+-1|0)>>>0>5||(b=(w|0)!=0,(d|0)==1&b)?(d=-1,d|0):(w=Tc(A,h)|0,b?(d=(5-w+(a[22384+(d<<2)>>2]|0)|0)%5|0,d|0):(d=(6-w+(a[22416+(d<<2)>>2]|0)|0)%6|0,d|0))}function Mr(A,h,d){A=A|0,h=h|0,d=d|0;var w=0;(h|0)>0?(w=es(h,4)|0,a[A>>2]=w,w||Mt(23230,23253,40,23267)):a[A>>2]=0,a[A+4>>2]=h,a[A+8>>2]=0,a[A+12>>2]=d}function il(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0;b=A+4|0,C=A+12|0,P=A+8|0;e:for(;;){for(d=a[b>>2]|0,h=0;;){if((h|0)>=(d|0))break e;if(w=a[A>>2]|0,B=a[w+(h<<2)>>2]|0,!B)h=h+1|0;else break}h=w+(~~(+Pe(+(+qe(10,+ +(15-(a[C>>2]|0)|0))*(+G[B>>3]+ +G[B+8>>3])))%+(d|0))>>>0<<2)|0,d=a[h>>2]|0;t:do if(d|0){if(w=B+32|0,(d|0)==(B|0))a[h>>2]=a[w>>2];else{if(d=d+32|0,h=a[d>>2]|0,!h)break;for(;(h|0)!=(B|0);)if(d=h+32|0,h=a[d>>2]|0,!h)break t;a[d>>2]=a[w>>2]}fn(B),a[P>>2]=(a[P>>2]|0)+-1}while(0)}fn(a[A>>2]|0)}function Hl(A){A=A|0;var h=0,d=0,w=0;for(w=a[A+4>>2]|0,d=0;;){if((d|0)>=(w|0)){h=0,d=4;break}if(h=a[(a[A>>2]|0)+(d<<2)>>2]|0,!h)d=d+1|0;else{d=4;break}}return(d|0)==4?h|0:0}function bu(A,h){A=A|0,h=h|0;var d=0,w=0,b=0,C=0;if(d=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,d=(a[A>>2]|0)+(d<<2)|0,w=a[d>>2]|0,!w)return C=1,C|0;C=h+32|0;do if((w|0)!=(h|0)){if(d=a[w+32>>2]|0,!d)return C=1,C|0;for(b=d;;){if((b|0)==(h|0)){b=8;break}if(d=a[b+32>>2]|0,d)w=b,b=d;else{d=1,b=10;break}}if((b|0)==8){a[w+32>>2]=a[C>>2];break}else if((b|0)==10)return d|0}else a[d>>2]=a[C>>2];while(0);return fn(h),C=A+8|0,a[C>>2]=(a[C>>2]|0)+-1,C=0,C|0}function Sc(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0;C=Kt(40)|0,C||Mt(23283,23253,98,23296),a[C>>2]=a[h>>2],a[C+4>>2]=a[h+4>>2],a[C+8>>2]=a[h+8>>2],a[C+12>>2]=a[h+12>>2],b=C+16|0,a[b>>2]=a[d>>2],a[b+4>>2]=a[d+4>>2],a[b+8>>2]=a[d+8>>2],a[b+12>>2]=a[d+12>>2],a[C+32>>2]=0,b=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,b=(a[A>>2]|0)+(b<<2)|0,w=a[b>>2]|0;do if(!w)a[b>>2]=C;else{for(;!($s(w,h)|0&&$s(w+16|0,d)|0);)if(b=a[w+32>>2]|0,w=b|0?b:w,!(a[w+32>>2]|0)){P=10;break}if((P|0)==10){a[w+32>>2]=C;break}return fn(C),P=w,P|0}while(0);return P=A+8|0,a[P>>2]=(a[P>>2]|0)+1,P=C,P|0}function Eu(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0;if(b=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,b=a[(a[A>>2]|0)+(b<<2)>>2]|0,!b)return d=0,d|0;if(!d){for(A=b;;){if($s(A,h)|0){w=10;break}if(A=a[A+32>>2]|0,!A){A=0,w=10;break}}if((w|0)==10)return A|0}for(A=b;;){if($s(A,h)|0&&$s(A+16|0,d)|0){w=10;break}if(A=a[A+32>>2]|0,!A){A=0,w=10;break}}return(w|0)==10?A|0:0}function Cc(A,h){A=A|0,h=h|0;var d=0;if(d=~~(+Pe(+(+qe(10,+ +(15-(a[A+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[A+4>>2]|0))>>>0,A=a[(a[A>>2]|0)+(d<<2)>>2]|0,!A)return d=0,d|0;for(;;){if($s(A,h)|0){h=5;break}if(A=a[A+32>>2]|0,!A){A=0,h=5;break}}return(h|0)==5?A|0:0}function mr(){return 23312}function Wl(A){return A=+A,+ +c(+A)}function Xt(A){return A=+A,~~+Wl(A)|0}function Kt(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0,Me=0,ve=0,$e=0,Se=0,Ge=0,xe=0,y=0;y=De,De=De+16|0,ne=y;do if(A>>>0<245){if(W=A>>>0<11?16:A+11&-8,A=W>>>3,ae=a[5829]|0,d=ae>>>A,d&3|0)return h=(d&1^1)+A|0,A=23356+(h<<1<<2)|0,d=A+8|0,w=a[d>>2]|0,b=w+8|0,C=a[b>>2]|0,(C|0)==(A|0)?a[5829]=ae&~(1<<h):(a[C+12>>2]=A,a[d>>2]=C),xe=h<<3,a[w+4>>2]=xe|3,xe=w+xe+4|0,a[xe>>2]=a[xe>>2]|1,xe=b,De=y,xe|0;if(X=a[5831]|0,W>>>0>X>>>0){if(d|0)return h=2<<A,h=d<<A&(h|0-h),h=(h&0-h)+-1|0,B=h>>>12&16,h=h>>>B,d=h>>>5&8,h=h>>>d,C=h>>>2&4,h=h>>>C,A=h>>>1&2,h=h>>>A,w=h>>>1&1,w=(d|B|C|A|w)+(h>>>w)|0,h=23356+(w<<1<<2)|0,A=h+8|0,C=a[A>>2]|0,B=C+8|0,d=a[B>>2]|0,(d|0)==(h|0)?(A=ae&~(1<<w),a[5829]=A):(a[d+12>>2]=h,a[A>>2]=d,A=ae),xe=w<<3,P=xe-W|0,a[C+4>>2]=W|3,b=C+W|0,a[b+4>>2]=P|1,a[C+xe>>2]=P,X|0&&(w=a[5834]|0,h=X>>>3,d=23356+(h<<1<<2)|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=w,a[h+12>>2]=w,a[w+8>>2]=h,a[w+12>>2]=d),a[5831]=P,a[5834]=b,xe=B,De=y,xe|0;if(C=a[5830]|0,C){for(d=(C&0-C)+-1|0,b=d>>>12&16,d=d>>>b,w=d>>>5&8,d=d>>>w,P=d>>>2&4,d=d>>>P,B=d>>>1&2,d=d>>>B,V=d>>>1&1,V=a[23620+((w|b|P|B|V)+(d>>>V)<<2)>>2]|0,d=V,B=V,V=(a[V+4>>2]&-8)-W|0;A=a[d+16>>2]|0,!(!A&&(A=a[d+20>>2]|0,!A));)P=(a[A+4>>2]&-8)-W|0,b=P>>>0<V>>>0,d=A,B=b?A:B,V=b?P:V;if(P=B+W|0,P>>>0>B>>>0){b=a[B+24>>2]|0,h=a[B+12>>2]|0;do if((h|0)==(B|0)){if(A=B+20|0,h=a[A>>2]|0,!h&&(A=B+16|0,h=a[A>>2]|0,!h)){d=0;break}for(;;)if(w=h+20|0,d=a[w>>2]|0,d)h=d,A=w;else if(w=h+16|0,d=a[w>>2]|0,d)h=d,A=w;else break;a[A>>2]=0,d=h}else d=a[B+8>>2]|0,a[d+12>>2]=h,a[h+8>>2]=d,d=h;while(0);do if(b|0){if(h=a[B+28>>2]|0,A=23620+(h<<2)|0,(B|0)==(a[A>>2]|0)){if(a[A>>2]=d,!d){a[5830]=C&~(1<<h);break}}else if(xe=b+16|0,a[((a[xe>>2]|0)==(B|0)?xe:b+20|0)>>2]=d,!d)break;a[d+24>>2]=b,h=a[B+16>>2]|0,h|0&&(a[d+16>>2]=h,a[h+24>>2]=d),h=a[B+20>>2]|0,h|0&&(a[d+20>>2]=h,a[h+24>>2]=d)}while(0);return V>>>0<16?(xe=V+W|0,a[B+4>>2]=xe|3,xe=B+xe+4|0,a[xe>>2]=a[xe>>2]|1):(a[B+4>>2]=W|3,a[P+4>>2]=V|1,a[P+V>>2]=V,X|0&&(w=a[5834]|0,h=X>>>3,d=23356+(h<<1<<2)|0,h=1<<h,h&ae?(A=d+8|0,h=a[A>>2]|0):(a[5829]=h|ae,h=d,A=d+8|0),a[A>>2]=w,a[h+12>>2]=w,a[w+8>>2]=h,a[w+12>>2]=d),a[5831]=V,a[5834]=P),xe=B+8|0,De=y,xe|0}else ae=W}else ae=W}else ae=W}else if(A>>>0<=4294967231)if(A=A+11|0,W=A&-8,w=a[5830]|0,w){b=0-W|0,A=A>>>8,A?W>>>0>16777215?V=31:(ae=(A+1048320|0)>>>16&8,Me=A<<ae,B=(Me+520192|0)>>>16&4,Me=Me<<B,V=(Me+245760|0)>>>16&2,V=14-(B|ae|V)+(Me<<V>>>15)|0,V=W>>>(V+7|0)&1|V<<1):V=0,d=a[23620+(V<<2)>>2]|0;e:do if(!d)d=0,A=0,Me=61;else for(A=0,B=W<<((V|0)==31?0:25-(V>>>1)|0),C=0;;){if(P=(a[d+4>>2]&-8)-W|0,P>>>0<b>>>0)if(P)A=d,b=P;else{A=d,b=0,Me=65;break e}if(Me=a[d+20>>2]|0,d=a[d+16+(B>>>31<<2)>>2]|0,C=(Me|0)==0|(Me|0)==(d|0)?C:Me,d)B=B<<1;else{d=C,Me=61;break}}while(0);if((Me|0)==61){if((d|0)==0&(A|0)==0){if(A=2<<V,A=(A|0-A)&w,!A){ae=W;break}ae=(A&0-A)+-1|0,P=ae>>>12&16,ae=ae>>>P,C=ae>>>5&8,ae=ae>>>C,B=ae>>>2&4,ae=ae>>>B,V=ae>>>1&2,ae=ae>>>V,d=ae>>>1&1,A=0,d=a[23620+((C|P|B|V|d)+(ae>>>d)<<2)>>2]|0}d?Me=65:(B=A,P=b)}if((Me|0)==65)for(C=d;;)if(ae=(a[C+4>>2]&-8)-W|0,d=ae>>>0<b>>>0,b=d?ae:b,A=d?C:A,d=a[C+16>>2]|0,d||(d=a[C+20>>2]|0),d)C=d;else{B=A,P=b;break}if(B|0&&P>>>0<((a[5831]|0)-W|0)>>>0&&(X=B+W|0,X>>>0>B>>>0)){C=a[B+24>>2]|0,h=a[B+12>>2]|0;do if((h|0)==(B|0)){if(A=B+20|0,h=a[A>>2]|0,!h&&(A=B+16|0,h=a[A>>2]|0,!h)){h=0;break}for(;;)if(b=h+20|0,d=a[b>>2]|0,d)h=d,A=b;else if(b=h+16|0,d=a[b>>2]|0,d)h=d,A=b;else break;a[A>>2]=0}else xe=a[B+8>>2]|0,a[xe+12>>2]=h,a[h+8>>2]=xe;while(0);do if(C){if(A=a[B+28>>2]|0,d=23620+(A<<2)|0,(B|0)==(a[d>>2]|0)){if(a[d>>2]=h,!h){w=w&~(1<<A),a[5830]=w;break}}else if(xe=C+16|0,a[((a[xe>>2]|0)==(B|0)?xe:C+20|0)>>2]=h,!h)break;a[h+24>>2]=C,A=a[B+16>>2]|0,A|0&&(a[h+16>>2]=A,a[A+24>>2]=h),A=a[B+20>>2]|0,A&&(a[h+20>>2]=A,a[A+24>>2]=h)}while(0);e:do if(P>>>0<16)xe=P+W|0,a[B+4>>2]=xe|3,xe=B+xe+4|0,a[xe>>2]=a[xe>>2]|1;else{if(a[B+4>>2]=W|3,a[X+4>>2]=P|1,a[X+P>>2]=P,h=P>>>3,P>>>0<256){d=23356+(h<<1<<2)|0,A=a[5829]|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=X,a[h+12>>2]=X,a[X+8>>2]=h,a[X+12>>2]=d;break}if(h=P>>>8,h?P>>>0>16777215?d=31:(Ge=(h+1048320|0)>>>16&8,xe=h<<Ge,Se=(xe+520192|0)>>>16&4,xe=xe<<Se,d=(xe+245760|0)>>>16&2,d=14-(Se|Ge|d)+(xe<<d>>>15)|0,d=P>>>(d+7|0)&1|d<<1):d=0,h=23620+(d<<2)|0,a[X+28>>2]=d,A=X+16|0,a[A+4>>2]=0,a[A>>2]=0,A=1<<d,!(w&A)){a[5830]=w|A,a[h>>2]=X,a[X+24>>2]=h,a[X+12>>2]=X,a[X+8>>2]=X;break}h=a[h>>2]|0;t:do if((a[h+4>>2]&-8|0)!=(P|0)){for(w=P<<((d|0)==31?0:25-(d>>>1)|0);d=h+16+(w>>>31<<2)|0,A=a[d>>2]|0,!!A;)if((a[A+4>>2]&-8|0)==(P|0)){h=A;break t}else w=w<<1,h=A;a[d>>2]=X,a[X+24>>2]=h,a[X+12>>2]=X,a[X+8>>2]=X;break e}while(0);Ge=h+8|0,xe=a[Ge>>2]|0,a[xe+12>>2]=X,a[Ge>>2]=X,a[X+8>>2]=xe,a[X+12>>2]=h,a[X+24>>2]=0}while(0);return xe=B+8|0,De=y,xe|0}else ae=W}else ae=W;else ae=-1;while(0);if(d=a[5831]|0,d>>>0>=ae>>>0)return h=d-ae|0,A=a[5834]|0,h>>>0>15?(xe=A+ae|0,a[5834]=xe,a[5831]=h,a[xe+4>>2]=h|1,a[A+d>>2]=h,a[A+4>>2]=ae|3):(a[5831]=0,a[5834]=0,a[A+4>>2]=d|3,xe=A+d+4|0,a[xe>>2]=a[xe>>2]|1),xe=A+8|0,De=y,xe|0;if(P=a[5832]|0,P>>>0>ae>>>0)return Se=P-ae|0,a[5832]=Se,xe=a[5835]|0,Ge=xe+ae|0,a[5835]=Ge,a[Ge+4>>2]=Se|1,a[xe+4>>2]=ae|3,xe=xe+8|0,De=y,xe|0;if(a[5947]|0?A=a[5949]|0:(a[5949]=4096,a[5948]=4096,a[5950]=-1,a[5951]=-1,a[5952]=0,a[5940]=0,a[5947]=ne&-16^1431655768,A=4096),B=ae+48|0,V=ae+47|0,C=A+V|0,b=0-A|0,W=C&b,W>>>0<=ae>>>0||(A=a[5939]|0,A|0&&(X=a[5937]|0,ne=X+W|0,ne>>>0<=X>>>0|ne>>>0>A>>>0)))return xe=0,De=y,xe|0;e:do if(a[5940]&4)h=0,Me=143;else{d=a[5835]|0;t:do if(d){for(w=23764;ne=a[w>>2]|0,!(ne>>>0<=d>>>0&&(ne+(a[w+4>>2]|0)|0)>>>0>d>>>0);)if(A=a[w+8>>2]|0,A)w=A;else{Me=128;break t}if(h=C-P&b,h>>>0<2147483647)if(A=_(h|0)|0,(A|0)==((a[w>>2]|0)+(a[w+4>>2]|0)|0)){if((A|0)!=-1){P=h,C=A,Me=145;break e}}else w=A,Me=136;else h=0}else Me=128;while(0);do if((Me|0)==128)if(d=_(0)|0,(d|0)!=-1&&(h=d,ue=a[5948]|0,be=ue+-1|0,h=(be&h|0?(be+h&0-ue)-h|0:0)+W|0,ue=a[5937]|0,be=h+ue|0,h>>>0>ae>>>0&h>>>0<2147483647)){if(ne=a[5939]|0,ne|0&&be>>>0<=ue>>>0|be>>>0>ne>>>0){h=0;break}if(A=_(h|0)|0,(A|0)==(d|0)){P=h,C=d,Me=145;break e}else w=A,Me=136}else h=0;while(0);do if((Me|0)==136){if(d=0-h|0,!(B>>>0>h>>>0&(h>>>0<2147483647&(w|0)!=-1)))if((w|0)==-1){h=0;break}else{P=h,C=w,Me=145;break e}if(A=a[5949]|0,A=V-h+A&0-A,A>>>0>=2147483647){P=h,C=w,Me=145;break e}if((_(A|0)|0)==-1){_(d|0)|0,h=0;break}else{P=A+h|0,C=w,Me=145;break e}}while(0);a[5940]=a[5940]|4,Me=143}while(0);if((Me|0)==143&&W>>>0<2147483647&&(Se=_(W|0)|0,be=_(0)|0,ve=be-Se|0,$e=ve>>>0>(ae+40|0)>>>0,!((Se|0)==-1|$e^1|Se>>>0<be>>>0&((Se|0)!=-1&(be|0)!=-1)^1))&&(P=$e?ve:h,C=Se,Me=145),(Me|0)==145){h=(a[5937]|0)+P|0,a[5937]=h,h>>>0>(a[5938]|0)>>>0&&(a[5938]=h),V=a[5835]|0;e:do if(V){for(h=23764;;){if(A=a[h>>2]|0,d=a[h+4>>2]|0,(C|0)==(A+d|0)){Me=154;break}if(w=a[h+8>>2]|0,w)h=w;else break}if((Me|0)==154&&(Ge=h+4|0,(a[h+12>>2]&8|0)==0)&&C>>>0>V>>>0&A>>>0<=V>>>0){a[Ge>>2]=d+P,xe=(a[5832]|0)+P|0,Se=V+8|0,Se=Se&7|0?0-Se&7:0,Ge=V+Se|0,Se=xe-Se|0,a[5835]=Ge,a[5832]=Se,a[Ge+4>>2]=Se|1,a[V+xe+4>>2]=40,a[5836]=a[5951];break}for(C>>>0<(a[5833]|0)>>>0&&(a[5833]=C),d=C+P|0,h=23764;;){if((a[h>>2]|0)==(d|0)){Me=162;break}if(A=a[h+8>>2]|0,A)h=A;else break}if((Me|0)==162&&!(a[h+12>>2]&8|0)){a[h>>2]=C,X=h+4|0,a[X>>2]=(a[X>>2]|0)+P,X=C+8|0,X=C+(X&7|0?0-X&7:0)|0,h=d+8|0,h=d+(h&7|0?0-h&7:0)|0,W=X+ae|0,B=h-X-ae|0,a[X+4>>2]=ae|3;t:do if((V|0)==(h|0))xe=(a[5832]|0)+B|0,a[5832]=xe,a[5835]=W,a[W+4>>2]=xe|1;else{if((a[5834]|0)==(h|0)){xe=(a[5831]|0)+B|0,a[5831]=xe,a[5834]=W,a[W+4>>2]=xe|1,a[W+xe>>2]=xe;break}if(A=a[h+4>>2]|0,(A&3|0)==1){P=A&-8,w=A>>>3;n:do if(A>>>0<256)if(A=a[h+8>>2]|0,d=a[h+12>>2]|0,(d|0)==(A|0)){a[5829]=a[5829]&~(1<<w);break}else{a[A+12>>2]=d,a[d+8>>2]=A;break}else{C=a[h+24>>2]|0,A=a[h+12>>2]|0;do if((A|0)==(h|0)){if(d=h+16|0,w=d+4|0,A=a[w>>2]|0,A)d=w;else if(A=a[d>>2]|0,!A){A=0;break}for(;;)if(b=A+20|0,w=a[b>>2]|0,w)A=w,d=b;else if(b=A+16|0,w=a[b>>2]|0,w)A=w,d=b;else break;a[d>>2]=0}else xe=a[h+8>>2]|0,a[xe+12>>2]=A,a[A+8>>2]=xe;while(0);if(!C)break;d=a[h+28>>2]|0,w=23620+(d<<2)|0;do if((a[w>>2]|0)!=(h|0)){if(xe=C+16|0,a[((a[xe>>2]|0)==(h|0)?xe:C+20|0)>>2]=A,!A)break n}else{if(a[w>>2]=A,A|0)break;a[5830]=a[5830]&~(1<<d);break n}while(0);if(a[A+24>>2]=C,d=h+16|0,w=a[d>>2]|0,w|0&&(a[A+16>>2]=w,a[w+24>>2]=A),d=a[d+4>>2]|0,!d)break;a[A+20>>2]=d,a[d+24>>2]=A}while(0);h=h+P|0,b=P+B|0}else b=B;if(h=h+4|0,a[h>>2]=a[h>>2]&-2,a[W+4>>2]=b|1,a[W+b>>2]=b,h=b>>>3,b>>>0<256){d=23356+(h<<1<<2)|0,A=a[5829]|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=W,a[h+12>>2]=W,a[W+8>>2]=h,a[W+12>>2]=d;break}h=b>>>8;do if(!h)w=0;else{if(b>>>0>16777215){w=31;break}Ge=(h+1048320|0)>>>16&8,xe=h<<Ge,Se=(xe+520192|0)>>>16&4,xe=xe<<Se,w=(xe+245760|0)>>>16&2,w=14-(Se|Ge|w)+(xe<<w>>>15)|0,w=b>>>(w+7|0)&1|w<<1}while(0);if(h=23620+(w<<2)|0,a[W+28>>2]=w,A=W+16|0,a[A+4>>2]=0,a[A>>2]=0,A=a[5830]|0,d=1<<w,!(A&d)){a[5830]=A|d,a[h>>2]=W,a[W+24>>2]=h,a[W+12>>2]=W,a[W+8>>2]=W;break}h=a[h>>2]|0;n:do if((a[h+4>>2]&-8|0)!=(b|0)){for(w=b<<((w|0)==31?0:25-(w>>>1)|0);d=h+16+(w>>>31<<2)|0,A=a[d>>2]|0,!!A;)if((a[A+4>>2]&-8|0)==(b|0)){h=A;break n}else w=w<<1,h=A;a[d>>2]=W,a[W+24>>2]=h,a[W+12>>2]=W,a[W+8>>2]=W;break t}while(0);Ge=h+8|0,xe=a[Ge>>2]|0,a[xe+12>>2]=W,a[Ge>>2]=W,a[W+8>>2]=xe,a[W+12>>2]=h,a[W+24>>2]=0}while(0);return xe=X+8|0,De=y,xe|0}for(h=23764;A=a[h>>2]|0,!(A>>>0<=V>>>0&&(xe=A+(a[h+4>>2]|0)|0,xe>>>0>V>>>0));)h=a[h+8>>2]|0;b=xe+-47|0,A=b+8|0,A=b+(A&7|0?0-A&7:0)|0,b=V+16|0,A=A>>>0<b>>>0?V:A,h=A+8|0,d=P+-40|0,Se=C+8|0,Se=Se&7|0?0-Se&7:0,Ge=C+Se|0,Se=d-Se|0,a[5835]=Ge,a[5832]=Se,a[Ge+4>>2]=Se|1,a[C+d+4>>2]=40,a[5836]=a[5951],d=A+4|0,a[d>>2]=27,a[h>>2]=a[5941],a[h+4>>2]=a[5942],a[h+8>>2]=a[5943],a[h+12>>2]=a[5944],a[5941]=C,a[5942]=P,a[5944]=0,a[5943]=h,h=A+24|0;do Ge=h,h=h+4|0,a[h>>2]=7;while((Ge+8|0)>>>0<xe>>>0);if((A|0)!=(V|0)){if(C=A-V|0,a[d>>2]=a[d>>2]&-2,a[V+4>>2]=C|1,a[A>>2]=C,h=C>>>3,C>>>0<256){d=23356+(h<<1<<2)|0,A=a[5829]|0,h=1<<h,A&h?(A=d+8|0,h=a[A>>2]|0):(a[5829]=A|h,h=d,A=d+8|0),a[A>>2]=V,a[h+12>>2]=V,a[V+8>>2]=h,a[V+12>>2]=d;break}if(h=C>>>8,h?C>>>0>16777215?w=31:(Ge=(h+1048320|0)>>>16&8,xe=h<<Ge,Se=(xe+520192|0)>>>16&4,xe=xe<<Se,w=(xe+245760|0)>>>16&2,w=14-(Se|Ge|w)+(xe<<w>>>15)|0,w=C>>>(w+7|0)&1|w<<1):w=0,d=23620+(w<<2)|0,a[V+28>>2]=w,a[V+20>>2]=0,a[b>>2]=0,h=a[5830]|0,A=1<<w,!(h&A)){a[5830]=h|A,a[d>>2]=V,a[V+24>>2]=d,a[V+12>>2]=V,a[V+8>>2]=V;break}h=a[d>>2]|0;t:do if((a[h+4>>2]&-8|0)!=(C|0)){for(w=C<<((w|0)==31?0:25-(w>>>1)|0);d=h+16+(w>>>31<<2)|0,A=a[d>>2]|0,!!A;)if((a[A+4>>2]&-8|0)==(C|0)){h=A;break t}else w=w<<1,h=A;a[d>>2]=V,a[V+24>>2]=h,a[V+12>>2]=V,a[V+8>>2]=V;break e}while(0);Ge=h+8|0,xe=a[Ge>>2]|0,a[xe+12>>2]=V,a[Ge>>2]=V,a[V+8>>2]=xe,a[V+12>>2]=h,a[V+24>>2]=0}}else xe=a[5833]|0,(xe|0)==0|C>>>0<xe>>>0&&(a[5833]=C),a[5941]=C,a[5942]=P,a[5944]=0,a[5838]=a[5947],a[5837]=-1,a[5842]=23356,a[5841]=23356,a[5844]=23364,a[5843]=23364,a[5846]=23372,a[5845]=23372,a[5848]=23380,a[5847]=23380,a[5850]=23388,a[5849]=23388,a[5852]=23396,a[5851]=23396,a[5854]=23404,a[5853]=23404,a[5856]=23412,a[5855]=23412,a[5858]=23420,a[5857]=23420,a[5860]=23428,a[5859]=23428,a[5862]=23436,a[5861]=23436,a[5864]=23444,a[5863]=23444,a[5866]=23452,a[5865]=23452,a[5868]=23460,a[5867]=23460,a[5870]=23468,a[5869]=23468,a[5872]=23476,a[5871]=23476,a[5874]=23484,a[5873]=23484,a[5876]=23492,a[5875]=23492,a[5878]=23500,a[5877]=23500,a[5880]=23508,a[5879]=23508,a[5882]=23516,a[5881]=23516,a[5884]=23524,a[5883]=23524,a[5886]=23532,a[5885]=23532,a[5888]=23540,a[5887]=23540,a[5890]=23548,a[5889]=23548,a[5892]=23556,a[5891]=23556,a[5894]=23564,a[5893]=23564,a[5896]=23572,a[5895]=23572,a[5898]=23580,a[5897]=23580,a[5900]=23588,a[5899]=23588,a[5902]=23596,a[5901]=23596,a[5904]=23604,a[5903]=23604,xe=P+-40|0,Se=C+8|0,Se=Se&7|0?0-Se&7:0,Ge=C+Se|0,Se=xe-Se|0,a[5835]=Ge,a[5832]=Se,a[Ge+4>>2]=Se|1,a[C+xe+4>>2]=40,a[5836]=a[5951];while(0);if(h=a[5832]|0,h>>>0>ae>>>0)return Se=h-ae|0,a[5832]=Se,xe=a[5835]|0,Ge=xe+ae|0,a[5835]=Ge,a[Ge+4>>2]=Se|1,a[xe+4>>2]=ae|3,xe=xe+8|0,De=y,xe|0}return xe=mr()|0,a[xe>>2]=12,xe=0,De=y,xe|0}function fn(A){A=A|0;var h=0,d=0,w=0,b=0,C=0,P=0,B=0,V=0;if(A){d=A+-8|0,b=a[5833]|0,A=a[A+-4>>2]|0,h=A&-8,V=d+h|0;do if(A&1)B=d,P=d;else{if(w=a[d>>2]|0,!(A&3)||(P=d+(0-w)|0,C=w+h|0,P>>>0<b>>>0))return;if((a[5834]|0)==(P|0)){if(A=V+4|0,h=a[A>>2]|0,(h&3|0)!=3){B=P,h=C;break}a[5831]=C,a[A>>2]=h&-2,a[P+4>>2]=C|1,a[P+C>>2]=C;return}if(d=w>>>3,w>>>0<256)if(A=a[P+8>>2]|0,h=a[P+12>>2]|0,(h|0)==(A|0)){a[5829]=a[5829]&~(1<<d),B=P,h=C;break}else{a[A+12>>2]=h,a[h+8>>2]=A,B=P,h=C;break}b=a[P+24>>2]|0,A=a[P+12>>2]|0;do if((A|0)==(P|0)){if(h=P+16|0,d=h+4|0,A=a[d>>2]|0,A)h=d;else if(A=a[h>>2]|0,!A){A=0;break}for(;;)if(w=A+20|0,d=a[w>>2]|0,d)A=d,h=w;else if(w=A+16|0,d=a[w>>2]|0,d)A=d,h=w;else break;a[h>>2]=0}else B=a[P+8>>2]|0,a[B+12>>2]=A,a[A+8>>2]=B;while(0);if(b){if(h=a[P+28>>2]|0,d=23620+(h<<2)|0,(a[d>>2]|0)==(P|0)){if(a[d>>2]=A,!A){a[5830]=a[5830]&~(1<<h),B=P,h=C;break}}else if(B=b+16|0,a[((a[B>>2]|0)==(P|0)?B:b+20|0)>>2]=A,!A){B=P,h=C;break}a[A+24>>2]=b,h=P+16|0,d=a[h>>2]|0,d|0&&(a[A+16>>2]=d,a[d+24>>2]=A),h=a[h+4>>2]|0,h?(a[A+20>>2]=h,a[h+24>>2]=A,B=P,h=C):(B=P,h=C)}else B=P,h=C}while(0);if(!(P>>>0>=V>>>0)&&(A=V+4|0,w=a[A>>2]|0,!!(w&1))){if(w&2)a[A>>2]=w&-2,a[B+4>>2]=h|1,a[P+h>>2]=h,b=h;else{if((a[5835]|0)==(V|0)){if(V=(a[5832]|0)+h|0,a[5832]=V,a[5835]=B,a[B+4>>2]=V|1,(B|0)!=(a[5834]|0))return;a[5834]=0,a[5831]=0;return}if((a[5834]|0)==(V|0)){V=(a[5831]|0)+h|0,a[5831]=V,a[5834]=P,a[B+4>>2]=V|1,a[P+V>>2]=V;return}b=(w&-8)+h|0,d=w>>>3;do if(w>>>0<256)if(h=a[V+8>>2]|0,A=a[V+12>>2]|0,(A|0)==(h|0)){a[5829]=a[5829]&~(1<<d);break}else{a[h+12>>2]=A,a[A+8>>2]=h;break}else{C=a[V+24>>2]|0,A=a[V+12>>2]|0;do if((A|0)==(V|0)){if(h=V+16|0,d=h+4|0,A=a[d>>2]|0,A)h=d;else if(A=a[h>>2]|0,!A){d=0;break}for(;;)if(w=A+20|0,d=a[w>>2]|0,d)A=d,h=w;else if(w=A+16|0,d=a[w>>2]|0,d)A=d,h=w;else break;a[h>>2]=0,d=A}else d=a[V+8>>2]|0,a[d+12>>2]=A,a[A+8>>2]=d,d=A;while(0);if(C|0){if(A=a[V+28>>2]|0,h=23620+(A<<2)|0,(a[h>>2]|0)==(V|0)){if(a[h>>2]=d,!d){a[5830]=a[5830]&~(1<<A);break}}else if(w=C+16|0,a[((a[w>>2]|0)==(V|0)?w:C+20|0)>>2]=d,!d)break;a[d+24>>2]=C,A=V+16|0,h=a[A>>2]|0,h|0&&(a[d+16>>2]=h,a[h+24>>2]=d),A=a[A+4>>2]|0,A|0&&(a[d+20>>2]=A,a[A+24>>2]=d)}}while(0);if(a[B+4>>2]=b|1,a[P+b>>2]=b,(B|0)==(a[5834]|0)){a[5831]=b;return}}if(A=b>>>3,b>>>0<256){d=23356+(A<<1<<2)|0,h=a[5829]|0,A=1<<A,h&A?(h=d+8|0,A=a[h>>2]|0):(a[5829]=h|A,A=d,h=d+8|0),a[h>>2]=B,a[A+12>>2]=B,a[B+8>>2]=A,a[B+12>>2]=d;return}A=b>>>8,A?b>>>0>16777215?w=31:(P=(A+1048320|0)>>>16&8,V=A<<P,C=(V+520192|0)>>>16&4,V=V<<C,w=(V+245760|0)>>>16&2,w=14-(C|P|w)+(V<<w>>>15)|0,w=b>>>(w+7|0)&1|w<<1):w=0,A=23620+(w<<2)|0,a[B+28>>2]=w,a[B+20>>2]=0,a[B+16>>2]=0,h=a[5830]|0,d=1<<w;e:do if(!(h&d))a[5830]=h|d,a[A>>2]=B,a[B+24>>2]=A,a[B+12>>2]=B,a[B+8>>2]=B;else{A=a[A>>2]|0;t:do if((a[A+4>>2]&-8|0)!=(b|0)){for(w=b<<((w|0)==31?0:25-(w>>>1)|0);d=A+16+(w>>>31<<2)|0,h=a[d>>2]|0,!!h;)if((a[h+4>>2]&-8|0)==(b|0)){A=h;break t}else w=w<<1,A=h;a[d>>2]=B,a[B+24>>2]=A,a[B+12>>2]=B,a[B+8>>2]=B;break e}while(0);P=A+8|0,V=a[P>>2]|0,a[V+12>>2]=B,a[P>>2]=B,a[B+8>>2]=V,a[B+12>>2]=A,a[B+24>>2]=0}while(0);if(V=(a[5837]|0)+-1|0,a[5837]=V,!(V|0)){for(A=23772;A=a[A>>2]|0,A;)A=A+8|0;a[5837]=-1}}}}function es(A,h){A=A|0,h=h|0;var d=0;return A?(d=qt(h,A)|0,(h|A)>>>0>65535&&(d=((d>>>0)/(A>>>0)|0|0)==(h|0)?d:-1)):d=0,A=Kt(d)|0,!A||!(a[A+-4>>2]&3)||L(A|0,0,d|0)|0,A|0}function Jo(A,h,d,w){return A=A|0,h=h|0,d=d|0,w=w|0,d=A+d>>>0,Ft(h+w+(d>>>0<A>>>0|0)>>>0|0),d|0|0}function Hr(A,h,d,w){return A=A|0,h=h|0,d=d|0,w=w|0,w=h-w-(d>>>0>A>>>0|0)>>>0,Ft(w|0),A-d>>>0|0|0}function Zs(A){return A=A|0,(A?31-(xn(A^A-1)|0)|0:32)|0}function Ps(A,h,d,w,b){A=A|0,h=h|0,d=d|0,w=w|0,b=b|0;var C=0,P=0,B=0,V=0,W=0,X=0,ae=0,ne=0,ue=0,be=0;if(X=A,V=h,W=V,P=d,ne=w,B=ne,!W)return C=(b|0)!=0,B?C?(a[b>>2]=A|0,a[b+4>>2]=h&0,ne=0,b=0,Ft(ne|0),b|0):(ne=0,b=0,Ft(ne|0),b|0):(C&&(a[b>>2]=(X>>>0)%(P>>>0),a[b+4>>2]=0),ne=0,b=(X>>>0)/(P>>>0)>>>0,Ft(ne|0),b|0);C=(B|0)==0;do if(P){if(!C){if(C=(xn(B|0)|0)-(xn(W|0)|0)|0,C>>>0<=31){ae=C+1|0,B=31-C|0,h=C-31>>31,P=ae,A=X>>>(ae>>>0)&h|W<<B,h=W>>>(ae>>>0)&h,C=0,B=X<<B;break}return b?(a[b>>2]=A|0,a[b+4>>2]=V|h&0,ne=0,b=0,Ft(ne|0),b|0):(ne=0,b=0,Ft(ne|0),b|0)}if(C=P-1|0,C&P|0){B=(xn(P|0)|0)+33-(xn(W|0)|0)|0,be=64-B|0,ae=32-B|0,V=ae>>31,ue=B-32|0,h=ue>>31,P=B,A=ae-1>>31&W>>>(ue>>>0)|(W<<ae|X>>>(B>>>0))&h,h=h&W>>>(B>>>0),C=X<<be&V,B=(W<<be|X>>>(ue>>>0))&V|X<<ae&B-33>>31;break}return b|0&&(a[b>>2]=C&X,a[b+4>>2]=0),(P|0)==1?(ue=V|h&0,be=A|0|0,Ft(ue|0),be|0):(be=Zs(P|0)|0,ue=W>>>(be>>>0)|0,be=W<<32-be|X>>>(be>>>0)|0,Ft(ue|0),be|0)}else{if(C)return b|0&&(a[b>>2]=(W>>>0)%(P>>>0),a[b+4>>2]=0),ue=0,be=(W>>>0)/(P>>>0)>>>0,Ft(ue|0),be|0;if(!X)return b|0&&(a[b>>2]=0,a[b+4>>2]=(W>>>0)%(B>>>0)),ue=0,be=(W>>>0)/(B>>>0)>>>0,Ft(ue|0),be|0;if(C=B-1|0,!(C&B))return b|0&&(a[b>>2]=A|0,a[b+4>>2]=C&W|h&0),ue=0,be=W>>>((Zs(B|0)|0)>>>0),Ft(ue|0),be|0;if(C=(xn(B|0)|0)-(xn(W|0)|0)|0,C>>>0<=30){h=C+1|0,B=31-C|0,P=h,A=W<<B|X>>>(h>>>0),h=W>>>(h>>>0),C=0,B=X<<B;break}return b?(a[b>>2]=A|0,a[b+4>>2]=V|h&0,ue=0,be=0,Ft(ue|0),be|0):(ue=0,be=0,Ft(ue|0),be|0)}while(0);if(!P)W=B,V=0,B=0;else{ae=d|0|0,X=ne|w&0,W=Jo(ae|0,X|0,-1,-1)|0,d=Oe()|0,V=B,B=0;do w=V,V=C>>>31|V<<1,C=B|C<<1,w=A<<1|w>>>31|0,ne=A>>>31|h<<1|0,Hr(W|0,d|0,w|0,ne|0)|0,be=Oe()|0,ue=be>>31|((be|0)<0?-1:0)<<1,B=ue&1,A=Hr(w|0,ne|0,ue&ae|0,(((be|0)<0?-1:0)>>31|((be|0)<0?-1:0)<<1)&X|0)|0,h=Oe()|0,P=P-1|0;while(P|0);W=V,V=0}return P=0,b|0&&(a[b>>2]=A,a[b+4>>2]=h),ue=(C|0)>>>31|(W|P)<<1|(P<<1|C>>>31)&0|V,be=(C<<1|0)&-2|B,Ft(ue|0),be|0}function Ys(A,h,d,w){A=A|0,h=h|0,d=d|0,w=w|0;var b=0,C=0;return C=De,De=De+16|0,b=C|0,Ps(A,h,d,w,b)|0,De=C,Ft(a[b+4>>2]|0),a[b>>2]|0|0}function Ct(A,h,d){return A=A|0,h=h|0,d=d|0,(d|0)<32?(Ft(h>>>d|0),A>>>d|(h&(1<<d)-1)<<32-d):(Ft(0),h>>>d-32|0)}function Pt(A,h,d){return A=A|0,h=h|0,d=d|0,(d|0)<32?(Ft(h<<d|(A&(1<<d)-1<<32-d)>>>32-d|0),A<<d):(Ft(A<<d-32|0),0)}function Wr(A,h){return A=+A,h=+h,A!=A?+h:h!=h?+A:+an(+A,+h)}function sl(A){return A=+A,A>=0?+ke(A+.5):+pn(A-.5)}function Xs(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0;if((d|0)>=8192)return hi(A|0,h|0,d|0)|0,A|0;if(C=A|0,b=A+d|0,(A&3)==(h&3)){for(;A&3;){if(!d)return C|0;fe[A>>0]=fe[h>>0]|0,A=A+1|0,h=h+1|0,d=d-1|0}for(d=b&-4|0,w=d-64|0;(A|0)<=(w|0);)a[A>>2]=a[h>>2],a[A+4>>2]=a[h+4>>2],a[A+8>>2]=a[h+8>>2],a[A+12>>2]=a[h+12>>2],a[A+16>>2]=a[h+16>>2],a[A+20>>2]=a[h+20>>2],a[A+24>>2]=a[h+24>>2],a[A+28>>2]=a[h+28>>2],a[A+32>>2]=a[h+32>>2],a[A+36>>2]=a[h+36>>2],a[A+40>>2]=a[h+40>>2],a[A+44>>2]=a[h+44>>2],a[A+48>>2]=a[h+48>>2],a[A+52>>2]=a[h+52>>2],a[A+56>>2]=a[h+56>>2],a[A+60>>2]=a[h+60>>2],A=A+64|0,h=h+64|0;for(;(A|0)<(d|0);)a[A>>2]=a[h>>2],A=A+4|0,h=h+4|0}else for(d=b-4|0;(A|0)<(d|0);)fe[A>>0]=fe[h>>0]|0,fe[A+1>>0]=fe[h+1>>0]|0,fe[A+2>>0]=fe[h+2>>0]|0,fe[A+3>>0]=fe[h+3>>0]|0,A=A+4|0,h=h+4|0;for(;(A|0)<(b|0);)fe[A>>0]=fe[h>>0]|0,A=A+1|0,h=h+1|0;return C|0}function L(A,h,d){A=A|0,h=h|0,d=d|0;var w=0,b=0,C=0,P=0;if(C=A+d|0,h=h&255,(d|0)>=67){for(;A&3;)fe[A>>0]=h,A=A+1|0;for(w=C&-4|0,P=h|h<<8|h<<16|h<<24,b=w-64|0;(A|0)<=(b|0);)a[A>>2]=P,a[A+4>>2]=P,a[A+8>>2]=P,a[A+12>>2]=P,a[A+16>>2]=P,a[A+20>>2]=P,a[A+24>>2]=P,a[A+28>>2]=P,a[A+32>>2]=P,a[A+36>>2]=P,a[A+40>>2]=P,a[A+44>>2]=P,a[A+48>>2]=P,a[A+52>>2]=P,a[A+56>>2]=P,a[A+60>>2]=P,A=A+64|0;for(;(A|0)<(w|0);)a[A>>2]=P,A=A+4|0}for(;(A|0)<(C|0);)fe[A>>0]=h,A=A+1|0;return C-d|0}function c(A){return A=+A,A>=0?+ke(A+.5):+pn(A-.5)}function _(A){A=A|0;var h=0,d=0,w=0;return w=cn()|0,d=a[Le>>2]|0,h=d+A|0,(A|0)>0&(h|0)<(d|0)|(h|0)<0?(pa(h|0)|0,Ce(12),-1):(h|0)>(w|0)&&!(rr(h|0)|0)?(Ce(12),-1):(a[Le>>2]=h,d|0)}return{___uremdi3:Ys,_bitshift64Lshr:Ct,_bitshift64Shl:Pt,_calloc:es,_cellAreaKm2:Xa,_cellAreaM2:xa,_cellAreaRads2:zl,_compact:pu,_destroyLinkedPolygon:nl,_edgeLengthKm:Ya,_edgeLengthM:_c,_emscripten_replace_memory:Ha,_exactEdgeLengthKm:Fl,_exactEdgeLengthM:gr,_exactEdgeLengthRads:Ol,_experimentalH3ToLocalIj:Ta,_experimentalLocalIjToH3:Ko,_free:fn,_geoToH3:Ka,_getDestinationH3IndexFromUnidirectionalEdge:Xo,_getH3IndexesFromUnidirectionalEdge:Eo,_getH3UnidirectionalEdge:Ji,_getH3UnidirectionalEdgeBoundary:tl,_getH3UnidirectionalEdgesFromHexagon:Gl,_getOriginH3IndexFromUnidirectionalEdge:Vl,_getPentagonIndexes:ai,_getRes0Indexes:kl,_h3Distance:mu,_h3GetBaseCell:cs,_h3GetFaces:ba,_h3GetResolution:MA,_h3IndexesAreNeighbors:Ms,_h3IsPentagon:zr,_h3IsResClassIII:PA,_h3IsValid:du,_h3Line:kA,_h3LineSize:Vt,_h3SetToLinkedGeo:Dr,_h3ToCenterChild:oi,_h3ToChildren:Xr,_h3ToGeo:Ws,_h3ToGeoBoundary:fs,_h3ToParent:Nl,_h3UnidirectionalEdgeIsValid:bc,_hexAreaKm2:Yo,_hexAreaM2:yc,_hexRing:Te,_i64Subtract:Hr,_kRing:ga,_kRingDistances:Ml,_llvm_minnum_f64:Wr,_llvm_round_f64:sl,_malloc:Kt,_maxFaceCount:wc,_maxH3ToChildrenSize:vc,_maxKringSize:Qa,_maxPolyfillSize:Ne,_maxUncompactSize:xc,_memcpy:Xs,_memset:L,_numHexagons:fu,_pentagonIndexCount:el,_pointDistKm:qn,_pointDistM:br,_pointDistRads:$n,_polyfill:lt,_res0IndexCount:Pl,_round:c,_sbrk:_,_sizeOfCoordIJ:Bi,_sizeOfGeoBoundary:_u,_sizeOfGeoCoord:Ec,_sizeOfGeoPolygon:xu,_sizeOfGeofence:vu,_sizeOfH3Index:Ch,_sizeOfLinkedGeoPolygon:qs,_uncompact:Hs,establishStackSpace:Wa,stackAlloc:we,stackRestore:Ss,stackSave:jo}}(Ts,yn,Fe);e.___uremdi3=Xe.___uremdi3,e._bitshift64Lshr=Xe._bitshift64Lshr,e._bitshift64Shl=Xe._bitshift64Shl,e._calloc=Xe._calloc,e._cellAreaKm2=Xe._cellAreaKm2,e._cellAreaM2=Xe._cellAreaM2,e._cellAreaRads2=Xe._cellAreaRads2,e._compact=Xe._compact,e._destroyLinkedPolygon=Xe._destroyLinkedPolygon,e._edgeLengthKm=Xe._edgeLengthKm,e._edgeLengthM=Xe._edgeLengthM;var Zr=e._emscripten_replace_memory=Xe._emscripten_replace_memory;e._exactEdgeLengthKm=Xe._exactEdgeLengthKm,e._exactEdgeLengthM=Xe._exactEdgeLengthM,e._exactEdgeLengthRads=Xe._exactEdgeLengthRads,e._experimentalH3ToLocalIj=Xe._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=Xe._experimentalLocalIjToH3,e._free=Xe._free,e._geoToH3=Xe._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=Xe._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=Xe._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=Xe._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=Xe._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=Xe._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=Xe._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=Xe._getPentagonIndexes,e._getRes0Indexes=Xe._getRes0Indexes,e._h3Distance=Xe._h3Distance,e._h3GetBaseCell=Xe._h3GetBaseCell,e._h3GetFaces=Xe._h3GetFaces,e._h3GetResolution=Xe._h3GetResolution,e._h3IndexesAreNeighbors=Xe._h3IndexesAreNeighbors,e._h3IsPentagon=Xe._h3IsPentagon,e._h3IsResClassIII=Xe._h3IsResClassIII,e._h3IsValid=Xe._h3IsValid,e._h3Line=Xe._h3Line,e._h3LineSize=Xe._h3LineSize,e._h3SetToLinkedGeo=Xe._h3SetToLinkedGeo,e._h3ToCenterChild=Xe._h3ToCenterChild,e._h3ToChildren=Xe._h3ToChildren,e._h3ToGeo=Xe._h3ToGeo,e._h3ToGeoBoundary=Xe._h3ToGeoBoundary,e._h3ToParent=Xe._h3ToParent,e._h3UnidirectionalEdgeIsValid=Xe._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=Xe._hexAreaKm2,e._hexAreaM2=Xe._hexAreaM2,e._hexRing=Xe._hexRing,e._i64Subtract=Xe._i64Subtract,e._kRing=Xe._kRing,e._kRingDistances=Xe._kRingDistances,e._llvm_minnum_f64=Xe._llvm_minnum_f64,e._llvm_round_f64=Xe._llvm_round_f64,e._malloc=Xe._malloc,e._maxFaceCount=Xe._maxFaceCount,e._maxH3ToChildrenSize=Xe._maxH3ToChildrenSize,e._maxKringSize=Xe._maxKringSize,e._maxPolyfillSize=Xe._maxPolyfillSize,e._maxUncompactSize=Xe._maxUncompactSize,e._memcpy=Xe._memcpy,e._memset=Xe._memset,e._numHexagons=Xe._numHexagons,e._pentagonIndexCount=Xe._pentagonIndexCount,e._pointDistKm=Xe._pointDistKm,e._pointDistM=Xe._pointDistM,e._pointDistRads=Xe._pointDistRads,e._polyfill=Xe._polyfill,e._res0IndexCount=Xe._res0IndexCount,e._round=Xe._round,e._sbrk=Xe._sbrk,e._sizeOfCoordIJ=Xe._sizeOfCoordIJ,e._sizeOfGeoBoundary=Xe._sizeOfGeoBoundary,e._sizeOfGeoCoord=Xe._sizeOfGeoCoord,e._sizeOfGeoPolygon=Xe._sizeOfGeoPolygon,e._sizeOfGeofence=Xe._sizeOfGeofence,e._sizeOfH3Index=Xe._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=Xe._sizeOfLinkedGeoPolygon,e._uncompact=Xe._uncompact,e.establishStackSpace=Xe.establishStackSpace;var Vs=e.stackAlloc=Xe.stackAlloc,Fr=e.stackRestore=Xe.stackRestore,ci=e.stackSave=Xe.stackSave;if(e.asm=Xe,e.cwrap=se,e.setValue=F,e.getValue=H,e.getTempRet0=M,Qn){yo(Qn)||(Qn=s(Qn));{Vn();var Yn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ze.set(K,k),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,ki()},Gs=function(){l(Qn,Yn,function(){throw"could not load memory initializer "+Qn})},ji=Rr(Qn);if(ji)Yn(ji.buffer);else if(e.memoryInitializerRequest){var Hi=function(){var K=e.memoryInitializerRequest,Q=K.response;if(K.status!==200&&K.status!==0){var te=Rr(e.memoryInitializerRequestURL);if(te)Q=te.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+Qn),Gs();return}}Yn(Q)};e.memoryInitializerRequest.response?setTimeout(Hi,0):e.memoryInitializerRequest.addEventListener("load",Hi)}else Gs()}}var Ri;ri=function K(){Ri||us(),Ri||(ri=K)};function us(K){if(nr>0||(Un(),nr>0))return;function Q(){Ri||(Ri=!0,!j&&(Cr(),wt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),rn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Q()},1)):Q()}e.run=us;function Nr(K){throw e.onAbort&&e.onAbort(K),K+="",o(K),p(K),j=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Nr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return us(),t}(typeof kt=="object"?kt:{}),Cn="number",Np=Cn,Nn=Cn,Jn=Cn,ta=Cn,wr=Cn,Hme=[["sizeOfH3Index",Cn],["sizeOfGeoCoord",Cn],["sizeOfGeoBoundary",Cn],["sizeOfGeoPolygon",Cn],["sizeOfGeofence",Cn],["sizeOfLinkedGeoPolygon",Cn],["sizeOfCoordIJ",Cn],["h3IsValid",Np,[Nn,Jn]],["geoToH3",Nn,[Cn,Cn,ta]],["h3ToGeo",null,[Nn,Jn,wr]],["h3ToGeoBoundary",null,[Nn,Jn,wr]],["maxKringSize",Cn,[Cn]],["kRing",null,[Nn,Jn,Cn,wr]],["kRingDistances",null,[Nn,Jn,Cn,wr,wr]],["hexRing",null,[Nn,Jn,Cn,wr]],["maxPolyfillSize",Cn,[wr,ta]],["polyfill",null,[wr,ta,wr]],["h3SetToLinkedGeo",null,[wr,Cn,wr]],["destroyLinkedPolygon",null,[wr]],["compact",Cn,[wr,wr,Cn]],["uncompact",Cn,[wr,Cn,wr,Cn,ta]],["maxUncompactSize",Cn,[wr,Cn,ta]],["h3IsPentagon",Np,[Nn,Jn]],["h3IsResClassIII",Np,[Nn,Jn]],["h3GetBaseCell",Cn,[Nn,Jn]],["h3GetResolution",Cn,[Nn,Jn]],["maxFaceCount",Cn,[Nn,Jn]],["h3GetFaces",null,[Nn,Jn,wr]],["h3ToParent",Nn,[Nn,Jn,ta]],["h3ToChildren",null,[Nn,Jn,ta,wr]],["h3ToCenterChild",Nn,[Nn,Jn,ta]],["maxH3ToChildrenSize",Cn,[Nn,Jn,ta]],["h3IndexesAreNeighbors",Np,[Nn,Jn,Nn,Jn]],["getH3UnidirectionalEdge",Nn,[Nn,Jn,Nn,Jn]],["getOriginH3IndexFromUnidirectionalEdge",Nn,[Nn,Jn]],["getDestinationH3IndexFromUnidirectionalEdge",Nn,[Nn,Jn]],["h3UnidirectionalEdgeIsValid",Np,[Nn,Jn]],["getH3IndexesFromUnidirectionalEdge",null,[Nn,Jn,wr]],["getH3UnidirectionalEdgesFromHexagon",null,[Nn,Jn,wr]],["getH3UnidirectionalEdgeBoundary",null,[Nn,Jn,wr]],["h3Distance",Cn,[Nn,Jn,Nn,Jn]],["h3Line",Cn,[Nn,Jn,Nn,Jn,wr]],["h3LineSize",Cn,[Nn,Jn,Nn,Jn]],["experimentalH3ToLocalIj",Cn,[Nn,Jn,Nn,Jn,wr]],["experimentalLocalIjToH3",Cn,[Nn,Jn,wr,wr]],["hexAreaM2",Cn,[ta]],["hexAreaKm2",Cn,[ta]],["edgeLengthM",Cn,[ta]],["edgeLengthKm",Cn,[ta]],["pointDistM",Cn,[wr,wr]],["pointDistKm",Cn,[wr,wr]],["pointDistRads",Cn,[wr,wr]],["cellAreaM2",Cn,[Nn,Jn]],["cellAreaKm2",Cn,[Nn,Jn]],["cellAreaRads2",Cn,[Nn,Jn]],["exactEdgeLengthM",Cn,[Nn,Jn]],["exactEdgeLengthKm",Cn,[Nn,Jn]],["exactEdgeLengthRads",Cn,[Nn,Jn]],["numHexagons",Cn,[ta]],["getRes0Indexes",null,[wr]],["res0IndexCount",Cn],["getPentagonIndexes",null,[Cn,wr]],["pentagonIndexCount",Cn]],on={};Hme.forEach(function(e){on[e[0]]=kt.cwrap.apply(kt,e)});var G0=16,Fo=4,R8=4,vh=8,mo=on.sizeOfH3Index(),Ov=on.sizeOfGeoCoord(),F7=on.sizeOfGeoBoundary(),Wme=on.sizeOfGeoPolygon(),vg=on.sizeOfGeofence(),Qme=on.sizeOfLinkedGeoPolygon(),N7=on.sizeOfCoordIJ(),fa={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function $d(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var qme=/[^0-9a-fA-F]/;function vr(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||qme.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),G0),n=parseInt(t.substring(t.length-8),G0);return[n,e]}function B8(t){if(t>=0)return t.toString(G0);t=t&2147483647;var e=U7(8,t.toString(G0)),n=(parseInt(e[0],G0)+8).toString(G0);return e=n+e.substring(1),e}function Fv(t,e){return B8(e)+U7(8,B8(t))}function U7(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function z8(t,e,n){for(var r=t.length,i=kt._calloc(r,Ov),s=n?1:0,l=n?0:1,o=0;o<r*2;o+=2)kt.HEAPF64.set([t[o/2][s],t[o/2][l]].map(Nv),i/vh+o);return kt.HEAPU32.set([r,i],e/Fo),e}function Zme(t,e){var n=t.length-1,r=kt._calloc(Wme),i=0,s=i+vg,l=s+Fo;z8(t[0],r+i,e);var o;if(n>0){o=kt._calloc(n,vg);for(var p=0;p<n;p++)z8(t[p+1],o+vg*p,e)}return kt.setValue(r+s,n,"i32"),kt.setValue(r+l,o,"i32"),r}function Yme(t){var e=0,n=e+vg,r=n+Fo,i=Fo;kt._free(kt.getValue(t+e+i,"i8*"));var s=kt.getValue(t+n,"i32");if(s>0){for(var l=kt.getValue(t+r,"i32"),o=0;o<s;o++)kt._free(kt.getValue(l+vg*o+i,"i8*"));kt._free(l)}kt._free(t)}function V7(t){var e=kt.getTempRet0();return[t,e]}function jd(t){var e=V7(t),n=e[0],r=e[1];return r?Fv(n,r):null}function G7(t,e){e===void 0&&(e=0);var n=kt.getValue(t+Fo*e*2,"i32"),r=kt.getValue(t+Fo*(e*2+1),"i32");return r?Fv(n,r):null}function Xme(t,e,n){kt.HEAPU32.set(vr(t),e/Fo+2*n)}function _A(t,e){for(var n=[],r=0;r<e;r++){var i=G7(t,r);i!==null&&n.push(i)}return n}function y4(t,e){for(var n=e.length,r=0;r<n;r++)Xme(e[r],t,r)}function O8(t,e){var n=kt._calloc(1,Ov);return kt.HEAPF64.set([t,e].map(Nv),n/vh),n}function D2(t){return W7(kt.getValue(t,"double"))}function _4(t){return[D2(t),D2(t+vh)]}function $7(t){return[D2(t+vh),D2(t)]}function j7(t,e,n){for(var r=kt.getValue(t,"i32"),i=t+vh,s=[],l=e?$7:_4,o=0;o<r*2;o+=2)s.push(l(i+vh*o));return n&&s.push(s[0]),s}function Kme(t,e){for(var n=[],r=e?$7:_4,i,s,l,o;t;){for(n.push(i=[]),s=kt.getValue(t,"i8*");s;){for(i.push(l=[]),o=kt.getValue(s,"i8*");o;)l.push(r(o)),o=kt.getValue(o+vh*2,"i8*");e&&l.push(l[0]),s=kt.getValue(s+R8*2,"i8*")}t=kt.getValue(t+R8*2,"i8*")}return n}function Jme(t){return{i:kt.getValue(t,"i32"),j:kt.getValue(t+Fo,"i32")}}function e1e(t,e){var n=e.i,r=e.j;kt.setValue(t,n,"i32"),kt.setValue(t+Fo,r,"i32")}function t1e(t,e){for(var n=[],r=0;r<e;r++){var i=kt.getValue(t+Fo*r,"i32");i>=0&&n.push(i)}return n}function H7(t){var e=vr(t),n=e[0],r=e[1];return!!on.h3IsValid(n,r)}function n1e(t){var e=vr(t),n=e[0],r=e[1];return!!on.h3IsPentagon(n,r)}function r1e(t){var e=vr(t),n=e[0],r=e[1];return!!on.h3IsResClassIII(n,r)}function i1e(t){var e=vr(t),n=e[0],r=e[1];return on.h3GetBaseCell(n,r)}function s1e(t){var e=vr(t),n=e[0],r=e[1],i=on.maxFaceCount(n,r),s=kt._malloc(Fo*i);on.h3GetFaces(n,r,s);var l=t1e(s,i);return kt._free(s),l}function o1e(t){var e=vr(t),n=e[0],r=e[1];return on.h3IsValid(n,r)?on.h3GetResolution(n,r):-1}function a1e(t,e,n){var r=kt._malloc(Ov);kt.HEAPF64.set([t,e].map(Nv),r/vh);var i=jd(on.geoToH3(r,n));return kt._free(r),i}function l1e(t){var e=kt._malloc(Ov),n=vr(t),r=n[0],i=n[1];on.h3ToGeo(r,i,e);var s=_4(e);return kt._free(e),s}function A1e(t,e){var n=kt._malloc(F7),r=vr(t),i=r[0],s=r[1];on.h3ToGeoBoundary(i,s,n);var l=j7(n,e,e);return kt._free(n),l}function u1e(t,e){var n=vr(t),r=n[0],i=n[1];return jd(on.h3ToParent(r,i,e))}function c1e(t,e){if(!H7(t))return[];var n=vr(t),r=n[0],i=n[1],s=on.maxH3ToChildrenSize(r,i,e),l=kt._calloc(s,mo);on.h3ToChildren(r,i,e,l);var o=_A(l,s);return kt._free(l),o}function h1e(t,e){var n=vr(t),r=n[0],i=n[1];return jd(on.h3ToCenterChild(r,i,e))}function f1e(t,e){var n=vr(t),r=n[0],i=n[1],s=on.maxKringSize(e),l=kt._calloc(s,mo);on.kRing(r,i,e,l);var o=_A(l,s);return kt._free(l),o}function d1e(t,e){var n=vr(t),r=n[0],i=n[1],s=on.maxKringSize(e),l=kt._calloc(s,mo),o=kt._calloc(s,Fo);on.kRingDistances(r,i,e,l,o);for(var p=[],v=0;v<e+1;v++)p.push([]);for(var S=0;S<s*2;S+=2){var M=kt.getValue(l+Fo*S,"i32"),k=kt.getValue(l+Fo*(S+1),"i32"),F=kt.getValue(o+Fo*(S/2),"i32");(M!==0||k!==0)&&p[F].push(Fv(M,k))}return kt._free(l),kt._free(o),p}function p1e(t,e){var n=e===0?1:6*e,r=kt._calloc(n,mo),i=on.hexRing.apply(on,vr(t).concat([e],[r]));if(i!==0)throw kt._free(r),new Error("Failed to get hexRing (encountered a pentagon?)");var s=_A(r,n);return kt._free(r),s}function g1e(t,e,n){if($d(e),n=!!n,t.length===0||t[0].length===0)return[];typeof t[0][0]=="number"&&(t=[t]);var r=Zme(t,n),i=on.maxPolyfillSize(r,e),s=kt._calloc(i,mo);on.polyfill(r,e,s);var l=_A(s,i);return kt._free(s),Yme(r),l}function m1e(t,e){if(!t||!t.length)return[];var n=t.length,r=kt._calloc(n,mo);y4(r,t);var i=kt._calloc(Qme),s=i;on.h3SetToLinkedGeo(r,n,i);var l=Kme(i,e);return on.destroyLinkedPolygon(s),kt._free(s),kt._free(r),l}function y1e(t){if(!t||!t.length)return[];var e=t.length,n=kt._calloc(e,mo);y4(n,t);var r=kt._calloc(e,mo),i=on.compact(n,r,e);if(i!==0)throw kt._free(n),kt._free(r),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var s=_A(r,e);return kt._free(n),kt._free(r),s}function _1e(t,e){if($d(e),!t||!t.length)return[];var n=t.length,r=kt._calloc(n,mo);y4(r,t);var i=on.maxUncompactSize(r,n,e),s=kt._calloc(i,mo),l=on.uncompact(r,n,s,i,e);if(l!==0)throw kt._free(r),kt._free(s),new Error("Failed to uncompact (bad resolution?)");var o=_A(s,i);return kt._free(r),kt._free(s),o}function v1e(t,e){var n=vr(t),r=n[0],i=n[1],s=vr(e),l=s[0],o=s[1];return!!on.h3IndexesAreNeighbors(r,i,l,o)}function x1e(t,e){var n=vr(t),r=n[0],i=n[1],s=vr(e),l=s[0],o=s[1];return jd(on.getH3UnidirectionalEdge(r,i,l,o))}function w1e(t){var e=vr(t),n=e[0],r=e[1];return jd(on.getOriginH3IndexFromUnidirectionalEdge(n,r))}function b1e(t){var e=vr(t),n=e[0],r=e[1];return jd(on.getDestinationH3IndexFromUnidirectionalEdge(n,r))}function E1e(t){var e=vr(t),n=e[0],r=e[1];return!!on.h3UnidirectionalEdgeIsValid(n,r)}function T1e(t){var e=vr(t),n=e[0],r=e[1],i=2,s=kt._calloc(i,mo);on.getH3IndexesFromUnidirectionalEdge(n,r,s);var l=_A(s,i);return kt._free(s),l}function S1e(t){var e=vr(t),n=e[0],r=e[1],i=6,s=kt._calloc(i,mo);on.getH3UnidirectionalEdgesFromHexagon(n,r,s);var l=_A(s,i);return kt._free(s),l}function C1e(t,e){var n=kt._malloc(F7),r=vr(t),i=r[0],s=r[1];on.getH3UnidirectionalEdgeBoundary(i,s,n);var l=j7(n,e);return kt._free(n),l}function M1e(t,e){var n=vr(t),r=n[0],i=n[1],s=vr(e),l=s[0],o=s[1];return on.h3Distance(r,i,l,o)}function P1e(t,e){var n=vr(t),r=n[0],i=n[1],s=vr(e),l=s[0],o=s[1],p=on.h3LineSize(r,i,l,o);if(p<0)throw new Error("Line cannot be calculated");var v=kt._calloc(p,mo);on.h3Line(r,i,l,o,v);var S=_A(v,p);return kt._free(v),S}function k1e(t,e){var n=kt._malloc(N7),r=on.experimentalH3ToLocalIj.apply(on,vr(t).concat(vr(e),[n])),i=Jme(n);switch(kt._free(n),r){case 0:return i;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function I1e(t,e){if(!e||typeof e.i!="number"||typeof e.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=kt._malloc(N7),r=kt._malloc(mo);e1e(n,e);var i=on.experimentalLocalIjToH3.apply(on,vr(t).concat([n],[r])),s=G7(r);if(kt._free(n),kt._free(r),i!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return s}function L1e(t,e,n){var r=O8(t[0],t[1]),i=O8(e[0],e[1]),s;switch(n){case fa.m:s=on.pointDistM(r,i);break;case fa.km:s=on.pointDistKm(r,i);break;case fa.rads:s=on.pointDistRads(r,i);break;default:s=null}if(kt._free(r),kt._free(i),s===null)throw new Error("Unknown unit: "+n);return s}function D1e(t,e){var n=vr(t),r=n[0],i=n[1];switch(e){case fa.m2:return on.cellAreaM2(r,i);case fa.km2:return on.cellAreaKm2(r,i);case fa.rads2:return on.cellAreaRads2(r,i);default:throw new Error("Unknown unit: "+e)}}function R1e(t,e){var n=vr(t),r=n[0],i=n[1];switch(e){case fa.m:return on.exactEdgeLengthM(r,i);case fa.km:return on.exactEdgeLengthKm(r,i);case fa.rads:return on.exactEdgeLengthRads(r,i);default:throw new Error("Unknown unit: "+e)}}function B1e(t,e){switch($d(t),e){case fa.m2:return on.hexAreaM2(t);case fa.km2:return on.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function z1e(t,e){switch($d(t),e){case fa.m:return on.edgeLengthM(t);case fa.km:return on.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function O1e(t){$d(t);var e=V7(on.numHexagons(t)),n=e[0],r=e[1];return r?r*Math.pow(2,32)+n:n}function F1e(){var t=on.res0IndexCount(),e=kt._malloc(mo*t);on.getRes0Indexes(e);var n=_A(e,t);return kt._free(e),n}function N1e(t){$d(t);var e=on.pentagonIndexCount(),n=kt._malloc(mo*e);on.getPentagonIndexes(t,n);var r=_A(n,e);return kt._free(n),r}function Nv(t){return t*Math.PI/180}function W7(t){return t*180/Math.PI}const U1e=Object.freeze(Object.defineProperty({__proto__:null,UNITS:fa,cellArea:D1e,compact:y1e,degsToRads:Nv,edgeLength:z1e,exactEdgeLength:R1e,experimentalH3ToLocalIj:k1e,experimentalLocalIjToH3:I1e,geoToH3:a1e,getDestinationH3IndexFromUnidirectionalEdge:b1e,getH3IndexesFromUnidirectionalEdge:T1e,getH3UnidirectionalEdge:x1e,getH3UnidirectionalEdgeBoundary:C1e,getH3UnidirectionalEdgesFromHexagon:S1e,getOriginH3IndexFromUnidirectionalEdge:w1e,getPentagonIndexes:N1e,getRes0Indexes:F1e,h3Distance:M1e,h3GetBaseCell:i1e,h3GetFaces:s1e,h3GetResolution:o1e,h3IndexToSplitLong:vr,h3IndexesAreNeighbors:v1e,h3IsPentagon:n1e,h3IsResClassIII:r1e,h3IsValid:H7,h3Line:P1e,h3SetToMultiPolygon:m1e,h3ToCenterChild:h1e,h3ToChildren:c1e,h3ToGeo:l1e,h3ToGeoBoundary:A1e,h3ToParent:u1e,h3UnidirectionalEdgeIsValid:E1e,hexArea:B1e,hexRing:p1e,kRing:f1e,kRingDistances:d1e,numHexagons:O1e,pointDist:L1e,polyfill:g1e,radsToDegs:W7,splitLongToh3Index:Fv,uncompact:_1e},Symbol.toStringTag,{value:"Module"})),V1e=Q9(U1e);var pm=V1e,Uv="Feature",Q7="FeatureCollection",R2="Polygon",v4="MultiPolygon";function q7(t){for(var e=null,n=0;n<t.length;n++)if(e!==null)for(var r=0;r<t[n].length;r++)e.push(t[n][r]);else e=t[n];return Array.from(new Set(e))}function G1e(t){for(var e=0,n=0,r=0,i=t[0],s=0;s<i.length;s++)e+=i[s][0],n+=i[s][1],r++;return[e/r,n/r]}function $1e(t,e){var n=t.features;if(!n)throw new Error("No features found");return q7(n.map(function(r){return Z7(r,e)}))}function Z7(t,e,n){n===void 0&&(n={});var r=t.type,i=t.geometry,s=i&&i.type;if(r===Q7)return $1e(t,e);if(r!==Uv)throw new Error("Unhandled type: "+r);if(s!==R2&&s!==v4)throw new Error("Unhandled geometry type: "+s);var l=s===R2?[i.coordinates]:i.coordinates;return q7(l.map(function(o){var p=pm.polyfill(o,e,!0);if(p.length||!n.ensureOutput)return p;var v=G1e(o),S=v[0],M=v[1];return[pm.geoToH3(M,S,e)]}))}function Y7(t,e){e===void 0&&(e={});var n=[pm.h3ToGeoBoundary(t,!0)];return{type:Uv,id:t,properties:e,geometry:{type:R2,coordinates:n}}}function j1e(t,e){e===void 0&&(e={});var n=pm.h3SetToMultiPolygon(t,!0),r=n.length>1,i=r?v4:R2,s=r?n:n[0]||[];return{type:Uv,properties:e,geometry:{type:i,coordinates:s}}}function H1e(t,e){e===void 0&&(e={});var n=t.map(function(r){return[pm.h3ToGeoBoundary(r,{geoJson:!0})]});return{type:Uv,properties:e,geometry:{type:v4,coordinates:n}}}function W1e(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],s=e?e(i):{};n.push(Y7(i,s))}return{type:Q7,features:n}}var Q1e={featureToH3Set:Z7,h3ToFeature:Y7,h3SetToFeature:j1e,h3SetToMultiPolygonFeature:H1e,h3SetToFeatureCollection:W1e},F8=Q1e;function Hd({dataDeag:t,disabled:e=!1,deagKey:n}){const{current:r}=Ue.useRef(Mme(t.features,ce=>ce.properties.id)),[i,s]=Ue.useState(null),[l,o]=Ue.useState({}),[p,v]=Ue.useState([]),[S,M]=Ue.useState({}),[k,F]=Ue.useState({type:"FeatureCollection",features:[]}),[H,j]=Ue.useState({}),[ie,Y]=Ue.useState(!1),J=Ue.useCallback(({object:ce})=>{if(!ce){s(null),o({}),v([]);return}if(!e){if(ie)s(null),o({}),v(ce.properties.id);else if(ce.properties[n]){const me=F8.h3ToFeature(ce.hexId),Ee={};for(const He of ce.properties[n]){const Qe=r[He],Ye=V6(me,Qe.geometry);Ye&&(Ee[Qe.properties.id]=E6(Ye)/E6(me))}o(Ee),s(ce.hexId)}return!0}},[S,ie,e,n]),se=Ue.useCallback(({object:ce},me)=>{if(ce.properties.id==p)return F({type:"FeatureCollection",features:[]}),j({}),M({}),Y(!1),!0;if(ce.properties[n]==null)return;if(me.srcEvent.shiftKey)return M(Ye=>({...Ye,[ce.hexId]:ce.properties[n]})),!0;Y(!0),s(null),o({}),v(ce.properties.id),M({});const Ee={...S,[ce.hexId]:ce.properties[n]};M(Ee);const He={},Qe={type:"FeatureCollection",features:[]};for(const Ye in Ee)for(const nt of Ee[Ye]){const Fe=r[nt],tt=F8.h3ToFeature(Ye),Ze=V6(tt,Fe.geometry);Qe.features.push({...Ze,properties:{...Fe.properties}}),He[Fe.properties.id]={...Fe.properties}}return j(He),F(Qe),!0},[S,p,ie,n]);return{hoveredHex:i,clickedHexes:S,hoveredGeos:l,selectedGeoJSON:k,selectedGeos:H,hoveredGeoActive:p,onHover:J,onClick:se,selectionFinalized:ie}}const q1e=/^[og]\s*(.+)?/,Z1e=/^mtllib /,Y1e=/^usemtl /;class x4{constructor(e){let{index:n,name:r="",mtllib:i,smooth:s,groupStart:l}=e;this.index=n,this.name=r,this.mtllib=i,this.smooth=s,this.groupStart=l,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new x4({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class X1e{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);const i=new x4({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0});return this.materials.push(i),i}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class K1e{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new X1e(e),this.object.fromDeclaration=n,r&&r.name&&typeof r.clone=="function"){const i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseNormalIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseUVIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/2)*2}addVertex(e,n,r){const i=this.vertices,s=this.object.geometry.vertices;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,r){const i=this.normals,s=this.object.geometry.normals;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addColor(e,n,r){const i=this.colors,s=this.object.geometry.colors;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addUV(e,n,r){const i=this.uvs,s=this.object.geometry.uvs;s.push(i[e+0],i[e+1]),s.push(i[n+0],i[n+1]),s.push(i[r+0],i[r+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,r,i,s,l,o,p,v){const S=this.vertices.length;let M=this.parseVertexIndex(e,S),k=this.parseVertexIndex(n,S),F=this.parseVertexIndex(r,S);if(this.addVertex(M,k,F),i!==void 0&&i!==""){const H=this.uvs.length;M=this.parseUVIndex(i,H),k=this.parseUVIndex(s,H),F=this.parseUVIndex(l,H),this.addUV(M,k,F)}if(o!==void 0&&o!==""){const H=this.normals.length;M=this.parseNormalIndex(o,H),k=o===p?M:this.parseNormalIndex(p,H),F=o===v?M:this.parseNormalIndex(v,H),this.addNormal(M,k,F)}this.colors.length>0&&this.addColor(M,k,F)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const r of e)this.addVertexPoint(this.parseVertexIndex(r,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const r=this.vertices.length,i=this.uvs.length;for(const s of e)this.addVertexLine(this.parseVertexIndex(s,r));for(const s of n)this.addUVLine(this.parseUVIndex(s,i))}}function J1e(t){const e=new K1e;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let r="",i="",s=0,l=[];const o=typeof"".trimLeft=="function";for(let S=0,M=n.length;S<M;S++)if(r=n[S],r=o?r.trimLeft():r.trim(),s=r.length,s!==0&&(i=r.charAt(0),i!=="#"))if(i==="v"){const k=r.split(/\s+/);switch(k[0]){case"v":e.vertices.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])),k.length>=7&&e.colors.push(parseFloat(k[4]),parseFloat(k[5]),parseFloat(k[6]));break;case"vn":e.normals.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]));break;case"vt":e.uvs.push(parseFloat(k[1]),parseFloat(k[2]));break}}else if(i==="f"){const F=r.substr(1).trim().split(/\s+/),H=[];for(let ie=0,Y=F.length;ie<Y;ie++){const J=F[ie];if(J.length>0){const se=J.split("/");H.push(se)}}const j=H[0];for(let ie=1,Y=H.length-1;ie<Y;ie++){const J=H[ie],se=H[ie+1];e.addFace(j[0],J[0],se[0],j[1],J[1],se[1],j[2],J[2],se[2])}}else if(i==="l"){const k=r.substring(1).trim().split(" ");let F;const H=[];if(r.indexOf("/")===-1)F=k;else{F=[];for(let j=0,ie=k.length;j<ie;j++){const Y=k[j].split("/");Y[0]!==""&&F.push(Y[0]),Y[1]!==""&&H.push(Y[1])}}e.addLineGeometry(F,H)}else if(i==="p"){const F=r.substr(1).trim().split(" ");e.addPointGeometry(F)}else if((l=q1e.exec(r))!==null){const k=(" "+l[0].substr(1).trim()).substr(1);e.startObject(k)}else if(Y1e.test(r))e.object.startMaterial(r.substring(7).trim(),e.materialLibraries);else if(Z1e.test(r))e.materialLibraries.push(r.substring(7).trim());else if(i==="s"){if(l=r.split(" "),l.length>1){const F=l[1].trim().toLowerCase();e.object.smooth=F!=="0"&&F!=="off"}else e.object.smooth=!0;const k=e.object.currentMaterial();k&&(k.smooth=e.object.smooth)}else{if(r==="\0")continue;throw new Error('Unexpected line: "'.concat(r,'"'))}e.finalize();const p=[],v=[];for(const S of e.objects){const{geometry:M}=S;if(M.vertices.length===0)continue;const k={header:{vertexCount:M.vertices.length/3},attributes:{}};switch(M.type){case"Points":k.mode=0;break;case"Line":k.mode=1;break;default:k.mode=4;break}k.attributes.POSITION={value:new Float32Array(M.vertices),size:3},M.normals.length>0&&(k.attributes.NORMAL={value:new Float32Array(M.normals),size:3}),M.colors.length>0&&(k.attributes.COLOR_0={value:new Float32Array(M.colors),size:3}),M.uvs.length>0&&(k.attributes.TEXCOORD_0={value:new Float32Array(M.uvs),size:2}),k.materials=[];for(const F of S.materials){const H={name:F.name,flatShading:!F.smooth};k.materials.push(H),v.push(H)}k.name=S.name,p.push(k)}return{meshes:p,materials:v}}function eye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const i in e)n=n||new Map,i!=="value"&&n.set(i,JSON.stringify(e[i]));const r=[];for(const i in t){const s=t[i],l=tye(i,s);r.push(l)}return new O0(r,n)}function tye(t,e){const n=new Map;for(const s in e)s!=="value"&&n.set(s,JSON.stringify(e[s]));const r=Ihe(e.value);return!("size"in e)||e.size===1?new yg(t,r,!1,n):new yg(t,new khe(e.size,new yg("value",r)),!1,n)}function N8(t,e){const{meshes:n}=J1e(t),r=n.reduce((o,p)=>o+p.header.vertexCount,0),i=nye(n,r),s={vertexCount:r,boundingBox:_F(i)},l=eye(i,{mode:4,boundingBox:s.boundingBox});return{loaderData:{header:{}},schema:l,header:s,mode:4,attributes:i}}function nye(t,e){const n=new Float32Array(e*3);let r,i,s,l=0;for(const p of t){const{POSITION:v,NORMAL:S,COLOR_0:M,TEXCOORD_0:k}=p.attributes;n.set(v.value,l*3),S&&(r=r||new Float32Array(e*3),r.set(S.value,l*3)),M&&(i=i||new Float32Array(e*3),i.set(M.value,l*3)),k&&(s=s||new Float32Array(e*2),s.set(k.value,l*2)),l+=v.value.length/3}const o={};return o.POSITION={value:n,size:3},r&&(o.NORMAL={value:r,size:3}),i&&(o.COLOR_0={value:i,size:3}),s&&(o.TEXCOORD_0={value:s,size:2}),o}const rye="3.4.14",iye={name:"OBJ",id:"obj",module:"obj",version:rye,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:sye,options:{obj:{}}};function sye(t){return t[0]==="v"}const Vv={...iye,parse:async(t,e)=>N8(new TextDecoder().decode(t)),parseTextSync:(t,e)=>N8(t)},oye=ss().domain([0,1]).range(ph(0,sa.length)),aye=sa[0];class Wd extends Sr{initializeState(){super.initializeState();const{zoom:e}=this.context.viewport,n=Object.keys(this.props.data).map(s=>parseInt(s)),r=ur().domain(this.props.zoomRange).range([0,1]).clamp(!0),i=ss().domain([0,1]).range(n)(r(e));this.setState({hextiles:this.props.data,resRange:n,lastResolution:i,valueInterpResolution:r}),this.createPolygons()}createPolygons(){const{hextiles:e,lastResolution:n}=this.state,r=[],i=e[n],[s,l]=this.props.offset;Object.keys(i).forEach(o=>{const p=i[o],v=mP(gP(o)[0],yr.km)*.48,[S,M]=lS(o);let k=0;const F=Bs(n,yr.km)/Bs(5,yr.km);for(let[H,j,ie]of this.props.getValue?aye:[[0,0,0]])r.push({position:[M+(H+s)*v/(111.32*Math.cos(S*Math.PI/180)),S+(j+l)*v/110.574,(typeof this.props.getElevation=="function"?this.props.getElevation({properties:p}):this.props.getElevation)+ie*1e5*F],properties:p,polyIdx:k++,hexID:o})}),this.setState({...this.state,polygons:r})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:l,changeFlags:o,context:p}=e;if(s.getElevation!=l.getElevation||o.viewportChanged){const v=ss().domain([0,1]).range(n)(i(p.viewport.zoom));(v!=r||s.getElevation!=l.getElevation)&&(this.setState({...this.state,lastResolution:v}),this.createPolygons())}}renderLayers(){const{polygons:e,lastResolution:n,resRange:r}=this.state,i=Bs(n,yr.km)/Bs(5,yr.km);return[new vv(this.getSubLayerProps({data:this.props.data,mesh:this.props.mesh,texture:this.props.texture,textureParameters:this.props.textureParameters,getPosition:this.props.getPosition,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,sizeScale:this.props.sizeScale,_useMeshColors:this.props._useMeshColors,_instanced:this.props._instanced,wireframe:this.props.wireframe,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"IconHexTileLayer",data:e,getPosition:s=>s.position,sizeScale:this.props.sizeScale*i,getTranslation:this.props.getValue===null?[0,0,0]:s=>{const l=sa[oye(this.props.getValue(s))][s.polyIdx],o=sa[0][s.polyIdx],p=mP(gP(s.hexID)[0],yr.m)*.5;return[(l[0]-o[0])*p,(l[1]-o[1])*p,(l[2]-o[2])*1e5*i]}}))]}}Wd.layerName="IconHexTileLayer";Wd.defaultProps={...Sr.defaultProps,...vv.defaultProps,thicknessRange:[.7,.9],getValue:null,getElevation:()=>0,offset:[0,0],zoomRange:[7,9]};function U8(t,e,n=1){const r=n,[i,s]=lS(t);return e.map(o=>{let p=wl(s,o[0],r),v=wl(i,o[1],r);return[p,v]})}function lye(t,[e,n]){let r=JZ(t).map(l=>[l[1],l[0]]),i=U8(t,r,n),s=U8(t,r,e);return[i,s]}class Tl extends Sr{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=ur().domain(this.props.zoomRange).range([0,1]).clamp(!0),r=ss().domain([0,1]).range(e)(n(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:r,valueInterpResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],r=this.props.data[e];Object.keys(r).forEach((i,s)=>{let l=r[i];const o=this.props.getValue?ur().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:l})):this.props.thicknessRange[0];let p=lye(i,[o,this.props.thicknessRange[1]]);this.props.raised?n.push({polygon:p.map(v=>v.map(([S,M])=>[S,M,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:i,properties:l}):this.props.getElevation])),hexId:i,properties:l}):n.push({hexId:i,polygon:p,properties:l})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:l,changeFlags:o,context:p}=e;if(s.getElevation!=l.getElevation||s.getValue!=l.getValue||o.viewportChanged){const v=ss().domain([0,1]).range(n)(i(p.viewport.zoom));(v!=r||s.getValue!=l.getValue||s.getElevation!=l.getElevation)&&(this.setState({...this.state,lastResolution:v}),this.createPolygons())}}renderLayers(){return[new Nd(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,extruded:this.props.extruded,wireframe:this.props.wireframe,lineWidthUnits:this.props.lineWidthUnits,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,onClick:this.props.onClick,id:"SolidHexTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}Tl.layerName="SolidHexTileLayer";Tl.defaultProps={...Sr.defaultProps,...Nd.defaultProps,thicknessRange:[.7,.9],getValue:void 0,raised:!1,zoomRange:[7,9]};class Gv extends Sr{renderLayers(){const{data:e,deagData:n,curOption:r,hoveredHex:i,visible:s,clickedHexes:l,hoveredGeoActive:o,hoveredGeos:p,selectedGeoJSON:v,selectedGeos:S,selectionFinalized:M,zoomRange:k,getFillColor:F}=this.props;return[new ha({id:"GeoJsonGray",data:n,opacity:.3,stroked:!1,getFillColor:H=>!M&&H.properties.id in p?[100,100,100,205*p[H.properties.id]+50]:[0,0,0,0],visible:s&&!M,updateTriggers:{getFillColor:[i,M]},pickable:!1}),new ha({id:"GeoJsonColor",data:n,opacity:1,pickable:M,visible:s,getLineWidth:H=>H.properties.id in S?H.properties.id==o?100:20:0,getFillColor:H=>{if(H.properties.id in S){if(H.properties.id==o){const j=[0,0,.5019607843137255,.5019607843137255],ie=[...F({properties:S[H.properties.id]}),255];return[(j[0]*j[3]+ie[0]/255*(1-j[3]))*255,(j[1]*j[3]+ie[1]/255*(1-j[3]))*255,(j[2]*j[3]+ie[2]/255*(1-j[3]))*255,(j[3]*j[3]+ie[3]/255*(1-j[3]))*255]}return[...F({properties:S[H.properties.id]}),255]}return[0,0,0,0]},getLineColor:[0,0,0],updateTriggers:{getFillColor:[...this.props.updateTriggers.getFillColor||[],o,r,M],getLineWidth:[o,r,M]}}),new Tl({id:"HoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!M,autoHighlight:!M,visible:s,zoomRange:k})]}}Gv.layerName="DeaggregatedLayer";Gv.defaultProps={...Sr.defaultProps,autoHighlight:!0};let w4=class extends Sr{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o,useVsup:p,showAllRings:v}=this.props;return[new Tl({id:"Party",data:e,thicknessRange:[0,1],getFillColor:S=>p?Wn.party.interpVsup(S.properties.DemLead||0,S.properties.DemLeadVar||0):Wn.party.interpColor(S.properties.DemLead||0),opacity:1,visible:l,updateTriggers:{getFillColor:[r,p]},zoomRange:o,pickable:!1}),new Tl({id:"PoC",data:e,thicknessRange:[.4,.65],getFillColor:S=>Wn.poc.interpColor(S.properties.PoC,!v),getValue:S=>p?Wn.poc.scaleLinearVar(S.properties.PoCVar)*.7+.3:1,raised:!0,visible:l,getElevation:S=>S.hexId in i?5e3:0,getLineWidth:S=>S.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new Vd({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r,v],getValue:[n,r,p],getElevation:[s],getLineWidth:[s]},zoomRange:o,pickable:!1}),new Wd({id:"Population",data:e,loaders:[Vv],mesh:"assets/human.obj",raised:!0,getColor:S=>[255,255,7,(p?Wn.population.scaleLinearVar(S.properties.PopSqKmVar):1)*200+55],getValue:S=>Wn.population.scaleLinear(S.properties.PopSqKm),visible:l,sizeScale:400,opacity:1,updateTriggers:{getTranslation:[r],getColor:[p]},zoomRange:o,pickable:!1}),new Gv({...this.props,id:"DeagLayer",data:e,deagData:$m,getFillColor:S=>Wn.party.interpColor(S.properties.pct_dem_lead,!1,!1)})]}};w4.layerName="MultivariableHextileLayer";w4.defaultProps={...Sr.defaultProps,autoHighlight:!0};const wb=512,Aye=Math.PI/180;function X7({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n?.props._customRender,i=n?.props.onLoad,s=J7({...n?.props,_customRender:()=>{t.triggerRepaint(),r?.("")}});let l;return(!n||n.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:gm(t)}),n!=null&&n.isInitialized?V8(n,t):s.onLoad=()=>{i?.(),V8(l,t)}),n?(l=n,n.setProps(s),n.userData.isExternal=!0):(l=new vf(s),t.on("remove",()=>{K7(t)})),l.userData.mapboxLayers=new Set,t.__deck=l,t.on("render",()=>{l.isInitialized&&pye(l,t)}),l}function V8(t,e){const n=()=>{t.isInitialized?gye(t,e):e.off("move",n)};e.on("move",n)}function K7(t){var e;(e=t.__deck)===null||e===void 0||e.finalize(),t.__deck=null}function J7(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new Yu({id:"mapbox"})]}}function uye(t,e){t.userData.mapboxLayers.add(e),b4(t)}function cye(t,e){t.userData.mapboxLayers.delete(e),b4(t)}function hye(t,e){b4(t)}function fye(t,e,n){let{currentViewport:r}=t.userData,i=!1;r||(r=eN(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:s})=>n.id===s.id||s.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function gm(t){var e;const{lng:n,lat:r}=t.getCenter(),i={longitude:(n+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(e=t.getTerrain)!==null&&e!==void 0&&e.call(t)&&dye(t,i),i}function dye(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:i,latitude:s,pitch:l}=e,o=n.x*wb,p=(1-n.y)*wb,v=n.z*wb,S=dA([i,s]),M=o-S[0],k=p-S[1],F=Math.sqrt(M*M+k*k),H=l*Aye,j=1.5*r,ie=H<.001?j*Math.cos(H)/v:j*Math.sin(H)/F;e.zoom=Math.log2(ie);const Y=j*Math.cos(H)/ie,J=v-Y;e.position=[0,0,J/Vy(s)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function eN(t,e,n=!0){return new Ac({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...gm(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function pye(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const i=Array.from(n,S=>S.id),l=_f(t.props.layers,Boolean).some(S=>S&&!i.includes(S.id));let o=t.getViewports();const p=o.findIndex(S=>S.id==="mapbox"),v=o.length>1||p<0;(l||v)&&(p>=0&&(o=o.slice(),o[p]=eN(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:S=>(!t.props.layerFilter||t.props.layerFilter(S))&&(S.viewport.id!=="mapbox"||!i.includes(S.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function gye(t,e){t.setProps({viewState:gm(e)}),t.needsRedraw({clearRedrawFlags:!0})}function b4(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);e.push(i)}),t.setProps({layers:e})}class mye{constructor(e){if(oe(this,"id",void 0),oe(this,"type",void 0),oe(this,"renderingMode",void 0),oe(this,"map",void 0),oe(this,"deck",void 0),oe(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=X7({map:e,gl:n,deck:this.props.deck}),uye(this.deck,this)}onRemove(){this.deck&&cye(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&hye(this.deck)}render(){fye(this.deck,this.map,this)}}const bb="__UNDEFINED__";function gy(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const i=_f(r,Boolean);if(n!==r){const o=_f(n,Boolean),p=new Set(o.map(v=>v.id));for(const v of i)p.delete(v.id);for(const v of p)t.getLayer(v)&&t.removeLayer(v)}for(const o of i){const p=t.getLayer(o.id);p?p.implementation.setProps(o.props):t.addLayer(new mye({id:o.id,deck:e}),o.props.beforeId)}const s=t.style._order,l={};for(const o of i){let{beforeId:p}=o.props;(!p||!s.includes(p))&&(p=bb),l[p]=l[p]||[],l[p].push(o.id)}for(const o in l){const p=l[o];let v=o===bb?s.length:s.indexOf(o),S=o===bb?void 0:o;for(let M=p.length-1;M>=0;M--){const k=p[M],F=s.indexOf(k);F!==v-1&&(t.moveLayer(k,S),F>v&&v++),v--,S=k}}}class yye{constructor(e){oe(this,"_props",void 0),oe(this,"_deck",void 0),oe(this,"_map",void 0),oe(this,"_container",void 0),oe(this,"_interleaved",void 0),oe(this,"_lastMouseDownPoint",void 0),oe(this,"_handleStyleChange",()=>{gy(this._map,this._deck,this._props.layers,this._props.layers)}),oe(this,"_updateContainerSize",()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:s}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(i,"px"),height:"".concat(s,"px")})}}),oe(this,"_updateViewState",()=>{const i=this._deck;i&&(i.setProps({viewState:gm(this._map)}),i.isInitialized&&i.redraw())}),oe(this,"_handleMouseEvent",i=>{const s=this._deck;if(!s||!s.isInitialized)return;const l={type:i.type,offsetCenter:i.point,srcEvent:i},o=this._lastMouseDownPoint;switch(!i.point&&o&&(l.deltaX=i.originalEvent.clientX-o.clientX,l.deltaY=i.originalEvent.clientY-o.clientY,l.offsetCenter={x:o.x+l.deltaX,y:o.y+l.deltaY}),l.type){case"mousedown":s._onPointerDown(l),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":l.type="panstart",s._onEvent(l);break;case"drag":l.type="panmove",s._onEvent(l);break;case"dragend":l.type="panend",s._onEvent(l);break;case"click":l.tapCount=1,s._onEvent(l);break;case"dblclick":l.type="click",l.tapCount=2,s._onEvent(l);break;case"mousemove":l.type="pointermove",s._onPointerMove(l);break;case"mouseout":l.type="pointerleave",s._onPointerMove(l);break;default:return}});const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&gy(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?J7(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,pointerEvents:"none"}),this._container=n,this._deck=new vf({...this._props,parent:n,viewState:gm(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){return this._deck=X7({map:e,gl:e.painter.context.gl,deck:new vf({...this._props,gl:e.painter.context.gl})}),e.on("styledata",this._handleStyleChange),gy(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)===null||n===void 0||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),gy(e,this._deck,this._props.layers,[]),K7(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Ni(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Ni(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Ni(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}function G8(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function jm(t){return Rd(()=>new yye({...t,layers:Ue.Children.map(t.children,n=>G8(n.type,n.props))})).setProps({...t,layers:Ue.Children.map(t.children,n=>G8(n.type,n.props))}),null}function _ye(){const{current:t}=Ue.useRef(Object.keys(hc).map(M=>parseInt(M))),[e,n]=Ue.useState(5),[r,i]=Ue.useState(!1),[s,l]=Ue.useState(!1),o=m4(),p=Hd({disabled:o.curOption>1,dataDeag:$m,deagKey:"PrecinctRgs"}),v=O7(o),S={data:hc,...o,...p};return rt.createElement(rt.Fragment,null,rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",antialias:!0,initialViewState:R7},rt.createElement(jm,{getTooltip:v,interleaved:!0,effects:[Eh],onViewStateChange:({viewState:M})=>{n(M.zoom)},antialias:!0},rt.createElement(ha,{id:"ground",data:jme,stroked:!1,getFillColor:[0,0,0,0],beforeId:"landcover"}),rt.createElement(w4,{id:"slide-election",...S,zoomRange:[5,7],visible:!0,useVsup:r,showAllRings:s,beforeId:"place_hamlet"}))),rt.createElement(vye,{res:ss().domain([0,1]).range(t)(ur().domain([5,7]).range([0,1]).clamp(!0)(e)),useVsup:r,setUseVsup:i,showAllRings:s,setShowAllRings:l}))}function vye({res:t,useVsup:e,setUseVsup:n,showAllRings:r,setShowAllRings:i}){const s=Ue.useRef(),l=Ue.useRef();return Ue.useEffect(()=>{Ui(".lin-legend").style("visibility",e?"hidden":"visible"),Ui(".vsup-legend-v").style("visibility",e?"visible":"hidden"),Ui(".vsup-legend-u").attr("transform",`translate(0,${e?0:50})`),Ui(".box1").attr("transform",`translate(0,${e?0:150})`).attr("height",e?250:100).attr("width",e?250:300),Ui(".box2").attr("transform",`translate(0,${e?0:60})`).attr("height",e?170:110)},[e]),Ue.useEffect(()=>{Gr("#diff-u").html("").call(Ef(Wn.poc,"% PoC",r))},[r]),Ue.useLayoutEffect(()=>{const o=Gr(s.current).attr("width",window.innerWidth).attr("height",window.innerHeight),p=200,v=window.innerWidth,S=o.append("g").attr("transform",`translate(0,${window.innerHeight-p})`);S.append("g").attr("transform",`translate(0,${p-250})`).append("rect").attr("class","box1").attr("height",250).attr("width",250).attr("fill","white"),S.append("g").attr("transform",`translate(0,${p-170})`).append("rect").attr("class","box2").attr("height",170).attr("width",920).attr("x",350).attr("fill","white"),S.append("g").attr("class","vsup-legend-v").append("g").call(Bv().vtitle("% Dem. Lead").utitle("Variance").scale(Wn.party.vsup).size(150).x(40).y(p-150-40)),S.append("g").attr("class","lin-legend").append("g").call(nu.simpleLegend(null,250,20,".2s").title("% Dem. Lead").size(250).height(20).scale(Wn.party.colorsStepped).x(20).y(p-70));let M=400,k=p-120;S.append("g").attr("transform",`translate(${M},${k})`).append("g").attr("class","vsup-legend-u").attr("id","diff-u").call(Ef(Wn.poc,"% PoC",r)),S.append("g").attr("transform",`translate(${M},${k+20})`).append("g").attr("class","vsup-legend-v").call(Rv(Wn.poc)),M=750,k=p-120,S.append("g").attr("transform",`translate(${M},${k})`).append("g").attr("class","vsup-legend-u").call(Lv(Wn.population,"assets/human.png","Pop. / Km2")),S.append("g").attr("transform",`translate(${M},${k+55})`).append("g").attr("class","vsup-legend-v").call(Dv(Wn.population,"assets/human.png")),S.append("g").attr("transform",`translate(${v-60},${p-80})`).call(p4(0,0,50,"rgba(146, 146, 146, 0.5)")).call(function(F){l.current=[F.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${_r(".2s")(ic(t,yr.km2))} km²`),F.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${_r(".2s")(Bs(t,yr.km))} km →;`)]})},[]),Ue.useEffect(()=>{let[o,p]=l.current;o.text(`${_r(".2s")(ic(t,yr.km2))} km²`),p.text(`← ${_r(".2s")(Bs(t,yr.km))} km →;`)},[t]),rt.createElement(rt.Fragment,null,rt.createElement("svg",{className:"legend-area",ref:s}),rt.createElement("div",{className:"study-input"},rt.createElement("input",{type:"checkbox",checked:e,onChange:()=>n(o=>!o)}),rt.createElement("span",null,"Use VSUP"),rt.createElement("input",{type:"checkbox",checked:r,onChange:()=>i(o=>!o)}),rt.createElement("span",null,"Show All Rings")))}const xye=8,wye="OSM Liberty",bye={"maputnik:license":"https://github.com/maputnik/osm-liberty/blob/gh-pages/LICENSE.md","maputnik:renderer":"mbgljs","openmaptiles:version":"3.x"},Eye={openmaptiles:{type:"vector",url:"https://tiles.basemaps.cartocdn.com/vector/carto.streets/v1/tiles.json"},natural_earth_shaded_relief:{maxzoom:6,tileSize:256,tiles:["https://klokantech.github.io/naturalearthtiles/tiles/natural_earth_2_shaded_relief.raster/{z}/{x}/{y}.png"],type:"raster"}},Tye="https://maputnik.github.io/osm-liberty/sprites/osm-liberty",Sye="https://orangemug.github.io/font-glyphs/glyphs/{fontstack}/{range}.pbf",Cye=[{id:"boundary_3",type:"line",source:"openmaptiles","source-layer":"boundary",minzoom:8,filter:["all",["in","admin_level",3,4]],layout:{"line-join":"round"},paint:{"line-color":"#9e9cab","line-dasharray":[5,1],"line-width":{base:1,stops:[[4,.4],[5,1],[12,1.8]]}}},{id:"boundary_2_z0-4",type:"line",source:"openmaptiles","source-layer":"boundary",maxzoom:5,filter:["all",["==","admin_level",2],["!has","claimed_by"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(248, 1%, 41%)","line-opacity":{base:1,stops:[[0,.4],[4,1]]},"line-width":{base:1,stops:[[3,1],[5,1.2],[12,3]]}}},{id:"boundary_2_z5-",type:"line",source:"openmaptiles","source-layer":"boundary",minzoom:5,filter:["all",["==","admin_level",2]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(248, 1%, 41%)","line-opacity":{base:1,stops:[[0,.4],[4,1]]},"line-width":{base:1,stops:[[3,1],[5,1.2],[12,3]]}}},{id:"water_name_line",type:"symbol",source:"openmaptiles","source-layer":"waterway",filter:["all",["==","$type","LineString"]],layout:{"text-field":"{name}","text-font":["Roboto Regular"],"text-max-width":5,"text-size":12,"symbol-placement":"line"},paint:{"text-color":"#5d60be","text-halo-color":"rgba(255,255,255,0.7)","text-halo-width":1}},{id:"water_name_point",type:"symbol",source:"openmaptiles","source-layer":"water_name",filter:["==","$type","Point"],layout:{"text-field":"{name}","text-font":["Roboto Regular"],"text-max-width":5,"text-size":12},paint:{"text-color":"#5d60be","text-halo-color":"rgba(255,255,255,0.7)","text-halo-width":1}},{id:"poi_z16",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:16,filter:["all",["==","$type","Point"],[">=","rank",20]],layout:{"icon-image":["match",["get","subclass"],["florist","furniture"],["get","subclass"],["get","class"]],"text-anchor":"top","text-field":"{name}","text-font":["Roboto Condensed Italic"],"text-max-width":9,"text-offset":[0,.6],"text-size":12},paint:{"text-color":"#666","text-halo-blur":.5,"text-halo-color":"#ffffff","text-halo-width":1}},{id:"poi_z15",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:15,filter:["all",["==","$type","Point"],[">=","rank",7],["<","rank",20]],layout:{"icon-image":["match",["get","subclass"],["florist","furniture"],["get","subclass"],["get","class"]],"text-anchor":"top","text-field":"{name}","text-font":["Roboto Condensed Italic"],"text-max-width":9,"text-offset":[0,.6],"text-size":12},paint:{"text-color":"#666","text-halo-blur":.5,"text-halo-color":"#ffffff","text-halo-width":1}},{id:"poi_z14",type:"symbol",source:"openmaptiles","source-layer":"poi",minzoom:14,filter:["all",["==","$type","Point"],[">=","rank",1],["<","rank",7]],layout:{"icon-image":["match",["get","subclass"],["florist","furniture"],["get","subclass"],["get","class"]],"text-anchor":"top","text-field":"{name}","text-font":["Roboto Condensed Italic"],"text-max-width":9,"text-offset":[0,.6],"text-size":12},paint:{"text-color":"#666","text-halo-blur":.5,"text-halo-color":"#ffffff","text-halo-width":1}},{id:"poi_transit",type:"symbol",source:"openmaptiles","source-layer":"poi",filter:["all",["in","class","bus","rail","airport"]],layout:{"icon-image":"{class}","text-anchor":"left","text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-max-width":9,"text-offset":[.9,0],"text-size":12},paint:{"text-color":"#4898ff","text-halo-blur":.5,"text-halo-color":"#ffffff","text-halo-width":1}},{id:"place_other",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["in","class","hamlet","island","islet","neighbourhood","suburb","quarter"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-letter-spacing":.1,"text-max-width":9,"text-size":{base:1.2,stops:[[12,10],[15,14]]},"text-transform":"uppercase"},paint:{"text-color":"#633","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.2}},{id:"place_village",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["==","class","village"]],layout:{"text-field":"{name_en}","text-font":["Roboto Regular"],"text-max-width":8,"text-size":{base:1.2,stops:[[10,12],[15,22]]}},paint:{"text-color":"#333","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.2}},{id:"place_town",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["==","class","town"]],layout:{"icon-image":{base:1,stops:[[0,"dot_9"],[8,""]]},"text-anchor":"bottom","text-field":"{name_en}","text-font":["Roboto Regular"],"text-max-width":8,"text-offset":[0,0],"text-size":{base:1.2,stops:[[7,12],[11,16]]}},paint:{"text-color":"#333","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.2}},{id:"place_city",type:"symbol",source:"openmaptiles","source-layer":"place",minzoom:5,filter:["all",["==","class","city"]],layout:{"icon-image":{base:1,stops:[[0,"dot_9"],[8,""]]},"text-anchor":"bottom","text-field":"{name_en}","text-font":["Roboto Medium"],"text-max-width":8,"text-offset":[0,0],"text-size":{base:1.2,stops:[[7,14],[11,24]]},"icon-allow-overlap":!0,"icon-optional":!1},paint:{"text-color":"#333","text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1.2}},{id:"state",type:"symbol",source:"openmaptiles","source-layer":"place",maxzoom:6,filter:["all",["==","class","state"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-size":{stops:[[4,11],[6,15]]},"text-transform":"uppercase"},paint:{"text-color":"#633","text-halo-color":"rgba(255,255,255,0.7)","text-halo-width":1}},{id:"country_3",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",[">=","rank",3],["==","class","country"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-max-width":6.25,"text-size":{stops:[[3,11],[7,17]]},"text-transform":"none"},paint:{"text-color":"#334","text-halo-blur":1,"text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1}},{id:"country_2",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["==","rank",2],["==","class","country"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-max-width":6.25,"text-size":{stops:[[2,11],[5,17]]},"text-transform":"none"},paint:{"text-color":"#334","text-halo-blur":1,"text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1}},{id:"country_1",type:"symbol",source:"openmaptiles","source-layer":"place",filter:["all",["==","rank",1],["==","class","country"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-max-width":6.25,"text-size":{stops:[[1,11],[4,17]]},"text-transform":"none"},paint:{"text-color":"#334","text-halo-blur":1,"text-halo-color":"rgba(255,255,255,0.8)","text-halo-width":1}},{id:"continent",type:"symbol",source:"openmaptiles","source-layer":"place",maxzoom:1,filter:["all",["==","class","continent"]],layout:{"text-field":"{name_en}","text-font":["Roboto Condensed Italic"],"text-size":13,"text-transform":"uppercase","text-justify":"center"},paint:{"text-color":"#633","text-halo-color":"rgba(255,255,255,0.7)","text-halo-width":1}}],Mye="osm-liberty",tf={version:xye,name:wye,metadata:bye,sources:Eye,sprite:Tye,glyphs:Sye,layers:Cye,id:Mye};let E4=class extends Sr{renderLayers(){return[new Fm({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:2,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new Om(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};E4.layerName="BaseTerrainLayer";E4.defaultProps={...Sr.defaultProps};function Pye(){const t=m4(),e=Hd({disabled:t.curOption>1,dataDeag:$m,deagKey:"PrecinctRgs"}),n=O7({...t,curOption:100}),r={data:hc,...t,...e},[i,s]=Ue.useState({longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58}),l=Ue.useCallback(({viewId:o,viewState:p})=>{s({one:p,two:p,three:p})},[]);return rt.createElement(rt.Fragment,null,rt.createElement(t4,{controller:!0,effects:[Eh],viewState:i,onViewStateChange:l,getTooltip:n,layerFilter:({layer:o,viewport:p})=>o.id=="slide-terrain"||o.id=="Pop"&&p.id=="one"||o.id=="Votes"&&p.id=="two"||o.id=="Demog"&&p.id=="three",views:[new Yu({id:"one",x:"0%",y:"0%",height:"50%",width:"50%",controller:!0}),new Yu({id:"two",x:"50%",y:"0%",height:"50%",width:"50%",controller:!0}),new Yu({id:"three",x:"25%",y:"50%",height:"50%",width:"50%",controller:!0})]},rt.createElement(El,{id:"one"},rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:tf})),rt.createElement(El,{id:"two"},rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:tf})),rt.createElement(El,{id:"three"},rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:tf})),rt.createElement(E4,{id:"slide-terrain",...r}),rt.createElement(ha,{id:"Pop",data:D8,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>Wn.population.interpColor(o.properties["Population per Sqkm"],!1,!1),pickable:!0,autoHighlight:!0}),rt.createElement(ha,{id:"Votes",data:$me,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>Wn.party.interpColor(o.properties.DemLeadCount,!1,!1),pickable:!0,autoHighlight:!0}),rt.createElement(ha,{id:"Demog",data:D8,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>Wn.poc.interpColor(o.properties.PoCCount||0,!1,!1),pickable:!0,autoHighlight:!0})),rt.createElement(kye,{...r}))}function kye({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return rt.createElement(rt.Fragment,null,rt.createElement(Iye,null))}function Iye({}){const t=Ue.useRef();return Ue.useLayoutEffect(()=>{Gr(t.current).attr("width",400).attr("height",500).call(function(r){r.append("g").call(nu.simpleLegend(null,250,20,".2s").title("Population / Km2").size(250).height(20).scale(Wn.population.colorsStepped).x(400-280).y(500-240))}).call(function(r){r.append("g").call(nu.simpleLegend(null,250,20,".2s").title("Percent Democrat Lead").size(250).height(20).scale(Wn.party.colorsStepped).x(400-280).y(500-170))}).call(function(r){r.append("g").call(nu.simpleLegend(null,250,20,".2s").title("Percent PoC").size(250).height(20).scale(Wn.poc.colorsStepped).x(400-280).y(500-100))})},[]),rt.createElement("svg",{className:"legend-area",ref:t})}function tN(t){const[e,n,r]=t.split("/"),i=T4(r);return[parseFloat(e)+i/2,parseFloat(n)+i/2]}function Lye(t,e,n=1,r){const i=n,[s,l]=tN(t),o=nN(t),p=T4(o)/4*i;return e.map(S=>{let M=wl(l,S[0],i),k=wl(s,S[1],i);return[M+p*r[0],k+p*r[1]]})}function nN(t){const[e,n,r]=t.split("/");return parseInt(r)}function Dye(t){const[e,n]=tN(t),r=nN(t),i=T4(r)/4;return[[e+i,n-i],[e+i,n+i],[e-i,n+i],[e-i,n-i]]}function Rye(t){return t/111.1}function Bye(t){return Bs(parseInt(t),yr.km)*2}function T4(t){return Rye(Bye(t))}function zye(t,[e,n],r){let i=Dye(t).map(l=>[l[1],l[0]]);return[Lye(t,i,1-e,r)]}class xs extends Sr{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=ur().domain(this.props.zoomRange).range([0,1]).clamp(!0),r=ss().domain([0,1]).range(e)(n(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:r,valueInterpResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],r=this.props.data[e];Object.keys(r).forEach((i,s)=>{let l=r[i];const o=this.props.getValue?ur().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:l})):this.props.thicknessRange[0];let p=zye(i,[o,this.props.thicknessRange[1]],this.props.offset);this.props.raised?n.push({polygon:p.map(v=>v.map(([S,M])=>[S,M,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:i,properties:l}):this.props.getElevation])),hexId:i,properties:l}):n.push({hexId:i,polygon:p,properties:l})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:l,changeFlags:o,context:p}=e;if(s.getElevation!=l.getElevation||s.getValue!=l.getValue||o.viewportChanged){const v=ss().domain([0,1]).range(n)(i(p.viewport.zoom));(v!=r||s.getValue!=l.getValue||s.getElevation!=l.getElevation)&&(this.setState({...this.state,lastResolution:v}),this.createPolygons())}}renderLayers(){return[new Nd(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,lineWidthUnits:this.props.lineWidthUnits,extruded:this.props.extruded,wireframe:this.props.wireframe,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,onClick:this.props.onClick,id:"SolidSquareTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}xs.layerName="SolidSquareTileLayer";xs.defaultProps={...Sr.defaultProps,...Nd.defaultProps,thicknessRange:[0,1],getValue:void 0,raised:!1,zoomRange:[7,9],offset:[0,0]};const Oye=Object.keys(Gm).map(t=>parseInt(t)),$8=[5,7];function Fye(){const[t,e]=Ue.useState(5),n=m4(),r=Hd({disabled:n.curOption>1,dataDeag:$m,deagKey:"PrecinctRgs"}),i={data:Gm,...n,...r};return rt.createElement(rt.Fragment,null,rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",antialias:!0,initialViewState:R7},rt.createElement(jm,{interleaved:!0,effects:[Eh],onViewStateChange:({viewState:s})=>{e(s.zoom)}},rt.createElement(S4,{id:"slide-election",...i,zoomRange:$8,visible:!0,beforeId:"place_hamlet"}))),rt.createElement(Nye,{res:ss().domain($8).range(Oye)(t),...i}))}class S4 extends Sr{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new xs({id:"SquareBorders",data:e,getFillColor:[0,0,0,0],getLineColor:[80,80,80,100],stroked:!0,lineWidthUnits:"pixels",getValue:p=>2,visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[0,0]}),new xs({id:"PoC",data:e,getFillColor:[0,121,42],getValue:p=>Wn.poc.scaleLinear(p.properties.PoC),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,-1]}),new xs({id:"Dem",data:e,getFillColor:[72,30,197],getValue:p=>Wn.party.scaleLinear(p.properties.DemLead>0?p.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[-1,1]}),new xs({id:"Repub",data:e,getFillColor:[165,0,38],getValue:p=>Wn.party.scaleLinear(p.properties.DemLead<0?-p.properties.DemLead*2-100:-100),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,1]}),new xs({id:"Pop",data:e,getFillColor:[156,156,156],getValue:p=>Wn.population.scaleLinear(p.properties.PopSqKm),visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[1,-1]})]}}S4.layerName="MultivariableSquareTileLayer";S4.defaultProps={...Sr.defaultProps,autoHighlight:!0};function j8(t){return Bs(parseInt(t),yr.km)*2}function Nye({res:t}){const e=Ue.useRef(),n=Ue.useRef();return Ue.useLayoutEffect(()=>{const r=window.innerHeight,i=window.innerWidth,s=Gr(e.current).attr("width",i).attr("height",r);s.append("g").attr("transform",`translate(${i-60},${r-170})`).call(l=>{l.append("rect").attr("x",-50).attr("y",-50).attr("width",100).attr("height",100).attr("fill","rgba(146, 146, 146, 0.5)")}).call(function(l){n.current=[l.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${_r(".2s")(ic(t,yr.km2))} km²`),l.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${_r(".2s")(Bs(t,yr.km))} km →;`)]}),s.append("g").attr("transform",`translate(120,${r-140})`).call(l=>{l.append("rect").attr("x",-120).attr("y",-140).attr("width",459).attr("height",240).attr("fill","rgba(255, 255, 255, 1)");const o=75;l.append("text").attr("x",o).attr("y",-o-15).style("font-weight","bold").attr("text-anchor","middle").text("Measure Type"),l.append("rect").attr("x",0).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(72, 30, 197, 0.7)"),l.append("rect").attr("x",o).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(165, 0, 38, 0.7)"),l.append("rect").attr("x",o).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(156, 156, 156, 0.7)"),l.append("rect").attr("x",0).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(0, 121, 42, 0.7)");let p,v;p=[100,0],v=Fa().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(0,${-o})`).call(fd(v)),p=Wn.poc.scaleLinear.domain(),v=Fa().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform","translate(0,0)").call(fd(v)),p=[-100,0],v=Fa().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},${-o})`).call(lf(v)),p=Wn.population.scaleLinear.domain(),v=Fa().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},0)`).call(lf(v)),l.append("text").attr("x",-20).attr("y",-18).attr("text-anchor","end").text("% Dem. Lead"),l.append("text").attr("x",o*2+20).attr("y",-18).attr("text-anchor","start").text("% Rep. Lead"),l.append("text").attr("x",o*2+20).attr("y",0+12).attr("text-anchor","start").text("Pop. / Km2"),l.append("text").attr("x",-20).attr("y",0+12).attr("text-anchor","end").text("% PoC")})},[]),Ue.useEffect(()=>{let[r,i]=n.current;r.text(`${_r(".2s")(Math.pow(j8(t),2))} km²`),i.text(`← ${_r(".2s")(j8(t))} km →;`)},[t]),rt.createElement(rt.Fragment,null,rt.createElement("svg",{className:"legend-area",ref:e}))}function C4(){const[t,e]=Ue.useState(1027),[n,r]=Ue.useState(!1),[i,s]=Ue.useState(!1),[l,o]=Ue.useState(!1);return Ue.useEffect(()=>{if(n){let p=setTimeout(()=>e(v=>v%1199+1),33.333333333333336);return function(){clearTimeout(p)}}},[t,n]),{speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r,useVsup:i,setUseVsup:s,showAllRings:l,setShowAllRings:o}}const Bu=0;function rN({speedyCounter:t}){const e=Ue.useRef(),n=Ue.useRef(),r=Ue.useRef({});Ue.useEffect(()=>{e.current=document.querySelector("#main-tooltip"),n.current=document.querySelector("#secondary-tooltip")},[]);const i=Ue.useCallback(p=>{const v=p.properties.Demand[Ro[Bu]][t],S=-p.properties.UnmetDemand[Ro[Bu]][t],M=-S-p.properties.UnmetDemandBaseline[t];e.current.classList.add("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><b>Region ID</b> ${p.properties.id}</div>
        <div><b>Scenario Demand</b> ${v}</div>
        <div><b>Scen. Unmet Demand</b> ${S}</div>
        <div><b>Difference in Unmet Demand</b> ${M}</div>
        <div><b>Land Holder</b> ${yb(p)}</div>
      `},[t]),s=Ue.useCallback(p=>{if(n.current.classList.remove("active"),e.current.classList.add("active"),e.current.innerHTML=`        <div><i>${k8(_g(t))}</i></div>
      `,p.properties.Demand){const v=p.properties.Demand[Ro[Bu]][t],S=-p.properties.UnmetDemand[Ro[Bu]][t],M=-S-p.properties.UnmetDemandBaseline[t];e.current.innerHTML+=`        
          <div><i>${I8[Bu]}</i></div>
          <div><b>Region ID</b> ${p.properties.id}</div>
          <div><b>Scenario Demand</b> ${v}</div>
          <div><b>Scen. Unmet Demand</b> ${S}</div>
          <div><b>Difference in Unmet Demand</b> ${M}</div>
          <div><b>Land Holder</b> ${yb(p)}</div>
        `}else{const v=p.properties.Groundwater[t];e.current.innerHTML+=`     
          <div><b>Elem ID</b> ${p.properties.id}</div>
          <div><b>Groundwater</b> ${v}</div>
      `}},[t]),l=Ue.useCallback(p=>{const v=p.properties.Demand[Ro[Bu]][t],S=-p.properties.UnmetDemand[Ro[Bu]][t],M=-S-p.properties.UnmetDemandBaseline[t],k=p.properties.Groundwater[t],F=p.properties.GroundwaterVar[t],H=p.properties.UnmetDemandVar[Ro[Bu]][t],j=k7(p.properties.UnmetDemandBaselineVar[t],H),ie=p.properties.DURgs.join(", "),Y=p.properties.GWRgs.join(", ");n.current.classList.remove("active"),e.current.classList.add("active"),e.current.innerHTML=`        <div><i>${k8(_g(t))}</i></div>
        <div><i>${I8[Bu]}</i></div>
        <div><b>Groundwater</b> ${k}</div>
        <div><b>Scenario Demand</b> ${v}</div>
        <div><b>Scen. Unmet Demand</b> ${S}</div>
        <div><b>Difference in Unmet Demand</b> ${M}</div>
        <div><b>Land Holder</b> ${yb(p)}</div>
        <div><b>Variance (GW)</b> ${F}</div>
        <div><b>Var. (Scen. UnmetDem)</b> ${H}</div>
        <div><b>Var. (Difference)</b> ${j}</div>
        <div><b>Demand Regions</b> ${ie}</div>
        <div><b>GW Regions</b> ${Y}</div>
      `},[t]);return Ue.useCallback(({object:p})=>{if(!p){r.current&&(n.current.classList.remove("active"),kd(r.current)&&e.current.classList.remove("active"),r.current=p);return}kd(p)?l(p):kv(p)?i(p):s(p),r.current=p},[t])}let M4=class extends Sr{renderLayers(){return[new Fm({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new Om(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};M4.layerName="BaseTerrainLayer";M4.defaultProps={...Sr.defaultProps};const H8=oa("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),W8=oa("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),Q8=oa("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),q8=oa("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t));function P4({counter:t,displayMonth:e,dataset:n}){const r=(t+9)%12+1,i=Ue.useRef();Ue.useEffect(()=>{i.current=Object.groupBy(xb[n],(v,S)=>_g(S).toLocaleString("default",{year:"numeric"}))},[n]);const s=ur().domain([0,S$(xb[n],v=>v)]).range([40,90]),l=ur().domain([1,12]).range([0,2*Math.PI]),o=hP().radius(v=>s(v)).curve(dP).angle((v,S)=>l((S+9)%12+1)),p=hP().radius(v=>s(v)).curve(dP).angle((v,S)=>l(S%12+1));Ue.useEffect(()=>(Gr("#clockContainer").style("visibility","visible"),Gr("#pieOutline path").attr("d",$_().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*2)).attr("fill","none").attr("stroke",n=="averageGroundwater"?`rgb(${H8})`:`rgba(${Q8}, 1)`),Gr("#demandLine path").data([xb[n]]).join("path").attr("d",v=>o(v)).attr("stroke",n=="averageGroundwater"?`rgba(${W8}, 0.3)`:`rgba(${q8}, 0.3)`).attr("stroke-width","0.2").attr("fill","none"),function(){Gr("#clockContainer").style("visibility","hidden"),Gr("#pie path").attr("d",""),Gr("#pieOutline path").attr("d",""),Gr("#demandLine path").attr("d",""),Gr("#demandLineCur path").attr("d",""),Gr("#date").text("")}),[n]),Ue.useEffect(()=>{Gr("#pie path").attr("d",$_().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*r/12*2)).attr("fill",n=="averageGroundwater"?`rgb(${H8})`:`rgba(${Q8}, 1)`);let v=_g(t);e?Gr("#date").html("<b>"+v.toLocaleString("default",{year:"numeric"})+"</b><br/>"+v.toLocaleString("default",{month:"long"})):Gr("#date").html("<b>"+v.toLocaleString("default",{year:"numeric"})+"</b>"),Ui("#demandLineCur path").data([i.current[_g(t).toLocaleString("default",{year:"numeric"})]]).join("path").attr("d",S=>p(S)).attr("stroke",n=="averageGroundwater"?`rgba(${W8}, 1)`:`rgba(${q8}, 1)`).attr("stroke-width","2").attr("fill","none")},[n,t])}function Uye({res:t,useVsup:e,setUseVsup:n,showAllRings:r,setShowAllRings:i}){const s=Ue.useRef(),l=Ue.useRef();return Ue.useEffect(()=>{Ui(".lin-legend").style("visibility",e?"hidden":"visible"),Ui(".vsup-legend-v").style("visibility",e?"visible":"hidden"),Ui(".vsup-legend-u").attr("transform",`translate(0,${e?0:50})`),Ui(".box1").attr("transform",`translate(0,${e?0:150})`).attr("height",e?250:100).attr("width",e?250:300),Ui(".box2").attr("transform",`translate(0,${e?0:60})`).attr("height",e?170:110)},[e]),Ue.useEffect(()=>{Gr("#diff-u").html("").call(Ef(Lr.difference,"Diff. w/ BL (600 TAF/km2)",r))},[r]),Ue.useLayoutEffect(()=>{const o=Gr(s.current).attr("width",window.innerWidth).attr("height",window.innerHeight),p=200,v=window.innerWidth,S=o.append("g").attr("transform",`translate(0,${window.innerHeight-p})`);S.append("g").attr("transform",`translate(0,${p-250})`).append("rect").attr("class","box1").attr("height",250).attr("width",250).attr("fill","white"),S.append("g").attr("transform",`translate(0,${p-170})`).append("rect").attr("class","box2").attr("height",170).attr("width",920).attr("x",350).attr("fill","white"),S.append("g").attr("class","vsup-legend-v").append("g").call(Bv().vtitle("GW (ft)").utitle("Variance").scale(Lr.groundwater.vsup).size(150).x(40).y(p-150-40)),S.append("g").attr("class","lin-legend").append("g").call(nu.simpleLegend(null,250,20,".2s").title("GW (ft)").size(250).height(20).scale(Lr.groundwater.colorsStepped).x(20).y(p-70));let M=400,k=p-120;S.append("g").attr("transform",`translate(${M},${k})`).append("g").attr("class","vsup-legend-u").attr("id","diff-u").call(Ef(Lr.difference,"Diff. w/ BL (600 TAF/km2)",r)),S.append("g").attr("transform",`translate(${M},${k+20})`).append("g").attr("class","vsup-legend-v").call(Rv(Lr.difference)),M=750,k=p-120,S.append("g").attr("transform",`translate(${M},${k})`).append("g").attr("class","vsup-legend-u").call(Lv(Lr.unmetDemandPositive,"assets/drop.png","Scenario Unmet (600 TAF/km2)")),S.append("g").attr("transform",`translate(${M},${k+55})`).append("g").attr("class","vsup-legend-v").call(Dv(Lr.unmetDemandPositive,"assets/drop.png")),S.append("g").attr("transform",`translate(${v-60},${p-80})`).call(p4(0,0,50,"rgba(146, 146, 146, 0.5)")).call(function(F){l.current=[F.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${_r(".2s")(ic(t,yr.km2))} km²`),F.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${_r(".2s")(Bs(t,yr.km))} km →;`)]})},[]),Ue.useEffect(()=>{let[o,p]=l.current;o.text(`${_r(".2s")(ic(t,yr.km2))} km²`),p.text(`← ${_r(".2s")(Bs(t,yr.km))} km →;`)},[t]),rt.createElement(rt.Fragment,null,rt.createElement("svg",{className:"legend-area",ref:s}),rt.createElement("div",{className:"study-input"},rt.createElement("input",{type:"checkbox",checked:e,onChange:()=>n(o=>!o)}),rt.createElement("span",null,"Use VSUP"),rt.createElement("input",{type:"checkbox",checked:r,onChange:()=>i(o=>!o)}),rt.createElement("span",null,"Show All Rings")))}function Vye({speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r,res:i,useVsup:s,setUseVsup:l,showAllRings:o,setShowAllRings:p}){return rt.createElement(rt.Fragment,null,rt.createElement(P4,{counter:t,displayMonth:!1,dataset:"averageDemandBaseline"}),rt.createElement(Uye,{res:i,useVsup:s,setUseVsup:l,showAllRings:o,setShowAllRings:p}),rt.createElement("div",{className:"styled-input"},rt.createElement("button",{onClick:()=>{r(v=>!v)}},n?"Pause":"Play"),rt.createElement("input",{onChange:function(v){r(!1),e(parseInt(v.target.value))},onInput:function(v){e(parseInt(v.target.value))},value:t,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}),rt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:t,onChange:function(v){e(parseInt(v.target.value))}})))}const Up=Ro[0];let k4=class extends Sr{renderLayers(){const{data:e,speedyCounter:n,clickedHexes:r,selectionFinalized:i,visible:s,zoomRange:l,useVsup:o,showAllRings:p}=this.props;return[new Tl({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:v=>o?Lr.groundwater.interpVsup(v.properties.Groundwater[n],v.properties.GroundwaterVar[n]):Lr.groundwater.interpColor(v.properties.Groundwater[n]),opacity:1,visible:s,updateTriggers:{getFillColor:[n,o]},zoomRange:l,pickable:!1}),new Tl({id:"DiffRings",data:e,thicknessRange:[.4,.65],getFillColor:v=>Lr.difference.interpColor(v.properties.UnmetDemand[Up][n]-v.properties.UnmetDemandBaseline[n],!p),getValue:v=>o?Lr.difference.scaleLinearVar(k7(v.properties.UnmetDemandBaselineVar[n],v.properties.UnmetDemandVar[Up][n]))*.7+.3:1,visible:s,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new Vd({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,p],getValue:[n,o]},zoomRange:l,pickable:!1}),new Wd({id:"ScenarioUnmet",data:e,loaders:[Vv],mesh:"./assets/drop.obj",getColor:v=>[255,130,35,(o?Lr.unmetDemand.scaleLinearVar(v.properties.UnmetDemandVar[Up][n]):1)*200+55],getValue:v=>Lr.unmetDemand.scaleLinear(v.properties.UnmetDemand[Up][n]),visible:s,sizeScale:3e3,opacity:1,updateTriggers:{getTranslation:[n],getColor:[o]},zoomRange:l,pickable:!1}),new Gv({...this.props,id:"DeagLayer",data:e,deagData:sd,getFillColor:v=>Lr.unmetDemand.interpColor(v.properties.UnmetDemand[Up][n],!1,!1),updateTriggers:{getFillColor:[n]}})]}};k4.layerName="MultivariableHextileLayer";k4.defaultProps={...Sr.defaultProps,autoHighlight:!0};const Gye=Object.keys(zv).map(t=>parseInt(t)),Z8=[7,9];function $ye(){const[t,e]=Ue.useState(dm.zoom),n=C4(),r=Hd({dataDeag:sd,deagKey:"DURgs"}),i=rN(n);return rt.createElement(rt.Fragment,null,rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",antialias:!0,initialViewState:dm},rt.createElement(jm,{getTooltip:i,interleaved:!0,effects:[Eh],onViewStateChange:({viewState:s})=>{e(s.zoom)}},rt.createElement(ha,{id:"ground",data:z7,stroked:!1,getFillColor:[0,0,0,0],beforeId:"landcover"}),rt.createElement(k4,{id:"slide-waters",data:zv,zoomRange:Z8,visible:!0,...n,...r,beforeId:"place_hamlet"}))),rt.createElement(Vye,{res:ss().domain(Z8).range(Gye)(t),...n}))}const Y8=0;function jye(){const t=C4(),e=Hd({disabled:t.curOption>1,dataDeag:sd,deagKey:"DURgs"}),n=rN({...t,curOption:100}),r={data:zv,...t,...e},[i,s]=Ue.useState(dm),l=Ue.useCallback(({viewId:o,viewState:p})=>{s({one:p,two:p,three:p})},[]);return rt.createElement(rt.Fragment,null,rt.createElement(t4,{controller:!0,effects:[Eh],viewState:i,onViewStateChange:l,getTooltip:n,layerFilter:({layer:o,viewport:p})=>o.id=="slide-terrain"||o.id=="GroundwaterGeo"&&p.id=="one"||o.id=="UDemGeo"&&p.id=="two"||o.id=="DemDiffGeo"&&p.id=="three",views:[new Yu({id:"one",x:"0%",y:"0%",height:"50%",width:"50%",controller:!0}),new Yu({id:"two",x:"50%",y:"0%",height:"50%",width:"50%",controller:!0}),new Yu({id:"three",x:"25%",y:"50%",height:"50%",width:"50%",controller:!0})]},rt.createElement(El,{id:"one"},rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:tf})),rt.createElement(El,{id:"two"},rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:tf})),rt.createElement(El,{id:"three"},rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:tf})),rt.createElement(M4,{id:"slide-terrain",...r}),rt.createElement(ha,{id:"GroundwaterGeo",data:B7,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...Lr.groundwater.interpColor(o.properties.Groundwater[t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0}),rt.createElement(ha,{id:"UDemGeo",data:sd,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...Lr.unmetDemand.interpColor(o.properties.UnmetDemand[Ro[Y8]][t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0}),rt.createElement(ha,{id:"DemDiffGeo",data:sd,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...Lr.difference.interpColor(o.properties.UnmetDemand[Ro[Y8]][t.speedyCounter]-o.properties.UnmetDemandBaseline[t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0})),rt.createElement(Hye,{...r}))}function Hye({speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r}){return rt.createElement(rt.Fragment,null,rt.createElement(P4,{counter:t,displayMonth:!1,dataset:"averageDemandBaseline"}),rt.createElement(Wye,null),rt.createElement("div",{className:"styled-input",style:{bottom:"20px"}},rt.createElement("button",{onClick:()=>{r(i=>!i)}},n?"Pause":"Play"),rt.createElement("input",{onChange:function(i){r(!1),e(parseInt(i.target.value))},onInput:function(i){e(parseInt(i.target.value))},value:t,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}),rt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:t,onChange:function(i){e(parseInt(i.target.value))}})))}function Wye({}){const t=Ue.useRef();return Ue.useLayoutEffect(()=>{Gr(t.current).attr("width",400).attr("height",500).call(function(r){r.append("g").call(nu.simpleLegend(null,250,20,".2s").title("GW (ft)").size(250).height(20).scale(Lr.groundwater.colorsStepped).x(400-280).y(500-240))}).call(function(r){r.append("g").call(nu.simpleLegend(null,250,20,".2s").title("Scenario Unmet (600 TAF/km2)").size(250).height(20).scale(Lr.unmetDemandPositive.colorsStepped).x(400-280).y(500-170))}).call(function(r){r.append("g").call(nu.simpleLegend(null,250,20,".2s").title("Diff. w/ BL (600 TAF / km2)").size(250).height(20).scale(Lr.difference.colorsStepped).x(400-280).y(500-100))})},[]),rt.createElement("svg",{className:"legend-area",ref:t})}function Qye(){const{current:t}=Ue.useRef(Object.keys(L8).map(l=>parseInt(l))),e=C4(),n=Hd({disabled:e.curOption>1,dataDeag:sd,deagKey:"DURgs"}),[r,i]=Ue.useState(dm.zoom),s={data:L8,...e,...n};return rt.createElement(rt.Fragment,null,rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",antialias:!0,initialViewState:dm},rt.createElement(jm,{interleaved:!0,effects:[Eh],onViewStateChange:({viewState:l})=>{i(l.zoom)}},rt.createElement(I4,{id:"slide-waters",...s,zoomRange:[7,9],visible:!0,beforeId:"place_hamlet"}))),rt.createElement(qye,{...s,res:ss().domain([0,1]).range(t)(ur().domain([7,9]).range([0,1]).clamp(!0)(r))}))}const Vp=0;let I4=class extends Sr{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:l,zoomRange:o}=this.props;return[new xs({id:"SquareBorders",data:e,getFillColor:[0,0,0,0],getLineColor:[80,80,80,100],stroked:!0,lineWidthUnits:"pixels",getValue:p=>2,visible:l,extruded:!1,opacity:1,zoomRange:o,offset:[0,0]}),new xs({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:p=>Lr.groundwater.interpColor(450),getValue:p=>Lr.groundwater.scaleLinear(p.properties.Groundwater[r]),opacity:1,visible:l,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[1,1]}),new xs({id:"DifferencePos",data:e,thicknessRange:[0,1],getFillColor:Lr.difference.interpColor(25,!1),getValue:p=>Lr.difference.scaleLinear(p.properties.UnmetDemand[Ro[Vp]][r]-p.properties.UnmetDemandBaseline[r])>.5?(Lr.difference.scaleLinear(p.properties.UnmetDemand[Ro[Vp]][r]-p.properties.UnmetDemandBaseline[r])-.5)/.5:0,opacity:1,visible:l,updateTriggers:{getValue:[r]},zoomRange:o,offset:[1,-1]}),new xs({id:"DifferenceNeg",data:e,thicknessRange:[0,1],getFillColor:Lr.difference.interpColor(-25,!1),getValue:p=>Lr.difference.scaleLinear(p.properties.UnmetDemand[Ro[Vp]][r]-p.properties.UnmetDemandBaseline[r])<.5?1-Lr.difference.scaleLinear(p.properties.UnmetDemand[Ro[Vp]][r]-p.properties.UnmetDemandBaseline[r])/.5:0,opacity:1,visible:l,updateTriggers:{getValue:[r]},zoomRange:o,offset:[-1,-1]}),new xs({id:"UnmetDemand",data:e,thicknessRange:[0,1],getFillColor:[157,157,157],getValue:p=>Lr.unmetDemand.scaleLinear(p.properties.UnmetDemand[Ro[Vp]][r]),opacity:1,visible:l,updateTriggers:{getValue:[r]},zoomRange:o,offset:[-1,1]})]}};I4.layerName="MultivariableHextileLayer";I4.defaultProps={...Sr.defaultProps,autoHighlight:!0};function qye({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s,res:l}){return rt.createElement(rt.Fragment,null,rt.createElement(P4,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),rt.createElement(Zye,{res:l}),rt.createElement("div",{className:"styled-input",style:{right:"40%",bottom:"50px"}},rt.createElement("button",{onClick:()=>{s(o=>!o)}},i?"Pause":"Play"),rt.createElement("input",{onChange:function(o){s(!1),r(parseInt(o.target.value))},onInput:function(o){r(parseInt(o.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}),rt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(o){r(parseInt(o.target.value))}})))}function X8(t){return Bs(parseInt(t),yr.km)*2}function Zye({res:t}){const e=Ue.useRef(),n=Ue.useRef();return Ue.useLayoutEffect(()=>{const r=window.innerHeight,i=window.innerWidth,s=Gr(e.current).attr("width",i).attr("height",r);s.append("g").attr("transform",`translate(${i-60},${r-170})`).call(l=>{l.append("rect").attr("x",-50).attr("y",-50).attr("width",100).attr("height",100).attr("fill","rgba(146, 146, 146, 0.5)")}).call(function(l){n.current=[l.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${_r(".2s")(ic(t,yr.km2))} km²`),l.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${_r(".2s")(Bs(t,yr.km))} km →;`)]}),s.append("g").attr("transform",`translate(200,${r-140})`).call(l=>{l.append("rect").attr("x",-200).attr("y",-140).attr("width",559).attr("height",240).attr("fill","rgba(255, 255, 255, 1)");const o=75;l.append("text").attr("x",o).attr("y",-o-15).style("font-weight","bold").attr("text-anchor","middle").text("Measure Type"),l.append("rect").attr("x",0).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(157, 157, 157, 0.7)"),l.append("rect").attr("x",o).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(57, 79, 132, 0.7)"),l.append("rect").attr("x",o).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(0, 104, 55, 0.7)"),l.append("rect").attr("x",0).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(165, 0, 38, 0.7)");let p=[],v;[p[1],p[0]]=Lr.unmetDemandPositive.scaleLinear.domain(),v=Fa().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(0,${-o})`).call(fd(v)),p=[0,30],v=Fa().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform","translate(0,0)").call(fd(v)),[p[1],p[0]]=Lr.groundwater.scaleLinear.domain(),v=Fa().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},${-o})`).call(lf(v)),p=[0,30],v=Fa().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},0)`).call(lf(v)),l.append("text").attr("x",-20).attr("y",-18).style("font-size",12).attr("text-anchor","end").text("Scenario Unmet (600 TAF/km2)"),l.append("text").attr("x",o*2+20).attr("y",-18).attr("text-anchor","start").style("font-size",12).text("GW (ft)"),l.append("text").attr("x",o*2+20).attr("y",0+12).attr("text-anchor","start").style("font-size",12).text("+ Diff. w/ BL (600 TAF/km2)"),l.append("text").attr("x",-20).attr("y",0+12).attr("text-anchor","end").style("font-size",12).text("- Diff. w/ BL (600 TAF/km2)")})},[]),Ue.useEffect(()=>{let[r,i]=n.current;r.text(`${_r(".2s")(Math.pow(X8(t),2))} km²`),i.text(`← ${_r(".2s")(X8(t))} km →;`)},[t]),rt.createElement("svg",{className:"legend-area",ref:e})}class L4 extends Sr{renderLayers(){return[new Fm({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:2,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new Om(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}}L4.layerName="BaseTerrainLayer";L4.defaultProps={...Sr.defaultProps};class D4 extends Sr{renderLayers(){const{data:e,visible:n,zoomRange:r,highlighted:i}=this.props;return[new xs({id:"SquareBorders",data:e,getFillColor:[0,0,0,0],getLineColor:[80,80,80,100],stroked:!0,lineWidthUnits:"pixels",getValue:s=>2,visible:n,extruded:!1,opacity:1,zoomRange:r,offset:[0,0]}),new xs({id:"SquarePoC",data:e,getFillColor:[0,121,42],getValue:s=>Wn.poc.scaleLinear(s.properties.PoC),visible:n,extruded:!1,opacity:1,zoomRange:r,offset:[-1,-1]}),new xs({id:"SquareDem",data:e,getFillColor:[72,30,197],getValue:s=>Wn.party.scaleLinear(s.properties.DemLead>0?s.properties.DemLead*2-100:-100),visible:n,extruded:!1,opacity:1,zoomRange:r,offset:[-1,1]}),new xs({id:"SquareRepub",data:e,getFillColor:[165,0,38],getValue:s=>Wn.party.scaleLinear(s.properties.DemLead<0?-s.properties.DemLead*2-100:-100),visible:n,extruded:!1,opacity:1,zoomRange:r,offset:[1,1]}),new xs({id:"SquarePop",data:e,getFillColor:[156,156,156],getValue:s=>Wn.population.scaleLinear(s.properties.PopSqKm),visible:n,extruded:!1,opacity:1,zoomRange:r,offset:[1,-1]}),new xs({id:"SquareHoveringTiles",data:e,getFillColor:[0,0,0,0],pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,getValue:s=>2,stroked:!0,getLineWidth:s=>s.hexId==i?2e3:1,visible:n,zoomRange:r,opacity:1,offset:[0,0]})]}}D4.layerName="MultivariableSquareTileLayer";D4.defaultProps={...Sr.defaultProps,autoHighlight:!0,pickable:!0};class R4 extends Sr{renderLayers(){const{data:e,speedyCounter:n=1026,clickedHexes:r,selectionFinalized:i,visible:s,zoomRange:l,useVsup:o,highlighted:p=null}=this.props;return[new Tl({id:"HexParty",data:e,thicknessRange:[0,1],getFillColor:v=>o?Wn.party.interpVsup(v.properties.DemLead||0,v.properties.DemLeadVar||0):Wn.party.interpColor(v.properties.DemLead||0),opacity:1,visible:s,updateTriggers:{getFillColor:[n,o]},zoomRange:l}),new Tl({id:"HexWhite",data:e,thicknessRange:[.4,.65],getFillColor:v=>Wn.poc.interpColor(v.properties.PoC,!1),getValue:v=>o?Wn.poc.scaleLinearVar(v.properties.PoCVar)*.7+.3:1,visible:s,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new Vd({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n],getValue:[n,o],getElevation:[i],getLineWidth:[i]},zoomRange:l}),new Wd({id:"HexPopulation",data:e,loaders:[Vv],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",getColor:v=>[255,255,7,(o?Wn.population.scaleLinearVar(v.properties.PopSqKmVar):1)*200+55],getValue:v=>Wn.population.scaleLinear(v.properties.PopSqKm),visible:s,sizeScale:400,opacity:1,updateTriggers:{getTranslation:[n],getColor:[o]},zoomRange:l}),new Tl({id:"HexHoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,stroked:!0,getLineWidth:v=>v.hexId==p?5:0,lineWidthUnits:"pixels",visible:s,zoomRange:l,updateTriggers:{getLineWidth:[p]}})]}}R4.layerName="MultivariableHextileLayer";R4.defaultProps={...Sr.defaultProps,autoHighlight:!0,pickable:!0};const xg=Object.keys(hc[4]).map(t=>Yye(t)),wg=Object.keys(Gm[4]).map(t=>Xye(t));function Yye(t){const{CountyRgs:e,PrecinctRgs:n,...r}=hc[4][t];return{id:t,...r}}function Xye(t){const{CountyRgs:e,PrecinctRgs:n,...r}=Gm[4][t];return{id:t,...r}}function bg(t,e){let n=[];do{let r=Kye(t);n=n.indexOf(r)>-1?n:n.concat(r)}while(n.length<e);return n}function K8(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}function Kye(t){return Math.floor(Math.random()*t)}function Jye(){return bg(xg.length,15).map(e=>xg[e])}function e_e(){return bg(wg.length,15).map(e=>wg[e])}function t_e(){const t=[],e=Jye(),n=e_e();for(let r=0;r<5;r++){const i=K8(["population density","person of color","dem. lead"]);for(let s of i){const l=K8(["hex","square"]);for(let o of l)t.push({type:"text",q:`What is your best estimate for ${s} in this tile?`,a:(o=="hex"?e[r]:n[r]).id,map:o})}}return t}const n_e=(t,e)=>t.sort((n,r)=>n[e]-r[e]),r_e=(t,e,n)=>{const r=n_e(t,n),i=(r.length-1)*e,s=Math.floor(i),l=i-s;return r[s+1]!==void 0?r[s][n]+l*(r[s+1][n]-r[s][n]):r[s][n]};function Lo(t,e,n){return r_e(Array.from(t),e/100,n)}const f0={PopSqKm:"population density",DemLead:"dem. lead",PoC:"person of color"};function i_e(){let t=[],e=[[0,25],[25,100],[100,150],[150,1e8]],n="PopSqKm",r="DemLead",i=[];for(let[s,l]of e)for(let o of["hex","square"]){let p=o=="hex"?xg:wg;p=p.filter(j=>j[n]<=l&&j[n]>=s),console.log(p);const v=Lo(p,0,r),S=Lo(p,25,r),M=Lo(p,50,r),k=Lo(p,75,r),F=Lo(p,100,r),H=[[Math.round(v),Math.round(S)],[Math.round(S),Math.round(M)],[Math.round(M),Math.round(k)],[Math.round(k),Math.round(F)]];for(let[j,ie]of H)i.push({type:"click",q:`Which tile has ${f0[n]} in range [${s},${l}] and ${f0[r]} in [${j},${ie}]?`,a:p.filter(Y=>Y[r]<=ie&&Y[r]>=j).map(Y=>Y.id),map:o})}t=[...t,...bg(32,10).map(s=>i[s])],i=[],n="PopSqKm",r="PoC";for(let[s,l]of e)for(let o of["hex","square"]){let p=o=="hex"?xg:wg;p=p.filter(j=>j[n]<=l&&j[n]>=s);const v=Lo(p,0,r),S=Lo(p,25,r),M=Lo(p,50,r),k=Lo(p,75,r),F=Lo(p,100,r),H=[[Math.round(v),Math.round(S)],[Math.round(S),Math.round(M)],[Math.round(M),Math.round(k)],[Math.round(k),Math.round(F)]];for(let[j,ie]of H)i.push({type:"click",q:`Which tile has ${f0[n]} in range [${s},${l}] and ${f0[r]} in [${j},${ie}]?`,a:p.filter(Y=>Y[r]<=ie&&Y[r]>=j).map(Y=>Y.id),map:o})}t=[...t,...bg(32,10).map(s=>i[s])],e=[[-100,-50],[-50,0],[0,20],[20,100]],i=[],n="DemLead",r="PoC";for(let[s,l]of e)for(let o of["hex","square"]){let p=o=="hex"?xg:wg;p=p.filter(j=>j[n]<=l&&j[n]>=s);const v=Lo(p,0,r),S=Lo(p,25,r),M=Lo(p,50,r),k=Lo(p,75,r),F=Lo(p,100,r),H=[[Math.round(v),Math.round(S)],[Math.round(S),Math.round(M)],[Math.round(M),Math.round(k)],[Math.round(k),Math.round(F)]];for(let[j,ie]of H)i.push({type:"click",q:`Which tile has ${f0[n]} in range [${s},${l}] and ${f0[r]} in [${j},${ie}]?`,a:p.filter(Y=>Y[r]<=ie&&Y[r]>=j).map(Y=>Y.id),map:o})}return t=[...t,...bg(32,10).map(s=>i[s])],t}function s_e(){let t=[...t_e(),...i_e()];return console.log(t),console.log("gen functions"),t}const Eb={width:1286,height:703,latitude:28.758769832242674,longitude:-101.33351900443955,zoom:5.5,bearing:32.58,pitch:50.85,altitude:1.5,maxZoom:15,minZoom:3,maxPitch:60,minPitch:0,normalize:!0,position:[0,0,0]},J8=Object.keys(hc).map(t=>parseInt(t)),ir=s_e();function o_e(){const[t,e]=Ue.useState(5),n=Ue.useRef([]),[r,i]=Ue.useState(-1),[s,l]=Ue.useState(""),[o,p]=Ue.useState(),[v,S]=Ue.useState(!1),[M,k]=Ue.useState(!1),{curViewState:F,zoomInHex:H,zoomInSquare:j}=h_e(),ie={data:hc},Y=()=>{i(ce=>(ir[ce+1].map=="hex"?H(ir[ce+1].a,()=>{p(Date.now())}):j(ir[ce+1].a,()=>{p(Date.now())}),ce+1))},J=Ue.useCallback(()=>{if(M)l(""),k(!1),i(ce=>(ce+1<ir.length&&(ir[ce+1].type=="text"?ir[ce+1].map=="hex"?H(ir[ce+1].a,()=>{p(Date.now())}):j(ir[ce+1].a,()=>{p(Date.now())}):p(Date.now())),ce+1));else{const ce={...ir[r],user:s,time:Date.now()-o};console.log(ce),n.current.push(ce),l(""),r==29?k(!0):i(me=>(me+1<ir.length&&(ir[me+1].type=="text"?ir[me+1].map=="hex"?H(ir[me+1].a,()=>{p(Date.now())}):j(ir[me+1].a,()=>{p(Date.now())}):p(Date.now())),me+1))}}),se=Ue.useCallback(({object:ce})=>{const me={...ir[r],user:ce.hexId,time:Date.now()-o};console.log(me),n.current.push(me),i(Ee=>(Ee+1<ir.length&&(ir[Ee+1].type=="text"?ir[Ee+1].map=="hex"?H(ir[Ee+1].a,()=>{p(Date.now())}):j(ir[Ee+1].a,()=>{p(Date.now())}):p(Date.now())),Ee+1))},[o,r]);return Ue.useEffect(()=>{if(r==ir.length){console.log(n.current);let ce=new XMLHttpRequest;ce.open("POST",`https://userstudy-4f273-default-rtdb.firebaseio.com/${Rme()}.json`,!0),ce.setRequestHeader("Content-Type","application/json; charset=UTF-8"),ce.send(JSON.stringify(n.current))}},[r]),rt.createElement(rt.Fragment,null,rt.createElement(t4,{controller:!0,effects:[Eh],initialViewState:F,onViewStateChange:({viewState:ce})=>{e(ce.zoom)}},rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:tf}),rt.createElement(L4,{id:"slide-terrain",...ie}),rt.createElement(R4,{pickable:(ir[r]||{}).type==="click"&&!M,autoHighlight:(ir[r]||{}).type==="click"&&!M,id:"slide-hex",data:hc,zoomRange:[0,1],visible:(ir[r]||{}).map=="hex",onClick:se,useVsup:v,highlighted:ir[r]&&ir[r].type=="text"?ir[r].a:null}),rt.createElement(D4,{pickable:(ir[r]||{}).type==="click"&&!M,autoHighlight:(ir[r]||{}).type==="click"&&!M,id:"slide-elec-square",data:Gm,zoomRange:[0,1],visible:(ir[r]||{}).map=="square",onClick:se,highlighted:ir[r]&&ir[r].type=="text"?ir[r].a:null})),r<ir.length&&rt.createElement("div",{className:"study-area"},r==-1&&rt.createElement(rt.Fragment,null,rt.createElement("p",null,"Press button to start."),rt.createElement("button",{onClick:Y},"Next")),r>-1&&!M&&rt.createElement(rt.Fragment,null,rt.createElement("p",null,ir[r].q),ir[r].type=="text"&&rt.createElement(rt.Fragment,null,rt.createElement("input",{type:"text",value:s,onChange:ce=>l(ce.target.value)}),rt.createElement("button",{onClick:J},"Next"))),M&&rt.createElement(rt.Fragment,null,rt.createElement("p",null,"Starting next part."),rt.createElement("button",{onClick:J},"Next")),r>-1&&!M&&rt.createElement(rt.Fragment,null,rt.createElement("p",{style:{fontSize:"12px",marginTop:"0.3em"}},r+1," / 60"))),(ir[r]||{}).map=="hex"&&rt.createElement(a_e,{res:ss().domain([0,1]).range(J8)(ur().domain([5,8]).range([0,1]).clamp(!0)(t)),useVsup:v,setUseVsup:S}),(ir[r]||{}).map=="square"&&rt.createElement(l_e,{res:ss().domain([0,1]).range(J8)(ur().domain([5,8]).range([0,1]).clamp(!0)(t))}),r>=ir.length&&rt.createElement("button",{style:{position:"absolute",left:"20px",bottom:"20px"},onClick:()=>Dme(n.current,"user-data")},"Download results"))}function a_e({res:t,useVsup:e,setUseVsup:n}){const r=Ue.useRef(),i=Ue.useRef();return Ue.useEffect(()=>{Ui(".lin-legend").style("visibility",e?"hidden":"visible"),Ui(".vsup-legend-u").style("visibility",e?"visible":"hidden"),Ui(".vsup-legend-v").attr("transform",`translate(0,${e?0:50})`),Ui(".box1").attr("transform",`translate(0,${e?0:150})`).attr("height",e?250:100).attr("width",e?250:300),Ui(".box2").attr("transform",`translate(0,${e?0:60})`).attr("height",e?170:110)},[e]),Ue.useLayoutEffect(()=>{const s=Gr(r.current).attr("width",window.innerWidth).attr("height",window.innerHeight),l=200,o=window.innerWidth,p=s.append("g").attr("transform",`translate(0,${window.innerHeight-l-100})`);p.append("g").attr("transform",`translate(0,${l-250})`).append("rect").attr("class","box1").attr("height",250).attr("width",250).attr("fill","white"),p.append("g").attr("transform",`translate(0,${l-170})`).append("rect").attr("class","box2").attr("height",170).attr("width",920).attr("x",350).attr("fill","white"),p.append("g").attr("class","vsup-legend-u").append("g").call(Bv().vtitle("% Dem. Lead").utitle("Variance").scale(Wn.party.vsup).size(150).x(40).y(l-150-40)),p.append("g").attr("class","lin-legend").append("g").call(nu.simpleLegend(null,250,20,".2s").title("% Dem. Lead").size(250).height(20).scale(Wn.party.colorsStepped).x(20).y(l-70));let v=400,S=l-120;p.append("g").attr("transform",`translate(${v},${S})`).append("g").attr("class","vsup-legend-v").call(Ef(Wn.poc,"% PoC")),p.append("g").attr("transform",`translate(${v},${S+20})`).append("g").attr("class","vsup-legend-u").call(Rv(Wn.poc)),v=750,S=l-120,p.append("g").attr("transform",`translate(${v},${S})`).append("g").attr("class","vsup-legend-v").call(Lv(Wn.population,"assets/human.png","Pop. / Km2")),p.append("g").attr("transform",`translate(${v},${S+55})`).append("g").attr("class","vsup-legend-u").call(Dv(Wn.population,"assets/human.png")),p.append("g").attr("transform",`translate(${o-60},${l-80})`).call(p4(0,0,50,"rgba(146, 146, 146, 0.5)")).call(function(M){i.current=[M.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${_r(".2s")(ic(t,yr.km2))} km²`),M.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${_r(".2s")(Bs(t,yr.km))} km →;`)]})},[]),Ue.useEffect(()=>{let[s,l]=i.current;s.text(`${_r(".2s")(ic(t,yr.km2))} km²`),l.text(`← ${_r(".2s")(Bs(t,yr.km))} km →;`)},[t]),rt.createElement(rt.Fragment,null,rt.createElement("svg",{className:"legend-area",ref:r}),rt.createElement("div",{className:"study-input"},rt.createElement("input",{type:"checkbox",checked:e,onChange:()=>n(s=>!s)}),rt.createElement("span",null,"Use VSUP")))}function WE(t){return Bs(parseInt(t),yr.km)*2}function l_e({res:t}){const e=Ue.useRef(),n=Ue.useRef();return Ue.useLayoutEffect(()=>{const r=window.innerHeight,i=window.innerWidth,s=Gr(e.current).attr("width",i).attr("height",r);s.append("g").attr("transform",`translate(${i-60},${r-170})`).call(l=>{l.append("rect").attr("x",-50).attr("y",-50).attr("width",100).attr("height",100).attr("fill","rgba(146, 146, 146, 0.5)")}).call(function(l){n.current=[l.append("text").attr("x",0).attr("y",8).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${_r(".2s")(ic(t,yr.km2))} km²`),l.append("text").attr("x",0).attr("y",55).attr("text-anchor","middle").style("font-size","11px").text(`← ${_r(".2s")(Bs(t,yr.km))} km →;`)]}),s.append("g").attr("transform",`translate(120,${r-200})`).call(l=>{l.append("rect").attr("x",-120).attr("y",-140).attr("width",459).attr("height",240).attr("fill","rgba(255, 255, 255, 1)");const o=75;l.append("text").attr("x",o).attr("y",-o-15).style("font-weight","bold").attr("text-anchor","middle").text("Measure Type"),l.append("rect").attr("x",0).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(72, 30, 197, 0.7)"),l.append("rect").attr("x",o).attr("y",-o).attr("width",o).attr("height",o).attr("fill","rgba(165, 0, 38, 0.7)"),l.append("rect").attr("x",o).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(156, 156, 156, 0.7)"),l.append("rect").attr("x",0).attr("y",0).attr("width",o).attr("height",o).attr("fill","rgba(0, 121, 42, 0.7)");let p,v;p=[100,0],v=Fa().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(0,${-o})`).call(fd(v)),p=Wn.poc.scaleLinear.domain(),v=Fa().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform","translate(0,0)").call(fd(v)),p=[-100,0],v=Fa().range([0,o]).domain([p[0],-(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},${-o})`).call(lf(v)),p=Wn.population.scaleLinear.domain(),v=Fa().range([0,o]).domain([p[0],(p[1]-p[0])/2,p[1]]),l.append("g").attr("transform",`translate(${o*2},0)`).call(lf(v)),l.append("text").attr("x",-20).attr("y",-18).attr("text-anchor","end").text("% Dem. Lead"),l.append("text").attr("x",o*2+20).attr("y",-18).attr("text-anchor","start").text("% Rep. Lead"),l.append("text").attr("x",o*2+20).attr("y",0+12).attr("text-anchor","start").text("Pop. / Km2"),l.append("text").attr("x",-20).attr("y",0+12).attr("text-anchor","end").text("% PoC")})},[]),Ue.useEffect(()=>{let[r,i]=n.current;r.text(`${_r(".2s")(Math.pow(WE(t),2))} km²`),i.text(`← ${_r(".2s")(WE(t))} km →;`)},[t]),rt.createElement(rt.Fragment,null,rt.createElement("svg",{className:"legend-area",ref:e}))}function A_e(t){return t/111.1}function u_e(t){return A_e(WE(t))}function c_e(t){const[e,n,r]=t.split("/"),i=u_e(r);return[parseFloat(e)+i/2,parseFloat(n)+i/2]}function h_e(){const[t,e]=Ue.useState(Eb),[n,r]=Ue.useState(!1),i=Ue.useCallback((l,o)=>{const[p,v]=lS(l);r(!0),e({...Eb,zoom:7.45,latitude:p,longitude:v,transitionDuration:500,transitionInterpolator:new yh,onTransitionEnd:()=>{r(!1),o()}})},[]),s=Ue.useCallback((l,o)=>{const[p,v]=c_e(l);r(!0),e({...Eb,zoom:7.45,latitude:p,longitude:v,transitionDuration:500,transitionInterpolator:new yh,onTransitionEnd:()=>{r(!1),o()}})},[]);return{curViewState:t,transitioning:n,zoomInHex:i,zoomInSquare:s}}function f_e(){const[t,e]=Ue.useState(1);return{curOption:t,setCurOption:e}}function d_e({curOption:t}){const e=Ue.useRef(),n=Ue.useRef(),r=Ue.useRef({});Ue.useEffect(()=>{e.current=document.querySelector("#main-tooltip"),n.current=document.querySelector("#secondary-tooltip")},[]);const i=Ue.useCallback(p=>{e.current.classList.add("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>GEOID</b> ${p.properties.GEOID}</div>
      <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
      <div><b>Percent Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
    `},[]),s=Ue.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),p.properties.pct_dem_lead?e.current.innerHTML=`        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>Votes / Km2</b> ${p.properties.votes_per_sqkm}</div>
        <div><b>% Dem. Lead</b> ${p.properties.pct_dem_lead}</div>
      `:e.current.innerHTML=`        <div><b>County Subdiv.</b> ${p.properties["county_subdivision_dec_Geographic Area Name"]}</div>
        <div><b>GEOID</b> ${p.properties.GEOID}</div>
        <div><b>% PoC</b> ${100-p.properties["county_subdivision_dec_Percent White"]}</div>
        <div><b>Pop. / Km2</b> ${p.properties["Population per Sqkm"]}</div>
      `},[]),l=Ue.useCallback(p=>{n.current.classList.remove("active"),e.current.classList.add("active"),e.current.innerHTML=`    <div><b>% PoC</b> ${p.properties.PoC}</div>
    <div><b>% PoC Var</b> ${p.properties.PoCVar}</div>
      <div><b>Pop. Den</b> ${p.properties.PopSqKm}</div>
      <div><b>Pop. Den Var</b> ${p.properties.PopSqKmVar}</div>
      <div><b>% Dem. Lead</b> ${p.properties.DemLead}</div>
      <div><b>% Dem. Lead Var</b> ${p.properties.DemLeadVar}</div>
      <div><b>Num. of County Subdivs</b> ${p.properties.CountyRgs.length}</div>
      <div><b>Num. of Precincts</b> ${p.properties.PrecinctRgs.length}</div>
      `},[]);return Ue.useCallback(({object:p})=>{if(!p){r.current&&(n.current.classList.remove("active"),kd(r.current)&&e.current.classList.remove("active"),r.current=p);return}kd(p)?l(p):kv(p)?i(p):s(p),r.current=p},[])}class B4 extends Sr{renderLayers(){const{data:e,visible:n,zoomRange:r,useVsup:i,showAllRings:s}=this.props;return[new Tl({id:"Fire",data:e,thicknessRange:[0,1],getFillColor:l=>i?dl.fire.interpVsup(l.properties.Fire||0,l.properties.FireVar||0):dl.fire.interpColor(l.properties.Fire||0),opacity:1,visible:n,updateTriggers:{getFillColor:[i]},zoomRange:r,pickable:!1}),new Tl({id:"GR2",data:e,thicknessRange:[.4,.65],getFillColor:l=>dl.gr2.interpColor(l.properties.GR2,!s),getValue:l=>1,visible:n,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new Vd({offset:!0})],opacity:1,updateTriggers:{getFillColor:[s],getValue:[i]},zoomRange:r,pickable:!1}),new Wd({id:"Personnel",data:e,loaders:[Vv],mesh:"assets/human.obj",raised:!0,getColor:l=>[255,255,7,(i?dl.personnel.scaleLinearVar(l.properties.PersVar):1)*200+55],getValue:l=>dl.personnel.scaleLinear(l.properties.Pers),visible:n,sizeScale:400,opacity:1,updateTriggers:{getColor:[i]},zoomRange:r,pickable:!1})]}}B4.layerName="MultivariableHextileLayer";B4.defaultProps={...Sr.defaultProps,autoHighlight:!0};const p_e=Object.keys(g4).map(t=>parseInt(t)),eL=[10,12];function g_e(){const[t,e]=Ue.useState(5),[n,r]=Ue.useState(!1),[i,s]=Ue.useState(!1),l=f_e(),o=d_e(l),p={data:g4,...l};return rt.createElement(rt.Fragment,null,rt.createElement(xl,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:vl,mapStyle:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",antialias:!0,initialViewState:Fme},rt.createElement(jm,{getTooltip:o,interleaved:!0,effects:[Eh],onViewStateChange:({viewState:v})=>{e(v.zoom)},antialias:!0},rt.createElement(ha,{id:"ground",data:z7,stroked:!1,getFillColor:[0,0,0,0],beforeId:"landcover"}),rt.createElement(B4,{id:"slide-election",...p,zoomRange:eL,visible:!0,useVsup:n,showAllRings:i,beforeId:"place_hamlet"}))),rt.createElement(m_e,{res:ss().domain(eL).range(p_e)(t),useVsup:n,setUseVsup:r,showAllRings:i,setShowAllRings:s}))}function m_e({res:t,useVsup:e,setUseVsup:n,showAllRings:r,setShowAllRings:i}){const s=Ue.useRef();return Ue.useEffect(()=>{Ui(".lin-legend").style("visibility",e?"hidden":"visible"),Ui(".vsup-legend-v").style("visibility",e?"visible":"hidden"),Ui(".vsup-legend-u").attr("transform",`translate(0,${e?0:50})`),Ui(".box1").attr("transform",`translate(0,${e?0:150})`).attr("height",e?250:100).attr("width",e?250:300),Ui(".box2").attr("transform",`translate(0,${e?0:60})`).attr("height",e?170:110)},[e]),Ue.useEffect(()=>{Gr("#diff-u").html("").call(Ef(dl.gr2,"GR2",r,".2"))},[r]),Ue.useLayoutEffect(()=>{const l=Gr(s.current).attr("width",window.innerWidth).attr("height",window.innerHeight),o=200,p=l.append("g").attr("transform",`translate(0,${window.innerHeight-o})`);p.append("g").attr("transform",`translate(0,${o-250})`).append("rect").attr("class","box1").attr("height",250).attr("width",250).attr("fill","white"),p.append("g").attr("transform",`translate(0,${o-170})`).append("rect").attr("class","box2").attr("height",170).attr("width",920).attr("x",350).attr("fill","white"),p.append("g").attr("class","vsup-legend-v").append("g").call(Bv().vtitle("Power").utitle("Uncertainty").scale(dl.fire.vsup).size(150).x(40).y(o-150-40)),p.append("g").attr("class","lin-legend").append("g").call(nu.simpleLegend(null,250,20,".2s").title("Power").size(250).height(20).scale(dl.fire.colorsStepped).x(20).y(o-70));let v=400,S=o-120;p.append("g").attr("transform",`translate(${v},${S})`).append("g").attr("class","vsup-legend-u").attr("id","diff-u").call(Ef(dl.gr2,"GR2",r,".2")),p.append("g").attr("transform",`translate(${v},${S+20})`).append("g").attr("class","vsup-legend-v").call(Rv(dl.gr2)),v=750,S=o-120,p.append("g").attr("transform",`translate(${v},${S})`).append("g").attr("class","vsup-legend-u").call(Lv(dl.personnel,"assets/human.png","Personnel",".2")),p.append("g").attr("transform",`translate(${v},${S+55})`).append("g").attr("class","vsup-legend-v").call(Dv(dl.personnel,"assets/human.png"))},[]),rt.createElement(rt.Fragment,null,rt.createElement("svg",{className:"legend-area",ref:s}),rt.createElement("div",{className:"study-input"},rt.createElement("input",{type:"checkbox",checked:e,onChange:()=>n(l=>!l)}),rt.createElement("span",null,"Use VSUP"),rt.createElement("input",{type:"checkbox",checked:r,onChange:()=>i(l=>!l)}),rt.createElement("span",null,"Show All Rings")))}function y_e(t){fR(t).render(rt.createElement(u$,null,rt.createElement(r$,null,rt.createElement(NA,{path:"/",element:rt.createElement(__e,null)}),rt.createElement(NA,{path:"user",element:rt.createElement(o_e,null)}),rt.createElement(NA,{path:"water/hex",element:rt.createElement($ye,null)}),rt.createElement(NA,{path:"water/square",element:rt.createElement(Qye,null)}),rt.createElement(NA,{path:"water/mult",element:rt.createElement(jye,null)}),rt.createElement(NA,{path:"election/hex",element:rt.createElement(_ye,null)}),rt.createElement(NA,{path:"election/square",element:rt.createElement(Fye,null)}),rt.createElement(NA,{path:"election/mult",element:rt.createElement(Pye,null)}),rt.createElement(NA,{path:"fire",element:rt.createElement(g_e,null)}))))}function __e(){return rt.createElement(rt.Fragment,null,rt.createElement(Rh,{className:"toc-link",to:"water/mult"},"Water Small Multiples"),rt.createElement(Rh,{className:"toc-link",to:"water/square"},"Water Square Tiles"),rt.createElement(Rh,{className:"toc-link",to:"water/hex"},"Water HexTiles"),rt.createElement(Rh,{className:"toc-link",to:"election/mult"},"Election Small Multiples"),rt.createElement(Rh,{className:"toc-link",to:"election/square"},"Election Square Tiles"),rt.createElement(Rh,{className:"toc-link",to:"election/hex"},"Election HexTiles"),rt.createElement(Rh,{className:"toc-link",to:"fire"},"Wildfire"))}y_e(document.getElementById("app"));
