function ME(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const A of s.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&r(A)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var l9=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function b2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function A9(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var _8={exports:{}},hr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kg=Symbol.for("react.element"),u9=Symbol.for("react.portal"),c9=Symbol.for("react.fragment"),h9=Symbol.for("react.strict_mode"),f9=Symbol.for("react.profiler"),d9=Symbol.for("react.provider"),p9=Symbol.for("react.context"),g9=Symbol.for("react.forward_ref"),m9=Symbol.for("react.suspense"),y9=Symbol.for("react.memo"),_9=Symbol.for("react.lazy"),F5=Symbol.iterator;function v9(t){return t===null||typeof t!="object"?null:(t=F5&&t[F5]||t["@@iterator"],typeof t=="function"?t:null)}var v8={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x8=Object.assign,w8={};function _d(t,e,n){this.props=t,this.context=e,this.refs=w8,this.updater=n||v8}_d.prototype.isReactComponent={};_d.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};_d.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function b8(){}b8.prototype=_d.prototype;function CE(t,e,n){this.props=t,this.context=e,this.refs=w8,this.updater=n||v8}var PE=CE.prototype=new b8;PE.constructor=CE;x8(PE,_d.prototype);PE.isPureReactComponent=!0;var N5=Array.isArray,E8=Object.prototype.hasOwnProperty,IE={current:null},T8={key:!0,ref:!0,__self:!0,__source:!0};function S8(t,e,n){var r,i={},s=null,A=null;if(e!=null)for(r in e.ref!==void 0&&(A=e.ref),e.key!==void 0&&(s=""+e.key),e)E8.call(e,r)&&!T8.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var g=Array(o),w=0;w<o;w++)g[w]=arguments[w+2];i.children=g}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:Kg,type:t,key:s,ref:A,props:i,_owner:IE.current}}function x9(t,e){return{$$typeof:Kg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function kE(t){return typeof t=="object"&&t!==null&&t.$$typeof===Kg}function w9(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var U5=/\/+/g;function ux(t,e){return typeof t=="object"&&t!==null&&t.key!=null?w9(""+t.key):e.toString(36)}function K1(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var A=!1;if(t===null)A=!0;else switch(s){case"string":case"number":A=!0;break;case"object":switch(t.$$typeof){case Kg:case u9:A=!0}}if(A)return A=t,i=i(A),t=r===""?"."+ux(A,0):r,N5(i)?(n="",t!=null&&(n=t.replace(U5,"$&/")+"/"),K1(i,e,n,"",function(w){return w})):i!=null&&(kE(i)&&(i=x9(i,n+(!i.key||A&&A.key===i.key?"":(""+i.key).replace(U5,"$&/")+"/")+t)),e.push(i)),1;if(A=0,r=r===""?".":r+":",N5(t))for(var o=0;o<t.length;o++){s=t[o];var g=r+ux(s,o);A+=K1(s,e,n,g,i)}else if(g=v9(t),typeof g=="function")for(t=g.call(t),o=0;!(s=t.next()).done;)s=s.value,g=r+ux(s,o++),A+=K1(s,e,n,g,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return A}function Qm(t,e,n){if(t==null)return t;var r=[],i=0;return K1(t,r,"","",function(s){return e.call(n,s,i++)}),r}function b9(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Bo={current:null},J1={transition:null},E9={ReactCurrentDispatcher:Bo,ReactCurrentBatchConfig:J1,ReactCurrentOwner:IE};hr.Children={map:Qm,forEach:function(t,e,n){Qm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Qm(t,function(){e++}),e},toArray:function(t){return Qm(t,function(e){return e})||[]},only:function(t){if(!kE(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};hr.Component=_d;hr.Fragment=c9;hr.Profiler=f9;hr.PureComponent=CE;hr.StrictMode=h9;hr.Suspense=m9;hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E9;hr.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=x8({},t.props),i=t.key,s=t.ref,A=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,A=IE.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(g in e)E8.call(e,g)&&!T8.hasOwnProperty(g)&&(r[g]=e[g]===void 0&&o!==void 0?o[g]:e[g])}var g=arguments.length-2;if(g===1)r.children=n;else if(1<g){o=Array(g);for(var w=0;w<g;w++)o[w]=arguments[w+2];r.children=o}return{$$typeof:Kg,type:t.type,key:i,ref:s,props:r,_owner:A}};hr.createContext=function(t){return t={$$typeof:p9,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:d9,_context:t},t.Consumer=t};hr.createElement=S8;hr.createFactory=function(t){var e=S8.bind(null,t);return e.type=t,e};hr.createRef=function(){return{current:null}};hr.forwardRef=function(t){return{$$typeof:g9,render:t}};hr.isValidElement=kE;hr.lazy=function(t){return{$$typeof:_9,_payload:{_status:-1,_result:t},_init:b9}};hr.memo=function(t,e){return{$$typeof:y9,type:t,compare:e===void 0?null:e}};hr.startTransition=function(t){var e=J1.transition;J1.transition={};try{t()}finally{J1.transition=e}};hr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};hr.useCallback=function(t,e){return Bo.current.useCallback(t,e)};hr.useContext=function(t){return Bo.current.useContext(t)};hr.useDebugValue=function(){};hr.useDeferredValue=function(t){return Bo.current.useDeferredValue(t)};hr.useEffect=function(t,e){return Bo.current.useEffect(t,e)};hr.useId=function(){return Bo.current.useId()};hr.useImperativeHandle=function(t,e,n){return Bo.current.useImperativeHandle(t,e,n)};hr.useInsertionEffect=function(t,e){return Bo.current.useInsertionEffect(t,e)};hr.useLayoutEffect=function(t,e){return Bo.current.useLayoutEffect(t,e)};hr.useMemo=function(t,e){return Bo.current.useMemo(t,e)};hr.useReducer=function(t,e,n){return Bo.current.useReducer(t,e,n)};hr.useRef=function(t){return Bo.current.useRef(t)};hr.useState=function(t){return Bo.current.useState(t)};hr.useSyncExternalStore=function(t,e,n){return Bo.current.useSyncExternalStore(t,e,n)};hr.useTransition=function(){return Bo.current.useTransition()};hr.version="18.2.0";_8.exports=hr;var je=_8.exports;const yt=b2(je),T9=ME({__proto__:null,default:yt},[je]);var M8={exports:{}},Ra={},C8={exports:{}},P8={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_t,Et){var Jt=_t.length;_t.push(Et);e:for(;0<Jt;){var kn=Jt-1>>>1,Tn=_t[kn];if(0<i(Tn,Et))_t[kn]=Et,_t[Jt]=Tn,Jt=kn;else break e}}function n(_t){return _t.length===0?null:_t[0]}function r(_t){if(_t.length===0)return null;var Et=_t[0],Jt=_t.pop();if(Jt!==Et){_t[0]=Jt;e:for(var kn=0,Tn=_t.length,Tr=Tn>>>1;kn<Tr;){var Jn=2*(kn+1)-1,ir=_t[Jn],ur=Jn+1,Un=_t[ur];if(0>i(ir,Jt))ur<Tn&&0>i(Un,ir)?(_t[kn]=Un,_t[ur]=Jt,kn=ur):(_t[kn]=ir,_t[Jn]=Jt,kn=Jn);else if(ur<Tn&&0>i(Un,Jt))_t[kn]=Un,_t[ur]=Jt,kn=ur;else break e}}return Et}function i(_t,Et){var Jt=_t.sortIndex-Et.sortIndex;return Jt!==0?Jt:_t.id-Et.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var A=Date,o=A.now();t.unstable_now=function(){return A.now()-o}}var g=[],w=[],C=1,I=null,k=3,U=!1,H=!1,q=!1,se=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ie(_t){for(var Et=n(w);Et!==null;){if(Et.callback===null)r(w);else if(Et.startTime<=_t)r(w),Et.sortIndex=Et.expirationTime,e(g,Et);else break;Et=n(w)}}function fe(_t){if(q=!1,ie(_t),!H)if(n(g)!==null)H=!0,Tt(me);else{var Et=n(w);Et!==null&&dn(fe,Et.startTime-_t)}}function me(_t,Et){H=!1,q&&(q=!1,X(Qe),Qe=-1),U=!0;var Jt=k;try{for(ie(Et),I=n(g);I!==null&&(!(I.expirationTime>Et)||_t&&!Ne());){var kn=I.callback;if(typeof kn=="function"){I.callback=null,k=I.priorityLevel;var Tn=kn(I.expirationTime<=Et);Et=t.unstable_now(),typeof Tn=="function"?I.callback=Tn:I===n(g)&&r(g),ie(Et)}else r(g);I=n(g)}if(I!==null)var Tr=!0;else{var Jn=n(w);Jn!==null&&dn(fe,Jn.startTime-Et),Tr=!1}return Tr}finally{I=null,k=Jt,U=!1}}var Se=!1,He=null,Qe=-1,Ke=5,nt=-1;function Ne(){return!(t.unstable_now()-nt<Ke)}function rt(){if(He!==null){var _t=t.unstable_now();nt=_t;var Et=!0;try{Et=He(!0,_t)}finally{Et?Ze():(Se=!1,He=null)}}else Se=!1}var Ze;if(typeof te=="function")Ze=function(){te(rt)};else if(typeof MessageChannel<"u"){var mt=new MessageChannel,Kt=mt.port2;mt.port1.onmessage=rt,Ze=function(){Kt.postMessage(null)}}else Ze=function(){se(rt,0)};function Tt(_t){He=_t,Se||(Se=!0,Ze())}function dn(_t,Et){Qe=se(function(){_t(t.unstable_now())},Et)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_t){_t.callback=null},t.unstable_continueExecution=function(){H||U||(H=!0,Tt(me))},t.unstable_forceFrameRate=function(_t){0>_t||125<_t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ke=0<_t?Math.floor(1e3/_t):5},t.unstable_getCurrentPriorityLevel=function(){return k},t.unstable_getFirstCallbackNode=function(){return n(g)},t.unstable_next=function(_t){switch(k){case 1:case 2:case 3:var Et=3;break;default:Et=k}var Jt=k;k=Et;try{return _t()}finally{k=Jt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(_t,Et){switch(_t){case 1:case 2:case 3:case 4:case 5:break;default:_t=3}var Jt=k;k=_t;try{return Et()}finally{k=Jt}},t.unstable_scheduleCallback=function(_t,Et,Jt){var kn=t.unstable_now();switch(typeof Jt=="object"&&Jt!==null?(Jt=Jt.delay,Jt=typeof Jt=="number"&&0<Jt?kn+Jt:kn):Jt=kn,_t){case 1:var Tn=-1;break;case 2:Tn=250;break;case 5:Tn=1073741823;break;case 4:Tn=1e4;break;default:Tn=5e3}return Tn=Jt+Tn,_t={id:C++,callback:Et,priorityLevel:_t,startTime:Jt,expirationTime:Tn,sortIndex:-1},Jt>kn?(_t.sortIndex=Jt,e(w,_t),n(g)===null&&_t===n(w)&&(q?(X(Qe),Qe=-1):q=!0,dn(fe,Jt-kn))):(_t.sortIndex=Tn,e(g,_t),H||U||(H=!0,Tt(me))),_t},t.unstable_shouldYield=Ne,t.unstable_wrapCallback=function(_t){var Et=k;return function(){var Jt=k;k=Et;try{return _t.apply(this,arguments)}finally{k=Jt}}}})(P8);C8.exports=P8;var S9=C8.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I8=je,Da=S9;function Bt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var k8=new Set,sg={};function gf(t,e){Z0(t,e),Z0(t+"Capture",e)}function Z0(t,e){for(sg[t]=e,t=0;t<e.length;t++)k8.add(e[t])}var ju=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ib=Object.prototype.hasOwnProperty,M9=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,V5={},G5={};function C9(t){return ib.call(G5,t)?!0:ib.call(V5,t)?!1:M9.test(t)?G5[t]=!0:(V5[t]=!0,!1)}function P9(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function I9(t,e,n,r){if(e===null||typeof e>"u"||P9(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zo(t,e,n,r,i,s,A){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=A}var Ds={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ds[t]=new zo(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ds[e]=new zo(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ds[t]=new zo(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ds[t]=new zo(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ds[t]=new zo(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ds[t]=new zo(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ds[t]=new zo(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ds[t]=new zo(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ds[t]=new zo(t,5,!1,t.toLowerCase(),null,!1,!1)});var LE=/[\-:]([a-z])/g;function DE(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(LE,DE);Ds[e]=new zo(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(LE,DE);Ds[e]=new zo(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(LE,DE);Ds[e]=new zo(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ds[t]=new zo(t,1,!1,t.toLowerCase(),null,!1,!1)});Ds.xlinkHref=new zo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ds[t]=new zo(t,1,!1,t.toLowerCase(),null,!0,!0)});function RE(t,e,n,r){var i=Ds.hasOwnProperty(e)?Ds[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(I9(e,n,i,r)&&(n=null),r||i===null?C9(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var sc=I8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qm=Symbol.for("react.element"),i0=Symbol.for("react.portal"),s0=Symbol.for("react.fragment"),BE=Symbol.for("react.strict_mode"),sb=Symbol.for("react.profiler"),L8=Symbol.for("react.provider"),D8=Symbol.for("react.context"),zE=Symbol.for("react.forward_ref"),ob=Symbol.for("react.suspense"),ab=Symbol.for("react.suspense_list"),OE=Symbol.for("react.memo"),Rc=Symbol.for("react.lazy"),R8=Symbol.for("react.offscreen"),$5=Symbol.iterator;function Xd(t){return t===null||typeof t!="object"?null:(t=$5&&t[$5]||t["@@iterator"],typeof t=="function"?t:null)}var mi=Object.assign,cx;function Cp(t){if(cx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);cx=e&&e[1]||""}return`
`+cx+t}var hx=!1;function fx(t,e){if(!t||hx)return"";hx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(w){var r=w}Reflect.construct(t,[],e)}else{try{e.call()}catch(w){r=w}t.call(e.prototype)}else{try{throw Error()}catch(w){r=w}t()}}catch(w){if(w&&r&&typeof w.stack=="string"){for(var i=w.stack.split(`
`),s=r.stack.split(`
`),A=i.length-1,o=s.length-1;1<=A&&0<=o&&i[A]!==s[o];)o--;for(;1<=A&&0<=o;A--,o--)if(i[A]!==s[o]){if(A!==1||o!==1)do if(A--,o--,0>o||i[A]!==s[o]){var g=`
`+i[A].replace(" at new "," at ");return t.displayName&&g.includes("<anonymous>")&&(g=g.replace("<anonymous>",t.displayName)),g}while(1<=A&&0<=o);break}}}finally{hx=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Cp(t):""}function k9(t){switch(t.tag){case 5:return Cp(t.type);case 16:return Cp("Lazy");case 13:return Cp("Suspense");case 19:return Cp("SuspenseList");case 0:case 2:case 15:return t=fx(t.type,!1),t;case 11:return t=fx(t.type.render,!1),t;case 1:return t=fx(t.type,!0),t;default:return""}}function lb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case s0:return"Fragment";case i0:return"Portal";case sb:return"Profiler";case BE:return"StrictMode";case ob:return"Suspense";case ab:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case D8:return(t.displayName||"Context")+".Consumer";case L8:return(t._context.displayName||"Context")+".Provider";case zE:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case OE:return e=t.displayName||null,e!==null?e:lb(t.type)||"Memo";case Rc:e=t._payload,t=t._init;try{return lb(t(e))}catch{}}return null}function L9(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return lb(e);case 8:return e===BE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function oh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function B8(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function D9(t){var e=B8(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(A){r=""+A,s.call(this,A)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(A){r=""+A},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Zm(t){t._valueTracker||(t._valueTracker=D9(t))}function z8(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=B8(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function zy(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ab(t,e){var n=e.checked;return mi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function j5(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=oh(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function O8(t,e){e=e.checked,e!=null&&RE(t,"checked",e,!1)}function ub(t,e){O8(t,e);var n=oh(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?cb(t,e.type,n):e.hasOwnProperty("defaultValue")&&cb(t,e.type,oh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function H5(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function cb(t,e,n){(e!=="number"||zy(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Pp=Array.isArray;function L0(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+oh(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function hb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Bt(91));return mi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function W5(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Bt(92));if(Pp(n)){if(1<n.length)throw Error(Bt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:oh(n)}}function F8(t,e){var n=oh(e.value),r=oh(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Q5(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function N8(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?N8(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ym,U8=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ym=Ym||document.createElement("div"),Ym.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ym.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function og(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Gp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},R9=["Webkit","ms","Moz","O"];Object.keys(Gp).forEach(function(t){R9.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Gp[e]=Gp[t]})});function V8(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Gp.hasOwnProperty(t)&&Gp[t]?(""+e).trim():e+"px"}function G8(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=V8(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var B9=mi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function db(t,e){if(e){if(B9[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Bt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Bt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Bt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Bt(62))}}function pb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gb=null;function FE(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var mb=null,D0=null,R0=null;function q5(t){if(t=tm(t)){if(typeof mb!="function")throw Error(Bt(280));var e=t.stateNode;e&&(e=C2(e),mb(t.stateNode,t.type,e))}}function $8(t){D0?R0?R0.push(t):R0=[t]:D0=t}function j8(){if(D0){var t=D0,e=R0;if(R0=D0=null,q5(t),e)for(t=0;t<e.length;t++)q5(e[t])}}function H8(t,e){return t(e)}function W8(){}var dx=!1;function Q8(t,e,n){if(dx)return t(e,n);dx=!0;try{return H8(t,e,n)}finally{dx=!1,(D0!==null||R0!==null)&&(W8(),j8())}}function ag(t,e){var n=t.stateNode;if(n===null)return null;var r=C2(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Bt(231,e,typeof n));return n}var yb=!1;if(ju)try{var Kd={};Object.defineProperty(Kd,"passive",{get:function(){yb=!0}}),window.addEventListener("test",Kd,Kd),window.removeEventListener("test",Kd,Kd)}catch{yb=!1}function z9(t,e,n,r,i,s,A,o,g){var w=Array.prototype.slice.call(arguments,3);try{e.apply(n,w)}catch(C){this.onError(C)}}var $p=!1,Oy=null,Fy=!1,_b=null,O9={onError:function(t){$p=!0,Oy=t}};function F9(t,e,n,r,i,s,A,o,g){$p=!1,Oy=null,z9.apply(O9,arguments)}function N9(t,e,n,r,i,s,A,o,g){if(F9.apply(this,arguments),$p){if($p){var w=Oy;$p=!1,Oy=null}else throw Error(Bt(198));Fy||(Fy=!0,_b=w)}}function mf(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function q8(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Z5(t){if(mf(t)!==t)throw Error(Bt(188))}function U9(t){var e=t.alternate;if(!e){if(e=mf(t),e===null)throw Error(Bt(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Z5(i),t;if(s===r)return Z5(i),e;s=s.sibling}throw Error(Bt(188))}if(n.return!==r.return)n=i,r=s;else{for(var A=!1,o=i.child;o;){if(o===n){A=!0,n=i,r=s;break}if(o===r){A=!0,r=i,n=s;break}o=o.sibling}if(!A){for(o=s.child;o;){if(o===n){A=!0,n=s,r=i;break}if(o===r){A=!0,r=s,n=i;break}o=o.sibling}if(!A)throw Error(Bt(189))}}if(n.alternate!==r)throw Error(Bt(190))}if(n.tag!==3)throw Error(Bt(188));return n.stateNode.current===n?t:e}function Z8(t){return t=U9(t),t!==null?Y8(t):null}function Y8(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Y8(t);if(e!==null)return e;t=t.sibling}return null}var X8=Da.unstable_scheduleCallback,Y5=Da.unstable_cancelCallback,V9=Da.unstable_shouldYield,G9=Da.unstable_requestPaint,Ri=Da.unstable_now,$9=Da.unstable_getCurrentPriorityLevel,NE=Da.unstable_ImmediatePriority,K8=Da.unstable_UserBlockingPriority,Ny=Da.unstable_NormalPriority,j9=Da.unstable_LowPriority,J8=Da.unstable_IdlePriority,E2=null,RA=null;function H9(t){if(RA&&typeof RA.onCommitFiberRoot=="function")try{RA.onCommitFiberRoot(E2,t,void 0,(t.current.flags&128)===128)}catch{}}var Xl=Math.clz32?Math.clz32:q9,W9=Math.log,Q9=Math.LN2;function q9(t){return t>>>=0,t===0?32:31-(W9(t)/Q9|0)|0}var Xm=64,Km=4194304;function Ip(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Uy(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,A=n&268435455;if(A!==0){var o=A&~i;o!==0?r=Ip(o):(s&=A,s!==0&&(r=Ip(s)))}else A=n&~i,A!==0?r=Ip(A):s!==0&&(r=Ip(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Xl(e),i=1<<n,r|=t[n],e&=~i;return r}function Z9(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Y9(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var A=31-Xl(s),o=1<<A,g=i[A];g===-1?(!(o&n)||o&r)&&(i[A]=Z9(o,e)):g<=e&&(t.expiredLanes|=o),s&=~o}}function vb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function eL(){var t=Xm;return Xm<<=1,!(Xm&4194240)&&(Xm=64),t}function px(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Jg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Xl(e),t[e]=n}function X9(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Xl(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function UE(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Xl(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Lr=0;function tL(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var nL,VE,rL,iL,sL,xb=!1,Jm=[],Qc=null,qc=null,Zc=null,lg=new Map,Ag=new Map,Oc=[],K9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function X5(t,e){switch(t){case"focusin":case"focusout":Qc=null;break;case"dragenter":case"dragleave":qc=null;break;case"mouseover":case"mouseout":Zc=null;break;case"pointerover":case"pointerout":lg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ag.delete(e.pointerId)}}function Jd(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=tm(e),e!==null&&VE(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function J9(t,e,n,r,i){switch(e){case"focusin":return Qc=Jd(Qc,t,e,n,r,i),!0;case"dragenter":return qc=Jd(qc,t,e,n,r,i),!0;case"mouseover":return Zc=Jd(Zc,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return lg.set(s,Jd(lg.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ag.set(s,Jd(Ag.get(s)||null,t,e,n,r,i)),!0}return!1}function oL(t){var e=Fh(t.target);if(e!==null){var n=mf(e);if(n!==null){if(e=n.tag,e===13){if(e=q8(n),e!==null){t.blockedOn=e,sL(t.priority,function(){rL(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ey(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=wb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);gb=r,n.target.dispatchEvent(r),gb=null}else return e=tm(n),e!==null&&VE(e),t.blockedOn=n,!1;e.shift()}return!0}function K5(t,e,n){ey(t)&&n.delete(e)}function eU(){xb=!1,Qc!==null&&ey(Qc)&&(Qc=null),qc!==null&&ey(qc)&&(qc=null),Zc!==null&&ey(Zc)&&(Zc=null),lg.forEach(K5),Ag.forEach(K5)}function ep(t,e){t.blockedOn===e&&(t.blockedOn=null,xb||(xb=!0,Da.unstable_scheduleCallback(Da.unstable_NormalPriority,eU)))}function ug(t){function e(i){return ep(i,t)}if(0<Jm.length){ep(Jm[0],t);for(var n=1;n<Jm.length;n++){var r=Jm[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Qc!==null&&ep(Qc,t),qc!==null&&ep(qc,t),Zc!==null&&ep(Zc,t),lg.forEach(e),Ag.forEach(e),n=0;n<Oc.length;n++)r=Oc[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Oc.length&&(n=Oc[0],n.blockedOn===null);)oL(n),n.blockedOn===null&&Oc.shift()}var B0=sc.ReactCurrentBatchConfig,Vy=!0;function tU(t,e,n,r){var i=Lr,s=B0.transition;B0.transition=null;try{Lr=1,GE(t,e,n,r)}finally{Lr=i,B0.transition=s}}function nU(t,e,n,r){var i=Lr,s=B0.transition;B0.transition=null;try{Lr=4,GE(t,e,n,r)}finally{Lr=i,B0.transition=s}}function GE(t,e,n,r){if(Vy){var i=wb(t,e,n,r);if(i===null)Tx(t,e,r,Gy,n),X5(t,r);else if(J9(i,t,e,n,r))r.stopPropagation();else if(X5(t,r),e&4&&-1<K9.indexOf(t)){for(;i!==null;){var s=tm(i);if(s!==null&&nL(s),s=wb(t,e,n,r),s===null&&Tx(t,e,r,Gy,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Tx(t,e,r,null,n)}}var Gy=null;function wb(t,e,n,r){if(Gy=null,t=FE(r),t=Fh(t),t!==null)if(e=mf(t),e===null)t=null;else if(n=e.tag,n===13){if(t=q8(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Gy=t,null}function aL(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($9()){case NE:return 1;case K8:return 4;case Ny:case j9:return 16;case J8:return 536870912;default:return 16}default:return 16}}var Uc=null,$E=null,ty=null;function lL(){if(ty)return ty;var t,e=$E,n=e.length,r,i="value"in Uc?Uc.value:Uc.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var A=n-t;for(r=1;r<=A&&e[n-r]===i[s-r];r++);return ty=i.slice(t,1<r?1-r:void 0)}function ny(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function e1(){return!0}function J5(){return!1}function Ba(t){function e(n,r,i,s,A){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=A,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?e1:J5,this.isPropagationStopped=J5,this}return mi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=e1)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=e1)},persist:function(){},isPersistent:e1}),e}var vd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jE=Ba(vd),em=mi({},vd,{view:0,detail:0}),rU=Ba(em),gx,mx,tp,T2=mi({},em,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:HE,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==tp&&(tp&&t.type==="mousemove"?(gx=t.screenX-tp.screenX,mx=t.screenY-tp.screenY):mx=gx=0,tp=t),gx)},movementY:function(t){return"movementY"in t?t.movementY:mx}}),eM=Ba(T2),iU=mi({},T2,{dataTransfer:0}),sU=Ba(iU),oU=mi({},em,{relatedTarget:0}),yx=Ba(oU),aU=mi({},vd,{animationName:0,elapsedTime:0,pseudoElement:0}),lU=Ba(aU),AU=mi({},vd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uU=Ba(AU),cU=mi({},vd,{data:0}),tM=Ba(cU),hU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dU[t])?!!e[t]:!1}function HE(){return pU}var gU=mi({},em,{key:function(t){if(t.key){var e=hU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ny(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:HE,charCode:function(t){return t.type==="keypress"?ny(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ny(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),mU=Ba(gU),yU=mi({},T2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nM=Ba(yU),_U=mi({},em,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:HE}),vU=Ba(_U),xU=mi({},vd,{propertyName:0,elapsedTime:0,pseudoElement:0}),wU=Ba(xU),bU=mi({},T2,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),EU=Ba(bU),TU=[9,13,27,32],WE=ju&&"CompositionEvent"in window,jp=null;ju&&"documentMode"in document&&(jp=document.documentMode);var SU=ju&&"TextEvent"in window&&!jp,AL=ju&&(!WE||jp&&8<jp&&11>=jp),rM=String.fromCharCode(32),iM=!1;function uL(t,e){switch(t){case"keyup":return TU.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var o0=!1;function MU(t,e){switch(t){case"compositionend":return cL(e);case"keypress":return e.which!==32?null:(iM=!0,rM);case"textInput":return t=e.data,t===rM&&iM?null:t;default:return null}}function CU(t,e){if(o0)return t==="compositionend"||!WE&&uL(t,e)?(t=lL(),ty=$E=Uc=null,o0=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return AL&&e.locale!=="ko"?null:e.data;default:return null}}var PU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sM(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!PU[t.type]:e==="textarea"}function hL(t,e,n,r){$8(r),e=$y(e,"onChange"),0<e.length&&(n=new jE("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Hp=null,cg=null;function IU(t){bL(t,0)}function S2(t){var e=A0(t);if(z8(e))return t}function kU(t,e){if(t==="change")return e}var fL=!1;if(ju){var _x;if(ju){var vx="oninput"in document;if(!vx){var oM=document.createElement("div");oM.setAttribute("oninput","return;"),vx=typeof oM.oninput=="function"}_x=vx}else _x=!1;fL=_x&&(!document.documentMode||9<document.documentMode)}function aM(){Hp&&(Hp.detachEvent("onpropertychange",dL),cg=Hp=null)}function dL(t){if(t.propertyName==="value"&&S2(cg)){var e=[];hL(e,cg,t,FE(t)),Q8(IU,e)}}function LU(t,e,n){t==="focusin"?(aM(),Hp=e,cg=n,Hp.attachEvent("onpropertychange",dL)):t==="focusout"&&aM()}function DU(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return S2(cg)}function RU(t,e){if(t==="click")return S2(e)}function BU(t,e){if(t==="input"||t==="change")return S2(e)}function zU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var eA=typeof Object.is=="function"?Object.is:zU;function hg(t,e){if(eA(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ib.call(e,i)||!eA(t[i],e[i]))return!1}return!0}function lM(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function AM(t,e){var n=lM(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=lM(n)}}function pL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?pL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function gL(){for(var t=window,e=zy();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=zy(t.document)}return e}function QE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function OU(t){var e=gL(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&pL(n.ownerDocument.documentElement,n)){if(r!==null&&QE(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=AM(n,s);var A=AM(n,r);i&&A&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==A.node||t.focusOffset!==A.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(A.node,A.offset)):(e.setEnd(A.node,A.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var FU=ju&&"documentMode"in document&&11>=document.documentMode,a0=null,bb=null,Wp=null,Eb=!1;function uM(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Eb||a0==null||a0!==zy(r)||(r=a0,"selectionStart"in r&&QE(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Wp&&hg(Wp,r)||(Wp=r,r=$y(bb,"onSelect"),0<r.length&&(e=new jE("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=a0)))}function t1(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var l0={animationend:t1("Animation","AnimationEnd"),animationiteration:t1("Animation","AnimationIteration"),animationstart:t1("Animation","AnimationStart"),transitionend:t1("Transition","TransitionEnd")},xx={},mL={};ju&&(mL=document.createElement("div").style,"AnimationEvent"in window||(delete l0.animationend.animation,delete l0.animationiteration.animation,delete l0.animationstart.animation),"TransitionEvent"in window||delete l0.transitionend.transition);function M2(t){if(xx[t])return xx[t];if(!l0[t])return t;var e=l0[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in mL)return xx[t]=e[n];return t}var yL=M2("animationend"),_L=M2("animationiteration"),vL=M2("animationstart"),xL=M2("transitionend"),wL=new Map,cM="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hh(t,e){wL.set(t,e),gf(e,[t])}for(var wx=0;wx<cM.length;wx++){var bx=cM[wx],NU=bx.toLowerCase(),UU=bx[0].toUpperCase()+bx.slice(1);hh(NU,"on"+UU)}hh(yL,"onAnimationEnd");hh(_L,"onAnimationIteration");hh(vL,"onAnimationStart");hh("dblclick","onDoubleClick");hh("focusin","onFocus");hh("focusout","onBlur");hh(xL,"onTransitionEnd");Z0("onMouseEnter",["mouseout","mouseover"]);Z0("onMouseLeave",["mouseout","mouseover"]);Z0("onPointerEnter",["pointerout","pointerover"]);Z0("onPointerLeave",["pointerout","pointerover"]);gf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gf("onBeforeInput",["compositionend","keypress","textInput","paste"]);gf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VU=new Set("cancel close invalid load scroll toggle".split(" ").concat(kp));function hM(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,N9(r,e,void 0,t),t.currentTarget=null}function bL(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var A=r.length-1;0<=A;A--){var o=r[A],g=o.instance,w=o.currentTarget;if(o=o.listener,g!==s&&i.isPropagationStopped())break e;hM(i,o,w),s=g}else for(A=0;A<r.length;A++){if(o=r[A],g=o.instance,w=o.currentTarget,o=o.listener,g!==s&&i.isPropagationStopped())break e;hM(i,o,w),s=g}}}if(Fy)throw t=_b,Fy=!1,_b=null,t}function ii(t,e){var n=e[Pb];n===void 0&&(n=e[Pb]=new Set);var r=t+"__bubble";n.has(r)||(EL(e,t,2,!1),n.add(r))}function Ex(t,e,n){var r=0;e&&(r|=4),EL(n,t,r,e)}var n1="_reactListening"+Math.random().toString(36).slice(2);function fg(t){if(!t[n1]){t[n1]=!0,k8.forEach(function(n){n!=="selectionchange"&&(VU.has(n)||Ex(n,!1,t),Ex(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[n1]||(e[n1]=!0,Ex("selectionchange",!1,e))}}function EL(t,e,n,r){switch(aL(e)){case 1:var i=tU;break;case 4:i=nU;break;default:i=GE}n=i.bind(null,e,n,t),i=void 0,!yb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Tx(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var A=r.tag;if(A===3||A===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(A===4)for(A=r.return;A!==null;){var g=A.tag;if((g===3||g===4)&&(g=A.stateNode.containerInfo,g===i||g.nodeType===8&&g.parentNode===i))return;A=A.return}for(;o!==null;){if(A=Fh(o),A===null)return;if(g=A.tag,g===5||g===6){r=s=A;continue e}o=o.parentNode}}r=r.return}Q8(function(){var w=s,C=FE(n),I=[];e:{var k=wL.get(t);if(k!==void 0){var U=jE,H=t;switch(t){case"keypress":if(ny(n)===0)break e;case"keydown":case"keyup":U=mU;break;case"focusin":H="focus",U=yx;break;case"focusout":H="blur",U=yx;break;case"beforeblur":case"afterblur":U=yx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":U=eM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":U=sU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":U=vU;break;case yL:case _L:case vL:U=lU;break;case xL:U=wU;break;case"scroll":U=rU;break;case"wheel":U=EU;break;case"copy":case"cut":case"paste":U=uU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":U=nM}var q=(e&4)!==0,se=!q&&t==="scroll",X=q?k!==null?k+"Capture":null:k;q=[];for(var te=w,ie;te!==null;){ie=te;var fe=ie.stateNode;if(ie.tag===5&&fe!==null&&(ie=fe,X!==null&&(fe=ag(te,X),fe!=null&&q.push(dg(te,fe,ie)))),se)break;te=te.return}0<q.length&&(k=new U(k,H,null,n,C),I.push({event:k,listeners:q}))}}if(!(e&7)){e:{if(k=t==="mouseover"||t==="pointerover",U=t==="mouseout"||t==="pointerout",k&&n!==gb&&(H=n.relatedTarget||n.fromElement)&&(Fh(H)||H[Hu]))break e;if((U||k)&&(k=C.window===C?C:(k=C.ownerDocument)?k.defaultView||k.parentWindow:window,U?(H=n.relatedTarget||n.toElement,U=w,H=H?Fh(H):null,H!==null&&(se=mf(H),H!==se||H.tag!==5&&H.tag!==6)&&(H=null)):(U=null,H=w),U!==H)){if(q=eM,fe="onMouseLeave",X="onMouseEnter",te="mouse",(t==="pointerout"||t==="pointerover")&&(q=nM,fe="onPointerLeave",X="onPointerEnter",te="pointer"),se=U==null?k:A0(U),ie=H==null?k:A0(H),k=new q(fe,te+"leave",U,n,C),k.target=se,k.relatedTarget=ie,fe=null,Fh(C)===w&&(q=new q(X,te+"enter",H,n,C),q.target=ie,q.relatedTarget=se,fe=q),se=fe,U&&H)t:{for(q=U,X=H,te=0,ie=q;ie;ie=$f(ie))te++;for(ie=0,fe=X;fe;fe=$f(fe))ie++;for(;0<te-ie;)q=$f(q),te--;for(;0<ie-te;)X=$f(X),ie--;for(;te--;){if(q===X||X!==null&&q===X.alternate)break t;q=$f(q),X=$f(X)}q=null}else q=null;U!==null&&fM(I,k,U,q,!1),H!==null&&se!==null&&fM(I,se,H,q,!0)}}e:{if(k=w?A0(w):window,U=k.nodeName&&k.nodeName.toLowerCase(),U==="select"||U==="input"&&k.type==="file")var me=kU;else if(sM(k))if(fL)me=BU;else{me=DU;var Se=LU}else(U=k.nodeName)&&U.toLowerCase()==="input"&&(k.type==="checkbox"||k.type==="radio")&&(me=RU);if(me&&(me=me(t,w))){hL(I,me,n,C);break e}Se&&Se(t,k,w),t==="focusout"&&(Se=k._wrapperState)&&Se.controlled&&k.type==="number"&&cb(k,"number",k.value)}switch(Se=w?A0(w):window,t){case"focusin":(sM(Se)||Se.contentEditable==="true")&&(a0=Se,bb=w,Wp=null);break;case"focusout":Wp=bb=a0=null;break;case"mousedown":Eb=!0;break;case"contextmenu":case"mouseup":case"dragend":Eb=!1,uM(I,n,C);break;case"selectionchange":if(FU)break;case"keydown":case"keyup":uM(I,n,C)}var He;if(WE)e:{switch(t){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else o0?uL(t,n)&&(Qe="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(Qe="onCompositionStart");Qe&&(AL&&n.locale!=="ko"&&(o0||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&o0&&(He=lL()):(Uc=C,$E="value"in Uc?Uc.value:Uc.textContent,o0=!0)),Se=$y(w,Qe),0<Se.length&&(Qe=new tM(Qe,t,null,n,C),I.push({event:Qe,listeners:Se}),He?Qe.data=He:(He=cL(n),He!==null&&(Qe.data=He)))),(He=SU?MU(t,n):CU(t,n))&&(w=$y(w,"onBeforeInput"),0<w.length&&(C=new tM("onBeforeInput","beforeinput",null,n,C),I.push({event:C,listeners:w}),C.data=He))}bL(I,e)})}function dg(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $y(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ag(t,n),s!=null&&r.unshift(dg(t,s,i)),s=ag(t,e),s!=null&&r.push(dg(t,s,i))),t=t.return}return r}function $f(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function fM(t,e,n,r,i){for(var s=e._reactName,A=[];n!==null&&n!==r;){var o=n,g=o.alternate,w=o.stateNode;if(g!==null&&g===r)break;o.tag===5&&w!==null&&(o=w,i?(g=ag(n,s),g!=null&&A.unshift(dg(n,g,o))):i||(g=ag(n,s),g!=null&&A.push(dg(n,g,o)))),n=n.return}A.length!==0&&t.push({event:e,listeners:A})}var GU=/\r\n?/g,$U=/\u0000|\uFFFD/g;function dM(t){return(typeof t=="string"?t:""+t).replace(GU,`
`).replace($U,"")}function r1(t,e,n){if(e=dM(e),dM(t)!==e&&n)throw Error(Bt(425))}function jy(){}var Tb=null,Sb=null;function Mb(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Cb=typeof setTimeout=="function"?setTimeout:void 0,jU=typeof clearTimeout=="function"?clearTimeout:void 0,pM=typeof Promise=="function"?Promise:void 0,HU=typeof queueMicrotask=="function"?queueMicrotask:typeof pM<"u"?function(t){return pM.resolve(null).then(t).catch(WU)}:Cb;function WU(t){setTimeout(function(){throw t})}function Sx(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ug(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ug(e)}function Yc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function gM(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var xd=Math.random().toString(36).slice(2),PA="__reactFiber$"+xd,pg="__reactProps$"+xd,Hu="__reactContainer$"+xd,Pb="__reactEvents$"+xd,QU="__reactListeners$"+xd,qU="__reactHandles$"+xd;function Fh(t){var e=t[PA];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Hu]||n[PA]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=gM(t);t!==null;){if(n=t[PA])return n;t=gM(t)}return e}t=n,n=t.parentNode}return null}function tm(t){return t=t[PA]||t[Hu],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function A0(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Bt(33))}function C2(t){return t[pg]||null}var Ib=[],u0=-1;function fh(t){return{current:t}}function si(t){0>u0||(t.current=Ib[u0],Ib[u0]=null,u0--)}function Xr(t,e){u0++,Ib[u0]=t.current,t.current=e}var ah={},co=fh(ah),ta=fh(!1),qh=ah;function Y0(t,e){var n=t.type.contextTypes;if(!n)return ah;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function na(t){return t=t.childContextTypes,t!=null}function Hy(){si(ta),si(co)}function mM(t,e,n){if(co.current!==ah)throw Error(Bt(168));Xr(co,e),Xr(ta,n)}function TL(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Bt(108,L9(t)||"Unknown",i));return mi({},n,r)}function Wy(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ah,qh=co.current,Xr(co,t),Xr(ta,ta.current),!0}function yM(t,e,n){var r=t.stateNode;if(!r)throw Error(Bt(169));n?(t=TL(t,e,qh),r.__reactInternalMemoizedMergedChildContext=t,si(ta),si(co),Xr(co,t)):si(ta),Xr(ta,n)}var Cu=null,P2=!1,Mx=!1;function SL(t){Cu===null?Cu=[t]:Cu.push(t)}function ZU(t){P2=!0,SL(t)}function dh(){if(!Mx&&Cu!==null){Mx=!0;var t=0,e=Lr;try{var n=Cu;for(Lr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Cu=null,P2=!1}catch(i){throw Cu!==null&&(Cu=Cu.slice(t+1)),X8(NE,dh),i}finally{Lr=e,Mx=!1}}return null}var c0=[],h0=0,Qy=null,qy=0,sl=[],ol=0,Zh=null,ku=1,Lu="";function Dh(t,e){c0[h0++]=qy,c0[h0++]=Qy,Qy=t,qy=e}function ML(t,e,n){sl[ol++]=ku,sl[ol++]=Lu,sl[ol++]=Zh,Zh=t;var r=ku;t=Lu;var i=32-Xl(r)-1;r&=~(1<<i),n+=1;var s=32-Xl(e)+i;if(30<s){var A=i-i%5;s=(r&(1<<A)-1).toString(32),r>>=A,i-=A,ku=1<<32-Xl(e)+i|n<<i|r,Lu=s+t}else ku=1<<s|n<<i|r,Lu=t}function qE(t){t.return!==null&&(Dh(t,1),ML(t,1,0))}function ZE(t){for(;t===Qy;)Qy=c0[--h0],c0[h0]=null,qy=c0[--h0],c0[h0]=null;for(;t===Zh;)Zh=sl[--ol],sl[ol]=null,Lu=sl[--ol],sl[ol]=null,ku=sl[--ol],sl[ol]=null}var ka=null,Pa=null,ci=!1,Gl=null;function CL(t,e){var n=al(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function _M(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ka=t,Pa=Yc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ka=t,Pa=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Zh!==null?{id:ku,overflow:Lu}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=al(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ka=t,Pa=null,!0):!1;default:return!1}}function kb(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Lb(t){if(ci){var e=Pa;if(e){var n=e;if(!_M(t,e)){if(kb(t))throw Error(Bt(418));e=Yc(n.nextSibling);var r=ka;e&&_M(t,e)?CL(r,n):(t.flags=t.flags&-4097|2,ci=!1,ka=t)}}else{if(kb(t))throw Error(Bt(418));t.flags=t.flags&-4097|2,ci=!1,ka=t}}}function vM(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ka=t}function i1(t){if(t!==ka)return!1;if(!ci)return vM(t),ci=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Mb(t.type,t.memoizedProps)),e&&(e=Pa)){if(kb(t))throw PL(),Error(Bt(418));for(;e;)CL(t,e),e=Yc(e.nextSibling)}if(vM(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Bt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Pa=Yc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Pa=null}}else Pa=ka?Yc(t.stateNode.nextSibling):null;return!0}function PL(){for(var t=Pa;t;)t=Yc(t.nextSibling)}function X0(){Pa=ka=null,ci=!1}function YE(t){Gl===null?Gl=[t]:Gl.push(t)}var YU=sc.ReactCurrentBatchConfig;function Ul(t,e){if(t&&t.defaultProps){e=mi({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Zy=fh(null),Yy=null,f0=null,XE=null;function KE(){XE=f0=Yy=null}function JE(t){var e=Zy.current;si(Zy),t._currentValue=e}function Db(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function z0(t,e){Yy=t,XE=f0=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Jo=!0),t.firstContext=null)}function dl(t){var e=t._currentValue;if(XE!==t)if(t={context:t,memoizedValue:e,next:null},f0===null){if(Yy===null)throw Error(Bt(308));f0=t,Yy.dependencies={lanes:0,firstContext:t}}else f0=f0.next=t;return e}var Nh=null;function eT(t){Nh===null?Nh=[t]:Nh.push(t)}function IL(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,eT(e)):(n.next=i.next,i.next=n),e.interleaved=n,Wu(t,r)}function Wu(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Bc=!1;function tT(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kL(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Nu(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,xr&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Wu(t,n)}return i=r.interleaved,i===null?(e.next=e,eT(r)):(e.next=i.next,i.next=e),r.interleaved=e,Wu(t,n)}function ry(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,UE(t,n)}}function xM(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var A={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=A:s=s.next=A,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Xy(t,e,n,r){var i=t.updateQueue;Bc=!1;var s=i.firstBaseUpdate,A=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var g=o,w=g.next;g.next=null,A===null?s=w:A.next=w,A=g;var C=t.alternate;C!==null&&(C=C.updateQueue,o=C.lastBaseUpdate,o!==A&&(o===null?C.firstBaseUpdate=w:o.next=w,C.lastBaseUpdate=g))}if(s!==null){var I=i.baseState;A=0,C=w=g=null,o=s;do{var k=o.lane,U=o.eventTime;if((r&k)===k){C!==null&&(C=C.next={eventTime:U,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var H=t,q=o;switch(k=e,U=n,q.tag){case 1:if(H=q.payload,typeof H=="function"){I=H.call(U,I,k);break e}I=H;break e;case 3:H.flags=H.flags&-65537|128;case 0:if(H=q.payload,k=typeof H=="function"?H.call(U,I,k):H,k==null)break e;I=mi({},I,k);break e;case 2:Bc=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,k=i.effects,k===null?i.effects=[o]:k.push(o))}else U={eventTime:U,lane:k,tag:o.tag,payload:o.payload,callback:o.callback,next:null},C===null?(w=C=U,g=I):C=C.next=U,A|=k;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;k=o,o=k.next,k.next=null,i.lastBaseUpdate=k,i.shared.pending=null}}while(1);if(C===null&&(g=I),i.baseState=g,i.firstBaseUpdate=w,i.lastBaseUpdate=C,e=i.shared.interleaved,e!==null){i=e;do A|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Xh|=A,t.lanes=A,t.memoizedState=I}}function wM(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Bt(191,i));i.call(r)}}}var LL=new I8.Component().refs;function Rb(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:mi({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var I2={isMounted:function(t){return(t=t._reactInternals)?mf(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Do(),i=Jc(t),s=Nu(r,i);s.payload=e,n!=null&&(s.callback=n),e=Xc(t,s,i),e!==null&&(Kl(e,t,i,r),ry(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Do(),i=Jc(t),s=Nu(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Xc(t,s,i),e!==null&&(Kl(e,t,i,r),ry(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Do(),r=Jc(t),i=Nu(n,r);i.tag=2,e!=null&&(i.callback=e),e=Xc(t,i,r),e!==null&&(Kl(e,t,r,n),ry(e,t,r))}};function bM(t,e,n,r,i,s,A){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,A):e.prototype&&e.prototype.isPureReactComponent?!hg(n,r)||!hg(i,s):!0}function DL(t,e,n){var r=!1,i=ah,s=e.contextType;return typeof s=="object"&&s!==null?s=dl(s):(i=na(e)?qh:co.current,r=e.contextTypes,s=(r=r!=null)?Y0(t,i):ah),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=I2,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function EM(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&I2.enqueueReplaceState(e,e.state,null)}function Bb(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=LL,tT(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=dl(s):(s=na(e)?qh:co.current,i.context=Y0(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Rb(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&I2.enqueueReplaceState(i,i.state,null),Xy(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function np(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Bt(309));var r=n.stateNode}if(!r)throw Error(Bt(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(A){var o=i.refs;o===LL&&(o=i.refs={}),A===null?delete o[s]:o[s]=A},e._stringRef=s,e)}if(typeof t!="string")throw Error(Bt(284));if(!n._owner)throw Error(Bt(290,t))}return t}function s1(t,e){throw t=Object.prototype.toString.call(e),Error(Bt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function TM(t){var e=t._init;return e(t._payload)}function RL(t){function e(X,te){if(t){var ie=X.deletions;ie===null?(X.deletions=[te],X.flags|=16):ie.push(te)}}function n(X,te){if(!t)return null;for(;te!==null;)e(X,te),te=te.sibling;return null}function r(X,te){for(X=new Map;te!==null;)te.key!==null?X.set(te.key,te):X.set(te.index,te),te=te.sibling;return X}function i(X,te){return X=eh(X,te),X.index=0,X.sibling=null,X}function s(X,te,ie){return X.index=ie,t?(ie=X.alternate,ie!==null?(ie=ie.index,ie<te?(X.flags|=2,te):ie):(X.flags|=2,te)):(X.flags|=1048576,te)}function A(X){return t&&X.alternate===null&&(X.flags|=2),X}function o(X,te,ie,fe){return te===null||te.tag!==6?(te=Rx(ie,X.mode,fe),te.return=X,te):(te=i(te,ie),te.return=X,te)}function g(X,te,ie,fe){var me=ie.type;return me===s0?C(X,te,ie.props.children,fe,ie.key):te!==null&&(te.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Rc&&TM(me)===te.type)?(fe=i(te,ie.props),fe.ref=np(X,te,ie),fe.return=X,fe):(fe=Ay(ie.type,ie.key,ie.props,null,X.mode,fe),fe.ref=np(X,te,ie),fe.return=X,fe)}function w(X,te,ie,fe){return te===null||te.tag!==4||te.stateNode.containerInfo!==ie.containerInfo||te.stateNode.implementation!==ie.implementation?(te=Bx(ie,X.mode,fe),te.return=X,te):(te=i(te,ie.children||[]),te.return=X,te)}function C(X,te,ie,fe,me){return te===null||te.tag!==7?(te=jh(ie,X.mode,fe,me),te.return=X,te):(te=i(te,ie),te.return=X,te)}function I(X,te,ie){if(typeof te=="string"&&te!==""||typeof te=="number")return te=Rx(""+te,X.mode,ie),te.return=X,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case qm:return ie=Ay(te.type,te.key,te.props,null,X.mode,ie),ie.ref=np(X,null,te),ie.return=X,ie;case i0:return te=Bx(te,X.mode,ie),te.return=X,te;case Rc:var fe=te._init;return I(X,fe(te._payload),ie)}if(Pp(te)||Xd(te))return te=jh(te,X.mode,ie,null),te.return=X,te;s1(X,te)}return null}function k(X,te,ie,fe){var me=te!==null?te.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return me!==null?null:o(X,te,""+ie,fe);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case qm:return ie.key===me?g(X,te,ie,fe):null;case i0:return ie.key===me?w(X,te,ie,fe):null;case Rc:return me=ie._init,k(X,te,me(ie._payload),fe)}if(Pp(ie)||Xd(ie))return me!==null?null:C(X,te,ie,fe,null);s1(X,ie)}return null}function U(X,te,ie,fe,me){if(typeof fe=="string"&&fe!==""||typeof fe=="number")return X=X.get(ie)||null,o(te,X,""+fe,me);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case qm:return X=X.get(fe.key===null?ie:fe.key)||null,g(te,X,fe,me);case i0:return X=X.get(fe.key===null?ie:fe.key)||null,w(te,X,fe,me);case Rc:var Se=fe._init;return U(X,te,ie,Se(fe._payload),me)}if(Pp(fe)||Xd(fe))return X=X.get(ie)||null,C(te,X,fe,me,null);s1(te,fe)}return null}function H(X,te,ie,fe){for(var me=null,Se=null,He=te,Qe=te=0,Ke=null;He!==null&&Qe<ie.length;Qe++){He.index>Qe?(Ke=He,He=null):Ke=He.sibling;var nt=k(X,He,ie[Qe],fe);if(nt===null){He===null&&(He=Ke);break}t&&He&&nt.alternate===null&&e(X,He),te=s(nt,te,Qe),Se===null?me=nt:Se.sibling=nt,Se=nt,He=Ke}if(Qe===ie.length)return n(X,He),ci&&Dh(X,Qe),me;if(He===null){for(;Qe<ie.length;Qe++)He=I(X,ie[Qe],fe),He!==null&&(te=s(He,te,Qe),Se===null?me=He:Se.sibling=He,Se=He);return ci&&Dh(X,Qe),me}for(He=r(X,He);Qe<ie.length;Qe++)Ke=U(He,X,Qe,ie[Qe],fe),Ke!==null&&(t&&Ke.alternate!==null&&He.delete(Ke.key===null?Qe:Ke.key),te=s(Ke,te,Qe),Se===null?me=Ke:Se.sibling=Ke,Se=Ke);return t&&He.forEach(function(Ne){return e(X,Ne)}),ci&&Dh(X,Qe),me}function q(X,te,ie,fe){var me=Xd(ie);if(typeof me!="function")throw Error(Bt(150));if(ie=me.call(ie),ie==null)throw Error(Bt(151));for(var Se=me=null,He=te,Qe=te=0,Ke=null,nt=ie.next();He!==null&&!nt.done;Qe++,nt=ie.next()){He.index>Qe?(Ke=He,He=null):Ke=He.sibling;var Ne=k(X,He,nt.value,fe);if(Ne===null){He===null&&(He=Ke);break}t&&He&&Ne.alternate===null&&e(X,He),te=s(Ne,te,Qe),Se===null?me=Ne:Se.sibling=Ne,Se=Ne,He=Ke}if(nt.done)return n(X,He),ci&&Dh(X,Qe),me;if(He===null){for(;!nt.done;Qe++,nt=ie.next())nt=I(X,nt.value,fe),nt!==null&&(te=s(nt,te,Qe),Se===null?me=nt:Se.sibling=nt,Se=nt);return ci&&Dh(X,Qe),me}for(He=r(X,He);!nt.done;Qe++,nt=ie.next())nt=U(He,X,Qe,nt.value,fe),nt!==null&&(t&&nt.alternate!==null&&He.delete(nt.key===null?Qe:nt.key),te=s(nt,te,Qe),Se===null?me=nt:Se.sibling=nt,Se=nt);return t&&He.forEach(function(rt){return e(X,rt)}),ci&&Dh(X,Qe),me}function se(X,te,ie,fe){if(typeof ie=="object"&&ie!==null&&ie.type===s0&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case qm:e:{for(var me=ie.key,Se=te;Se!==null;){if(Se.key===me){if(me=ie.type,me===s0){if(Se.tag===7){n(X,Se.sibling),te=i(Se,ie.props.children),te.return=X,X=te;break e}}else if(Se.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===Rc&&TM(me)===Se.type){n(X,Se.sibling),te=i(Se,ie.props),te.ref=np(X,Se,ie),te.return=X,X=te;break e}n(X,Se);break}else e(X,Se);Se=Se.sibling}ie.type===s0?(te=jh(ie.props.children,X.mode,fe,ie.key),te.return=X,X=te):(fe=Ay(ie.type,ie.key,ie.props,null,X.mode,fe),fe.ref=np(X,te,ie),fe.return=X,X=fe)}return A(X);case i0:e:{for(Se=ie.key;te!==null;){if(te.key===Se)if(te.tag===4&&te.stateNode.containerInfo===ie.containerInfo&&te.stateNode.implementation===ie.implementation){n(X,te.sibling),te=i(te,ie.children||[]),te.return=X,X=te;break e}else{n(X,te);break}else e(X,te);te=te.sibling}te=Bx(ie,X.mode,fe),te.return=X,X=te}return A(X);case Rc:return Se=ie._init,se(X,te,Se(ie._payload),fe)}if(Pp(ie))return H(X,te,ie,fe);if(Xd(ie))return q(X,te,ie,fe);s1(X,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,te!==null&&te.tag===6?(n(X,te.sibling),te=i(te,ie),te.return=X,X=te):(n(X,te),te=Rx(ie,X.mode,fe),te.return=X,X=te),A(X)):n(X,te)}return se}var K0=RL(!0),BL=RL(!1),nm={},BA=fh(nm),gg=fh(nm),mg=fh(nm);function Uh(t){if(t===nm)throw Error(Bt(174));return t}function nT(t,e){switch(Xr(mg,e),Xr(gg,t),Xr(BA,nm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:fb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=fb(e,t)}si(BA),Xr(BA,e)}function J0(){si(BA),si(gg),si(mg)}function zL(t){Uh(mg.current);var e=Uh(BA.current),n=fb(e,t.type);e!==n&&(Xr(gg,t),Xr(BA,n))}function rT(t){gg.current===t&&(si(BA),si(gg))}var di=fh(0);function Ky(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Cx=[];function iT(){for(var t=0;t<Cx.length;t++)Cx[t]._workInProgressVersionPrimary=null;Cx.length=0}var iy=sc.ReactCurrentDispatcher,Px=sc.ReactCurrentBatchConfig,Yh=0,gi=null,Ji=null,gs=null,Jy=!1,Qp=!1,yg=0,XU=0;function Ys(){throw Error(Bt(321))}function sT(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!eA(t[n],e[n]))return!1;return!0}function oT(t,e,n,r,i,s){if(Yh=s,gi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,iy.current=t===null||t.memoizedState===null?tV:nV,t=n(r,i),Qp){s=0;do{if(Qp=!1,yg=0,25<=s)throw Error(Bt(301));s+=1,gs=Ji=null,e.updateQueue=null,iy.current=rV,t=n(r,i)}while(Qp)}if(iy.current=e_,e=Ji!==null&&Ji.next!==null,Yh=0,gs=Ji=gi=null,Jy=!1,e)throw Error(Bt(300));return t}function aT(){var t=yg!==0;return yg=0,t}function CA(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gs===null?gi.memoizedState=gs=t:gs=gs.next=t,gs}function pl(){if(Ji===null){var t=gi.alternate;t=t!==null?t.memoizedState:null}else t=Ji.next;var e=gs===null?gi.memoizedState:gs.next;if(e!==null)gs=e,Ji=t;else{if(t===null)throw Error(Bt(310));Ji=t,t={memoizedState:Ji.memoizedState,baseState:Ji.baseState,baseQueue:Ji.baseQueue,queue:Ji.queue,next:null},gs===null?gi.memoizedState=gs=t:gs=gs.next=t}return gs}function _g(t,e){return typeof e=="function"?e(t):e}function Ix(t){var e=pl(),n=e.queue;if(n===null)throw Error(Bt(311));n.lastRenderedReducer=t;var r=Ji,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var A=i.next;i.next=s.next,s.next=A}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=A=null,g=null,w=s;do{var C=w.lane;if((Yh&C)===C)g!==null&&(g=g.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),r=w.hasEagerState?w.eagerState:t(r,w.action);else{var I={lane:C,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};g===null?(o=g=I,A=r):g=g.next=I,gi.lanes|=C,Xh|=C}w=w.next}while(w!==null&&w!==s);g===null?A=r:g.next=o,eA(r,e.memoizedState)||(Jo=!0),e.memoizedState=r,e.baseState=A,e.baseQueue=g,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,gi.lanes|=s,Xh|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function kx(t){var e=pl(),n=e.queue;if(n===null)throw Error(Bt(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var A=i=i.next;do s=t(s,A.action),A=A.next;while(A!==i);eA(s,e.memoizedState)||(Jo=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function OL(){}function FL(t,e){var n=gi,r=pl(),i=e(),s=!eA(r.memoizedState,i);if(s&&(r.memoizedState=i,Jo=!0),r=r.queue,lT(VL.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||gs!==null&&gs.memoizedState.tag&1){if(n.flags|=2048,vg(9,UL.bind(null,n,r,i,e),void 0,null),ys===null)throw Error(Bt(349));Yh&30||NL(n,e,i)}return i}function NL(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=gi.updateQueue,e===null?(e={lastEffect:null,stores:null},gi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function UL(t,e,n,r){e.value=n,e.getSnapshot=r,GL(e)&&$L(t)}function VL(t,e,n){return n(function(){GL(e)&&$L(t)})}function GL(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!eA(t,n)}catch{return!0}}function $L(t){var e=Wu(t,1);e!==null&&Kl(e,t,1,-1)}function SM(t){var e=CA();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_g,lastRenderedState:t},e.queue=t,t=t.dispatch=eV.bind(null,gi,t),[e.memoizedState,t]}function vg(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=gi.updateQueue,e===null?(e={lastEffect:null,stores:null},gi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function jL(){return pl().memoizedState}function sy(t,e,n,r){var i=CA();gi.flags|=t,i.memoizedState=vg(1|e,n,void 0,r===void 0?null:r)}function k2(t,e,n,r){var i=pl();r=r===void 0?null:r;var s=void 0;if(Ji!==null){var A=Ji.memoizedState;if(s=A.destroy,r!==null&&sT(r,A.deps)){i.memoizedState=vg(e,n,s,r);return}}gi.flags|=t,i.memoizedState=vg(1|e,n,s,r)}function MM(t,e){return sy(8390656,8,t,e)}function lT(t,e){return k2(2048,8,t,e)}function HL(t,e){return k2(4,2,t,e)}function WL(t,e){return k2(4,4,t,e)}function QL(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function qL(t,e,n){return n=n!=null?n.concat([t]):null,k2(4,4,QL.bind(null,e,t),n)}function AT(){}function ZL(t,e){var n=pl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&sT(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function YL(t,e){var n=pl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&sT(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function XL(t,e,n){return Yh&21?(eA(n,e)||(n=eL(),gi.lanes|=n,Xh|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Jo=!0),t.memoizedState=n)}function KU(t,e){var n=Lr;Lr=n!==0&&4>n?n:4,t(!0);var r=Px.transition;Px.transition={};try{t(!1),e()}finally{Lr=n,Px.transition=r}}function KL(){return pl().memoizedState}function JU(t,e,n){var r=Jc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},JL(t))eD(e,n);else if(n=IL(t,e,n,r),n!==null){var i=Do();Kl(n,t,r,i),tD(n,e,r)}}function eV(t,e,n){var r=Jc(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(JL(t))eD(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var A=e.lastRenderedState,o=s(A,n);if(i.hasEagerState=!0,i.eagerState=o,eA(o,A)){var g=e.interleaved;g===null?(i.next=i,eT(e)):(i.next=g.next,g.next=i),e.interleaved=i;return}}catch{}finally{}n=IL(t,e,i,r),n!==null&&(i=Do(),Kl(n,t,r,i),tD(n,e,r))}}function JL(t){var e=t.alternate;return t===gi||e!==null&&e===gi}function eD(t,e){Qp=Jy=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function tD(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,UE(t,n)}}var e_={readContext:dl,useCallback:Ys,useContext:Ys,useEffect:Ys,useImperativeHandle:Ys,useInsertionEffect:Ys,useLayoutEffect:Ys,useMemo:Ys,useReducer:Ys,useRef:Ys,useState:Ys,useDebugValue:Ys,useDeferredValue:Ys,useTransition:Ys,useMutableSource:Ys,useSyncExternalStore:Ys,useId:Ys,unstable_isNewReconciler:!1},tV={readContext:dl,useCallback:function(t,e){return CA().memoizedState=[t,e===void 0?null:e],t},useContext:dl,useEffect:MM,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,sy(4194308,4,QL.bind(null,e,t),n)},useLayoutEffect:function(t,e){return sy(4194308,4,t,e)},useInsertionEffect:function(t,e){return sy(4,2,t,e)},useMemo:function(t,e){var n=CA();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=CA();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=JU.bind(null,gi,t),[r.memoizedState,t]},useRef:function(t){var e=CA();return t={current:t},e.memoizedState=t},useState:SM,useDebugValue:AT,useDeferredValue:function(t){return CA().memoizedState=t},useTransition:function(){var t=SM(!1),e=t[0];return t=KU.bind(null,t[1]),CA().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=gi,i=CA();if(ci){if(n===void 0)throw Error(Bt(407));n=n()}else{if(n=e(),ys===null)throw Error(Bt(349));Yh&30||NL(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,MM(VL.bind(null,r,s,t),[t]),r.flags|=2048,vg(9,UL.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=CA(),e=ys.identifierPrefix;if(ci){var n=Lu,r=ku;n=(r&~(1<<32-Xl(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=yg++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=XU++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},nV={readContext:dl,useCallback:ZL,useContext:dl,useEffect:lT,useImperativeHandle:qL,useInsertionEffect:HL,useLayoutEffect:WL,useMemo:YL,useReducer:Ix,useRef:jL,useState:function(){return Ix(_g)},useDebugValue:AT,useDeferredValue:function(t){var e=pl();return XL(e,Ji.memoizedState,t)},useTransition:function(){var t=Ix(_g)[0],e=pl().memoizedState;return[t,e]},useMutableSource:OL,useSyncExternalStore:FL,useId:KL,unstable_isNewReconciler:!1},rV={readContext:dl,useCallback:ZL,useContext:dl,useEffect:lT,useImperativeHandle:qL,useInsertionEffect:HL,useLayoutEffect:WL,useMemo:YL,useReducer:kx,useRef:jL,useState:function(){return kx(_g)},useDebugValue:AT,useDeferredValue:function(t){var e=pl();return Ji===null?e.memoizedState=t:XL(e,Ji.memoizedState,t)},useTransition:function(){var t=kx(_g)[0],e=pl().memoizedState;return[t,e]},useMutableSource:OL,useSyncExternalStore:FL,useId:KL,unstable_isNewReconciler:!1};function ed(t,e){try{var n="",r=e;do n+=k9(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Lx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function zb(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var iV=typeof WeakMap=="function"?WeakMap:Map;function nD(t,e,n){n=Nu(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){n_||(n_=!0,Wb=r),zb(t,e)},n}function rD(t,e,n){n=Nu(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){zb(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){zb(t,e),typeof r!="function"&&(Kc===null?Kc=new Set([this]):Kc.add(this));var A=e.stack;this.componentDidCatch(e.value,{componentStack:A!==null?A:""})}),n}function CM(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new iV;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=yV.bind(null,t,e,n),e.then(t,t))}function PM(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function IM(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Nu(-1,1),e.tag=2,Xc(n,e,1))),n.lanes|=1),t)}var sV=sc.ReactCurrentOwner,Jo=!1;function Co(t,e,n,r){e.child=t===null?BL(e,null,n,r):K0(e,t.child,n,r)}function kM(t,e,n,r,i){n=n.render;var s=e.ref;return z0(e,i),r=oT(t,e,n,r,s,i),n=aT(),t!==null&&!Jo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Qu(t,e,i)):(ci&&n&&qE(e),e.flags|=1,Co(t,e,r,i),e.child)}function LM(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!mT(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,iD(t,e,s,r,i)):(t=Ay(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var A=s.memoizedProps;if(n=n.compare,n=n!==null?n:hg,n(A,r)&&t.ref===e.ref)return Qu(t,e,i)}return e.flags|=1,t=eh(s,r),t.ref=e.ref,t.return=e,e.child=t}function iD(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(hg(s,r)&&t.ref===e.ref)if(Jo=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Jo=!0);else return e.lanes=t.lanes,Qu(t,e,i)}return Ob(t,e,n,r,i)}function sD(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xr(p0,Sa),Sa|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xr(p0,Sa),Sa|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Xr(p0,Sa),Sa|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Xr(p0,Sa),Sa|=r;return Co(t,e,i,n),e.child}function oD(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ob(t,e,n,r,i){var s=na(n)?qh:co.current;return s=Y0(e,s),z0(e,i),n=oT(t,e,n,r,s,i),r=aT(),t!==null&&!Jo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Qu(t,e,i)):(ci&&r&&qE(e),e.flags|=1,Co(t,e,n,i),e.child)}function DM(t,e,n,r,i){if(na(n)){var s=!0;Wy(e)}else s=!1;if(z0(e,i),e.stateNode===null)oy(t,e),DL(e,n,r),Bb(e,n,r,i),r=!0;else if(t===null){var A=e.stateNode,o=e.memoizedProps;A.props=o;var g=A.context,w=n.contextType;typeof w=="object"&&w!==null?w=dl(w):(w=na(n)?qh:co.current,w=Y0(e,w));var C=n.getDerivedStateFromProps,I=typeof C=="function"||typeof A.getSnapshotBeforeUpdate=="function";I||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(o!==r||g!==w)&&EM(e,A,r,w),Bc=!1;var k=e.memoizedState;A.state=k,Xy(e,r,A,i),g=e.memoizedState,o!==r||k!==g||ta.current||Bc?(typeof C=="function"&&(Rb(e,n,C,r),g=e.memoizedState),(o=Bc||bM(e,n,o,r,k,g,w))?(I||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(e.flags|=4194308)):(typeof A.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=g),A.props=r,A.state=g,A.context=w,r=o):(typeof A.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{A=e.stateNode,kL(t,e),o=e.memoizedProps,w=e.type===e.elementType?o:Ul(e.type,o),A.props=w,I=e.pendingProps,k=A.context,g=n.contextType,typeof g=="object"&&g!==null?g=dl(g):(g=na(n)?qh:co.current,g=Y0(e,g));var U=n.getDerivedStateFromProps;(C=typeof U=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(o!==I||k!==g)&&EM(e,A,r,g),Bc=!1,k=e.memoizedState,A.state=k,Xy(e,r,A,i);var H=e.memoizedState;o!==I||k!==H||ta.current||Bc?(typeof U=="function"&&(Rb(e,n,U,r),H=e.memoizedState),(w=Bc||bM(e,n,w,r,k,H,g)||!1)?(C||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(r,H,g),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(r,H,g)),typeof A.componentDidUpdate=="function"&&(e.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof A.componentDidUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=H),A.props=r,A.state=H,A.context=g,r=w):(typeof A.componentDidUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&k===t.memoizedState||(e.flags|=1024),r=!1)}return Fb(t,e,n,r,s,i)}function Fb(t,e,n,r,i,s){oD(t,e);var A=(e.flags&128)!==0;if(!r&&!A)return i&&yM(e,n,!1),Qu(t,e,s);r=e.stateNode,sV.current=e;var o=A&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&A?(e.child=K0(e,t.child,null,s),e.child=K0(e,null,o,s)):Co(t,e,o,s),e.memoizedState=r.state,i&&yM(e,n,!0),e.child}function aD(t){var e=t.stateNode;e.pendingContext?mM(t,e.pendingContext,e.pendingContext!==e.context):e.context&&mM(t,e.context,!1),nT(t,e.containerInfo)}function RM(t,e,n,r,i){return X0(),YE(i),e.flags|=256,Co(t,e,n,r),e.child}var Nb={dehydrated:null,treeContext:null,retryLane:0};function Ub(t){return{baseLanes:t,cachePool:null,transitions:null}}function lD(t,e,n){var r=e.pendingProps,i=di.current,s=!1,A=(e.flags&128)!==0,o;if((o=A)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Xr(di,i&1),t===null)return Lb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(A=r.children,t=r.fallback,s?(r=e.mode,s=e.child,A={mode:"hidden",children:A},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=A):s=R2(A,r,0,null),t=jh(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ub(n),e.memoizedState=Nb,t):uT(e,A));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return oV(t,e,A,r,o,i,n);if(s){s=r.fallback,A=e.mode,i=t.child,o=i.sibling;var g={mode:"hidden",children:r.children};return!(A&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=g,e.deletions=null):(r=eh(i,g),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=eh(o,s):(s=jh(s,A,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,A=t.child.memoizedState,A=A===null?Ub(n):{baseLanes:A.baseLanes|n,cachePool:null,transitions:A.transitions},s.memoizedState=A,s.childLanes=t.childLanes&~n,e.memoizedState=Nb,r}return s=t.child,t=s.sibling,r=eh(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function uT(t,e){return e=R2({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function o1(t,e,n,r){return r!==null&&YE(r),K0(e,t.child,null,n),t=uT(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function oV(t,e,n,r,i,s,A){if(n)return e.flags&256?(e.flags&=-257,r=Lx(Error(Bt(422))),o1(t,e,A,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=R2({mode:"visible",children:r.children},i,0,null),s=jh(s,i,A,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&K0(e,t.child,null,A),e.child.memoizedState=Ub(A),e.memoizedState=Nb,s);if(!(e.mode&1))return o1(t,e,A,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(Bt(419)),r=Lx(s,r,void 0),o1(t,e,A,r)}if(o=(A&t.childLanes)!==0,Jo||o){if(r=ys,r!==null){switch(A&-A){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|A)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Wu(t,i),Kl(r,t,i,-1))}return gT(),r=Lx(Error(Bt(421))),o1(t,e,A,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=_V.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Pa=Yc(i.nextSibling),ka=e,ci=!0,Gl=null,t!==null&&(sl[ol++]=ku,sl[ol++]=Lu,sl[ol++]=Zh,ku=t.id,Lu=t.overflow,Zh=e),e=uT(e,r.children),e.flags|=4096,e)}function BM(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Db(t.return,e,n)}function Dx(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function AD(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Co(t,e,r.children,n),r=di.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&BM(t,n,e);else if(t.tag===19)BM(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Xr(di,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ky(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Dx(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ky(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Dx(e,!0,n,null,s);break;case"together":Dx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function oy(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Qu(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Xh|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Bt(153));if(e.child!==null){for(t=e.child,n=eh(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=eh(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function aV(t,e,n){switch(e.tag){case 3:aD(e),X0();break;case 5:zL(e);break;case 1:na(e.type)&&Wy(e);break;case 4:nT(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Xr(Zy,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Xr(di,di.current&1),e.flags|=128,null):n&e.child.childLanes?lD(t,e,n):(Xr(di,di.current&1),t=Qu(t,e,n),t!==null?t.sibling:null);Xr(di,di.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return AD(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xr(di,di.current),r)break;return null;case 22:case 23:return e.lanes=0,sD(t,e,n)}return Qu(t,e,n)}var uD,Vb,cD,hD;uD=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Vb=function(){};cD=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Uh(BA.current);var s=null;switch(n){case"input":i=Ab(t,i),r=Ab(t,r),s=[];break;case"select":i=mi({},i,{value:void 0}),r=mi({},r,{value:void 0}),s=[];break;case"textarea":i=hb(t,i),r=hb(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=jy)}db(n,r);var A;n=null;for(w in i)if(!r.hasOwnProperty(w)&&i.hasOwnProperty(w)&&i[w]!=null)if(w==="style"){var o=i[w];for(A in o)o.hasOwnProperty(A)&&(n||(n={}),n[A]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(sg.hasOwnProperty(w)?s||(s=[]):(s=s||[]).push(w,null));for(w in r){var g=r[w];if(o=i?.[w],r.hasOwnProperty(w)&&g!==o&&(g!=null||o!=null))if(w==="style")if(o){for(A in o)!o.hasOwnProperty(A)||g&&g.hasOwnProperty(A)||(n||(n={}),n[A]="");for(A in g)g.hasOwnProperty(A)&&o[A]!==g[A]&&(n||(n={}),n[A]=g[A])}else n||(s||(s=[]),s.push(w,n)),n=g;else w==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,o=o?o.__html:void 0,g!=null&&o!==g&&(s=s||[]).push(w,g)):w==="children"?typeof g!="string"&&typeof g!="number"||(s=s||[]).push(w,""+g):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(sg.hasOwnProperty(w)?(g!=null&&w==="onScroll"&&ii("scroll",t),s||o===g||(s=[])):(s=s||[]).push(w,g))}n&&(s=s||[]).push("style",n);var w=s;(e.updateQueue=w)&&(e.flags|=4)}};hD=function(t,e,n,r){n!==r&&(e.flags|=4)};function rp(t,e){if(!ci)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Xs(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function lV(t,e,n){var r=e.pendingProps;switch(ZE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xs(e),null;case 1:return na(e.type)&&Hy(),Xs(e),null;case 3:return r=e.stateNode,J0(),si(ta),si(co),iT(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(i1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gl!==null&&(Zb(Gl),Gl=null))),Vb(t,e),Xs(e),null;case 5:rT(e);var i=Uh(mg.current);if(n=e.type,t!==null&&e.stateNode!=null)cD(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Bt(166));return Xs(e),null}if(t=Uh(BA.current),i1(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[PA]=e,r[pg]=s,t=(e.mode&1)!==0,n){case"dialog":ii("cancel",r),ii("close",r);break;case"iframe":case"object":case"embed":ii("load",r);break;case"video":case"audio":for(i=0;i<kp.length;i++)ii(kp[i],r);break;case"source":ii("error",r);break;case"img":case"image":case"link":ii("error",r),ii("load",r);break;case"details":ii("toggle",r);break;case"input":j5(r,s),ii("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ii("invalid",r);break;case"textarea":W5(r,s),ii("invalid",r)}db(n,s),i=null;for(var A in s)if(s.hasOwnProperty(A)){var o=s[A];A==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&r1(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&r1(r.textContent,o,t),i=["children",""+o]):sg.hasOwnProperty(A)&&o!=null&&A==="onScroll"&&ii("scroll",r)}switch(n){case"input":Zm(r),H5(r,s,!0);break;case"textarea":Zm(r),Q5(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=jy)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{A=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=N8(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=A.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=A.createElement(n,{is:r.is}):(t=A.createElement(n),n==="select"&&(A=t,r.multiple?A.multiple=!0:r.size&&(A.size=r.size))):t=A.createElementNS(t,n),t[PA]=e,t[pg]=r,uD(t,e,!1,!1),e.stateNode=t;e:{switch(A=pb(n,r),n){case"dialog":ii("cancel",t),ii("close",t),i=r;break;case"iframe":case"object":case"embed":ii("load",t),i=r;break;case"video":case"audio":for(i=0;i<kp.length;i++)ii(kp[i],t);i=r;break;case"source":ii("error",t),i=r;break;case"img":case"image":case"link":ii("error",t),ii("load",t),i=r;break;case"details":ii("toggle",t),i=r;break;case"input":j5(t,r),i=Ab(t,r),ii("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=mi({},r,{value:void 0}),ii("invalid",t);break;case"textarea":W5(t,r),i=hb(t,r),ii("invalid",t);break;default:i=r}db(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var g=o[s];s==="style"?G8(t,g):s==="dangerouslySetInnerHTML"?(g=g?g.__html:void 0,g!=null&&U8(t,g)):s==="children"?typeof g=="string"?(n!=="textarea"||g!=="")&&og(t,g):typeof g=="number"&&og(t,""+g):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(sg.hasOwnProperty(s)?g!=null&&s==="onScroll"&&ii("scroll",t):g!=null&&RE(t,s,g,A))}switch(n){case"input":Zm(t),H5(t,r,!1);break;case"textarea":Zm(t),Q5(t);break;case"option":r.value!=null&&t.setAttribute("value",""+oh(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?L0(t,!!r.multiple,s,!1):r.defaultValue!=null&&L0(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=jy)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xs(e),null;case 6:if(t&&e.stateNode!=null)hD(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Bt(166));if(n=Uh(mg.current),Uh(BA.current),i1(e)){if(r=e.stateNode,n=e.memoizedProps,r[PA]=e,(s=r.nodeValue!==n)&&(t=ka,t!==null))switch(t.tag){case 3:r1(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&r1(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[PA]=e,e.stateNode=r}return Xs(e),null;case 13:if(si(di),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ci&&Pa!==null&&e.mode&1&&!(e.flags&128))PL(),X0(),e.flags|=98560,s=!1;else if(s=i1(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Bt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Bt(317));s[PA]=e}else X0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xs(e),s=!1}else Gl!==null&&(Zb(Gl),Gl=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||di.current&1?es===0&&(es=3):gT())),e.updateQueue!==null&&(e.flags|=4),Xs(e),null);case 4:return J0(),Vb(t,e),t===null&&fg(e.stateNode.containerInfo),Xs(e),null;case 10:return JE(e.type._context),Xs(e),null;case 17:return na(e.type)&&Hy(),Xs(e),null;case 19:if(si(di),s=e.memoizedState,s===null)return Xs(e),null;if(r=(e.flags&128)!==0,A=s.rendering,A===null)if(r)rp(s,!1);else{if(es!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(A=Ky(t),A!==null){for(e.flags|=128,rp(s,!1),r=A.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,A=s.alternate,A===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=A.childLanes,s.lanes=A.lanes,s.child=A.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=A.memoizedProps,s.memoizedState=A.memoizedState,s.updateQueue=A.updateQueue,s.type=A.type,t=A.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Xr(di,di.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ri()>td&&(e.flags|=128,r=!0,rp(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ky(A),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),rp(s,!0),s.tail===null&&s.tailMode==="hidden"&&!A.alternate&&!ci)return Xs(e),null}else 2*Ri()-s.renderingStartTime>td&&n!==1073741824&&(e.flags|=128,r=!0,rp(s,!1),e.lanes=4194304);s.isBackwards?(A.sibling=e.child,e.child=A):(n=s.last,n!==null?n.sibling=A:e.child=A,s.last=A)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ri(),e.sibling=null,n=di.current,Xr(di,r?n&1|2:n&1),e):(Xs(e),null);case 22:case 23:return pT(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Sa&1073741824&&(Xs(e),e.subtreeFlags&6&&(e.flags|=8192)):Xs(e),null;case 24:return null;case 25:return null}throw Error(Bt(156,e.tag))}function AV(t,e){switch(ZE(e),e.tag){case 1:return na(e.type)&&Hy(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return J0(),si(ta),si(co),iT(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return rT(e),null;case 13:if(si(di),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Bt(340));X0()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return si(di),null;case 4:return J0(),null;case 10:return JE(e.type._context),null;case 22:case 23:return pT(),null;case 24:return null;default:return null}}var a1=!1,lo=!1,uV=typeof WeakSet=="function"?WeakSet:Set,cn=null;function d0(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ei(t,e,r)}else n.current=null}function Gb(t,e,n){try{n()}catch(r){Ei(t,e,r)}}var zM=!1;function cV(t,e){if(Tb=Vy,t=gL(),QE(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var A=0,o=-1,g=-1,w=0,C=0,I=t,k=null;t:for(;;){for(var U;I!==n||i!==0&&I.nodeType!==3||(o=A+i),I!==s||r!==0&&I.nodeType!==3||(g=A+r),I.nodeType===3&&(A+=I.nodeValue.length),(U=I.firstChild)!==null;)k=I,I=U;for(;;){if(I===t)break t;if(k===n&&++w===i&&(o=A),k===s&&++C===r&&(g=A),(U=I.nextSibling)!==null)break;I=k,k=I.parentNode}I=U}n=o===-1||g===-1?null:{start:o,end:g}}else n=null}n=n||{start:0,end:0}}else n=null;for(Sb={focusedElem:t,selectionRange:n},Vy=!1,cn=e;cn!==null;)if(e=cn,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,cn=t;else for(;cn!==null;){e=cn;try{var H=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(H!==null){var q=H.memoizedProps,se=H.memoizedState,X=e.stateNode,te=X.getSnapshotBeforeUpdate(e.elementType===e.type?q:Ul(e.type,q),se);X.__reactInternalSnapshotBeforeUpdate=te}break;case 3:var ie=e.stateNode.containerInfo;ie.nodeType===1?ie.textContent="":ie.nodeType===9&&ie.documentElement&&ie.removeChild(ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Bt(163))}}catch(fe){Ei(e,e.return,fe)}if(t=e.sibling,t!==null){t.return=e.return,cn=t;break}cn=e.return}return H=zM,zM=!1,H}function qp(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Gb(e,n,s)}i=i.next}while(i!==r)}}function L2(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function $b(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function fD(t){var e=t.alternate;e!==null&&(t.alternate=null,fD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[PA],delete e[pg],delete e[Pb],delete e[QU],delete e[qU])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function dD(t){return t.tag===5||t.tag===3||t.tag===4}function OM(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||dD(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function jb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=jy));else if(r!==4&&(t=t.child,t!==null))for(jb(t,e,n),t=t.sibling;t!==null;)jb(t,e,n),t=t.sibling}function Hb(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Hb(t,e,n),t=t.sibling;t!==null;)Hb(t,e,n),t=t.sibling}var Is=null,Vl=!1;function Tc(t,e,n){for(n=n.child;n!==null;)pD(t,e,n),n=n.sibling}function pD(t,e,n){if(RA&&typeof RA.onCommitFiberUnmount=="function")try{RA.onCommitFiberUnmount(E2,n)}catch{}switch(n.tag){case 5:lo||d0(n,e);case 6:var r=Is,i=Vl;Is=null,Tc(t,e,n),Is=r,Vl=i,Is!==null&&(Vl?(t=Is,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Is.removeChild(n.stateNode));break;case 18:Is!==null&&(Vl?(t=Is,n=n.stateNode,t.nodeType===8?Sx(t.parentNode,n):t.nodeType===1&&Sx(t,n),ug(t)):Sx(Is,n.stateNode));break;case 4:r=Is,i=Vl,Is=n.stateNode.containerInfo,Vl=!0,Tc(t,e,n),Is=r,Vl=i;break;case 0:case 11:case 14:case 15:if(!lo&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,A=s.destroy;s=s.tag,A!==void 0&&(s&2||s&4)&&Gb(n,e,A),i=i.next}while(i!==r)}Tc(t,e,n);break;case 1:if(!lo&&(d0(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ei(n,e,o)}Tc(t,e,n);break;case 21:Tc(t,e,n);break;case 22:n.mode&1?(lo=(r=lo)||n.memoizedState!==null,Tc(t,e,n),lo=r):Tc(t,e,n);break;default:Tc(t,e,n)}}function FM(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new uV),e.forEach(function(r){var i=vV.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Nl(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,A=e,o=A;e:for(;o!==null;){switch(o.tag){case 5:Is=o.stateNode,Vl=!1;break e;case 3:Is=o.stateNode.containerInfo,Vl=!0;break e;case 4:Is=o.stateNode.containerInfo,Vl=!0;break e}o=o.return}if(Is===null)throw Error(Bt(160));pD(s,A,i),Is=null,Vl=!1;var g=i.alternate;g!==null&&(g.return=null),i.return=null}catch(w){Ei(i,e,w)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gD(e,t),e=e.sibling}function gD(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Nl(e,t),xA(t),r&4){try{qp(3,t,t.return),L2(3,t)}catch(q){Ei(t,t.return,q)}try{qp(5,t,t.return)}catch(q){Ei(t,t.return,q)}}break;case 1:Nl(e,t),xA(t),r&512&&n!==null&&d0(n,n.return);break;case 5:if(Nl(e,t),xA(t),r&512&&n!==null&&d0(n,n.return),t.flags&32){var i=t.stateNode;try{og(i,"")}catch(q){Ei(t,t.return,q)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,A=n!==null?n.memoizedProps:s,o=t.type,g=t.updateQueue;if(t.updateQueue=null,g!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&O8(i,s),pb(o,A);var w=pb(o,s);for(A=0;A<g.length;A+=2){var C=g[A],I=g[A+1];C==="style"?G8(i,I):C==="dangerouslySetInnerHTML"?U8(i,I):C==="children"?og(i,I):RE(i,C,I,w)}switch(o){case"input":ub(i,s);break;case"textarea":F8(i,s);break;case"select":var k=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var U=s.value;U!=null?L0(i,!!s.multiple,U,!1):k!==!!s.multiple&&(s.defaultValue!=null?L0(i,!!s.multiple,s.defaultValue,!0):L0(i,!!s.multiple,s.multiple?[]:"",!1))}i[pg]=s}catch(q){Ei(t,t.return,q)}}break;case 6:if(Nl(e,t),xA(t),r&4){if(t.stateNode===null)throw Error(Bt(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(q){Ei(t,t.return,q)}}break;case 3:if(Nl(e,t),xA(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ug(e.containerInfo)}catch(q){Ei(t,t.return,q)}break;case 4:Nl(e,t),xA(t);break;case 13:Nl(e,t),xA(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(fT=Ri())),r&4&&FM(t);break;case 22:if(C=n!==null&&n.memoizedState!==null,t.mode&1?(lo=(w=lo)||C,Nl(e,t),lo=w):Nl(e,t),xA(t),r&8192){if(w=t.memoizedState!==null,(t.stateNode.isHidden=w)&&!C&&t.mode&1)for(cn=t,C=t.child;C!==null;){for(I=cn=C;cn!==null;){switch(k=cn,U=k.child,k.tag){case 0:case 11:case 14:case 15:qp(4,k,k.return);break;case 1:d0(k,k.return);var H=k.stateNode;if(typeof H.componentWillUnmount=="function"){r=k,n=k.return;try{e=r,H.props=e.memoizedProps,H.state=e.memoizedState,H.componentWillUnmount()}catch(q){Ei(r,n,q)}}break;case 5:d0(k,k.return);break;case 22:if(k.memoizedState!==null){UM(I);continue}}U!==null?(U.return=k,cn=U):UM(I)}C=C.sibling}e:for(C=null,I=t;;){if(I.tag===5){if(C===null){C=I;try{i=I.stateNode,w?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=I.stateNode,g=I.memoizedProps.style,A=g!=null&&g.hasOwnProperty("display")?g.display:null,o.style.display=V8("display",A))}catch(q){Ei(t,t.return,q)}}}else if(I.tag===6){if(C===null)try{I.stateNode.nodeValue=w?"":I.memoizedProps}catch(q){Ei(t,t.return,q)}}else if((I.tag!==22&&I.tag!==23||I.memoizedState===null||I===t)&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===t)break e;for(;I.sibling===null;){if(I.return===null||I.return===t)break e;C===I&&(C=null),I=I.return}C===I&&(C=null),I.sibling.return=I.return,I=I.sibling}}break;case 19:Nl(e,t),xA(t),r&4&&FM(t);break;case 21:break;default:Nl(e,t),xA(t)}}function xA(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(dD(n)){var r=n;break e}n=n.return}throw Error(Bt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(og(i,""),r.flags&=-33);var s=OM(t);Hb(t,s,i);break;case 3:case 4:var A=r.stateNode.containerInfo,o=OM(t);jb(t,o,A);break;default:throw Error(Bt(161))}}catch(g){Ei(t,t.return,g)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hV(t,e,n){cn=t,mD(t)}function mD(t,e,n){for(var r=(t.mode&1)!==0;cn!==null;){var i=cn,s=i.child;if(i.tag===22&&r){var A=i.memoizedState!==null||a1;if(!A){var o=i.alternate,g=o!==null&&o.memoizedState!==null||lo;o=a1;var w=lo;if(a1=A,(lo=g)&&!w)for(cn=i;cn!==null;)A=cn,g=A.child,A.tag===22&&A.memoizedState!==null?VM(i):g!==null?(g.return=A,cn=g):VM(i);for(;s!==null;)cn=s,mD(s),s=s.sibling;cn=i,a1=o,lo=w}NM(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,cn=s):NM(t)}}function NM(t){for(;cn!==null;){var e=cn;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:lo||L2(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!lo)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ul(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&wM(e,s,r);break;case 3:var A=e.updateQueue;if(A!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}wM(e,A,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var g=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":g.autoFocus&&n.focus();break;case"img":g.src&&(n.src=g.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var w=e.alternate;if(w!==null){var C=w.memoizedState;if(C!==null){var I=C.dehydrated;I!==null&&ug(I)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Bt(163))}lo||e.flags&512&&$b(e)}catch(k){Ei(e,e.return,k)}}if(e===t){cn=null;break}if(n=e.sibling,n!==null){n.return=e.return,cn=n;break}cn=e.return}}function UM(t){for(;cn!==null;){var e=cn;if(e===t){cn=null;break}var n=e.sibling;if(n!==null){n.return=e.return,cn=n;break}cn=e.return}}function VM(t){for(;cn!==null;){var e=cn;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{L2(4,e)}catch(g){Ei(e,n,g)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(g){Ei(e,i,g)}}var s=e.return;try{$b(e)}catch(g){Ei(e,s,g)}break;case 5:var A=e.return;try{$b(e)}catch(g){Ei(e,A,g)}}}catch(g){Ei(e,e.return,g)}if(e===t){cn=null;break}var o=e.sibling;if(o!==null){o.return=e.return,cn=o;break}cn=e.return}}var fV=Math.ceil,t_=sc.ReactCurrentDispatcher,cT=sc.ReactCurrentOwner,Al=sc.ReactCurrentBatchConfig,xr=0,ys=null,Wi=null,Ls=0,Sa=0,p0=fh(0),es=0,xg=null,Xh=0,D2=0,hT=0,Zp=null,Ko=null,fT=0,td=1/0,Mu=null,n_=!1,Wb=null,Kc=null,l1=!1,Vc=null,r_=0,Yp=0,Qb=null,ay=-1,ly=0;function Do(){return xr&6?Ri():ay!==-1?ay:ay=Ri()}function Jc(t){return t.mode&1?xr&2&&Ls!==0?Ls&-Ls:YU.transition!==null?(ly===0&&(ly=eL()),ly):(t=Lr,t!==0||(t=window.event,t=t===void 0?16:aL(t.type)),t):1}function Kl(t,e,n,r){if(50<Yp)throw Yp=0,Qb=null,Error(Bt(185));Jg(t,n,r),(!(xr&2)||t!==ys)&&(t===ys&&(!(xr&2)&&(D2|=n),es===4&&Fc(t,Ls)),ra(t,r),n===1&&xr===0&&!(e.mode&1)&&(td=Ri()+500,P2&&dh()))}function ra(t,e){var n=t.callbackNode;Y9(t,e);var r=Uy(t,t===ys?Ls:0);if(r===0)n!==null&&Y5(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Y5(n),e===1)t.tag===0?ZU(GM.bind(null,t)):SL(GM.bind(null,t)),HU(function(){!(xr&6)&&dh()}),n=null;else{switch(tL(r)){case 1:n=NE;break;case 4:n=K8;break;case 16:n=Ny;break;case 536870912:n=J8;break;default:n=Ny}n=TD(n,yD.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function yD(t,e){if(ay=-1,ly=0,xr&6)throw Error(Bt(327));var n=t.callbackNode;if(O0()&&t.callbackNode!==n)return null;var r=Uy(t,t===ys?Ls:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=i_(t,r);else{e=r;var i=xr;xr|=2;var s=vD();(ys!==t||Ls!==e)&&(Mu=null,td=Ri()+500,$h(t,e));do try{gV();break}catch(o){_D(t,o)}while(1);KE(),t_.current=s,xr=i,Wi!==null?e=0:(ys=null,Ls=0,e=es)}if(e!==0){if(e===2&&(i=vb(t),i!==0&&(r=i,e=qb(t,i))),e===1)throw n=xg,$h(t,0),Fc(t,r),ra(t,Ri()),n;if(e===6)Fc(t,r);else{if(i=t.current.alternate,!(r&30)&&!dV(i)&&(e=i_(t,r),e===2&&(s=vb(t),s!==0&&(r=s,e=qb(t,s))),e===1))throw n=xg,$h(t,0),Fc(t,r),ra(t,Ri()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Bt(345));case 2:Rh(t,Ko,Mu);break;case 3:if(Fc(t,r),(r&130023424)===r&&(e=fT+500-Ri(),10<e)){if(Uy(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Do(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Cb(Rh.bind(null,t,Ko,Mu),e);break}Rh(t,Ko,Mu);break;case 4:if(Fc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var A=31-Xl(r);s=1<<A,A=e[A],A>i&&(i=A),r&=~s}if(r=i,r=Ri()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*fV(r/1960))-r,10<r){t.timeoutHandle=Cb(Rh.bind(null,t,Ko,Mu),r);break}Rh(t,Ko,Mu);break;case 5:Rh(t,Ko,Mu);break;default:throw Error(Bt(329))}}}return ra(t,Ri()),t.callbackNode===n?yD.bind(null,t):null}function qb(t,e){var n=Zp;return t.current.memoizedState.isDehydrated&&($h(t,e).flags|=256),t=i_(t,e),t!==2&&(e=Ko,Ko=n,e!==null&&Zb(e)),t}function Zb(t){Ko===null?Ko=t:Ko.push.apply(Ko,t)}function dV(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!eA(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Fc(t,e){for(e&=~hT,e&=~D2,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Xl(e),r=1<<n;t[n]=-1,e&=~r}}function GM(t){if(xr&6)throw Error(Bt(327));O0();var e=Uy(t,0);if(!(e&1))return ra(t,Ri()),null;var n=i_(t,e);if(t.tag!==0&&n===2){var r=vb(t);r!==0&&(e=r,n=qb(t,r))}if(n===1)throw n=xg,$h(t,0),Fc(t,e),ra(t,Ri()),n;if(n===6)throw Error(Bt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Rh(t,Ko,Mu),ra(t,Ri()),null}function dT(t,e){var n=xr;xr|=1;try{return t(e)}finally{xr=n,xr===0&&(td=Ri()+500,P2&&dh())}}function Kh(t){Vc!==null&&Vc.tag===0&&!(xr&6)&&O0();var e=xr;xr|=1;var n=Al.transition,r=Lr;try{if(Al.transition=null,Lr=1,t)return t()}finally{Lr=r,Al.transition=n,xr=e,!(xr&6)&&dh()}}function pT(){Sa=p0.current,si(p0)}function $h(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,jU(n)),Wi!==null)for(n=Wi.return;n!==null;){var r=n;switch(ZE(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Hy();break;case 3:J0(),si(ta),si(co),iT();break;case 5:rT(r);break;case 4:J0();break;case 13:si(di);break;case 19:si(di);break;case 10:JE(r.type._context);break;case 22:case 23:pT()}n=n.return}if(ys=t,Wi=t=eh(t.current,null),Ls=Sa=e,es=0,xg=null,hT=D2=Xh=0,Ko=Zp=null,Nh!==null){for(e=0;e<Nh.length;e++)if(n=Nh[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var A=s.next;s.next=i,r.next=A}n.pending=r}Nh=null}return t}function _D(t,e){do{var n=Wi;try{if(KE(),iy.current=e_,Jy){for(var r=gi.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Jy=!1}if(Yh=0,gs=Ji=gi=null,Qp=!1,yg=0,cT.current=null,n===null||n.return===null){es=1,xg=e,Wi=null;break}e:{var s=t,A=n.return,o=n,g=e;if(e=Ls,o.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){var w=g,C=o,I=C.tag;if(!(C.mode&1)&&(I===0||I===11||I===15)){var k=C.alternate;k?(C.updateQueue=k.updateQueue,C.memoizedState=k.memoizedState,C.lanes=k.lanes):(C.updateQueue=null,C.memoizedState=null)}var U=PM(A);if(U!==null){U.flags&=-257,IM(U,A,o,s,e),U.mode&1&&CM(s,w,e),e=U,g=w;var H=e.updateQueue;if(H===null){var q=new Set;q.add(g),e.updateQueue=q}else H.add(g);break e}else{if(!(e&1)){CM(s,w,e),gT();break e}g=Error(Bt(426))}}else if(ci&&o.mode&1){var se=PM(A);if(se!==null){!(se.flags&65536)&&(se.flags|=256),IM(se,A,o,s,e),YE(ed(g,o));break e}}s=g=ed(g,o),es!==4&&(es=2),Zp===null?Zp=[s]:Zp.push(s),s=A;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var X=nD(s,g,e);xM(s,X);break e;case 1:o=g;var te=s.type,ie=s.stateNode;if(!(s.flags&128)&&(typeof te.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(Kc===null||!Kc.has(ie)))){s.flags|=65536,e&=-e,s.lanes|=e;var fe=rD(s,o,e);xM(s,fe);break e}}s=s.return}while(s!==null)}wD(n)}catch(me){e=me,Wi===n&&n!==null&&(Wi=n=n.return);continue}break}while(1)}function vD(){var t=t_.current;return t_.current=e_,t===null?e_:t}function gT(){(es===0||es===3||es===2)&&(es=4),ys===null||!(Xh&268435455)&&!(D2&268435455)||Fc(ys,Ls)}function i_(t,e){var n=xr;xr|=2;var r=vD();(ys!==t||Ls!==e)&&(Mu=null,$h(t,e));do try{pV();break}catch(i){_D(t,i)}while(1);if(KE(),xr=n,t_.current=r,Wi!==null)throw Error(Bt(261));return ys=null,Ls=0,es}function pV(){for(;Wi!==null;)xD(Wi)}function gV(){for(;Wi!==null&&!V9();)xD(Wi)}function xD(t){var e=ED(t.alternate,t,Sa);t.memoizedProps=t.pendingProps,e===null?wD(t):Wi=e,cT.current=null}function wD(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=AV(n,e),n!==null){n.flags&=32767,Wi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{es=6,Wi=null;return}}else if(n=lV(n,e,Sa),n!==null){Wi=n;return}if(e=e.sibling,e!==null){Wi=e;return}Wi=e=t}while(e!==null);es===0&&(es=5)}function Rh(t,e,n){var r=Lr,i=Al.transition;try{Al.transition=null,Lr=1,mV(t,e,n,r)}finally{Al.transition=i,Lr=r}return null}function mV(t,e,n,r){do O0();while(Vc!==null);if(xr&6)throw Error(Bt(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Bt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(X9(t,s),t===ys&&(Wi=ys=null,Ls=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||l1||(l1=!0,TD(Ny,function(){return O0(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Al.transition,Al.transition=null;var A=Lr;Lr=1;var o=xr;xr|=4,cT.current=null,cV(t,n),gD(n,t),OU(Sb),Vy=!!Tb,Sb=Tb=null,t.current=n,hV(n),G9(),xr=o,Lr=A,Al.transition=s}else t.current=n;if(l1&&(l1=!1,Vc=t,r_=i),s=t.pendingLanes,s===0&&(Kc=null),H9(n.stateNode),ra(t,Ri()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(n_)throw n_=!1,t=Wb,Wb=null,t;return r_&1&&t.tag!==0&&O0(),s=t.pendingLanes,s&1?t===Qb?Yp++:(Yp=0,Qb=t):Yp=0,dh(),null}function O0(){if(Vc!==null){var t=tL(r_),e=Al.transition,n=Lr;try{if(Al.transition=null,Lr=16>t?16:t,Vc===null)var r=!1;else{if(t=Vc,Vc=null,r_=0,xr&6)throw Error(Bt(331));var i=xr;for(xr|=4,cn=t.current;cn!==null;){var s=cn,A=s.child;if(cn.flags&16){var o=s.deletions;if(o!==null){for(var g=0;g<o.length;g++){var w=o[g];for(cn=w;cn!==null;){var C=cn;switch(C.tag){case 0:case 11:case 15:qp(8,C,s)}var I=C.child;if(I!==null)I.return=C,cn=I;else for(;cn!==null;){C=cn;var k=C.sibling,U=C.return;if(fD(C),C===w){cn=null;break}if(k!==null){k.return=U,cn=k;break}cn=U}}}var H=s.alternate;if(H!==null){var q=H.child;if(q!==null){H.child=null;do{var se=q.sibling;q.sibling=null,q=se}while(q!==null)}}cn=s}}if(s.subtreeFlags&2064&&A!==null)A.return=s,cn=A;else e:for(;cn!==null;){if(s=cn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:qp(9,s,s.return)}var X=s.sibling;if(X!==null){X.return=s.return,cn=X;break e}cn=s.return}}var te=t.current;for(cn=te;cn!==null;){A=cn;var ie=A.child;if(A.subtreeFlags&2064&&ie!==null)ie.return=A,cn=ie;else e:for(A=te;cn!==null;){if(o=cn,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:L2(9,o)}}catch(me){Ei(o,o.return,me)}if(o===A){cn=null;break e}var fe=o.sibling;if(fe!==null){fe.return=o.return,cn=fe;break e}cn=o.return}}if(xr=i,dh(),RA&&typeof RA.onPostCommitFiberRoot=="function")try{RA.onPostCommitFiberRoot(E2,t)}catch{}r=!0}return r}finally{Lr=n,Al.transition=e}}return!1}function $M(t,e,n){e=ed(n,e),e=nD(t,e,1),t=Xc(t,e,1),e=Do(),t!==null&&(Jg(t,1,e),ra(t,e))}function Ei(t,e,n){if(t.tag===3)$M(t,t,n);else for(;e!==null;){if(e.tag===3){$M(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Kc===null||!Kc.has(r))){t=ed(n,t),t=rD(e,t,1),e=Xc(e,t,1),t=Do(),e!==null&&(Jg(e,1,t),ra(e,t));break}}e=e.return}}function yV(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Do(),t.pingedLanes|=t.suspendedLanes&n,ys===t&&(Ls&n)===n&&(es===4||es===3&&(Ls&130023424)===Ls&&500>Ri()-fT?$h(t,0):hT|=n),ra(t,e)}function bD(t,e){e===0&&(t.mode&1?(e=Km,Km<<=1,!(Km&130023424)&&(Km=4194304)):e=1);var n=Do();t=Wu(t,e),t!==null&&(Jg(t,e,n),ra(t,n))}function _V(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),bD(t,n)}function vV(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Bt(314))}r!==null&&r.delete(e),bD(t,n)}var ED;ED=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ta.current)Jo=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Jo=!1,aV(t,e,n);Jo=!!(t.flags&131072)}else Jo=!1,ci&&e.flags&1048576&&ML(e,qy,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;oy(t,e),t=e.pendingProps;var i=Y0(e,co.current);z0(e,n),i=oT(null,e,r,t,i,n);var s=aT();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,na(r)?(s=!0,Wy(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,tT(e),i.updater=I2,e.stateNode=i,i._reactInternals=e,Bb(e,r,t,n),e=Fb(null,e,r,!0,s,n)):(e.tag=0,ci&&s&&qE(e),Co(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(oy(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=wV(r),t=Ul(r,t),i){case 0:e=Ob(null,e,r,t,n);break e;case 1:e=DM(null,e,r,t,n);break e;case 11:e=kM(null,e,r,t,n);break e;case 14:e=LM(null,e,r,Ul(r.type,t),n);break e}throw Error(Bt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ul(r,i),Ob(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ul(r,i),DM(t,e,r,i,n);case 3:e:{if(aD(e),t===null)throw Error(Bt(387));r=e.pendingProps,s=e.memoizedState,i=s.element,kL(t,e),Xy(e,r,null,n);var A=e.memoizedState;if(r=A.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=ed(Error(Bt(423)),e),e=RM(t,e,r,n,i);break e}else if(r!==i){i=ed(Error(Bt(424)),e),e=RM(t,e,r,n,i);break e}else for(Pa=Yc(e.stateNode.containerInfo.firstChild),ka=e,ci=!0,Gl=null,n=BL(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(X0(),r===i){e=Qu(t,e,n);break e}Co(t,e,r,n)}e=e.child}return e;case 5:return zL(e),t===null&&Lb(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,A=i.children,Mb(r,i)?A=null:s!==null&&Mb(r,s)&&(e.flags|=32),oD(t,e),Co(t,e,A,n),e.child;case 6:return t===null&&Lb(e),null;case 13:return lD(t,e,n);case 4:return nT(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=K0(e,null,r,n):Co(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ul(r,i),kM(t,e,r,i,n);case 7:return Co(t,e,e.pendingProps,n),e.child;case 8:return Co(t,e,e.pendingProps.children,n),e.child;case 12:return Co(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,A=i.value,Xr(Zy,r._currentValue),r._currentValue=A,s!==null)if(eA(s.value,A)){if(s.children===i.children&&!ta.current){e=Qu(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){A=s.child;for(var g=o.firstContext;g!==null;){if(g.context===r){if(s.tag===1){g=Nu(-1,n&-n),g.tag=2;var w=s.updateQueue;if(w!==null){w=w.shared;var C=w.pending;C===null?g.next=g:(g.next=C.next,C.next=g),w.pending=g}}s.lanes|=n,g=s.alternate,g!==null&&(g.lanes|=n),Db(s.return,n,e),o.lanes|=n;break}g=g.next}}else if(s.tag===10)A=s.type===e.type?null:s.child;else if(s.tag===18){if(A=s.return,A===null)throw Error(Bt(341));A.lanes|=n,o=A.alternate,o!==null&&(o.lanes|=n),Db(A,n,e),A=s.sibling}else A=s.child;if(A!==null)A.return=s;else for(A=s;A!==null;){if(A===e){A=null;break}if(s=A.sibling,s!==null){s.return=A.return,A=s;break}A=A.return}s=A}Co(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,z0(e,n),i=dl(i),r=r(i),e.flags|=1,Co(t,e,r,n),e.child;case 14:return r=e.type,i=Ul(r,e.pendingProps),i=Ul(r.type,i),LM(t,e,r,i,n);case 15:return iD(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ul(r,i),oy(t,e),e.tag=1,na(r)?(t=!0,Wy(e)):t=!1,z0(e,n),DL(e,r,i),Bb(e,r,i,n),Fb(null,e,r,!0,t,n);case 19:return AD(t,e,n);case 22:return sD(t,e,n)}throw Error(Bt(156,e.tag))};function TD(t,e){return X8(t,e)}function xV(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function al(t,e,n,r){return new xV(t,e,n,r)}function mT(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wV(t){if(typeof t=="function")return mT(t)?1:0;if(t!=null){if(t=t.$$typeof,t===zE)return 11;if(t===OE)return 14}return 2}function eh(t,e){var n=t.alternate;return n===null?(n=al(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ay(t,e,n,r,i,s){var A=2;if(r=t,typeof t=="function")mT(t)&&(A=1);else if(typeof t=="string")A=5;else e:switch(t){case s0:return jh(n.children,i,s,e);case BE:A=8,i|=8;break;case sb:return t=al(12,n,e,i|2),t.elementType=sb,t.lanes=s,t;case ob:return t=al(13,n,e,i),t.elementType=ob,t.lanes=s,t;case ab:return t=al(19,n,e,i),t.elementType=ab,t.lanes=s,t;case R8:return R2(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case L8:A=10;break e;case D8:A=9;break e;case zE:A=11;break e;case OE:A=14;break e;case Rc:A=16,r=null;break e}throw Error(Bt(130,t==null?t:typeof t,""))}return e=al(A,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function jh(t,e,n,r){return t=al(7,t,r,e),t.lanes=n,t}function R2(t,e,n,r){return t=al(22,t,r,e),t.elementType=R8,t.lanes=n,t.stateNode={isHidden:!1},t}function Rx(t,e,n){return t=al(6,t,null,e),t.lanes=n,t}function Bx(t,e,n){return e=al(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function bV(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=px(0),this.expirationTimes=px(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=px(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function yT(t,e,n,r,i,s,A,o,g){return t=new bV(t,e,n,o,g),e===1?(e=1,s===!0&&(e|=8)):e=0,s=al(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},tT(s),t}function EV(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i0,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function SD(t){if(!t)return ah;t=t._reactInternals;e:{if(mf(t)!==t||t.tag!==1)throw Error(Bt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(na(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Bt(171))}if(t.tag===1){var n=t.type;if(na(n))return TL(t,n,e)}return e}function MD(t,e,n,r,i,s,A,o,g){return t=yT(n,r,!0,t,i,s,A,o,g),t.context=SD(null),n=t.current,r=Do(),i=Jc(n),s=Nu(r,i),s.callback=e??null,Xc(n,s,i),t.current.lanes=i,Jg(t,i,r),ra(t,r),t}function B2(t,e,n,r){var i=e.current,s=Do(),A=Jc(i);return n=SD(n),e.context===null?e.context=n:e.pendingContext=n,e=Nu(s,A),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xc(i,e,A),t!==null&&(Kl(t,i,A,s),ry(t,i,A)),A}function s_(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function jM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function _T(t,e){jM(t,e),(t=t.alternate)&&jM(t,e)}function TV(){return null}var CD=typeof reportError=="function"?reportError:function(t){console.error(t)};function vT(t){this._internalRoot=t}z2.prototype.render=vT.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Bt(409));B2(t,e,null,null)};z2.prototype.unmount=vT.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Kh(function(){B2(null,t,null,null)}),e[Hu]=null}};function z2(t){this._internalRoot=t}z2.prototype.unstable_scheduleHydration=function(t){if(t){var e=iL();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Oc.length&&e!==0&&e<Oc[n].priority;n++);Oc.splice(n,0,t),n===0&&oL(t)}};function xT(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function O2(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function HM(){}function SV(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var w=s_(A);s.call(w)}}var A=MD(e,r,t,0,null,!1,!1,"",HM);return t._reactRootContainer=A,t[Hu]=A.current,fg(t.nodeType===8?t.parentNode:t),Kh(),A}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var w=s_(g);o.call(w)}}var g=yT(t,0,!1,null,null,!1,!1,"",HM);return t._reactRootContainer=g,t[Hu]=g.current,fg(t.nodeType===8?t.parentNode:t),Kh(function(){B2(e,g,n,r)}),g}function F2(t,e,n,r,i){var s=n._reactRootContainer;if(s){var A=s;if(typeof i=="function"){var o=i;i=function(){var g=s_(A);o.call(g)}}B2(e,A,t,i)}else A=SV(n,e,t,i,r);return s_(A)}nL=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ip(e.pendingLanes);n!==0&&(UE(e,n|1),ra(e,Ri()),!(xr&6)&&(td=Ri()+500,dh()))}break;case 13:Kh(function(){var r=Wu(t,1);if(r!==null){var i=Do();Kl(r,t,1,i)}}),_T(t,1)}};VE=function(t){if(t.tag===13){var e=Wu(t,134217728);if(e!==null){var n=Do();Kl(e,t,134217728,n)}_T(t,134217728)}};rL=function(t){if(t.tag===13){var e=Jc(t),n=Wu(t,e);if(n!==null){var r=Do();Kl(n,t,e,r)}_T(t,e)}};iL=function(){return Lr};sL=function(t,e){var n=Lr;try{return Lr=t,e()}finally{Lr=n}};mb=function(t,e,n){switch(e){case"input":if(ub(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=C2(r);if(!i)throw Error(Bt(90));z8(r),ub(r,i)}}}break;case"textarea":F8(t,n);break;case"select":e=n.value,e!=null&&L0(t,!!n.multiple,e,!1)}};H8=dT;W8=Kh;var MV={usingClientEntryPoint:!1,Events:[tm,A0,C2,$8,j8,dT]},ip={findFiberByHostInstance:Fh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},CV={bundleType:ip.bundleType,version:ip.version,rendererPackageName:ip.rendererPackageName,rendererConfig:ip.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Z8(t),t===null?null:t.stateNode},findFiberByHostInstance:ip.findFiberByHostInstance||TV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var A1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!A1.isDisabled&&A1.supportsFiber)try{E2=A1.inject(CV),RA=A1}catch{}}Ra.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MV;Ra.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xT(e))throw Error(Bt(200));return EV(t,e,null,n)};Ra.createRoot=function(t,e){if(!xT(t))throw Error(Bt(299));var n=!1,r="",i=CD;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=yT(t,1,!1,null,null,n,!1,r,i),t[Hu]=e.current,fg(t.nodeType===8?t.parentNode:t),new vT(e)};Ra.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Bt(188)):(t=Object.keys(t).join(","),Error(Bt(268,t)));return t=Z8(e),t=t===null?null:t.stateNode,t};Ra.flushSync=function(t){return Kh(t)};Ra.hydrate=function(t,e,n){if(!O2(e))throw Error(Bt(200));return F2(null,t,e,!0,n)};Ra.hydrateRoot=function(t,e,n){if(!xT(t))throw Error(Bt(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",A=CD;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(A=n.onRecoverableError)),e=MD(e,null,t,1,n??null,i,!1,s,A),t[Hu]=e.current,fg(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new z2(e)};Ra.render=function(t,e,n){if(!O2(e))throw Error(Bt(200));return F2(null,t,e,!1,n)};Ra.unmountComponentAtNode=function(t){if(!O2(t))throw Error(Bt(40));return t._reactRootContainer?(Kh(function(){F2(null,null,t,!1,function(){t._reactRootContainer=null,t[Hu]=null})}),!0):!1};Ra.unstable_batchedUpdates=dT;Ra.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!O2(n))throw Error(Bt(200));if(t==null||t._reactInternals===void 0)throw Error(Bt(38));return F2(t,e,n,!1,r)};Ra.version="18.2.0-next-9e3b772b8-20220608";function PD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(PD)}catch(t){console.error(t)}}PD(),M8.exports=Ra;var wT=M8.exports,ID,WM=wT;ID=WM.createRoot,WM.hydrateRoot;/**
 * @remix-run/router v1.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wg(){return wg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wg.apply(this,arguments)}var Gc;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Gc||(Gc={}));const QM="popstate";function PV(t){t===void 0&&(t={});function e(i,s){let{pathname:A="/",search:o="",hash:g=""}=yf(i.location.hash.substr(1));return!A.startsWith("/")&&!A.startsWith(".")&&(A="/"+A),Yb("",{pathname:A,search:o,hash:g},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(i,s){let A=i.document.querySelector("base"),o="";if(A&&A.getAttribute("href")){let g=i.location.href,w=g.indexOf("#");o=w===-1?g:g.slice(0,w)}return o+"#"+(typeof s=="string"?s:o_(s))}function r(i,s){N2(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(s)+")")}return kV(e,n,r,t)}function Qi(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function N2(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function IV(){return Math.random().toString(36).substr(2,8)}function qM(t,e){return{usr:t.state,key:t.key,idx:e}}function Yb(t,e,n,r){return n===void 0&&(n=null),wg({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?yf(e):e,{state:n,key:e&&e.key||r||IV()})}function o_(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function yf(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function kV(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,A=i.history,o=Gc.Pop,g=null,w=C();w==null&&(w=0,A.replaceState(wg({},A.state,{idx:w}),""));function C(){return(A.state||{idx:null}).idx}function I(){o=Gc.Pop;let se=C(),X=se==null?null:se-w;w=se,g&&g({action:o,location:q.location,delta:X})}function k(se,X){o=Gc.Push;let te=Yb(q.location,se,X);n&&n(te,se),w=C()+1;let ie=qM(te,w),fe=q.createHref(te);try{A.pushState(ie,"",fe)}catch(me){if(me instanceof DOMException&&me.name==="DataCloneError")throw me;i.location.assign(fe)}s&&g&&g({action:o,location:q.location,delta:1})}function U(se,X){o=Gc.Replace;let te=Yb(q.location,se,X);n&&n(te,se),w=C();let ie=qM(te,w),fe=q.createHref(te);A.replaceState(ie,"",fe),s&&g&&g({action:o,location:q.location,delta:0})}function H(se){let X=i.location.origin!=="null"?i.location.origin:i.location.href,te=typeof se=="string"?se:o_(se);return Qi(X,"No window.location.(origin|href) available to create URL for href: "+te),new URL(te,X)}let q={get action(){return o},get location(){return t(i,A)},listen(se){if(g)throw new Error("A history only accepts one active listener");return i.addEventListener(QM,I),g=se,()=>{i.removeEventListener(QM,I),g=null}},createHref(se){return e(i,se)},createURL:H,encodeLocation(se){let X=H(se);return{pathname:X.pathname,search:X.search,hash:X.hash}},push:k,replace:U,go(se){return A.go(se)}};return q}var ZM;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ZM||(ZM={}));function LV(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?yf(e):e,i=bT(r.pathname||"/",n);if(i==null)return null;let s=kD(t);DV(s);let A=null;for(let o=0;A==null&&o<s.length;++o)A=GV(s[o],HV(i));return A}function kD(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,A,o)=>{let g={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:A,route:s};g.relativePath.startsWith("/")&&(Qi(g.relativePath.startsWith(r),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(r.length));let w=th([r,g.relativePath]),C=n.concat(g);s.children&&s.children.length>0&&(Qi(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+w+'".')),kD(s.children,e,C,w)),!(s.path==null&&!s.index)&&e.push({path:w,score:UV(w,s.index),routesMeta:C})};return t.forEach((s,A)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,A);else for(let g of LD(s.path))i(s,A,g)}),e}function LD(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let A=LD(r.join("/")),o=[];return o.push(...A.map(g=>g===""?s:[s,g].join("/"))),i&&o.push(...A),o.map(g=>t.startsWith("/")&&g===""?"/":g)}function DV(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:VV(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const RV=/^:[\w-]+$/,BV=3,zV=2,OV=1,FV=10,NV=-2,YM=t=>t==="*";function UV(t,e){let n=t.split("/"),r=n.length;return n.some(YM)&&(r+=NV),e&&(r+=zV),n.filter(i=>!YM(i)).reduce((i,s)=>i+(RV.test(s)?BV:s===""?OV:FV),r)}function VV(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function GV(t,e){let{routesMeta:n}=t,r={},i="/",s=[];for(let A=0;A<n.length;++A){let o=n[A],g=A===n.length-1,w=i==="/"?e:e.slice(i.length)||"/",C=$V({path:o.relativePath,caseSensitive:o.caseSensitive,end:g},w);if(!C)return null;Object.assign(r,C.params);let I=o.route;s.push({params:r,pathname:th([i,C.pathname]),pathnameBase:YV(th([i,C.pathnameBase])),route:I}),C.pathnameBase!=="/"&&(i=th([i,C.pathnameBase]))}return s}function $V(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=jV(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],A=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((w,C,I)=>{let{paramName:k,isOptional:U}=C;if(k==="*"){let q=o[I]||"";A=s.slice(0,s.length-q.length).replace(/(.)\/+$/,"$1")}const H=o[I];return U&&!H?w[k]=void 0:w[k]=WV(H||"",k),w},{}),pathname:s,pathnameBase:A,pattern:t}}function jV(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),N2(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(A,o,g)=>(r.push({paramName:o,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function HV(t){try{return decodeURI(t)}catch(e){return N2(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function WV(t,e){try{return decodeURIComponent(t)}catch(n){return N2(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function bT(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function QV(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?yf(t):t;return{pathname:n?n.startsWith("/")?n:qV(n,e):e,search:XV(r),hash:KV(i)}}function qV(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function zx(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ZV(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function DD(t,e){let n=ZV(t);return e?n.map((r,i)=>i===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function RD(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=yf(t):(i=wg({},t),Qi(!i.pathname||!i.pathname.includes("?"),zx("?","pathname","search",i)),Qi(!i.pathname||!i.pathname.includes("#"),zx("#","pathname","hash",i)),Qi(!i.search||!i.search.includes("#"),zx("#","search","hash",i)));let s=t===""||i.pathname==="",A=s?"/":i.pathname,o;if(A==null)o=n;else{let I=e.length-1;if(!r&&A.startsWith("..")){let k=A.split("/");for(;k[0]==="..";)k.shift(),I-=1;i.pathname=k.join("/")}o=I>=0?e[I]:"/"}let g=QV(i,o),w=A&&A!=="/"&&A.endsWith("/"),C=(s||A===".")&&n.endsWith("/");return!g.pathname.endsWith("/")&&(w||C)&&(g.pathname+="/"),g}const th=t=>t.join("/").replace(/\/\/+/g,"/"),YV=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),XV=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,KV=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function JV(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const BD=["post","put","patch","delete"];new Set(BD);const eG=["get",...BD];new Set(eG);/**
 * React Router v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bg(){return bg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},bg.apply(this,arguments)}const ET=je.createContext(null),tG=je.createContext(null),_f=je.createContext(null),U2=je.createContext(null),vf=je.createContext({outlet:null,matches:[],isDataRoute:!1}),zD=je.createContext(null);function nG(t,e){let{relative:n}=e===void 0?{}:e;rm()||Qi(!1);let{basename:r,navigator:i}=je.useContext(_f),{hash:s,pathname:A,search:o}=FD(t,{relative:n}),g=A;return r!=="/"&&(g=A==="/"?r:th([r,A])),i.createHref({pathname:g,search:o,hash:s})}function rm(){return je.useContext(U2)!=null}function V2(){return rm()||Qi(!1),je.useContext(U2).location}function OD(t){je.useContext(_f).static||je.useLayoutEffect(t)}function rG(){let{isDataRoute:t}=je.useContext(vf);return t?gG():iG()}function iG(){rm()||Qi(!1);let t=je.useContext(ET),{basename:e,future:n,navigator:r}=je.useContext(_f),{matches:i}=je.useContext(vf),{pathname:s}=V2(),A=JSON.stringify(DD(i,n.v7_relativeSplatPath)),o=je.useRef(!1);return OD(()=>{o.current=!0}),je.useCallback(function(w,C){if(C===void 0&&(C={}),!o.current)return;if(typeof w=="number"){r.go(w);return}let I=RD(w,JSON.parse(A),s,C.relative==="path");t==null&&e!=="/"&&(I.pathname=I.pathname==="/"?e:th([e,I.pathname])),(C.replace?r.replace:r.push)(I,C.state,C)},[e,r,A,s,t])}function FD(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=je.useContext(_f),{matches:i}=je.useContext(vf),{pathname:s}=V2(),A=JSON.stringify(DD(i,r.v7_relativeSplatPath));return je.useMemo(()=>RD(t,JSON.parse(A),s,n==="path"),[t,A,s,n])}function sG(t,e){return oG(t,e)}function oG(t,e,n,r){rm()||Qi(!1);let{navigator:i}=je.useContext(_f),{matches:s}=je.useContext(vf),A=s[s.length-1],o=A?A.params:{};A&&A.pathname;let g=A?A.pathnameBase:"/";A&&A.route;let w=V2(),C;if(e){var I;let se=typeof e=="string"?yf(e):e;g==="/"||(I=se.pathname)!=null&&I.startsWith(g)||Qi(!1),C=se}else C=w;let k=C.pathname||"/",U=g==="/"?k:k.slice(g.length)||"/",H=LV(t,{pathname:U}),q=cG(H&&H.map(se=>Object.assign({},se,{params:Object.assign({},o,se.params),pathname:th([g,i.encodeLocation?i.encodeLocation(se.pathname).pathname:se.pathname]),pathnameBase:se.pathnameBase==="/"?g:th([g,i.encodeLocation?i.encodeLocation(se.pathnameBase).pathname:se.pathnameBase])})),s,n,r);return e&&q?je.createElement(U2.Provider,{value:{location:bg({pathname:"/",search:"",hash:"",state:null,key:"default"},C),navigationType:Gc.Pop}},q):q}function aG(){let t=pG(),e=JV(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return je.createElement(je.Fragment,null,je.createElement("h2",null,"Unexpected Application Error!"),je.createElement("h3",{style:{fontStyle:"italic"}},e),n?je.createElement("pre",{style:i},n):null,s)}const lG=je.createElement(aG,null);class AG extends je.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?je.createElement(vf.Provider,{value:this.props.routeContext},je.createElement(zD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uG(t){let{routeContext:e,match:n,children:r}=t,i=je.useContext(ET);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),je.createElement(vf.Provider,{value:e},r)}function cG(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if((s=n)!=null&&s.errors)t=n.matches;else return null}let A=t,o=(i=n)==null?void 0:i.errors;if(o!=null){let C=A.findIndex(I=>I.route.id&&o?.[I.route.id]);C>=0||Qi(!1),A=A.slice(0,Math.min(A.length,C+1))}let g=!1,w=-1;if(n&&r&&r.v7_partialHydration)for(let C=0;C<A.length;C++){let I=A[C];if((I.route.HydrateFallback||I.route.hydrateFallbackElement)&&(w=C),I.route.id){let{loaderData:k,errors:U}=n,H=I.route.loader&&k[I.route.id]===void 0&&(!U||U[I.route.id]===void 0);if(I.route.lazy||H){g=!0,w>=0?A=A.slice(0,w+1):A=[A[0]];break}}}return A.reduceRight((C,I,k)=>{let U,H=!1,q=null,se=null;n&&(U=o&&I.route.id?o[I.route.id]:void 0,q=I.route.errorElement||lG,g&&(w<0&&k===0?(mG("route-fallback",!1),H=!0,se=null):w===k&&(H=!0,se=I.route.hydrateFallbackElement||null)));let X=e.concat(A.slice(0,k+1)),te=()=>{let ie;return U?ie=q:H?ie=se:I.route.Component?ie=je.createElement(I.route.Component,null):I.route.element?ie=I.route.element:ie=C,je.createElement(uG,{match:I,routeContext:{outlet:C,matches:X,isDataRoute:n!=null},children:ie})};return n&&(I.route.ErrorBoundary||I.route.errorElement||k===0)?je.createElement(AG,{location:n.location,revalidation:n.revalidation,component:q,error:U,children:te(),routeContext:{outlet:null,matches:X,isDataRoute:!0}}):te()},null)}var ND=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(ND||{}),a_=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(a_||{});function hG(t){let e=je.useContext(ET);return e||Qi(!1),e}function fG(t){let e=je.useContext(tG);return e||Qi(!1),e}function dG(t){let e=je.useContext(vf);return e||Qi(!1),e}function UD(t){let e=dG(),n=e.matches[e.matches.length-1];return n.route.id||Qi(!1),n.route.id}function pG(){var t;let e=je.useContext(zD),n=fG(a_.UseRouteError),r=UD(a_.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function gG(){let{router:t}=hG(ND.UseNavigateStable),e=UD(a_.UseNavigateStable),n=je.useRef(!1);return OD(()=>{n.current=!0}),je.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,bg({fromRouteId:e},s)))},[t,e])}const XM={};function mG(t,e,n){!e&&!XM[t]&&(XM[t]=!0)}function Su(t){Qi(!1)}function yG(t){let{basename:e="/",children:n=null,location:r,navigationType:i=Gc.Pop,navigator:s,static:A=!1,future:o}=t;rm()&&Qi(!1);let g=e.replace(/^\/*/,"/"),w=je.useMemo(()=>({basename:g,navigator:s,static:A,future:bg({v7_relativeSplatPath:!1},o)}),[g,o,s,A]);typeof r=="string"&&(r=yf(r));let{pathname:C="/",search:I="",hash:k="",state:U=null,key:H="default"}=r,q=je.useMemo(()=>{let se=bT(C,g);return se==null?null:{location:{pathname:se,search:I,hash:k,state:U,key:H},navigationType:i}},[g,C,I,k,U,H,i]);return q==null?null:je.createElement(_f.Provider,{value:w},je.createElement(U2.Provider,{children:n,value:q}))}function _G(t){let{children:e,location:n}=t;return sG(Xb(e),n)}new Promise(()=>{});function Xb(t,e){e===void 0&&(e=[]);let n=[];return je.Children.forEach(t,(r,i)=>{if(!je.isValidElement(r))return;let s=[...e,i];if(r.type===je.Fragment){n.push.apply(n,Xb(r.props.children,s));return}r.type!==Su&&Qi(!1),!r.props.index||!r.props.children||Qi(!1);let A={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(A.children=Xb(r.props.children,s)),n.push(A)}),n}/**
 * React Router DOM v6.22.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kb(){return Kb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kb.apply(this,arguments)}function vG(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function xG(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function wG(t,e){return t.button===0&&(!e||e==="_self")&&!xG(t)}const bG=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],EG="6";try{window.__reactRouterVersion=EG}catch{}const TG="startTransition",KM=T9[TG];function SG(t){let{basename:e,children:n,future:r,window:i}=t,s=je.useRef();s.current==null&&(s.current=PV({window:i,v5Compat:!0}));let A=s.current,[o,g]=je.useState({action:A.action,location:A.location}),{v7_startTransition:w}=r||{},C=je.useCallback(I=>{w&&KM?KM(()=>g(I)):g(I)},[g,w]);return je.useLayoutEffect(()=>A.listen(C),[A,C]),je.createElement(yG,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:A,future:r})}const MG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",CG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Th=je.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:A,state:o,target:g,to:w,preventScrollReset:C,unstable_viewTransition:I}=e,k=vG(e,bG),{basename:U}=je.useContext(_f),H,q=!1;if(typeof w=="string"&&CG.test(w)&&(H=w,MG))try{let ie=new URL(window.location.href),fe=w.startsWith("//")?new URL(ie.protocol+w):new URL(w),me=bT(fe.pathname,U);fe.origin===ie.origin&&me!=null?w=me+fe.search+fe.hash:q=!0}catch{}let se=nG(w,{relative:i}),X=PG(w,{replace:A,state:o,target:g,preventScrollReset:C,relative:i,unstable_viewTransition:I});function te(ie){r&&r(ie),ie.defaultPrevented||X(ie)}return je.createElement("a",Kb({},k,{href:H||se,onClick:q||s?r:te,ref:n,target:g}))});var JM;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(JM||(JM={}));var eC;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(eC||(eC={}));function PG(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:A,unstable_viewTransition:o}=e===void 0?{}:e,g=rG(),w=V2(),C=FD(t,{relative:A});return je.useCallback(I=>{if(wG(I,n)){I.preventDefault();let k=r!==void 0?r:o_(w)===o_(C);g(t,{replace:k,state:i,preventScrollReset:s,relative:A,unstable_viewTransition:o})}},[w,g,C,r,i,n,t,s,A,o])}function l_(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const TT=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),tC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);tC&&parseFloat(tC[1]);const IG="3.4.14";function qu(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const uy=typeof process!="object"||String(process)!=="[object process]"||process.browser,kG=typeof window<"u"&&typeof window.orientation<"u",nC=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);nC&&parseFloat(nC[1]);function Eg(t){"@babel/helpers - typeof";return Eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eg(t)}function LG(t,e){if(Eg(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Eg(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DG(t){var e=LG(t,"string");return Eg(e)==="symbol"?e:String(e)}function oe(t,e,n){return e=DG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class RG{constructor(e,n){oe(this,"name",void 0),oe(this,"workerThread",void 0),oe(this,"isRunning",!0),oe(this,"result",void 0),oe(this,"_resolve",()=>{}),oe(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){qu(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){qu(this.isRunning),this.isRunning=!1,this._reject(e)}}let Ox=class{terminate(){}};const Fx=new Map;function BG(t){qu(t.source&&!t.url||!t.source&&t.url);let e=Fx.get(t.source||t.url);return e||(t.url&&(e=zG(t.url),Fx.set(t.url,e)),t.source&&(e=VD(t.source),Fx.set(t.source,e))),qu(e),e}function zG(t){if(!t.startsWith("http"))return t;const e=OG(t);return VD(e)}function VD(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function OG(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function GD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(rC(t))r.add(t);else if(rC(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)GD(t[i],e,r)}}return n===void 0?Array.from(r):[]}function rC(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Nx=()=>{};class Jb{static isSupported(){return typeof Worker<"u"&&uy||typeof Ox<"u"&&!uy}constructor(e){oe(this,"name",void 0),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"terminated",!1),oe(this,"worker",void 0),oe(this,"onMessage",void 0),oe(this,"onError",void 0),oe(this,"_loadableURL","");const{name:n,source:r,url:i}=e;qu(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=Nx,this.onError=s=>console.log(s),this.worker=uy?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Nx,this.onError=Nx,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||GD(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=BG({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Ox(r,{eval:!1})}else if(this.source)e=new Ox(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class FG{static isSupported(){return Jb.isSupported()}constructor(e){oe(this,"name","unnamed"),oe(this,"source",void 0),oe(this,"url",void 0),oe(this,"maxConcurrency",1),oe(this,"maxMobileConcurrency",1),oe(this,"onDebug",()=>{}),oe(this,"reuseWorkers",!0),oe(this,"props",{}),oe(this,"jobQueue",[]),oe(this,"idleQueue",[]),oe(this,"count",0),oe(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,A,o)=>s.done(o),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,A)=>s.error(A);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new RG(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Jb({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return kG?this.maxMobileConcurrency:this.maxConcurrency}}const NG={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Pu{static isSupported(){return Jb.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Pu._workerFarm=Pu._workerFarm||new Pu({}),Pu._workerFarm.setProps(e),Pu._workerFarm}constructor(e){oe(this,"props",void 0),oe(this,"workerPools",new Map),this.props={...NG},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new FG({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}oe(Pu,"_workerFarm",void 0);const UG="latest";function VG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=UG);const A=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(A,"/dist/").concat(r)}return qu(i),i}function GG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:IG;qu(t,"no worker provided");const n=t.version;return!(!e||!n)}function $G(t,e){return!Pu.isSupported()||!uy&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&e?.worker}async function jG(t,e,n,r,i){const s=t.id,A=VG(t,n),g=Pu.getWorkerFarm(n).getWorkerPool({name:s,url:A});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const w=await g.startJob("process-on-worker",HG.bind(null,i));return w.postMessage("process",{input:e,options:n,context:r}),await(await w.result).result}async function HG(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:A}=r;try{const o=await t(s,A);e.postMessage("done",{id:i,result:o})}catch(o){const g=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:g})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function WG(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function QG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=r.reduce((o,g)=>o+g.byteLength,0),s=new Uint8Array(i);let A=0;for(const o of r)s.set(o,A),A+=o.byteLength;return s.buffer}async function qG(t){const e=[];for await(const n of t)e.push(n);return QG(...e)}function iC(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let sC=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=iC(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(iC()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},ZG=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof sC?i=e:i=new sC(n,r),this.stats[n]=i),i}};const YG="Queued Requests",XG="Active Requests",KG="Cancelled Requests",JG="Queued Requests Ever",e$="Active Requests Ever",t$={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class n${constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};oe(this,"props",void 0),oe(this,"stats",void 0),oe(this,"activeRequestCount",0),oe(this,"requestQueue",[]),oe(this,"requestMap",new Map),oe(this,"deferredUpdate",null),this.props={...t$,...e},this.stats=new ZG({id:this.props.id}),this.stats.get(YG),this.stats.get(XG),this.stats.get(KG),this.stats.get(JG),this.stats.get(e$)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(s=>(r.resolve=s,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const s=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let r$="";const oC={};function i$(t){for(const e in oC)if(t.startsWith(e)){const n=oC[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(r$).concat(t)),t}function s$(t){return t&&typeof t=="object"&&t.isBuffer}function $D(t){if(s$(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function jD(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function o$(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const a$=t=>typeof t=="boolean",Xp=t=>typeof t=="function",im=t=>t!==null&&typeof t=="object",aC=t=>im(t)&&t.constructor==={}.constructor,l$=t=>t&&typeof t[Symbol.iterator]=="function",A$=t=>t&&typeof t[Symbol.asyncIterator]=="function",xf=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,wf=t=>typeof Blob<"u"&&t instanceof Blob,u$=t=>t&&typeof t=="object"&&t.isBuffer,c$=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||im(t)&&Xp(t.tee)&&Xp(t.cancel)&&Xp(t.getReader),h$=t=>im(t)&&Xp(t.read)&&Xp(t.pipe)&&a$(t.readable),HD=t=>c$(t)||h$(t),f$=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,d$=/^([-\w.]+\/[-\w.+]+)/;function p$(t){const e=d$.exec(t);return e?e[1]:t}function lC(t){const e=f$.exec(t);return e?e[1]:""}const WD=/\?.*/;function g$(t){const e=t.match(WD);return e&&e[0]}function ST(t){return t.replace(WD,"")}function G2(t){return xf(t)?t.url:wf(t)?t.name||"":typeof t=="string"?t:""}function MT(t){if(xf(t)){const e=t,n=e.headers.get("content-type")||"",r=ST(e.url);return p$(n)||lC(r)}return wf(t)?t.type||"":typeof t=="string"?lC(t):""}function m$(t){return xf(t)?t.headers["content-length"]||-1:wf(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function QD(t){if(xf(t))return t;const e={},n=m$(t);n>=0&&(e["content-length"]=String(n));const r=G2(t),i=MT(t);i&&(e["content-type"]=i);const s=await v$(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const A=new Response(t,{headers:e});return Object.defineProperty(A,"url",{value:r}),A}async function y$(t){if(!t.ok){const e=await _$(t);throw new Error(e)}}async function _$(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function v$(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var A;return r(s==null||(A=s.target)===null||A===void 0?void 0:A.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=x$(n);return"data:base64,".concat(r)}return null}function x$(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function AC(t,e){if(typeof t=="string"){t=i$(t);let n=e;return e!=null&&e.fetch&&typeof e?.fetch!="function"&&(n=e.fetch),await fetch(t,n)}return await QD(t)}function w$(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function sm(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||w$()}const u1=globalThis.window||globalThis.self||globalThis.global,sp=globalThis.process||{},qD=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";sm();function b$(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let E$=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=b$(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function T$(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function S$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Ux(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,A=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(A/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(A,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(A,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let A_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(A_||(A_={}));const M$=10;function uC(t){return typeof t!="string"?t:(t=t.toUpperCase(),A_[t]||A_.WHITE)}function C$(t,e,n){if(!sm&&typeof t=="string"){if(e){const r=uC(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=uC(n);t="\x1B[".concat(r+M$,"m").concat(t,"\x1B[49m")}}return t}function P$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const A=i[s];typeof A=="function"&&(e.find(o=>s===o)||(i[s]=A.bind(t)))}}function u_(t,e){if(!t)throw new Error(e||"Assertion failed")}function jf(){let t;if(sm()&&u1.performance){var e,n;t=u1==null||(e=u1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in sp){var r;const i=sp==null||(r=sp.hrtime)===null||r===void 0?void 0:r.call(sp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Hf={debug:sm()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},I$={enabled:!0,level:0};function tl(){}const cC={},hC={once:!0};let CT=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=qD,this._startTs=jf(),this._deltaTs=jf(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new E$("__probe-".concat(this.id,"__"),I$),this.timeStamp("".concat(this.id," started")),P$(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((jf()-this._startTs).toPrecision(10))}getDelta(){return Number((jf()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){u_(e,n)}warn(e){return this._getLogFunction(0,e,Hf.warn,arguments,hC)}error(e){return this._getLogFunction(0,e,Hf.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Hf.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Hf.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,Hf.debug||Hf.info,arguments,hC)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||tl,r&&[r],{tag:R$(n)}):tl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:A=1}=e;return this._shouldLog(n||r)?sm()?D$({image:i,message:s,scale:A}):L$():tl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||tl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=fC({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||tl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=ZD(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=fC({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,u_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=jf();const A=s.tag||s.message;if(s.once&&A)if(!cC[A])cC[A]=jf();else return tl;return n=k$(this.id,s.message,s),r.bind(console,n,...s.args)}return tl}};CT.VERSION=qD;function ZD(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return u_(Number.isFinite(e)&&e>=0),e}function fC(t){const{logLevel:e,message:n}=t;t.logLevel=ZD(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return u_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function k$(t,e,n){if(typeof e=="string"){const r=n.time?S$(T$(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=C$(e,n.color,n.background)}return e}function L$(t){return console.warn("removed"),tl}function D$(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const A=Ux(s,n,r);console.log(...A)},s.src=e,tl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Ux(e,n,r)),tl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Ux(s,n,r)),s.src=e.toDataURL(),tl}return tl}function R$(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const dC=new CT({id:"loaders.gl"});class B${log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class z${constructor(){oe(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const YD={fetch:null,mimeType:void 0,nothrow:!1,log:new z$,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:TT,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},O$={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function XD(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const KD=()=>{const t=XD();return t.globalOptions=t.globalOptions||{...YD},t.globalOptions};function F$(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],N$(t,n),V$(e,t,r)}function N$(t,e){pC(t,null,YD,O$,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};pC(r,n.id,i,s,e)}}function pC(t,e,n,r,i){const s=e||"Top level",A=e?"".concat(e,"."):"";for(const o in t){const g=!e&&im(t[o]),w=o==="baseUri"&&!e,C=o==="workerUrl"&&e;if(!(o in n)&&!w&&!C){if(o in r)dC.warn("".concat(s," loader option '").concat(A).concat(o,"' no longer supported, use '").concat(r[o],"'"))();else if(!g){const I=U$(o,i);dC.warn("".concat(s," loader option '").concat(A).concat(o,"' not recognized. ").concat(I))()}}}}function U$(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const A=s.toLowerCase();(n.startsWith(A)||A.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function V$(t,e,n){const i={...t.options||{}};return G$(i,n),i.log===null&&(i.log=new B$),gC(i,KD()),gC(i,e),i}function gC(t,e){for(const n in e)if(n in e){const r=e[n];aC(r)&&aC(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function G$(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function PT(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function IT(t){var e,n;l_(t,"null loader"),l_(PT(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const JD=()=>{const t=XD();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function $$(t){const e=JD();t=Array.isArray(t)?t:[t];for(const n of t){const r=IT(n);e.find(i=>r===i)||e.unshift(r)}}function j$(){return JD()}const H$=new CT({id:"loaders.gl"}),W$=/\.([^.]+)$/;async function Q$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!eR(t))return null;let i=mC(t,e,{...n,nothrow:!0},r);if(i)return i;if(wf(t)&&(t=await t.slice(0,10).arrayBuffer(),i=mC(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(tR(t));return i}function mC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!eR(t))return null;if(e&&!Array.isArray(e))return IT(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...j$()),Z$(i);const s=q$(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(tR(t));return s}function q$(t,e,n,r){const i=G2(t),s=MT(t),A=ST(i)||r?.url;let o=null,g="";if(n!=null&&n.mimeType&&(o=Vx(e,n?.mimeType),g="match forced by supplied MIME type ".concat(n?.mimeType)),o=o||Y$(e,A),g=g||(o?"matched url ".concat(A):""),o=o||Vx(e,s),g=g||(o?"matched MIME type ".concat(s):""),o=o||K$(e,t),g=g||(o?"matched initial data ".concat(nR(t)):""),o=o||Vx(e,n?.fallbackMimeType),g=g||(o?"matched fallback MIME type ".concat(s):""),g){var w;H$.log(1,"selectLoader selected ".concat((w=o)===null||w===void 0?void 0:w.name,": ").concat(g,"."))}return o}function eR(t){return!(t instanceof Response&&t.status===204)}function tR(t){const e=G2(t),n=MT(t);let r="No valid loader found (";r+=e?"".concat(jD(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?nR(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function Z$(t){for(const e of t)IT(e)}function Y$(t,e){const n=e&&W$.exec(e),r=n&&n[1];return r?X$(t,r):null}function X$(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function Vx(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function K$(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(J$(e,n))return n}else if(ArrayBuffer.isView(e)){if(yC(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&yC(e,0,n))return n;return null}function J$(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function yC(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>ej(t,e,n,i))}function ej(t,e,n,r){if(r instanceof ArrayBuffer)return WG(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=e3(t,e,r.length);return r===i;default:return!1}}function nR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?e3(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?e3(t,0,e):""}function e3(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const tj=256*1024;function*nj(t,e){const n=e?.chunkSize||tj;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),A=t.slice(r,r+s);r+=s,yield i.encode(A)}}const rj=256*1024;function ij(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=rj}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),A=new Uint8Array(t,r,i);new Uint8Array(s).set(A),r+=i,yield s}}()}const sj=1024*1024;async function*oj(t,e){const n=e?.chunkSize||sj;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function _C(t,e){return TT?aj(t,e):lj(t)}async function*aj(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:A}=await i;if(s)return;yield $D(A)}}catch{n.releaseLock()}}async function*lj(t,e){for await(const n of t)yield $D(n)}function Aj(t,e){if(typeof t=="string")return nj(t,e);if(t instanceof ArrayBuffer)return ij(t,e);if(wf(t))return oj(t,e);if(HD(t))return _C(t,e);if(xf(t))return _C(t.body,e);throw new Error("makeIterator")}const rR="Cannot convert supplied data type";function uj(t,e,n){if(e.text&&typeof t=="string")return t;if(u$(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(rR)}async function cj(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return uj(t,e);if(wf(t)&&(t=await QD(t)),xf(t)){const i=t;return await y$(i),e.binary?await i.arrayBuffer():await i.text()}if(HD(t)&&(t=Aj(t,n)),l$(t)||A$(t))return qG(t);throw new Error(rR)}function iR(t,e){const n=KD(),r=t||n;return typeof r.fetch=="function"?r.fetch:im(r.fetch)?i=>AC(i,r):e!=null&&e.fetch?e?.fetch:AC}function hj(t,e,n){if(n)return n;const r={fetch:iR(e,t),...t};if(r.url){const i=ST(r.url);r.baseUrl=i,r.queryString=g$(r.url),r.filename=jD(i),r.baseUrl=o$(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function fj(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function kT(t,e,n,r){qu(!r||typeof r=="object"),e&&!Array.isArray(e)&&!PT(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=G2(t),A=fj(e,r),o=await Q$(t,A,n);return o?(n=F$(n,o,A,i),r=hj({url:i,parse:kT,loaders:A},n,r||null),await dj(o,t,n,r)):null}async function dj(t,e,n,r){if(GG(t),xf(e)){const i=e,{ok:s,redirected:A,status:o,statusText:g,type:w,url:C}=i,I=Object.fromEntries(i.headers.entries());r.response={headers:I,ok:s,redirected:A,status:o,statusText:g,type:w,url:C}}if(e=await cj(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if($G(t,n))return await jG(t,e,n,r,kT);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw qu(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function c_(t,e,n,r){!Array.isArray(e)&&!PT(e)&&(n=e,e=void 0);const i=iR(n);let s=t;return typeof t=="string"&&(s=await i(t)),wf(t)&&(s=await i(t)),await kT(s,e,n)}const pj="3.4.14",{_parseImageNode:gj}=globalThis,t3=typeof Image<"u",n3=typeof ImageBitmap<"u",mj=!!gj,r3=TT?!0:mj;function yj(t){switch(t){case"auto":return n3||t3||r3;case"imagebitmap":return n3;case"image":return t3;case"data":return r3;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function _j(){if(n3)return"imagebitmap";if(t3)return"image";if(r3)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function vj(t){const e=wj(t);if(!e)throw new Error("Not an image");return e}function xj(t){switch(vj(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function wj(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const bj=/^data:image\/svg\+xml/,Ej=/\.svg((\?|#).*)?$/;function LT(t){return t&&(bj.test(t)||Ej.test(t))}function Tj(t,e){if(LT(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return sR(t,e)}function sR(t,e){if(LT(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function oR(t,e,n){const r=Tj(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await Sj(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function Sj(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const Mj={};let vC=!0;async function Cj(t,e,n){let r;LT(n)?r=await oR(t,e,n):r=sR(t,n);const i=e&&e.imagebitmap;return await Pj(r,i)}async function Pj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((Ij(e)||!vC)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),vC=!1}return await createImageBitmap(t)}function Ij(t){for(const e in t||Mj)return!1;return!0}function kj(t){return!Bj(t,"ftyp",4)||!(t[8]&96)?null:Lj(t)}function Lj(t){switch(Dj(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Dj(t,e,n){return String.fromCharCode(...t.slice(e,n))}function Rj(t){return[...t].map(e=>e.charCodeAt(0))}function Bj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=Rj(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const IA=!1,Kp=!0;function aR(t){const e=om(t);return Oj(e)||Uj(e)||Fj(e)||Nj(e)||zj(e)}function zj(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=kj(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function Oj(t){const e=om(t);return e.byteLength>=24&&e.getUint32(0,IA)===2303741511?{mimeType:"image/png",width:e.getUint32(16,IA),height:e.getUint32(20,IA)}:null}function Fj(t){const e=om(t);return e.byteLength>=10&&e.getUint32(0,IA)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Kp),height:e.getUint16(8,Kp)}:null}function Nj(t){const e=om(t);return e.byteLength>=14&&e.getUint16(0,IA)===16973&&e.getUint32(2,Kp)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Kp),height:e.getUint32(22,Kp)}:null}function Uj(t){const e=om(t);if(!(e.byteLength>=3&&e.getUint16(0,IA)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=Vj();let s=2;for(;s+9<e.byteLength;){const A=e.getUint16(s,IA);if(i.has(A))return{mimeType:"image/jpeg",height:e.getUint16(s+5,IA),width:e.getUint16(s+7,IA)};if(!r.has(A))return null;s+=2,s+=e.getUint16(s,IA)}return null}function Vj(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function om(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function Gj(t,e){const{mimeType:n}=aR(t)||{},r=globalThis._parseImageNode;return l_(r),await r(t,n)}async function $j(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},A=jj(i);let o;switch(A){case"imagebitmap":o=await Cj(t,e,s);break;case"image":o=await oR(t,e,s);break;case"data":o=await Gj(t);break;default:l_(!1)}return i==="data"&&(o=xj(o)),o}function jj(t){switch(t){case"auto":case"data":return _j();default:return yj(t),t}}const Hj=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],Wj=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],Qj={image:{type:"auto",decode:!0}},qj={id:"image",module:"images",name:"Images",version:pj,mimeTypes:Wj,extensions:Hj,parse:$j,tests:[t=>!!aR(new DataView(t))],options:Qj};function lR(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function wd(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||lR()}const cy={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},c1=cy.window||cy.self||cy.global,op=cy.process||{},AR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";wd();const Gx=globalThis;function Zj(t){if(!t&&!wd())return"Node";if(lR(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":Gx.chrome?"Chrome":Gx.safari?"Safari":Gx.mozInnerScreenX?"Firefox":"Unknown"}function Yj(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let Xj=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=Yj(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function Kj(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function Jj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function $x(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,A=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(A/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(A,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(A,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let h_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(h_||(h_={}));function xC(t){return typeof t=="string"?h_[t.toUpperCase()]||h_.WHITE:t}function eH(t,e,n){return!wd&&typeof t=="string"&&(e&&(e=xC(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=xC(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function tH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function f_(t,e){if(!t)throw new Error(e||"Assertion failed")}function Wf(){let t;if(wd&&"performance"in c1){var e,n;t=c1==null||(e=c1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in op){var r;const i=op==null||(r=op.hrtime)===null||r===void 0?void 0:r.call(op);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Qf={debug:wd&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},nH={enabled:!0,level:0};function nl(){}const wC={},bC={once:!0};let uR=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",AR),oe(this,"_startTs",Wf()),oe(this,"_deltaTs",Wf()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new Xj("__probe-".concat(this.id,"__"),nH),this.timeStamp("".concat(this.id," started")),tH(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Wf()-this._startTs).toPrecision(10))}getDelta(){return Number((Wf()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){f_(e,n)}warn(e){return this._getLogFunction(0,e,Qf.warn,arguments,bC)}error(e){return this._getLogFunction(0,e,Qf.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Qf.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Qf.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Qf.debug||Qf.info,arguments,bC)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||nl,r&&[r],{tag:oH(n)}):nl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:A=1}=e;return this._shouldLog(n||r)?wd?sH({image:i,message:s,scale:A}):iH():nl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||nl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=EC({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||nl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=cR(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=EC({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,f_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Wf();const A=s.tag||s.message;if(s.once)if(!wC[A])wC[A]=Wf();else return nl;return n=rH(this.id,s.message,s),r.bind(console,n,...s.args)}return nl}};oe(uR,"VERSION",AR);function cR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return f_(Number.isFinite(e)&&e>=0),e}function EC(t){const{logLevel:e,message:n}=t;t.logLevel=cR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return f_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function rH(t,e,n){if(typeof e=="string"){const r=n.time?Jj(Kj(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=eH(e,n.color,n.background)}return e}function iH(t){return console.warn("removed"),nl}function sH(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const A=$x(s,n,r);console.log(...A)},s.src=e,nl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...$x(e,n,r)),nl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...$x(s,n,r)),s.src=e.toDataURL(),nl}return nl}function oH(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const rr=new uR({id:"deck"});let i3={};function aH(t){i3=t}function oo(t,e,n,r){rr.level>0&&i3[t]&&i3[t].call(null,e,n,r)}function lH(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const AH={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:lH,parseTextSync:JSON.parse};function uH(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(rr.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:rr,_registerLoggers:aH},$$([AH,[qj,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const cH=uH(),ar={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ar,"IDENTITY",{get:()=>(rr.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Hl={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Jh={common:0,meters:1,pixels:2},TC={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};function hH(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function bd(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||hH()}const hy={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},h1=hy.window||hy.self||hy.global,ap=hy.process||{},hR=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";bd();function fH(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class dH{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";oe(this,"storage",void 0),oe(this,"id",void 0),oe(this,"config",void 0),this.storage=fH(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function pH(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function gH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function jx(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,A=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(A/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(A,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(A,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let d_;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(d_||(d_={}));function SC(t){return typeof t=="string"?d_[t.toUpperCase()]||d_.WHITE:t}function mH(t,e,n){return!bd&&typeof t=="string"&&(e&&(e=SC(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=SC(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function yH(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function p_(t,e){if(!t)throw new Error(e||"Assertion failed")}function qf(){let t;if(bd&&"performance"in h1){var e,n;t=h1==null||(e=h1.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in ap){var r;const i=ap==null||(r=ap.hrtime)===null||r===void 0?void 0:r.call(ap);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Zf={debug:bd&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},_H={enabled:!0,level:0};function rl(){}const MC={},CC={once:!0};class fR{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};oe(this,"id",void 0),oe(this,"VERSION",hR),oe(this,"_startTs",qf()),oe(this,"_deltaTs",qf()),oe(this,"_storage",void 0),oe(this,"userData",{}),oe(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new dH("__probe-".concat(this.id,"__"),_H),this.timeStamp("".concat(this.id," started")),yH(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((qf()-this._startTs).toPrecision(10))}getDelta(){return Number((qf()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){p_(e,n)}warn(e){return this._getLogFunction(0,e,Zf.warn,arguments,CC)}error(e){return this._getLogFunction(0,e,Zf.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Zf.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Zf.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Zf.debug||Zf.info,arguments,CC)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||rl,r&&[r],{tag:bH(n)}):rl}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:A=1}=e;return this._shouldLog(n||r)?bd?wH({image:i,message:s,scale:A}):xH():rl}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||rl)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=PC({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||rl)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=dR(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=PC({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,p_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=qf();const A=s.tag||s.message;if(s.once)if(!MC[A])MC[A]=qf();else return rl;return n=vH(this.id,s.message,s),r.bind(console,n,...s.args)}return rl}}oe(fR,"VERSION",hR);function dR(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return p_(Number.isFinite(e)&&e>=0),e}function PC(t){const{logLevel:e,message:n}=t;t.logLevel=dR(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return p_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function vH(t,e,n){if(typeof e=="string"){const r=n.time?gH(pH(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=mH(e,n.color,n.background)}return e}function xH(t){return console.warn("removed"),rl}function wH(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const A=jx(s,n,r);console.log(...A)},s.src=e,rl}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...jx(e,n,r)),rl;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...jx(s,n,r)),s.src=e.toDataURL(),rl}return rl}function bH(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const vn=new fR({id:"luma.gl"});function Po(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const EH="Invalid WebGLRenderingContext",TH="Requires WebGL2";function $2(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function lr(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function SH(t){return lr(t)?t:null}function j2(t){return Po($2(t),EH),t}function Ao(t){return Po(lr(t),TH),t}const Lp={};function MH(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function CH(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function PH(t,e){Lp[t]=!0,e!==void 0&&MH(e)}function IH(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Lp[r]=!0);while(r!==0);for(r in Lp)if(Lp[r])return delete Lp[r],parseInt(r,10);return 0}}const am=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};am.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};am.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const bf=function(e){const n=this;this.gl=e,IH(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const A=n.currentVertexArrayObject;A.maxAttrib=Math.max(A.maxAttrib,s);const o=A.attribs[s];return o.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const A=n.currentVertexArrayObject;A.maxAttrib=Math.max(A.maxAttrib,s);const o=A.attribs[s];return o.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,A){switch(s){case 34962:n.currentArrayBuffer=A;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=A;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,A){const g=n.currentVertexArrayObject.attribs[s];switch(A){case 34975:return g.buffer;case 34338:return g.enabled;case 34339:return g.size;case 34340:return g.stride;case 34341:return g.type;case 34922:return g.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,A,o,g,w,C){const I=n.currentVertexArrayObject;I.maxAttrib=Math.max(I.maxAttrib,s);const k=I.attribs[s];return k.buffer=n.currentArrayBuffer,k.size=A,k.type=o,k.normalized=g,k.stride=w,k.offset=C,k.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{CH("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};bf.prototype.VERTEX_ARRAY_BINDING_OES=34229;bf.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new am(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};bf.prototype.createVertexArrayOES=function(){const e=new am(this);return this.vertexArrayObjects.push(e),e};bf.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};bf.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof am&&e.hasBeenBound&&e.ext===this)};bf.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){PH(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let A=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let g=0;g<=o;g++){const w=s.attribs[g],C=i?i.attribs[g]:null;if((!i||w.enabled!==C.enabled)&&(w.enabled?r.enableVertexAttribArray.call(n,g):r.disableVertexAttribArray.call(n,g)),w.enabled){let I=!1;(!i||w.buffer!==C.buffer)&&(A!==w.buffer&&(r.bindBuffer.call(n,34962,w.buffer),A=w.buffer),I=!0),(I||w.cached!==C.cached)&&r.vertexAttribPointer.call(n,g,w.size,w.type,w.normalized,w.stride,w.offset)}}this.currentArrayBuffer!==A&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function kH(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new bf(this)),this.__OESVertexArrayObject))}}const IC="OES_element_index",kC="WEBGL_draw_buffers",LH="EXT_disjoint_timer_query",DH="EXT_disjoint_timer_query_webgl2",RH="EXT_texture_filter_anisotropic",LC="WEBGL_debug_renderer_info",BH=35723,zH=4352,OH=36795,FH=34047,NH=37445,UH=37446,Zr=t=>lr(t)?void 0:0,VH={3074:t=>lr(t)?void 0:36064,[BH]:t=>lr(t)?void 0:zH,35977:Zr,32937:Zr,[OH]:(t,e)=>{const n=lr(t)?t.getExtension(DH):t.getExtension(LH);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[NH]:(t,e)=>{const n=t.getExtension(LC);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[UH]:(t,e)=>{const n=t.getExtension(LC);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[FH]:(t,e)=>{const n=t.luma.extensions[RH];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Zr,35071:Zr,37447:Zr,36063:(t,e)=>{if(!lr(t)){const n=t.getExtension(kC);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Zr,35374:Zr,35377:Zr,34852:t=>{if(!lr(t)){const e=t.getExtension(kC);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(IC)?2147483647:65535,33001:t=>t.getExtension(IC)?16777216:65535,33e3:t=>16777216,37157:Zr,35373:Zr,35657:Zr,36183:Zr,37137:Zr,34045:Zr,35978:Zr,35979:Zr,35968:Zr,35376:Zr,35375:Zr,35659:Zr,37154:Zr,35371:Zr,35658:Zr,35076:Zr,35077:Zr,35380:Zr};function GH(t,e,n){const r=VH[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const $H="OES_vertex_array_object",pR="ANGLE_instanced_arrays",jH="WEBGL_draw_buffers",HH="EXT_disjoint_timer_query",WH="EXT_texture_filter_anisotropic",QH="VertexArray requires WebGL2 or OES_vertex_array_object extension";function qH(t,e){return{webgl2:lr(t),ext:t.getExtension(e)}}const gR={[$H]:{meta:{suffix:"OES"},createVertexArray:()=>{Po(!1,QH)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[pR]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Po(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[jH]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Po(!1)}},[HH]:{meta:{suffix:"EXT"},createQuery:()=>{Po(!1)},deleteQuery:()=>{Po(!1)},beginQuery:()=>{Po(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},Hx={readBuffer:(t,e,n)=>{lr(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=qH(t,pR);let A;switch(r){case 35069:A=i?void 0:!1;break;case 35070:A=!i&&!s?0:void 0;break}return A!==void 0?A:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!lr(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!lr(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[WH];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:GH,hint(t,e,n,r){return e(n,r)}};function ZH(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(kH(t),YH(t),KH(t,gR),XH(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=ZH;function YH(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function XH(t,e){let{target:n,target2:r}=e;Object.keys(Hx).forEach(i=>{if(typeof Hx[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},A=Hx[i].bind(null,t,s);n[i]=A,r[i]=A}})}function KH(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&JH(t,{extension:n,target:t.luma,target2:t})}function JH(t,e){let{extension:n,target:r,target2:i}=e;const s=gR[n];Po(s);const{meta:A={}}=s,{suffix:o=""}=A,g=t.getExtension(n);for(const w of Object.keys(s)){const C="".concat(w).concat(o);let I=null;w==="meta"||typeof t[w]=="function"||(g&&typeof g[C]=="function"?I=function(){return g[C](...arguments)}:typeof s[w]=="function"&&(I=s[w].bind(r))),I&&(r[w]=I,i[w]=I)}}const DT={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Sc=(t,e,n)=>e?t.enable(n):t.disable(n),DC=(t,e,n)=>t.hint(n,e),ba=(t,e,n)=>t.pixelStorei(n,e),eW=(t,e)=>{const n=lr(t)?36009:36160;return t.bindFramebuffer(n,e)},tW=(t,e)=>t.bindFramebuffer(36008,e);function lp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const nW={3042:Sc,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Sc,2885:(t,e)=>t.cullFace(e),2929:Sc,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Sc,35723:DC,36006:eW,2886:(t,e)=>t.frontFace(e),33170:DC,2849:(t,e)=>t.lineWidth(e),32823:Sc,32824:"polygonOffset",10752:"polygonOffset",35977:Sc,32938:"sampleCoverage",32939:"sampleCoverage",3089:Sc,3088:(t,e)=>t.scissor(...e),2960:Sc,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:ba,3317:ba,37440:ba,37441:ba,37443:ba,3330:ba,3332:ba,3331:ba,36010:tW,3314:ba,32878:ba,3316:ba,3315:ba,32877:ba,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=lp(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=lp(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=lp(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=lp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,A,o]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,A,o)},stencilOp:(t,e)=>{e=lp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,A,o]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,A,o)},viewport:(t,e)=>t.viewport(...e)};function wi(t,e,n){return e[t]!==void 0?e[t]:n[t]}const rW={blendEquation:(t,e,n)=>t.blendEquationSeparate(wi(32777,e,n),wi(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(wi(32969,e,n),wi(32968,e,n),wi(32971,e,n),wi(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(wi(32824,e,n),wi(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(wi(32938,e,n),wi(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,wi(2962,e,n),wi(2967,e,n),wi(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,wi(34816,e,n),wi(36003,e,n),wi(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,wi(2964,e,n),wi(2965,e,n),wi(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,wi(34817,e,n),wi(34818,e,n),wi(34819,e,n))},RC={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},wA=(t,e)=>t.isEnabled(e),BC={3042:wA,2884:wA,2929:wA,3024:wA,32823:wA,32926:wA,32928:wA,3089:wA,2960:wA,35977:wA};function mR(t){for(const e in t)return!1;return!0}function iW(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function zC(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function sW(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,A=new Array(s),o=0;o<s;o++)A[o]=arguments[o];const{valueChanged:g,oldValue:w}=n(t.state._updateCache,...A);return g&&r(...A),w},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function oW(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class aW{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?AW(e):Object.assign({},DT),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Po(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Zu(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Po(s!==void 0);const A=e[s],o=this.cache[s];iW(A,o)||(n=!0,r=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=A)}return{valueChanged:n,oldValue:r}}}function yR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Po(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new aW(t,{copyState:r}),oW(t);for(const s in RC){const A=RC[s];sW(t,s,A)}zC(t,"getParameter"),zC(t,"isEnabled")}return t.state.enable=n,t}function lW(t){t.state||yR(t,{copyState:!1}),t.state.push()}function OC(t){Po(t.state),t.state.pop()}function Zu(t,e){if(Po($2(t),"setParameters requires a WebGL context"),mR(e))return;const n={};for(const i in e){const s=Number(i),A=nW[i];A&&(typeof A=="string"?n[A]=!0:A(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=rW[i];s(t,e,r)}}function AW(t,e){if(e=e||DT,typeof e=="number"){const i=e,s=BC[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=BC[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function uW(t){Zu(t,DT)}function Jl(t,e,n){if(mR(e))return n(t);const{nocatch:r=!0}=e;lW(t),Zu(t,e);let i;if(r)i=n(t),OC(t);else try{i=n(t)}finally{OC(t)}return i}function nd(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function Wx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=nd(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return hW(e,r,i,s,n)}function cW(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function hW(t,e,n,r,i){const s=FC(t[0],e,n);let A=NC(t[1],e,r,i),o=FC(t[0]+1,e,n);const g=o===n-1?o:o-1;o=NC(t[1]+1,e,r,i);let w;return i?(o=o===0?o:o+1,w=A,A=o):w=o===r-1?o:o-1,{x:s,y:A,width:Math.max(g-s+1,1),height:Math.max(w-A+1,1)}}function FC(t,e,n){return Math.min(Math.round(t*e),n-1)}function NC(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const RT=bd(),fW=RT&&typeof document<"u",_R={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function vR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Po(RT,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},_R,t);const{width:e,height:n}=t;function r(o){if(t.throwOnError)throw new Error(o);return console.error(o),null}t.onError=r;let i;const{canvas:s}=t,A=mW({canvas:s,width:e,height:n,onError:r});return i=gW(A,t),i?(i=BT(i,t),yW(i),i):null}function BT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||_W(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},_R,e);const{manageState:n,debug:r}=e;return n&&yR(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),A=0;A<i;A++)s[A]=arguments[A];return vn.log(1,...s)()}}),RT&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),vn.level=Math.max(vn.level,1)):vn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function dW(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function pW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=cW(e.useDevicePixels);vW(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function gW(t,e){const{onError:n}=e;let r=null;const i=g=>r=g.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:A=!0}=e;let o=null;return A&&(o=o||t.getContext("webgl2",e),o=o||t.getContext("experimental-webgl2",e)),s&&(o=o||t.getContext("webgl",e),o=o||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),o?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),o):n("Failed to create ".concat(A&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function mW(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(fW&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function yW(t){const e=lr(t)?"WebGL2":"WebGL1",n=dW(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";vn.info(1,"".concat(e).concat(i," context ").concat(r))()}function _W(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function vW(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(vn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let A=e;const o=Math.floor(r*A),g=Math.floor(i*A);t.canvas.width=o,t.canvas.height=g,(t.drawingBufferWidth!==o||t.drawingBufferHeight!==g)&&(vn.warn("Device pixel ratio clamped")(),A=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*A),t.canvas.height=Math.floor(i*A)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function UC(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let VC=class{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=UC(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(UC()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},xW=class{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof VC?this.stats[n]=e:this.stats[n]=new VC(n,r)),this.stats[n]}};function xR(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function wR(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||xR()}const Qx=globalThis;function wW(t){if(!t&&!wR())return"Node";if(xR(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":Qx.chrome?"Chrome":Qx.safari?"Safari":Qx.mozInnerScreenX?"Firefox":"Unknown"}const Jp="8.5.21",bW="set luma.log.level=1 (or higher) to trace rendering";class EW{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new xW({id:e})),this.stats.get(e)}}const Vh=new EW;if(globalThis.luma&&globalThis.luma.VERSION!==Jp)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Jp));globalThis.luma||(wR()&&vn.log(1,"luma.gl ".concat(Jp," - ").concat(bW))(),globalThis.luma=globalThis.luma||{VERSION:Jp,version:Jp,log:vn,stats:Vh,globals:{modules:{},nodeIO:{}}});function TW(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function SW(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function nn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function qx(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return nn(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function nh(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const Zx={};function lh(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Zx[t]=Zx[t]||1;const e=Zx[t]++;return"".concat(t,"-").concat(e)}function GC(t){return nn(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function rd(t){let e=!0;for(const n in t){e=!1;break}return e}function bR(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(A=>{s.methodName||(s[A]=()=>{throw vn.removed("Calling removed method ".concat(e,".").concat(A,": "),i)(),new Error(A)})})}const Yf="Resource subclass must define virtual methods";let oc=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j2(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||lh(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=qx(this.gl,e),nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=lr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,g="webgl2"in i?i.webgl2:i.webgl1;return s?g:o}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=lr(this.gl),A={},o=n||Object.keys(i);for(const g of o){const w=i[g];if(w&&(!("webgl2"in w)||s)&&(!("extension"in w)||this.gl.getExtension(w.extension))){const I=r?nh(this.gl,g):g;A[I]=this.getParameter(g,e),r&&w.type==="GLenum"&&(A[I]=nh(this.gl,A[I]))}}return A}setParameter(e,n){e=qx(this.gl,e),nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=lr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=qx(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return bR(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Yf)}_deleteHandle(){throw new Error(Yf)}_bindHandle(e){throw new Error(Yf)}_getOptsFromHandle(){throw new Error(Yf)}_getParameter(e,n){throw new Error(Yf)}_setParameter(e,n){throw new Error(Yf)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Vh.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Vh.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=Vh.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=Vh.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const MW="Failed to deduce GL constant from typed array";function s3(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(MW)}}function Tg(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function CW(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const A=n*i;s=s||new Uint8Array(A);for(let o=0;o<r/2;++o){const g=o*A,w=(r-o-1)*A;s.set(e.subarray(g,g+A)),e.copyWithin(g,w,w+A),e.set(s,w)}}function PW(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),A=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let g=0;g<i;g++)for(let w=0;w<4;w++)A[(o*i+g)*4+w]=e[(o*2*n+g*2)*4+w];return{data:A,width:i,height:s}}function o3(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const o in r)if(o in e){const w=r[o]?"".concat(t,".").concat(r[o]):"N/A";vn.removed("".concat(t,".").concat(o),w)()}for(const o in i)if(o in e){const g=i[o];vn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(g))()}let A=null;for(const o in s)if(o in e){const g=s[o];vn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(g))(),A=A||Object.assign({},e),A[g]=e[o],delete A[o]}return A||e}const IW={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},kW={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Ma{static getBytesPerElement(e){return Tg(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return nn(e.size),Tg(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Ma(IW,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Ma.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Ma.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=o3("Accessor",e,kW),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const $C=10,ER={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},LW={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:ER},DW={removedProps:ER};class Or extends oc{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ma.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ma.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=o3("Buffer",e,LW),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=o3("Buffer",e,DW),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Ma(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;nn(n);const A=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(A,this.handle),i!==0||s!==void 0?(Ao(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(A,r,n),this.gl.bindBuffer(A,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:A}=this;return Ao(A),A.bindBuffer(36662,n.handle),A.bindBuffer(36663,this.handle),A.copyBufferSubData(36662,36663,r,i,s),A.bindBuffer(36662,null),A.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ao(this.gl);const s=Tg(this.accessor.type||5126,{clamped:!1}),A=this._getAvailableElementCount(n),o=r;let g,w;e?(w=e.length,g=w-o):(g=Math.min(A,i||A),w=o+g);const C=Math.min(A,g);return i=i||C,nn(i<=C),e=e||new s(w),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(nn(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min($C,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;nn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,$C),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=s3(e);return nn(s),this.setAccessor(new Ma(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;nn(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Tg(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Ma(this.accessor,{type:s3(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return vn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return vn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return vn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return vn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Ma(this.accessor,e),this}}const zT={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},TR={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},SR={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function RW(t,e){const n=zT[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=lr(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function BW(t,e){const n=zT[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const zW=[9729,9728],jC=globalThis.WebGLBuffer||function(){};class ef extends oc{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&RW(e,r),s=s&&(!i||BW(e,r))),s}constructor(e,n){const{id:r=lh("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(te=>this.initialize(Object.assign({},e,{pixels:te,data:te}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:A=0,recreate:o=!1,parameters:g={},pixelStore:w={},textureUnit:C=void 0}=e;n||(n=i);let{width:I,height:k,dataFormat:U,type:H,compressed:q=!1,mipmaps:se=!0}=e;const{depth:X=0}=e;return{width:I,height:k,compressed:q,dataFormat:U,type:H}=this._deduceParameters({format:s,type:H,dataFormat:U,compressed:q,data:n,width:I,height:k}),this.width=I,this.height=k,this.depth=X,this.format=s,this.type=H,this.dataFormat=U,this.border=A,this.textureUnit=C,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),se&&this._isNPOT()&&(vn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),se=!1,this._updateForNPOT(g)),this.mipmaps=se,this.setImageData({data:n,width:I,height:k,depth:X,format:s,type:H,dataFormat:U,border:A,mipmaps:se,parameters:w,compressed:q}),se&&this.generateMipmap(),this.setParameters(g),o&&(this.data=n),r&&(this._video={video:n,parameters:g,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(vn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Jl(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:A=this.border,offset:o=0,parameters:g={}}=e;let{data:w=null,type:C=this.type,width:I=this.width,height:k=this.height,dataFormat:U=this.dataFormat,compressed:H=!1}=e;w||(w=r),{type:C,dataFormat:U,compressed:H,width:I,height:k}=this._deduceParameters({format:s,type:C,dataFormat:U,compressed:H,data:w,width:I,height:k});const{gl:q}=this;q.bindTexture(this.target,this.handle);let se=null;({data:w,dataType:se}=this._getDataType({data:w,compressed:H}));let X,te=0;if(Jl(this.gl,g,()=>{switch(se){case"null":q.texImage2D(n,i,s,I,k,A,U,C,w);break;case"typed-array":q.texImage2D(n,i,s,I,k,A,U,C,w,o);break;case"buffer":X=Ao(q),X.bindBuffer(35052,w.handle||w),X.texImage2D(n,i,s,I,k,A,U,C,o),X.bindBuffer(35052,null);break;case"browser-object":lr(q)?q.texImage2D(n,i,s,I,k,A,U,C,w):q.texImage2D(n,i,s,U,C,w);break;case"compressed":for(const[ie,fe]of w.entries())q.compressedTexImage2D(n,ie,fe.format,fe.width,fe.height,A,fe.data),te+=fe.levelSize;break;default:nn(!1,"Unknown image data type")}}),se==="compressed")this._trackAllocatedMemory(te,"Texture");else if(w&&w.byteLength)this._trackAllocatedMemory(w.byteLength,"Texture");else{const ie=TR[this.dataFormat]||4,fe=SR[this.type]||1;this._trackAllocatedMemory(this.width*this.height*ie*fe,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:A=0,width:o=this.width,height:g=this.height,level:w=0,format:C=this.format,type:I=this.type,dataFormat:k=this.dataFormat,compressed:U=!1,offset:H=0,border:q=this.border,parameters:se={}}=e;if({type:I,dataFormat:k,compressed:U,width:o,height:g}=this._deduceParameters({format:C,type:I,dataFormat:k,compressed:U,data:i,width:o,height:g}),nn(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const X=i;i=X.data,o=X.shape[0],g=X.shape[1]}i instanceof Or&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Jl(this.gl,se,()=>{if(U)this.gl.compressedTexSubImage2D(n,w,s,A,o,g,C,i);else if(i===null)this.gl.texSubImage2D(n,w,s,A,o,g,k,I,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,w,s,A,o,g,k,I,i,H);else if(i instanceof jC){const X=Ao(this.gl);X.bindBuffer(35052,i),X.texSubImage2D(n,w,s,A,o,g,k,I,H),X.bindBuffer(35052,null)}else lr(this.gl)?Ao(this.gl).texSubImage2D(n,w,s,A,o,g,k,I,i):this.gl.texSubImage2D(n,w,s,A,k,I,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return vn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof Or?{data:n.handle,dataType:"buffer"}:n instanceof jC?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:A,type:o,compressed:g}=e;const w=zT[n];return A=A||w&&w.dataFormat,o=o||w&&w.types[0],g=g||w&&w.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:A,type:o,compressed:g,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},nn(i,"Could not deduced texture size"),nn(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),nn(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:nn(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return lr(this.gl)||!this.width||!this.height?!1:!GC(this.width)||!GC(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:zW.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let OW="";function FW(t,e){return nn(typeof t=="string"),t=OW+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class oa extends ef{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return ef.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j2(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:FW(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const a3=[34069,34070,34071,34072,34073,34074];class MR extends ef{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};j2(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:A=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:A})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:A=0,format:o=6408,type:g=5121}=e;const{gl:w}=this,C=i||s,I=await Promise.all(a3.map(k=>{const U=C[k];return Promise.all(Array.isArray(U)?U:[U])}));this.bind(),a3.forEach((k,U)=>{I[U].length>1&&this.opts.mipmaps!==!1&&vn.warn("".concat(this.id," has mipmap and multiple LODs."))(),I[U].forEach((H,q)=>{n&&r?w.texImage2D(k,q,o,n,r,A,o,g,H):w.texImage2D(k,q,o,o,g,H)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:A,border:o=0,format:g=6408,type:w=5121}=e,{gl:C}=this,I=s||A;return this.bind(),I instanceof Promise?I.then(k=>this.setImageDataForFace(Object.assign({},e,{face:n,data:k,pixels:k}))):this.width||this.height?C.texImage2D(n,0,g,r,i,o,g,w,I):C.texImage2D(n,0,g,g,w,I),this}}MR.FACES=a3;class NW extends ef{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return lr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ao(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:A=1,border:o=0,format:g,type:w=5121,offset:C=0,data:I,parameters:k={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Jl(this.gl,k,()=>{ArrayBuffer.isView(I)&&this.gl.texImage3D(this.target,n,r,i,s,A,o,g,w,I),I instanceof Or&&(this.gl.bindBuffer(35052,I.handle),this.gl.texImage3D(this.target,n,r,i,s,A,o,g,w,C))}),I&&I.byteLength)this._trackAllocatedMemory(I.byteLength,"Texture");else{const U=TR[this.dataFormat]||4,H=SR[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*U*H,"Texture")}return this.loaded=!0,this}}const Sh="EXT_color_buffer_float",HC={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Sh,bpp:2},33327:{gl2:Sh,bpp:4},34842:{gl2:Sh,bpp:8},33326:{gl2:Sh,bpp:4},33328:{gl2:Sh,bpp:8},34836:{gl2:Sh,bpp:16},35898:{gl2:Sh,bpp:4}};function UW(t,e,n){const r=n[e];if(!r)return!1;const i=lr(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class g0 extends oc{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||UW(e,n,HC)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return nn(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&lr(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*HC[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const VW=256,GW=1024,$W=16384,WC=6144,QC=6145,qC=6146,ZC=34041,CR="clear: bad arguments";function OT(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let A=0;n&&(A|=$W,n!==!0&&(s.clearColor=n)),r&&(A|=VW,r!==!0&&(s.clearDepth=r)),i&&(A|=GW,r!==!0&&(s.clearStencil=r)),nn(A!==0,CR),Jl(t,s,()=>{t.clear(A)})}function jW(t){let{framebuffer:e=null,buffer:n=WC,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ao(t),Jl(t,{framebuffer:e},()=>{switch(n){case WC:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case QC:t.clearBufferfv(QC,0,[i]);break;case qC:t.clearBufferiv(qC,0,[i]);break;case ZC:const[s,A]=i;t.clearBufferfi(ZC,0,s,A);break;default:nn(!1,CR)}})}function HW(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return nn(!1),0}}function H2(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:A=null,sourceWidth:o,sourceHeight:g,sourceType:w}=e;const{framebuffer:C,deleteFramebuffer:I}=PR(t);nn(C);const{gl:k,handle:U,attachments:H}=C;o=o||C.width,g=g||C.height,s===36064&&U===null&&(s=1028),nn(H[s]),w=w||H[s].type,A=QW(A,w,i,o,g),w=w||s3(A);const q=k.bindFramebuffer(36160,U);return k.readPixels(n,r,o,g,i,w,A),k.bindFramebuffer(36160,q||null),I&&C.delete(),A}function YC(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=H2(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=PW({data:r,width:i,height:s}));CW({data:r,width:i,height:s});const A=document.createElement("canvas");A.width=i,A.height=s;const o=A.getContext("2d"),g=o.createImageData(i,s);return g.data.set(r),o.putImageData(g,0,0),A.toDataURL()}function WW(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:A=6408}=n;let{targetX:o,targetY:g,targetZ:w,width:C,height:I}=n;const{framebuffer:k,deleteFramebuffer:U}=PR(t);nn(k);const{gl:H,handle:q}=k,se=typeof o<"u"||typeof g<"u"||typeof w<"u";o=o||0,g=g||0,w=w||0;const X=H.bindFramebuffer(36160,q);nn(e);let te=null;if(e instanceof ef&&(te=e,C=Number.isFinite(C)?C:te.width,I=Number.isFinite(I)?I:te.height,te.bind(0),e=te.target),!se)H.copyTexImage2D(e,s,A,r,i,C,I,0);else switch(e){case 3553:case 34067:H.copyTexSubImage2D(e,s,o,g,r,i,C,I);break;case 35866:case 32879:Ao(H).copyTexSubImage3D(e,s,o,g,w,r,i,C,I);break}return te&&te.unbind(),H.bindFramebuffer(36160,X||null),U&&k.delete(),te}function PR(t){return t instanceof ts?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:nQ(t),deleteFramebuffer:!0}}function QW(t,e,n,r,i){if(t)return t;e=e||5121;const s=Tg(e,{clamped:!1}),A=HW(n);return new s(r*i*A)}const Yr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function qW(t){const e=new oa(t,{format:6408,type:5126,dataFormat:6408}),n=new ts(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const IR={[Yr.WEBGL2]:[!1,!0],[Yr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Yr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Yr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Yr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Yr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Yr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Yr.FLOAT_BLEND]:["EXT_float_blend"],[Yr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Yr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Yr.TEXTURE_FLOAT]:["OES_texture_float",!0],[Yr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Yr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Yr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Yr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Yr.COLOR_ATTACHMENT_RGBA32F]:[qW,"EXT_color_buffer_float"],[Yr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Yr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Yr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Yr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Yr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Yr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},ZW=2;function kR(t,e){return FT(t,e)}function FT(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>LR(t,n))}function YW(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in IR)t.luma.caps[e]===void 0&&(t.luma.caps[e]=LR(t,e));return t.luma.caps}function LR(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=XW(t,e)),t.luma.caps[e]||vn.log(ZW,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function XW(t,e){const n=IR[e];nn(n,e);let r;const i=lr(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:nn(!1);return r}const XC="Multiple render targets not supported";class ts extends oc{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new ts(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Ao(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Ao(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:A=!0,stencil:o=!1,check:g=!0,readBuffer:w=void 0,drawBuffers:C=void 0}=e;if(nn(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const I in i){const k=i[I];(Array.isArray(k)?k[0]:k).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,A,o,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:w,drawBuffers:C}),i&&g&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:A=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:A});const{gl:o}=this,g=o.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,g||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return nn(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&vn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(A=>{i[A]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const A in i){nn(A!==void 0,"Misspelled framebuffer binding point?");const o=Number(A),g=i[o];let w=g;if(!w)this._unattach(o);else if(w instanceof g0)this._attachRenderbuffer({attachment:o,renderbuffer:w});else if(Array.isArray(g)){const[C,I=0,k=0]=g;w=C,this._attachTexture({attachment:o,texture:C,layer:I,level:k})}else this._attachTexture({attachment:o,texture:w,layer:0,level:0});r&&w&&w.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(A=>!this.attachments[A]).forEach(A=>{delete this.attachments[A]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(JW(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,A=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&OT(this.gl,{color:n,depth:r,stencil:i}),s.forEach((o,g)=>{jW(this.gl,{drawBuffer:g,value:o})}),this.gl.bindFramebuffer(36160,A||null),this}readPixels(){return vn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return vn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return vn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return vn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return vn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return vn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:A}=e;const o=Ao(this.gl),g=o.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&A===void 0?o.invalidateFramebuffer(36008,n):o.invalidateFramebuffer(36008,n,r,i,s,A),o.bindFramebuffer(36008,g),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=nh(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const A=n?nh(this.gl,s):s;i[A]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),A=e?nh(this.gl,s):s;r[A]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(YC(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>vn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=YC(this,{targetMaxHeight:100});return vn.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let A=null;return e&&(A=A||{},A[36064]=new oa(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(A[36064])),n&&r?(A=A||{},A[33306]=new g0(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(A[33306])):n?(A=A||{},A[36096]=new g0(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(A[36096])):r&&nn(!1),A}_unattach(e){const n=this.attachments[e];n&&(n instanceof g0?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:A}=this;switch(A.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Ao(A).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const g=KW(i);A.framebufferTexture2D(36160,n,g,r.handle,s);break;case 3553:A.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:nn(!1,"Illegal texture type")}A.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=SH(this.gl);n?n.readBuffer(e):nn(e===36064||e===1029,XC),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Ao(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):nn(e.length===1&&(e[0]===36064||e[0]===1029),XC)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=YW(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function KW(t){return t<34069?t+34069:t}function JW(t){return(ts.STATUS||{})[t]||"Framebuffer error ".concat(t)}const eQ=[36049,36048,33296,33298,33299,33300,33301,33302,33303];ts.ATTACHMENT_PARAMETERS=eQ;function tQ(t,e){nn(t instanceof oa||t instanceof MR||t instanceof NW);const n=t.constructor,{gl:r,width:i,height:s,format:A,type:o,dataFormat:g,border:w,mipmaps:C}=t,I=Object.assign({width:i,height:s,format:A,type:o,dataFormat:g,border:w,mipmaps:C},e);return new n(r,I)}function nQ(t,e){const{gl:n,width:r,height:i,id:s}=t;return new ts(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:t}}))}function fy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const rQ=35632,iQ=35633;function sQ(t){switch(t){case rQ:return"fragment";case iQ:return"vertex";default:return"unknown type"}}function oQ(t,e,n,r){const i=t.split(/\r?\n/),s={},A={},o=r||fy(e)||"(unnamed)",g="".concat(sQ(n)," shader ").concat(o);for(let C=0;C<i.length;C++){const I=i[C];if(I.length<=1)continue;const k=I.split(":"),U=k[0],H=parseInt(k[2],10);if(isNaN(H))throw new Error("GLSL compilation error in ".concat(g,": ").concat(t));U!=="WARNING"?s[H]=I:A[H]=I}const w=aQ(e);return{shaderName:g,errors:KC(s,w),warnings:KC(A,w)}}function KC(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],A=s.split(":",3),o=A[0],g=parseInt(A[1],10)||0,w=s.substring(A.join(":").length+1).trim();n+=DR("^^^ ".concat(o,": ").concat(w,`

`),g)}}return n}function aQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,A)=>{const o=String(A+e),g=o.length;return DR(o,i-g)+n+s})}function DR(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function RR(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const lQ="Shader: GLSL source code must be a JavaScript string";class Sg extends oc{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return nn(!1),"unknown"}}constructor(e,n){j2(e),nn(typeof n.source=="string",lQ);const r=fy(n.source,null)||n.id||lh("unnamed ".concat(Sg.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=fy(n,null);r&&(this.id=lh(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Sg.getTypeName(this.shaderType),":").concat(this.id)}getName(){return fy(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:A}=oQ(r,this.source,this.shaderType,this.id);throw vn.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),vn.warn("GLSL compilation warnings in ".concat(i,`
`).concat(A))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Yx extends Sg{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Xx extends Sg{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const AQ={5126:ri.bind(null,"uniform1fv",Ea,1,Ks),35664:ri.bind(null,"uniform2fv",Ea,2,Ks),35665:ri.bind(null,"uniform3fv",Ea,3,Ks),35666:ri.bind(null,"uniform4fv",Ea,4,Ks),5124:ri.bind(null,"uniform1iv",Mc,1,Ks),35667:ri.bind(null,"uniform2iv",Mc,2,Ks),35668:ri.bind(null,"uniform3iv",Mc,3,Ks),35669:ri.bind(null,"uniform4iv",Mc,4,Ks),35670:ri.bind(null,"uniform1iv",Mc,1,Ks),35671:ri.bind(null,"uniform2iv",Mc,2,Ks),35672:ri.bind(null,"uniform3iv",Mc,3,Ks),35673:ri.bind(null,"uniform4iv",Mc,4,Ks),35674:ri.bind(null,"uniformMatrix2fv",Ea,4,xu),35675:ri.bind(null,"uniformMatrix3fv",Ea,9,xu),35676:ri.bind(null,"uniformMatrix4fv",Ea,16,xu),35678:Ps,35680:Ps,5125:ri.bind(null,"uniform1uiv",f1,1,Ks),36294:ri.bind(null,"uniform2uiv",f1,2,Ks),36295:ri.bind(null,"uniform3uiv",f1,3,Ks),36296:ri.bind(null,"uniform4uiv",f1,4,Ks),35685:ri.bind(null,"uniformMatrix2x3fv",Ea,6,xu),35686:ri.bind(null,"uniformMatrix2x4fv",Ea,8,xu),35687:ri.bind(null,"uniformMatrix3x2fv",Ea,6,xu),35688:ri.bind(null,"uniformMatrix3x4fv",Ea,12,xu),35689:ri.bind(null,"uniformMatrix4x2fv",Ea,8,xu),35690:ri.bind(null,"uniformMatrix4x3fv",Ea,12,xu),35678:Ps,35680:Ps,35679:Ps,35682:Ps,36289:Ps,36292:Ps,36293:Ps,36298:Ps,36299:Ps,36300:Ps,36303:Ps,36306:Ps,36307:Ps,36308:Ps,36311:Ps},uQ={},cQ={},hQ={},JC=[0];function NT(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(JC[0]=t,t=JC);const i=t.length;if(i%e&&vn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let A=0;A<i;A++)s[A]=t[A];return s}function Ea(t,e){return NT(t,e,Float32Array,uQ)}function Mc(t,e){return NT(t,e,Int32Array,cQ)}function f1(t,e){return NT(t,e,Uint32Array,hQ)}function eP(t,e,n){const r=AQ[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function fQ(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function dQ(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!pQ(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function pQ(t){return Array.isArray(t)||ArrayBuffer.isView(t)?mQ(t):isFinite(t)||t===!0||t===!1||t instanceof ef||t instanceof g0?!0:t instanceof ts?!!t.texture:!1}function gQ(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function mQ(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ps(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function ri(t,e,n,r){let i=null,s=null;return(A,o,g)=>{const w=e(g,n),C=w.length;let I=!1;if(i===null)i=new Float32Array(C),s=C,I=!0;else{nn(s===C,"Uniform length cannot change.");for(let k=0;k<C;++k)if(w[k]!==i[k]){I=!0;break}}return I&&(r(A,t,o,w),i.set(w)),I}}function Ks(t,e,n,r){t[e](n,r)}function xu(t,e,n,r){t[e](n,!1,r)}const yQ=5120,_Q=5121,vQ=5122,xQ=5123,tP=0,d1=1,wQ=2,bQ=3,p1=4,EQ=5,TQ=6,Ki=5126,SQ=35664,MQ=35665,CQ=35666,Ap=5124,PQ=35667,IQ=35668,kQ=35669,up=5125,LQ=36294,DQ=36295,RQ=36296,BQ=35670,zQ=35671,OQ=35672,FQ=35673,NQ=35674,UQ=35675,VQ=35676,GQ=35685,$Q=35686,jQ=35687,HQ=35688,WQ=35689,QQ=35690,l3={[Ki]:[Ki,1,"float"],[SQ]:[Ki,2,"vec2"],[MQ]:[Ki,3,"vec3"],[CQ]:[Ki,4,"vec4"],[Ap]:[Ap,1,"int"],[PQ]:[Ap,2,"ivec2"],[IQ]:[Ap,3,"ivec3"],[kQ]:[Ap,4,"ivec4"],[up]:[up,1,"uint"],[LQ]:[up,2,"uvec2"],[DQ]:[up,3,"uvec3"],[RQ]:[up,4,"uvec4"],[BQ]:[Ki,1,"bool"],[zQ]:[Ki,2,"bvec2"],[OQ]:[Ki,3,"bvec3"],[FQ]:[Ki,4,"bvec4"],[NQ]:[Ki,8,"mat2"],[GQ]:[Ki,8,"mat2x3"],[$Q]:[Ki,8,"mat2x4"],[UQ]:[Ki,12,"mat3"],[jQ]:[Ki,12,"mat3x2"],[HQ]:[Ki,12,"mat3x4"],[VQ]:[Ki,16,"mat4"],[WQ]:[Ki,16,"mat4x2"],[QQ]:[Ki,16,"mat4x3"]};function qQ(t){switch(t){case tP:return tP;case d1:return d1;case bQ:return d1;case wQ:return d1;case p1:return p1;case EQ:return p1;case TQ:return p1;default:return nn(!1),0}}function nP(t){const e=l3[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function BR(t,e){switch(t){case yQ:case _Q:case vQ:case xQ:t=Ki;break}for(const n in l3){const[r,i,s]=l3[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class ZQ{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:A,size:o}=n.getActiveAttrib(e.handle,i),g=n.getAttribLocation(e.handle,s);g>=0&&this._addAttribute(g,s,A,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!lr(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:A,size:o}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,A,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:A}=nP(r),o={type:s,size:i*A};this._inferProperties(e,n,o);const g={location:e,name:n,accessor:new Ma(o)};this.attributeInfos.push(g),this.attributeInfosByLocation[e]=g,this.attributeInfosByName[g.name]=g}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:A}=nP(r),o=new Ma({type:s,size:i*A}),g={location:e,name:n,accessor:o};this.varyingInfos.push(g),this.varyingInfosByName[g.name]=g}}const rP=4,YQ=35981,XQ=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class zR extends oc{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",XQ),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:A=YQ}=e;return this.hash=n||"",this.vs=typeof r=="string"?new Yx(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new Xx(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,nn(this.vs instanceof Yx),nn(this.fs instanceof Xx),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Ao(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,A)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new ZQ(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:A,end:o,isIndexed:g=!1,indexType:w=5123,instanceCount:C=0,isInstanced:I=C>0,vertexArray:k=null,transformFeedback:U,framebuffer:H,parameters:q={},uniforms:se,samplers:X}=e;if((se||X)&&(vn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(se||{})),vn.priority>=n){const te=H?H.id:"default",ie="mode=".concat(nh(this.gl,r)," verts=").concat(i," ")+"instances=".concat(C," indexType=").concat(nh(this.gl,w)," ")+"isInstanced=".concat(I," isIndexed=").concat(g," ")+"Framebuffer=".concat(te);vn.log(n,ie)()}return nn(k),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||I&&C===0?!1:(k.bindForDraw(i,C,()=>{if(H!==void 0&&(q=Object.assign({},q,{framebuffer:H})),U){const te=qQ(r);U.begin(te)}this._bindTextures(),Jl(this.gl,q,()=>{g&&I?this.gl2.drawElementsInstanced(r,i,w,s,C):g&&lr(this.gl)&&!isNaN(A)&&!isNaN(o)?this.gl2.drawRangeElements(r,A,o,i,w,s):g?this.gl.drawElements(r,i,w,s):I?this.gl2.drawArraysInstanced(r,s,i,C):this.gl.drawArrays(r,s,i)}),U&&U.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vn.priority>=2&&dQ(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,A=!1;if(s instanceof ts&&(s=s.texture),s instanceof ef)if(A=this.uniforms[n]!==r,A){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:g}=i;o.bind(g),s=g,this._textureUniforms[n]=o}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||A)&&gQ(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new Yx({handle:i});break;case 35632:r.fs=new Xx({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=lh(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),vn.time(rP,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),vn.timeEnd(rP,"linkProgram for ".concat(this._getName()))(),e.debug||vn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=fQ(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=eP(e,s,r),r.size>1)for(let A=0;A<r.size;A++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(A,"]")),this._uniformSetters["".concat(i,"[").concat(A,"]")]=eP(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const KQ=34918,JQ=34919,eq=35007,tq=36795,nq=35976,rq=35887,iq=36202;class g_ extends oc{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=lr(e),i=FT(e,Yr.TIMER_QUERY);let s=r||i;for(const A of n)switch(A){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:nn(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(eq)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?iq:rq)}beginTransformFeedbackQuery(){return this.begin(nq)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,JQ);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(tq)}getResult(){return this.gl2.getQueryParameter(this.handle,KQ)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return g_.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class OR extends oc{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return lr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ao(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,rd(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:A}=this._getBufferParams(n);return r<0?(this.unused[e]=i,vn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,A,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof Or?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let g1=null;function sq(t){return(!g1||g1.byteLength<t)&&(g1=new ArrayBuffer(t)),g1}function oq(t,e){const n=sq(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function aq(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,A=i*s;let o=0;for(let g=r;o<s;o++)e[g++]=n[o];for(;o<A;)o<A-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+A-o),o=A);return e}const lq="elements must be GL.ELEMENT_ARRAY_BUFFER";class Ta extends oc{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?lr(e)||wW()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ta(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ta.MAX_ATTRIBUTES=Ta.MAX_ATTRIBUTES||e.getParameter(34921),Ta.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Ta._setConstantFloatArray(e,n,r);break;case Int32Array:Ta._setConstantIntArray(e,n,r);break;case Uint32Array:Ta._setConstantUintArray(e,n,r);break;default:nn(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ta.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return nn(!e||e.target===34963,lq),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:A,offset:o,normalized:g,integer:w,divisor:C}=r,{gl:I,gl2:k}=this;return e=Number(e),this.bind(()=>{I.bindBuffer(34962,n.handle),w?(nn(lr(I)),k.vertexAttribIPointer(e,i,s,A,o)):I.vertexAttribPointer(e,i,s,g,A,o),I.enableVertexAttribArray(e),k.vertexAttribDivisor(e,C||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Ta.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let A=!this.buffer;if(this.buffer=this.buffer||new Or(this.gl,i),A=A||this.buffer.reallocate(i),A=A||!this._compareConstantArrayValues(r,this.bufferValue),A){const o=oq(n.constructor,s);aq({target:o,source:r,start:0,count:s}),this.buffer.subData(o),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:nn(!1)}}static _setConstantIntArray(e,n,r){switch(nn(lr(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:nn(!1)}}static _setConstantUintArray(e,n,r){switch(nn(lr(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:nn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return nn(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const Aq="VertexArray: attributes must be Buffers or constants (i.e. typed array)",uq=/^(.+)__LOCATION_([0-9]+)$/,cq=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class hq{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ta(e),bR(this,"VertexArray","v6.0",cq),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Or(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Or&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof Or&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:A,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(A)||A<0)return this.unused[e]=n,vn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const g=this._getAttributeInfo(o||A);if(!g)return s;const w=this.accessors[A]||{},C=Ma.resolve(g.accessor,w,r,i),{size:I,type:k}=C;return nn(Number.isFinite(I)&&Number.isFinite(k)),{location:A,accessor:C}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=uq.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof Or)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof Or){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof Or){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(Aq)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Ta.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Ta.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,A=s>0;if(e.isInstanced=e.isInstanced||A,r instanceof Or){const o=r;if(A){const g=o.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,g)}else{const g=o.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,g)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function fq(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let A=0;A<t.length&&A<n;++A)A>0&&(i+=",".concat(A%r===0?" ":"")),i+=Mg(t[A],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function Mg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return fq(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function iP(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;nn(n);const s=".*_.*",A=".*Matrix",o=n._uniformSetters,g={},w=Object.keys(o).sort();let C=0;for(const U of w)!U.match(s)&&!U.match(A)&&Kx({table:g,header:e,uniforms:r,uniformName:U,undefinedOnly:i})&&C++;for(const U of w)U.match(A)&&Kx({table:g,header:e,uniforms:r,uniformName:U,undefinedOnly:i})&&C++;for(const U of w)g[U]||Kx({table:g,header:e,uniforms:r,uniformName:U,undefinedOnly:i})&&C++;let I=0;const k={};if(!i)for(const U in r){const H=r[U];g[U]||(I++,k[U]={Type:"NOT USED: ".concat(H),[e]:Mg(H)})}return{table:g,count:C,unusedTable:k,unusedCount:I}}function Kx(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const A=r[i],o=dq(A);return!s||!o?(e[i]={[n]:o?Mg(A):"N/A","Uniform Type":o?A:"NOT PROVIDED"},!0):!1}function dq(t){return t!=null}function pq(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=sP(e,e.elements,null,n));const i=e.values;for(const s in i){const A=e._getAttributeInfo(s);if(A){let o="".concat(s,": ").concat(A.name);const g=e.accessors[A.location];g&&(o="".concat(s,": ").concat(gq(A.name,g))),r[o]=sP(e,i[s],g,n)}}return r}function sP(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",A=1,o=0,g=0,w,C,I;if(n&&(s=n.type,A=n.size,s=String(s).replace("Array",""),w=s.indexOf("nt")!==-1),e instanceof Or){const k=e,{data:U,changed:H}=k.getDebugData();C=H?"*":"",I=U,g=k.byteLength,o=g/U.BYTES_PER_ELEMENT/A;let q;if(n){const se=n.divisor>0;q="".concat(se?"I ":"P "," ").concat(o," (x").concat(A,"=").concat(g," bytes ").concat(nh(i,s),")")}else w=!0,q="".concat(g," bytes");return{[r]:"".concat(C).concat(Mg(I,{size:A,isInteger:w})),"Format ":q}}return I=e,A=e.length,s=String(e.constructor.name).replace("Array",""),w=s.indexOf("nt")!==-1,{[r]:"".concat(Mg(I,{size:A,isInteger:w})," (constant)"),"Format ":"".concat(A,"x").concat(s," (constant)")}}function gq(t,e){const{type:n,size:r}=e,i=BR(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function mq(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=oP(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=oP(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function oP(t){const{type:e,size:n}=t.accessor,r=BR(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}function yq(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function _q(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||yq()}const aP=_q()&&typeof document<"u";let vq=0;class xq{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=se=>vR(se),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:A=()=>{},onError:o,gl:g=null,glOptions:w={},debug:C=!1,createFramebuffer:I=!1,autoResizeViewport:k=!0,autoResizeDrawingBuffer:U=!0,stats:H=Vh.get("animation-loop-".concat(vq++))}=e;let{useDevicePixels:q=!0}=e;"useDevicePixelRatio"in e&&(vn.deprecated("useDevicePixelRatio","useDevicePixels")(),q=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:A,onError:o,gl:g,glOptions:w,debug:C,createFramebuffer:I},this.gl=g,this.needsRedraw=null,this.timeline=null,this.stats=H,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:k,autoResizeDrawingBuffer:U,useDevicePixels:q}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return nn(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=g_.isSupported(this.gl,["timers"])?new g_(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return vn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=aP?new Promise((e,n)=>{if(aP&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):SW(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):TW(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?BT(this.props.gl,e):this.onCreateContext(e),!$2(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");uW(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&pW(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new ts(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const lm="vs",UT="fs";function La(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Jx={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function wq(t){const e={};for(const n in t){const r=t[n],i=bq(r);e[n]=i}return e}function bq(t){let e=lP(t);return e==="object"?t?"type"in t?Object.assign({},t,Jx[t.type]):"value"in t?(e=lP(t.value),Object.assign({type:e},t,Jx[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Jx[e])}function lP(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Eq="vs",Tq="fs";class AP{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:A,getUniforms:o,deprecations:g=[],defines:w={},inject:C={},vertexShader:I,fragmentShader:k}=e;La(typeof n=="string"),this.name=n,this.vs=r||I,this.fs=i||k,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(g),this.defines=w,this.injections=Sq(C),A&&(this.uniforms=wq(A))}getModuleSource(e){let n;switch(e){case Eq:n=this.vs||"";break;case Tq:n=this.fs||"";break;default:La(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&La(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function Sq(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function Mq(t){return Cq(NR(t))}function Cq(t){const e={},n={};return FR({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function FR(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&FR({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function NR(t,e){return t.map(n=>(n instanceof AP||(La(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),La(n.name,"shader module has no name"),n=new AP(n),n.dependencies=NR(n.dependencies)),n))}function Pq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const Iq=7936,kq=7937,Lq=7938,Dq=35724,VT={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Bh={};Object.keys(VT).forEach(t=>{Bh[t]=t});function Rq(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Bq(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Iq),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||kq);return{gpuVendor:zq(n,r),vendor:n,renderer:r,version:t.getParameter(Lq),shadingLanguageVersion:t.getParameter(Dq)}}function zq(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const ew={};function uP(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=VT[e];if(La(r,e),!Pq(n))return!0;if(e in ew)return ew[e];const i=r[0],s=n.behavior||"enable",A="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=t.createShader(35633);t.shaderSource(o,A),t.compileShader(o);const g=t.getShaderParameter(o,35713);return t.deleteShader(o),ew[e]=g,g}function Oq(t,e){const n=VT[e];La(n,e);const r=Rq(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return La(i===!1||i===!0),i}function m1(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Oq(t,n))}function Fq(t){switch(Bq(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Nq(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return m1(t,Bh.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),m1(t,Bh.GLSL_DERIVATIVES)&&uP(t,Bh.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),m1(t,Bh.GLSL_FRAG_DATA)&&uP(t,Bh.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),m1(t,Bh.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const Uq=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,Vq=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Gq={[lm]:Uq,[UT]:Vq},dy="__LUMA_INJECT_DECLARATIONS__",cP=/void\s+main\s*\([^)]*\)\s*\{\n?/,hP=/}\n?[^{}]*$/,tw=[];function fP(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===lm;for(const s in n){const A=n[s];A.sort((g,w)=>g.order-w.order),tw.length=A.length;for(let g=0,w=A.length;g<w;++g)tw[g]=A[g].injection;const o="".concat(tw.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(dy,o));break;case"vs:#main-start":i&&(t=t.replace(cP,g=>g+o));break;case"vs:#main-end":i&&(t=t.replace(hP,g=>o+g));break;case"fs:#decl":i||(t=t.replace(dy,o));break;case"fs:#main-start":i||(t=t.replace(cP,g=>g+o));break;case"fs:#main-end":i||(t=t.replace(hP,g=>o+g));break;default:t=t.replace(s,g=>g+o)}}return t=t.replace(dy,""),r&&(t=t.replace(/\}\s*$/,s=>s+Gq[e])),t}function A3(t){const e={};return La(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function id(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const UR=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],$q=[...UR,[id("attribute"),"in $1"],[id("varying"),"out $1"]],jq=[...UR,[id("varying"),"in $1"]],VR=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Hq=[...VR,[id("in"),"attribute $1"],[id("out"),"varying $1"]],Wq=[...VR,[id("in"),"varying $1"]],u3="gl_FragColor",c3=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Qq=/void\s+main\s*\([^)]*\)\s*\{\n?/;function qq(t,e,n){switch(e){case 300:return n?m_(t,$q):Zq(t);case 100:return n?m_(t,Hq):Yq(t);default:throw new Error("unknown GLSL version ".concat(e))}}function m_(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function Zq(t){t=m_(t,jq);const e=t.match(c3);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(u3,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(Qq,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(u3,"\\b"),"g"),n)}return t}function Yq(t){t=m_(t,Wq);const e=t.match(c3);if(e){const n=e[1];t=t.replace(c3,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),u3)}return t}const Xq=`

`.concat(dy,`

`),GR={[lm]:"vertex",[UT]:"fragment"},Kq=`precision highp float;

`;function Jq(t,e){const{vs:n,fs:r}=e,i=Mq(e.modules||[]);return{gl:t,vs:dP(t,Object.assign({},e,{source:n,type:lm,modules:i})),fs:dP(t,Object.assign({},e,{source:r,type:UT,modules:i})),getUniforms:eZ(i)}}function dP(t,e){let{id:n,source:r,type:i,modules:s,defines:A={},hookFunctions:o=[],inject:g={},transpileToGLSL100:w=!1,prologue:C=!0,log:I}=e;La(typeof r=="string","shader source must be a string");const k=i===lm,U=r.split(`
`);let H=100,q="",se=r;U[0].indexOf("#version ")===0?(H=300,q=U[0],se=U.slice(1).join(`
`)):q="#version ".concat(H);const X={};s.forEach(He=>{Object.assign(X,He.getDefines())}),Object.assign(X,A);let te=C?"".concat(q,`
`).concat(nZ({id:n,source:r,type:i}),`
`).concat(tZ({type:i}),`
`).concat(Fq(t),`
`).concat(Nq(t),`
`).concat(rZ(X),`
`).concat(k?"":Kq,`
`):"".concat(q,`
`);const ie=sZ(o),fe={},me={},Se={};for(const He in g){const Qe=typeof g[He]=="string"?{injection:g[He],order:0}:g[He],Ke=He.match(/^(v|f)s:(#)?([\w-]+)$/);if(Ke){const nt=Ke[2],Ne=Ke[3];nt?Ne==="decl"?me[He]=[Qe]:Se[He]=[Qe]:fe[He]=[Qe]}else Se[He]=[Qe]}for(const He of s){I&&He.checkDeprecations(se,I);const Qe=He.getModuleSource(i,H);te+=Qe;const Ke=He.injections[i];for(const nt in Ke){const Ne=nt.match(/^(v|f)s:#([\w-]+)$/);if(Ne){const Ze=Ne[2]==="decl"?me:Se;Ze[nt]=Ze[nt]||[],Ze[nt].push(Ke[nt])}else fe[nt]=fe[nt]||[],fe[nt].push(Ke[nt])}}return te+=Xq,te=fP(te,i,me),te+=iZ(ie[i],fe),te+=se,te=fP(te,i,Se),te=qq(te,w?100:H,k),te}function eZ(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function tZ(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(GR[e].toUpperCase(),`
`)}function nZ(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(GR[r],`

`):""}function rZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function iZ(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((A,o)=>A.order-o.order);for(const A of s)n+="  ".concat(A.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function sZ(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),A=n.replace(/\(.+/,"");e[i][A]=Object.assign(r,{signature:s})}),e}const oZ="void main() {gl_FragColor = vec4(0);}",$R=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,aZ=`#version 300 es
`.concat($R);function jR(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const A=s.split(";")[0];return{qualifier:r,type:i,name:A}}function HR(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?aZ:e>300?"#version ".concat(e,`
`).concat($R):oZ;const s=uZ(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function lZ(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return La(!1),null}}function AZ(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return La(!1),null}}function uZ(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return La(!1),null}}const cZ=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,hZ={name:"fp32",vs:cZ,fs:null};function Cg(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Io={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function fZ(t,{precision:e=Io.precision}={}){return t=dZ(t),"".concat(parseFloat(t.toPrecision(e)))}function tf(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function $c(t,e,n){return gZ(t,r=>Math.max(e,Math.min(n,r)))}function ul(t,e,n){return tf(t)?t.map((r,i)=>ul(r,e[i],n)):n*e+(1-n)*t}function Uu(t,e,n){const r=Io.EPSILON;n&&(Io.EPSILON=n);try{if(t===e)return!0;if(tf(t)&&tf(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Uu(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Io.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Io.EPSILON=r}}function dZ(t){return Math.round(t/Io.EPSILON)*Io.EPSILON}function pZ(t){return t.clone?t.clone():new Array(t.length)}function gZ(t,e,n){if(tf(t)){const r=t;n=n||pZ(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function mZ(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class GT extends mZ(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:tf(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Io)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+fZ(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Uu(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Io.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function yZ(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Gr(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function eg(t,e,n=""){if(Io.debug&&!yZ(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class WR extends GT{get x(){return this[0]}set x(e){this[0]=Gr(e)}get y(){return this[1]}set y(e){this[1]=Gr(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Gr(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Gr(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Cg(e>=0&&e<this.ELEMENTS,"index is out of range"),Gr(this[e])}setComponent(e,n){return Cg(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var tg=1e-6,tA=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function _Z(){var t=new tA(2);return tA!=Float32Array&&(t[0]=0,t[1]=0),t}function h3(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function vZ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function xZ(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function wZ(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function bZ(t,e){return t[0]=-e[0],t[1]=-e[1],t}function QR(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function EZ(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function TZ(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var SZ=vZ;(function(){var t=_Z();return function(e,n,r,i,s,A){var o,g;for(n||(n=2),r||(r=0),i?g=Math.min(i*n+r,e.length):g=e.length,o=r;o<g;o+=n)t[0]=e[o],t[1]=e[o+1],s(t,t,A),e[o]=t[0],e[o+1]=t[1];return e}})();function MZ(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function qR(t,e,n){const r=e[0],i=e[1],s=e[2],A=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/A,t[1]=(n[1]*r+n[5]*i+n[9]*s)/A,t[2]=(n[2]*r+n[6]*i+n[10]*s)/A,t}function CZ(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function PZ(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function ZR(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*s,t[1]=n[1]*r+n[4]*i+n[7]*s,t[2]=n[2]*r+n[5]*i+n[8]*s,t[3]=e[3],t}function YR(){var t=new tA(3);return tA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function IZ(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function pP(t,e,n){var r=new tA(3);return r[0]=t,r[1]=e,r[2]=n,r}function kZ(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function LZ(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function DZ(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function RZ(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function BZ(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function XR(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function py(t,e,n){var r=e[0],i=e[1],s=e[2],A=n[0],o=n[1],g=n[2];return t[0]=i*g-s*o,t[1]=s*A-r*g,t[2]=r*o-i*A,t}function zZ(t,e,n,r){var i=e[0],s=e[1],A=e[2];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=A+r*(n[2]-A),t}function $T(t,e,n){var r=e[0],i=e[1],s=e[2],A=n[3]*r+n[7]*i+n[11]*s+n[15];return A=A||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/A,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/A,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/A,t}function KR(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function JR(t,e,n){var r=n[0],i=n[1],s=n[2],A=n[3],o=e[0],g=e[1],w=e[2],C=i*w-s*g,I=s*o-r*w,k=r*g-i*o,U=i*k-s*I,H=s*C-r*k,q=r*I-i*C,se=A*2;return C*=se,I*=se,k*=se,U*=2,H*=2,q*=2,t[0]=o+C+U,t[1]=g+I+H,t[2]=w+k+q,t}function OZ(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function FZ(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function NZ(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function UZ(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],A=e[1],o=e[2],g=Math.sqrt(n*n+r*r+i*i),w=Math.sqrt(s*s+A*A+o*o),C=g*w,I=C&&XR(t,e)/C;return Math.acos(Math.min(Math.max(I,-1),1))}var eB=kZ,VZ=LZ,tB=IZ,nw=DZ;(function(){var t=YR();return function(e,n,r,i,s,A){var o,g;for(n||(n=3),r||(r=0),i?g=Math.min(i*n+r,e.length):g=e.length,o=r;o<g;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,A),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const rw=[0,0,0];let y1;class An extends WR{static get ZERO(){return y1||(y1=new An(0,0,0),Object.freeze(y1)),y1}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&tf(e)?this.copy(e):(Io.debug&&(Gr(e),Gr(n),Gr(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Io.debug&&(Gr(e.x),Gr(e.y),Gr(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Gr(e)}angle(e){return UZ(this,e)}cross(e){return py(this,this,e),this.check()}rotateX({radians:e,origin:n=rw}){return OZ(this,this,n,e),this.check()}rotateY({radians:e,origin:n=rw}){return FZ(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=rw}){return NZ(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return $T(this,this,e),this.check()}transformAsVector(e){return qR(this,this,e),this.check()}transformByMatrix3(e){return KR(this,this,e),this.check()}transformByMatrix2(e){return CZ(this,this,e),this.check()}transformByQuaternion(e){return JR(this,this,e),this.check()}}let _1;class jT extends WR{static get ZERO(){return _1||(_1=new jT(0,0,0,0),Object.freeze(_1)),_1}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),tf(e)&&arguments.length===1?this.copy(e):(Io.debug&&(Gr(e),Gr(n),Gr(r),Gr(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Io.debug&&(Gr(e.x),Gr(e.y),Gr(e.z),Gr(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Gr(e)}get w(){return this[3]}set w(e){this[3]=Gr(e)}transform(e){return $T(this,this,e),this.check()}transformByMatrix3(e){return ZR(this,this,e),this.check()}transformByMatrix2(e){return PZ(this,this,e),this.check()}transformByQuaternion(e){return JR(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class nB extends GT{toString(){let e="[";if(Io.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Gr(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function GZ(){var t=new tA(9);return tA!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function $Z(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function jZ(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=e[4],o=e[5],g=e[6],w=e[7],C=e[8],I=C*A-o*w,k=-C*s+o*g,U=w*s-A*g,H=n*I+r*k+i*U;return H?(H=1/H,t[0]=I*H,t[1]=(-C*r+i*w)*H,t[2]=(o*r-i*A)*H,t[3]=k*H,t[4]=(C*n-i*g)*H,t[5]=(-o*n+i*s)*H,t[6]=U*H,t[7]=(-w*n+r*g)*H,t[8]=(A*n-r*s)*H,t):null}function HZ(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],A=t[5],o=t[6],g=t[7],w=t[8];return e*(w*s-A*g)+n*(-w*i+A*o)+r*(g*i-s*o)}function gP(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],o=e[4],g=e[5],w=e[6],C=e[7],I=e[8],k=n[0],U=n[1],H=n[2],q=n[3],se=n[4],X=n[5],te=n[6],ie=n[7],fe=n[8];return t[0]=k*r+U*A+H*w,t[1]=k*i+U*o+H*C,t[2]=k*s+U*g+H*I,t[3]=q*r+se*A+X*w,t[4]=q*i+se*o+X*C,t[5]=q*s+se*g+X*I,t[6]=te*r+ie*A+fe*w,t[7]=te*i+ie*o+fe*C,t[8]=te*s+ie*g+fe*I,t}function WZ(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],o=e[4],g=e[5],w=e[6],C=e[7],I=e[8],k=n[0],U=n[1];return t[0]=r,t[1]=i,t[2]=s,t[3]=A,t[4]=o,t[5]=g,t[6]=k*r+U*A+w,t[7]=k*i+U*o+C,t[8]=k*s+U*g+I,t}function QZ(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],o=e[4],g=e[5],w=e[6],C=e[7],I=e[8],k=Math.sin(n),U=Math.cos(n);return t[0]=U*r+k*A,t[1]=U*i+k*o,t[2]=U*s+k*g,t[3]=U*A-k*r,t[4]=U*o-k*i,t[5]=U*g-k*s,t[6]=w,t[7]=C,t[8]=I,t}function mP(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function qZ(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=n+n,o=r+r,g=i+i,w=n*A,C=r*A,I=r*o,k=i*A,U=i*o,H=i*g,q=s*A,se=s*o,X=s*g;return t[0]=1-I-H,t[3]=C-X,t[6]=k+se,t[1]=C+X,t[4]=1-w-H,t[7]=U-q,t[2]=k-se,t[5]=U+q,t[8]=1-w-I,t}var f3;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(f3||(f3={}));const ZZ=Object.freeze([1,0,0,0,1,0,0,0,1]);class ks extends nB{static get IDENTITY(){return XZ()}static get ZERO(){return YZ()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return f3}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(ZZ)}fromObject(e){return this.check()}fromQuaternion(e){return qZ(this,e),this.check()}set(e,n,r,i,s,A,o,g,w){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=A,this[6]=o,this[7]=g,this[8]=w,this.check()}setRowMajor(e,n,r,i,s,A,o,g,w){return this[0]=e,this[1]=i,this[2]=o,this[3]=n,this[4]=s,this[5]=g,this[6]=r,this[7]=A,this[8]=w,this.check()}determinant(){return HZ(this)}transpose(){return $Z(this,this),this.check()}invert(){return jZ(this,this),this.check()}multiplyLeft(e){return gP(this,e,this),this.check()}multiplyRight(e){return gP(this,this,e),this.check()}rotate(e){return QZ(this,this,e),this.check()}scale(e){return Array.isArray(e)?mP(this,this,e):mP(this,this,[e,e]),this.check()}translate(e){return WZ(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=EZ(n||[-0,-0],e,this);break;case 3:r=KR(n||[-0,-0,-0],e,this);break;case 4:r=ZR(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return eg(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let v1,x1;function YZ(){return v1||(v1=new ks([0,0,0,0,0,0,0,0,0]),Object.freeze(v1)),v1}function XZ(){return x1||(x1=new ks,Object.freeze(x1)),x1}function KZ(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function JZ(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],A=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=A,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function d3(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=e[4],o=e[5],g=e[6],w=e[7],C=e[8],I=e[9],k=e[10],U=e[11],H=e[12],q=e[13],se=e[14],X=e[15],te=n*o-r*A,ie=n*g-i*A,fe=n*w-s*A,me=r*g-i*o,Se=r*w-s*o,He=i*w-s*g,Qe=C*q-I*H,Ke=C*se-k*H,nt=C*X-U*H,Ne=I*se-k*q,rt=I*X-U*q,Ze=k*X-U*se,mt=te*Ze-ie*rt+fe*Ne+me*nt-Se*Ke+He*Qe;return mt?(mt=1/mt,t[0]=(o*Ze-g*rt+w*Ne)*mt,t[1]=(i*rt-r*Ze-s*Ne)*mt,t[2]=(q*He-se*Se+X*me)*mt,t[3]=(k*Se-I*He-U*me)*mt,t[4]=(g*nt-A*Ze-w*Ke)*mt,t[5]=(n*Ze-i*nt+s*Ke)*mt,t[6]=(se*fe-H*He-X*ie)*mt,t[7]=(C*He-k*fe+U*ie)*mt,t[8]=(A*rt-o*nt+w*Qe)*mt,t[9]=(r*nt-n*rt-s*Qe)*mt,t[10]=(H*Se-q*fe+X*te)*mt,t[11]=(I*fe-C*Se-U*te)*mt,t[12]=(o*Ke-A*Ne-g*Qe)*mt,t[13]=(n*Ne-r*Ke+i*Qe)*mt,t[14]=(q*ie-H*me-se*te)*mt,t[15]=(C*me-I*ie+k*te)*mt,t):null}function eY(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],A=t[5],o=t[6],g=t[7],w=t[8],C=t[9],I=t[10],k=t[11],U=t[12],H=t[13],q=t[14],se=t[15],X=e*A-n*s,te=e*o-r*s,ie=e*g-i*s,fe=n*o-r*A,me=n*g-i*A,Se=r*g-i*o,He=w*H-C*U,Qe=w*q-I*U,Ke=w*se-k*U,nt=C*q-I*H,Ne=C*se-k*H,rt=I*se-k*q;return X*rt-te*Ne+ie*nt+fe*Ke-me*Qe+Se*He}function Hh(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],o=e[4],g=e[5],w=e[6],C=e[7],I=e[8],k=e[9],U=e[10],H=e[11],q=e[12],se=e[13],X=e[14],te=e[15],ie=n[0],fe=n[1],me=n[2],Se=n[3];return t[0]=ie*r+fe*o+me*I+Se*q,t[1]=ie*i+fe*g+me*k+Se*se,t[2]=ie*s+fe*w+me*U+Se*X,t[3]=ie*A+fe*C+me*H+Se*te,ie=n[4],fe=n[5],me=n[6],Se=n[7],t[4]=ie*r+fe*o+me*I+Se*q,t[5]=ie*i+fe*g+me*k+Se*se,t[6]=ie*s+fe*w+me*U+Se*X,t[7]=ie*A+fe*C+me*H+Se*te,ie=n[8],fe=n[9],me=n[10],Se=n[11],t[8]=ie*r+fe*o+me*I+Se*q,t[9]=ie*i+fe*g+me*k+Se*se,t[10]=ie*s+fe*w+me*U+Se*X,t[11]=ie*A+fe*C+me*H+Se*te,ie=n[12],fe=n[13],me=n[14],Se=n[15],t[12]=ie*r+fe*o+me*I+Se*q,t[13]=ie*i+fe*g+me*k+Se*se,t[14]=ie*s+fe*w+me*U+Se*X,t[15]=ie*A+fe*C+me*H+Se*te,t}function y_(t,e,n){var r=n[0],i=n[1],s=n[2],A,o,g,w,C,I,k,U,H,q,se,X;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(A=e[0],o=e[1],g=e[2],w=e[3],C=e[4],I=e[5],k=e[6],U=e[7],H=e[8],q=e[9],se=e[10],X=e[11],t[0]=A,t[1]=o,t[2]=g,t[3]=w,t[4]=C,t[5]=I,t[6]=k,t[7]=U,t[8]=H,t[9]=q,t[10]=se,t[11]=X,t[12]=A*r+C*i+H*s+e[12],t[13]=o*r+I*i+q*s+e[13],t[14]=g*r+k*i+se*s+e[14],t[15]=w*r+U*i+X*s+e[15]),t}function HT(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function tY(t,e,n,r){var i=r[0],s=r[1],A=r[2],o=Math.hypot(i,s,A),g,w,C,I,k,U,H,q,se,X,te,ie,fe,me,Se,He,Qe,Ke,nt,Ne,rt,Ze,mt,Kt;return o<tg?null:(o=1/o,i*=o,s*=o,A*=o,g=Math.sin(n),w=Math.cos(n),C=1-w,I=e[0],k=e[1],U=e[2],H=e[3],q=e[4],se=e[5],X=e[6],te=e[7],ie=e[8],fe=e[9],me=e[10],Se=e[11],He=i*i*C+w,Qe=s*i*C+A*g,Ke=A*i*C-s*g,nt=i*s*C-A*g,Ne=s*s*C+w,rt=A*s*C+i*g,Ze=i*A*C+s*g,mt=s*A*C-i*g,Kt=A*A*C+w,t[0]=I*He+q*Qe+ie*Ke,t[1]=k*He+se*Qe+fe*Ke,t[2]=U*He+X*Qe+me*Ke,t[3]=H*He+te*Qe+Se*Ke,t[4]=I*nt+q*Ne+ie*rt,t[5]=k*nt+se*Ne+fe*rt,t[6]=U*nt+X*Ne+me*rt,t[7]=H*nt+te*Ne+Se*rt,t[8]=I*Ze+q*mt+ie*Kt,t[9]=k*Ze+se*mt+fe*Kt,t[10]=U*Ze+X*mt+me*Kt,t[11]=H*Ze+te*mt+Se*Kt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function rB(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],A=e[5],o=e[6],g=e[7],w=e[8],C=e[9],I=e[10],k=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+w*r,t[5]=A*i+C*r,t[6]=o*i+I*r,t[7]=g*i+k*r,t[8]=w*i-s*r,t[9]=C*i-A*r,t[10]=I*i-o*r,t[11]=k*i-g*r,t}function nY(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],A=e[1],o=e[2],g=e[3],w=e[8],C=e[9],I=e[10],k=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-w*r,t[1]=A*i-C*r,t[2]=o*i-I*r,t[3]=g*i-k*r,t[8]=s*r+w*i,t[9]=A*r+C*i,t[10]=o*r+I*i,t[11]=g*r+k*i,t}function iB(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],A=e[1],o=e[2],g=e[3],w=e[4],C=e[5],I=e[6],k=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+w*r,t[1]=A*i+C*r,t[2]=o*i+I*r,t[3]=g*i+k*r,t[4]=w*i-s*r,t[5]=C*i-A*r,t[6]=I*i-o*r,t[7]=k*i-g*r,t}function rY(t,e){var n=e[0],r=e[1],i=e[2],s=e[4],A=e[5],o=e[6],g=e[8],w=e[9],C=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(s,A,o),t[2]=Math.hypot(g,w,C),t}function iY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=n+n,o=r+r,g=i+i,w=n*A,C=r*A,I=r*o,k=i*A,U=i*o,H=i*g,q=s*A,se=s*o,X=s*g;return t[0]=1-I-H,t[1]=C+X,t[2]=k-se,t[3]=0,t[4]=C-X,t[5]=1-w-H,t[6]=U+q,t[7]=0,t[8]=k+se,t[9]=U-q,t[10]=1-w-I,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sY(t,e,n,r,i,s,A){var o=1/(n-e),g=1/(i-r),w=1/(s-A);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*g,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*g,t[10]=(A+s)*w,t[11]=-1,t[12]=0,t[13]=0,t[14]=A*s*2*w,t[15]=0,t}function oY(t,e,n,r,i){var s=1/Math.tan(e/2),A;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(A=1/(r-i),t[10]=(i+r)*A,t[14]=2*i*r*A):(t[10]=-1,t[14]=-2*r),t}var aY=oY;function lY(t,e,n,r,i,s,A){var o=1/(e-n),g=1/(r-i),w=1/(s-A);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*g,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*w,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*g,t[14]=(A+s)*w,t[15]=1,t}var AY=lY;function uY(t,e,n,r){var i,s,A,o,g,w,C,I,k,U,H=e[0],q=e[1],se=e[2],X=r[0],te=r[1],ie=r[2],fe=n[0],me=n[1],Se=n[2];return Math.abs(H-fe)<tg&&Math.abs(q-me)<tg&&Math.abs(se-Se)<tg?KZ(t):(C=H-fe,I=q-me,k=se-Se,U=1/Math.hypot(C,I,k),C*=U,I*=U,k*=U,i=te*k-ie*I,s=ie*C-X*k,A=X*I-te*C,U=Math.hypot(i,s,A),U?(U=1/U,i*=U,s*=U,A*=U):(i=0,s=0,A=0),o=I*A-k*s,g=k*i-C*A,w=C*s-I*i,U=Math.hypot(o,g,w),U?(U=1/U,o*=U,g*=U,w*=U):(o=0,g=0,w=0),t[0]=i,t[1]=o,t[2]=C,t[3]=0,t[4]=s,t[5]=g,t[6]=I,t[7]=0,t[8]=A,t[9]=w,t[10]=k,t[11]=0,t[12]=-(i*H+s*q+A*se),t[13]=-(o*H+g*q+w*se),t[14]=-(C*H+I*q+k*se),t[15]=1,t)}function cY(){var t=new tA(4);return tA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function hY(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function WT(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function fY(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function dY(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function pY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=n*n+r*r+i*i+s*s;return A>0&&(A=1/Math.sqrt(A)),t[0]=n*A,t[1]=r*A,t[2]=i*A,t[3]=s*A,t}function gY(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function mY(t,e,n,r){var i=e[0],s=e[1],A=e[2],o=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=A+r*(n[2]-A),t[3]=o+r*(n[3]-o),t}function Ed(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*A,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*A,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*A,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*A,t}function yY(t,e,n){var r=e[0],i=e[1],s=e[2],A=n[0],o=n[1],g=n[2],w=n[3],C=w*r+o*s-g*i,I=w*i+g*r-A*s,k=w*s+A*i-o*r,U=-A*r-o*i-g*s;return t[0]=C*w+U*-A+I*-g-k*-o,t[1]=I*w+U*-o+k*-A-C*-g,t[2]=k*w+U*-g+C*-o-I*-A,t[3]=e[3],t}(function(){var t=cY();return function(e,n,r,i,s,A){var o,g;for(n||(n=4),r||(r=0),i?g=Math.min(i*n+r,e.length):g=e.length,o=r;o<g;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,A),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var p3;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(p3||(p3={}));const _Y=45*Math.PI/180,vY=1,iw=.1,sw=500,xY=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ia extends nB{static get IDENTITY(){return bY()}static get ZERO(){return wY()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return p3}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,A,o,g,w,C,I,k,U,H,q,se){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=A,this[6]=o,this[7]=g,this[8]=w,this[9]=C,this[10]=I,this[11]=k,this[12]=U,this[13]=H,this[14]=q,this[15]=se,this.check()}setRowMajor(e,n,r,i,s,A,o,g,w,C,I,k,U,H,q,se){return this[0]=e,this[1]=s,this[2]=w,this[3]=U,this[4]=n,this[5]=A,this[6]=C,this[7]=H,this[8]=r,this[9]=o,this[10]=I,this[11]=q,this[12]=i,this[13]=g,this[14]=k,this[15]=se,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(xY)}fromObject(e){return this.check()}fromQuaternion(e){return iY(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:A=iw,far:o=sw}=e;return o===1/0?EY(this,n,r,i,s,A):sY(this,n,r,i,s,A,o),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return uY(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:A=iw,far:o=sw}=e;return AY(this,n,r,i,s,A,o),this.check()}orthographic(e){const{fovy:n=_Y,aspect:r=vY,focalDistance:i=1,near:s=iw,far:A=sw}=e;yP(n);const o=n/2,g=i*Math.tan(o),w=g*r;return this.ortho({left:-w,right:w,bottom:-g,top:g,near:s,far:A})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return yP(n),aY(this,n,r,i,s),this.check()}determinant(){return eY(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],A=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*A,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*A,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*A,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],A=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*A,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*A,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*A,e}transpose(){return JZ(this,this),this.check()}invert(){return d3(this,this),this.check()}multiplyLeft(e){return Hh(this,e,this),this.check()}multiplyRight(e){return Hh(this,this,e),this.check()}rotateX(e){return rB(this,this,e),this.check()}rotateY(e){return nY(this,this,e),this.check()}rotateZ(e){return iB(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return tY(this,this,e,n),this.check()}scale(e){return HT(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return y_(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Ed(n||[-0,-0,-0,-0],e,this),eg(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=TZ(n||[-0,-0],e,this);break;case 3:i=$T(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return eg(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=MZ(n||[-0,-0],e,this);break;case 3:r=qR(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return eg(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let w1,b1;function wY(){return w1||(w1=new ia([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(w1)),w1}function bY(){return b1||(b1=new ia,Object.freeze(b1)),b1}function yP(t){if(t>Math.PI*2)throw Error("expected radians")}function EY(t,e,n,r,i,s){const A=2*s/(n-e),o=2*s/(i-r),g=(n+e)/(n-e),w=(i+r)/(i-r),C=-1,I=-1,k=-2*s;return t[0]=A,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=g,t[9]=w,t[10]=C,t[11]=I,t[12]=0,t[13]=0,t[14]=k,t[15]=0,t}function _P(){var t=new tA(4);return tA!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function TY(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function sB(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function vP(t,e,n){var r=e[0],i=e[1],s=e[2],A=e[3],o=n[0],g=n[1],w=n[2],C=n[3];return t[0]=r*C+A*o+i*w-s*g,t[1]=i*C+A*g+s*o-r*w,t[2]=s*C+A*w+r*g-i*o,t[3]=A*C-r*o-i*g-s*w,t}function SY(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],A=e[3],o=Math.sin(n),g=Math.cos(n);return t[0]=r*g+A*o,t[1]=i*g+s*o,t[2]=s*g-i*o,t[3]=A*g-r*o,t}function MY(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],A=e[3],o=Math.sin(n),g=Math.cos(n);return t[0]=r*g-s*o,t[1]=i*g+A*o,t[2]=s*g+r*o,t[3]=A*g-i*o,t}function CY(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],A=e[3],o=Math.sin(n),g=Math.cos(n);return t[0]=r*g+i*o,t[1]=i*g-r*o,t[2]=s*g+A*o,t[3]=A*g-s*o,t}function PY(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function gy(t,e,n,r){var i=e[0],s=e[1],A=e[2],o=e[3],g=n[0],w=n[1],C=n[2],I=n[3],k,U,H,q,se;return U=i*g+s*w+A*C+o*I,U<0&&(U=-U,g=-g,w=-w,C=-C,I=-I),1-U>tg?(k=Math.acos(U),H=Math.sin(k),q=Math.sin((1-r)*k)/H,se=Math.sin(r*k)/H):(q=1-r,se=r),t[0]=q*i+se*g,t[1]=q*s+se*w,t[2]=q*A+se*C,t[3]=q*o+se*I,t}function IY(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],A=n*n+r*r+i*i+s*s,o=A?1/A:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-i*o,t[3]=s*o,t}function kY(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function oB(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var s=(i+1)%3,A=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[s*3+s]-e[A*3+A]+1),t[i]=.5*r,r=.5/r,t[3]=(e[s*3+A]-e[A*3+s])*r,t[s]=(e[s*3+i]+e[i*3+s])*r,t[A]=(e[A*3+i]+e[i*3+A])*r}return t}var LY=hY,DY=WT,RY=gY,BY=mY,zY=fY,OY=dY,aB=pY,FY=function(){var t=YR(),e=pP(1,0,0),n=pP(0,1,0);return function(r,i,s){var A=XR(i,s);return A<-.999999?(py(t,e,i),tB(t)<1e-6&&py(t,n,i),BZ(t,t),sB(r,t,Math.PI),r):A>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(py(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+A,aB(r,r))}}();(function(){var t=_P(),e=_P();return function(n,r,i,s,A,o){return gy(t,r,A,o),gy(e,i,s,o),gy(n,t,e,2*o*(1-o)),n}})();(function(){var t=GZ();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],aB(e,oB(e,t))}})();const NY=[0,0,0,1];class xP extends GT{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return oB(this,e),this.check()}fromAxisRotation(e,n){return sB(this,e,n),this.check()}identity(){return TY(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Gr(e)}get y(){return this[1]}set y(e){this[1]=Gr(e)}get z(){return this[2]}set z(e){this[2]=Gr(e)}get w(){return this[3]}set w(e){this[3]=Gr(e)}len(){return zY(this)}lengthSquared(){return OY(this)}dot(e){return RY(this,e)}rotationTo(e,n){return FY(this,e,n),this.check()}add(e){return LY(this,this,e),this.check()}calculateW(){return PY(this,this),this.check()}conjugate(){return kY(this,this),this.check()}invert(){return IY(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(BY(this,e,n,r),this.check())}multiplyRight(e){return vP(this,this,e),this.check()}multiplyLeft(e){return vP(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return SY(this,this,e),this.check()}rotateY(e){return MY(this,this,e),this.check()}rotateZ(e){return CY(this,this,e),this.check()}scale(e){return DY(this,this,e),this.check()}slerp(e,n,r){let i,s,A;switch(arguments.length){case 1:({start:i=NY,target:s,ratio:A}=e);break;case 2:i=this,s=e,A=n;break;default:i=e,s=n,A=r}return gy(this,i,s,A),this.check()}transformVector4(e,n=new jT){return yY(n,e,this),eg(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const lB={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},wP=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,UY={lightSources:{}};function ow(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function VY(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=ow(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,A)=>{i["lighting_uPointLight[".concat(A,"].color")]=ow(s),i["lighting_uPointLight[".concat(A,"].position")]=s.position,i["lighting_uPointLight[".concat(A,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,A)=>{i["lighting_uDirectionalLight[".concat(A,"].color")]=ow(s),i["lighting_uDirectionalLight[".concat(A,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function AB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:UY;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},VY({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return AB({lightSources:e})}return{}}const uB={name:"lights",vs:wP,fs:wP,getUniforms:AB,defines:{MAX_LIGHTS:3}},GY=new Uint8Array([0,255,255,255]),$Y={pickingSelectedColor:null,pickingHighlightColor:GY,pickingActive:!1,pickingAttribute:!1};function jY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$Y;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const HY=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,WY=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,QY={name:"picking",vs:HY,fs:WY,getUniforms:jY},cB=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,qY={};function ZY(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function hB(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qY;if(!("material"in t))return{};const{material:e}=t;return e?ZY(e):{lighting_uEnabled:!1}}const YY={name:"gouraud-lighting",dependencies:[uB],vs:cB,defines:{LIGHTING_VERTEX:1},getUniforms:hB},XY={name:"phong-lighting",dependencies:[uB],fs:cB,defines:{LIGHTING_FRAGMENT:1},getUniforms:hB},KY=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,JY={name:"transform",vs:KY,fs:null};class Am{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Am(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:A=[],bufferMode:o=35981,transpileToGLSL100:g=!1}=e,w=this._getModuleList(e.modules),C=this._getHash(n),I=this._getHash(r),k=w.map(ie=>this._getHash(ie.name)).sort(),U=A.map(ie=>this._getHash(ie)),H=Object.keys(i).sort(),q=Object.keys(s).sort(),se=[],X=[];for(const ie of H)se.push(this._getHash(ie)),se.push(this._getHash(i[ie]));for(const ie of q)X.push(this._getHash(ie)),X.push(this._getHash(s[ie]));const te="".concat(C,"/").concat(I,"D").concat(se.join("/"),"M").concat(k.join("/"),"I").concat(X.join("/"),"V").concat(U.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(g?"T":"");if(!this._programCache[te]){const ie=Jq(this.gl,{vs:n,fs:r,modules:w,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:g});this._programCache[te]=new zR(this.gl,{hash:te,vs:ie.vs,fs:ie.fs,varyings:A,bufferMode:o}),this._getUniforms[te]=ie.getUniforms||(fe=>{}),this._useCounts[te]=0}return this._useCounts[te]++,this._programCache[te]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,A=this._defaultModules.length;s<A;++s){const o=this._defaultModules[s],g=o.name;n[i++]=o,r[g]=!0}for(let s=0,A=e.length;s<A;++s){const o=e[s],g=o.name;r[g]||(n[i++]=o,r[g]=!0)}return n.length=i,n}}const eX={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function tX(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const A=e.attributes[s],o=nX(s,n);if(s==="indices")i=A;else if(A.constant)r[o]=A.value;else{const g=A.value,w={...A};delete w.value,r[o]=[new Or(t,g),w],rX(s,w)}}if(i){const s=i.value||i;nn(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const A={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new Or(t,{data:s,target:34963}),A]}return r}function nX(t,e){const{attributeMap:n=eX}=e||{};return n&&n[t]||t}function rX(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}nn(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Xf=2,iX=1e4,sX="Model needs drawMode and vertexCount",bP=()=>{},oX={};class Yu{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=lh("model")}=n;nn($2(e)),this.id=r,this.gl=e,this.id=n.id||lh("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||Am.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:A,inject:o,varyings:g,bufferMode:w,transpileToGLSL100:C}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:A,inject:o,varyings:g,bufferMode:w,transpileToGLSL100:C},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},nn(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),sX)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:A,inject:o,varyings:g,bufferMode:w,transpileToGLSL100:C}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:A,inject:o,varyings:g,bufferMode:w,transpileToGLSL100:C},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return nn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return nn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=tX(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(rd(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return OT(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:A=this.transformFeedback,parameters:o={},vertexArray:g=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let w;vn.priority>=Xf&&(w=this._logDrawCallStart(Xf));const C=this.vertexArray.getDrawParams(),{isIndexed:I=C.isIndexed,indexType:k=C.indexType,indexOffset:U=C.indexOffset,vertexArrayInstanced:H=C.isInstanced}=this.props;H&&!this.isInstanced&&vn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:q,instanceCount:se}=this,{onBeforeRender:X=bP,onAfterRender:te=bP}=this.props;X(),this.program.setUniforms(this.uniforms);const ie=this.program.draw(Object.assign(oX,e,{logPriority:w,uniforms:null,framebuffer:r,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:g,transformFeedback:A,isIndexed:I,indexType:k,isInstanced:q,instanceCount:se,offset:I?U:0}));return te(),vn.priority>=Xf&&this._logDrawCallEnd(w,g,r),ie}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{35977:n})),i.forEach(A=>A.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(A=>A.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return vn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:A,defines:o,varyings:g,bufferMode:w,transpileToGLSL100:C}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:A,defines:o,varyings:g,bufferMode:w,transpileToGLSL100:C}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}nn(n instanceof zR,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new hq(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof Or&&n.delete()}}_setAnimationProps(e){this.animated&&nn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(rd(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new OR(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:iX;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),vn.group(Xf,">>> DRAWING MODEL ".concat(this.id),{collapsed:vn.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=pq({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:A,unusedTable:o,unusedCount:g}=iP({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:w,count:C}=iP({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});C>0&&vn.log("MISSING UNIFORMS",Object.keys(w))(),g>0&&vn.log("UNUSED UNIFORMS",Object.keys(o))();const I=mq(this.vertexArray.configuration);vn.table(e,s)(),vn.table(e,A)(),vn.table(e+1,I)(),i&&i.log({logLevel:Xf,message:"Rendered to ".concat(i.id)}),vn.groupEnd(Xf)()}}class aX{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof Or?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&nn(lr(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const A=n[s],{byteLength:o,usage:g,accessor:w}=A;r[i]=this._createNewBuffer(i,{byteLength:o,usage:g,accessor:w})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new OR(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],nn(r[s]instanceof Or)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new Or(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const lX="transform_uSampler_",__="transform_uSize_",EP="transform_position";function AX(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,A=Object.keys(n).length,o=null;const g={};let w=e,C={};if(A>0||r){const I=w.split(`
`),k=I.slice();if(I.forEach((U,H,q)=>{if(A>0){const se=dX(U,n);if(se){const{updatedLine:X,inject:te}=se;k[H]=X,C=A3([C,te]),Object.assign(g,se.samplerTextureMap),A--}}r&&!o&&(o=fX(U,r))}),r){nn(i);const U="".concat(__).concat(r),H="uniform vec2 ".concat(U,`;
`),q="     vec2 ".concat(EP," = transform_getPos(").concat(U,`);
     gl_Position = vec4(`).concat(EP,`, 0, 1.);
`);C=A3([C,{"vs:#decl":H,"vs:#main-start":q}])}w=k.join(`
`)}return{vs:w,targetTextureType:o,inject:C,samplerTextureMap:g}}function uX(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,A;n&&({width:s,height:A}=r,i["".concat(__).concat(n)]=[s,A]);for(const o in e)({width:s,height:A}=e[o]),i["".concat(__).concat(o)]=[s,A];return i}function cX(t){return jR(t,["attribute","in"])}function hX(t){const e="".concat(lX).concat(t),n="".concat(__).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function fX(t,e){const n=jR(t,["varying","out"]);return n&&n.name===e?n.type:null}function dX(t,e){const n={},r=cX(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const A="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:g,uniformDeclerations:w}=hX(s),C=lZ(i),I="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(g,").").concat(C,`;
`);return n[o]=s,{updatedLine:A,inject:{"vs:#decl":w,"vs:#main-start":I},samplerTextureMap:n}}return null}const pX={10241:9728,10240:9728,10242:33071,10243:33071},gX="transform_output";class mX{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],A=Object.assign({},n,e.attributes),o=Object.assign({},e.uniforms),g=Object.assign({},e.parameters);let w=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){A.transform_elementID=this.elementIDBuffer;for(const I in this.samplerTextureMap){const k=this.samplerTextureMap[I];o[I]=r[k]}this._setSourceTextureParameters();const C=uX({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,C)}return this.hasTargetTexture&&(w=!1,g.viewport=[0,0,i.width,i.height]),{attributes:A,framebuffer:i,uniforms:o,discard:w,parameters:g}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=H2(n);if(!e)return r;const i=r.constructor,s=AZ(this.targetTextureType),A=new i(r.length*s/4);let o=0;for(let g=0;g<r.length;g+=4)for(let w=0;w<s;w++)A[o++]=r[g+w];return A}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof oa)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new Or(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:A,height:o}=s,{framebuffer:g}=e;g?(g.update({attachments:{36064:s},resizeAttachments:!1}),g.resize({width:A,height:o})):e.framebuffer=new ts(this.gl,{id:"transform-framebuffer",width:A,height:o,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(pX)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=tQ(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:A,inject:o,samplerTextureMap:g}=AX({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),w=A3([e.inject||{},o]);this.targetTextureType=A,this.samplerTextureMap=g;const C=e._fs||HR({version:RR(i),input:this.targetTextureVarying,inputType:A,output:gX}),I=this.hasSourceTextures||this.targetTextureVarying?[JY].concat(e.modules||[]):e.modules;return{vs:i,fs:C,modules:I,uniforms:s,inject:w}}}let QT=class{static isSupported(e){return lr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();nn(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Yu(n,Object.assign({},e,{fs:e.fs||HR({version:RR(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){yX(n)&&(this.bufferTransform=new aX(e,n)),_X(n)&&(this.textureTransform=new mX(e,n)),nn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}};function yX(t){return!!(!rd(t.feedbackBuffers)||!rd(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function _X(t){return!!(!rd(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const TP={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Vu{static get DRAW_MODE(){return TP}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=lh("geometry"),drawMode:r=TP.TRIANGLES,attributes:i={},indices:s=null,vertexCount:A=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=A||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,nn(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(nn(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:A,size:o,constant:g}=s;!g&&A&&o>=1&&(r=Math.min(r,A.length/o))}return nn(Number.isFinite(r)),r}}let vX=1,xX=1;class fB{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,A=vX++,o={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(A,o),A}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:A}=i;s.setTime(this.getTime(A))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=xX++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const wX=[255,255,255],bX=1;let EX=0;class dB{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","ambient");const{color:n=wX}=e,{intensity:r=bX}=e;this.id=e.id||"ambient-".concat(EX++),this.color=n,this.intensity=r}}const TX=[255,255,255],SX=1,MX=[0,0,-1];let CX=0;class g3{constructor(e={}){oe(this,"id",void 0),oe(this,"color",void 0),oe(this,"intensity",void 0),oe(this,"type","directional"),oe(this,"direction",void 0),oe(this,"shadow",void 0);const{color:n=TX}=e,{intensity:r=SX}=e,{direction:i=MX}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(CX++),this.color=n,this.intensity=r,this.type="directional",this.direction=new An(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class PX{constructor(e,n={id:"pass"}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class qT extends PX{constructor(...e){super(...e),oe(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return Zu(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:A,clearStack:o=!0,clearCanvas:g=!0}=e;e.pass=e.pass||"unknown";const w=this.gl;g&&kX(w,n),o&&(this._lastRenderIndex=-1);const C=[];for(const I of i){const k=s&&s[I.id];A?.(I);const U=this._getDrawLayerParams(I,e),H=I.subViewports||[I];for(const q of H){const se=this._drawLayersInViewport(w,{target:n,moduleParameters:r,viewport:q,view:k,pass:e.pass,layers:e.layers},U);C.push(se)}}return C}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:A,effects:o,moduleParameters:g},w=!1){const C=[],I=pB(this._lastRenderIndex+1),k={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:A},U={};for(let H=0;H<n.length;H++){const q=n[H],se=this._shouldDrawLayer(q,k,s,U),X={shouldDrawLayer:se};se&&!w&&(X.layerRenderIndex=I(q,se),X.moduleParameters=this._getModuleParameters(q,o,r,g),X.layerParameters=this.getLayerParameters(q,H,e)),C[H]=X}return C}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:A,view:o},g){const w=IX(e,{moduleParameters:r,target:s,viewport:A});if(o&&o.props.clear){const I=o.props.clear===!0?{color:!0,depth:!0}:o.props.clear;Jl(e,{scissorTest:!0,scissor:w},()=>OT(e,I))}const C={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};Zu(e,{viewport:w});for(let I=0;I<n.length;I++){const k=n[I],{shouldDrawLayer:U,layerRenderIndex:H,moduleParameters:q,layerParameters:se}=g[I];if(U&&k.props.pickable&&C.pickableCount++,k.isComposite)C.compositeCount++;else if(U){C.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,H),q.viewport=A;try{k._drawLayer({moduleParameters:q,uniforms:{layerIndex:H},parameters:se})}catch(X){k.raiseError(X,"drawing ".concat(k," to ").concat(i))}}}return C}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let A=e.parent;for(;A;){if(!A.props.visible||!A.filterSubLayer(n))return!1;n.layer=A,A=A.parent}if(r){const o=n.layer.id;if(o in i||(i[o]=r(n)),!i[o])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const A=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:nd(this.gl)});if(n)for(const g of n){var o;Object.assign(A,(o=g.getModuleParameters)===null||o===void 0?void 0:o.call(g,e))}return Object.assign(A,this.getModuleParameters(e,n),i)}}function pB(t=0,e={}){const n={},r=(i,s)=>{const A=i.props._offset,o=i.id,g=i.parent&&i.parent.id;let w;if(g&&!(g in e)&&r(i.parent,!1),g in n){const C=n[g]=n[g]||pB(e[g],e);w=C(i,s),n[o]=C}else Number.isFinite(A)?(w=A+(e[g]||0),n[o]=null):w=t;return s&&w>=t&&(t=w+1),e[o]=w,w};return r}function IX(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||nd(t),A=i?n.height:t.drawingBufferHeight,o=r;return[o.x*s,A-(o.y+o.height)*s,o.width*s,o.height*s]}function kX(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;Zu(t,{viewport:[0,0,n,r]}),t.clear(16640)}class LX extends qT{constructor(e,n){super(e,n),oe(this,"shadowMap",void 0),oe(this,"depthBuffer",void 0),oe(this,"fbo",void 0),this.shadowMap=new oa(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new g0(e,{format:33189,width:1,height:1}),this.fbo=new ts(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Jl(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=nd(this.gl),s=r.width*i,A=r.height*i;(s!==n.width||A!==n.height)&&n.resize({width:s,height:A}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const gB="#define SMOOTH_EDGE_RADIUS 0.5",DX=`
`.concat(gB,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),RX=`
`.concat(gB,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),BX={name:"geometry",vs:DX,fs:RX},zX=Object.keys(ar).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(ar[t],";")).join(""),OX=Object.keys(Hl).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Hl[t],";")).join(""),FX=Object.keys(Jh).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Jh[t],";")).join(""),NX="".concat(zX,`
`).concat(OX,`
`).concat(FX,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function UX(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function um(t){let e={},n;return r=>{for(const i in r)if(!UX(r[i],e[i])){n=t(r),e=r;break}return n}}const SP=[0,0,0,0],VX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],mB=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],GX=[0,0,0],yB=[0,0,0],$X=um(WX);function _B(t,e,n=yB){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===ar.LNGLAT_OFFSETS||e===ar.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Hl.WEB_MERCATOR:(e===ar.LNGLAT||e===ar.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Hl.WEB_MERCATOR_AUTO_OFFSET:e===ar.LNGLAT?r=i:e===ar.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Hl.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Hl.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function jX(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:A}=t,o=SP,g=SP,w=t.cameraPosition;const{geospatialOrigin:C,shaderCoordinateOrigin:I,offsetMode:k}=_B(t,e,n);return k&&(g=t.projectPosition(C||I),w=[w[0]-g[0],w[1]-g[1],w[2]-g[2]],g[3]=1,o=Ed([],g,A),s=r||s,A=Hh([],i,s),A=Hh([],A,VX)),{viewMatrix:s,viewProjectionMatrix:A,projectionCenter:o,originCommon:g,cameraPosCommon:w,shaderCoordinateOrigin:I,geospatialOrigin:C}}function HX({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=ar.DEFAULT,coordinateOrigin:i=yB,autoWrapLongitude:s=!1}){r===ar.DEFAULT&&(r=t.isGeospatial?ar.LNGLAT:ar.CARTESIAN);const A=$X({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return A.project_uWrapLongitude=s,A.project_uModelMatrix=n||mB,A}function WX({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:A,cameraPosCommon:o,shaderCoordinateOrigin:g,geospatialOrigin:w}=jX(t,n,r),C=t.getDistanceScales(),I=[t.width*e,t.height*e],k=Ed([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,U={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:g,project_uCommonOrigin:A.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:I,project_uDevicePixelRatio:e,project_uFocalDistance:k,project_uCommonUnitsPerMeter:C.unitsPerMeter,project_uCommonUnitsPerWorldUnit:C.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:GX,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:mB,project_uCameraPosition:o};if(w){const H=t.getDistanceScales(w);switch(n){case ar.METER_OFFSETS:U.project_uCommonUnitsPerWorldUnit=H.unitsPerMeter,U.project_uCommonUnitsPerWorldUnit2=H.unitsPerMeter2;break;case ar.LNGLAT:case ar.LNGLAT_OFFSETS:t._pseudoMeters||(U.project_uCommonUnitsPerMeter=H.unitsPerMeter),U.project_uCommonUnitsPerWorldUnit=H.unitsPerDegree,U.project_uCommonUnitsPerWorldUnit2=H.unitsPerDegree2;break;case ar.CARTESIAN:U.project_uCommonUnitsPerWorldUnit=[1,1,H.unitsPerMeter[2]],U.project_uCommonUnitsPerWorldUnit2=[0,0,H.unitsPerMeter2[2]];break}}return U}const QX={};function qX(t=QX){return"viewport"in t?HX(t):{}}const ZT={name:"project",dependencies:[hZ,BX],vs:NX,getUniforms:qX};function ZX(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function F0(t,e){const n=Ed([],e,t);return WT(n,n,1/n[3]),n}function MP(t,e){const n=t%e;return n<0?e+n:n}function YX(t,e,n){return n*e+(1-n)*t}function m3(t,e,n){return t<e?e:t>n?n:t}function XX(t){return Math.log(t)*Math.LOG2E}const YT=Math.log2||XX;function Xu(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Wl=Math.PI,vB=Wl/4,cl=Wl/180,y3=180/Wl,sd=512,v_=4003e4,E1=85.051129,KX=1.5;function CP(t){return Math.pow(2,t)}function xB(t){return YT(t)}function nA(t){const[e,n]=t;Xu(Number.isFinite(e)),Xu(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*cl,i=n*cl,s=sd*(r+Wl)/(2*Wl),A=sd*(Wl+Math.log(Math.tan(vB+i*.5)))/(2*Wl);return[s,A]}function nf(t){const[e,n]=t,r=e/sd*(2*Wl)-Wl,i=2*(Math.atan(Math.exp(n/sd*(2*Wl)-Wl))-vB);return[r*y3,i*y3]}function JX(t){const{latitude:e}=t;Xu(Number.isFinite(e));const n=Math.cos(e*cl);return xB(v_*n)-9}function my(t){const e=Math.cos(t*cl);return sd/v_/e}function _3(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Xu(Number.isFinite(e)&&Number.isFinite(n));const i=sd,s=Math.cos(e*cl),A=i/360,o=A/s,g=i/v_/s,w={unitsPerMeter:[g,g,g],metersPerUnit:[1/g,1/g,1/g],unitsPerDegree:[A,o,g],degreesPerUnit:[1/A,1/o,1/g]};if(r){const C=cl*Math.tan(e*cl)/s,I=A*C/2,k=i/v_*C,U=k/o*g;w.unitsPerDegree2=[0,I,k],w.unitsPerMeter2=[U,0,U]}return w}function wB(t,e){const[n,r,i]=t,[s,A,o]=e,{unitsPerMeter:g,unitsPerMeter2:w}=_3({longitude:n,latitude:r,highPrecision:!0}),C=nA(t);C[0]+=s*(g[0]+w[0]*A),C[1]+=A*(g[1]+w[1]*A);const I=nf(C),k=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[I[0],I[1],k]:I}function eK(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:A}=t,o=ZX();y_(o,o,[0,0,-i]),rB(o,o,-n*cl),iB(o,o,r*cl);const g=s/e;return HT(o,o,[g,g,g]),A&&y_(o,o,RZ([],A)),o}function tK(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:A,scale:o,nearZMultiplier:g=1,farZMultiplier:w=1}=t;let{fovy:C=x_(KX)}=t;r!==void 0&&(C=x_(r));const I=C*cl,k=i*cl,U=bB(C);let H=U;A&&(H+=A[2]*o/Math.cos(k)/n);const q=I*(.5+(s?s[1]:0)/n),se=Math.sin(q)*H/Math.sin(m3(Math.PI/2-k-q,.01,Math.PI-.01)),X=Math.sin(k)*se+H,te=H*10,ie=Math.min(X*w,te);return{fov:I,aspect:e/n,focalDistance:U,near:g,far:ie}}function x_(t){return 2*Math.atan(.5/t)*y3}function bB(t){return .5/Math.tan(.5*t*cl)}function EB(t,e){const[n,r,i=0]=t;return Xu(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),F0(e,[n,r,i,1])}function XT(t,e,n=0){const[r,i,s]=t;if(Xu(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return F0(e,[r,i,s,1]);const A=F0(e,[r,i,0,1]),o=F0(e,[r,i,1,1]),g=A[2],w=o[2],C=g===w?0:((n||0)-g)/(w-g);return QR([],A,o,C)}function nK(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:A=[0,0]}=t,[[o,g],[w,C]]=r,I=rK(t.padding),k=nA([o,m3(C,-E1,E1)]),U=nA([w,m3(g,-E1,E1)]),H=[Math.max(Math.abs(U[0]-k[0]),i),Math.max(Math.abs(U[1]-k[1]),i)],q=[e-I.left-I.right-Math.abs(A[0])*2,n-I.top-I.bottom-Math.abs(A[1])*2];Xu(q[0]>0&&q[1]>0);const se=q[0]/H[0],X=q[1]/H[1],te=(I.right-I.left)/2/se,ie=(I.top-I.bottom)/2/X,fe=[(U[0]+k[0])/2+te,(U[1]+k[1])/2+ie],me=nf(fe),Se=Math.min(s,YT(Math.abs(Math.min(se,X))));return Xu(Number.isFinite(Se)),{longitude:me[0],latitude:me[1],zoom:Se}}function rK(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Xu(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const PP=Math.PI/180;function iK(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},A=i([0,r],s),o=i([n,r],s);let g,w;const C=t.fovy?.5*t.fovy*PP:Math.atan(.5/t.altitude),I=(90-t.pitch)*PP;return C>I-.01?(g=IP(t,0,e),w=IP(t,n,e)):(g=i([0,0],s),w=i([n,0],s)),[A,o,w,g]}function IP(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=F0(r,[e,0,1,1]),s=F0(r,[e,t.height,1,1]),o=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),g=QR([],i,s,o),w=nf(g);return w.push(n),w}const kP=512;function sK(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:A,bearing:o=0}=t;(i<-180||i>180)&&(i=MP(i+180,360)-180),(o<-180||o>180)&&(o=MP(o+180,360)-180);const g=YT(n/kP);if(A<=g)A=g,s=0;else{const w=n/2/Math.pow(2,A),C=nf([0,w])[1];if(s<C)s=C;else{const I=nf([0,kP-w])[1];s>I&&(s=I)}}return{width:e,height:n,longitude:i,latitude:s,zoom:A,pitch:r,bearing:o}}const TB=.01,oK=["longitude","latitude","zoom"],SB={curve:1.414,speed:1.2};function aK(t,e,n,r){const{startZoom:i,startCenterXY:s,uDelta:A,w0:o,u1:g,S:w,rho:C,rho2:I,r0:k}=MB(t,e,r);if(g<TB){const fe={};for(const me of oK){const Se=t[me],He=e[me];fe[me]=YX(Se,He,n)}return fe}const U=n*w,H=Math.cosh(k)/Math.cosh(k+C*U),q=o*((Math.cosh(k)*Math.tanh(k+C*U)-Math.sinh(k))/I)/g,se=1/H,X=i+xB(se),te=xZ([],A,q);h3(te,te,s);const ie=nf(te);return{longitude:ie[0],latitude:ie[1],zoom:X}}function lK(t,e,n){const r={...SB,...n},{screenSpeed:i,speed:s,maxDuration:A}=r,{S:o,rho:g}=MB(t,e,r),w=1e3*o;let C;return Number.isFinite(i)?C=w/(i/g):C=w/s,Number.isFinite(A)&&C>A?0:C}function MB(t,e,n){n=Object.assign({},SB,n);const r=n.curve,i=t.zoom,s=[t.longitude,t.latitude],A=CP(i),o=e.zoom,g=[e.longitude,e.latitude],w=CP(o-i),C=nA(s),I=nA(g),k=SZ([],I,C),U=Math.max(t.width,t.height),H=U/w,q=wZ(k)*A,se=Math.max(q,TB),X=r*r,te=(H*H-U*U+X*X*se*se)/(2*U*X*se),ie=(H*H-U*U-X*X*se*se)/(2*H*X*se),fe=Math.log(Math.sqrt(te*te+1)-te),me=Math.log(Math.sqrt(ie*ie+1)-ie),Se=(me-fe)/r;return{startZoom:i,startCenterXY:C,uDelta:k,w0:U,u1:q,S:Se,rho:r,rho2:X,r0:fe,r1:me}}const AK=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,uK=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,cK=um(gK),hK=um(mK),fK=[0,0,0,1],dK=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function pK(t,e){const[n,r,i]=t,s=XT([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function gK({viewport:t,center:e}){return new ia(t.viewProjectionMatrix).invert().transform(e)}function mK({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(A=>pK(A,r));for(const A of e){const o=A.clone().translate(new An(t.center).negate()),g=s.map(C=>o.transform(C)),w=new ia().ortho({left:Math.min(...g.map(C=>C[0])),right:Math.max(...g.map(C=>C[0])),bottom:Math.min(...g.map(C=>C[1])),top:Math.max(...g.map(C=>C[1])),near:Math.min(...g.map(C=>-C[2])),far:Math.max(...g.map(C=>-C[2]))});n.push(w.multiplyRight(A))}return n}function yK(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||fK,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=cK({viewport:t.viewport,center:e.project_uCenter}),s=[],A=hK({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let o=0;o<t.shadowMatrices.length;o++){const g=A[o],w=g.clone().translate(new An(t.viewport.center).negate());e.project_uCoordinateSystem===ar.LNGLAT&&e.project_uProjectionMode===Hl.WEB_MERCATOR?(A[o]=w,s[o]=i):(A[o]=g.clone().multiplyRight(dK),s[o]=w.transform(i))}for(let o=0;o<A.length;o++)r["shadow_uViewProjectionMatrices[".concat(o,"]")]=A[o],r["shadow_uProjectCenters[".concat(o,"]")]=s[o],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(o)]=t.shadowMaps[o]:r["shadow_uShadowMap".concat(o)]=t.dummyShadowMap;return r}const aw={name:"shadow",dependencies:[ZT],vs:AK,fs:uK,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?yK(t,e):{}},_K={color:[255,255,255],intensity:1},LP=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],vK=[0,0,0,200/255];class KT{constructor(e={}){oe(this,"id","lighting-effect"),oe(this,"props",void 0),oe(this,"shadowColor",vK),oe(this,"shadow",void 0),oe(this,"ambientLight",void 0),oe(this,"directionalLights",void 0),oe(this,"pointLights",void 0),oe(this,"shadowPasses",[]),oe(this,"shadowMaps",[]),oe(this,"dummyShadowMap",null),oe(this,"programManager",void 0),oe(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:A}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=Am.getDefaultProgramManager(e),aw&&this.programManager.addDefaultModule(aw)),this.dummyShadowMap||(this.dummyShadowMap=new oa(e,{width:1,height:1}));for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:A,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(aw),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new ia().lookAt({eye:new An(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new LX(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new dB(_K),this.directionalLights.push(new g3(LP[0]),new g3(LP[1])))}}class xK{constructor(e={}){oe(this,"_pool",[]),oe(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:A=!1,initialize:o=!1,maxCount:g}){const w=i||e&&e.constructor||Float32Array,C=n*r+s;if(ArrayBuffer.isView(e)){if(C<=e.length)return e;if(C*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new w(e.buffer,0,C)}let I=1/0;g&&(I=g*r+s);const k=this._allocate(w,C,o,I);return e&&A?k.set(e):o||k.fill(0,0,4),this._release(e),k}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const A=this._pool,o=e.BYTES_PER_ELEMENT*s,g=A.findIndex(w=>w.byteLength>=o);if(g>=0){const w=new e(A.splice(g,1)[0],0,s);return r&&w.fill(0),w}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(A=>A.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const od=new xK;function Dp(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function wK(t){return[t[12],t[13],t[14]]}function bK(t){return{left:Kf(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Kf(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Kf(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Kf(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Kf(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Kf(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const DP=new An;function Kf(t,e,n,r){DP.set(t,e,n);const i=DP.len();return{distance:r/i,normal:new An(-t/i,-e/i,-n/i)}}function EK(t){return t-Math.fround(t)}let cp;function lw(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;cp=od.allocate(cp,s,{type:Float32Array,size:n*2});let A=r,o=0;for(;A<i;){for(let g=0;g<n;g++){const w=t[A++];cp[o+g]=w,cp[o+g+n]=EK(w)}o+=n*2}return cp.subarray(0,s*n*2)}function TK(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const SK=Math.PI/180,MK=Dp(),RP=[0,0,0],CK={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function PK({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:A,far:o}){const g=t/e,w=n?new ia().orthographic({fovy:r,aspect:g,focalDistance:i,near:A,far:o}):new ia().perspective({fovy:r,aspect:g,near:A,far:o});if(s){const{left:C=0,right:I=0,top:k=0,bottom:U=0}=s,H=$c((C+t-I)/2,0,t)-t/2,q=$c((k+e-U)/2,0,e)-e/2;w[8]-=H*2/t,w[9]+=q*2/e}return w}class Ef{constructor(e={}){oe(this,"id",void 0),oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"padding",void 0),oe(this,"isGeospatial",void 0),oe(this,"zoom",void 0),oe(this,"focalDistance",void 0),oe(this,"position",void 0),oe(this,"modelMatrix",void 0),oe(this,"distanceScales",void 0),oe(this,"scale",void 0),oe(this,"center",void 0),oe(this,"cameraPosition",void 0),oe(this,"projectionMatrix",void 0),oe(this,"viewMatrix",void 0),oe(this,"viewMatrixUncentered",void 0),oe(this,"viewMatrixInverse",void 0),oe(this,"viewProjectionMatrix",void 0),oe(this,"pixelProjectionMatrix",void 0),oe(this,"pixelUnprojectionMatrix",void 0),oe(this,"resolution",void 0),oe(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||CK,this.focalDistance=e.focalDistance||1,this.position=e.position||RP,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Hl.WEB_MERCATOR:Hl.WEB_MERCATOR_AUTO_OFFSET:Hl.IDENTITY}equals(e){return e instanceof Ef?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Uu(e.projectionMatrix,this.projectionMatrix)&&Uu(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=EB(r,this.pixelProjectionMatrix),[s,A]=i,o=n?A:this.height-A;return e.length===2?[s,o]:[s,o,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,A]=e,o=n?s:this.height-s,g=r&&r*this.distanceScales.unitsPerMeter[2],w=XT([i,o,A],this.pixelUnprojectionMatrix,g),[C,I,k]=this.unprojectPosition(w);return Number.isFinite(A)?[C,I,k]:Number.isFinite(r)?[C,I,r]:[C,I]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=nA(e);return n[1]=$c(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?nf(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),A=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],A[0]),Math.min(r[1],i[1],s[1],A[1]),Math.max(r[0],i[0],s[0],A[0]),Math.max(r[1],i[1],s[1],A[1])]}getDistanceScales(e){return e?_3({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,bK(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=JX({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||_3({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:A}=e;let o=RP;if(s&&(o=A?new ia(A).transformAsVector(s,[]):s),this.isGeospatial){const g=this.projectPosition([n,r,0]);this.center=new An(o).scale(this.distanceScales.unitsPerMeter).add(g)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:n=MK,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:A=75,near:o=.1,far:g=1e3,padding:w=null,focalDistance:C=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new ia().multiplyRight(n).translate(new An(this.center).negate()),this.projectionMatrix=r||PK({width:this.width,height:this.height,orthographic:i,fovyRadians:s||A*SK,focalDistance:C,padding:w,near:o,far:g});const I=Dp();Hh(I,I,this.projectionMatrix),Hh(I,I,this.viewMatrix),this.viewProjectionMatrix=I,this.viewMatrixInverse=d3([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=wK(this.viewMatrixInverse);const k=Dp(),U=Dp();HT(k,k,[this.width/2,-this.height/2,1]),y_(k,k,[1,-1,0]),Hh(U,k,this.viewProjectionMatrix),this.pixelProjectionMatrix=U,this.pixelUnprojectionMatrix=d3(Dp(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||rr.warn("Pixel project matrix not invertible")()}}oe(Ef,"displayName","Viewport");class Ku extends Ef{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:A=0,nearZMultiplier:o=.1,farZMultiplier:g=1.01,nearZ:w,farZ:C,orthographic:I=!1,projectionMatrix:k,repeat:U=!1,worldOffset:H=0,position:q,padding:se,legacyMeterSizes:X=!1}=e;let{width:te,height:ie,altitude:fe=1.5}=e;const me=Math.pow(2,i);te=te||1,ie=ie||1;let Se,He=null;if(k)fe=k[5]/2,Se=x_(fe);else{e.fovy?(Se=e.fovy,fe=bB(Se)):Se=x_(fe);let Ke;if(se){const{top:nt=0,bottom:Ne=0}=se;Ke=[0,$c((nt+ie-Ne)/2,0,ie)-ie/2]}He=tK({width:te,height:ie,scale:me,center:q&&[0,0,q[2]*my(n)],offset:Ke,pitch:s,fovy:Se,nearZMultiplier:o,farZMultiplier:g}),Number.isFinite(w)&&(He.near=w),Number.isFinite(C)&&(He.far=C)}let Qe=eK({height:ie,pitch:s,bearing:A,scale:me,altitude:fe});H&&(Qe=new ia().translate([512*H,0,0]).multiplyLeft(Qe)),super({...e,width:te,height:ie,viewMatrix:Qe,longitude:r,latitude:n,zoom:i,...He,fovy:Se,focalDistance:fe}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"pitch",void 0),oe(this,"bearing",void 0),oe(this,"altitude",void 0),oe(this,"fovy",void 0),oe(this,"orthographic",void 0),oe(this,"_subViewports",void 0),oe(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=A,this.altitude=fe,this.fovy=Se,this.orthographic=I,this._subViewports=U?[]:null,this._pseudoMeters=X,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new Ku({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*my(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/my(r);return[n,r,i]}addMetersToLngLat(e,n){return wB(e,n)}panByPosition(e,n){const r=XT(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=h3([],i,bZ([],r)),A=h3([],this.center,s),[o,g]=this.unprojectFlat(A);return{longitude:o,latitude:g}}getBounds(e={}){const n=iK(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:A,zoom:o}=nK({width:r,height:i,bounds:e,...n});return new Ku({width:r,height:i,longitude:s,latitude:A,zoom:o})}}oe(Ku,"displayName","WebMercatorViewport");const BP=[0,0,0];function Aw(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Ku){const[i,s,A=0]=t,o=e.getDistanceScales([i,s]);r[2]=A*o.unitsPerMeter[2]}return r}function IK(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:A}=t;return i===ar.DEFAULT&&(i=e.isGeospatial?ar.LNGLAT:ar.CARTESIAN),s===void 0&&(s=i),A===void 0&&(A=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:A}}function CB(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[A,o,g=0]=t;switch(n&&([A,o,g]=Ed([],[A,o,g,1],n)),r){case ar.LNGLAT:return Aw([A,o,g],e,s);case ar.LNGLAT_OFFSETS:return Aw([A+i[0],o+i[1],g+(i[2]||0)],e,s);case ar.METER_OFFSETS:return Aw(wB(i,[A,o,g]),e,s);case ar.CARTESIAN:default:return e.isGeospatial?[A+i[0],o+i[1],g+i[2]]:e.projectPosition([A,o,g])}}function kK(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:A,fromCoordinateOrigin:o}=IK(e),{autoOffset:g=!0}=e,{geospatialOrigin:w=BP,shaderCoordinateOrigin:C=BP,offsetMode:I=!1}=g?_B(n,r,i):{},k=CB(t,{viewport:n,modelMatrix:s,coordinateSystem:A,coordinateOrigin:o,offsetMode:I});if(I){const U=n.projectPosition(w||C);eB(k,k,U)}return k}const rf=Math.PI/180,LK=1e3*60*60*24,DK=2440588,RK=2451545,w_=rf*23.4397,BK=357.5291,zK=.98560028,OK=280.147,FK=360.9856235;function NK(t,e,n){const r=rf*-n,i=rf*e,s=VK(t),A=ZK(s),o=WK(s,r)-A.rightAscension;return{azimuth:jK(o,i,A.declination),altitude:HK(o,i,A.declination)}}function zP(t,e,n){const{azimuth:r,altitude:i}=NK(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function UK(t){return(typeof t=="number"?t:t.getTime())/LK-.5+DK}function VK(t){return UK(t)-RK}function GK(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(w_)-Math.tan(e)*Math.sin(w_),Math.cos(n))}function $K(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(w_)+Math.cos(e)*Math.sin(w_)*Math.sin(n))}function jK(t,e,n){const r=t,i=e,s=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(s)*Math.cos(i))}function HK(t,e,n){const r=t,i=e,s=n;return Math.asin(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(r))}function WK(t,e){return rf*(OK+FK*t)-e}function QK(t){return rf*(BK+zK*t)}function qK(t){const e=t,n=rf*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),r=rf*102.9372;return e+n+r+Math.PI}function ZK(t){const e=QK(t),n=qK(e);return{declination:$K(n,0),rightAscension:GK(n,0)}}class YK extends g3{constructor(e){super(e),oe(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[i,s,A]=zP(this.timestamp,0,0);this.direction=[i,-A,s]}else{const{latitude:i,longitude:s}=n;this.direction=zP(this.timestamp,i,s)}return this}}const OP={blendFunc:[1,0,32771,0],blendEquation:32774};class PB extends qT{constructor(...e){super(...e),oe(this,"pickZ",void 0),oe(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:A,deviceRect:{x:o,y:g,width:w,height:C},cullRect:I,effects:k,pass:U="picking",pickZ:H,moduleParameters:q}){const se=this.gl;this.pickZ=H;const X=this._resetColorEncoder(H),te=Jl(se,{scissorTest:!0,scissor:[o,g,w,C],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...OP,blend:!H},()=>super.render({target:A,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:I,effects:k?.filter(fe=>fe.useInPicking),pass:U,isPicking:!0,moduleParameters:q}));return this._colorEncoderState=null,{decodePickingColor:X&&KK.bind(null,X),stats:te}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:A}=e.props;return this._colorEncoderState?s&&A.includes("draw")&&(Object.assign(i,OP),i.blend=!0,i.blendColor=XK(this._colorEncoderState,e,r)):i.blend=!1,A.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function XK(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,A=r.get(e);return A?(A.viewports.push(n),s=A.a):(s=r.size+1,s<=255?(A={a:s,layer:e,viewports:[n]},r.set(e,A),i[s]=A):(rr.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function KK(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const r0={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},b_=Symbol.for("component"),rh=Symbol.for("propTypes"),uw=Symbol.for("deprecatedProps"),N0=Symbol.for("asyncPropDefaults"),sf=Symbol.for("asyncPropOriginal"),jc=Symbol.for("asyncPropResolved");function of(t,e=()=>!0){return Array.isArray(t)?IB(t,e,[]):e(t)?[t]:[]}function IB(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?IB(i,e,n):e(i)&&n.push(i)}return n}function JK({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let A=0;for(let o=n;A<i;A++)t[o++]=e[A];for(;A<s;)A<s-A?(t.copyWithin(n+A,n,n+A),A*=2):(t.copyWithin(n+A,n,n+s-A),A=s);return t}function FP(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class NP{constructor(e,n){oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"sampleSize",1),oe(this,"time",void 0),oe(this,"count",void 0),oe(this,"samples",void 0),oe(this,"lastTiming",void 0),oe(this,"lastSampleTime",void 0),oe(this,"lastSampleCount",void 0),oe(this,"_count",0),oe(this,"_time",0),oe(this,"_samples",0),oe(this,"_startTime",0),oe(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=FP(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(FP()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class kB{constructor(e){oe(this,"id",void 0),oe(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof NP?this.stats[n]=e:this.stats[n]=new NP(n,r)),this.stats[n]}}class eJ{constructor(e,n,r){oe(this,"id",void 0),oe(this,"context",void 0),oe(this,"isLoaded",void 0),oe(this,"persistent",void 0),oe(this,"_loadCount",0),oe(this,"_subscribers",new Set),oe(this,"_data",void 0),oe(this,"_loader",void 0),oe(this,"_error",void 0),oe(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=c_(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class tJ{constructor({gl:e,protocol:n}){oe(this,"protocol",void 0),oe(this,"_context",void 0),oe(this,"_resources",void 0),oe(this,"_consumers",void 0),oe(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new eJ(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:A}=this;e.startsWith(A)&&(e=e.replace(A,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=s[e];if(this._track(r,i,o,n),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,A=s[e]=s[e]||{},o=A[n]||{},g=o.resourceId&&this._resources[o.resourceId];g&&(g.unsubscribe(o),this.prune()),r&&(A[n]=o,o.onChange=i,o.resourceId=r.id,r.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const nJ=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Tf={name:"project32",dependencies:[ZT],vs:nJ},Sf={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...QY},rJ=[ZT],iJ=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function sJ(t){const e=Am.getDefaultProgramManager(t);for(const n of rJ)e.addDefaultModule(n);for(const n of iJ)e.addShaderHook(n);return e}const oJ="layerManager.setLayers",aJ="layerManager.activateViewport";class lJ{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){oe(this,"layers",void 0),oe(this,"context",void 0),oe(this,"resourceManager",void 0),oe(this,"_lastRenderedLayers",[]),oe(this,"_needsRedraw",!1),oe(this,"_needsUpdate",!1),oe(this,"_nextLayers",null),oe(this,"_debug",!1),oe(this,"activateViewport",A=>{oo(aJ,this,A),A&&(this.context.viewport=A)}),this.layers=[],this.resourceManager=new tJ({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&sJ(e),stats:r||new kB({id:"deck.gl"}),viewport:i||new Ef({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new fB,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){oo(oJ,this,n,e),this._lastRenderedLayers=e;const r=of(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const A of e)r[A.id]?rr.warn("Multiple old layers with same id ".concat(A.id))():r[A.id]=A;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const A of i)if(A.hasUniformTransition()){s="Uniform transition in ".concat(A);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&rr.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let A=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),A=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}A&&this._updateSublayersRecursively(A,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=r0.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=r0.MATCHED,n!==e&&(e.lifecycle=r0.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=r0.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=r0.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Ql(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Ql(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Ql(t[s],e[s],n-1))return!1;return!0}return!1}class AJ{constructor(e){oe(this,"width",void 0),oe(this,"height",void 0),oe(this,"views",void 0),oe(this,"viewState",void 0),oe(this,"controllers",void 0),oe(this,"timeline",void 0),oe(this,"_viewports",void 0),oe(this,"_viewportMap",void 0),oe(this,"_isUpdating",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_needsUpdate",void 0),oe(this,"_eventManager",void 0),oe(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const A=r[s];if(A.containsPixel(i)){const o=e.slice();return o[0]-=A.x,o[1]-=A.y,A.unproject(o,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=of(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Ql(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):rr.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var A;return(A=this.getView(e.id))===null||A===void 0?void 0:A.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const A={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,A)),i&&i.setProps(A),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],A=this.getViewState(s),o=s.makeViewport({viewState:A,width:this.width,height:this.height});let g=n[s.id];const w=!!s.controller;w&&!g&&(r=!0),(r||!w)&&g&&(g.finalize(),g=null),this.controllers[s.id]=this._updateController(s,A,o,g),o&&this._viewports.unshift(o)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const uJ=/([0-9]+\.?[0-9]*)(%|px)/;function Cc(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=uJ.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Pc(t,e){return t.relative?Math.round(t.position*e):t.position}function Bi(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class hl{constructor(e){oe(this,"id",void 0),oe(this,"viewportInstance",void 0),oe(this,"_x",void 0),oe(this,"_y",void 0),oe(this,"_width",void 0),oe(this,"_height",void 0),oe(this,"_padding",void 0),oe(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:A="100%",padding:o=null,viewportInstance:g}=e||{};Bi(!g||g instanceof Ef),this.viewportInstance=g,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Cc(r),this._y=Cc(i),this._width=Cc(s),this._height=Cc(A),this._padding=o&&{left:Cc(o.left||0),right:Cc(o.right||0),top:Cc(o.top||0),bottom:Cc(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Ql(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Pc(this._x,e),y:Pc(this._y,n),width:Pc(this._width,e),height:Pc(this._height,n)};return this._padding&&(r.padding={left:Pc(this._padding.left,e),top:Pc(this._padding.top,n),right:Pc(this._padding.right,e),bottom:Pc(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let cm=class{constructor(e){oe(this,"_inProgress",void 0),oe(this,"_handle",void 0),oe(this,"_timeline",void 0),oe(this,"time",void 0),oe(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const UP=()=>{},v3={BREAK:1,SNAP_TO_END:2,IGNORE:3},cJ=t=>t,hJ=v3.BREAK;class fJ{constructor(e){oe(this,"getControllerState",void 0),oe(this,"props",void 0),oe(this,"propsInTransition",void 0),oe(this,"transition",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:A,duration:o,easing:g}}=n,w=g(r/o),C=i.interpolateProps(s,A,w);this.propsInTransition=this.getControllerState({...this.props,...C}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new cm(e.timeline),this.onViewStateChange=e.onViewStateChange||UP,this.onStateChange=e.onStateChange||UP}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:A}=this.transition.settings;i={...r,...s===v3.SNAP_TO_END?A:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===v3.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,A=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(A===0)return;const o=s.initializeProps(e,i);this.propsInTransition={};const g={duration:A,easing:n.transitionEasing||cJ,interpolator:s,interruption:n.transitionInterruption||hJ,startProps:o.start,endProps:o.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(g),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}class LB{constructor(e){oe(this,"_propsToCompare",void 0),oe(this,"_propsToExtract",void 0),oe(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Uu(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Bi(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const dJ=["longitude","latitude","zoom","bearing","pitch"],pJ=["longitude","latitude","zoom"];class DB extends LB{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:dJ,required:pJ},super(r.transitionProps),oe(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const A=i(e),o=i(n),g=A.unproject(s);r.start.around=s,Object.assign(r.end,{around:o.project(g),aroundPosition:g,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=ul(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,ul(e.around,n.around,r)))}return i}}const Ic={transitionDuration:0},gJ=300,T1=t=>1-(1-t)*(1-t),Jf={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Mh={};class mJ{constructor(e){oe(this,"props",void 0),oe(this,"state",{}),oe(this,"transitionManager",void 0),oe(this,"eventManager",void 0),oe(this,"onViewStateChange",void 0),oe(this,"onStateChange",void 0),oe(this,"makeViewport",void 0),oe(this,"_controllerState",void 0),oe(this,"_events",{}),oe(this,"_interactionState",{isDragging:!1}),oe(this,"_customEvents",[]),oe(this,"_eventStartBlocked",null),oe(this,"_panMove",!1),oe(this,"invertPan",!1),oe(this,"dragMode","rotate"),oe(this,"inertia",0),oe(this,"scrollZoom",!0),oe(this,"dragPan",!0),oe(this,"dragRotate",!0),oe(this,"doubleClickZoom",!0),oe(this,"touchZoom",!0),oe(this,"touchRotate",!1),oe(this,"keyboard",!0),this.transitionManager=new fJ({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?gJ:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:A=!0,touchZoom:o=!0,touchRotate:g=!1,keyboard:w=!0}=e,C=!!this.onViewStateChange;this.toggleEvents(Jf.WHEEL,C&&r),this.toggleEvents(Jf.PAN,C),this.toggleEvents(Jf.PINCH,C&&(o||g)),this.toggleEvents(Jf.TRIPLE_PAN,C&&g),this.toggleEvents(Jf.DOUBLE_TAP,C&&A),this.toggleEvents(Jf.KEYBOARD,C&&w),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=A,this.touchZoom=o,this.touchRotate=g,this.keyboard=w}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const A=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:A})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Ic,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Ic,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:T1},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Ic,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:T1},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let A=2/(1+Math.exp(-Math.abs(s*r)));s<0&&A!==0&&(A=1/A);const o=this.controllerState.zoom({pos:n,scale:A});return this.updateViewport(o,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Ic,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Ic,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:T1},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Mh._startPinchRotation=e.rotation,Mh._lastPinchEvent=e,this.updateViewport(r,Ic,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Mh._startPinchRotation-r})}return this.updateViewport(n,Ic,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Mh._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Mh;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const A=Math.log2(e.scale),o=(A-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),g=Math.pow(2,A+o*n/2);s=s.zoom({pos:i,scale:g}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:T1},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Mh._startPinchRotation=null,Mh._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:A}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let g;const w={};switch(e.srcEvent.code){case"Minus":g=n?o.zoomOut(r).zoomOut(r):o.zoomOut(r),w.isZooming=!0;break;case"Equal":g=n?o.zoomIn(r).zoomIn(r):o.zoomIn(r),w.isZooming=!0;break;case"ArrowLeft":n?(g=o.rotateLeft(s),w.isRotating=!0):(g=o.moveLeft(i),w.isPanning=!0);break;case"ArrowRight":n?(g=o.rotateRight(s),w.isRotating=!0):(g=o.moveRight(i),w.isPanning=!0);break;case"ArrowUp":n?(g=o.rotateUp(A),w.isRotating=!0):(g=o.moveUp(i),w.isPanning=!0);break;case"ArrowDown":n?(g=o.rotateDown(A),w.isRotating=!0):(g=o.moveDown(i),w.isPanning=!0);break;default:return!1}return this.updateViewport(g,this._getTransitionProps(),w),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Ic:e?{...n,transitionInterpolator:new DB({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class yJ{constructor(e,n){oe(this,"_viewportProps",void 0),oe(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const VP=5,_J=1.2;class vJ extends yJ{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:A,bearing:o=0,pitch:g=0,altitude:w=1.5,position:C=[0,0,0],maxZoom:I=20,minZoom:k=0,maxPitch:U=60,minPitch:H=0,startPanLngLat:q,startZoomLngLat:se,startRotatePos:X,startBearing:te,startPitch:ie,startZoom:fe,normalize:me=!0}=e;Bi(Number.isFinite(s)),Bi(Number.isFinite(i)),Bi(Number.isFinite(A)),super({width:n,height:r,latitude:i,longitude:s,zoom:A,bearing:o,pitch:g,altitude:w,maxZoom:I,minZoom:k,maxPitch:U,minPitch:H,normalize:me,position:C},{startPanLngLat:q,startZoomLngLat:se,startRotatePos:X,startBearing:te,startPitch:ie,startZoom:fe}),oe(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:A}=this.getState();if(!i||s===void 0||A===void 0)return this;let o;return e?o=this._getNewRotation(e,i,A,s):o={bearing:s+n,pitch:A+r},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:A,minZoom:o}=this.getViewportProps();let g=i+Math.log2(r);g=$c(g,o,A);const w=this.makeViewport({...this.getViewportProps(),zoom:g});return this._getUpdatedState({zoom:g,...w.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=$c(i,r,n);const{maxPitch:s,minPitch:A,pitch:o}=e;e.pitch=$c(o,A,s);const{normalize:g=!0}=e;return g&&Object.assign(e,sK(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],A=e[1]-n[1],o=e[1],g=n[1],{width:w,height:C}=this.getViewportProps(),I=s/w;let k=0;A>0?Math.abs(C-g)>VP&&(k=A/(g-C)*_J):A<0&&g>VP&&(k=1-o/g),k=$c(k,-1,1);const{minPitch:U,maxPitch:H}=this.getViewportProps(),q=i+180*I;let se=r;return k>0?se=r+k*(H-r):k<0&&(se=r-k*(U-r)),{pitch:se,bearing:q}}}class xJ extends mJ{constructor(...e){super(...e),oe(this,"ControllerState",vJ),oe(this,"transition",{transitionDuration:300,transitionInterpolator:new DB({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),oe(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Gu extends hl{get ViewportType(){return Ku}get ControllerType(){return xJ}}oe(Gu,"displayName","MapView");const wJ=new KT;function bJ(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class EJ{constructor(){oe(this,"effects",void 0),oe(this,"_resolvedEffects",[]),oe(this,"_defaultEffects",[]),oe(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>bJ(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Ql(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof KT)||this._resolvedEffects.push(wJ),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class TJ extends qT{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const SJ="deckRenderer.renderLayers";class MJ{constructor(e){oe(this,"gl",void 0),oe(this,"layerFilter",void 0),oe(this,"drawPickingColors",void 0),oe(this,"drawLayersPass",void 0),oe(this,"pickLayersPass",void 0),oe(this,"renderCount",void 0),oe(this,"_needsRedraw",void 0),oe(this,"renderBuffers",void 0),oe(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new TJ(e),this.pickLayersPass=new PB(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||ts.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,oo(SJ,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new ts(this.gl),new ts(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const A=s.postRender(this.gl,i);i.inputBuffer=A,i.swapBuffer=A===r[0]?r[1]:r[0]}}}const CJ={pickedColor:null,pickedObjectIndex:-1};function PJ({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:A,y:o,width:g,height:w}=s;let C=i*i,I=-1,k=0;for(let U=0;U<w;U++){const H=U+o-r,q=H*H;if(q>C)k+=4*g;else for(let se=0;se<g;se++){if(t[k+3]-1>=0){const te=se+A-n,ie=te*te+q;ie<=C&&(C=ie,I=k)}k+=4}}if(I>=0){const U=t.slice(I,I+4),H=e(U);if(H){const q=Math.floor(I/4/g),se=I/4-q*g;return{...H,pickedColor:U,pickedX:A+se,pickedY:o+q}}rr.error("Picked non-existent layer. Is picking buffer corrupt?")()}return CJ}function IJ({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),A=s.join(",");if(!n.has(A)){const o=e(s);o?n.set(A,{...o,color:s}):rr.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function RB({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let A=e[0];e.length>1&&(A=LJ(t?.pickedViewports||e,{x:r,y:i}));let o;if(A){const g=[r-A.x,i-A.y];s!==void 0&&(g[2]=s),o=A.unproject(g)}return{color:null,layer:null,viewport:A,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function kJ(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:A,pickedObjectIndex:o}=e,g=A?[A]:[];if(r==="hover"){const I=n.index,k=n.layerId,U=A?A.props.id:null;if(U!==k||o!==I){if(U!==k){const H=i.find(q=>q.props.id===k);H&&g.unshift(H)}n.layerId=U,n.index=o,n.info=null}}const w=RB(t),C=new Map;return C.set(null,w),g.forEach(I=>{let k={...w};I===A&&(k.color=s,k.index=o,k.picked=!0),k=BB({layer:I,info:k,mode:r});const U=k.layer;I===A&&r==="hover"&&(n.info=k),C.set(U.id,k),r==="hover"&&U.updateAutoHighlight(k)}),C}function BB({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function LJ(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class DJ{constructor(e){oe(this,"gl",void 0),oe(this,"pickingFBO",void 0),oe(this,"depthFBO",void 0),oe(this,"pickLayersPass",void 0),oe(this,"layerFilter",void 0),oe(this,"lastPickedInfo",void 0),oe(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new PB(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const A=s&&s.layer&&s.layer.id,o=s&&s.viewport&&s.viewport.id,g=A?r.find(k=>k.id===A):null,w=o&&i.find(k=>k.id===o)||i[0],C=w&&w.unproject([e-w.x,n-w.y]);return{...s,...{x:e,y:n,viewport:w,coordinate:C,layer:g}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new ts(r),ts.isSupported(r,{colorBufferFloat:!0}))){const i=new ts(r);i.attach({36064:new oa(r,{format:lr(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:A=0,depth:o=1,mode:g="query",unproject3D:w,onViewportActive:C,effects:I}){const k=this._getPickable(e),U=nd(this.gl);if(!k)return{result:[],emptyInfo:RB({viewports:r,x:i,y:s,pixelRatio:U})};this._resizeBuffer();const H=Wx(this.gl,[i,s],!0),q=[H.x+Math.floor(H.width/2),H.y+Math.floor(H.height/2)],se=Math.round(A*U),{width:X,height:te}=this.pickingFBO,ie=this._getPickingRect({deviceX:q[0],deviceY:q[1],deviceRadius:se,deviceWidth:X,deviceHeight:te}),fe={x:i-A,y:s-A,width:A*2+1,height:A*2+1};let me;const Se=[],He=new Set;for(let Qe=0;Qe<o;Qe++){let Ke;if(ie){const Ne=this._drawAndSample({layers:k,views:n,viewports:r,onViewportActive:C,deviceRect:ie,cullRect:fe,effects:I,pass:"picking:".concat(g)});Ke=PJ({...Ne,deviceX:q[0],deviceY:q[1],deviceRadius:se,deviceRect:ie})}else Ke={pickedColor:null,pickedObjectIndex:-1};let nt;if(Ke.pickedLayer&&w&&this.depthFBO){const{pickedColors:Ne}=this._drawAndSample({layers:[Ke.pickedLayer],views:n,viewports:r,onViewportActive:C,deviceRect:{x:Ke.pickedX,y:Ke.pickedY,width:1,height:1},cullRect:fe,effects:I,pass:"picking:".concat(g,":z")},!0);Ne[3]&&(nt=Ne[0])}Ke.pickedLayer&&Qe+1<o&&(He.add(Ke.pickedLayer),Ke.pickedLayer.disablePickingIndex(Ke.pickedObjectIndex)),me=kJ({pickInfo:Ke,lastPickedInfo:this.lastPickedInfo,mode:g,layers:k,viewports:r,x:i,y:s,z:nt,pixelRatio:U});for(const Ne of me.values())Ne.layer&&Se.push(Ne);if(!Ke.pickedColor)break}for(const Qe of He)Qe.restorePickingColors();return{result:Se,emptyInfo:me.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:A=1,height:o=1,mode:g="query",maxObjects:w=null,onViewportActive:C,effects:I}){const k=this._getPickable(e);if(!k)return[];this._resizeBuffer();const U=nd(this.gl),H=Wx(this.gl,[i,s],!0),q=H.x,se=H.y+H.height,X=Wx(this.gl,[i+A,s+o],!0),te=X.x+X.width,ie=X.y,fe={x:q,y:ie,width:te-q,height:se-ie},me=this._drawAndSample({layers:k,views:n,viewports:r,onViewportActive:C,deviceRect:fe,cullRect:{x:i,y:s,width:A,height:o},effects:I,pass:"picking:".concat(g)}),Se=IJ(me),He=new Map,Qe=Number.isFinite(w);for(let Ke=0;Ke<Se.length&&!(Qe&&w&&He.size>=w);Ke++){const nt=Se[Ke];let Ne={color:nt.pickedColor,layer:null,index:nt.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:U};Ne=BB({layer:nt.pickedLayer,info:Ne,mode:g}),He.has(Ne.object)||He.set(Ne.object,Ne)}return Array.from(He.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:A,effects:o,pass:g},w=!1){const C=w?this.depthFBO:this.pickingFBO,I={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:C,deviceRect:s,cullRect:A,effects:o,pass:g,pickZ:w,preRenderStats:{}};for(const te of o)te.useInPicking&&(I.preRenderStats[te.id]=te.preRender(this.gl,I));const{decodePickingColor:k}=this.pickLayersPass.render(I),{x:U,y:H,width:q,height:se}=s,X=new(w?Float32Array:Uint8Array)(q*se*4);return H2(C,{sourceX:U,sourceY:H,sourceWidth:q,sourceHeight:se,target:X}),{pickedColors:X,decodePickingColor:k}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const A=Math.max(0,e-r),o=Math.max(0,n-r),g=Math.min(i,e+r+1)-A,w=Math.min(s,n+r+1)-o;return g<=0||w<=0?null:{x:A,y:o,width:g,height:w}}}const RJ={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class BJ{constructor(e){oe(this,"el",null),oe(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,RJ),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var zB={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],A=n.createElement("div"),o="function",g=Math.round,w=Math.abs,C=Date.now;function I(ge,Ee,Fe){return setTimeout(ie(ge,Fe),Ee)}function k(ge,Ee,Fe){return Array.isArray(ge)?(U(ge,Fe[Ee],Fe),!0):!1}function U(ge,Ee,Fe){var at;if(ge)if(ge.forEach)ge.forEach(Ee,Fe);else if(ge.length!==i)for(at=0;at<ge.length;)Ee.call(Fe,ge[at],at,ge),at++;else for(at in ge)ge.hasOwnProperty(at)&&Ee.call(Fe,ge[at],at,ge)}function H(ge,Ee,Fe){var at="DEPRECATED METHOD: "+Ee+`
`+Fe+` AT 
`;return function(){var bt=new Error("get-stack-trace"),Qt=bt&&bt.stack?bt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ln=e.console&&(e.console.warn||e.console.log);return Ln&&Ln.call(e.console,at,Qt),ge.apply(this,arguments)}}var q;typeof Object.assign!="function"?q=function(Ee){if(Ee===i||Ee===null)throw new TypeError("Cannot convert undefined or null to object");for(var Fe=Object(Ee),at=1;at<arguments.length;at++){var bt=arguments[at];if(bt!==i&&bt!==null)for(var Qt in bt)bt.hasOwnProperty(Qt)&&(Fe[Qt]=bt[Qt])}return Fe}:q=Object.assign;var se=H(function(Ee,Fe,at){for(var bt=Object.keys(Fe),Qt=0;Qt<bt.length;)(!at||at&&Ee[bt[Qt]]===i)&&(Ee[bt[Qt]]=Fe[bt[Qt]]),Qt++;return Ee},"extend","Use `assign`."),X=H(function(Ee,Fe){return se(Ee,Fe,!0)},"merge","Use `assign`.");function te(ge,Ee,Fe){var at=Ee.prototype,bt;bt=ge.prototype=Object.create(at),bt.constructor=ge,bt._super=at,Fe&&q(bt,Fe)}function ie(ge,Ee){return function(){return ge.apply(Ee,arguments)}}function fe(ge,Ee){return typeof ge==o?ge.apply(Ee&&Ee[0]||i,Ee):ge}function me(ge,Ee){return ge===i?Ee:ge}function Se(ge,Ee,Fe){U(nt(Ee),function(at){ge.addEventListener(at,Fe,!1)})}function He(ge,Ee,Fe){U(nt(Ee),function(at){ge.removeEventListener(at,Fe,!1)})}function Qe(ge,Ee){for(;ge;){if(ge==Ee)return!0;ge=ge.parentNode}return!1}function Ke(ge,Ee){return ge.indexOf(Ee)>-1}function nt(ge){return ge.trim().split(/\s+/g)}function Ne(ge,Ee,Fe){if(ge.indexOf&&!Fe)return ge.indexOf(Ee);for(var at=0;at<ge.length;){if(Fe&&ge[at][Fe]==Ee||!Fe&&ge[at]===Ee)return at;at++}return-1}function rt(ge){return Array.prototype.slice.call(ge,0)}function Ze(ge,Ee,Fe){for(var at=[],bt=[],Qt=0;Qt<ge.length;){var Ln=Ee?ge[Qt][Ee]:ge[Qt];Ne(bt,Ln)<0&&at.push(ge[Qt]),bt[Qt]=Ln,Qt++}return Fe&&(Ee?at=at.sort(function(en,Pr){return en[Ee]>Pr[Ee]}):at=at.sort()),at}function mt(ge,Ee){for(var Fe,at,bt=Ee[0].toUpperCase()+Ee.slice(1),Qt=0;Qt<s.length;){if(Fe=s[Qt],at=Fe?Fe+bt:Ee,at in ge)return at;Qt++}return i}var Kt=1;function Tt(){return Kt++}function dn(ge){var Ee=ge.ownerDocument||ge;return Ee.defaultView||Ee.parentWindow||e}var _t=/mobile|tablet|ip(ad|hone|od)|android/i,Et="ontouchstart"in e,Jt=mt(e,"PointerEvent")!==i,kn=Et&&_t.test(navigator.userAgent),Tn="touch",Tr="pen",Jn="mouse",ir="kinect",ur=25,Un=1,wr=2,wt=4,rn=8,Cn=1,xt=2,er=4,Hn=8,mr=16,or=xt|er,tr=Hn|mr,Kr=or|tr,Vn=["x","y"],Si=["clientX","clientY"];function Wn(ge,Ee){var Fe=this;this.manager=ge,this.callback=Ee,this.element=ge.element,this.target=ge.options.inputTarget,this.domHandler=function(at){fe(ge.options.enable,[ge])&&Fe.handler(at)},this.init()}Wn.prototype={handler:function(){},init:function(){this.evEl&&Se(this.element,this.evEl,this.domHandler),this.evTarget&&Se(this.target,this.evTarget,this.domHandler),this.evWin&&Se(dn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&He(this.element,this.evEl,this.domHandler),this.evTarget&&He(this.target,this.evTarget,this.domHandler),this.evWin&&He(dn(this.element),this.evWin,this.domHandler)}};function Fi(ge){var Ee,Fe=ge.options.inputClass;return Fe?Ee=Fe:Jt?Ee=Ye:kn?Ee=Vi:Et?Ee=K:Ee=Sn,new Ee(ge,fo)}function fo(ge,Ee,Fe){var at=Fe.pointers.length,bt=Fe.changedPointers.length,Qt=Ee&Un&&at-bt===0,Ln=Ee&(wt|rn)&&at-bt===0;Fe.isFirst=!!Qt,Fe.isFinal=!!Ln,Qt&&(ge.session={}),Fe.eventType=Ee,Fr(ge,Fe),ge.emit("hammer.input",Fe),ge.recognize(Fe),ge.session.prevInput=Fe}function Fr(ge,Ee){var Fe=ge.session,at=Ee.pointers,bt=at.length;Fe.firstInput||(Fe.firstInput=is(Ee)),bt>1&&!Fe.firstMultiple?Fe.firstMultiple=is(Ee):bt===1&&(Fe.firstMultiple=!1);var Qt=Fe.firstInput,Ln=Fe.firstMultiple,Mr=Ln?Ln.center:Qt.center,en=Ee.center=ct(at);Ee.timeStamp=C(),Ee.deltaTime=Ee.timeStamp-Qt.timeStamp,Ee.angle=Bn(Mr,en),Ee.distance=yi(Mr,en),Mi(Fe,Ee),Ee.offsetDirection=Bs(Ee.deltaX,Ee.deltaY);var Pr=kt(Ee.deltaTime,Ee.deltaX,Ee.deltaY);Ee.overallVelocityX=Pr.x,Ee.overallVelocityY=Pr.y,Ee.overallVelocity=w(Pr.x)>w(Pr.y)?Pr.x:Pr.y,Ee.scale=Ln?Ci(Ln.pointers,at):1,Ee.rotation=Ln?Ni(Ln.pointers,at):0,Ee.maxPointers=Fe.prevInput?Ee.pointers.length>Fe.prevInput.maxPointers?Ee.pointers.length:Fe.prevInput.maxPointers:Ee.pointers.length,Oo(Fe,Ee);var Gn=ge.element;Qe(Ee.srcEvent.target,Gn)&&(Gn=Ee.srcEvent.target),Ee.target=Gn}function Mi(ge,Ee){var Fe=Ee.center,at=ge.offsetDelta||{},bt=ge.prevDelta||{},Qt=ge.prevInput||{};(Ee.eventType===Un||Qt.eventType===wt)&&(bt=ge.prevDelta={x:Qt.deltaX||0,y:Qt.deltaY||0},at=ge.offsetDelta={x:Fe.x,y:Fe.y}),Ee.deltaX=bt.x+(Fe.x-at.x),Ee.deltaY=bt.y+(Fe.y-at.y)}function Oo(ge,Ee){var Fe=ge.lastInterval||Ee,at=Ee.timeStamp-Fe.timeStamp,bt,Qt,Ln,Mr;if(Ee.eventType!=rn&&(at>ur||Fe.velocity===i)){var en=Ee.deltaX-Fe.deltaX,Pr=Ee.deltaY-Fe.deltaY,Gn=kt(at,en,Pr);Qt=Gn.x,Ln=Gn.y,bt=w(Gn.x)>w(Gn.y)?Gn.x:Gn.y,Mr=Bs(en,Pr),ge.lastInterval=Ee}else bt=Fe.velocity,Qt=Fe.velocityX,Ln=Fe.velocityY,Mr=Fe.direction;Ee.velocity=bt,Ee.velocityX=Qt,Ee.velocityY=Ln,Ee.direction=Mr}function is(ge){for(var Ee=[],Fe=0;Fe<ge.pointers.length;)Ee[Fe]={clientX:g(ge.pointers[Fe].clientX),clientY:g(ge.pointers[Fe].clientY)},Fe++;return{timeStamp:C(),pointers:Ee,center:ct(Ee),deltaX:ge.deltaX,deltaY:ge.deltaY}}function ct(ge){var Ee=ge.length;if(Ee===1)return{x:g(ge[0].clientX),y:g(ge[0].clientY)};for(var Fe=0,at=0,bt=0;bt<Ee;)Fe+=ge[bt].clientX,at+=ge[bt].clientY,bt++;return{x:g(Fe/Ee),y:g(at/Ee)}}function kt(ge,Ee,Fe){return{x:Ee/ge||0,y:Fe/ge||0}}function Bs(ge,Ee){return ge===Ee?Cn:w(ge)>=w(Ee)?ge<0?xt:er:Ee<0?Hn:mr}function yi(ge,Ee,Fe){Fe||(Fe=Vn);var at=Ee[Fe[0]]-ge[Fe[0]],bt=Ee[Fe[1]]-ge[Fe[1]];return Math.sqrt(at*at+bt*bt)}function Bn(ge,Ee,Fe){Fe||(Fe=Vn);var at=Ee[Fe[0]]-ge[Fe[0]],bt=Ee[Fe[1]]-ge[Fe[1]];return Math.atan2(bt,at)*180/Math.PI}function Ni(ge,Ee){return Bn(Ee[1],Ee[0],Si)+Bn(ge[1],ge[0],Si)}function Ci(ge,Ee){return yi(Ee[0],Ee[1],Si)/yi(ge[0],ge[1],Si)}var Pi={mousedown:Un,mousemove:wr,mouseup:wt},ss="mousedown",Lt="mousemove mouseup";function Sn(){this.evEl=ss,this.evWin=Lt,this.pressed=!1,Wn.apply(this,arguments)}te(Sn,Wn,{handler:function(Ee){var Fe=Pi[Ee.type];Fe&Un&&Ee.button===0&&(this.pressed=!0),Fe&wr&&Ee.which!==1&&(Fe=wt),this.pressed&&(Fe&wt&&(this.pressed=!1),this.callback(this.manager,Fe,{pointers:[Ee],changedPointers:[Ee],pointerType:Jn,srcEvent:Ee}))}});var bn={pointerdown:Un,pointermove:wr,pointerup:wt,pointercancel:rn,pointerout:rn},Cr={2:Tn,3:Tr,4:Jn,5:ir},xs="pointerdown",yn="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(xs="MSPointerDown",yn="MSPointerMove MSPointerUp MSPointerCancel");function Ye(){this.evEl=xs,this.evWin=yn,Wn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}te(Ye,Wn,{handler:function(Ee){var Fe=this.store,at=!1,bt=Ee.type.toLowerCase().replace("ms",""),Qt=bn[bt],Ln=Cr[Ee.pointerType]||Ee.pointerType,Mr=Ln==Tn,en=Ne(Fe,Ee.pointerId,"pointerId");Qt&Un&&(Ee.button===0||Mr)?en<0&&(Fe.push(Ee),en=Fe.length-1):Qt&(wt|rn)&&(at=!0),!(en<0)&&(Fe[en]=Ee,this.callback(this.manager,Qt,{pointers:Fe,changedPointers:[Ee],pointerType:Ln,srcEvent:Ee}),at&&Fe.splice(en,1))}});var jr={touchstart:Un,touchmove:wr,touchend:wt,touchcancel:rn},zs="touchstart",Dr="touchstart touchmove touchend touchcancel";function oi(){this.evTarget=zs,this.evWin=Dr,this.started=!1,Wn.apply(this,arguments)}te(oi,Wn,{handler:function(Ee){var Fe=jr[Ee.type];if(Fe===Un&&(this.started=!0),!!this.started){var at=Zn.call(this,Ee,Fe);Fe&(wt|rn)&&at[0].length-at[1].length===0&&(this.started=!1),this.callback(this.manager,Fe,{pointers:at[0],changedPointers:at[1],pointerType:Tn,srcEvent:Ee})}}});function Zn(ge,Ee){var Fe=rt(ge.touches),at=rt(ge.changedTouches);return Ee&(wt|rn)&&(Fe=Ze(Fe.concat(at),"identifier",!0)),[Fe,at]}var Os={touchstart:Un,touchmove:wr,touchend:wt,touchcancel:rn},Ui="touchstart touchmove touchend touchcancel";function Vi(){this.evTarget=Ui,this.targetIds={},Wn.apply(this,arguments)}te(Vi,Wn,{handler:function(Ee){var Fe=Os[Ee.type],at=Ii.call(this,Ee,Fe);at&&this.callback(this.manager,Fe,{pointers:at[0],changedPointers:at[1],pointerType:Tn,srcEvent:Ee})}});function Ii(ge,Ee){var Fe=rt(ge.touches),at=this.targetIds;if(Ee&(Un|wr)&&Fe.length===1)return at[Fe[0].identifier]=!0,[Fe,Fe];var bt,Qt,Ln=rt(ge.changedTouches),Mr=[],en=this.target;if(Qt=Fe.filter(function(Pr){return Qe(Pr.target,en)}),Ee===Un)for(bt=0;bt<Qt.length;)at[Qt[bt].identifier]=!0,bt++;for(bt=0;bt<Ln.length;)at[Ln[bt].identifier]&&Mr.push(Ln[bt]),Ee&(wt|rn)&&delete at[Ln[bt].identifier],bt++;if(Mr.length)return[Ze(Qt.concat(Mr),"identifier",!0),Mr]}var os=2500,Rr=25;function K(){Wn.apply(this,arguments);var ge=ie(this.handler,this);this.touch=new Vi(this.manager,ge),this.mouse=new Sn(this.manager,ge),this.primaryTouch=null,this.lastTouches=[]}te(K,Wn,{handler:function(Ee,Fe,at){var bt=at.pointerType==Tn,Qt=at.pointerType==Jn;if(!(Qt&&at.sourceCapabilities&&at.sourceCapabilities.firesTouchEvents)){if(bt)W.call(this,Fe,at);else if(Qt&&he.call(this,at))return;this.callback(Ee,Fe,at)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function W(ge,Ee){ge&Un?(this.primaryTouch=Ee.changedPointers[0].identifier,ee.call(this,Ee)):ge&(wt|rn)&&ee.call(this,Ee)}function ee(ge){var Ee=ge.changedPointers[0];if(Ee.identifier===this.primaryTouch){var Fe={x:Ee.clientX,y:Ee.clientY};this.lastTouches.push(Fe);var at=this.lastTouches,bt=function(){var Qt=at.indexOf(Fe);Qt>-1&&at.splice(Qt,1)};setTimeout(bt,os)}}function he(ge){for(var Ee=ge.srcEvent.clientX,Fe=ge.srcEvent.clientY,at=0;at<this.lastTouches.length;at++){var bt=this.lastTouches[at],Qt=Math.abs(Ee-bt.x),Ln=Math.abs(Fe-bt.y);if(Qt<=Rr&&Ln<=Rr)return!0}return!1}var a=mt(A.style,"touchAction"),G=a!==i,Le="compute",Ie="auto",Pe="manipulation",ke="none",qe="pan-x",lt="pan-y",We=Rt();function ft(ge,Ee){this.manager=ge,this.set(Ee)}ft.prototype={set:function(ge){ge==Le&&(ge=this.compute()),G&&this.manager.element.style&&We[ge]&&(this.manager.element.style[a]=ge),this.actions=ge.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ge=[];return U(this.manager.recognizers,function(Ee){fe(Ee.options.enable,[Ee])&&(ge=ge.concat(Ee.getTouchAction()))}),Dt(ge.join(" "))},preventDefaults:function(ge){var Ee=ge.srcEvent,Fe=ge.offsetDirection;if(this.manager.session.prevented){Ee.preventDefault();return}var at=this.actions,bt=Ke(at,ke)&&!We[ke],Qt=Ke(at,lt)&&!We[lt],Ln=Ke(at,qe)&&!We[qe];if(bt){var Mr=ge.pointers.length===1,en=ge.distance<2,Pr=ge.deltaTime<250;if(Mr&&en&&Pr)return}if(!(Ln&&Qt)&&(bt||Qt&&Fe&or||Ln&&Fe&tr))return this.preventSrc(Ee)},preventSrc:function(ge){this.manager.session.prevented=!0,ge.preventDefault()}};function Dt(ge){if(Ke(ge,ke))return ke;var Ee=Ke(ge,qe),Fe=Ke(ge,lt);return Ee&&Fe?ke:Ee||Fe?Ee?qe:lt:Ke(ge,Pe)?Pe:Ie}function Rt(){if(!G)return!1;var ge={},Ee=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Fe){ge[Fe]=Ee?e.CSS.supports("touch-action",Fe):!0}),ge}var sn=1,jt=2,pn=4,qt=8,an=qt,xn=16,Ft=32;function Oe(ge){this.options=q({},this.defaults,ge||{}),this.id=Tt(),this.manager=null,this.options.enable=me(this.options.enable,!0),this.state=sn,this.simultaneous={},this.requireFail=[]}Oe.prototype={defaults:{},set:function(ge){return q(this.options,ge),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ge){if(k(ge,"recognizeWith",this))return this;var Ee=this.simultaneous;return ge=un(ge,this),Ee[ge.id]||(Ee[ge.id]=ge,ge.recognizeWith(this)),this},dropRecognizeWith:function(ge){return k(ge,"dropRecognizeWith",this)?this:(ge=un(ge,this),delete this.simultaneous[ge.id],this)},requireFailure:function(ge){if(k(ge,"requireFailure",this))return this;var Ee=this.requireFail;return ge=un(ge,this),Ne(Ee,ge)===-1&&(Ee.push(ge),ge.requireFailure(this)),this},dropRequireFailure:function(ge){if(k(ge,"dropRequireFailure",this))return this;ge=un(ge,this);var Ee=Ne(this.requireFail,ge);return Ee>-1&&this.requireFail.splice(Ee,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ge){return!!this.simultaneous[ge.id]},emit:function(ge){var Ee=this,Fe=this.state;function at(bt){Ee.manager.emit(bt,ge)}Fe<qt&&at(Ee.options.event+Ct(Fe)),at(Ee.options.event),ge.additionalEvent&&at(ge.additionalEvent),Fe>=qt&&at(Ee.options.event+Ct(Fe))},tryEmit:function(ge){if(this.canEmit())return this.emit(ge);this.state=Ft},canEmit:function(){for(var ge=0;ge<this.requireFail.length;){if(!(this.requireFail[ge].state&(Ft|sn)))return!1;ge++}return!0},recognize:function(ge){var Ee=q({},ge);if(!fe(this.options.enable,[this,Ee])){this.reset(),this.state=Ft;return}this.state&(an|xn|Ft)&&(this.state=sn),this.state=this.process(Ee),this.state&(jt|pn|qt|xn)&&this.tryEmit(Ee)},process:function(ge){},getTouchAction:function(){},reset:function(){}};function Ct(ge){return ge&xn?"cancel":ge&qt?"end":ge&pn?"move":ge&jt?"start":""}function Me(ge){return ge==mr?"down":ge==Hn?"up":ge==xt?"left":ge==er?"right":""}function un(ge,Ee){var Fe=Ee.manager;return Fe?Fe.get(ge):ge}function ai(){Oe.apply(this,arguments)}te(ai,Oe,{defaults:{pointers:1},attrTest:function(ge){var Ee=this.options.pointers;return Ee===0||ge.pointers.length===Ee},process:function(ge){var Ee=this.state,Fe=ge.eventType,at=Ee&(jt|pn),bt=this.attrTest(ge);return at&&(Fe&rn||!bt)?Ee|xn:at||bt?Fe&wt?Ee|qt:Ee&jt?Ee|pn:jt:Ft}});function nr(){ai.apply(this,arguments),this.pX=null,this.pY=null}te(nr,ai,{defaults:{event:"pan",threshold:10,pointers:1,direction:Kr},getTouchAction:function(){var ge=this.options.direction,Ee=[];return ge&or&&Ee.push(lt),ge&tr&&Ee.push(qe),Ee},directionTest:function(ge){var Ee=this.options,Fe=!0,at=ge.distance,bt=ge.direction,Qt=ge.deltaX,Ln=ge.deltaY;return bt&Ee.direction||(Ee.direction&or?(bt=Qt===0?Cn:Qt<0?xt:er,Fe=Qt!=this.pX,at=Math.abs(ge.deltaX)):(bt=Ln===0?Cn:Ln<0?Hn:mr,Fe=Ln!=this.pY,at=Math.abs(ge.deltaY))),ge.direction=bt,Fe&&at>Ee.threshold&&bt&Ee.direction},attrTest:function(ge){return ai.prototype.attrTest.call(this,ge)&&(this.state&jt||!(this.state&jt)&&this.directionTest(ge))},emit:function(ge){this.pX=ge.deltaX,this.pY=ge.deltaY;var Ee=Me(ge.direction);Ee&&(ge.additionalEvent=this.options.event+Ee),this._super.emit.call(this,ge)}});function aa(){ai.apply(this,arguments)}te(aa,ai,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ke]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.scale-1)>this.options.threshold||this.state&jt)},emit:function(ge){if(ge.scale!==1){var Ee=ge.scale<1?"in":"out";ge.additionalEvent=this.options.event+Ee}this._super.emit.call(this,ge)}});function De(){Oe.apply(this,arguments),this._timer=null,this._input=null}te(De,Oe,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ie]},process:function(ge){var Ee=this.options,Fe=ge.pointers.length===Ee.pointers,at=ge.distance<Ee.threshold,bt=ge.deltaTime>Ee.time;if(this._input=ge,!at||!Fe||ge.eventType&(wt|rn)&&!bt)this.reset();else if(ge.eventType&Un)this.reset(),this._timer=I(function(){this.state=an,this.tryEmit()},Ee.time,this);else if(ge.eventType&wt)return an;return Ft},reset:function(){clearTimeout(this._timer)},emit:function(ge){this.state===an&&(ge&&ge.eventType&wt?this.manager.emit(this.options.event+"up",ge):(this._input.timeStamp=C(),this.manager.emit(this.options.event,this._input)))}});function za(){ai.apply(this,arguments)}te(za,ai,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ke]},attrTest:function(ge){return this._super.attrTest.call(this,ge)&&(Math.abs(ge.rotation)>this.options.threshold||this.state&jt)}});function we(){ai.apply(this,arguments)}te(we,ai,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:or|tr,pointers:1},getTouchAction:function(){return nr.prototype.getTouchAction.call(this)},attrTest:function(ge){var Ee=this.options.direction,Fe;return Ee&(or|tr)?Fe=ge.overallVelocity:Ee&or?Fe=ge.overallVelocityX:Ee&tr&&(Fe=ge.overallVelocityY),this._super.attrTest.call(this,ge)&&Ee&ge.offsetDirection&&ge.distance>this.options.threshold&&ge.maxPointers==this.options.pointers&&w(Fe)>this.options.velocity&&ge.eventType&wt},emit:function(ge){var Ee=Me(ge.offsetDirection);Ee&&this.manager.emit(this.options.event+Ee,ge),this.manager.emit(this.options.event,ge)}});function Fo(){Oe.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}te(Fo,Oe,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pe]},process:function(ge){var Ee=this.options,Fe=ge.pointers.length===Ee.pointers,at=ge.distance<Ee.threshold,bt=ge.deltaTime<Ee.time;if(this.reset(),ge.eventType&Un&&this.count===0)return this.failTimeout();if(at&&bt&&Fe){if(ge.eventType!=wt)return this.failTimeout();var Qt=this.pTime?ge.timeStamp-this.pTime<Ee.interval:!0,Ln=!this.pCenter||yi(this.pCenter,ge.center)<Ee.posThreshold;this.pTime=ge.timeStamp,this.pCenter=ge.center,!Ln||!Qt?this.count=1:this.count+=1,this._input=ge;var Mr=this.count%Ee.taps;if(Mr===0)return this.hasRequireFailures()?(this._timer=I(function(){this.state=an,this.tryEmit()},Ee.interval,this),jt):an}return Ft},failTimeout:function(){return this._timer=I(function(){this.state=Ft},this.options.interval,this),Ft},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==an&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ws(ge,Ee){return Ee=Ee||{},Ee.recognizers=me(Ee.recognizers,ws.defaults.preset),new la(ge,Ee)}ws.VERSION="2.0.7",ws.defaults={domEvents:!1,touchAction:Le,enable:!0,inputTarget:null,inputClass:null,preset:[[za,{enable:!1}],[aa,{enable:!1},["rotate"]],[we,{direction:or}],[nr,{direction:or},["swipe"]],[Fo],[Fo,{event:"doubletap",taps:2},["tap"]],[De]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Oa=1,Fa=2;function la(ge,Ee){this.options=q({},ws.defaults,Ee||{}),this.options.inputTarget=this.options.inputTarget||ge,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ge,this.input=Fi(this),this.touchAction=new ft(this,this.options.touchAction),gl(this,!0),U(this.options.recognizers,function(Fe){var at=this.add(new Fe[0](Fe[1]));Fe[2]&&at.recognizeWith(Fe[2]),Fe[3]&&at.requireFailure(Fe[3])},this)}la.prototype={set:function(ge){return q(this.options,ge),ge.touchAction&&this.touchAction.update(),ge.inputTarget&&(this.input.destroy(),this.input.target=ge.inputTarget,this.input.init()),this},stop:function(ge){this.session.stopped=ge?Fa:Oa},recognize:function(ge){var Ee=this.session;if(!Ee.stopped){this.touchAction.preventDefaults(ge);var Fe,at=this.recognizers,bt=Ee.curRecognizer;(!bt||bt&&bt.state&an)&&(bt=Ee.curRecognizer=null);for(var Qt=0;Qt<at.length;)Fe=at[Qt],Ee.stopped!==Fa&&(!bt||Fe==bt||Fe.canRecognizeWith(bt))?Fe.recognize(ge):Fe.reset(),!bt&&Fe.state&(jt|pn|qt)&&(bt=Ee.curRecognizer=Fe),Qt++}},get:function(ge){if(ge instanceof Oe)return ge;for(var Ee=this.recognizers,Fe=0;Fe<Ee.length;Fe++)if(Ee[Fe].options.event==ge)return Ee[Fe];return null},add:function(ge){if(k(ge,"add",this))return this;var Ee=this.get(ge.options.event);return Ee&&this.remove(Ee),this.recognizers.push(ge),ge.manager=this,this.touchAction.update(),ge},remove:function(ge){if(k(ge,"remove",this))return this;if(ge=this.get(ge),ge){var Ee=this.recognizers,Fe=Ne(Ee,ge);Fe!==-1&&(Ee.splice(Fe,1),this.touchAction.update())}return this},on:function(ge,Ee){if(ge!==i&&Ee!==i){var Fe=this.handlers;return U(nt(ge),function(at){Fe[at]=Fe[at]||[],Fe[at].push(Ee)}),this}},off:function(ge,Ee){if(ge!==i){var Fe=this.handlers;return U(nt(ge),function(at){Ee?Fe[at]&&Fe[at].splice(Ne(Fe[at],Ee),1):delete Fe[at]}),this}},emit:function(ge,Ee){this.options.domEvents&&Aa(ge,Ee);var Fe=this.handlers[ge]&&this.handlers[ge].slice();if(!(!Fe||!Fe.length)){Ee.type=ge,Ee.preventDefault=function(){Ee.srcEvent.preventDefault()};for(var at=0;at<Fe.length;)Fe[at](Ee),at++}},destroy:function(){this.element&&gl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function gl(ge,Ee){var Fe=ge.element;if(Fe.style){var at;U(ge.options.cssProps,function(bt,Qt){at=mt(Fe.style,Qt),Ee?(ge.oldCssProps[at]=Fe.style[at],Fe.style[at]=bt):Fe.style[at]=ge.oldCssProps[at]||""}),Ee||(ge.oldCssProps={})}}function Aa(ge,Ee){var Fe=n.createEvent("Event");Fe.initEvent(ge,!0,!0),Fe.gesture=Ee,Ee.target.dispatchEvent(Fe)}q(ws,{INPUT_START:Un,INPUT_MOVE:wr,INPUT_END:wt,INPUT_CANCEL:rn,STATE_POSSIBLE:sn,STATE_BEGAN:jt,STATE_CHANGED:pn,STATE_ENDED:qt,STATE_RECOGNIZED:an,STATE_CANCELLED:xn,STATE_FAILED:Ft,DIRECTION_NONE:Cn,DIRECTION_LEFT:xt,DIRECTION_RIGHT:er,DIRECTION_UP:Hn,DIRECTION_DOWN:mr,DIRECTION_HORIZONTAL:or,DIRECTION_VERTICAL:tr,DIRECTION_ALL:Kr,Manager:la,Input:Wn,TouchAction:ft,TouchInput:Vi,MouseInput:Sn,PointerEventInput:Ye,TouchMouseInput:K,SingleTouchInput:oi,Recognizer:Oe,AttrRecognizer:ai,Tap:Fo,Pan:nr,Swipe:we,Pinch:aa,Rotate:za,Press:De,on:Se,off:He,each:U,merge:X,extend:se,assign:q,inherit:te,bindFn:ie,prefixed:mt});var Jr=typeof e<"u"?e:typeof self<"u"?self:{};Jr.Hammer=ws,typeof i=="function"&&i.amd?i(function(){return ws}):t.exports?t.exports=ws:e[r]=ws})(window,document,"Hammer")})(zB);var hm=zB.exports;const zJ=b2(hm),bA=ME({__proto__:null,default:zJ},[hm]),OB=1,FB=2,x3=4,OJ={mousedown:OB,mousemove:FB,mouseup:x3};function FJ(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function NJ(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(FJ(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function UJ(t){t.prototype.handler=function(n){let r=OJ[n.type];r&OB&&n.button>=0&&(this.pressed=!0),r&FB&&n.which===0&&(r=x3),this.pressed&&(r&x3&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}NJ(hm.PointerEventInput);UJ(hm.MouseInput);const VJ=hm.Manager;class W2{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const GJ=bA?[[bA.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[bA.Rotate,{enable:!1}],[bA.Pinch,{enable:!1}],[bA.Swipe,{enable:!1}],[bA.Pan,{threshold:0,enable:!1}],[bA.Press,{enable:!1}],[bA.Tap,{event:"doubletap",taps:2,enable:!1}],[bA.Tap,{event:"anytap",enable:!1}],[bA.Tap,{enable:!1}]]:null,GP={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},$J={doubletap:["tap"]},jJ={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},JT={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},HJ={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},$P={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},WJ=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",m0=typeof window<"u"?window:global;let w3=!1;try{const t={get passive(){return w3=!0,!0}};m0.addEventListener("test",null,t),m0.removeEventListener("test",null)}catch{w3=!1}const QJ=WJ.indexOf("firefox")!==-1,{WHEEL_EVENTS:qJ}=JT,jP="wheel",HP=4.000244140625,ZJ=40,YJ=.25;class XJ extends W2{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;m0.WheelEvent&&(QJ&&i.deltaMode===m0.WheelEvent.DOM_DELTA_PIXEL&&(s/=m0.devicePixelRatio),i.deltaMode===m0.WheelEvent.DOM_DELTA_LINE&&(s*=ZJ)),s!==0&&s%HP===0&&(s=Math.floor(s/HP)),i.shiftKey&&s&&(s=s*YJ),this.callback({type:jP,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(qJ),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,w3?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===jP&&(this.options.enable=n)}}const{MOUSE_EVENTS:KJ}=JT,WP="pointermove",QP="pointerover",qP="pointerout",ZP="pointerenter",YP="pointerleave";class JJ extends W2{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(KJ),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===WP&&(this.enableMoveEvent=n),e===QP&&(this.enableOverEvent=n),e===qP&&(this.enableOutEvent=n),e===ZP&&(this.enableEnterEvent=n),e===YP&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(QP,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(qP,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(ZP,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(YP,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(WP,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:eee}=JT,XP="keydown",KP="keyup";class tee extends W2{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:XP,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:KP,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(eee),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===XP&&(this.enableDownEvent=n),e===KP&&(this.enableUpEvent=n)}}const JP="contextmenu";class nee extends W2{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:JP,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===JP&&(this.options.enable=n)}}const b3=1,E_=2,E3=4,ree={pointerdown:b3,pointermove:E_,pointerup:E3,mousedown:b3,mousemove:E_,mouseup:E3},iee=1,see=2,oee=3,aee=0,lee=1,Aee=2,uee=1,cee=2,hee=4;function fee(t){const e=ree[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,A=!1,o=!1;return e===E3||e===E_&&!Number.isFinite(n)?(s=i===iee,A=i===see,o=i===oee):e===E_?(s=!!(n&uee),A=!!(n&hee),o=!!(n&cee)):e===b3&&(s=r===aee,A=r===lee,o=r===Aee),{leftButton:s,middleButton:A,rightButton:o}}function dee(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,A={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:A}}const cw={srcElement:"root",priority:0};class pee{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:A,handlersByElement:o}=this;let g=cw;typeof r=="string"||r&&r.addEventListener?g={...cw,srcElement:r}:r&&(g={...cw,...r});let w=o.get(g.srcElement);w||(w=[],o.set(g.srcElement,w));const C={type:e,handler:n,srcElement:g.srcElement,priority:g.priority};i&&(C.once=!0),s&&(C.passive=!0),A.push(C),this._active=this._active||!C.passive;let I=w.length-1;for(;I>=0&&!(w[I].priority>=C.priority);)I--;w.splice(I+1,0,C)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const A=r[s];if(A.type===e&&A.handler===n){r.splice(s,1);const o=i.get(A.srcElement);o.splice(o.indexOf(A),1),o.length===0&&i.delete(A.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},A=()=>{e.handled=!0,i=!0},o=[];for(let g=0;g<r.length;g++){const{type:w,handler:C,once:I}=r[g];if(C({...e,type:w,stopPropagation:s,stopImmediatePropagation:A}),I&&o.push(r[g]),i)break}for(let g=0;g<o.length;g++){const{type:w,handler:C}=o[g];this.remove(w,C)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...fee(e),...dee(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const gee={events:null,recognizers:null,recognizerOptions:{},Manager:VJ,touchAction:"none",tabIndex:0};class mee{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,A=jJ[s.type];A&&this.manager.emit(A,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...gee,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||GJ}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(GP).forEach(i=>{const s=this.manager.get(i);s&&GP[i].forEach(A=>{s.recognizeWith(A)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const A=n.recognizerOptions[i];delete A.enable,s.set(A)}}this.wheelInput=new XJ(e,this._onOtherEvent,{enable:!1}),this.moveInput=new JJ(e,this._onOtherEvent,{enable:!1}),this.keyInput=new tee(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new nee(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=$J[e];s&&!this.options.recognizers&&s.forEach(A=>{const o=r.get(A);n?(o.requireFailure(e),i.dropRequireFailure(A)):o.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const C in e)this._addEventHandler(C,e[C],r,i,s);return}const{manager:A,events:o}=this,g=$P[e]||e;let w=o.get(g);w||(w=new pee(this),o.set(g,w),w.recognizerName=HJ[g]||g,A&&A.on(g,w.handleEvent)),w.add(e,n,r,i,s),w.isEmpty()||this._toggleRecognizer(w.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const A in e)this._removeEventHandler(A,e[A]);return}const{events:r}=this,i=$P[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:A}=s;let o=!1;for(const g of r.values())if(g.recognizerName===A&&!g.isEmpty()){o=!0;break}o||this._toggleRecognizer(A,!1)}}}function Ch(){}const yee=({isDragging:t})=>t?"grabbing":"grab",NB={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Ch,onResize:Ch,onViewStateChange:Ch,onInteractionStateChange:Ch,onBeforeRender:Ch,onAfterRender:Ch,onLoad:Ch,onError:t=>rr.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:yee,getTooltip:null,debug:!1,drawPickingColors:!1};class af{constructor(e){oe(this,"props",void 0),oe(this,"width",0),oe(this,"height",0),oe(this,"userData",{}),oe(this,"canvas",null),oe(this,"viewManager",null),oe(this,"layerManager",null),oe(this,"effectManager",null),oe(this,"deckRenderer",null),oe(this,"deckPicker",null),oe(this,"eventManager",null),oe(this,"tooltip",null),oe(this,"metrics",void 0),oe(this,"animationLoop",void 0),oe(this,"stats",void 0),oe(this,"viewState",void 0),oe(this,"cursorState",void 0),oe(this,"_needsRedraw",void 0),oe(this,"_pickRequest",void 0),oe(this,"_lastPointerDownInfo",null),oe(this,"_metricsCounter",void 0),oe(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),oe(this,"_onEvent",n=>{const r=TC[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),A=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=A,g=o&&(o[r.handler]||o.props[r.handler]),w=this.props[r.handler];let C=!1;g&&(C=g.call(o,A,n)),!C&&w&&w(A,n)}),oe(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...NB,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&rr.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),Zj()==="IE"&&rr.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new kB({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&od.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,A,o,g;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(A=this.deckPicker)===null||A===void 0||A.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(g=this.tooltip)===null||g===void 0||g.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var w;(w=this.canvas.parentElement)===null||w===void 0||w.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&rr.removed("onLayerHover","onHover")(),"onLayerClick"in e&&rr.removed("onLayerClick","onClick")(),e.initialViewState&&!Ql(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),A=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||A,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Bi(this.viewManager),this.viewManager.views}getViewports(e){return Bi(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Bi(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Bi(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var A,o;this.width=i,this.height=s,(A=this.viewManager)===null||A===void 0||A.setProps({width:i,height:s}),(o=this.layerManager)===null||o===void 0||o.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:A,onError:o,onBeforeRender:g,onAfterRender:w,useDevicePixels:C}=e;return new xq({width:n,height:r,useDevicePixels:C,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:I=>vR({...s,...I,canvas:this.canvas,debug:A,onContextLost:()=>this._onContextLost()}),onInitialize:I=>this._setGLContext(I.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:g,onAfterRender:w,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Gu({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,A=!1;for(const o of r){var n;s=o,A=((n=o.layer)===null||n===void 0?void 0:n.onHover(o,e.event))||A}if(!A&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,BT(e,{enable:!0,copyState:!0})),this.tooltip=new BJ(this.canvas),Zu(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new fB;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new mee(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in TC)this.eventManager.on(i,this._onEvent);this.viewManager=new AJ({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new lJ(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new EJ,this.deckRenderer=new MJ(e),this.deckPicker=new DJ(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;Zu(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),rr.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=Vh.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}oe(af,"defaultProps",NB);oe(af,"VERSION",cH);class hw{constructor(e,n){oe(this,"opts",void 0),oe(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const A=n.elementOffset||0;for(let o=0;o<i;++o)s[o]=r[A+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function _ee(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function yy(t){return t.stride||t.size*t.bytesPerElement}function UB(t,e){e.offset&&rr.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=yy(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function vee(t,e){const n=UB(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class xee{constructor(e,n,r){oe(this,"gl",void 0),oe(this,"id",void 0),oe(this,"size",void 0),oe(this,"settings",void 0),oe(this,"value",void 0),oe(this,"doublePrecision",void 0),oe(this,"_buffer",void 0),oe(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:A}=n;A=Number.isFinite(A)?[A]:A||new Array(this.size).fill(0);let o;s?o=5126:!i&&n.isIndexed?o=e&&kR(e,Yr.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let g=_ee(i||o||5126);this.doublePrecision=s,s&&n.fp64===!1&&(g=Float32Array),this.value=null,this.settings={...n,defaultType:g,defaultValue:A,logicalType:i,type:o,size:this.size,bytesPerElement:g.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new Or(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*yy(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),od.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=vee(this.getAccessor(),n||{});return r[e]=new hw(this,s.high),r["".concat(e,"64Low")]=i?new hw(this,s.low):new Float32Array(this.size),r}if(n){const r=UB(this.getAccessor(),n);return{[e]:new hw(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const A=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let g=0;g<s;)for(let w=0;w<i;w++){const C=n[g++];C<A[w]&&(A[w]=C),C>o[w]&&(o[w]=C)}e=[A,o]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Or?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const A=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(A?2:1),i.stride=yy(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=yy(i);const{buffer:A,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=lw(s,i));const g=s.byteLength+o+i.stride*2;A.byteLength<g&&A.reallocate(g),A.setAccessor(null),A.subData({data:s,offset:o}),i.type=r.type||A.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?lw(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=od.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:A,byteOffset:o}=this;return A.byteLength<s.byteLength+o&&(A.reallocate(s.byteLength+o),n&&i&&A.subData({data:i instanceof Float64Array?lw(i,this):i,offset:o})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&rr.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let A=s;for(;--A>=0;)n[r+A]=i[A];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let A=s;for(;--A>=0;)n[r+A]=Number.isFinite(e[A])?e[A]:i[A]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const eI=[],tI=[];function Td(t,e=0,n=1/0){let r=eI;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(tI.length=t.length,r=tI):r=eI,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function VB(t){return t&&t[Symbol.asyncIterator]}function GB(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:A}=e,o=t.BYTES_PER_ELEMENT,g=r?r/o:n,w=i?i/o:0,C=Math.floor((t.length-w)/g);return(I,{index:k,target:U})=>{if(!s){const X=k*g+w;for(let te=0;te<n;te++)U[te]=t[X+te];return U}const H=s[k],q=s[k+1]||C;let se;if(A){se=new Array(q-H);for(let X=H;X<q;X++){const te=X*g+w;U=new Array(n);for(let ie=0;ie<n;ie++)U[ie]=t[te+ie];se[X-H]=U}}else if(g===n)se=t.subarray(H*n+w,q*n+w);else{se=new t.constructor((q-H)*n);let X=0;for(let te=H;te<q;te++){const ie=te*g+w;for(let fe=0;fe<n;fe++)se[X++]=t[ie+fe]}}return se}}const wee=[],_y=[[0,1/0]];function bee(t,e){if(t===_y||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const A=t[s];A[1]<e[0]?(n.push(A),i=s+1):A[0]>e[1]?n.push(A):e=[Math.min(A[0],e[0]),Math.max(A[1],e[1])]}return n.splice(i,0,e),n}function fw(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,A=t.end||n.length,o=e.length,g=A-r;if(o>g){n.set(e.subarray(0,g),r);return}if(n.set(e,r),!s)return;let w=o;for(;w<g;){const C=s(w,e);for(let I=0;I<i;I++)n[r+w]=C[I]||0,w++}}function Eee({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return fw({source:t,target:e,size:n,getData:r}),e;let A=0,o=0;const g=r&&((C,I)=>r(C+o,I)),w=Math.min(i.length,s.length);for(let C=1;C<w;C++){const I=i[C]*n,k=s[C]*n;fw({source:t.subarray(A,I),target:e,start:o,end:k,size:n,getData:g}),A=I,o=k}return o<e.length&&fw({source:[],target:e,start:o,size:n,getData:g}),e}const Tee={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function $B(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Tee[n],...e,...t,type:n}}function jB(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function HB(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function WB(t){t.push(t.shift())}function eS(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,A=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*A}function QB({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=A=>A}){const A=n.doublePrecision&&n.value instanceof Float64Array?2:1,o=n.size*A,g=n.byteOffset,w=n.startIndices,C=i&&w,I=eS(n,e),k=n.isConstant;if(!C&&r>=I)return;const U=k?n.value:n.getBuffer().getData({srcByteOffset:g});if(n.settings.normalized&&!k){const X=s;s=(te,ie)=>n.normalizeConstant(X(te,ie))}const H=k?(X,te)=>s(U,te):(X,te)=>s(U.subarray(X,X+o),te),q=t.getData({length:r}),se=new Float32Array(I);Eee({source:q,target:se,sourceStartIndices:i,targetStartIndices:w,size:o,getData:H}),t.byteLength<se.byteLength+g&&t.reallocate(se.byteLength+g),t.subData({data:se,offset:g})}class tS extends xee{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:_y}),oe(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return $B(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=bee(this.state.updateRanges,[r,i])}else this.state.updateRanges=_y}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=wee}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==_y),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:A,noAlloc:o}}=this;let g=!0;if(A){for(const[w,C]of s)A.call(i,this,{data:n,startRow:w,endRow:C,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[w,C]of s){const I=Number.isFinite(w)?this.getVertexOffset(w):0,k=Number.isFinite(C)?this.getVertexOffset(C):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:I,endOffset:k})}this._checkAttributeArray()}else g=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),g}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const A=e;Bi(ArrayBuffer.isView(A.value),"invalid ".concat(i.accessor));const o=!!A.size&&A.size!==this.size;return r.binaryAccessor=GB(A.value,{size:A.size||this.size,stride:A.stride,offset:A.offset,startIndices:n,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:A}){if(e.constant)return;const{settings:o,state:g,value:w,size:C,startIndices:I}=e,{accessor:k,transform:U}=o,H=g.binaryAccessor||(typeof k=="function"?k:s[k]);Bi(typeof H=="function",'accessor "'.concat(k,'" is not a function'));let q=e.getVertexOffset(r);const{iterable:se,objectInfo:X}=Td(n,r,i);for(const te of se){X.index++;let ie=H(te,X);if(U&&(ie=U.call(this,ie)),I){const fe=(X.index<I.length-1?I[X.index+1]:A)-I[X.index];if(ie&&Array.isArray(ie[0])){let me=q;for(const Se of ie)e._normalizeValue(Se,w,me),me+=C}else ie&&ie.length>C?w.set(ie,q):(e._normalizeValue(ie,X.target,0),JK({target:w,source:X.target,start:q,count:fe}));q+=fe*C}else e._normalizeValue(ie,w,q),q+=C}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class See{constructor({gl:e,attribute:n,timeline:r}){oe(this,"gl",void 0),oe(this,"type","interpolation"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.transition=new cm(r),this.attribute=n,this.attributeInTransition=new tS(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=Cee(e,n);const i={byteLength:0,usage:35050};this.buffers=[new Or(e,i),new Or(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;WB(i);const A={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)QB({buffer:o,...A});this.currentStartIndices=s.startIndices,this.currentLength=eS(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:jB(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const Mee=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function Cee(t,e){const n=HB(e.size);return new QT(t,{vs:Mee,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class Pee{constructor({gl:e,attribute:n,timeline:r}){oe(this,"gl",void 0),oe(this,"type","spring"),oe(this,"attributeInTransition",void 0),oe(this,"settings",void 0),oe(this,"attribute",void 0),oe(this,"transition",void 0),oe(this,"currentStartIndices",void 0),oe(this,"currentLength",void 0),oe(this,"texture",void 0),oe(this,"framebuffer",void 0),oe(this,"transform",void 0),oe(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new cm(r),this.attribute=n,this.attributeInTransition=new tS(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=kee(e),this.framebuffer=Lee(e,this.texture),this.transform=Iee(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new Or(e,i),new Or(e,i),new Or(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,A={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)QB({buffer:o,...A});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=eS(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:jB(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const A=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:A.stiffness,damping:A.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),WB(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),H2(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function Iee(t,e,n){const r=HB(e.size);return new QT(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function kee(t){return new oa(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function Lee(t,e){return new ts(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const Dee={interpolation:See,spring:Pee};class Ree{constructor(e,{id:n,timeline:r}){oe(this,"id",void 0),oe(this,"isSupported",void 0),oe(this,"gl",void 0),oe(this,"timeline",void 0),oe(this,"transitions",void 0),oe(this,"needsRedraw",void 0),oe(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=QT.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],A=s.getTransitionSetting(n);A&&this._updateAttribute(i,s,A)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){rr.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const A=Dee[r.type];A?this.transitions[e]=new A({attribute:n,timeline:this.timeline,gl:this.gl}):(rr.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const nI="attributeManager.invalidate",Bee="attributeManager.updateStart",zee="attributeManager.updateEnd",Oee="attribute.updateStart",Fee="attribute.allocate",Nee="attribute.updateEnd";class Uee{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){oe(this,"id",void 0),oe(this,"gl",void 0),oe(this,"attributes",void 0),oe(this,"updateTriggers",void 0),oe(this,"needsRedraw",void 0),oe(this,"userData",void 0),oe(this,"stats",void 0),oe(this,"attributeTransitionManager",void 0),oe(this,"mergeBoundsMemoized",um(TK)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Ree(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);oo(nI,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);oo(nI,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:A={},context:o={}}){let g=!1;oo(Bee,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const w in this.attributes){const C=this.attributes[w],I=C.settings.accessor;C.startIndices=r,C.numInstances=n,s[w]&&rr.removed("props.".concat(w),"data.attributes.".concat(w))(),C.setExternalBuffer(A[w])||C.setBinaryValue(typeof I=="string"?A[I]:void 0,e.startIndices)||typeof I=="string"&&!A[I]&&C.setConstantValue(s[I])||C.needsUpdate()&&(g=!0,this._updateAttribute({attribute:C,numInstances:n,data:e,props:s,context:o})),this.needsRedraw=this.needsRedraw||C.needsRedraw()}g&&oo(zee,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const A=n[s];A.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=A)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new tS(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(A=>{const o=r[A];o&&o.setNeedsUpdate(o.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(oo(Oee,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&oo(Fee,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,oo(Nee,n,r))}}class Vee extends cm{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,A=s(e/i);this._value=ul(n,r,A)}}const rI=1e-5;function iI(t,e,n,r,i){const s=e-t,o=(n-e)*i,g=-s*r;return o+g+s+e}function Gee(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let A=0;A<n.length;A++)s[A]=iI(t[A],e[A],n[A],r,i);return s}return iI(t,e,n,r,i)}function sI(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class $ee extends cm{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:A=e}=this;let o=Gee(s,A,n,r,i);const g=sI(o,n),w=sI(o,A);g<rI&&w<rI&&(o=n,this.end()),this._prevValue=A,this._currValue=o}}const jee={interpolation:Vee,spring:$ee};class Hee{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const g=s.get(e),{value:w=g.settings.fromValue}=g;n=w,this.remove(e)}if(i=$B(i),!i)return;const A=jee[i.type];if(!A){rr.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new A(this.timeline);o.start({...i,fromValue:n,toValue:r}),s.set(e,o)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Wee(t){const e=t[rh];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function Qee(t,e){const n=qB({newProps:t,oldProps:e,propTypes:t[rh],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=Zee(t,e);let i=!1;return r||(i=Yee(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Xee(t,e),transitionsChanged:qee(t,e)}}function qee(t,e){if(!t.transitions)return!1;const n={},r=t[rh];let i=!1;for(const s in t.transitions){const A=r[s],o=A&&A.type;(o==="number"||o==="color"||o==="array")&&T3(t[s],e[s],A)&&(n[s]=!0,i=!0)}return i?n:!1}function qB({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const A=T3(t[s],e[s],r[s]);if(A)return"".concat(i,".").concat(s," ").concat(A)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const A=T3(t[s],e[s],r[s]);if(A)return"".concat(i,".").concat(s," ").concat(A)}}return!1}function T3(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function Zee(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function Yee(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&oI(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&oI(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function Xee(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function oI(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},qB({oldProps:i,newProps:r,triggerName:n})}const Kee="count(): argument not an object",Jee="count(): argument not a container";function ete(t){if(!nte(t))throw new Error(Kee);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(tte(t))return Object.keys(t).length;throw new Error(Jee)}function tte(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function nte(t){return t!==null&&typeof t=="object"}function S3(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const rte={10241:9987,10240:9729,10242:33071,10243:33071},M3={};function ite(t,e,n,r){if(n instanceof oa)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new oa(e,{...n,parameters:{...rte,...i,...r}});return M3[s.id]=t,s}function ste(t,e){!e||!(e instanceof oa)||M3[e.id]===t&&(e.delete(),delete M3[e.id])}const ote={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||C3(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Ql(t,e,1)}},accessor:{validate(t,e){const n=T_(t);return n==="function"||n===T_(e.value)},equal(t,e,n){return typeof e=="function"?!0:Ql(t,e,1)}},array:{validate(t,e){return e.optional&&!t||C3(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Ql(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Ql(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:ite(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{ste(n.id,t)}}};function ate(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const A=s?.deprecatedFor;if(A)r[i]=Array.isArray(A)?A:[A];else{const o=lte(i,s);e[i]=o,n[i]=o.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function lte(t,e){switch(T_(e)){case"object":return hp(t,e);case"array":return hp(t,{type:"array",value:e,compare:!1});case"boolean":return hp(t,{type:"boolean",value:e});case"number":return hp(t,{type:"number",value:e});case"function":return hp(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function hp(t,e){return"type"in e?{name:t,...ote[e.type],...e}:"value"in e?{name:t,type:T_(e.value),...e}:{name:t,type:"object",value:e}}function C3(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function T_(t){return C3(t)?"array":t===null?"null":typeof t}function Ate(t,e){let n;for(let s=e.length-1;s>=0;s--){const A=e[s];"extensions"in A&&(n=A.extensions)}const r=P3(t.constructor,n),i=Object.create(r);i[b_]=t,i[sf]={},i[jc]={};for(let s=0;s<e.length;++s){const A=e[s];for(const o in A)i[o]=A[o]}return Object.freeze(i),i}const ute="_mergedDefaultProps";function P3(t,e){let n=ute;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=ZB(t,n);return r||(t[n]=cte(t,e||[]))}function cte(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=P3(r),s=ZB(t,"defaultProps")||{},A=ate(s),o=Object.assign(Object.create(null),i,A.defaultProps),g=Object.assign(Object.create(null),i?.[rh],A.propTypes),w=Object.assign(Object.create(null),i?.[uw],A.deprecatedProps);for(const C of e){const I=P3(C.constructor);I&&(Object.assign(o,I),Object.assign(g,I[rh]),Object.assign(w,I[uw]))}return hte(o,t),dte(o,g),fte(o,w),o[rh]=g,o[uw]=w,e.length===0&&!nS(t,"_propTypes")&&(t._propTypes=g),o}function hte(t,e){const n=gte(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function fte(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])nS(this,s)||(this[s]=r);rr.deprecated(i,e[n].join("/"))()}})}function dte(t,e){const n={},r={};for(const i in e){const s=e[i],{name:A,value:o}=s;s.async&&(n[A]=o,r[A]=pte(A))}t[N0]=n,t[sf]={},Object.defineProperties(t,r)}function pte(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||VB(e)?this[sf][t]=e:this[jc][t]=e},get(){if(this[jc]){if(t in this[jc])return this[jc][t]||this[N0][t];if(t in this[sf]){const e=this[b_]&&this[b_].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[N0][t]}}return this[N0][t]}}}function nS(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ZB(t,e){return nS(t,e)&&t[e]}function gte(t){const e=t.componentName;return e||rr.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let mte=0;class rS{constructor(...e){oe(this,"id",void 0),oe(this,"props",void 0),oe(this,"count",void 0),this.props=Ate(this,e),this.id=this.props.id,this.count=mte++}clone(e){const{props:n}=this,r={};for(const i in n[N0])i in n[jc]?r[i]=n[jc][i]:i in n[sf]&&(r[i]=n[sf][i]);return new this.constructor({...n,...r,...e})}}oe(rS,"componentName","Component");oe(rS,"defaultProps",{});const yte=Object.freeze({});class _te{constructor(e){oe(this,"component",void 0),oe(this,"onAsyncPropUpdated",void 0),oe(this,"asyncProps",void 0),oe(this,"oldProps",void 0),oe(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||yte}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[b_]||this.component;const n=e[jc]||{},r=e[sf]||e,i=e[N0]||{};for(const s in n){const A=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,A),n[s]=this.getAsyncProp(s)}for(const s in r){const A=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,A)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(VB(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],A=0;for await(const o of n){if(!this.component)return;const{dataTransform:g}=this.component.props;g?s=g(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:A,endRow:s.length}]}),A=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[rh];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class vte extends _te{constructor({attributeManager:e,layer:n}){super(n),oe(this,"attributeManager",void 0),oe(this,"needsRedraw",void 0),oe(this,"needsUpdate",void 0),oe(this,"subLayers",void 0),oe(this,"usesPickingColorCache",void 0),oe(this,"hasPickingBuffer",void 0),oe(this,"changeFlags",void 0),oe(this,"viewport",void 0),oe(this,"uniformTransitions",void 0),oe(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r?.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const xte="layer.changeFlag",wte="layer.initialize",bte="layer.update",Ete="layer.finalize",Tte="layer.matched",aI=2**24-1,Ste=Object.freeze([]),Mte=um(({oldViewport:t,viewport:e})=>t.equals(e));let EA=new Uint8ClampedArray(0);const Cte={data:{type:"data",value:Ste,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:A}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var o;i={...i,fetch:{...(o=i)===null||o===void 0?void 0:o.fetch,signal:s}}}let g=A.contains(t);return!g&&!i&&(A.add({resourceId:t,data:c_(t,r),persistent:!1}),g=!0),g?A.subscribe({resourceId:t,onChange:w=>{var C;return(C=n.internalState)===null||C===void 0?void 0:C.reloadAsyncProp(e,w)},consumerId:n.id,requestId:e}):c_(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:ar.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class iA extends rS{constructor(...e){super(...e),oe(this,"internalState",null),oe(this,"lifecycle",r0.NO_STATE),oe(this,"context",void 0),oe(this,"state",void 0),oe(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Bi(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=CB(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,A]=EB(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,A]}unproject(e){return Bi(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Bi(this.internalState);const r=this.internalState.viewport||this.context.viewport;return kK(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===ar.DEFAULT||e===ar.LNGLAT||e===ar.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Bi(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:ete(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=S3(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,A=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==A){this.internalState.hasPickingBuffer=A;const{pickingColors:o,instancePickingColors:g}=n.attributes,w=o||g;w&&(A&&w.constant&&(w.constant=!1,n.invalidate(w.id)),!w.value&&!A&&(w.constant=!0,w.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,A;(s=this.context)===null||s===void 0||(A=s.onError)===null||A===void 0||A.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!Mte({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(EA.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>aI&&rr.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),EA=od.allocate(EA,n,{size:3,copy:!0,maxCount:Math.max(n,aI)});const i=Math.floor(EA.length/3),s=[];for(let A=r;A<i;A++)this.encodePickingColor(A,s),EA[A*3+0]=s[0],EA[A*3+1]=s[1],EA[A*3+2]=s[2]}e.value=EA.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,A=s&&n.attributes&&n.attributes[s.id];if(A&&A.value){const o=A.value,g=this.encodePickingColor(e);for(let w=0;w<n.length;w++){const C=s.getVertexOffset(w);o[C]===g[0]&&o[C+1]===g[1]&&o[C+2]===g[2]&&this._disablePickingIndex(w)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),A=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(A-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==EA.buffer&&(r.value=EA.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Bi(!this.internalState),Bi(Number.isFinite(this.props.coordinateSystem)),oo(wte,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new vte({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(rr.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Hee(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){oo(Tte,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(oo(bte,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,A=this._updateUniformTransition();i.propsInTransition=A,r.viewport=i.viewport||s,this.props=A;try{const o=this._getUpdateParams(),g=this.getModels();if(r.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const C of this.props.extensions)C.updateState.call(this,o,C);const w=this.getModels()[0]!==g[0];this._postUpdate(o,w)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){oo(Ete,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const A=this.props.opacity;n.opacity=Math.pow(A,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:o}=this.props,g=o&&o(n)||[0,0];Zu(s.gl,{polygonOffset:g}),Jl(s.gl,r,()=>{const w={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const C of this.props.extensions)C.draw.call(this,w,C);this.draw(w)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const A=e[i],o=n[i];A&&Array.isArray(o)&&(n.dataChanged=Array.isArray(A)?o.concat(A):A,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&oo(xte,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=Qee(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){Wee(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Uee(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s?.setInstanceCount(this.getNumInstances());const{autoHighlight:A,highlightedObjectIndex:o,highlightColor:g}=r;if(n||i.autoHighlight!==A||i.highlightedObjectIndex!==o||i.highlightColor!==g){const w={};A||(w.pickingSelectedColor=null),Array.isArray(g)&&(w.pickingHighlightColor=g),(n||o!==i.highlightedObjectIndex)&&(w.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(w)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}oe(iA,"defaultProps",Cte);oe(iA,"layerName","Layer");const Pte="compositeLayer.renderLayers";class Ar extends iA{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:A,getPolygonOffset:o,highlightedObjectIndex:g,autoHighlight:w,highlightColor:C,coordinateSystem:I,coordinateOrigin:k,wrapLongitude:U,positionFormat:H,modelMatrix:q,extensions:se,fetch:X,operation:te,_subLayerProps:ie}=this.props,fe={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:A,getPolygonOffset:o,highlightedObjectIndex:g,autoHighlight:w,highlightColor:C,coordinateSystem:I,coordinateOrigin:k,wrapLongitude:U,positionFormat:H,modelMatrix:q,extensions:se,fetch:X,operation:te},me=ie&&e.id&&ie[e.id],Se=me&&me.updateTriggers,He=e.id||"sublayer";if(me){const Qe=this.props[rh],Ke=e.type?e.type._propTypes:{};for(const nt in me){const Ne=Ke[nt]||Qe[nt];Ne&&Ne.type==="accessor"&&(me[nt]=this.getSubLayerAccessor(me[nt]))}}Object.assign(fe,e,me),fe.id="".concat(this.props.id,"-").concat(He),fe.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...Se};for(const Qe of se){const Ke=Qe.getSubLayerProps.call(this,Qe);Ke&&Object.assign(fe,Ke,{updateTriggers:Object.assign(fe.updateTriggers,Ke.updateTriggers)})}return fe}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=of(s,Boolean),this.internalState.subLayers=r}oo(Pte,this,i,r);for(const s of r)s.parent=this}}oe(Ar,"layerName","CompositeLayer");const S1=Math.PI/180,lI=180/Math.PI,vy=6370972,y0=256;function Ite(){const t=y0/vy,e=Math.PI/180*y0;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class kte extends Ef{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,nearZMultiplier:s=.1,farZMultiplier:A=2,resolution:o=10}=e;let{height:g,altitude:w=1.5}=e;g=g||1,w=Math.max(.75,w);const C=new ia().lookAt({eye:[0,-w,0],up:[0,0,1]}),I=Math.pow(2,i);C.rotateX(n*S1),C.rotateZ(-r*S1),C.scale(I/g);const k=Math.atan(.5/w),U=y0*2*I/g;super({...e,height:g,viewMatrix:C,longitude:r,latitude:n,zoom:i,distanceScales:Ite(),fovyRadians:k*2,focalDistance:w,near:s,far:Math.min(2,1/U+1)*w*A}),oe(this,"longitude",void 0),oe(this,"latitude",void 0),oe(this,"resolution",void 0),this.latitude=n,this.longitude=r,this.resolution=o}get projectionMode(){return Hl.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),A=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],s[0],i[0],A[0]),Math.min(r[1],s[1],i[1],A[1]),Math.max(r[0],s[0],i[0],A[0]),Math.max(r[1],s[1],i[1],A[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,A]=e,o=n?s:this.height-s,{pixelUnprojectionMatrix:g}=this;let w;if(Number.isFinite(A))w=dw(g,[i,o,A,1]);else{const U=dw(g,[i,o,-1,1]),H=dw(g,[i,o,1,1]),q=((r||0)/vy+1)*y0,se=nw(eB([],U,H)),X=nw(U),te=nw(H),fe=4*((4*X*te-(se-X-te)**2)/16)/se,me=Math.sqrt(X-fe),Se=Math.sqrt(Math.max(0,q*q-fe)),He=(me-Se)/Math.sqrt(se);w=zZ([],U,H,He)}const[C,I,k]=this.unprojectPosition(w);return Number.isFinite(A)?[C,I,k]:Number.isFinite(r)?[C,I,r]:[C,I]}projectPosition(e){const[n,r,i=0]=e,s=n*S1,A=r*S1,o=Math.cos(A),g=(i/vy+1)*y0;return[Math.sin(s)*o*g,-Math.cos(s)*o*g,Math.sin(A)*g]}unprojectPosition(e){const[n,r,i]=e,s=tB(e),A=Math.asin(i/s),g=Math.atan2(n,-r)*lI,w=A*lI,C=(s/y0-1)*vy;return[g,w,C]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const r=this.unproject(n);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function dw(t,e){const n=Ed([],e,t);return WT(n,n,1/n[3]),n}class iS{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){oe(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&Ql(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],A=this.props[i];r[i]=A,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof A=="function"&&(r[i]=this.getSubLayerAccessor(A)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}oe(iS,"defaultProps",{});oe(iS,"extensionName","LayerExtension");const pw={bearing:0,pitch:0,position:[0,0,0]},Lte={speed:1.2,curve:1.414};class Sd extends LB{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),oe(this,"opts",void 0),this.opts={...Lte,...e}}interpolateProps(e,n,r){const i=aK(e,n,r,this.opts);for(const s in pw)i[s]=ul(e[s]||pw[s],n[s]||pw[s],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=lK(e,n,this.opts)),r}}class YB{constructor(e){oe(this,"opts",void 0),oe(this,"typedArrayManager",void 0),oe(this,"indexStarts",[0]),oe(this,"vertexStarts",[0]),oe(this,"vertexCount",0),oe(this,"instanceCount",0),oe(this,"attributes",void 0),oe(this,"_attributeDefs",void 0),oe(this,"data",void 0),oe(this,"getGeometry",void 0),oe(this,"geometryBuffer",void 0),oe(this,"buffers",void 0),oe(this,"positionSize",void 0),oe(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=od,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:A,dataChanged:o,normalize:g=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(A==="XY"?2:3),this.buffers=r,this.normalize=g,s&&(Bi(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),g||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(o))for(const w of o)this._rebuildGeometry(w);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?GB(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:A}=this;for(const o in s)if(o in i)A.release(r[o]),r[o]=null;else{const g=s[o];g.copy=n,r[o]=A.allocate(r[o],e,g)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:A,objectInfo:o}=Td(i,n,r);for(const g of A){o.index++;const w=s?s(g,o):null;e(w,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:A}=this,{startRow:o=0,endRow:g=1/0}=e||{},w={};if(e||(n=[0],r=[0]),this.normalize||!A)this._forEachGeometry((I,k)=>{const U=I&&this.normalizeGeometry(I);w[k]=U,r[k+1]=r[k]+(U?this.getGeometrySize(U):0)},o,g),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(A))i=i||A.length/this.positionSize;else if(A instanceof Or){const I=A.accessor.stride||this.positionSize*4;i=i||A.byteLength/I}else if(A.buffer){const I=A.stride||this.positionSize*4;i=i||A.buffer.byteLength/I}else if(A.value){const I=A.value,k=A.stride/I.BYTES_PER_ELEMENT||this.positionSize;i=i||I.length/k}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const C={};this._forEachGeometry((I,k)=>{const U=w[k]||I;C.vertexStart=r[k],C.indexStart=n[k];const H=k<r.length-1?r[k+1]:i;C.geometrySize=H-r[k],C.geometryIndex=k,this.updateGeometryAttributes(U,C)},o,g),this.vertexCount=n[n.length-1]}}const Dte=typeof window<"u"?je.useLayoutEffect:je.useEffect,Rte=Dte;function S_(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const Bte={position:"absolute",zIndex:-1};function XB(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>XB(n,e));if(Q2(t)){if(zte(t))return e.style=Bte,je.cloneElement(t,e);if(Ote(t))return je.cloneElement(t,e)}return t}function Q2(t){return t&&typeof t=="object"&&"type"in t||!1}function zte(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function Ote(t){const e=t.type;return e&&e.deckGLViewProps}function I3(t){if(typeof t=="function")return je.createElement(hl,{},t);if(Array.isArray(t))return t.map(I3);if(Q2(t)){if(t.type===je.Fragment)return I3(t.props.children);if(S_(t.type,hl))return t}return t}function Fte({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return je.Children.forEach(I3(t),A=>{if(Q2(A)){const o=A.type;if(S_(o,iA)){const g=Nte(o,A.props);i.push(g)}else r.push(A);if(S_(o,hl)&&o!==hl&&A.props.id){const g=new o(A.props);s[g.id]=g}}else A&&r.push(A)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(A=>{s[A.id]=A}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function Nte(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function Ute({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const A of t){let o=s,g=A;Q2(A)&&S_(A.type,hl)&&(o=A.props.id||s,g=A.props.children);const w=r.getViewport(o),C=r.getViewState(o);if(w){C.padding=w.padding;const{x:I,y:k,width:U,height:H}=w;g=XB(g,{x:I,y:k,width:U,height:H,viewport:w,viewState:C}),i[o]||(i[o]={viewport:w,children:[]}),i[o].children.push(g)}}return Object.keys(i).map(A=>{const{viewport:o,children:g}=i[A],{x:w,y:C,width:I,height:k}=o,U={position:"absolute",left:w,top:C,width:I,height:k},H="view-".concat(A),q=je.createElement("div",{key:H,id:H,style:U},...g);if(n){const se={viewport:o,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:X=>{X.viewId=A,e._onViewStateChange(X)}};return je.createElement(n,{key:H,value:se},q)}return q})}const Vte={mixBlendMode:null};function Gte({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in Vte?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function $te(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function KB(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function jte(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():KB(t)}});return r}const JB=je.forwardRef((t,e)=>{const[n,r]=je.useState(0),s=je.useRef({control:null,version:n,forceUpdate:()=>r(me=>me+1)}).current,A=je.useRef(null),o=je.useRef(null),g=je.useMemo(()=>Fte(t),[t.layers,t.views,t.children]);let w=!0;const C=me=>{var Se;return w&&t.viewState?(s.viewStateUpdateRequested=me,null):(s.viewStateUpdateRequested=null,(Se=t.onViewStateChange)===null||Se===void 0?void 0:Se.call(t,me))},I=me=>{if(w)s.interactionStateUpdateRequested=me;else{var Se;s.interactionStateUpdateRequested=null,(Se=t.onInteractionStateChange)===null||Se===void 0||Se.call(t,me)}},k=je.useMemo(()=>{const me={...t,style:null,width:"100%",height:"100%",parent:A.current,canvas:o.current,layers:g.layers,views:g.views,onViewStateChange:C,onInteractionStateChange:I};return delete me._customRender,s.deck&&s.deck.setProps(me),me},[t]);je.useEffect(()=>{const me=t.Deck||af;return s.deck=jte(s,me,{...k,parent:A.current,canvas:o.current}),()=>{var Se;return(Se=s.deck)===null||Se===void 0?void 0:Se.finalize()}},[]),Rte(()=>{KB(s);const{viewStateUpdateRequested:me,interactionStateUpdateRequested:Se}=s;me&&C(me),Se&&I(Se)}),je.useImperativeHandle(e,()=>$te(s),[]);const U=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:H,width:q,height:se,id:X,style:te}=t,{containerStyle:ie,canvasStyle:fe}=je.useMemo(()=>Gte({width:q,height:se,style:te}),[q,se,te]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===U||s.version!==n){s.lastRenderedViewports=U,s.version=n;const me=Ute({children:g.children,deck:s.deck,ContextProvider:H}),Se=je.createElement("canvas",{key:"canvas",id:X||"deckgl-overlay",ref:o,style:fe});s.control=je.createElement("div",{id:"".concat(X||"deckgl","-wrapper"),ref:A,style:ie},[Se,me])}return w=!1,s.control});JB.defaultProps=af.defaultProps;const Md=JB;var ez={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(l9,function(){var n,r,i;function s(o,g){if(!n)n=g;else if(!r)r=g;else{var w="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",C={};n(C),i=g(C),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([w],{type:"text/javascript"})))}}s(["exports"],function(o){var g=w;function w(f,u,p,T){this.cx=3*f,this.bx=3*(p-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(T-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=u,this.p2x=p,this.p2y=T}function C(f,u,p,T){const D=new g(f,u,p,T);return function(z){return D.solve(z)}}w.prototype={sampleCurveX:function(f){return((this.ax*f+this.bx)*f+this.cx)*f},sampleCurveY:function(f){return((this.ay*f+this.by)*f+this.cy)*f},sampleCurveDerivativeX:function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},solveCurveX:function(f,u){if(u===void 0&&(u=1e-6),f<0)return 0;if(f>1)return 1;for(var p=f,T=0;T<8;T++){var D=this.sampleCurveX(p)-f;if(Math.abs(D)<u)return p;var z=this.sampleCurveDerivativeX(p);if(Math.abs(z)<1e-6)break;p-=D/z}var F=0,$=1;for(p=f,T=0;T<20&&(D=this.sampleCurveX(p),!(Math.abs(D-f)<u));T++)f>D?F=p:$=p,p=.5*($-F)+F;return p},solve:function(f,u){return this.sampleCurveY(this.solveCurveX(f,u))}};const I=C(.25,.1,.25,1);function k(f,u,p){return Math.min(p,Math.max(u,f))}function U(f,u,p){const T=p-u,D=((f-u)%T+T)%T+u;return D===u?p:D}function H(f,...u){for(const p of u)for(const T in p)f[T]=p[T];return f}let q=1;function se(f,u){f.forEach(p=>{u[p]&&(u[p]=u[p].bind(u))})}function X(f,u,p){const T={};for(const D in f)T[D]=u.call(p||this,f[D],D,f);return T}function te(f,u,p){const T={};for(const D in f)u.call(p||this,f[D],D,f)&&(T[D]=f[D]);return T}function ie(f){return Array.isArray(f)?f.map(ie):typeof f=="object"&&f?X(f,ie):f}const fe={};function me(f){fe[f]||(typeof console<"u"&&console.warn(f),fe[f]=!0)}function Se(f,u,p){return(p.y-f.y)*(u.x-f.x)>(u.y-f.y)*(p.x-f.x)}function He(f){let u=0;for(let p,T,D=0,z=f.length,F=z-1;D<z;F=D++)p=f[D],T=f[F],u+=(T.x-p.x)*(p.y+T.y);return u}function Qe(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ke(f){const u={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(p,T,D,z)=>{const F=D||z;return u[T]=!F||F.toLowerCase(),""}),u["max-age"]){const p=parseInt(u["max-age"],10);isNaN(p)?delete u["max-age"]:u["max-age"]=p}return u}let nt,Ne,rt=null;function Ze(f){if(rt==null){const u=f.navigator?f.navigator.userAgent:null;rt=!!f.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return rt}function mt(f){return typeof ImageBitmap<"u"&&f instanceof ImageBitmap}const Kt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f){const u=requestAnimationFrame(f);return{cancel:()=>cancelAnimationFrame(u)}},getImageData(f,u=0){const p=window.document.createElement("canvas"),T=p.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return p.width=f.width,p.height=f.height,T.drawImage(f,0,0,f.width,f.height),T.getImageData(-u,-u,f.width+2*u,f.height+2*u)},resolveURL:f=>(nt||(nt=document.createElement("a")),nt.href=f,nt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ne==null&&(Ne=matchMedia("(prefers-reduced-motion: reduce)")),Ne.matches)}};var Tt=dn;function dn(f,u){this.x=f,this.y=u}dn.prototype={clone:function(){return new dn(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,u){return this.clone()._rotateAround(f,u)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var u=f.x-this.x,p=f.y-this.y;return u*u+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,u){return Math.atan2(this.x*u-this.y*f,this.x*f+this.y*u)},_matMult:function(f){var u=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=u,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var u=Math.cos(f),p=Math.sin(f),T=p*this.x+u*this.y;return this.x=u*this.x-p*this.y,this.y=T,this},_rotateAround:function(f,u){var p=Math.cos(f),T=Math.sin(f),D=u.y+T*(this.x-u.x)+p*(this.y-u.y);return this.x=u.x+p*(this.x-u.x)-T*(this.y-u.y),this.y=D,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},dn.convert=function(f){return f instanceof dn?f:Array.isArray(f)?new dn(f[0],f[1]):f};const _t={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Et="mapbox-tiles";let Jt,kn,Tn=500,Tr=50;function Jn(){typeof caches>"u"||Jt||(Jt=caches.open(Et))}let ir=1/0;const ur={supported:!1,testSupport:function(f){!wt&&wr&&(rn?Cn(f):Un=f)}};let Un,wr,wt=!1,rn=!1;function Cn(f){const u=f.createTexture();f.bindTexture(f.TEXTURE_2D,u);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,wr),f.isContextLost())return;ur.supported=!0}catch{}f.deleteTexture(u),wt=!0}typeof document<"u"&&(wr=document.createElement("img"),wr.onload=function(){Un&&Cn(Un),Un=null,rn=!0},wr.onerror=function(){wt=!0,Un=null},wr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const xt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(xt);class er extends Error{constructor(u,p,T,D){super(`AJAXError: ${p} (${u}): ${T}`),this.status=u,this.statusText=p,this.url=T,this.body=D}}const Hn=Qe()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function mr(f,u){const p=new AbortController,T=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Hn(),signal:p.signal});let D=!1,z=!1;return f.type==="json"&&T.headers.set("Accept","application/json"),((F,$,Z)=>{if(z)return;const re=Date.now();fetch(T).then(Ae=>Ae.ok?((ce,pe,ye)=>{(f.type==="arrayBuffer"?ce.arrayBuffer():f.type==="json"?ce.json():ce.text()).then(_e=>{z||(pe&&ye&&function(Ue,ze,tt){if(Jn(),!Jt)return;const At={status:ze.status,statusText:ze.statusText,headers:new Headers};ze.headers.forEach((ot,gt)=>At.headers.set(gt,ot));const et=Ke(ze.headers.get("Cache-Control")||"");et["no-store"]||(et["max-age"]&&At.headers.set("Expires",new Date(tt+1e3*et["max-age"]).toUTCString()),new Date(At.headers.get("Expires")).getTime()-tt<42e4||function(ot,gt){if(kn===void 0)try{new Response(new ReadableStream),kn=!0}catch{kn=!1}kn?gt(ot.body):ot.blob().then(gt)}(ze,ot=>{const gt=new Response(ot,At);Jn(),Jt&&Jt.then(pt=>pt.put(function(Zt){const tn=Zt.indexOf("?");return tn<0?Zt:Zt.slice(0,tn)}(Ue.url),gt)).catch(pt=>me(pt.message))}))}(T,pe,ye),D=!0,u(null,_e,ce.headers.get("Cache-Control"),ce.headers.get("Expires")))}).catch(_e=>{z||u(new Error(_e.message))})})(Ae,null,re):Ae.blob().then(ce=>u(new er(Ae.status,Ae.statusText,f.url,ce)))).catch(Ae=>{Ae.code!==20&&u(new Error(Ae.message))})})(),{cancel:()=>{z=!0,D||p.abort()}}}const or=function(f,u){if(/:\/\//.test(f.url)&&!/^https?:|^file:/.test(f.url)){if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u);if(!Qe()){const T=f.url.substring(0,f.url.indexOf("://"));return(_t.REGISTERED_PROTOCOLS[T]||mr)(f,u)}}if(!(/^file:/.test(p=f.url)||/^file:/.test(Hn())&&!/^\w+:/.test(p))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return mr(f,u);if(Qe()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,u,void 0,!0)}var p;return function(T,D){const z=new XMLHttpRequest;z.open(T.method||"GET",T.url,!0),T.type==="arrayBuffer"&&(z.responseType="arraybuffer");for(const F in T.headers)z.setRequestHeader(F,T.headers[F]);return T.type==="json"&&(z.responseType="text",z.setRequestHeader("Accept","application/json")),z.withCredentials=T.credentials==="include",z.onerror=()=>{D(new Error(z.statusText))},z.onload=()=>{if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let F=z.response;if(T.type==="json")try{F=JSON.parse(z.response)}catch($){return D($)}D(null,F,z.getResponseHeader("Cache-Control"),z.getResponseHeader("Expires"))}else{const F=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});D(new er(z.status,z.statusText,T.url,F))}},z.send(T.body),{cancel:()=>z.abort()}}(f,u)},tr=function(f,u){return or(H(f,{type:"arrayBuffer"}),u)};function Kr(f){const u=window.document.createElement("a");return u.href=f,u.protocol===window.document.location.protocol&&u.host===window.document.location.host}const Vn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Si,Wn;Si=[],Wn=0;const Fi=function(f,u){if(ur.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),Wn>=_t.MAX_PARALLEL_IMAGE_REQUESTS){const z={requestParameters:f,callback:u,cancelled:!1,cancel(){this.cancelled=!0}};return Si.push(z),z}Wn++;let p=!1;const T=()=>{if(!p)for(p=!0,Wn--;Si.length&&Wn<_t.MAX_PARALLEL_IMAGE_REQUESTS;){const z=Si.shift(),{requestParameters:F,callback:$,cancelled:Z}=z;Z||(z.cancel=Fi(F,$).cancel)}},D=tr(f,(z,F,$,Z)=>{T(),z?u(z):F&&function(re,Ae){typeof createImageBitmap=="function"?function(ce,pe){const ye=new Blob([new Uint8Array(ce)],{type:"image/png"});createImageBitmap(ye).then(_e=>{pe(null,_e)}).catch(_e=>{pe(new Error(`Could not load image because of ${_e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(re,Ae):function(ce,pe){const ye=new Image;ye.onload=()=>{pe(null,ye),URL.revokeObjectURL(ye.src),ye.onload=null,window.requestAnimationFrame(()=>{ye.src=Vn})},ye.onerror=()=>pe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _e=new Blob([new Uint8Array(ce)],{type:"image/png"});ye.src=ce.byteLength?URL.createObjectURL(_e):Vn}(re,Ae)}(F,(re,Ae)=>{re!=null?u(re):Ae!=null&&u(null,Ae,{cacheControl:$,expires:Z})})});return{cancel:()=>{D.cancel(),T()}}};function fo(f,u,p){p[f]&&p[f].indexOf(u)!==-1||(p[f]=p[f]||[],p[f].push(u))}function Fr(f,u,p){if(p&&p[f]){const T=p[f].indexOf(u);T!==-1&&p[f].splice(T,1)}}class Mi{constructor(u,p={}){H(this,p),this.type=u}}class Oo extends Mi{constructor(u,p={}){super("error",H({error:u},p))}}class is{on(u,p){return this._listeners=this._listeners||{},fo(u,p,this._listeners),this}off(u,p){return Fr(u,p,this._listeners),Fr(u,p,this._oneTimeListeners),this}once(u,p){return this._oneTimeListeners=this._oneTimeListeners||{},fo(u,p,this._oneTimeListeners),this}fire(u,p){typeof u=="string"&&(u=new Mi(u,p||{}));const T=u.type;if(this.listens(T)){u.target=this;const D=this._listeners&&this._listeners[T]?this._listeners[T].slice():[];for(const $ of D)$.call(this,u);const z=this._oneTimeListeners&&this._oneTimeListeners[T]?this._oneTimeListeners[T].slice():[];for(const $ of z)Fr(T,$,this._oneTimeListeners),$.call(this,u);const F=this._eventedParent;F&&(H(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),F.fire(u))}else u instanceof Oo&&console.error(u.error);return this}listens(u){return this._listeners&&this._listeners[u]&&this._listeners[u].length>0||this._oneTimeListeners&&this._oneTimeListeners[u]&&this._oneTimeListeners[u].length>0||this._eventedParent&&this._eventedParent.listens(u)}setEventedParent(u,p){return this._eventedParent=u,this._eventedParentData=p,this}}var ct={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class kt{constructor(u,p,T,D){this.message=(u?`${u}: `:"")+T,D&&(this.identifier=D),p!=null&&p.__line__&&(this.line=p.__line__)}}function Bs(f){const u=f.value;return u?[new kt(f.key,u,"constants have been deprecated as of v8")]:[]}function yi(f,...u){for(const p of u)for(const T in p)f[T]=p[T];return f}function Bn(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function Ni(f){if(Array.isArray(f))return f.map(Ni);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){const u={};for(const p in f)u[p]=Ni(f[p]);return u}return Bn(f)}class Ci extends Error{constructor(u,p){super(p),this.message=p,this.key=u}}class Pi{constructor(u,p=[]){this.parent=u,this.bindings={};for(const[T,D]of p)this.bindings[T]=D}concat(u){return new Pi(this,u)}get(u){if(this.bindings[u])return this.bindings[u];if(this.parent)return this.parent.get(u);throw new Error(`${u} not found in scope.`)}has(u){return!!this.bindings[u]||!!this.parent&&this.parent.has(u)}}const ss={kind:"null"},Lt={kind:"number"},Sn={kind:"string"},bn={kind:"boolean"},Cr={kind:"color"},xs={kind:"object"},yn={kind:"value"},Ye={kind:"collator"},jr={kind:"formatted"},zs={kind:"padding"},Dr={kind:"resolvedImage"};function oi(f,u){return{kind:"array",itemType:f,N:u}}function Zn(f){if(f.kind==="array"){const u=Zn(f.itemType);return typeof f.N=="number"?`array<${u}, ${f.N}>`:f.itemType.kind==="value"?"array":`array<${u}>`}return f.kind}const Os=[ss,Lt,Sn,bn,Cr,jr,xs,oi(yn),zs,Dr];function Ui(f,u){if(u.kind==="error")return null;if(f.kind==="array"){if(u.kind==="array"&&(u.N===0&&u.itemType.kind==="value"||!Ui(f.itemType,u.itemType))&&(typeof f.N!="number"||f.N===u.N))return null}else{if(f.kind===u.kind)return null;if(f.kind==="value"){for(const p of Os)if(!Ui(p,u))return null}}return`Expected ${Zn(f)} but found ${Zn(u)} instead.`}function Vi(f,u){return u.some(p=>p.kind===f.kind)}function Ii(f,u){return u.some(p=>p==="null"?f===null:p==="array"?Array.isArray(f):p==="object"?f&&!Array.isArray(f)&&typeof f=="object":p===typeof f)}var os,Rr={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function K(f){return(f=Math.round(f))<0?0:f>255?255:f}function W(f){return K(f[f.length-1]==="%"?parseFloat(f)/100*255:parseInt(f))}function ee(f){return(u=f[f.length-1]==="%"?parseFloat(f)/100:parseFloat(f))<0?0:u>1?1:u;var u}function he(f,u,p){return p<0?p+=1:p>1&&(p-=1),6*p<1?f+(u-f)*p*6:2*p<1?u:3*p<2?f+(u-f)*(2/3-p)*6:f}try{os={}.parseCSSColor=function(f){var u,p=f.replace(/ /g,"").toLowerCase();if(p in Rr)return Rr[p].slice();if(p[0]==="#")return p.length===4?(u=parseInt(p.substr(1),16))>=0&&u<=4095?[(3840&u)>>4|(3840&u)>>8,240&u|(240&u)>>4,15&u|(15&u)<<4,1]:null:p.length===7&&(u=parseInt(p.substr(1),16))>=0&&u<=16777215?[(16711680&u)>>16,(65280&u)>>8,255&u,1]:null;var T=p.indexOf("("),D=p.indexOf(")");if(T!==-1&&D+1===p.length){var z=p.substr(0,T),F=p.substr(T+1,D-(T+1)).split(","),$=1;switch(z){case"rgba":if(F.length!==4)return null;$=ee(F.pop());case"rgb":return F.length!==3?null:[W(F[0]),W(F[1]),W(F[2]),$];case"hsla":if(F.length!==4)return null;$=ee(F.pop());case"hsl":if(F.length!==3)return null;var Z=(parseFloat(F[0])%360+360)%360/360,re=ee(F[1]),Ae=ee(F[2]),ce=Ae<=.5?Ae*(re+1):Ae+re-Ae*re,pe=2*Ae-ce;return[K(255*he(pe,ce,Z+1/3)),K(255*he(pe,ce,Z)),K(255*he(pe,ce,Z-1/3)),$];default:return null}}return null}}catch{}class a{constructor(u,p,T,D=1){this.r=u,this.g=p,this.b=T,this.a=D}static parse(u){if(!u)return;if(u instanceof a)return u;if(typeof u!="string")return;const p=os(u);return p?new a(p[0]/255*p[3],p[1]/255*p[3],p[2]/255*p[3],p[3]):void 0}toString(){const[u,p,T,D]=this.toArray();return`rgba(${Math.round(u)},${Math.round(p)},${Math.round(T)},${D})`}toArray(){const{r:u,g:p,b:T,a:D}=this;return D===0?[0,0,0,0]:[255*u/D,255*p/D,255*T/D,D]}}a.black=new a(0,0,0,1),a.white=new a(1,1,1,1),a.transparent=new a(0,0,0,0),a.red=new a(1,0,0,1);class G{constructor(u,p,T){this.sensitivity=u?p?"variant":"case":p?"accent":"base",this.locale=T,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(u,p){return this.collator.compare(u,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Le{constructor(u,p,T,D,z){this.text=u,this.image=p,this.scale=T,this.fontStack=D,this.textColor=z}}class Ie{constructor(u){this.sections=u}static fromString(u){return new Ie([new Le(u,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(u=>u.text.length!==0||u.image&&u.image.name.length!==0)}static factory(u){return u instanceof Ie?u:Ie.fromString(u)}toString(){return this.sections.length===0?"":this.sections.map(u=>u.text).join("")}}class Pe{constructor(u){this.values=u.slice()}static parse(u){if(u instanceof Pe)return u;if(typeof u=="number")return new Pe([u,u,u,u]);if(Array.isArray(u)&&!(u.length<1||u.length>4)){for(const p of u)if(typeof p!="number")return;switch(u.length){case 1:u=[u[0],u[0],u[0],u[0]];break;case 2:u=[u[0],u[1],u[0],u[1]];break;case 3:u=[u[0],u[1],u[2],u[1]]}return new Pe(u)}}toString(){return JSON.stringify(this.values)}}class ke{constructor(u){this.name=u.name,this.available=u.available}toString(){return this.name}static fromString(u){return u?new ke({name:u,available:!1}):null}}function qe(f,u,p,T){return typeof f=="number"&&f>=0&&f<=255&&typeof u=="number"&&u>=0&&u<=255&&typeof p=="number"&&p>=0&&p<=255?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:`Invalid rgba value [${[f,u,p,T].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof T=="number"?[f,u,p,T]:[f,u,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function lt(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof a||f instanceof G||f instanceof Ie||f instanceof Pe||f instanceof ke)return!0;if(Array.isArray(f)){for(const u of f)if(!lt(u))return!1;return!0}if(typeof f=="object"){for(const u in f)if(!lt(f[u]))return!1;return!0}return!1}function We(f){if(f===null)return ss;if(typeof f=="string")return Sn;if(typeof f=="boolean")return bn;if(typeof f=="number")return Lt;if(f instanceof a)return Cr;if(f instanceof G)return Ye;if(f instanceof Ie)return jr;if(f instanceof Pe)return zs;if(f instanceof ke)return Dr;if(Array.isArray(f)){const u=f.length;let p;for(const T of f){const D=We(T);if(p){if(p===D)continue;p=yn;break}p=D}return oi(p||yn,u)}return xs}function ft(f){const u=typeof f;return f===null?"":u==="string"||u==="number"||u==="boolean"?String(f):f instanceof a||f instanceof Ie||f instanceof Pe||f instanceof ke?f.toString():JSON.stringify(f)}class Dt{constructor(u,p){this.type=u,this.value=p}static parse(u,p){if(u.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${u.length-1} instead.`);if(!lt(u[1]))return p.error("invalid value");const T=u[1];let D=We(T);const z=p.expectedType;return D.kind!=="array"||D.N!==0||!z||z.kind!=="array"||typeof z.N=="number"&&z.N!==0||(D=z),new Dt(D,T)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Rt{constructor(u){this.name="ExpressionEvaluationError",this.message=u}toJSON(){return this.message}}const sn={string:Sn,number:Lt,boolean:bn,object:xs};class jt{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");let T,D=1;const z=u[0];if(z==="array"){let $,Z;if(u.length>2){const re=u[1];if(typeof re!="string"||!(re in sn)||re==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);$=sn[re],D++}else $=yn;if(u.length>3){if(u[2]!==null&&(typeof u[2]!="number"||u[2]<0||u[2]!==Math.floor(u[2])))return p.error('The length argument to "array" must be a positive integer literal',2);Z=u[2],D++}T=oi($,Z)}else{if(!sn[z])throw new Error(`Types doesn't contain name = ${z}`);T=sn[z]}const F=[];for(;D<u.length;D++){const $=p.parse(u[D],D,yn);if(!$)return null;F.push($)}return new jt(T,F)}evaluate(u){for(let p=0;p<this.args.length;p++){const T=this.args[p].evaluate(u);if(!Ui(this.type,We(T)))return T;if(p===this.args.length-1)throw new Rt(`Expected value to be of type ${Zn(this.type)}, but found ${Zn(We(T))} instead.`)}throw new Error}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const pn={"to-boolean":bn,"to-color":Cr,"to-number":Lt,"to-string":Sn};class qt{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const T=u[0];if(!pn[T])throw new Error(`Can't parse ${T} as it is not part of the known types`);if((T==="to-boolean"||T==="to-string")&&u.length!==2)return p.error("Expected one argument.");const D=pn[T],z=[];for(let F=1;F<u.length;F++){const $=p.parse(u[F],F,yn);if(!$)return null;z.push($)}return new qt(D,z)}evaluate(u){if(this.type.kind==="boolean")return!!this.args[0].evaluate(u);if(this.type.kind==="color"){let p,T;for(const D of this.args){if(p=D.evaluate(u),T=null,p instanceof a)return p;if(typeof p=="string"){const z=u.parseColor(p);if(z)return z}else if(Array.isArray(p)&&(T=p.length<3||p.length>4?`Invalid rbga value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:qe(p[0],p[1],p[2],p[3]),!T))return new a(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Rt(T||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}if(this.type.kind==="padding"){let p;for(const T of this.args){p=T.evaluate(u);const D=Pe.parse(p);if(D)return D}throw new Rt(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}if(this.type.kind==="number"){let p=null;for(const T of this.args){if(p=T.evaluate(u),p===null)return 0;const D=Number(p);if(!isNaN(D))return D}throw new Rt(`Could not convert ${JSON.stringify(p)} to number.`)}return this.type.kind==="formatted"?Ie.fromString(ft(this.args[0].evaluate(u))):this.type.kind==="resolvedImage"?ke.fromString(ft(this.args[0].evaluate(u))):ft(this.args[0].evaluate(u))}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}const an=["Unknown","Point","LineString","Polygon"];class xn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?an[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(u){let p=this._parseColorCache[u];return p||(p=this._parseColorCache[u]=a.parse(u)),p}}class Ft{constructor(u,p,T,D){this.name=u,this.type=p,this._evaluate=T,this.args=D}evaluate(u){return this._evaluate(u,this.args)}eachChild(u){this.args.forEach(u)}outputDefined(){return!1}static parse(u,p){const T=u[0],D=Ft.definitions[T];if(!D)return p.error(`Unknown expression "${T}". If you wanted a literal array, use ["literal", [...]].`,0);const z=Array.isArray(D)?D[0]:D.type,F=Array.isArray(D)?[[D[1],D[2]]]:D.overloads,$=F.filter(([re])=>!Array.isArray(re)||re.length===u.length-1);let Z=null;for(const[re,Ae]of $){Z=new bt(p.registry,p.path,null,p.scope);const ce=[];let pe=!1;for(let ye=1;ye<u.length;ye++){const _e=u[ye],Ue=Array.isArray(re)?re[ye-1]:re.type,ze=Z.parse(_e,1+ce.length,Ue);if(!ze){pe=!0;break}ce.push(ze)}if(!pe)if(Array.isArray(re)&&re.length!==ce.length)Z.error(`Expected ${re.length} arguments, but found ${ce.length} instead.`);else{for(let ye=0;ye<ce.length;ye++){const _e=Array.isArray(re)?re[ye]:re.type,Ue=ce[ye];Z.concat(ye+1).checkSubtype(_e,Ue.type)}if(Z.errors.length===0)return new Ft(T,z,Ae,ce)}}if($.length===1)p.errors.push(...Z.errors);else{const re=($.length?$:F).map(([ce])=>{return pe=ce,Array.isArray(pe)?`(${pe.map(Zn).join(", ")})`:`(${Zn(pe.type)}...)`;var pe}).join(" | "),Ae=[];for(let ce=1;ce<u.length;ce++){const pe=p.parse(u[ce],1+Ae.length);if(!pe)return null;Ae.push(Zn(pe.type))}p.error(`Expected arguments of type ${re}, but found (${Ae.join(", ")}) instead.`)}return null}static register(u,p){Ft.definitions=p;for(const T in p)u[T]=Ft}}class Oe{constructor(u,p,T){this.type=Ye,this.locale=T,this.caseSensitive=u,this.diacriticSensitive=p}static parse(u,p){if(u.length!==2)return p.error("Expected one argument.");const T=u[1];if(typeof T!="object"||Array.isArray(T))return p.error("Collator options argument must be an object.");const D=p.parse(T["case-sensitive"]!==void 0&&T["case-sensitive"],1,bn);if(!D)return null;const z=p.parse(T["diacritic-sensitive"]!==void 0&&T["diacritic-sensitive"],1,bn);if(!z)return null;let F=null;return T.locale&&(F=p.parse(T.locale,1,Sn),!F)?null:new Oe(D,z,F)}evaluate(u){return new G(this.caseSensitive.evaluate(u),this.diacriticSensitive.evaluate(u),this.locale?this.locale.evaluate(u):null)}eachChild(u){u(this.caseSensitive),u(this.diacriticSensitive),this.locale&&u(this.locale)}outputDefined(){return!1}}const Ct=8192;function Me(f,u){f[0]=Math.min(f[0],u[0]),f[1]=Math.min(f[1],u[1]),f[2]=Math.max(f[2],u[0]),f[3]=Math.max(f[3],u[1])}function un(f,u){return!(f[0]<=u[0]||f[2]>=u[2]||f[1]<=u[1]||f[3]>=u[3])}function ai(f,u){const p=(180+f[0])/360,T=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,D=Math.pow(2,u.z);return[Math.round(p*D*Ct),Math.round(T*D*Ct)]}function nr(f,u,p){const T=f[0]-u[0],D=f[1]-u[1],z=f[0]-p[0],F=f[1]-p[1];return T*F-z*D==0&&T*z<=0&&D*F<=0}function aa(f,u){let p=!1;for(let F=0,$=u.length;F<$;F++){const Z=u[F];for(let re=0,Ae=Z.length;re<Ae-1;re++){if(nr(f,Z[re],Z[re+1]))return!1;(D=Z[re])[1]>(T=f)[1]!=(z=Z[re+1])[1]>T[1]&&T[0]<(z[0]-D[0])*(T[1]-D[1])/(z[1]-D[1])+D[0]&&(p=!p)}}var T,D,z;return p}function De(f,u){for(let p=0;p<u.length;p++)if(aa(f,u[p]))return!0;return!1}function za(f,u,p,T){const D=T[0]-p[0],z=T[1]-p[1],F=(f[0]-p[0])*z-D*(f[1]-p[1]),$=(u[0]-p[0])*z-D*(u[1]-p[1]);return F>0&&$<0||F<0&&$>0}function we(f,u,p){for(const re of p)for(let Ae=0;Ae<re.length-1;++Ae)if(($=[(F=re[Ae+1])[0]-(z=re[Ae])[0],F[1]-z[1]])[0]*(Z=[(D=u)[0]-(T=f)[0],D[1]-T[1]])[1]-$[1]*Z[0]!=0&&za(T,D,z,F)&&za(z,F,T,D))return!0;var T,D,z,F,$,Z;return!1}function Fo(f,u){for(let p=0;p<f.length;++p)if(!aa(f[p],u))return!1;for(let p=0;p<f.length-1;++p)if(we(f[p],f[p+1],u))return!1;return!0}function ws(f,u){for(let p=0;p<u.length;p++)if(Fo(f,u[p]))return!0;return!1}function Oa(f,u,p){const T=[];for(let D=0;D<f.length;D++){const z=[];for(let F=0;F<f[D].length;F++){const $=ai(f[D][F],p);Me(u,$),z.push($)}T.push(z)}return T}function Fa(f,u,p){const T=[];for(let D=0;D<f.length;D++){const z=Oa(f[D],u,p);T.push(z)}return T}function la(f,u,p,T){if(f[0]<p[0]||f[0]>p[2]){const D=.5*T;let z=f[0]-p[0]>D?-T:p[0]-f[0]>D?T:0;z===0&&(z=f[0]-p[2]>D?-T:p[2]-f[0]>D?T:0),f[0]+=z}Me(u,f)}function gl(f,u,p,T){const D=Math.pow(2,T.z)*Ct,z=[T.x*Ct,T.y*Ct],F=[];for(const $ of f)for(const Z of $){const re=[Z.x+z[0],Z.y+z[1]];la(re,u,p,D),F.push(re)}return F}function Aa(f,u,p,T){const D=Math.pow(2,T.z)*Ct,z=[T.x*Ct,T.y*Ct],F=[];for(const Z of f){const re=[];for(const Ae of Z){const ce=[Ae.x+z[0],Ae.y+z[1]];Me(u,ce),re.push(ce)}F.push(re)}if(u[2]-u[0]<=D/2){($=u)[0]=$[1]=1/0,$[2]=$[3]=-1/0;for(const Z of F)for(const re of Z)la(re,u,p,D)}var $;return F}class Jr{constructor(u,p){this.type=bn,this.geojson=u,this.geometries=p}static parse(u,p){if(u.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${u.length-1} instead.`);if(lt(u[1])){const T=u[1];if(T.type==="FeatureCollection")for(let D=0;D<T.features.length;++D){const z=T.features[D].geometry.type;if(z==="Polygon"||z==="MultiPolygon")return new Jr(T,T.features[D].geometry)}else if(T.type==="Feature"){const D=T.geometry.type;if(D==="Polygon"||D==="MultiPolygon")return new Jr(T,T.geometry)}else if(T.type==="Polygon"||T.type==="MultiPolygon")return new Jr(T,T)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(u){if(u.geometry()!=null&&u.canonicalID()!=null){if(u.geometryType()==="Point")return function(p,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],F=p.canonicalID();if(T.type==="Polygon"){const $=Oa(T.coordinates,z,F),Z=gl(p.geometry(),D,z,F);if(!un(D,z))return!1;for(const re of Z)if(!aa(re,$))return!1}if(T.type==="MultiPolygon"){const $=Fa(T.coordinates,z,F),Z=gl(p.geometry(),D,z,F);if(!un(D,z))return!1;for(const re of Z)if(!De(re,$))return!1}return!0}(u,this.geometries);if(u.geometryType()==="LineString")return function(p,T){const D=[1/0,1/0,-1/0,-1/0],z=[1/0,1/0,-1/0,-1/0],F=p.canonicalID();if(T.type==="Polygon"){const $=Oa(T.coordinates,z,F),Z=Aa(p.geometry(),D,z,F);if(!un(D,z))return!1;for(const re of Z)if(!Fo(re,$))return!1}if(T.type==="MultiPolygon"){const $=Fa(T.coordinates,z,F),Z=Aa(p.geometry(),D,z,F);if(!un(D,z))return!1;for(const re of Z)if(!ws(re,$))return!1}return!0}(u,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ge(f){if(f instanceof Ft&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof Jr)return!1;let u=!0;return f.eachChild(p=>{u&&!ge(p)&&(u=!1)}),u}function Ee(f){if(f instanceof Ft&&f.name==="feature-state")return!1;let u=!0;return f.eachChild(p=>{u&&!Ee(p)&&(u=!1)}),u}function Fe(f,u){if(f instanceof Ft&&u.indexOf(f.name)>=0)return!1;let p=!0;return f.eachChild(T=>{p&&!Fe(T,u)&&(p=!1)}),p}class at{constructor(u,p){this.type=p.type,this.name=u,this.boundExpression=p}static parse(u,p){if(u.length!==2||typeof u[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const T=u[1];return p.scope.has(T)?new at(T,p.scope.get(T)):p.error(`Unknown variable "${T}". Make sure "${T}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(u){return this.boundExpression.evaluate(u)}eachChild(){}outputDefined(){return!1}}class bt{constructor(u,p=[],T,D=new Pi,z=[]){this.registry=u,this.path=p,this.key=p.map(F=>`[${F}]`).join(""),this.scope=D,this.errors=z,this.expectedType=T}parse(u,p,T,D,z={}){return p?this.concat(p,T,D)._parse(u,z):this._parse(u,z)}_parse(u,p){function T(D,z,F){return F==="assert"?new jt(z,[D]):F==="coerce"?new qt(z,[D]):D}if(u!==null&&typeof u!="string"&&typeof u!="boolean"&&typeof u!="number"||(u=["literal",u]),Array.isArray(u)){if(u.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const D=u[0];if(typeof D!="string")return this.error(`Expression name must be a string, but found ${typeof D} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const z=this.registry[D];if(z){let F=z.parse(u,this);if(!F)return null;if(this.expectedType){const $=this.expectedType,Z=F.type;if($.kind!=="string"&&$.kind!=="number"&&$.kind!=="boolean"&&$.kind!=="object"&&$.kind!=="array"||Z.kind!=="value")if($.kind!=="color"&&$.kind!=="formatted"&&$.kind!=="resolvedImage"||Z.kind!=="value"&&Z.kind!=="string")if($.kind!=="padding"||Z.kind!=="value"&&Z.kind!=="number"&&Z.kind!=="array"){if(this.checkSubtype($,Z))return null}else F=T(F,$,p.typeAnnotation||"coerce");else F=T(F,$,p.typeAnnotation||"coerce");else F=T(F,$,p.typeAnnotation||"assert")}if(!(F instanceof Dt)&&F.type.kind!=="resolvedImage"&&Qt(F)){const $=new xn;try{F=new Dt(F.type,F.evaluate($))}catch(Z){return this.error(Z.message),null}}return F}return this.error(`Unknown expression "${D}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(u===void 0?"'undefined' value invalid. Use null instead.":typeof u=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof u} instead.`)}concat(u,p,T){const D=typeof u=="number"?this.path.concat(u):this.path,z=T?this.scope.concat(T):this.scope;return new bt(this.registry,D,p||null,z,this.errors)}error(u,...p){const T=`${this.key}${p.map(D=>`[${D}]`).join("")}`;this.errors.push(new Ci(T,u))}checkSubtype(u,p){const T=Ui(u,p);return T&&this.error(T),T}}function Qt(f){if(f instanceof at)return Qt(f.boundExpression);if(f instanceof Ft&&f.name==="error"||f instanceof Oe||f instanceof Jr)return!1;const u=f instanceof qt||f instanceof jt;let p=!0;return f.eachChild(T=>{p=u?p&&Qt(T):p&&T instanceof Dt}),!!p&&ge(f)&&Fe(f,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ln(f,u){const p=f.length-1;let T,D,z=0,F=p,$=0;for(;z<=F;)if($=Math.floor((z+F)/2),T=f[$],D=f[$+1],T<=u){if($===p||u<D)return $;z=$+1}else{if(!(T>u))throw new Rt("Input is not a number.");F=$-1}return 0}class Mr{constructor(u,p,T){this.type=u,this.input=p,this.labels=[],this.outputs=[];for(const[D,z]of T)this.labels.push(D),this.outputs.push(z)}static parse(u,p){if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");const T=p.parse(u[1],1,Lt);if(!T)return null;const D=[];let z=null;p.expectedType&&p.expectedType.kind!=="value"&&(z=p.expectedType);for(let F=1;F<u.length;F+=2){const $=F===1?-1/0:u[F],Z=u[F+1],re=F,Ae=F+1;if(typeof $!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',re);if(D.length&&D[D.length-1][0]>=$)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',re);const ce=p.parse(Z,Ae,z);if(!ce)return null;z=z||ce.type,D.push([$,ce])}return new Mr(z,T,D)}evaluate(u){const p=this.labels,T=this.outputs;if(p.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=p[0])return T[0].evaluate(u);const z=p.length;return D>=p[z-1]?T[z-1].evaluate(u):T[Ln(p,D)].evaluate(u)}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function en(f,u,p){return f*(1-p)+u*p}var Pr=Object.freeze({__proto__:null,number:en,color:function(f,u,p){return new a(en(f.r,u.r,p),en(f.g,u.g,p),en(f.b,u.b,p),en(f.a,u.a,p))},array:function(f,u,p){return f.map((T,D)=>en(T,u[D],p))},padding:function(f,u,p){const T=f.values,D=u.values;return new Pe([en(T[0],D[0],p),en(T[1],D[1],p),en(T[2],D[2],p),en(T[3],D[3],p)])}});const Gn=.95047,lA=1.08883,AA=4/29,uA=6/29,QA=3*uA*uA,qA=Math.PI/180,cA=180/Math.PI;function ml(f){return f>.008856451679035631?Math.pow(f,1/3):f/QA+AA}function yl(f){return f>uA?f*f*f:QA*(f-AA)}function hA(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function fA(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Yn(f){const u=fA(f.r),p=fA(f.g),T=fA(f.b),D=ml((.4124564*u+.3575761*p+.1804375*T)/Gn),z=ml((.2126729*u+.7151522*p+.072175*T)/1);return{l:116*z-16,a:500*(D-z),b:200*(z-ml((.0193339*u+.119192*p+.9503041*T)/lA)),alpha:f.a}}function ZA(f){let u=(f.l+16)/116,p=isNaN(f.a)?u:u+f.a/500,T=isNaN(f.b)?u:u-f.b/200;return u=1*yl(u),p=Gn*yl(p),T=lA*yl(T),new a(hA(3.2404542*p-1.5371385*u-.4985314*T),hA(-.969266*p+1.8760108*u+.041556*T),hA(.0556434*p-.2040259*u+1.0572252*T),f.alpha)}function lc(f,u,p){const T=u-f;return f+p*(T>180||T<-180?T-360*Math.round(T/360):T)}const _l={forward:Yn,reverse:ZA,interpolate:function(f,u,p){return{l:en(f.l,u.l,p),a:en(f.a,u.a,p),b:en(f.b,u.b,p),alpha:en(f.alpha,u.alpha,p)}}},Hr={forward:function(f){const{l:u,a:p,b:T}=Yn(f),D=Math.atan2(T,p)*cA;return{h:D<0?D+360:D,c:Math.sqrt(p*p+T*T),l:u,alpha:f.a}},reverse:function(f){const u=f.h*qA,p=f.c;return ZA({l:f.l,a:Math.cos(u)*p,b:Math.sin(u)*p,alpha:f.alpha})},interpolate:function(f,u,p){return{h:lc(f.h,u.h,p),c:en(f.c,u.c,p),l:en(f.l,u.l,p),alpha:en(f.alpha,u.alpha,p)}}};var No=Object.freeze({__proto__:null,lab:_l,hcl:Hr});class zn{constructor(u,p,T,D,z){this.type=u,this.operator=p,this.interpolation=T,this.input=D,this.labels=[],this.outputs=[];for(const[F,$]of z)this.labels.push(F),this.outputs.push($)}static interpolationFactor(u,p,T,D){let z=0;if(u.name==="exponential")z=bs(p,u.base,T,D);else if(u.name==="linear")z=bs(p,1,T,D);else if(u.name==="cubic-bezier"){const F=u.controlPoints;z=new g(F[0],F[1],F[2],F[3]).solve(bs(p,1,T,D))}return z}static parse(u,p){let[T,D,z,...F]=u;if(!Array.isArray(D)||D.length===0)return p.error("Expected an interpolation type expression.",1);if(D[0]==="linear")D={name:"linear"};else if(D[0]==="exponential"){const re=D[1];if(typeof re!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);D={name:"exponential",base:re}}else{if(D[0]!=="cubic-bezier")return p.error(`Unknown interpolation type ${String(D[0])}`,1,0);{const re=D.slice(1);if(re.length!==4||re.some(Ae=>typeof Ae!="number"||Ae<0||Ae>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);D={name:"cubic-bezier",controlPoints:re}}}if(u.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if((u.length-1)%2!=0)return p.error("Expected an even number of arguments.");if(z=p.parse(z,2,Lt),!z)return null;const $=[];let Z=null;T==="interpolate-hcl"||T==="interpolate-lab"?Z=Cr:p.expectedType&&p.expectedType.kind!=="value"&&(Z=p.expectedType);for(let re=0;re<F.length;re+=2){const Ae=F[re],ce=F[re+1],pe=re+3,ye=re+4;if(typeof Ae!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',pe);if($.length&&$[$.length-1][0]>=Ae)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',pe);const _e=p.parse(ce,ye,Z);if(!_e)return null;Z=Z||_e.type,$.push([Ae,_e])}return Z.kind==="number"||Z.kind==="color"||Z.kind==="padding"||Z.kind==="array"&&Z.itemType.kind==="number"&&typeof Z.N=="number"?new zn(Z,T,D,z,$):p.error(`Type ${Zn(Z)} is not interpolatable.`)}evaluate(u){const p=this.labels,T=this.outputs;if(p.length===1)return T[0].evaluate(u);const D=this.input.evaluate(u);if(D<=p[0])return T[0].evaluate(u);const z=p.length;if(D>=p[z-1])return T[z-1].evaluate(u);const F=Ln(p,D),$=zn.interpolationFactor(this.interpolation,D,p[F],p[F+1]),Z=T[F].evaluate(u),re=T[F+1].evaluate(u);return this.operator==="interpolate"?Pr[this.type.kind.toLowerCase()](Z,re,$):this.operator==="interpolate-hcl"?Hr.reverse(Hr.interpolate(Hr.forward(Z),Hr.forward(re),$)):_l.reverse(_l.interpolate(_l.forward(Z),_l.forward(re),$))}eachChild(u){u(this.input);for(const p of this.outputs)u(p)}outputDefined(){return this.outputs.every(u=>u.outputDefined())}}function bs(f,u,p,T){const D=T-p,z=f-p;return D===0?0:u===1?z/D:(Math.pow(u,z)-1)/(Math.pow(u,D)-1)}class ei{constructor(u,p){this.type=u,this.args=p}static parse(u,p){if(u.length<2)return p.error("Expectected at least one argument.");let T=null;const D=p.expectedType;D&&D.kind!=="value"&&(T=D);const z=[];for(const $ of u.slice(1)){const Z=p.parse($,1+z.length,T,void 0,{typeAnnotation:"omit"});if(!Z)return null;T=T||Z.type,z.push(Z)}if(!T)throw new Error("No output type");const F=D&&z.some($=>Ui(D,$.type));return new ei(F?yn:T,z)}evaluate(u){let p,T=null,D=0;for(const z of this.args)if(D++,T=z.evaluate(u),T&&T instanceof ke&&!T.available&&(p||(p=T.name),T=null,D===this.args.length&&(T=p)),T!==null)break;return T}eachChild(u){this.args.forEach(u)}outputDefined(){return this.args.every(u=>u.outputDefined())}}class po{constructor(u,p){this.type=p.type,this.bindings=[].concat(u),this.result=p}evaluate(u){return this.result.evaluate(u)}eachChild(u){for(const p of this.bindings)u(p[1]);u(this.result)}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found ${u.length-1} instead.`);const T=[];for(let z=1;z<u.length-1;z+=2){const F=u[z];if(typeof F!="string")return p.error(`Expected string, but found ${typeof F} instead.`,z);if(/[^a-zA-Z0-9_]/.test(F))return p.error("Variable names must contain only alphanumeric characters or '_'.",z);const $=p.parse(u[z+1],z+1);if(!$)return null;T.push([F,$])}const D=p.parse(u[u.length-1],u.length-1,p.expectedType,T);return D?new po(T,D):null}outputDefined(){return this.result.outputDefined()}}class vl{constructor(u,p,T){this.type=u,this.index=p,this.input=T}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=p.parse(u[1],1,Lt),D=p.parse(u[2],2,oi(p.expectedType||yn));return T&&D?new vl(D.type.itemType,T,D):null}evaluate(u){const p=this.index.evaluate(u),T=this.input.evaluate(u);if(p<0)throw new Rt(`Array index out of bounds: ${p} < 0.`);if(p>=T.length)throw new Rt(`Array index out of bounds: ${p} > ${T.length-1}.`);if(p!==Math.floor(p))throw new Rt(`Array index must be an integer, but found ${p} instead.`);return T[p]}eachChild(u){u(this.index),u(this.input)}outputDefined(){return!1}}class Uo{constructor(u,p){this.type=bn,this.needle=u,this.haystack=p}static parse(u,p){if(u.length!==3)return p.error(`Expected 2 arguments, but found ${u.length-1} instead.`);const T=p.parse(u[1],1,yn),D=p.parse(u[2],2,yn);return T&&D?Vi(T.type,[bn,Sn,Lt,ss,yn])?new Uo(T,D):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(T.type)} instead`):null}evaluate(u){const p=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!T)return!1;if(!Ii(p,["boolean","string","number","null"]))throw new Rt(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(We(p))} instead.`);if(!Ii(T,["string","array"]))throw new Rt(`Expected second argument to be of type array or string, but found ${Zn(We(T))} instead.`);return T.indexOf(p)>=0}eachChild(u){u(this.needle),u(this.haystack)}outputDefined(){return!0}}class ua{constructor(u,p,T){this.type=Lt,this.needle=u,this.haystack=p,this.fromIndex=T}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=p.parse(u[1],1,yn),D=p.parse(u[2],2,yn);if(!T||!D)return null;if(!Vi(T.type,[bn,Sn,Lt,ss,yn]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(T.type)} instead`);if(u.length===4){const z=p.parse(u[3],3,Lt);return z?new ua(T,D,z):null}return new ua(T,D)}evaluate(u){const p=this.needle.evaluate(u),T=this.haystack.evaluate(u);if(!Ii(p,["boolean","string","number","null"]))throw new Rt(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(We(p))} instead.`);if(!Ii(T,["string","array"]))throw new Rt(`Expected second argument to be of type array or string, but found ${Zn(We(T))} instead.`);if(this.fromIndex){const D=this.fromIndex.evaluate(u);return T.indexOf(p,D)}return T.indexOf(p)}eachChild(u){u(this.needle),u(this.haystack),this.fromIndex&&u(this.fromIndex)}outputDefined(){return!1}}class go{constructor(u,p,T,D,z,F){this.inputType=u,this.type=p,this.input=T,this.cases=D,this.outputs=z,this.otherwise=F}static parse(u,p){if(u.length<5)return p.error(`Expected at least 4 arguments, but found only ${u.length-1}.`);if(u.length%2!=1)return p.error("Expected an even number of arguments.");let T,D;p.expectedType&&p.expectedType.kind!=="value"&&(D=p.expectedType);const z={},F=[];for(let re=2;re<u.length-1;re+=2){let Ae=u[re];const ce=u[re+1];Array.isArray(Ae)||(Ae=[Ae]);const pe=p.concat(re);if(Ae.length===0)return pe.error("Expected at least one branch label.");for(const _e of Ae){if(typeof _e!="number"&&typeof _e!="string")return pe.error("Branch labels must be numbers or strings.");if(typeof _e=="number"&&Math.abs(_e)>Number.MAX_SAFE_INTEGER)return pe.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof _e=="number"&&Math.floor(_e)!==_e)return pe.error("Numeric branch labels must be integer values.");if(T){if(pe.checkSubtype(T,We(_e)))return null}else T=We(_e);if(z[String(_e)]!==void 0)return pe.error("Branch labels must be unique.");z[String(_e)]=F.length}const ye=p.parse(ce,re,D);if(!ye)return null;D=D||ye.type,F.push(ye)}const $=p.parse(u[1],1,yn);if(!$)return null;const Z=p.parse(u[u.length-1],u.length-1,D);return Z?$.type.kind!=="value"&&p.concat(1).checkSubtype(T,$.type)?null:new go(T,D,$,z,F,Z):null}evaluate(u){const p=this.input.evaluate(u);return(We(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(u)}eachChild(u){u(this.input),this.outputs.forEach(u),u(this.otherwise)}outputDefined(){return this.outputs.every(u=>u.outputDefined())&&this.otherwise.outputDefined()}}class dA{constructor(u,p,T){this.type=u,this.branches=p,this.otherwise=T}static parse(u,p){if(u.length<4)return p.error(`Expected at least 3 arguments, but found only ${u.length-1}.`);if(u.length%2!=0)return p.error("Expected an odd number of arguments.");let T;p.expectedType&&p.expectedType.kind!=="value"&&(T=p.expectedType);const D=[];for(let F=1;F<u.length-1;F+=2){const $=p.parse(u[F],F,bn);if(!$)return null;const Z=p.parse(u[F+1],F+1,T);if(!Z)return null;D.push([$,Z]),T=T||Z.type}const z=p.parse(u[u.length-1],u.length-1,T);if(!z)return null;if(!T)throw new Error("Can't infer output type");return new dA(T,D,z)}evaluate(u){for(const[p,T]of this.branches)if(p.evaluate(u))return T.evaluate(u);return this.otherwise.evaluate(u)}eachChild(u){for(const[p,T]of this.branches)u(p),u(T);u(this.otherwise)}outputDefined(){return this.branches.every(([u,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class Na{constructor(u,p,T,D){this.type=u,this.input=p,this.beginIndex=T,this.endIndex=D}static parse(u,p){if(u.length<=2||u.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${u.length-1} instead.`);const T=p.parse(u[1],1,yn),D=p.parse(u[2],2,Lt);if(!T||!D)return null;if(!Vi(T.type,[oi(yn),Sn,yn]))return p.error(`Expected first argument to be of type array or string, but found ${Zn(T.type)} instead`);if(u.length===4){const z=p.parse(u[3],3,Lt);return z?new Na(T.type,T,D,z):null}return new Na(T.type,T,D)}evaluate(u){const p=this.input.evaluate(u),T=this.beginIndex.evaluate(u);if(!Ii(p,["string","array"]))throw new Rt(`Expected first argument to be of type array or string, but found ${Zn(We(p))} instead.`);if(this.endIndex){const D=this.endIndex.evaluate(u);return p.slice(T,D)}return p.slice(T)}eachChild(u){u(this.input),u(this.beginIndex),this.endIndex&&u(this.endIndex)}outputDefined(){return!1}}function Vo(f,u){return f==="=="||f==="!="?u.kind==="boolean"||u.kind==="string"||u.kind==="number"||u.kind==="null"||u.kind==="value":u.kind==="string"||u.kind==="number"||u.kind==="value"}function Gi(f,u,p,T){return T.compare(u,p)===0}function $i(f,u,p){const T=f!=="=="&&f!=="!=";return class tz{constructor(z,F,$){this.type=bn,this.lhs=z,this.rhs=F,this.collator=$,this.hasUntypedArgument=z.type.kind==="value"||F.type.kind==="value"}static parse(z,F){if(z.length!==3&&z.length!==4)return F.error("Expected two or three arguments.");const $=z[0];let Z=F.parse(z[1],1,yn);if(!Z)return null;if(!Vo($,Z.type))return F.concat(1).error(`"${$}" comparisons are not supported for type '${Zn(Z.type)}'.`);let re=F.parse(z[2],2,yn);if(!re)return null;if(!Vo($,re.type))return F.concat(2).error(`"${$}" comparisons are not supported for type '${Zn(re.type)}'.`);if(Z.type.kind!==re.type.kind&&Z.type.kind!=="value"&&re.type.kind!=="value")return F.error(`Cannot compare types '${Zn(Z.type)}' and '${Zn(re.type)}'.`);T&&(Z.type.kind==="value"&&re.type.kind!=="value"?Z=new jt(re.type,[Z]):Z.type.kind!=="value"&&re.type.kind==="value"&&(re=new jt(Z.type,[re])));let Ae=null;if(z.length===4){if(Z.type.kind!=="string"&&re.type.kind!=="string"&&Z.type.kind!=="value"&&re.type.kind!=="value")return F.error("Cannot use collator to compare non-string types.");if(Ae=F.parse(z[3],3,Ye),!Ae)return null}return new tz(Z,re,Ae)}evaluate(z){const F=this.lhs.evaluate(z),$=this.rhs.evaluate(z);if(T&&this.hasUntypedArgument){const Z=We(F),re=We($);if(Z.kind!==re.kind||Z.kind!=="string"&&Z.kind!=="number")throw new Rt(`Expected arguments for "${f}" to be (string, string) or (number, number), but found (${Z.kind}, ${re.kind}) instead.`)}if(this.collator&&!T&&this.hasUntypedArgument){const Z=We(F),re=We($);if(Z.kind!=="string"||re.kind!=="string")return u(z,F,$)}return this.collator?p(z,F,$,this.collator.evaluate(z)):u(z,F,$)}eachChild(z){z(this.lhs),z(this.rhs),this.collator&&z(this.collator)}outputDefined(){return!0}}}const YA=$i("==",function(f,u,p){return u===p},Gi),xl=$i("!=",function(f,u,p){return u!==p},function(f,u,p,T){return!Gi(0,u,p,T)}),mo=$i("<",function(f,u,p){return u<p},function(f,u,p,T){return T.compare(u,p)<0}),Go=$i(">",function(f,u,p){return u>p},function(f,u,p,T){return T.compare(u,p)>0}),Ac=$i("<=",function(f,u,p){return u<=p},function(f,u,p,T){return T.compare(u,p)<=0}),XA=$i(">=",function(f,u,p){return u>=p},function(f,u,p,T){return T.compare(u,p)>=0});class wl{constructor(u,p,T,D,z){this.type=Sn,this.number=u,this.locale=p,this.currency=T,this.minFractionDigits=D,this.maxFractionDigits=z}static parse(u,p){if(u.length!==3)return p.error("Expected two arguments.");const T=p.parse(u[1],1,Lt);if(!T)return null;const D=u[2];if(typeof D!="object"||Array.isArray(D))return p.error("NumberFormat options argument must be an object.");let z=null;if(D.locale&&(z=p.parse(D.locale,1,Sn),!z))return null;let F=null;if(D.currency&&(F=p.parse(D.currency,1,Sn),!F))return null;let $=null;if(D["min-fraction-digits"]&&($=p.parse(D["min-fraction-digits"],1,Lt),!$))return null;let Z=null;return D["max-fraction-digits"]&&(Z=p.parse(D["max-fraction-digits"],1,Lt),!Z)?null:new wl(T,z,F,$,Z)}evaluate(u){return new Intl.NumberFormat(this.locale?this.locale.evaluate(u):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(u):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(u):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(u):void 0}).format(this.number.evaluate(u))}eachChild(u){u(this.number),this.locale&&u(this.locale),this.currency&&u(this.currency),this.minFractionDigits&&u(this.minFractionDigits),this.maxFractionDigits&&u(this.maxFractionDigits)}outputDefined(){return!1}}class pA{constructor(u){this.type=jr,this.sections=u}static parse(u,p){if(u.length<2)return p.error("Expected at least one argument.");const T=u[1];if(!Array.isArray(T)&&typeof T=="object")return p.error("First argument must be an image or text section.");const D=[];let z=!1;for(let F=1;F<=u.length-1;++F){const $=u[F];if(z&&typeof $=="object"&&!Array.isArray($)){z=!1;let Z=null;if($["font-scale"]&&(Z=p.parse($["font-scale"],1,Lt),!Z))return null;let re=null;if($["text-font"]&&(re=p.parse($["text-font"],1,oi(Sn)),!re))return null;let Ae=null;if($["text-color"]&&(Ae=p.parse($["text-color"],1,Cr),!Ae))return null;const ce=D[D.length-1];ce.scale=Z,ce.font=re,ce.textColor=Ae}else{const Z=p.parse(u[F],1,yn);if(!Z)return null;const re=Z.type.kind;if(re!=="string"&&re!=="value"&&re!=="null"&&re!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");z=!0,D.push({content:Z,scale:null,font:null,textColor:null})}}return new pA(D)}evaluate(u){return new Ie(this.sections.map(p=>{const T=p.content.evaluate(u);return We(T)===Dr?new Le("",T,null,null,null):new Le(ft(T),null,p.scale?p.scale.evaluate(u):null,p.font?p.font.evaluate(u).join(","):null,p.textColor?p.textColor.evaluate(u):null)}))}eachChild(u){for(const p of this.sections)u(p.content),p.scale&&u(p.scale),p.font&&u(p.font),p.textColor&&u(p.textColor)}outputDefined(){return!1}}class KA{constructor(u){this.type=Dr,this.input=u}static parse(u,p){if(u.length!==2)return p.error("Expected two arguments.");const T=p.parse(u[1],1,Sn);return T?new KA(T):p.error("No image name provided.")}evaluate(u){const p=this.input.evaluate(u),T=ke.fromString(p);return T&&u.availableImages&&(T.available=u.availableImages.indexOf(p)>-1),T}eachChild(u){u(this.input)}outputDefined(){return!1}}class $o{constructor(u){this.type=Lt,this.input=u}static parse(u,p){if(u.length!==2)return p.error(`Expected 1 argument, but found ${u.length-1} instead.`);const T=p.parse(u[1],1);return T?T.type.kind!=="array"&&T.type.kind!=="string"&&T.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${Zn(T.type)} instead.`):new $o(T):null}evaluate(u){const p=this.input.evaluate(u);if(typeof p=="string"||Array.isArray(p))return p.length;throw new Rt(`Expected value to be of type string or array, but found ${Zn(We(p))} instead.`)}eachChild(u){u(this.input)}outputDefined(){return!1}}const Ua={"==":YA,"!=":xl,">":Go,"<":mo,">=":XA,"<=":Ac,array:jt,at:vl,boolean:jt,case:dA,coalesce:ei,collator:Oe,format:pA,image:KA,in:Uo,"index-of":ua,interpolate:zn,"interpolate-hcl":zn,"interpolate-lab":zn,length:$o,let:po,literal:Dt,match:go,number:jt,"number-format":wl,object:jt,slice:Na,step:Mr,string:jt,"to-boolean":qt,"to-color":qt,"to-number":qt,"to-string":qt,var:at,within:Jr};function JA(f,[u,p,T,D]){u=u.evaluate(f),p=p.evaluate(f),T=T.evaluate(f);const z=D?D.evaluate(f):1,F=qe(u,p,T,z);if(F)throw new Rt(F);return new a(u/255*z,p/255*z,T/255*z,z)}function eu(f,u){return f in u}function yo(f,u){const p=u[f];return p===void 0?null:p}function ca(f){return{type:f}}function tu(f){return{result:"success",value:f}}function ha(f){return{result:"error",value:f}}function cr(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Fs(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function $n(f){return!!f.expression&&f.expression.interpolated}function Qn(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function _r(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function fr(f){return f}function bl(f,u){const p=u.type==="color",T=f.stops&&typeof f.stops[0][0]=="object",D=T||!(T||f.property!==void 0),z=f.type||($n(u)?"exponential":"interval");if(p||u.type==="padding"){const re=p?a.parse:Pe.parse;(f=yi({},f)).stops&&(f.stops=f.stops.map(Ae=>[Ae[0],re(Ae[1])])),f.default=re(f.default?f.default:u.default)}if(f.colorSpace&&f.colorSpace!=="rgb"&&!No[f.colorSpace])throw new Error(`Unknown color space: ${f.colorSpace}`);let F,$,Z;if(z==="exponential")F=cc;else if(z==="interval")F=Va;else if(z==="categorical"){F=uc,$=Object.create(null);for(const re of f.stops)$[re[0]]=re[1];Z=typeof f.stops[0][0]}else{if(z!=="identity")throw new Error(`Unknown function type "${z}"`);F=nu}if(T){const re={},Ae=[];for(let ye=0;ye<f.stops.length;ye++){const _e=f.stops[ye],Ue=_e[0].zoom;re[Ue]===void 0&&(re[Ue]={zoom:Ue,type:f.type,property:f.property,default:f.default,stops:[]},Ae.push(Ue)),re[Ue].stops.push([_e[0].value,_e[1]])}const ce=[];for(const ye of Ae)ce.push([re[ye].zoom,bl(re[ye],u)]);const pe={name:"linear"};return{kind:"composite",interpolationType:pe,interpolationFactor:zn.interpolationFactor.bind(void 0,pe),zoomStops:ce.map(ye=>ye[0]),evaluate:({zoom:ye},_e)=>cc({stops:ce,base:f.base},u,ye).evaluate(ye,_e)}}if(D){const re=z==="exponential"?{name:"exponential",base:f.base!==void 0?f.base:1}:null;return{kind:"camera",interpolationType:re,interpolationFactor:zn.interpolationFactor.bind(void 0,re),zoomStops:f.stops.map(Ae=>Ae[0]),evaluate:({zoom:Ae})=>F(f,u,Ae,$,Z)}}return{kind:"source",evaluate(re,Ae){const ce=Ae&&Ae.properties?Ae.properties[f.property]:void 0;return ce===void 0?jo(f.default,u.default):F(f,u,ce,$,Z)}}}function jo(f,u,p){return f!==void 0?f:u!==void 0?u:p!==void 0?p:void 0}function uc(f,u,p,T,D){return jo(typeof p===D?T[p]:void 0,f.default,u.default)}function Va(f,u,p){if(Qn(p)!=="number")return jo(f.default,u.default);const T=f.stops.length;if(T===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[T-1][0])return f.stops[T-1][1];const D=Ln(f.stops.map(z=>z[0]),p);return f.stops[D][1]}function cc(f,u,p){const T=f.base!==void 0?f.base:1;if(Qn(p)!=="number")return jo(f.default,u.default);const D=f.stops.length;if(D===1||p<=f.stops[0][0])return f.stops[0][1];if(p>=f.stops[D-1][0])return f.stops[D-1][1];const z=Ln(f.stops.map(Ae=>Ae[0]),p),F=function(Ae,ce,pe,ye){const _e=ye-pe,Ue=Ae-pe;return _e===0?0:ce===1?Ue/_e:(Math.pow(ce,Ue)-1)/(Math.pow(ce,_e)-1)}(p,T,f.stops[z][0],f.stops[z+1][0]),$=f.stops[z][1],Z=f.stops[z+1][1];let re=Pr[u.type]||fr;if(f.colorSpace&&f.colorSpace!=="rgb"){const Ae=No[f.colorSpace];re=(ce,pe)=>Ae.reverse(Ae.interpolate(Ae.forward(ce),Ae.forward(pe),F))}return typeof $.evaluate=="function"?{evaluate(...Ae){const ce=$.evaluate.apply(void 0,Ae),pe=Z.evaluate.apply(void 0,Ae);if(ce!==void 0&&pe!==void 0)return re(ce,pe,F)}}:re($,Z,F)}function nu(f,u,p){switch(u.type){case"color":p=a.parse(p);break;case"formatted":p=Ie.fromString(p.toString());break;case"resolvedImage":p=ke.fromString(p.toString());break;case"padding":p=Pe.parse(p);break;default:Qn(p)===u.type||u.type==="enum"&&u.values[p]||(p=void 0)}return jo(p,f.default,u.default)}Ft.register(Ua,{error:[{kind:"error"},[Sn],(f,[u])=>{throw new Rt(u.evaluate(f))}],typeof:[Sn,[yn],(f,[u])=>Zn(We(u.evaluate(f)))],"to-rgba":[oi(Lt,4),[Cr],(f,[u])=>u.evaluate(f).toArray()],rgb:[Cr,[Lt,Lt,Lt],JA],rgba:[Cr,[Lt,Lt,Lt,Lt],JA],has:{type:bn,overloads:[[[Sn],(f,[u])=>eu(u.evaluate(f),f.properties())],[[Sn,xs],(f,[u,p])=>eu(u.evaluate(f),p.evaluate(f))]]},get:{type:yn,overloads:[[[Sn],(f,[u])=>yo(u.evaluate(f),f.properties())],[[Sn,xs],(f,[u,p])=>yo(u.evaluate(f),p.evaluate(f))]]},"feature-state":[yn,[Sn],(f,[u])=>yo(u.evaluate(f),f.featureState||{})],properties:[xs,[],f=>f.properties()],"geometry-type":[Sn,[],f=>f.geometryType()],id:[yn,[],f=>f.id()],zoom:[Lt,[],f=>f.globals.zoom],"heatmap-density":[Lt,[],f=>f.globals.heatmapDensity||0],"line-progress":[Lt,[],f=>f.globals.lineProgress||0],accumulated:[yn,[],f=>f.globals.accumulated===void 0?null:f.globals.accumulated],"+":[Lt,ca(Lt),(f,u)=>{let p=0;for(const T of u)p+=T.evaluate(f);return p}],"*":[Lt,ca(Lt),(f,u)=>{let p=1;for(const T of u)p*=T.evaluate(f);return p}],"-":{type:Lt,overloads:[[[Lt,Lt],(f,[u,p])=>u.evaluate(f)-p.evaluate(f)],[[Lt],(f,[u])=>-u.evaluate(f)]]},"/":[Lt,[Lt,Lt],(f,[u,p])=>u.evaluate(f)/p.evaluate(f)],"%":[Lt,[Lt,Lt],(f,[u,p])=>u.evaluate(f)%p.evaluate(f)],ln2:[Lt,[],()=>Math.LN2],pi:[Lt,[],()=>Math.PI],e:[Lt,[],()=>Math.E],"^":[Lt,[Lt,Lt],(f,[u,p])=>Math.pow(u.evaluate(f),p.evaluate(f))],sqrt:[Lt,[Lt],(f,[u])=>Math.sqrt(u.evaluate(f))],log10:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN10],ln:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))],log2:[Lt,[Lt],(f,[u])=>Math.log(u.evaluate(f))/Math.LN2],sin:[Lt,[Lt],(f,[u])=>Math.sin(u.evaluate(f))],cos:[Lt,[Lt],(f,[u])=>Math.cos(u.evaluate(f))],tan:[Lt,[Lt],(f,[u])=>Math.tan(u.evaluate(f))],asin:[Lt,[Lt],(f,[u])=>Math.asin(u.evaluate(f))],acos:[Lt,[Lt],(f,[u])=>Math.acos(u.evaluate(f))],atan:[Lt,[Lt],(f,[u])=>Math.atan(u.evaluate(f))],min:[Lt,ca(Lt),(f,u)=>Math.min(...u.map(p=>p.evaluate(f)))],max:[Lt,ca(Lt),(f,u)=>Math.max(...u.map(p=>p.evaluate(f)))],abs:[Lt,[Lt],(f,[u])=>Math.abs(u.evaluate(f))],round:[Lt,[Lt],(f,[u])=>{const p=u.evaluate(f);return p<0?-Math.round(-p):Math.round(p)}],floor:[Lt,[Lt],(f,[u])=>Math.floor(u.evaluate(f))],ceil:[Lt,[Lt],(f,[u])=>Math.ceil(u.evaluate(f))],"filter-==":[bn,[Sn,yn],(f,[u,p])=>f.properties()[u.value]===p.value],"filter-id-==":[bn,[yn],(f,[u])=>f.id()===u.value],"filter-type-==":[bn,[Sn],(f,[u])=>f.geometryType()===u.value],"filter-<":[bn,[Sn,yn],(f,[u,p])=>{const T=f.properties()[u.value],D=p.value;return typeof T==typeof D&&T<D}],"filter-id-<":[bn,[yn],(f,[u])=>{const p=f.id(),T=u.value;return typeof p==typeof T&&p<T}],"filter->":[bn,[Sn,yn],(f,[u,p])=>{const T=f.properties()[u.value],D=p.value;return typeof T==typeof D&&T>D}],"filter-id->":[bn,[yn],(f,[u])=>{const p=f.id(),T=u.value;return typeof p==typeof T&&p>T}],"filter-<=":[bn,[Sn,yn],(f,[u,p])=>{const T=f.properties()[u.value],D=p.value;return typeof T==typeof D&&T<=D}],"filter-id-<=":[bn,[yn],(f,[u])=>{const p=f.id(),T=u.value;return typeof p==typeof T&&p<=T}],"filter->=":[bn,[Sn,yn],(f,[u,p])=>{const T=f.properties()[u.value],D=p.value;return typeof T==typeof D&&T>=D}],"filter-id->=":[bn,[yn],(f,[u])=>{const p=f.id(),T=u.value;return typeof p==typeof T&&p>=T}],"filter-has":[bn,[yn],(f,[u])=>u.value in f.properties()],"filter-has-id":[bn,[],f=>f.id()!==null&&f.id()!==void 0],"filter-type-in":[bn,[oi(Sn)],(f,[u])=>u.value.indexOf(f.geometryType())>=0],"filter-id-in":[bn,[oi(yn)],(f,[u])=>u.value.indexOf(f.id())>=0],"filter-in-small":[bn,[Sn,oi(yn)],(f,[u,p])=>p.value.indexOf(f.properties()[u.value])>=0],"filter-in-large":[bn,[Sn,oi(yn)],(f,[u,p])=>function(T,D,z,F){for(;z<=F;){const $=z+F>>1;if(D[$]===T)return!0;D[$]>T?F=$-1:z=$+1}return!1}(f.properties()[u.value],p.value,0,p.value.length-1)],all:{type:bn,overloads:[[[bn,bn],(f,[u,p])=>u.evaluate(f)&&p.evaluate(f)],[ca(bn),(f,u)=>{for(const p of u)if(!p.evaluate(f))return!1;return!0}]]},any:{type:bn,overloads:[[[bn,bn],(f,[u,p])=>u.evaluate(f)||p.evaluate(f)],[ca(bn),(f,u)=>{for(const p of u)if(p.evaluate(f))return!0;return!1}]]},"!":[bn,[bn],(f,[u])=>!u.evaluate(f)],"is-supported-script":[bn,[Sn],(f,[u])=>{const p=f.globals&&f.globals.isSupportedScript;return!p||p(u.evaluate(f))}],upcase:[Sn,[Sn],(f,[u])=>u.evaluate(f).toUpperCase()],downcase:[Sn,[Sn],(f,[u])=>u.evaluate(f).toLowerCase()],concat:[Sn,ca(yn),(f,u)=>u.map(p=>ft(p.evaluate(f))).join("")],"resolved-locale":[Sn,[Ye],(f,[u])=>u.evaluate(f).resolvedLocale()]});class Ns{constructor(u,p){this.expression=u,this._warningHistory={},this._evaluator=new xn,this._defaultValue=p?function(T){return T.type==="color"&&_r(T.default)?new a(0,0,0,0):T.type==="color"?a.parse(T.default)||null:T.type==="padding"?Pe.parse(T.default)||null:T.default===void 0?null:T.default}(p):null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(u,p,T,D,z,F){return this._evaluator.globals=u,this._evaluator.feature=p,this._evaluator.featureState=T,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=F,this.expression.evaluate(this._evaluator)}evaluate(u,p,T,D,z,F){this._evaluator.globals=u,this._evaluator.feature=p||null,this._evaluator.featureState=T||null,this._evaluator.canonical=D,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=F||null;try{const $=this.expression.evaluate(this._evaluator);if($==null||typeof $=="number"&&$!=$)return this._defaultValue;if(this._enumValues&&!($ in this._enumValues))throw new Rt(`Expected value to be one of ${Object.keys(this._enumValues).map(Z=>JSON.stringify(Z)).join(", ")}, but found ${JSON.stringify($)} instead.`);return $}catch($){return this._warningHistory[$.message]||(this._warningHistory[$.message]=!0,typeof console<"u"&&console.warn($.message)),this._defaultValue}}}function El(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in Ua}function Ga(f,u){const p=new bt(Ua,[],u?function(D){const z={color:Cr,string:Sn,number:Lt,enum:Sn,boolean:bn,formatted:jr,padding:zs,resolvedImage:Dr};return D.type==="array"?oi(z[D.value]||yn,D.length):z[D.type]}(u):void 0),T=p.parse(f,void 0,void 0,void 0,u&&u.type==="string"?{typeAnnotation:"coerce"}:void 0);return T?tu(new Ns(T,u)):ha(p.errors)}class fa{constructor(u,p){this.kind=u,this._styleExpression=p,this.isStateDependent=u!=="constant"&&!Ee(p.expression)}evaluateWithoutErrorHandling(u,p,T,D,z,F){return this._styleExpression.evaluateWithoutErrorHandling(u,p,T,D,z,F)}evaluate(u,p,T,D,z,F){return this._styleExpression.evaluate(u,p,T,D,z,F)}}class Tl{constructor(u,p,T,D){this.kind=u,this.zoomStops=T,this._styleExpression=p,this.isStateDependent=u!=="camera"&&!Ee(p.expression),this.interpolationType=D}evaluateWithoutErrorHandling(u,p,T,D,z,F){return this._styleExpression.evaluateWithoutErrorHandling(u,p,T,D,z,F)}evaluate(u,p,T,D,z,F){return this._styleExpression.evaluate(u,p,T,D,z,F)}interpolationFactor(u,p,T){return this.interpolationType?zn.interpolationFactor(this.interpolationType,u,p,T):0}}function Sl(f,u){const p=Ga(f,u);if(p.result==="error")return p;const T=p.value.expression,D=ge(T);if(!D&&!cr(u))return ha([new Ci("","data expressions not supported")]);const z=Fe(T,["zoom"]);if(!z&&!Fs(u))return ha([new Ci("","zoom expressions not supported")]);const F=gA(T);return F||z?F instanceof Ci?ha([F]):F instanceof zn&&!$n(u)?ha([new Ci("",'"interpolate" expressions cannot be used with this property')]):tu(F?new Tl(D?"camera":"composite",p.value,F.labels,F instanceof zn?F.interpolation:void 0):new fa(D?"constant":"source",p.value)):ha([new Ci("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class dr{constructor(u,p){this._parameters=u,this._specification=p,yi(this,bl(this._parameters,this._specification))}static deserialize(u){return new dr(u._parameters,u._specification)}static serialize(u){return{_parameters:u._parameters,_specification:u._specification}}}function gA(f){let u=null;if(f instanceof po)u=gA(f.result);else if(f instanceof ei){for(const p of f.args)if(u=gA(p),u)break}else(f instanceof Mr||f instanceof zn)&&f.input instanceof Ft&&f.input.name==="zoom"&&(u=f);return u instanceof Ci||f.eachChild(p=>{const T=gA(p);T instanceof Ci?u=T:!u&&T?u=new Ci("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):u&&T&&u!==T&&(u=new Ci("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),u}function as(f){const u=f.key,p=f.value,T=f.valueSpec||{},D=f.objectElementValidators||{},z=f.style,F=f.styleSpec;let $=[];const Z=Qn(p);if(Z!=="object")return[new kt(u,p,`object expected, ${Z} found`)];for(const re in p){const Ae=re.split(".")[0],ce=T[Ae]||T["*"];let pe;if(D[Ae])pe=D[Ae];else if(T[Ae])pe=Zi;else if(D["*"])pe=D["*"];else{if(!T["*"]){$.push(new kt(u,p[re],`unknown property "${re}"`));continue}pe=Zi}$=$.concat(pe({key:(u&&`${u}.`)+re,value:p[re],valueSpec:ce,style:z,styleSpec:F,object:p,objectKey:re},p))}for(const re in T)D[re]||T[re].required&&T[re].default===void 0&&p[re]===void 0&&$.push(new kt(u,p,`missing required property "${re}"`));return $}function ru(f){const u=f.value,p=f.valueSpec,T=f.style,D=f.styleSpec,z=f.key,F=f.arrayElementValidator||Zi;if(Qn(u)!=="array")return[new kt(z,u,`array expected, ${Qn(u)} found`)];if(p.length&&u.length!==p.length)return[new kt(z,u,`array length ${p.length} expected, length ${u.length} found`)];if(p["min-length"]&&u.length<p["min-length"])return[new kt(z,u,`array length at least ${p["min-length"]} expected, length ${u.length} found`)];let $={type:p.value,values:p.values};D.$version<7&&($.function=p.function),Qn(p.value)==="object"&&($=p.value);let Z=[];for(let re=0;re<u.length;re++)Z=Z.concat(F({array:u,arrayIndex:re,value:u[re],valueSpec:$,style:T,styleSpec:D,key:`${z}[${re}]`}));return Z}function Ml(f){const u=f.key,p=f.value,T=f.valueSpec;let D=Qn(p);return D==="number"&&p!=p&&(D="NaN"),D!=="number"?[new kt(u,p,`number expected, ${D} found`)]:"minimum"in T&&p<T.minimum?[new kt(u,p,`${p} is less than the minimum value ${T.minimum}`)]:"maximum"in T&&p>T.maximum?[new kt(u,p,`${p} is greater than the maximum value ${T.maximum}`)]:[]}function hc(f){const u=f.valueSpec,p=Bn(f.value.type);let T,D,z,F={};const $=p!=="categorical"&&f.value.property===void 0,Z=!$,re=Qn(f.value.stops)==="array"&&Qn(f.value.stops[0])==="array"&&Qn(f.value.stops[0][0])==="object",Ae=as({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(ye){if(p==="identity")return[new kt(ye.key,ye.value,'identity function may not have a "stops" property')];let _e=[];const Ue=ye.value;return _e=_e.concat(ru({key:ye.key,value:Ue,valueSpec:ye.valueSpec,style:ye.style,styleSpec:ye.styleSpec,arrayElementValidator:ce})),Qn(Ue)==="array"&&Ue.length===0&&_e.push(new kt(ye.key,Ue,"array must have at least one stop")),_e},default:function(ye){return Zi({key:ye.key,value:ye.value,valueSpec:u,style:ye.style,styleSpec:ye.styleSpec})}}});return p==="identity"&&$&&Ae.push(new kt(f.key,f.value,'missing required property "property"')),p==="identity"||f.value.stops||Ae.push(new kt(f.key,f.value,'missing required property "stops"')),p==="exponential"&&f.valueSpec.expression&&!$n(f.valueSpec)&&Ae.push(new kt(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(Z&&!cr(f.valueSpec)?Ae.push(new kt(f.key,f.value,"property functions not supported")):$&&!Fs(f.valueSpec)&&Ae.push(new kt(f.key,f.value,"zoom functions not supported"))),p!=="categorical"&&!re||f.value.property!==void 0||Ae.push(new kt(f.key,f.value,'"property" property is required')),Ae;function ce(ye){let _e=[];const Ue=ye.value,ze=ye.key;if(Qn(Ue)!=="array")return[new kt(ze,Ue,`array expected, ${Qn(Ue)} found`)];if(Ue.length!==2)return[new kt(ze,Ue,`array length 2 expected, length ${Ue.length} found`)];if(re){if(Qn(Ue[0])!=="object")return[new kt(ze,Ue,`object expected, ${Qn(Ue[0])} found`)];if(Ue[0].zoom===void 0)return[new kt(ze,Ue,"object stop key must have zoom")];if(Ue[0].value===void 0)return[new kt(ze,Ue,"object stop key must have value")];if(z&&z>Bn(Ue[0].zoom))return[new kt(ze,Ue[0].zoom,"stop zoom values must appear in ascending order")];Bn(Ue[0].zoom)!==z&&(z=Bn(Ue[0].zoom),D=void 0,F={}),_e=_e.concat(as({key:`${ze}[0]`,value:Ue[0],valueSpec:{zoom:{}},style:ye.style,styleSpec:ye.styleSpec,objectElementValidators:{zoom:Ml,value:pe}}))}else _e=_e.concat(pe({key:`${ze}[0]`,value:Ue[0],valueSpec:{},style:ye.style,styleSpec:ye.styleSpec},Ue));return El(Ni(Ue[1]))?_e.concat([new kt(`${ze}[1]`,Ue[1],"expressions are not allowed in function stops.")]):_e.concat(Zi({key:`${ze}[1]`,value:Ue[1],valueSpec:u,style:ye.style,styleSpec:ye.styleSpec}))}function pe(ye,_e){const Ue=Qn(ye.value),ze=Bn(ye.value),tt=ye.value!==null?ye.value:_e;if(T){if(Ue!==T)return[new kt(ye.key,tt,`${Ue} stop domain type must match previous stop domain type ${T}`)]}else T=Ue;if(Ue!=="number"&&Ue!=="string"&&Ue!=="boolean")return[new kt(ye.key,tt,"stop domain value must be a number, string, or boolean")];if(Ue!=="number"&&p!=="categorical"){let At=`number expected, ${Ue} found`;return cr(u)&&p===void 0&&(At+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new kt(ye.key,tt,At)]}return p!=="categorical"||Ue!=="number"||isFinite(ze)&&Math.floor(ze)===ze?p!=="categorical"&&Ue==="number"&&D!==void 0&&ze<D?[new kt(ye.key,tt,"stop domain values must appear in ascending order")]:(D=ze,p==="categorical"&&ze in F?[new kt(ye.key,tt,"stop domain values must be unique")]:(F[ze]=!0,[])):[new kt(ye.key,tt,`integer expected, found ${ze}`)]}}function Wr(f){const u=(f.expressionContext==="property"?Sl:Ga)(Ni(f.value),f.valueSpec);if(u.result==="error")return u.value.map(T=>new kt(`${f.key}${T.key}`,f.value,T.message));const p=u.value.expression||u.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!p.outputDefined())return[new kt(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!Ee(p))return[new kt(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!Ee(p))return[new kt(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!Fe(p,["zoom","feature-state"]))return[new kt(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!ge(p))return[new kt(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ir(f){const u=f.key,p=f.value,T=f.valueSpec,D=[];return Array.isArray(T.values)?T.values.indexOf(Bn(p))===-1&&D.push(new kt(u,p,`expected one of [${T.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(T.values).indexOf(Bn(p))===-1&&D.push(new kt(u,p,`expected one of [${Object.keys(T.values).join(", ")}], ${JSON.stringify(p)} found`)),D}function ti(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(const u of f.slice(1))if(!ti(u)&&typeof u!="boolean")return!1;return!0;default:return!0}}const iu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Us(f){if(f==null)return{filter:()=>!0,needGeometry:!1};ti(f)||(f=li(f));const u=Ga(f,iu);if(u.result==="error")throw new Error(u.value.map(p=>`${p.key}: ${p.message}`).join(", "));return{filter:(p,T,D)=>u.value.evaluate(p,T,{},D),needGeometry:mA(f)}}function fc(f,u){return f<u?-1:f>u?1:0}function mA(f){if(!Array.isArray(f))return!1;if(f[0]==="within")return!0;for(let u=1;u<f.length;u++)if(mA(f[u]))return!0;return!1}function li(f){if(!f)return!0;const u=f[0];return f.length<=1?u!=="any":u==="=="?_i(f[1],f[2],"=="):u==="!="?qi(_i(f[1],f[2],"==")):u==="<"||u===">"||u==="<="||u===">="?_i(f[1],f[2],u):u==="any"?(p=f.slice(1),["any"].concat(p.map(li))):u==="all"?["all"].concat(f.slice(1).map(li)):u==="none"?["all"].concat(f.slice(1).map(li).map(qi)):u==="in"?ls(f[1],f.slice(2)):u==="!in"?qi(ls(f[1],f.slice(2))):u==="has"?da(f[1]):u==="!has"?qi(da(f[1])):u!=="within"||f;var p}function _i(f,u,p){switch(f){case"$type":return[`filter-type-${p}`,u];case"$id":return[`filter-id-${p}`,u];default:return[`filter-${p}`,f,u]}}function ls(f,u){if(u.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",u]];case"$id":return["filter-id-in",["literal",u]];default:return u.length>200&&!u.some(p=>typeof p!=typeof u[0])?["filter-in-large",f,["literal",u.sort(fc)]]:["filter-in-small",f,["literal",u]]}}function da(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function qi(f){return["!",f]}function _o(f){return ti(Ni(f.value))?Wr(yi({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):hi(f)}function hi(f){const u=f.value,p=f.key;if(Qn(u)!=="array")return[new kt(p,u,`array expected, ${Qn(u)} found`)];const T=f.styleSpec;let D,z=[];if(u.length<1)return[new kt(p,u,"filter array must have at least 1 element")];switch(z=z.concat(Ir({key:`${p}[0]`,value:u[0],valueSpec:T.filter_operator,style:f.style,styleSpec:f.styleSpec})),Bn(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&Bn(u[1])==="$type"&&z.push(new kt(p,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&z.push(new kt(p,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(D=Qn(u[1]),D!=="string"&&z.push(new kt(`${p}[1]`,u[1],`string expected, ${D} found`)));for(let F=2;F<u.length;F++)D=Qn(u[F]),Bn(u[1])==="$type"?z=z.concat(Ir({key:`${p}[${F}]`,value:u[F],valueSpec:T.geometry_type,style:f.style,styleSpec:f.styleSpec})):D!=="string"&&D!=="number"&&D!=="boolean"&&z.push(new kt(`${p}[${F}]`,u[F],`string, number, or boolean expected, ${D} found`));break;case"any":case"all":case"none":for(let F=1;F<u.length;F++)z=z.concat(hi({key:`${p}[${F}]`,value:u[F],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":D=Qn(u[1]),u.length!==2?z.push(new kt(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="string"&&z.push(new kt(`${p}[1]`,u[1],`string expected, ${D} found`));break;case"within":D=Qn(u[1]),u.length!==2?z.push(new kt(p,u,`filter array for "${u[0]}" operator must have 2 elements`)):D!=="object"&&z.push(new kt(`${p}[1]`,u[1],`object expected, ${D} found`))}return z}function $a(f,u){const p=f.key,T=f.style,D=f.styleSpec,z=f.value,F=f.objectKey,$=D[`${u}_${f.layerType}`];if(!$)return[];const Z=F.match(/^(.*)-transition$/);if(u==="paint"&&Z&&$[Z[1]]&&$[Z[1]].transition)return Zi({key:p,value:z,valueSpec:D.transition,style:T,styleSpec:D});const re=f.valueSpec||$[F];if(!re)return[new kt(p,z,`unknown property "${F}"`)];let Ae;if(Qn(z)==="string"&&cr(re)&&!re.tokens&&(Ae=/^{([^}]+)}$/.exec(z)))return[new kt(p,z,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Ae[1])} }\`.`)];const ce=[];return f.layerType==="symbol"&&(F==="text-field"&&T&&!T.glyphs&&ce.push(new kt(p,z,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&_r(Ni(z))&&Bn(z.type)==="identity"&&ce.push(new kt(p,z,'"text-font" does not support identity functions'))),ce.concat(Zi({key:f.key,value:z,valueSpec:re,style:T,styleSpec:D,expressionContext:"property",propertyType:u,propertyKey:F}))}function Cl(f){return $a(f,"paint")}function ja(f){return $a(f,"layout")}function Vs(f){let u=[];const p=f.value,T=f.key,D=f.style,z=f.styleSpec;p.type||p.ref||u.push(new kt(T,p,'either "type" or "ref" is required'));let F=Bn(p.type);const $=Bn(p.ref);if(p.id){const Z=Bn(p.id);for(let re=0;re<f.arrayIndex;re++){const Ae=D.layers[re];Bn(Ae.id)===Z&&u.push(new kt(T,p.id,`duplicate layer id "${p.id}", previously used at line ${Ae.id.__line__}`))}}if("ref"in p){let Z;["type","source","source-layer","filter","layout"].forEach(re=>{re in p&&u.push(new kt(T,p[re],`"${re}" is prohibited for ref layers`))}),D.layers.forEach(re=>{Bn(re.id)===$&&(Z=re)}),Z?Z.ref?u.push(new kt(T,p.ref,"ref cannot reference another ref layer")):F=Bn(Z.type):u.push(new kt(T,p.ref,`ref layer "${$}" not found`))}else if(F!=="background")if(p.source){const Z=D.sources&&D.sources[p.source],re=Z&&Bn(Z.type);Z?re==="vector"&&F==="raster"?u.push(new kt(T,p.source,`layer "${p.id}" requires a raster source`)):re==="raster"&&F!=="raster"?u.push(new kt(T,p.source,`layer "${p.id}" requires a vector source`)):re!=="vector"||p["source-layer"]?re==="raster-dem"&&F!=="hillshade"?u.push(new kt(T,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):F!=="line"||!p.paint||!p.paint["line-gradient"]||re==="geojson"&&Z.lineMetrics||u.push(new kt(T,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new kt(T,p,`layer "${p.id}" must specify a "source-layer"`)):u.push(new kt(T,p.source,`source "${p.source}" not found`))}else u.push(new kt(T,p,'missing required property "source"'));return u=u.concat(as({key:T,value:p,valueSpec:z.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Zi({key:`${T}.type`,value:p.type,valueSpec:z.layer.type,style:f.style,styleSpec:f.styleSpec,object:p,objectKey:"type"}),filter:_o,layout:Z=>as({layer:p,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>ja(yi({layerType:F},re))}}),paint:Z=>as({layer:p,key:Z.key,value:Z.value,style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{"*":re=>Cl(yi({layerType:F},re))}})}})),u}function As(f){const u=f.value,p=f.key,T=Qn(u);return T!=="string"?[new kt(p,u,`string expected, ${T} found`)]:[]}const dc={promoteId:function({key:f,value:u}){if(Qn(u)==="string")return As({key:f,value:u});{const p=[];for(const T in u)p.push(...As({key:`${f}.${T}`,value:u[T]}));return p}}};function pa(f){const u=f.value,p=f.key,T=f.styleSpec,D=f.style;if(!u.type)return[new kt(p,u,'"type" is required')];const z=Bn(u.type);let F;switch(z){case"vector":case"raster":case"raster-dem":return F=as({key:p,value:u,valueSpec:T[`source_${z.replace("-","_")}`],style:f.style,styleSpec:T,objectElementValidators:dc}),F;case"geojson":if(F=as({key:p,value:u,valueSpec:T.source_geojson,style:D,styleSpec:T,objectElementValidators:dc}),u.cluster)for(const $ in u.clusterProperties){const[Z,re]=u.clusterProperties[$],Ae=typeof Z=="string"?[Z,["accumulated"],["get",$]]:Z;F.push(...Wr({key:`${p}.${$}.map`,value:re,expressionContext:"cluster-map"})),F.push(...Wr({key:`${p}.${$}.reduce`,value:Ae,expressionContext:"cluster-reduce"}))}return F;case"video":return as({key:p,value:u,valueSpec:T.source_video,style:D,styleSpec:T});case"image":return as({key:p,value:u,valueSpec:T.source_image,style:D,styleSpec:T});case"canvas":return[new kt(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ir({key:`${p}.type`,value:u.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:D,styleSpec:T})}}function Ha(f){const u=f.value,p=f.styleSpec,T=p.light,D=f.style;let z=[];const F=Qn(u);if(u===void 0)return z;if(F!=="object")return z=z.concat([new kt("light",u,`object expected, ${F} found`)]),z;for(const $ in u){const Z=$.match(/^(.*)-transition$/);z=z.concat(Z&&T[Z[1]]&&T[Z[1]].transition?Zi({key:$,value:u[$],valueSpec:p.transition,style:D,styleSpec:p}):T[$]?Zi({key:$,value:u[$],valueSpec:T[$],style:D,styleSpec:p}):[new kt($,u[$],`unknown property "${$}"`)])}return z}function ni(f){const u=f.value,p=f.styleSpec,T=p.terrain,D=f.style;let z=[];const F=Qn(u);if(u===void 0)return z;if(F!=="object")return z=z.concat([new kt("terrain",u,`object expected, ${F} found`)]),z;for(const $ in u)z=z.concat(T[$]?Zi({key:$,value:u[$],valueSpec:T[$],style:D,styleSpec:p}):[new kt($,u[$],`unknown property "${$}"`)]);return z}const Es={"*":()=>[],array:ru,boolean:function(f){const u=f.value,p=f.key,T=Qn(u);return T!=="boolean"?[new kt(p,u,`boolean expected, ${T} found`)]:[]},number:Ml,color:function(f){const u=f.key,p=f.value,T=Qn(p);return T!=="string"?[new kt(u,p,`color expected, ${T} found`)]:os(p)===null?[new kt(u,p,`color expected, "${p}" found`)]:[]},constants:Bs,enum:Ir,filter:_o,function:hc,layer:Vs,object:as,source:pa,light:Ha,terrain:ni,string:As,formatted:function(f){return As(f).length===0?[]:Wr(f)},resolvedImage:function(f){return As(f).length===0?[]:Wr(f)},padding:function(f){const u=f.key,p=f.value;if(Qn(p)==="array"){if(p.length<1||p.length>4)return[new kt(u,p,`padding requires 1 to 4 values; ${p.length} values found`)];const T={type:"number"};let D=[];for(let z=0;z<p.length;z++)D=D.concat(Zi({key:`${u}[${z}]`,value:p[z],valueSpec:T}));return D}return Ml({key:u,value:p,valueSpec:{}})}};function Zi(f){const u=f.value,p=f.valueSpec,T=f.styleSpec;return p.expression&&_r(Bn(u))?hc(f):p.expression&&El(Ni(u))?Wr(f):p.type&&Es[p.type]?Es[p.type](f):as(yi({},f,{valueSpec:p.type?T[p.type]:p}))}function Pl(f){const u=f.value,p=f.key,T=As(f);return T.length||(u.indexOf("{fontstack}")===-1&&T.push(new kt(p,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&T.push(new kt(p,u,'"glyphs" url must include a "{range}" token'))),T}function Ho(f,u=ct){let p=[];return p=p.concat(Zi({key:"",value:f,valueSpec:u.$root,styleSpec:u,style:f,objectElementValidators:{glyphs:Pl,"*":()=>[]}})),f.constants&&(p=p.concat(Bs({key:"constants",value:f.constants,style:f,styleSpec:u}))),pc(p)}function pc(f){return[].concat(f).sort((u,p)=>u.line-p.line)}function vo(f){return function(...u){return pc(f.apply(this,u))}}Ho.source=vo(pa),Ho.light=vo(Ha),Ho.terrain=vo(ni),Ho.layer=vo(Vs),Ho.filter=vo(_o),Ho.paintProperty=vo(Cl),Ho.layoutProperty=vo(ja);const Il=Ho,Wa=Il.light,gh=Il.paintProperty,mh=Il.layoutProperty;function Qa(f,u){let p=!1;if(u&&u.length)for(const T of u)f.fire(new Oo(new Error(T.message))),p=!0;return p}class ga{constructor(u,p,T){const D=this.cells=[];if(u instanceof ArrayBuffer){this.arrayBuffer=u;const F=new Int32Array(this.arrayBuffer);u=F[0],this.d=(p=F[1])+2*(T=F[2]);for(let Z=0;Z<this.d*this.d;Z++){const re=F[3+Z],Ae=F[3+Z+1];D.push(re===Ae?null:F.subarray(re,Ae))}const $=F[3+D.length+1];this.keys=F.subarray(F[3+D.length],$),this.bboxes=F.subarray($),this.insert=this._insertReadonly}else{this.d=p+2*T;for(let F=0;F<this.d*this.d;F++)D.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=u,this.padding=T,this.scale=p/u,this.uid=0;const z=T/p*u;this.min=-z,this.max=u+z}insert(u,p,T,D,z){this._forEachCell(p,T,D,z,this._insertCell,this.uid++,void 0,void 0),this.keys.push(u),this.bboxes.push(p),this.bboxes.push(T),this.bboxes.push(D),this.bboxes.push(z)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(u,p,T,D,z,F){this.cells[z].push(F)}query(u,p,T,D,z){const F=this.min,$=this.max;if(u<=F&&p<=F&&$<=T&&$<=D&&!z)return Array.prototype.slice.call(this.keys);{const Z=[];return this._forEachCell(u,p,T,D,this._queryCell,Z,{},z),Z}}_queryCell(u,p,T,D,z,F,$,Z){const re=this.cells[z];if(re!==null){const Ae=this.keys,ce=this.bboxes;for(let pe=0;pe<re.length;pe++){const ye=re[pe];if($[ye]===void 0){const _e=4*ye;(Z?Z(ce[_e+0],ce[_e+1],ce[_e+2],ce[_e+3]):u<=ce[_e+2]&&p<=ce[_e+3]&&T>=ce[_e+0]&&D>=ce[_e+1])?($[ye]=!0,F.push(Ae[ye])):$[ye]=!1}}}}_forEachCell(u,p,T,D,z,F,$,Z){const re=this._convertToCellCoord(u),Ae=this._convertToCellCoord(p),ce=this._convertToCellCoord(T),pe=this._convertToCellCoord(D);for(let ye=re;ye<=ce;ye++)for(let _e=Ae;_e<=pe;_e++){const Ue=this.d*_e+ye;if((!Z||Z(this._convertFromCellCoord(ye),this._convertFromCellCoord(_e),this._convertFromCellCoord(ye+1),this._convertFromCellCoord(_e+1)))&&z.call(this,u,p,T,D,Ue,F,$,Z))return}}_convertFromCellCoord(u){return(u-this.padding)/this.scale}_convertToCellCoord(u){return Math.max(0,Math.min(this.d-1,Math.floor(u*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const u=this.cells,p=3+this.cells.length+1+1;let T=0;for(let F=0;F<this.cells.length;F++)T+=this.cells[F].length;const D=new Int32Array(p+T+this.keys.length+this.bboxes.length);D[0]=this.extent,D[1]=this.n,D[2]=this.padding;let z=p;for(let F=0;F<u.length;F++){const $=u[F];D[3+F]=z,D.set($,z),z+=$.length}return D[3+u.length]=z,D.set(this.keys,z),z+=this.keys.length,D[3+u.length+1]=z,D.set(this.bboxes,z),z+=this.bboxes.length,D.buffer}static serialize(u,p){const T=u.toArrayBuffer();return p&&p.push(T),{buffer:T}}static deserialize(u){return new ga(u.buffer)}}const us={};function Nt(f,u,p={}){if(us[f])throw new Error(`${f} is already registered.`);Object.defineProperty(u,"_classRegistryKey",{value:f,writeable:!1}),us[f]={klass:u,omit:p.omit||[],shallow:p.shallow||[]}}Nt("Object",Object),Nt("TransferableGridIndex",ga),Nt("Color",a),Nt("Error",Error),Nt("AJAXError",er),Nt("ResolvedImage",ke),Nt("StylePropertyFunction",dr),Nt("StyleExpression",Ns,{omit:["_evaluator"]}),Nt("ZoomDependentExpression",Tl),Nt("ZoomConstantExpression",fa),Nt("CompoundExpression",Ft,{omit:["_evaluate"]});for(const f in Ua)Ua[f]._classRegistryKey||Nt(`Expression_${f}`,Ua[f]);function su(f){return f&&typeof ArrayBuffer<"u"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function ma(f,u){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob)return f;if(su(f)||mt(f))return u&&u.push(f),f;if(ArrayBuffer.isView(f)){const p=f;return u&&u.push(p.buffer),p}if(f instanceof ImageData)return u&&u.push(f.data.buffer),f;if(Array.isArray(f)){const p=[];for(const T of f)p.push(ma(T,u));return p}if(typeof f=="object"){const p=f.constructor,T=p._classRegistryKey;if(!T)throw new Error("can't serialize object of unregistered class");if(!us[T])throw new Error(`${T} is not registered.`);const D=p.serialize?p.serialize(f,u):{};if(p.serialize){if(u&&D===u[u.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const z in f){if(!f.hasOwnProperty(z)||us[T].omit.indexOf(z)>=0)continue;const F=f[z];D[z]=us[T].shallow.indexOf(z)>=0?F:ma(F,u)}f instanceof Error&&(D.message=f.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return T!=="Object"&&(D.$name=T),D}throw new Error("can't serialize object of type "+typeof f)}function Wo(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||f instanceof Blob||su(f)||mt(f)||ArrayBuffer.isView(f)||f instanceof ImageData)return f;if(Array.isArray(f))return f.map(Wo);if(typeof f=="object"){const u=f.$name||"Object";if(!us[u])throw new Error(`can't deserialize unregistered class ${u}`);const{klass:p}=us[u];if(!p)throw new Error(`can't deserialize unregistered class ${u}`);if(p.deserialize)return p.deserialize(f);const T=Object.create(p.prototype);for(const D of Object.keys(f)){if(D==="$name")continue;const z=f[D];T[D]=us[u].shallow.indexOf(D)>=0?z:Wo(z)}return T}throw new Error("can't deserialize object of type "+typeof f)}class ou{constructor(){this.first=!0}update(u,p){const T=Math.floor(u);return this.first?(this.first=!1,this.lastIntegerZoom=T,this.lastIntegerZoomTime=0,this.lastZoom=u,this.lastFloorZoom=T,!0):(this.lastFloorZoom>T?(this.lastIntegerZoom=T+1,this.lastIntegerZoomTime=p):this.lastFloorZoom<T&&(this.lastIntegerZoom=T,this.lastIntegerZoomTime=p),u!==this.lastZoom&&(this.lastZoom=u,this.lastFloorZoom=T,!0))}}const Vt={"Latin-1 Supplement":f=>f>=128&&f<=255,Arabic:f=>f>=1536&&f<=1791,"Arabic Supplement":f=>f>=1872&&f<=1919,"Arabic Extended-A":f=>f>=2208&&f<=2303,"Hangul Jamo":f=>f>=4352&&f<=4607,"Unified Canadian Aboriginal Syllabics":f=>f>=5120&&f<=5759,Khmer:f=>f>=6016&&f<=6143,"Unified Canadian Aboriginal Syllabics Extended":f=>f>=6320&&f<=6399,"General Punctuation":f=>f>=8192&&f<=8303,"Letterlike Symbols":f=>f>=8448&&f<=8527,"Number Forms":f=>f>=8528&&f<=8591,"Miscellaneous Technical":f=>f>=8960&&f<=9215,"Control Pictures":f=>f>=9216&&f<=9279,"Optical Character Recognition":f=>f>=9280&&f<=9311,"Enclosed Alphanumerics":f=>f>=9312&&f<=9471,"Geometric Shapes":f=>f>=9632&&f<=9727,"Miscellaneous Symbols":f=>f>=9728&&f<=9983,"Miscellaneous Symbols and Arrows":f=>f>=11008&&f<=11263,"CJK Radicals Supplement":f=>f>=11904&&f<=12031,"Kangxi Radicals":f=>f>=12032&&f<=12255,"Ideographic Description Characters":f=>f>=12272&&f<=12287,"CJK Symbols and Punctuation":f=>f>=12288&&f<=12351,Hiragana:f=>f>=12352&&f<=12447,Katakana:f=>f>=12448&&f<=12543,Bopomofo:f=>f>=12544&&f<=12591,"Hangul Compatibility Jamo":f=>f>=12592&&f<=12687,Kanbun:f=>f>=12688&&f<=12703,"Bopomofo Extended":f=>f>=12704&&f<=12735,"CJK Strokes":f=>f>=12736&&f<=12783,"Katakana Phonetic Extensions":f=>f>=12784&&f<=12799,"Enclosed CJK Letters and Months":f=>f>=12800&&f<=13055,"CJK Compatibility":f=>f>=13056&&f<=13311,"CJK Unified Ideographs Extension A":f=>f>=13312&&f<=19903,"Yijing Hexagram Symbols":f=>f>=19904&&f<=19967,"CJK Unified Ideographs":f=>f>=19968&&f<=40959,"Yi Syllables":f=>f>=40960&&f<=42127,"Yi Radicals":f=>f>=42128&&f<=42191,"Hangul Jamo Extended-A":f=>f>=43360&&f<=43391,"Hangul Syllables":f=>f>=44032&&f<=55215,"Hangul Jamo Extended-B":f=>f>=55216&&f<=55295,"Private Use Area":f=>f>=57344&&f<=63743,"CJK Compatibility Ideographs":f=>f>=63744&&f<=64255,"Arabic Presentation Forms-A":f=>f>=64336&&f<=65023,"Vertical Forms":f=>f>=65040&&f<=65055,"CJK Compatibility Forms":f=>f>=65072&&f<=65103,"Small Form Variants":f=>f>=65104&&f<=65135,"Arabic Presentation Forms-B":f=>f>=65136&&f<=65279,"Halfwidth and Fullwidth Forms":f=>f>=65280&&f<=65519};function yA(f){for(const u of f)if(qa(u.charCodeAt(0)))return!0;return!1}function kl(f){for(const u of f)if(!_A(u.charCodeAt(0)))return!1;return!0}function _A(f){return!(Vt.Arabic(f)||Vt["Arabic Supplement"](f)||Vt["Arabic Extended-A"](f)||Vt["Arabic Presentation Forms-A"](f)||Vt["Arabic Presentation Forms-B"](f))}function qa(f){return!(f!==746&&f!==747&&(f<4352||!(Vt["Bopomofo Extended"](f)||Vt.Bopomofo(f)||Vt["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Vt["CJK Compatibility Ideographs"](f)||Vt["CJK Compatibility"](f)||Vt["CJK Radicals Supplement"](f)||Vt["CJK Strokes"](f)||!(!Vt["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Vt["CJK Unified Ideographs Extension A"](f)||Vt["CJK Unified Ideographs"](f)||Vt["Enclosed CJK Letters and Months"](f)||Vt["Hangul Compatibility Jamo"](f)||Vt["Hangul Jamo Extended-A"](f)||Vt["Hangul Jamo Extended-B"](f)||Vt["Hangul Jamo"](f)||Vt["Hangul Syllables"](f)||Vt.Hiragana(f)||Vt["Ideographic Description Characters"](f)||Vt.Kanbun(f)||Vt["Kangxi Radicals"](f)||Vt["Katakana Phonetic Extensions"](f)||Vt.Katakana(f)&&f!==12540||!(!Vt["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Vt["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Vt["Unified Canadian Aboriginal Syllabics"](f)||Vt["Unified Canadian Aboriginal Syllabics Extended"](f)||Vt["Vertical Forms"](f)||Vt["Yijing Hexagram Symbols"](f)||Vt["Yi Syllables"](f)||Vt["Yi Radicals"](f))))}function Gs(f){return!(qa(f)||function(u){return!!(Vt["Latin-1 Supplement"](u)&&(u===167||u===169||u===174||u===177||u===188||u===189||u===190||u===215||u===247)||Vt["General Punctuation"](u)&&(u===8214||u===8224||u===8225||u===8240||u===8241||u===8251||u===8252||u===8258||u===8263||u===8264||u===8265||u===8273)||Vt["Letterlike Symbols"](u)||Vt["Number Forms"](u)||Vt["Miscellaneous Technical"](u)&&(u>=8960&&u<=8967||u>=8972&&u<=8991||u>=8996&&u<=9e3||u===9003||u>=9085&&u<=9114||u>=9150&&u<=9165||u===9167||u>=9169&&u<=9179||u>=9186&&u<=9215)||Vt["Control Pictures"](u)&&u!==9251||Vt["Optical Character Recognition"](u)||Vt["Enclosed Alphanumerics"](u)||Vt["Geometric Shapes"](u)||Vt["Miscellaneous Symbols"](u)&&!(u>=9754&&u<=9759)||Vt["Miscellaneous Symbols and Arrows"](u)&&(u>=11026&&u<=11055||u>=11088&&u<=11097||u>=11192&&u<=11243)||Vt["CJK Symbols and Punctuation"](u)||Vt.Katakana(u)||Vt["Private Use Area"](u)||Vt["CJK Compatibility Forms"](u)||Vt["Small Form Variants"](u)||Vt["Halfwidth and Fullwidth Forms"](u)||u===8734||u===8756||u===8757||u>=9984&&u<=10087||u>=10102&&u<=10131||u===65532||u===65533)}(f))}function au(f){return f>=1424&&f<=2303||Vt["Arabic Presentation Forms-A"](f)||Vt["Arabic Presentation Forms-B"](f)}function yh(f,u){return!(!u&&au(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Vt.Khmer(f))}function gc(f){for(const u of f)if(au(u.charCodeAt(0)))return!0;return!1}const lu="deferred",Au="loading",uu="loaded";let $s=null,ki="unavailable",xo=null;const cu=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(ki="error"),$s&&$s(f)};function ya(){Br.fire(new Mi("pluginStateChange",{pluginStatus:ki,pluginURL:xo}))}const Br=new is,Ll=function(){return ki},mc=function(){if(ki!==lu||!xo)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ki=Au,ya(),xo&&tr({url:xo},f=>{f?cu(f):(ki=uu,ya())})},cs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ki===uu||cs.applyArabicShaping!=null,isLoading:()=>ki===Au,setState(f){if(!Qe())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");ki=f.pluginStatus,xo=f.pluginURL},isParsed(){if(!Qe())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return cs.applyArabicShaping!=null&&cs.processBidirectionalText!=null&&cs.processStyledBidirectionalText!=null},getPluginURL(){if(!Qe())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return xo}};class br{constructor(u,p){this.zoom=u,p?(this.now=p.now,this.fadeDuration=p.fadeDuration,this.zoomHistory=p.zoomHistory,this.transition=p.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ou,this.transition={})}isSupportedScript(u){return function(p,T){for(const D of p)if(!yh(D.charCodeAt(0),T))return!1;return!0}(u,cs.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const u=this.zoom,p=u-Math.floor(u),T=this.crossFadingFactor();return u>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:p+(1-p)*T}:{fromScale:.5,toScale:1,t:1-(1-T)*p}}}class Za{constructor(u,p){this.property=u,this.value=p,this.expression=function(T,D){if(_r(T))return new dr(T,D);if(El(T)){const z=Sl(T,D);if(z.result==="error")throw new Error(z.value.map(F=>`${F.key}: ${F.message}`).join(", "));return z.value}{let z=T;return D.type==="color"&&typeof T=="string"?z=a.parse(T):D.type!=="padding"||typeof T!="number"&&!Array.isArray(T)||(z=Pe.parse(T)),{kind:"constant",evaluate:()=>z}}}(p===void 0?u.specification.default:p,u.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(u,p,T){return this.property.possiblyEvaluate(this,u,p,T)}}class Dl{constructor(u){this.property=u,this.value=new Za(u,void 0)}transitioned(u,p){return new yc(this.property,this.value,p,H({},u.transition,this.transition),u.now)}untransitioned(){return new yc(this.property,this.value,null,{},0)}}class hu{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitionablePropertyValues)}getValue(u){return ie(this._values[u].value.value)}setValue(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Dl(this._values[u].property)),this._values[u].value=new Za(this._values[u].property,p===null?void 0:ie(p))}getTransition(u){return ie(this._values[u].transition)}setTransition(u,p){Object.prototype.hasOwnProperty.call(this._values,u)||(this._values[u]=new Dl(this._values[u].property)),this._values[u].transition=ie(p)||void 0}serialize(){const u={};for(const p of Object.keys(this._values)){const T=this.getValue(p);T!==void 0&&(u[p]=T);const D=this.getTransition(p);D!==void 0&&(u[`${p}-transition`]=D)}return u}transitioned(u,p){const T=new fu(this._properties);for(const D of Object.keys(this._values))T._values[D]=this._values[D].transitioned(u,p._values[D]);return T}untransitioned(){const u=new fu(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].untransitioned();return u}}class yc{constructor(u,p,T,D,z){this.property=u,this.value=p,this.begin=z+D.delay||0,this.end=this.begin+D.duration||0,u.specification.transition&&(D.delay||D.duration)&&(this.prior=T)}possiblyEvaluate(u,p,T){const D=u.now||0,z=this.value.possiblyEvaluate(u,p,T),F=this.prior;if(F){if(D>this.end)return this.prior=null,z;if(this.value.isDataDriven())return this.prior=null,z;if(D<this.begin)return F.possiblyEvaluate(u,p,T);{const $=(D-this.begin)/(this.end-this.begin);return this.property.interpolate(F.possiblyEvaluate(u,p,T),z,function(Z){if(Z<=0)return 0;if(Z>=1)return 1;const re=Z*Z,Ae=re*Z;return 4*(Z<.5?Ae:3*(Z-re)+Ae-.75)}($))}}return z}}class fu{constructor(u){this._properties=u,this._values=Object.create(u.defaultTransitioningPropertyValues)}possiblyEvaluate(u,p,T){const D=new Rl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,p,T);return D}hasTransition(){for(const u of Object.keys(this._values))if(this._values[u].prior)return!0;return!1}}class _c{constructor(u){this._properties=u,this._values=Object.create(u.defaultPropertyValues)}getValue(u){return ie(this._values[u].value)}setValue(u,p){this._values[u]=new Za(this._values[u].property,p===null?void 0:ie(p))}serialize(){const u={};for(const p of Object.keys(this._values)){const T=this.getValue(p);T!==void 0&&(u[p]=T)}return u}possiblyEvaluate(u,p,T){const D=new Rl(this._properties);for(const z of Object.keys(this._values))D._values[z]=this._values[z].possiblyEvaluate(u,p,T);return D}}class pr{constructor(u,p,T){this.property=u,this.value=p,this.parameters=T}isConstant(){return this.value.kind==="constant"}constantOr(u){return this.value.kind==="constant"?this.value.value:u}evaluate(u,p,T,D){return this.property.evaluate(this.value,this.parameters,u,p,T,D)}}class Rl{constructor(u){this._properties=u,this._values=Object.create(u.defaultPossiblyEvaluatedValues)}get(u){return this._values[u]}}class Yt{constructor(u){this.specification=u}possiblyEvaluate(u,p){if(u.isDataDriven())throw new Error("Value should not be data driven");return u.expression.evaluate(p)}interpolate(u,p,T){const D=Pr[this.specification.type];return D?D(u,p,T):u}}class Xt{constructor(u,p){this.specification=u,this.overrides=p}possiblyEvaluate(u,p,T,D){return new pr(this,u.expression.kind==="constant"||u.expression.kind==="camera"?{kind:"constant",value:u.expression.evaluate(p,null,{},T,D)}:u.expression,p)}interpolate(u,p,T){if(u.value.kind!=="constant"||p.value.kind!=="constant")return u;if(u.value.value===void 0||p.value.value===void 0)return new pr(this,{kind:"constant",value:void 0},u.parameters);const D=Pr[this.specification.type];return D?new pr(this,{kind:"constant",value:D(u.value.value,p.value.value,T)},u.parameters):u}evaluate(u,p,T,D,z,F){return u.kind==="constant"?u.value:u.evaluate(p,T,D,z,F)}}class hn extends Xt{possiblyEvaluate(u,p,T,D){if(u.value===void 0)return new pr(this,{kind:"constant",value:void 0},p);if(u.expression.kind==="constant"){const z=u.expression.evaluate(p,null,{},T,D),F=u.property.specification.type==="resolvedImage"&&typeof z!="string"?z.name:z,$=this._calculate(F,F,F,p);return new pr(this,{kind:"constant",value:$},p)}if(u.expression.kind==="camera"){const z=this._calculate(u.expression.evaluate({zoom:p.zoom-1}),u.expression.evaluate({zoom:p.zoom}),u.expression.evaluate({zoom:p.zoom+1}),p);return new pr(this,{kind:"constant",value:z},p)}return new pr(this,u.expression,p)}evaluate(u,p,T,D,z,F){if(u.kind==="source"){const $=u.evaluate(p,T,D,z,F);return this._calculate($,$,$,p)}return u.kind==="composite"?this._calculate(u.evaluate({zoom:Math.floor(p.zoom)-1},T,D),u.evaluate({zoom:Math.floor(p.zoom)},T,D),u.evaluate({zoom:Math.floor(p.zoom)+1},T,D),p):u.value}_calculate(u,p,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:T,to:p}}interpolate(u){return u}}class Yi{constructor(u){this.specification=u}possiblyEvaluate(u,p,T,D){if(u.value!==void 0){if(u.expression.kind==="constant"){const z=u.expression.evaluate(p,null,{},T,D);return this._calculate(z,z,z,p)}return this._calculate(u.expression.evaluate(new br(Math.floor(p.zoom-1),p)),u.expression.evaluate(new br(Math.floor(p.zoom),p)),u.expression.evaluate(new br(Math.floor(p.zoom+1),p)),p)}}_calculate(u,p,T,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:u,to:p}:{from:T,to:p}}interpolate(u){return u}}class Qo{constructor(u){this.specification=u}possiblyEvaluate(u,p,T,D){return!!u.expression.evaluate(p,null,{},T,D)}interpolate(){return!1}}class Nr{constructor(u){this.properties=u,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const p in u){const T=u[p];T.specification.overridable&&this.overridableProperties.push(p);const D=this.defaultPropertyValues[p]=new Za(T,void 0),z=this.defaultTransitionablePropertyValues[p]=new Dl(T);this.defaultTransitioningPropertyValues[p]=z.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=D.possiblyEvaluate({})}}}Nt("DataDrivenProperty",Xt),Nt("DataConstantProperty",Yt),Nt("CrossFadedDataDrivenProperty",hn),Nt("CrossFadedProperty",Yi),Nt("ColorRampProperty",Qo);const js="-transition";class Ts extends is{constructor(u,p){if(super(),this.id=u.id,this.type=u.type,this._featureFilter={filter:()=>!0,needGeometry:!1},u.type!=="custom"&&(this.metadata=u.metadata,this.minzoom=u.minzoom,this.maxzoom=u.maxzoom,u.type!=="background"&&(this.source=u.source,this.sourceLayer=u["source-layer"],this.filter=u.filter),p.layout&&(this._unevaluatedLayout=new _c(p.layout)),p.paint)){this._transitionablePaint=new hu(p.paint);for(const T in u.paint)this.setPaintProperty(T,u.paint[T],{validate:!1});for(const T in u.layout)this.setLayoutProperty(T,u.layout[T],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Rl(p.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(u){return u==="visibility"?this.visibility:this._unevaluatedLayout.getValue(u)}setLayoutProperty(u,p,T={}){p!=null&&this._validate(mh,`layers.${this.id}.layout.${u}`,u,p,T)||(u!=="visibility"?this._unevaluatedLayout.setValue(u,p):this.visibility=p)}getPaintProperty(u){return u.endsWith(js)?this._transitionablePaint.getTransition(u.slice(0,-js.length)):this._transitionablePaint.getValue(u)}setPaintProperty(u,p,T={}){if(p!=null&&this._validate(gh,`layers.${this.id}.paint.${u}`,u,p,T))return!1;if(u.endsWith(js))return this._transitionablePaint.setTransition(u.slice(0,-js.length),p||void 0),!1;{const D=this._transitionablePaint._values[u],z=D.property.specification["property-type"]==="cross-faded-data-driven",F=D.value.isDataDriven(),$=D.value;this._transitionablePaint.setValue(u,p),this._handleSpecialPaintPropertyUpdate(u);const Z=this._transitionablePaint._values[u].value;return Z.isDataDriven()||F||z||this._handleOverridablePaintPropertyUpdate(u,$,Z)}}_handleSpecialPaintPropertyUpdate(u){}_handleOverridablePaintPropertyUpdate(u,p,T){return!1}isHidden(u){return!!(this.minzoom&&u<this.minzoom)||!!(this.maxzoom&&u>=this.maxzoom)||this.visibility==="none"}updateTransitions(u){this._transitioningPaint=this._transitionablePaint.transitioned(u,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(u,p){u.getCrossfadeParameters&&(this._crossfadeParameters=u.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(u,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(u,void 0,p)}serialize(){const u={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(u.layout=u.layout||{},u.layout.visibility=this.visibility),te(u,(p,T)=>!(p===void 0||T==="layout"&&!Object.keys(p).length||T==="paint"&&!Object.keys(p).length))}_validate(u,p,T,D,z={}){return(!z||z.validate!==!1)&&Qa(this,u.call(Il,{key:p,layerType:this.type,objectKey:T,value:D,styleSpec:ct,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const u in this.paint._values){const p=this.paint.get(u);if(p instanceof pr&&cr(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1}}const Hs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Mt{constructor(u,p){this._structArray=u,this._pos1=p*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(u,p){return u._trim(),p&&(u.isTransferred=!0,p.push(u.arrayBuffer)),{length:u.length,arrayBuffer:u.arrayBuffer}}static deserialize(u){const p=Object.create(this.prototype);return p.arrayBuffer=u.arrayBuffer,p.length=u.length,p.capacity=u.arrayBuffer.byteLength/p.bytesPerElement,p._refreshViews(),p}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(u){this.reserve(u),this.length=u}reserve(u){if(u>this.capacity){this.capacity=Math.max(u,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const p=this.uint8;this._refreshViews(),p&&this.uint8.set(p)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ur(f,u=1){let p=0,T=0;return{members:f.map(D=>{const z=Hs[D.type].BYTES_PER_ELEMENT,F=p=Ya(p,Math.max(u,z)),$=D.components||1;return T=Math.max(T,z),p+=z*$,{name:D.name,type:D.type,components:$,offset:F}}),size:Ya(p,Math.max(T,u)),alignment:u}}function Ya(f,u){return Math.ceil(f/u)*u}class Ws extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p){const T=this.length;return this.resize(T+1),this.emplace(T,u,p)}emplace(u,p,T){const D=2*u;return this.int16[D+0]=p,this.int16[D+1]=T,u}}Ws.prototype.bytesPerElement=4,Nt("StructArrayLayout2i4",Ws);class L extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,p,T,D)}emplace(u,p,T,D,z){const F=4*u;return this.int16[F+0]=p,this.int16[F+1]=T,this.int16[F+2]=D,this.int16[F+3]=z,u}}L.prototype.bytesPerElement=8,Nt("StructArrayLayout4i8",L);class c extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F){const $=this.length;return this.resize($+1),this.emplace($,u,p,T,D,z,F)}emplace(u,p,T,D,z,F,$){const Z=6*u;return this.int16[Z+0]=p,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=F,this.int16[Z+5]=$,u}}c.prototype.bytesPerElement=12,Nt("StructArrayLayout2i4i12",c);class _ extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F){const $=this.length;return this.resize($+1),this.emplace($,u,p,T,D,z,F)}emplace(u,p,T,D,z,F,$){const Z=4*u,re=8*u;return this.int16[Z+0]=p,this.int16[Z+1]=T,this.uint8[re+4]=D,this.uint8[re+5]=z,this.uint8[re+6]=F,this.uint8[re+7]=$,u}}_.prototype.bytesPerElement=8,Nt("StructArrayLayout2i4ub8",_);class l extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p){const T=this.length;return this.resize(T+1),this.emplace(T,u,p)}emplace(u,p,T){const D=2*u;return this.float32[D+0]=p,this.float32[D+1]=T,u}}l.prototype.bytesPerElement=8,Nt("StructArrayLayout2f8",l);class h extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,$,Z,re,Ae){const ce=this.length;return this.resize(ce+1),this.emplace(ce,u,p,T,D,z,F,$,Z,re,Ae)}emplace(u,p,T,D,z,F,$,Z,re,Ae,ce){const pe=10*u;return this.uint16[pe+0]=p,this.uint16[pe+1]=T,this.uint16[pe+2]=D,this.uint16[pe+3]=z,this.uint16[pe+4]=F,this.uint16[pe+5]=$,this.uint16[pe+6]=Z,this.uint16[pe+7]=re,this.uint16[pe+8]=Ae,this.uint16[pe+9]=ce,u}}h.prototype.bytesPerElement=20,Nt("StructArrayLayout10ui20",h);class d extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,$,Z,re,Ae,ce,pe){const ye=this.length;return this.resize(ye+1),this.emplace(ye,u,p,T,D,z,F,$,Z,re,Ae,ce,pe)}emplace(u,p,T,D,z,F,$,Z,re,Ae,ce,pe,ye){const _e=12*u;return this.int16[_e+0]=p,this.int16[_e+1]=T,this.int16[_e+2]=D,this.int16[_e+3]=z,this.uint16[_e+4]=F,this.uint16[_e+5]=$,this.uint16[_e+6]=Z,this.uint16[_e+7]=re,this.int16[_e+8]=Ae,this.int16[_e+9]=ce,this.int16[_e+10]=pe,this.int16[_e+11]=ye,u}}d.prototype.bytesPerElement=24,Nt("StructArrayLayout4i4ui4i24",d);class x extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,p,T)}emplace(u,p,T,D){const z=3*u;return this.float32[z+0]=p,this.float32[z+1]=T,this.float32[z+2]=D,u}}x.prototype.bytesPerElement=12,Nt("StructArrayLayout3f12",x);class b extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint32[1*u+0]=p,u}}b.prototype.bytesPerElement=4,Nt("StructArrayLayout1ul4",b);class S extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,$,Z,re){const Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,u,p,T,D,z,F,$,Z,re)}emplace(u,p,T,D,z,F,$,Z,re,Ae){const ce=10*u,pe=5*u;return this.int16[ce+0]=p,this.int16[ce+1]=T,this.int16[ce+2]=D,this.int16[ce+3]=z,this.int16[ce+4]=F,this.int16[ce+5]=$,this.uint32[pe+3]=Z,this.uint16[ce+8]=re,this.uint16[ce+9]=Ae,u}}S.prototype.bytesPerElement=20,Nt("StructArrayLayout6i1ul2ui20",S);class M extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F){const $=this.length;return this.resize($+1),this.emplace($,u,p,T,D,z,F)}emplace(u,p,T,D,z,F,$){const Z=6*u;return this.int16[Z+0]=p,this.int16[Z+1]=T,this.int16[Z+2]=D,this.int16[Z+3]=z,this.int16[Z+4]=F,this.int16[Z+5]=$,u}}M.prototype.bytesPerElement=12,Nt("StructArrayLayout2i2i2i12",M);class B extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z){const F=this.length;return this.resize(F+1),this.emplace(F,u,p,T,D,z)}emplace(u,p,T,D,z,F){const $=4*u,Z=8*u;return this.float32[$+0]=p,this.float32[$+1]=T,this.float32[$+2]=D,this.int16[Z+6]=z,this.int16[Z+7]=F,u}}B.prototype.bytesPerElement=16,Nt("StructArrayLayout2f1f2i16",B);class V extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,p,T,D)}emplace(u,p,T,D,z){const F=12*u,$=3*u;return this.uint8[F+0]=p,this.uint8[F+1]=T,this.float32[$+1]=D,this.float32[$+2]=z,u}}V.prototype.bytesPerElement=12,Nt("StructArrayLayout2ub2f12",V);class j extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,p,T)}emplace(u,p,T,D){const z=3*u;return this.uint16[z+0]=p,this.uint16[z+1]=T,this.uint16[z+2]=D,u}}j.prototype.bytesPerElement=6,Nt("StructArrayLayout3ui6",j);class Y extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ue,ze,tt){const At=this.length;return this.resize(At+1),this.emplace(At,u,p,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ue,ze,tt)}emplace(u,p,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ue,ze,tt,At){const et=24*u,ot=12*u,gt=48*u;return this.int16[et+0]=p,this.int16[et+1]=T,this.uint16[et+2]=D,this.uint16[et+3]=z,this.uint32[ot+2]=F,this.uint32[ot+3]=$,this.uint32[ot+4]=Z,this.uint16[et+10]=re,this.uint16[et+11]=Ae,this.uint16[et+12]=ce,this.float32[ot+7]=pe,this.float32[ot+8]=ye,this.uint8[gt+36]=_e,this.uint8[gt+37]=Ue,this.uint8[gt+38]=ze,this.uint32[ot+10]=tt,this.int16[et+22]=At,u}}Y.prototype.bytesPerElement=48,Nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Y);class ae extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ue,ze,tt,At,et,ot,gt,pt,Zt,tn,Ht,Ut,Ot,Wt){const $t=this.length;return this.resize($t+1),this.emplace($t,u,p,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ue,ze,tt,At,et,ot,gt,pt,Zt,tn,Ht,Ut,Ot,Wt)}emplace(u,p,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ue,ze,tt,At,et,ot,gt,pt,Zt,tn,Ht,Ut,Ot,Wt,$t){const St=34*u,gn=17*u;return this.int16[St+0]=p,this.int16[St+1]=T,this.int16[St+2]=D,this.int16[St+3]=z,this.int16[St+4]=F,this.int16[St+5]=$,this.int16[St+6]=Z,this.int16[St+7]=re,this.uint16[St+8]=Ae,this.uint16[St+9]=ce,this.uint16[St+10]=pe,this.uint16[St+11]=ye,this.uint16[St+12]=_e,this.uint16[St+13]=Ue,this.uint16[St+14]=ze,this.uint16[St+15]=tt,this.uint16[St+16]=At,this.uint16[St+17]=et,this.uint16[St+18]=ot,this.uint16[St+19]=gt,this.uint16[St+20]=pt,this.uint16[St+21]=Zt,this.uint16[St+22]=tn,this.uint32[gn+12]=Ht,this.float32[gn+13]=Ut,this.float32[gn+14]=Ot,this.float32[gn+15]=Wt,this.float32[gn+16]=$t,u}}ae.prototype.bytesPerElement=68,Nt("StructArrayLayout8i15ui1ul4f68",ae);class ne extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.float32[1*u+0]=p,u}}ne.prototype.bytesPerElement=4,Nt("StructArrayLayout1f4",ne);class ue extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(u,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,p,T)}emplace(u,p,T,D){const z=3*u;return this.int16[z+0]=p,this.int16[z+1]=T,this.int16[z+2]=D,u}}ue.prototype.bytesPerElement=6,Nt("StructArrayLayout3i6",ue);class be extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p,T){const D=this.length;return this.resize(D+1),this.emplace(D,u,p,T)}emplace(u,p,T,D){const z=4*u;return this.uint32[2*u+0]=p,this.uint16[z+2]=T,this.uint16[z+3]=D,u}}be.prototype.bytesPerElement=8,Nt("StructArrayLayout1ul2ui8",be);class Ce extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u,p){const T=this.length;return this.resize(T+1),this.emplace(T,u,p)}emplace(u,p,T){const D=2*u;return this.uint16[D+0]=p,this.uint16[D+1]=T,u}}Ce.prototype.bytesPerElement=4,Nt("StructArrayLayout2ui4",Ce);class ve extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(u){const p=this.length;return this.resize(p+1),this.emplace(p,u)}emplace(u,p){return this.uint16[1*u+0]=p,u}}ve.prototype.bytesPerElement=2,Nt("StructArrayLayout1ui2",ve);class Ge extends Pt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(u,p,T,D){const z=this.length;return this.resize(z+1),this.emplace(z,u,p,T,D)}emplace(u,p,T,D,z){const F=4*u;return this.float32[F+0]=p,this.float32[F+1]=T,this.float32[F+2]=D,this.float32[F+3]=z,u}}Ge.prototype.bytesPerElement=16,Nt("StructArrayLayout4f16",Ge);class Te extends Mt{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Tt(this.anchorPointX,this.anchorPointY)}}Te.prototype.size=20;class Ve extends S{get(u){return new Te(this,u)}}Nt("CollisionBoxArray",Ve);class xe extends Mt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(u){this._structArray.uint8[this._pos1+37]=u}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(u){this._structArray.uint8[this._pos1+38]=u}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(u){this._structArray.uint32[this._pos4+10]=u}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}xe.prototype.size=48;class y extends Y{get(u){return new xe(this,u)}}Nt("PlacedSymbolArray",y);class m extends Mt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(u){this._structArray.uint32[this._pos4+12]=u}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}m.prototype.size=68;class v extends ae{get(u){return new m(this,u)}}Nt("SymbolInstanceArray",v);class E extends ne{getoffsetX(u){return this.float32[1*u+0]}}Nt("GlyphOffsetArray",E);class P extends ue{getx(u){return this.int16[3*u+0]}gety(u){return this.int16[3*u+1]}gettileUnitDistanceFromAnchor(u){return this.int16[3*u+2]}}Nt("SymbolLineVertexArray",P);class R extends Mt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}R.prototype.size=8;class O extends be{get(u){return new R(this,u)}}Nt("FeatureIndexArray",O);class N extends Ws{}class Q extends Ws{}class J extends Ws{}class le extends c{}class de extends _{}class Re extends l{}class $e extends h{}class Be extends d{}class Xe extends x{}class ht extends b{}class ut extends M{}class it extends V{}class st extends j{}class Je extends Ce{}const Gt=Ur([{name:"a_pos",components:2,type:"Int16"}],4),{members:zt}=Gt;class dt{constructor(u=[]){this.segments=u}prepareSegment(u,p,T,D){let z=this.segments[this.segments.length-1];return u>dt.MAX_VERTEX_ARRAY_LENGTH&&me(`Max vertices per segment is ${dt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${u}`),(!z||z.vertexLength+u>dt.MAX_VERTEX_ARRAY_LENGTH||z.sortKey!==D)&&(z={vertexOffset:p.length,primitiveOffset:T.length,vertexLength:0,primitiveLength:0},D!==void 0&&(z.sortKey=D),this.segments.push(z)),z}get(){return this.segments}destroy(){for(const u of this.segments)for(const p in u.vaos)u.vaos[p].destroy()}static simpleSegment(u,p,T,D){return new dt([{vertexOffset:u,primitiveOffset:p,vertexLength:T,primitiveLength:D,vaos:{},sortKey:0}])}}function vt(f,u){return 256*(f=k(Math.floor(f),0,255))+k(Math.floor(u),0,255)}dt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nt("SegmentVector",dt);const Pn=Ur([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var wn={exports:{}},mn={exports:{}};mn.exports=function(f,u){var p,T,D,z,F,$,Z,re;for(T=f.length-(p=3&f.length),D=u,F=3432918353,$=461845907,re=0;re<T;)Z=255&f.charCodeAt(re)|(255&f.charCodeAt(++re))<<8|(255&f.charCodeAt(++re))<<16|(255&f.charCodeAt(++re))<<24,++re,D=27492+(65535&(z=5*(65535&(D=(D^=Z=(65535&(Z=(Z=(65535&Z)*F+(((Z>>>16)*F&65535)<<16)&4294967295)<<15|Z>>>17))*$+(((Z>>>16)*$&65535)<<16)&4294967295)<<13|D>>>19))+((5*(D>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(Z=0,p){case 3:Z^=(255&f.charCodeAt(re+2))<<16;case 2:Z^=(255&f.charCodeAt(re+1))<<8;case 1:D^=Z=(65535&(Z=(Z=(65535&(Z^=255&f.charCodeAt(re)))*F+(((Z>>>16)*F&65535)<<16)&4294967295)<<15|Z>>>17))*$+(((Z>>>16)*$&65535)<<16)&4294967295}return D^=f.length,D=2246822507*(65535&(D^=D>>>16))+((2246822507*(D>>>16)&65535)<<16)&4294967295,D=3266489909*(65535&(D^=D>>>13))+((3266489909*(D>>>16)&65535)<<16)&4294967295,(D^=D>>>16)>>>0};var _n={exports:{}};_n.exports=function(f,u){for(var p,T=f.length,D=u^T,z=0;T>=4;)p=1540483477*(65535&(p=255&f.charCodeAt(z)|(255&f.charCodeAt(++z))<<8|(255&f.charCodeAt(++z))<<16|(255&f.charCodeAt(++z))<<24))+((1540483477*(p>>>16)&65535)<<16),D=1540483477*(65535&D)+((1540483477*(D>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),T-=4,++z;switch(T){case 3:D^=(255&f.charCodeAt(z+2))<<16;case 2:D^=(255&f.charCodeAt(z+1))<<8;case 1:D=1540483477*(65535&(D^=255&f.charCodeAt(z)))+((1540483477*(D>>>16)&65535)<<16)}return D=1540483477*(65535&(D^=D>>>13))+((1540483477*(D>>>16)&65535)<<16),(D^=D>>>15)>>>0};var En=mn.exports,Dn=_n.exports;wn.exports=En,wn.exports.murmur3=En,wn.exports.murmur2=Dn;class sr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(u,p,T,D){this.ids.push(In(u)),this.positions.push(p,T,D)}getPositions(u){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const p=In(u);let T=0,D=this.ids.length-1;for(;T<D;){const F=T+D>>1;this.ids[F]>=p?D=F:T=F+1}const z=[];for(;this.ids[T]===p;)z.push({index:this.positions[3*T],start:this.positions[3*T+1],end:this.positions[3*T+2]}),T++;return z}static serialize(u,p){const T=new Float64Array(u.ids),D=new Uint32Array(u.positions);return vr(T,D,0,T.length-1),p&&p.push(T.buffer,D.buffer),{ids:T,positions:D}}static deserialize(u){const p=new sr;return p.ids=u.ids,p.positions=u.positions,p.indexed=!0,p}}function In(f){const u=+f;return!isNaN(u)&&u<=Number.MAX_SAFE_INTEGER?u:wn.exports(String(f))}function vr(f,u,p,T){for(;p<T;){const D=f[p+T>>1];let z=p-1,F=T+1;for(;;){do z++;while(f[z]<D);do F--;while(f[F]>D);if(z>=F)break;Qr(f,z,F),Qr(u,3*z,3*F),Qr(u,3*z+1,3*F+1),Qr(u,3*z+2,3*F+2)}F-p<T-F?(vr(f,u,p,F),p=F+1):(vr(f,u,F+1,T),T=F)}}function Qr(f,u,p){const T=f[u];f[u]=f[p],f[p]=T}Nt("FeaturePositionMap",sr);class Xa{constructor(u,p){this.gl=u.gl,this.location=p}}class du extends Xa{constructor(u,p){super(u,p),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Df extends Xa{constructor(u,p){super(u,p),this.current=[0,0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3]))}}class g4 extends Xa{constructor(u,p){super(u,p),this.current=a.transparent}set(u){u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a))}}const v7=new Float32Array(16);function Sv(f){return[vt(255*f.r,255*f.g),vt(255*f.b,255*f.a)]}class Rd{constructor(u,p,T){this.value=u,this.uniformNames=p.map(D=>`u_${D}`),this.type=T}setUniform(u,p,T){u.set(T.constantOr(this.value))}getBinding(u,p,T){return this.type==="color"?new g4(u,p):new du(u,p)}}class Rf{constructor(u,p){this.uniformNames=p.map(T=>`u_${T}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(u,p){this.pixelRatioFrom=p.pixelRatio,this.pixelRatioTo=u.pixelRatio,this.patternFrom=p.tlbr,this.patternTo=u.tlbr}setUniform(u,p,T,D){const z=D==="u_pattern_to"?this.patternTo:D==="u_pattern_from"?this.patternFrom:D==="u_pixel_ratio_to"?this.pixelRatioTo:D==="u_pixel_ratio_from"?this.pixelRatioFrom:null;z&&u.set(z)}getBinding(u,p,T){return T.substr(0,9)==="u_pattern"?new Df(u,p):new du(u,p)}}class pu{constructor(u,p,T,D){this.expression=u,this.type=T,this.maxValue=0,this.paintVertexAttributes=p.map(z=>({name:`a_${z}`,type:"Float32",components:T==="color"?2:1,offset:0})),this.paintVertexArray=new D}populatePaintArray(u,p,T,D,z){const F=this.paintVertexArray.length,$=this.expression.evaluate(new br(0),p,{},D,[],z);this.paintVertexArray.resize(u),this._setPaintValue(F,u,$)}updatePaintArray(u,p,T,D){const z=this.expression.evaluate({zoom:0},T,D);this._setPaintValue(u,p,z)}_setPaintValue(u,p,T){if(this.type==="color"){const D=Sv(T);for(let z=u;z<p;z++)this.paintVertexArray.emplace(z,D[0],D[1])}else{for(let D=u;D<p;D++)this.paintVertexArray.emplace(D,T);this.maxValue=Math.max(this.maxValue,Math.abs(T))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bl{constructor(u,p,T,D,z,F){this.expression=u,this.uniformNames=p.map($=>`u_${$}_t`),this.type=T,this.useIntegerZoom=D,this.zoom=z,this.maxValue=0,this.paintVertexAttributes=p.map($=>({name:`a_${$}`,type:"Float32",components:T==="color"?4:2,offset:0})),this.paintVertexArray=new F}populatePaintArray(u,p,T,D,z){const F=this.expression.evaluate(new br(this.zoom),p,{},D,[],z),$=this.expression.evaluate(new br(this.zoom+1),p,{},D,[],z),Z=this.paintVertexArray.length;this.paintVertexArray.resize(u),this._setPaintValue(Z,u,F,$)}updatePaintArray(u,p,T,D){const z=this.expression.evaluate({zoom:this.zoom},T,D),F=this.expression.evaluate({zoom:this.zoom+1},T,D);this._setPaintValue(u,p,z,F)}_setPaintValue(u,p,T,D){if(this.type==="color"){const z=Sv(T),F=Sv(D);for(let $=u;$<p;$++)this.paintVertexArray.emplace($,z[0],z[1],F[0],F[1])}else{for(let z=u;z<p;z++)this.paintVertexArray.emplace(z,T,D);this.maxValue=Math.max(this.maxValue,Math.abs(T),Math.abs(D))}}upload(u){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=u.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(u,p){const T=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,D=k(this.expression.interpolationFactor(T,this.zoom,this.zoom+1),0,1);u.set(D)}getBinding(u,p,T){return new du(u,p)}}class vc{constructor(u,p,T,D,z,F){this.expression=u,this.type=p,this.useIntegerZoom=T,this.zoom=D,this.layerId=F,this.zoomInPaintVertexArray=new z,this.zoomOutPaintVertexArray=new z}populatePaintArray(u,p,T){const D=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(u),this.zoomOutPaintVertexArray.resize(u),this._setPaintValues(D,u,p.patterns&&p.patterns[this.layerId],T)}updatePaintArray(u,p,T,D,z){this._setPaintValues(u,p,T.patterns&&T.patterns[this.layerId],z)}_setPaintValues(u,p,T,D){if(!D||!T)return;const{min:z,mid:F,max:$}=T,Z=D[z],re=D[F],Ae=D[$];if(Z&&re&&Ae)for(let ce=u;ce<p;ce++)this.zoomInPaintVertexArray.emplace(ce,re.tl[0],re.tl[1],re.br[0],re.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],re.pixelRatio,Z.pixelRatio),this.zoomOutPaintVertexArray.emplace(ce,re.tl[0],re.tl[1],re.br[0],re.br[1],Ae.tl[0],Ae.tl[1],Ae.br[0],Ae.br[1],re.pixelRatio,Ae.pixelRatio)}upload(u){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=u.createVertexBuffer(this.zoomInPaintVertexArray,Pn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=u.createVertexBuffer(this.zoomOutPaintVertexArray,Pn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class m4{constructor(u,p,T){this.binders={},this._buffers=[];const D=[];for(const z in u.paint._values){if(!T(z))continue;const F=u.paint.get(z);if(!(F instanceof pr&&cr(F.property.specification)))continue;const $=x7(z,u.type),Z=F.value,re=F.property.specification.type,Ae=F.property.useIntegerZoom,ce=F.property.specification["property-type"],pe=ce==="cross-faded"||ce==="cross-faded-data-driven";if(Z.kind==="constant")this.binders[z]=pe?new Rf(Z.value,$):new Rd(Z.value,$,re),D.push(`/u_${z}`);else if(Z.kind==="source"||pe){const ye=y4(z,re,"source");this.binders[z]=pe?new vc(Z,re,Ae,p,ye,u.id):new pu(Z,$,re,ye),D.push(`/a_${z}`)}else{const ye=y4(z,re,"composite");this.binders[z]=new Bl(Z,$,re,Ae,p,ye),D.push(`/z_${z}`)}}this.cacheKey=D.sort().join("")}getMaxValue(u){const p=this.binders[u];return p instanceof pu||p instanceof Bl?p.maxValue:0}populatePaintArrays(u,p,T,D,z){for(const F in this.binders){const $=this.binders[F];($ instanceof pu||$ instanceof Bl||$ instanceof vc)&&$.populatePaintArray(u,p,T,D,z)}}setConstantPatternPositions(u,p){for(const T in this.binders){const D=this.binders[T];D instanceof Rf&&D.setConstantPatternPositions(u,p)}}updatePaintArrays(u,p,T,D,z){let F=!1;for(const $ in u){const Z=p.getPositions($);for(const re of Z){const Ae=T.feature(re.index);for(const ce in this.binders){const pe=this.binders[ce];if((pe instanceof pu||pe instanceof Bl||pe instanceof vc)&&pe.expression.isStateDependent===!0){const ye=D.paint.get(ce);pe.expression=ye.value,pe.updatePaintArray(re.start,re.end,Ae,u[$],z),F=!0}}}}return F}defines(){const u=[];for(const p in this.binders){const T=this.binders[p];(T instanceof Rd||T instanceof Rf)&&u.push(...T.uniformNames.map(D=>`#define HAS_UNIFORM_${D}`))}return u}getBinderAttributes(){const u=[];for(const p in this.binders){const T=this.binders[p];if(T instanceof pu||T instanceof Bl)for(let D=0;D<T.paintVertexAttributes.length;D++)u.push(T.paintVertexAttributes[D].name);else if(T instanceof vc)for(let D=0;D<Pn.members.length;D++)u.push(Pn.members[D].name)}return u}getBinderUniforms(){const u=[];for(const p in this.binders){const T=this.binders[p];if(T instanceof Rd||T instanceof Rf||T instanceof Bl)for(const D of T.uniformNames)u.push(D)}return u}getPaintVertexBuffers(){return this._buffers}getUniforms(u,p){const T=[];for(const D in this.binders){const z=this.binders[D];if(z instanceof Rd||z instanceof Rf||z instanceof Bl){for(const F of z.uniformNames)if(p[F]){const $=z.getBinding(u,p[F],F);T.push({name:F,property:D,binding:$})}}}return T}setUniforms(u,p,T,D){for(const{name:z,property:F,binding:$}of p)this.binders[F].setUniform($,D,T.get(F),z)}updatePaintBuffers(u){this._buffers=[];for(const p in this.binders){const T=this.binders[p];if(u&&T instanceof vc){const D=u.fromScale===2?T.zoomInPaintVertexBuffer:T.zoomOutPaintVertexBuffer;D&&this._buffers.push(D)}else(T instanceof pu||T instanceof Bl)&&T.paintVertexBuffer&&this._buffers.push(T.paintVertexBuffer)}}upload(u){for(const p in this.binders){const T=this.binders[p];(T instanceof pu||T instanceof Bl||T instanceof vc)&&T.upload(u)}this.updatePaintBuffers()}destroy(){for(const u in this.binders){const p=this.binders[u];(p instanceof pu||p instanceof Bl||p instanceof vc)&&p.destroy()}}}class _h{constructor(u,p,T=()=>!0){this.programConfigurations={};for(const D of u)this.programConfigurations[D.id]=new m4(D,p,T);this.needsUpload=!1,this._featureMap=new sr,this._bufferOffset=0}populatePaintArrays(u,p,T,D,z,F){for(const $ in this.programConfigurations)this.programConfigurations[$].populatePaintArrays(u,p,D,z,F);p.id!==void 0&&this._featureMap.add(p.id,T,this._bufferOffset,u),this._bufferOffset=u,this.needsUpload=!0}updatePaintArrays(u,p,T,D){for(const z of T)this.needsUpload=this.programConfigurations[z.id].updatePaintArrays(u,this._featureMap,p,z,D)||this.needsUpload}get(u){return this.programConfigurations[u]}upload(u){if(this.needsUpload){for(const p in this.programConfigurations)this.programConfigurations[p].upload(u);this.needsUpload=!1}}destroy(){for(const u in this.programConfigurations)this.programConfigurations[u].destroy()}}function x7(f,u){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(`${u}-`,"").replace(/-/g,"_")]}function y4(f,u,p){const T={color:{source:l,composite:Ge},number:{source:ne,composite:l}},D=function(z){return{"line-pattern":{source:$e,composite:$e},"fill-pattern":{source:$e,composite:$e},"fill-extrusion-pattern":{source:$e,composite:$e}}[z]}(f);return D&&D[p]||T[u][p]}Nt("ConstantBinder",Rd),Nt("CrossFadedConstantBinder",Rf),Nt("SourceExpressionBinder",pu),Nt("CrossFadedCompositeBinder",vc),Nt("CompositeExpressionBinder",Bl),Nt("ProgramConfiguration",m4,{omit:["_buffers"]}),Nt("ProgramConfigurationSet",_h);var Li=8192;const Mv=Math.pow(2,14)-1,_4=-Mv-1;function vh(f){const u=Li/f.extent,p=f.loadGeometry();for(let T=0;T<p.length;T++){const D=p[T];for(let z=0;z<D.length;z++){const F=D[z],$=Math.round(F.x*u),Z=Math.round(F.y*u);F.x=k($,_4,Mv),F.y=k(Z,_4,Mv),($<F.x||$>F.x+1||Z<F.y||Z>F.y+1)&&me("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return p}function xh(f,u){return{type:f.type,id:f.id,properties:f.properties,geometry:u?vh(f):[]}}function Tm(f,u,p,T,D){f.emplaceBack(2*u+(T+1)/2,2*p+(D+1)/2)}class Cv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new Q,this.indexArray=new st,this.segments=new dt,this.programConfigurations=new _h(u.layers,u.zoom),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,T){const D=this.layers[0],z=[];let F=null,$=!1;D.type==="circle"&&(F=D.layout.get("circle-sort-key"),$=!F.isConstant());for(const{feature:Z,id:re,index:Ae,sourceLayerIndex:ce}of u){const pe=this.layers[0]._featureFilter.needGeometry,ye=xh(Z,pe);if(!this.layers[0]._featureFilter.filter(new br(this.zoom),ye,T))continue;const _e=$?F.evaluate(ye,{},T):void 0,Ue={id:re,properties:Z.properties,type:Z.type,sourceLayerIndex:ce,index:Ae,geometry:pe?ye.geometry:vh(Z),patterns:{},sortKey:_e};z.push(Ue)}$&&z.sort((Z,re)=>Z.sortKey-re.sortKey);for(const Z of z){const{geometry:re,index:Ae,sourceLayerIndex:ce}=Z,pe=u[Ae].feature;this.addFeature(Z,re,Ae,T),p.featureIndex.insert(pe,re,Ae,ce,this.index)}}update(u,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,zt),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(u,p,T,D){for(const z of p)for(const F of z){const $=F.x,Z=F.y;if($<0||$>=Li||Z<0||Z>=Li)continue;const re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,u.sortKey),Ae=re.vertexLength;Tm(this.layoutVertexArray,$,Z,-1,-1),Tm(this.layoutVertexArray,$,Z,1,-1),Tm(this.layoutVertexArray,$,Z,1,1),Tm(this.layoutVertexArray,$,Z,-1,1),this.indexArray.emplaceBack(Ae,Ae+1,Ae+2),this.indexArray.emplaceBack(Ae,Ae+3,Ae+2),re.vertexLength+=4,re.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,{},D)}}function v4(f,u){for(let p=0;p<f.length;p++)if(Bf(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Bf(f,u[p]))return!0;return!!Pv(f,u)}function w7(f,u,p){return!!Bf(f,u)||!!Iv(u,f,p)}function x4(f,u){if(f.length===1)return b4(u,f[0]);for(let p=0;p<u.length;p++){const T=u[p];for(let D=0;D<T.length;D++)if(Bf(f,T[D]))return!0}for(let p=0;p<f.length;p++)if(b4(u,f[p]))return!0;for(let p=0;p<u.length;p++)if(Pv(f,u[p]))return!0;return!1}function b7(f,u,p){if(f.length>1){if(Pv(f,u))return!0;for(let T=0;T<u.length;T++)if(Iv(u[T],f,p))return!0}for(let T=0;T<f.length;T++)if(Iv(f[T],u,p))return!0;return!1}function Pv(f,u){if(f.length===0||u.length===0)return!1;for(let p=0;p<f.length-1;p++){const T=f[p],D=f[p+1];for(let z=0;z<u.length-1;z++)if(E7(T,D,u[z],u[z+1]))return!0}return!1}function E7(f,u,p,T){return Se(f,p,T)!==Se(u,p,T)&&Se(f,u,p)!==Se(f,u,T)}function Iv(f,u,p){const T=p*p;if(u.length===1)return f.distSqr(u[0])<T;for(let D=1;D<u.length;D++)if(w4(f,u[D-1],u[D])<T)return!0;return!1}function w4(f,u,p){const T=u.distSqr(p);if(T===0)return f.distSqr(u);const D=((f.x-u.x)*(p.x-u.x)+(f.y-u.y)*(p.y-u.y))/T;return f.distSqr(D<0?u:D>1?p:p.sub(u)._mult(D)._add(u))}function b4(f,u){let p,T,D,z=!1;for(let F=0;F<f.length;F++){p=f[F];for(let $=0,Z=p.length-1;$<p.length;Z=$++)T=p[$],D=p[Z],T.y>u.y!=D.y>u.y&&u.x<(D.x-T.x)*(u.y-T.y)/(D.y-T.y)+T.x&&(z=!z)}return z}function Bf(f,u){let p=!1;for(let T=0,D=f.length-1;T<f.length;D=T++){const z=f[T],F=f[D];z.y>u.y!=F.y>u.y&&u.x<(F.x-z.x)*(u.y-z.y)/(F.y-z.y)+z.x&&(p=!p)}return p}function T7(f,u,p){const T=p[0],D=p[2];if(f.x<T.x&&u.x<T.x||f.x>D.x&&u.x>D.x||f.y<T.y&&u.y<T.y||f.y>D.y&&u.y>D.y)return!1;const z=Se(f,u,p[0]);return z!==Se(f,u,p[1])||z!==Se(f,u,p[2])||z!==Se(f,u,p[3])}function Bd(f,u,p){const T=u.paint.get(f).value;return T.kind==="constant"?T.value:p.programConfigurations.get(u.id).getMaxValue(f)}function Sm(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function Mm(f,u,p,T,D){if(!u[0]&&!u[1])return f;const z=Tt.convert(u)._mult(D);p==="viewport"&&z._rotate(-T);const F=[];for(let $=0;$<f.length;$++)F.push(f[$].sub(z));return F}Nt("CircleBucket",Cv,{omit:["layers"]});const S7=new Nr({"circle-sort-key":new Xt(ct.layout_circle["circle-sort-key"])});var M7={paint:new Nr({"circle-radius":new Xt(ct.paint_circle["circle-radius"]),"circle-color":new Xt(ct.paint_circle["circle-color"]),"circle-blur":new Xt(ct.paint_circle["circle-blur"]),"circle-opacity":new Xt(ct.paint_circle["circle-opacity"]),"circle-translate":new Yt(ct.paint_circle["circle-translate"]),"circle-translate-anchor":new Yt(ct.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Yt(ct.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Yt(ct.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xt(ct.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xt(ct.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xt(ct.paint_circle["circle-stroke-opacity"])}),layout:S7},Qs=1e-6,qs=typeof Float32Array<"u"?Float32Array:Array;function E4(){var f=new qs(9);return qs!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f}function kv(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function T4(f,u,p){var T=u[0],D=u[1],z=u[2],F=u[3],$=u[4],Z=u[5],re=u[6],Ae=u[7],ce=u[8],pe=u[9],ye=u[10],_e=u[11],Ue=u[12],ze=u[13],tt=u[14],At=u[15],et=p[0],ot=p[1],gt=p[2],pt=p[3];return f[0]=et*T+ot*$+gt*ce+pt*Ue,f[1]=et*D+ot*Z+gt*pe+pt*ze,f[2]=et*z+ot*re+gt*ye+pt*tt,f[3]=et*F+ot*Ae+gt*_e+pt*At,f[4]=(et=p[4])*T+(ot=p[5])*$+(gt=p[6])*ce+(pt=p[7])*Ue,f[5]=et*D+ot*Z+gt*pe+pt*ze,f[6]=et*z+ot*re+gt*ye+pt*tt,f[7]=et*F+ot*Ae+gt*_e+pt*At,f[8]=(et=p[8])*T+(ot=p[9])*$+(gt=p[10])*ce+(pt=p[11])*Ue,f[9]=et*D+ot*Z+gt*pe+pt*ze,f[10]=et*z+ot*re+gt*ye+pt*tt,f[11]=et*F+ot*Ae+gt*_e+pt*At,f[12]=(et=p[12])*T+(ot=p[13])*$+(gt=p[14])*ce+(pt=p[15])*Ue,f[13]=et*D+ot*Z+gt*pe+pt*ze,f[14]=et*z+ot*re+gt*ye+pt*tt,f[15]=et*F+ot*Ae+gt*_e+pt*At,f}Math.hypot||(Math.hypot=function(){for(var f=0,u=arguments.length;u--;)f+=arguments[u]*arguments[u];return Math.sqrt(f)});var zd,C7=T4;function S4(){var f=new qs(3);return qs!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f}function M4(f,u,p){var T=new qs(3);return T[0]=f,T[1]=u,T[2]=p,T}function Cm(f,u,p){var T=u[0],D=u[1],z=u[2],F=u[3];return f[0]=p[0]*T+p[4]*D+p[8]*z+p[12]*F,f[1]=p[1]*T+p[5]*D+p[9]*z+p[13]*F,f[2]=p[2]*T+p[6]*D+p[10]*z+p[14]*F,f[3]=p[3]*T+p[7]*D+p[11]*z+p[15]*F,f}function C4(){var f=new qs(4);return qs!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0),f[3]=1,f}function P4(f,u){const p=Cm([],[f.x,f.y,0,1],u);return new Tt(p[0]/p[3],p[1]/p[3])}S4(),zd=new qs(4),qs!=Float32Array&&(zd[0]=0,zd[1]=0,zd[2]=0,zd[3]=0),S4(),M4(1,0,0),M4(0,1,0),C4(),C4(),E4(),function(){var f;f=new qs(2),qs!=Float32Array&&(f[0]=0,f[1]=0)}();class I4 extends Cv{}Nt("HeatmapBucket",I4,{omit:["layers"]});var P7={paint:new Nr({"heatmap-radius":new Xt(ct.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xt(ct.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Yt(ct.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qo(ct.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Yt(ct.paint_heatmap["heatmap-opacity"])})};function Lv(f,{width:u,height:p},T,D){if(D){if(D instanceof Uint8ClampedArray)D=new Uint8Array(D.buffer);else if(D.length!==u*p*T)throw new RangeError(`mismatched image size. expected: ${D.length} but got: ${u*p*T}`)}else D=new Uint8Array(u*p*T);return f.width=u,f.height=p,f.data=D,f}function k4(f,{width:u,height:p},T){if(u===f.width&&p===f.height)return;const D=Lv({},{width:u,height:p},T);Dv(f,D,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,u),height:Math.min(f.height,p)},T),f.width=u,f.height=p,f.data=D.data}function Dv(f,u,p,T,D,z){if(D.width===0||D.height===0)return u;if(D.width>f.width||D.height>f.height||p.x>f.width-D.width||p.y>f.height-D.height)throw new RangeError("out of range source coordinates for image copy");if(D.width>u.width||D.height>u.height||T.x>u.width-D.width||T.y>u.height-D.height)throw new RangeError("out of range destination coordinates for image copy");const F=f.data,$=u.data;if(F===$)throw new Error("srcData equals dstData, so image is already copied");for(let Z=0;Z<D.height;Z++){const re=((p.y+Z)*f.width+p.x)*z,Ae=((T.y+Z)*u.width+T.x)*z;for(let ce=0;ce<D.width*z;ce++)$[Ae+ce]=F[re+ce]}return u}class Od{constructor(u,p){Lv(this,u,1,p)}resize(u){k4(this,u,1)}clone(){return new Od({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,T,D,z){Dv(u,p,T,D,z,1)}}class _a{constructor(u,p){Lv(this,u,4,p)}resize(u){k4(this,u,4)}replace(u,p){p?this.data.set(u):this.data=u instanceof Uint8ClampedArray?new Uint8Array(u.buffer):u}clone(){return new _a({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(u,p,T,D,z){Dv(u,p,T,D,z,4)}}function L4(f){const u={},p=f.resolution||256,T=f.clips?f.clips.length:1,D=f.image||new _a({width:p,height:T});if(Math.log(p)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${p}`);const z=(F,$,Z)=>{u[f.evaluationKey]=Z;const re=f.expression.evaluate(u);D.data[F+$+0]=Math.floor(255*re.r/re.a),D.data[F+$+1]=Math.floor(255*re.g/re.a),D.data[F+$+2]=Math.floor(255*re.b/re.a),D.data[F+$+3]=Math.floor(255*re.a)};if(f.clips)for(let F=0,$=0;F<T;++F,$+=4*p)for(let Z=0,re=0;Z<p;Z++,re+=4){const Ae=Z/(p-1),{start:ce,end:pe}=f.clips[F];z($,re,ce*(1-Ae)+pe*Ae)}else for(let F=0,$=0;F<p;F++,$+=4)z(0,$,F/(p-1));return D}Nt("AlphaImage",Od),Nt("RGBAImage",_a);var I7={paint:new Nr({"hillshade-illumination-direction":new Yt(ct.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Yt(ct.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Yt(ct.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Yt(ct.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Yt(ct.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Yt(ct.paint_hillshade["hillshade-accent-color"])})};const k7=Ur([{name:"a_pos",components:2,type:"Int16"}],4),{members:L7}=k7;var Pm={exports:{}};function Im(f,u,p){p=p||2;var T,D,z,F,$,Z,re,Ae=u&&u.length,ce=Ae?u[0]*p:f.length,pe=D4(f,0,ce,p,!0),ye=[];if(!pe||pe.next===pe.prev)return ye;if(Ae&&(pe=function(Ue,ze,tt,At){var et,ot,gt,pt=[];for(et=0,ot=ze.length;et<ot;et++)(gt=D4(Ue,ze[et]*At,et<ot-1?ze[et+1]*At:Ue.length,At,!1))===gt.next&&(gt.steiner=!0),pt.push(U7(gt));for(pt.sort(O7),et=0;et<pt.length;et++)tt=F7(pt[et],tt);return tt}(f,u,pe,p)),f.length>80*p){T=z=f[0],D=F=f[1];for(var _e=p;_e<ce;_e+=p)($=f[_e])<T&&(T=$),(Z=f[_e+1])<D&&(D=Z),$>z&&(z=$),Z>F&&(F=Z);re=(re=Math.max(z-T,F-D))!==0?32767/re:0}return Fd(pe,ye,p,T,D,re,0),ye}function D4(f,u,p,T,D){var z,F;if(D===zv(f,u,p,T)>0)for(z=u;z<p;z+=T)F=z4(z,f[z],f[z+1],F);else for(z=p-T;z>=u;z-=T)F=z4(z,f[z],f[z+1],F);return F&&km(F,F.next)&&(Ud(F),F=F.next),F}function wh(f,u){if(!f)return f;u||(u=f);var p,T=f;do if(p=!1,T.steiner||!km(T,T.next)&&fi(T.prev,T,T.next)!==0)T=T.next;else{if(Ud(T),(T=u=T.prev)===T.next)break;p=!0}while(p||T!==u);return u}function Fd(f,u,p,T,D,z,F){if(f){!F&&z&&function(Ae,ce,pe,ye){var _e=Ae;do _e.z===0&&(_e.z=Rv(_e.x,_e.y,ce,pe,ye)),_e.prevZ=_e.prev,_e.nextZ=_e.next,_e=_e.next;while(_e!==Ae);_e.prevZ.nextZ=null,_e.prevZ=null,function(Ue){var ze,tt,At,et,ot,gt,pt,Zt,tn=1;do{for(tt=Ue,Ue=null,ot=null,gt=0;tt;){for(gt++,At=tt,pt=0,ze=0;ze<tn&&(pt++,At=At.nextZ);ze++);for(Zt=tn;pt>0||Zt>0&&At;)pt!==0&&(Zt===0||!At||tt.z<=At.z)?(et=tt,tt=tt.nextZ,pt--):(et=At,At=At.nextZ,Zt--),ot?ot.nextZ=et:Ue=et,et.prevZ=ot,ot=et;tt=At}ot.nextZ=null,tn*=2}while(gt>1)}(_e)}(f,T,D,z);for(var $,Z,re=f;f.prev!==f.next;)if($=f.prev,Z=f.next,z?R7(f,T,D,z):D7(f))u.push($.i/p|0),u.push(f.i/p|0),u.push(Z.i/p|0),Ud(f),f=Z.next,re=Z.next;else if((f=Z)===re){F?F===1?Fd(f=B7(wh(f),u,p),u,p,T,D,z,2):F===2&&z7(f,u,p,T,D,z):Fd(wh(f),u,p,T,D,z,1);break}}}function D7(f){var u=f.prev,p=f,T=f.next;if(fi(u,p,T)>=0)return!1;for(var D=u.x,z=p.x,F=T.x,$=u.y,Z=p.y,re=T.y,Ae=D<z?D<F?D:F:z<F?z:F,ce=$<Z?$<re?$:re:Z<re?Z:re,pe=D>z?D>F?D:F:z>F?z:F,ye=$>Z?$>re?$:re:Z>re?Z:re,_e=T.next;_e!==u;){if(_e.x>=Ae&&_e.x<=pe&&_e.y>=ce&&_e.y<=ye&&zf(D,$,z,Z,F,re,_e.x,_e.y)&&fi(_e.prev,_e,_e.next)>=0)return!1;_e=_e.next}return!0}function R7(f,u,p,T){var D=f.prev,z=f,F=f.next;if(fi(D,z,F)>=0)return!1;for(var $=D.x,Z=z.x,re=F.x,Ae=D.y,ce=z.y,pe=F.y,ye=$<Z?$<re?$:re:Z<re?Z:re,_e=Ae<ce?Ae<pe?Ae:pe:ce<pe?ce:pe,Ue=$>Z?$>re?$:re:Z>re?Z:re,ze=Ae>ce?Ae>pe?Ae:pe:ce>pe?ce:pe,tt=Rv(ye,_e,u,p,T),At=Rv(Ue,ze,u,p,T),et=f.prevZ,ot=f.nextZ;et&&et.z>=tt&&ot&&ot.z<=At;){if(et.x>=ye&&et.x<=Ue&&et.y>=_e&&et.y<=ze&&et!==D&&et!==F&&zf($,Ae,Z,ce,re,pe,et.x,et.y)&&fi(et.prev,et,et.next)>=0||(et=et.prevZ,ot.x>=ye&&ot.x<=Ue&&ot.y>=_e&&ot.y<=ze&&ot!==D&&ot!==F&&zf($,Ae,Z,ce,re,pe,ot.x,ot.y)&&fi(ot.prev,ot,ot.next)>=0))return!1;ot=ot.nextZ}for(;et&&et.z>=tt;){if(et.x>=ye&&et.x<=Ue&&et.y>=_e&&et.y<=ze&&et!==D&&et!==F&&zf($,Ae,Z,ce,re,pe,et.x,et.y)&&fi(et.prev,et,et.next)>=0)return!1;et=et.prevZ}for(;ot&&ot.z<=At;){if(ot.x>=ye&&ot.x<=Ue&&ot.y>=_e&&ot.y<=ze&&ot!==D&&ot!==F&&zf($,Ae,Z,ce,re,pe,ot.x,ot.y)&&fi(ot.prev,ot,ot.next)>=0)return!1;ot=ot.nextZ}return!0}function B7(f,u,p){var T=f;do{var D=T.prev,z=T.next.next;!km(D,z)&&R4(D,T,T.next,z)&&Nd(D,z)&&Nd(z,D)&&(u.push(D.i/p|0),u.push(T.i/p|0),u.push(z.i/p|0),Ud(T),Ud(T.next),T=f=z),T=T.next}while(T!==f);return wh(T)}function z7(f,u,p,T,D,z){var F=f;do{for(var $=F.next.next;$!==F.prev;){if(F.i!==$.i&&V7(F,$)){var Z=B4(F,$);return F=wh(F,F.next),Z=wh(Z,Z.next),Fd(F,u,p,T,D,z,0),void Fd(Z,u,p,T,D,z,0)}$=$.next}F=F.next}while(F!==f)}function O7(f,u){return f.x-u.x}function F7(f,u){var p=function(D,z){var F,$=z,Z=D.x,re=D.y,Ae=-1/0;do{if(re<=$.y&&re>=$.next.y&&$.next.y!==$.y){var ce=$.x+(re-$.y)*($.next.x-$.x)/($.next.y-$.y);if(ce<=Z&&ce>Ae&&(Ae=ce,F=$.x<$.next.x?$:$.next,ce===Z))return F}$=$.next}while($!==z);if(!F)return null;var pe,ye=F,_e=F.x,Ue=F.y,ze=1/0;$=F;do Z>=$.x&&$.x>=_e&&Z!==$.x&&zf(re<Ue?Z:Ae,re,_e,Ue,re<Ue?Ae:Z,re,$.x,$.y)&&(pe=Math.abs(re-$.y)/(Z-$.x),Nd($,D)&&(pe<ze||pe===ze&&($.x>F.x||$.x===F.x&&N7(F,$)))&&(F=$,ze=pe)),$=$.next;while($!==ye);return F}(f,u);if(!p)return u;var T=B4(p,f);return wh(T,T.next),wh(p,p.next)}function N7(f,u){return fi(f.prev,f,u.prev)<0&&fi(u.next,f,f.next)<0}function Rv(f,u,p,T,D){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=(f-p)*D|0)|f<<8))|f<<4))|f<<2))|f<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-T)*D|0)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function U7(f){var u=f,p=f;do(u.x<p.x||u.x===p.x&&u.y<p.y)&&(p=u),u=u.next;while(u!==f);return p}function zf(f,u,p,T,D,z,F,$){return(D-F)*(u-$)>=(f-F)*(z-$)&&(f-F)*(T-$)>=(p-F)*(u-$)&&(p-F)*(z-$)>=(D-F)*(T-$)}function V7(f,u){return f.next.i!==u.i&&f.prev.i!==u.i&&!function(p,T){var D=p;do{if(D.i!==p.i&&D.next.i!==p.i&&D.i!==T.i&&D.next.i!==T.i&&R4(D,D.next,p,T))return!0;D=D.next}while(D!==p);return!1}(f,u)&&(Nd(f,u)&&Nd(u,f)&&function(p,T){var D=p,z=!1,F=(p.x+T.x)/2,$=(p.y+T.y)/2;do D.y>$!=D.next.y>$&&D.next.y!==D.y&&F<(D.next.x-D.x)*($-D.y)/(D.next.y-D.y)+D.x&&(z=!z),D=D.next;while(D!==p);return z}(f,u)&&(fi(f.prev,f,u.prev)||fi(f,u.prev,u))||km(f,u)&&fi(f.prev,f,f.next)>0&&fi(u.prev,u,u.next)>0)}function fi(f,u,p){return(u.y-f.y)*(p.x-u.x)-(u.x-f.x)*(p.y-u.y)}function km(f,u){return f.x===u.x&&f.y===u.y}function R4(f,u,p,T){var D=Dm(fi(f,u,p)),z=Dm(fi(f,u,T)),F=Dm(fi(p,T,f)),$=Dm(fi(p,T,u));return D!==z&&F!==$||!(D!==0||!Lm(f,p,u))||!(z!==0||!Lm(f,T,u))||!(F!==0||!Lm(p,f,T))||!($!==0||!Lm(p,u,T))}function Lm(f,u,p){return u.x<=Math.max(f.x,p.x)&&u.x>=Math.min(f.x,p.x)&&u.y<=Math.max(f.y,p.y)&&u.y>=Math.min(f.y,p.y)}function Dm(f){return f>0?1:f<0?-1:0}function Nd(f,u){return fi(f.prev,f,f.next)<0?fi(f,u,f.next)>=0&&fi(f,f.prev,u)>=0:fi(f,u,f.prev)<0||fi(f,f.next,u)<0}function B4(f,u){var p=new Bv(f.i,f.x,f.y),T=new Bv(u.i,u.x,u.y),D=f.next,z=u.prev;return f.next=u,u.prev=f,p.next=D,D.prev=p,T.next=p,p.prev=T,z.next=T,T.prev=z,T}function z4(f,u,p,T){var D=new Bv(f,u,p);return T?(D.next=T.next,D.prev=T,T.next.prev=D,T.next=D):(D.prev=D,D.next=D),D}function Ud(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function Bv(f,u,p){this.i=f,this.x=u,this.y=p,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function zv(f,u,p,T){for(var D=0,z=u,F=p-T;z<p;z+=T)D+=(f[F]-f[z])*(f[z+1]+f[F+1]),F=z;return D}function G7(f,u,p,T,D){O4(f,u,p||0,T||f.length-1,D||$7)}function O4(f,u,p,T,D){for(;T>p;){if(T-p>600){var z=T-p+1,F=u-p+1,$=Math.log(z),Z=.5*Math.exp(2*$/3),re=.5*Math.sqrt($*Z*(z-Z)/z)*(F-z/2<0?-1:1);O4(f,u,Math.max(p,Math.floor(u-F*Z/z+re)),Math.min(T,Math.floor(u+(z-F)*Z/z+re)),D)}var Ae=f[u],ce=p,pe=T;for(Vd(f,p,u),D(f[T],Ae)>0&&Vd(f,p,T);ce<pe;){for(Vd(f,ce,pe),ce++,pe--;D(f[ce],Ae)<0;)ce++;for(;D(f[pe],Ae)>0;)pe--}D(f[p],Ae)===0?Vd(f,p,pe):Vd(f,++pe,T),pe<=u&&(p=pe+1),u<=pe&&(T=pe-1)}}function Vd(f,u,p){var T=f[u];f[u]=f[p],f[p]=T}function $7(f,u){return f<u?-1:f>u?1:0}function Ov(f,u){const p=f.length;if(p<=1)return[f];const T=[];let D,z;for(let F=0;F<p;F++){const $=He(f[F]);$!==0&&(f[F].area=Math.abs($),z===void 0&&(z=$<0),z===$<0?(D&&T.push(D),D=[f[F]]):D.push(f[F]))}if(D&&T.push(D),u>1)for(let F=0;F<T.length;F++)T[F].length<=u||(G7(T[F],u,1,T[F].length-1,j7),T[F]=T[F].slice(0,u));return T}function j7(f,u){return u.area-f.area}function Fv(f,u,p){const T=p.patternDependencies;let D=!1;for(const z of u){const F=z.paint.get(`${f}-pattern`);F.isConstant()||(D=!0);const $=F.constantOr(null);$&&(D=!0,T[$.to]=!0,T[$.from]=!0)}return D}function Nv(f,u,p,T,D){const z=D.patternDependencies;for(const F of u){const $=F.paint.get(`${f}-pattern`).value;if($.kind!=="constant"){let Z=$.evaluate({zoom:T-1},p,{},D.availableImages),re=$.evaluate({zoom:T},p,{},D.availableImages),Ae=$.evaluate({zoom:T+1},p,{},D.availableImages);Z=Z&&Z.name?Z.name:Z,re=re&&re.name?re.name:re,Ae=Ae&&Ae.name?Ae.name:Ae,z[Z]=!0,z[re]=!0,z[Ae]=!0,p.patterns[F.id]={min:Z,mid:re,max:Ae}}}return p}Pm.exports=Im,Pm.exports.default=Im,Im.deviation=function(f,u,p,T){var D=u&&u.length,z=Math.abs(zv(f,0,D?u[0]*p:f.length,p));if(D)for(var F=0,$=u.length;F<$;F++)z-=Math.abs(zv(f,u[F]*p,F<$-1?u[F+1]*p:f.length,p));var Z=0;for(F=0;F<T.length;F+=3){var re=T[F]*p,Ae=T[F+1]*p,ce=T[F+2]*p;Z+=Math.abs((f[re]-f[ce])*(f[Ae+1]-f[re+1])-(f[re]-f[Ae])*(f[ce+1]-f[re+1]))}return z===0&&Z===0?0:Math.abs((Z-z)/z)},Im.flatten=function(f){for(var u=f[0][0].length,p={vertices:[],holes:[],dimensions:u},T=0,D=0;D<f.length;D++){for(var z=0;z<f[D].length;z++)for(var F=0;F<u;F++)p.vertices.push(f[D][z][F]);D>0&&p.holes.push(T+=f[D-1].length)}return p};class Uv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new J,this.indexArray=new st,this.indexArray2=new Je,this.programConfigurations=new _h(u.layers,u.zoom),this.segments=new dt,this.segments2=new dt,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,T){this.hasPattern=Fv("fill",this.layers,p);const D=this.layers[0].layout.get("fill-sort-key"),z=!D.isConstant(),F=[];for(const{feature:$,id:Z,index:re,sourceLayerIndex:Ae}of u){const ce=this.layers[0]._featureFilter.needGeometry,pe=xh($,ce);if(!this.layers[0]._featureFilter.filter(new br(this.zoom),pe,T))continue;const ye=z?D.evaluate(pe,{},T,p.availableImages):void 0,_e={id:Z,properties:$.properties,type:$.type,sourceLayerIndex:Ae,index:re,geometry:ce?pe.geometry:vh($),patterns:{},sortKey:ye};F.push(_e)}z&&F.sort(($,Z)=>$.sortKey-Z.sortKey);for(const $ of F){const{geometry:Z,index:re,sourceLayerIndex:Ae}=$;if(this.hasPattern){const ce=Nv("fill",this.layers,$,this.zoom,p);this.patternFeatures.push(ce)}else this.addFeature($,Z,re,T,{});p.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,T)}addFeatures(u,p,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,p,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,L7),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.indexBuffer2=u.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(u,p,T,D,z){for(const F of Ov(p,500)){let $=0;for(const ye of F)$+=ye.length;const Z=this.segments.prepareSegment($,this.layoutVertexArray,this.indexArray),re=Z.vertexLength,Ae=[],ce=[];for(const ye of F){if(ye.length===0)continue;ye!==F[0]&&ce.push(Ae.length/2);const _e=this.segments2.prepareSegment(ye.length,this.layoutVertexArray,this.indexArray2),Ue=_e.vertexLength;this.layoutVertexArray.emplaceBack(ye[0].x,ye[0].y),this.indexArray2.emplaceBack(Ue+ye.length-1,Ue),Ae.push(ye[0].x),Ae.push(ye[0].y);for(let ze=1;ze<ye.length;ze++)this.layoutVertexArray.emplaceBack(ye[ze].x,ye[ze].y),this.indexArray2.emplaceBack(Ue+ze-1,Ue+ze),Ae.push(ye[ze].x),Ae.push(ye[ze].y);_e.vertexLength+=ye.length,_e.primitiveLength+=ye.length}const pe=Pm.exports(Ae,ce);for(let ye=0;ye<pe.length;ye+=3)this.indexArray.emplaceBack(re+pe[ye],re+pe[ye+1],re+pe[ye+2]);Z.vertexLength+=$,Z.primitiveLength+=pe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}Nt("FillBucket",Uv,{omit:["layers","patternFeatures"]});const H7=new Nr({"fill-sort-key":new Xt(ct.layout_fill["fill-sort-key"])});var W7={paint:new Nr({"fill-antialias":new Yt(ct.paint_fill["fill-antialias"]),"fill-opacity":new Xt(ct.paint_fill["fill-opacity"]),"fill-color":new Xt(ct.paint_fill["fill-color"]),"fill-outline-color":new Xt(ct.paint_fill["fill-outline-color"]),"fill-translate":new Yt(ct.paint_fill["fill-translate"]),"fill-translate-anchor":new Yt(ct.paint_fill["fill-translate-anchor"]),"fill-pattern":new hn(ct.paint_fill["fill-pattern"])}),layout:H7};const Q7=Ur([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),q7=Ur([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Z7}=Q7;var xc={},Y7=Tt,F4=Of;function Of(f,u,p,T,D){this.properties={},this.extent=p,this.type=0,this._pbf=f,this._geometry=-1,this._keys=T,this._values=D,f.readFields(X7,this,u)}function X7(f,u,p){f==1?u.id=p.readVarint():f==2?function(T,D){for(var z=T.readVarint()+T.pos;T.pos<z;){var F=D._keys[T.readVarint()],$=D._values[T.readVarint()];D.properties[F]=$}}(p,u):f==3?u.type=p.readVarint():f==4&&(u._geometry=p.pos)}function K7(f){for(var u,p,T=0,D=0,z=f.length,F=z-1;D<z;F=D++)T+=((p=f[F]).x-(u=f[D]).x)*(u.y+p.y);return T}Of.types=["Unknown","Point","LineString","Polygon"],Of.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var u,p=f.readVarint()+f.pos,T=1,D=0,z=0,F=0,$=[];f.pos<p;){if(D<=0){var Z=f.readVarint();T=7&Z,D=Z>>3}if(D--,T===1||T===2)z+=f.readSVarint(),F+=f.readSVarint(),T===1&&(u&&$.push(u),u=[]),u.push(new Y7(z,F));else{if(T!==7)throw new Error("unknown command "+T);u&&u.push(u[0].clone())}}return u&&$.push(u),$},Of.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var u=f.readVarint()+f.pos,p=1,T=0,D=0,z=0,F=1/0,$=-1/0,Z=1/0,re=-1/0;f.pos<u;){if(T<=0){var Ae=f.readVarint();p=7&Ae,T=Ae>>3}if(T--,p===1||p===2)(D+=f.readSVarint())<F&&(F=D),D>$&&($=D),(z+=f.readSVarint())<Z&&(Z=z),z>re&&(re=z);else if(p!==7)throw new Error("unknown command "+p)}return[F,Z,$,re]},Of.prototype.toGeoJSON=function(f,u,p){var T,D,z=this.extent*Math.pow(2,p),F=this.extent*f,$=this.extent*u,Z=this.loadGeometry(),re=Of.types[this.type];function Ae(ye){for(var _e=0;_e<ye.length;_e++){var Ue=ye[_e];ye[_e]=[360*(Ue.x+F)/z-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ue.y+$)/z)*Math.PI/180))-90]}}switch(this.type){case 1:var ce=[];for(T=0;T<Z.length;T++)ce[T]=Z[T][0];Ae(Z=ce);break;case 2:for(T=0;T<Z.length;T++)Ae(Z[T]);break;case 3:for(Z=function(ye){var _e=ye.length;if(_e<=1)return[ye];for(var Ue,ze,tt=[],At=0;At<_e;At++){var et=K7(ye[At]);et!==0&&(ze===void 0&&(ze=et<0),ze===et<0?(Ue&&tt.push(Ue),Ue=[ye[At]]):Ue.push(ye[At]))}return Ue&&tt.push(Ue),tt}(Z),T=0;T<Z.length;T++)for(D=0;D<Z[T].length;D++)Ae(Z[T][D])}Z.length===1?Z=Z[0]:re="Multi"+re;var pe={type:"Feature",geometry:{type:re,coordinates:Z},properties:this.properties};return"id"in this&&(pe.id=this.id),pe};var J7=F4,N4=U4;function U4(f,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(eN,this,u),this.length=this._features.length}function eN(f,u,p){f===15?u.version=p.readVarint():f===1?u.name=p.readString():f===5?u.extent=p.readVarint():f===2?u._features.push(p.pos):f===3?u._keys.push(p.readString()):f===4&&u._values.push(function(T){for(var D=null,z=T.readVarint()+T.pos;T.pos<z;){var F=T.readVarint()>>3;D=F===1?T.readString():F===2?T.readFloat():F===3?T.readDouble():F===4?T.readVarint64():F===5?T.readVarint():F===6?T.readSVarint():F===7?T.readBoolean():null}return D}(p))}U4.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var u=this._pbf.readVarint()+this._pbf.pos;return new J7(this._pbf,u,this.extent,this._keys,this._values)};var tN=N4;function nN(f,u,p){if(f===3){var T=new tN(p,p.readVarint()+p.pos);T.length&&(u[T.name]=T)}}xc.VectorTile=function(f,u){this.layers=f.readFields(nN,{},u)},xc.VectorTileFeature=F4,xc.VectorTileLayer=N4;const rN=xc.VectorTileFeature.types,Vv=Math.pow(2,13);function Gd(f,u,p,T,D,z,F,$){f.emplaceBack(u,p,2*Math.floor(T*Vv)+F,D*Vv*2,z*Vv*2,Math.round($))}class Gv{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.layoutVertexArray=new le,this.centroidVertexArray=new N,this.indexArray=new st,this.programConfigurations=new _h(u.layers,u.zoom),this.segments=new dt,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,T){this.features=[],this.hasPattern=Fv("fill-extrusion",this.layers,p);for(const{feature:D,id:z,index:F,sourceLayerIndex:$}of u){const Z=this.layers[0]._featureFilter.needGeometry,re=xh(D,Z);if(!this.layers[0]._featureFilter.filter(new br(this.zoom),re,T))continue;const Ae={id:z,sourceLayerIndex:$,index:F,geometry:Z?re.geometry:vh(D),properties:D.properties,type:D.type,patterns:{}};this.hasPattern?this.features.push(Nv("fill-extrusion",this.layers,Ae,this.zoom,p)):this.addFeature(Ae,Ae.geometry,F,T,{}),p.featureIndex.insert(D,Ae.geometry,F,$,this.index,!0)}}addFeatures(u,p,T){for(const D of this.features){const{geometry:z}=D;this.addFeature(D,z,D.index,p,T)}}update(u,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,T)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,Z7),this.centroidVertexBuffer=u.createVertexBuffer(this.centroidVertexArray,q7.members,!0),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(u,p,T,D,z){const F={x:0,y:0,vertexCount:0};for(const $ of Ov(p,500)){let Z=0;for(const _e of $)Z+=_e.length;let re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const _e of $){if(_e.length===0||sN(_e))continue;let Ue=0;for(let ze=0;ze<_e.length;ze++){const tt=_e[ze];if(ze>=1){const At=_e[ze-1];if(!iN(tt,At)){re.vertexLength+4>dt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const et=tt.sub(At)._perp()._unit(),ot=At.dist(tt);Ue+ot>32768&&(Ue=0),Gd(this.layoutVertexArray,tt.x,tt.y,et.x,et.y,0,0,Ue),Gd(this.layoutVertexArray,tt.x,tt.y,et.x,et.y,0,1,Ue),F.x+=2*tt.x,F.y+=2*tt.y,F.vertexCount+=2,Ue+=ot,Gd(this.layoutVertexArray,At.x,At.y,et.x,et.y,0,0,Ue),Gd(this.layoutVertexArray,At.x,At.y,et.x,et.y,0,1,Ue),F.x+=2*At.x,F.y+=2*At.y,F.vertexCount+=2;const gt=re.vertexLength;this.indexArray.emplaceBack(gt,gt+2,gt+1),this.indexArray.emplaceBack(gt+1,gt+2,gt+3),re.vertexLength+=4,re.primitiveLength+=2}}}}if(re.vertexLength+Z>dt.MAX_VERTEX_ARRAY_LENGTH&&(re=this.segments.prepareSegment(Z,this.layoutVertexArray,this.indexArray)),rN[u.type]!=="Polygon")continue;const Ae=[],ce=[],pe=re.vertexLength;for(const _e of $)if(_e.length!==0){_e!==$[0]&&ce.push(Ae.length/2);for(let Ue=0;Ue<_e.length;Ue++){const ze=_e[Ue];Gd(this.layoutVertexArray,ze.x,ze.y,0,0,1,1,0),F.x+=ze.x,F.y+=ze.y,F.vertexCount+=1,Ae.push(ze.x),Ae.push(ze.y)}}const ye=Pm.exports(Ae,ce);for(let _e=0;_e<ye.length;_e+=3)this.indexArray.emplaceBack(pe+ye[_e],pe+ye[_e+2],pe+ye[_e+1]);re.primitiveLength+=ye.length/3,re.vertexLength+=Z}for(let $=0;$<F.vertexCount;$++)this.centroidVertexArray.emplaceBack(Math.floor(F.x/F.vertexCount),Math.floor(F.y/F.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}}function iN(f,u){return f.x===u.x&&(f.x<0||f.x>Li)||f.y===u.y&&(f.y<0||f.y>Li)}function sN(f){return f.every(u=>u.x<0)||f.every(u=>u.x>Li)||f.every(u=>u.y<0)||f.every(u=>u.y>Li)}Nt("FillExtrusionBucket",Gv,{omit:["layers","features"]});var oN={paint:new Nr({"fill-extrusion-opacity":new Yt(ct["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xt(ct["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Yt(ct["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Yt(ct["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new hn(ct["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xt(ct["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xt(ct["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Yt(ct["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function $d(f,u){return f.x*u.x+f.y*u.y}function V4(f,u){if(f.length===1){let p=0;const T=u[p++];let D;for(;!D||T.equals(D);)if(D=u[p++],!D)return 1/0;for(;p<u.length;p++){const z=u[p],F=f[0],$=D.sub(T),Z=z.sub(T),re=F.sub(T),Ae=$d($,$),ce=$d($,Z),pe=$d(Z,Z),ye=$d(re,$),_e=$d(re,Z),Ue=Ae*pe-ce*ce,ze=(pe*ye-ce*_e)/Ue,tt=(Ae*_e-ce*ye)/Ue,At=T.z*(1-ze-tt)+D.z*ze+z.z*tt;if(isFinite(At))return At}return 1/0}{let p=1/0;for(const T of u)p=Math.min(p,T.z);return p}}const aN=Ur([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:lN}=aN,AN=Ur([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:uN}=AN,cN=xc.VectorTileFeature.types,hN=Math.cos(Math.PI/180*37.5),G4=Math.pow(2,14)/.5;class $v{constructor(u){this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(p=>p.id),this.index=u.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(p=>{this.gradients[p.id]={}}),this.layoutVertexArray=new de,this.layoutVertexArray2=new Re,this.indexArray=new st,this.programConfigurations=new _h(u.layers,u.zoom),this.segments=new dt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id)}populate(u,p,T){this.hasPattern=Fv("line",this.layers,p);const D=this.layers[0].layout.get("line-sort-key"),z=!D.isConstant(),F=[];for(const{feature:$,id:Z,index:re,sourceLayerIndex:Ae}of u){const ce=this.layers[0]._featureFilter.needGeometry,pe=xh($,ce);if(!this.layers[0]._featureFilter.filter(new br(this.zoom),pe,T))continue;const ye=z?D.evaluate(pe,{},T):void 0,_e={id:Z,properties:$.properties,type:$.type,sourceLayerIndex:Ae,index:re,geometry:ce?pe.geometry:vh($),patterns:{},sortKey:ye};F.push(_e)}z&&F.sort(($,Z)=>$.sortKey-Z.sortKey);for(const $ of F){const{geometry:Z,index:re,sourceLayerIndex:Ae}=$;if(this.hasPattern){const ce=Nv("line",this.layers,$,this.zoom,p);this.patternFeatures.push(ce)}else this.addFeature($,Z,re,T,{});p.featureIndex.insert(u[re].feature,Z,re,Ae,this.index)}}update(u,p,T){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(u,p,this.stateDependentLayers,T)}addFeatures(u,p,T){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,p,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(u){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=u.createVertexBuffer(this.layoutVertexArray2,uN)),this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,lN),this.indexBuffer=u.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(u),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(u){if(u.properties&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(u.properties,"mapbox_clip_end"))return{start:+u.properties.mapbox_clip_start,end:+u.properties.mapbox_clip_end}}addFeature(u,p,T,D,z){const F=this.layers[0].layout,$=F.get("line-join").evaluate(u,{}),Z=F.get("line-cap"),re=F.get("line-miter-limit"),Ae=F.get("line-round-limit");this.lineClips=this.lineFeatureClips(u);for(const ce of p)this.addLine(ce,u,$,Z,re,Ae);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,u,T,z,D)}addLine(u,p,T,D,z,F){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let tt=0;tt<u.length-1;tt++)this.totalDistance+=u[tt].dist(u[tt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const $=cN[p.type]==="Polygon";let Z=u.length;for(;Z>=2&&u[Z-1].equals(u[Z-2]);)Z--;let re=0;for(;re<Z-1&&u[re].equals(u[re+1]);)re++;if(Z<($?3:2))return;T==="bevel"&&(z=1.05);const Ae=this.overscaling<=16?122880/(512*this.overscaling):0,ce=this.segments.prepareSegment(10*Z,this.layoutVertexArray,this.indexArray);let pe,ye,_e,Ue,ze;this.e1=this.e2=-1,$&&(pe=u[Z-2],ze=u[re].sub(pe)._unit()._perp());for(let tt=re;tt<Z;tt++){if(_e=tt===Z-1?$?u[re+1]:void 0:u[tt+1],_e&&u[tt].equals(_e))continue;ze&&(Ue=ze),pe&&(ye=pe),pe=u[tt],ze=_e?_e.sub(pe)._unit()._perp():Ue,Ue=Ue||ze;let At=Ue.add(ze);At.x===0&&At.y===0||At._unit();const et=Ue.x*ze.x+Ue.y*ze.y,ot=At.x*ze.x+At.y*ze.y,gt=ot!==0?1/ot:1/0,pt=2*Math.sqrt(2-2*ot),Zt=ot<hN&&ye&&_e,tn=Ue.x*ze.y-Ue.y*ze.x>0;if(Zt&&tt>re){const Ot=pe.dist(ye);if(Ot>2*Ae){const Wt=pe.sub(pe.sub(ye)._mult(Ae/Ot)._round());this.updateDistance(ye,Wt),this.addCurrentVertex(Wt,Ue,0,0,ce),ye=Wt}}const Ht=ye&&_e;let Ut=Ht?T:$?"butt":D;if(Ht&&Ut==="round"&&(gt<F?Ut="miter":gt<=2&&(Ut="fakeround")),Ut==="miter"&&gt>z&&(Ut="bevel"),Ut==="bevel"&&(gt>2&&(Ut="flipbevel"),gt<z&&(Ut="miter")),ye&&this.updateDistance(ye,pe),Ut==="miter")At._mult(gt),this.addCurrentVertex(pe,At,0,0,ce);else if(Ut==="flipbevel"){if(gt>100)At=ze.mult(-1);else{const Ot=gt*Ue.add(ze).mag()/Ue.sub(ze).mag();At._perp()._mult(Ot*(tn?-1:1))}this.addCurrentVertex(pe,At,0,0,ce),this.addCurrentVertex(pe,At.mult(-1),0,0,ce)}else if(Ut==="bevel"||Ut==="fakeround"){const Ot=-Math.sqrt(gt*gt-1),Wt=tn?Ot:0,$t=tn?0:Ot;if(ye&&this.addCurrentVertex(pe,Ue,Wt,$t,ce),Ut==="fakeround"){const St=Math.round(180*pt/Math.PI/20);for(let gn=1;gn<St;gn++){let ln=gn/St;if(ln!==.5){const zr=ln-.5;ln+=ln*zr*(ln-1)*((1.0904+et*(et*(3.55645-1.43519*et)-3.2452))*zr*zr+(.848013+et*(.215638*et-1.06021)))}const jn=ze.sub(Ue)._mult(ln)._add(Ue)._unit()._mult(tn?-1:1);this.addHalfVertex(pe,jn.x,jn.y,!1,tn,0,ce)}}_e&&this.addCurrentVertex(pe,ze,-Wt,-$t,ce)}else if(Ut==="butt")this.addCurrentVertex(pe,At,0,0,ce);else if(Ut==="square"){const Ot=ye?1:-1;this.addCurrentVertex(pe,At,Ot,Ot,ce)}else Ut==="round"&&(ye&&(this.addCurrentVertex(pe,Ue,0,0,ce),this.addCurrentVertex(pe,Ue,1,1,ce,!0)),_e&&(this.addCurrentVertex(pe,ze,-1,-1,ce,!0),this.addCurrentVertex(pe,ze,0,0,ce)));if(Zt&&tt<Z-1){const Ot=pe.dist(_e);if(Ot>2*Ae){const Wt=pe.add(_e.sub(pe)._mult(Ae/Ot)._round());this.updateDistance(pe,Wt),this.addCurrentVertex(Wt,ze,0,0,ce),pe=Wt}}}}addCurrentVertex(u,p,T,D,z,F=!1){const $=p.y*D-p.x,Z=-p.y-p.x*D;this.addHalfVertex(u,p.x+p.y*T,p.y-p.x*T,F,!1,T,z),this.addHalfVertex(u,$,Z,F,!0,-D,z),this.distance>G4/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(u,p,T,D,z,F))}addHalfVertex({x:u,y:p},T,D,z,F,$,Z){const re=.5*(this.lineClips?this.scaledDistance*(G4-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((u<<1)+(z?1:0),(p<<1)+(F?1:0),Math.round(63*T)+128,Math.round(63*D)+128,1+($===0?0:$<0?-1:1)|(63&re)<<2,re>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Ae=Z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Ae),Z.primitiveLength++),F?this.e2=Ae:this.e1=Ae}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(u,p){this.distance+=u.dist(p),this.updateScaledDistance()}}Nt("LineBucket",$v,{omit:["layers","patternFeatures"]});const fN=new Nr({"line-cap":new Yt(ct.layout_line["line-cap"]),"line-join":new Xt(ct.layout_line["line-join"]),"line-miter-limit":new Yt(ct.layout_line["line-miter-limit"]),"line-round-limit":new Yt(ct.layout_line["line-round-limit"]),"line-sort-key":new Xt(ct.layout_line["line-sort-key"])});var $4={paint:new Nr({"line-opacity":new Xt(ct.paint_line["line-opacity"]),"line-color":new Xt(ct.paint_line["line-color"]),"line-translate":new Yt(ct.paint_line["line-translate"]),"line-translate-anchor":new Yt(ct.paint_line["line-translate-anchor"]),"line-width":new Xt(ct.paint_line["line-width"]),"line-gap-width":new Xt(ct.paint_line["line-gap-width"]),"line-offset":new Xt(ct.paint_line["line-offset"]),"line-blur":new Xt(ct.paint_line["line-blur"]),"line-dasharray":new Yi(ct.paint_line["line-dasharray"]),"line-pattern":new hn(ct.paint_line["line-pattern"]),"line-gradient":new Qo(ct.paint_line["line-gradient"])}),layout:fN};const j4=new class extends Xt{possiblyEvaluate(f,u){return u=new br(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(f,u)}evaluate(f,u,p,T){return u=H({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(f,u,p,T)}}($4.paint.properties["line-width"].specification);function H4(f,u){return u>0?u+2*f:f}j4.useIntegerZoom=!0;const dN=Ur([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),pN=Ur([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ur([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const gN=Ur([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Ur([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const W4=Ur([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),mN=Ur([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function yN(f,u,p){return f.sections.forEach(T=>{T.text=function(D,z,F){const $=z.layout.get("text-transform").evaluate(F,{});return $==="uppercase"?D=D.toLocaleUpperCase():$==="lowercase"&&(D=D.toLocaleLowerCase()),cs.applyArabicShaping&&(D=cs.applyArabicShaping(D)),D}(T.text,u,p)}),f}Ur([{name:"triangle",components:3,type:"Uint16"}]),Ur([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ur([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ur([{type:"Float32",name:"offsetX"}]),Ur([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const jd={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Xi=24,jv=Sr,Q4=function(f,u,p,T,D){var z,F,$=8*D-T-1,Z=(1<<$)-1,re=Z>>1,Ae=-7,ce=p?D-1:0,pe=p?-1:1,ye=f[u+ce];for(ce+=pe,z=ye&(1<<-Ae)-1,ye>>=-Ae,Ae+=$;Ae>0;z=256*z+f[u+ce],ce+=pe,Ae-=8);for(F=z&(1<<-Ae)-1,z>>=-Ae,Ae+=T;Ae>0;F=256*F+f[u+ce],ce+=pe,Ae-=8);if(z===0)z=1-re;else{if(z===Z)return F?NaN:1/0*(ye?-1:1);F+=Math.pow(2,T),z-=re}return(ye?-1:1)*F*Math.pow(2,z-T)},q4=function(f,u,p,T,D,z){var F,$,Z,re=8*z-D-1,Ae=(1<<re)-1,ce=Ae>>1,pe=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,ye=T?0:z-1,_e=T?1:-1,Ue=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?($=isNaN(u)?1:0,F=Ae):(F=Math.floor(Math.log(u)/Math.LN2),u*(Z=Math.pow(2,-F))<1&&(F--,Z*=2),(u+=F+ce>=1?pe/Z:pe*Math.pow(2,1-ce))*Z>=2&&(F++,Z/=2),F+ce>=Ae?($=0,F=Ae):F+ce>=1?($=(u*Z-1)*Math.pow(2,D),F+=ce):($=u*Math.pow(2,ce-1)*Math.pow(2,D),F=0));D>=8;f[p+ye]=255&$,ye+=_e,$/=256,D-=8);for(F=F<<D|$,re+=D;re>0;f[p+ye]=255&F,ye+=_e,F/=256,re-=8);f[p+ye-_e]|=128*Ue};function Sr(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}Sr.Varint=0,Sr.Fixed64=1,Sr.Bytes=2,Sr.Fixed32=5;var wc,Hv=4294967296,Z4=1/Hv,Y4=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function gu(f){return f.type===Sr.Bytes?f.readVarint()+f.pos:f.pos+1}function Ff(f,u,p){return p?4294967296*u+(f>>>0):4294967296*(u>>>0)+(f>>>0)}function X4(f,u,p){var T=u<=16383?1:u<=2097151?2:u<=268435455?3:Math.floor(Math.log(u)/(7*Math.LN2));p.realloc(T);for(var D=p.pos-1;D>=f;D--)p.buf[D+T]=p.buf[D]}function _N(f,u){for(var p=0;p<f.length;p++)u.writeVarint(f[p])}function vN(f,u){for(var p=0;p<f.length;p++)u.writeSVarint(f[p])}function xN(f,u){for(var p=0;p<f.length;p++)u.writeFloat(f[p])}function wN(f,u){for(var p=0;p<f.length;p++)u.writeDouble(f[p])}function bN(f,u){for(var p=0;p<f.length;p++)u.writeBoolean(f[p])}function EN(f,u){for(var p=0;p<f.length;p++)u.writeFixed32(f[p])}function TN(f,u){for(var p=0;p<f.length;p++)u.writeSFixed32(f[p])}function SN(f,u){for(var p=0;p<f.length;p++)u.writeFixed64(f[p])}function MN(f,u){for(var p=0;p<f.length;p++)u.writeSFixed64(f[p])}function Rm(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+16777216*f[u+3]}function Nf(f,u,p){f[p]=u,f[p+1]=u>>>8,f[p+2]=u>>>16,f[p+3]=u>>>24}function K4(f,u){return(f[u]|f[u+1]<<8|f[u+2]<<16)+(f[u+3]<<24)}function CN(f,u,p){f===1&&p.readMessage(PN,u)}function PN(f,u,p){if(f===3){const{id:T,bitmap:D,width:z,height:F,left:$,top:Z,advance:re}=p.readMessage(IN,{});u.push({id:T,bitmap:new Od({width:z+6,height:F+6},D),metrics:{width:z,height:F,left:$,top:Z,advance:re}})}}function IN(f,u,p){f===1?u.id=p.readVarint():f===2?u.bitmap=p.readBytes():f===3?u.width=p.readVarint():f===4?u.height=p.readVarint():f===5?u.left=p.readSVarint():f===6?u.top=p.readSVarint():f===7&&(u.advance=p.readVarint())}function J4(f){let u=0,p=0;for(const F of f)u+=F.w*F.h,p=Math.max(p,F.w);f.sort((F,$)=>$.h-F.h);const T=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),p),h:1/0}];let D=0,z=0;for(const F of f)for(let $=T.length-1;$>=0;$--){const Z=T[$];if(!(F.w>Z.w||F.h>Z.h)){if(F.x=Z.x,F.y=Z.y,z=Math.max(z,F.y+F.h),D=Math.max(D,F.x+F.w),F.w===Z.w&&F.h===Z.h){const re=T.pop();$<T.length&&(T[$]=re)}else F.h===Z.h?(Z.x+=F.w,Z.w-=F.w):F.w===Z.w?(Z.y+=F.h,Z.h-=F.h):(T.push({x:Z.x+F.w,y:Z.y,w:Z.w-F.w,h:F.h}),Z.y+=F.h,Z.h-=F.h);break}}return{w:D,h:z,fill:u/(D*z)||0}}Sr.prototype={destroy:function(){this.buf=null},readFields:function(f,u,p){for(p=p||this.length;this.pos<p;){var T=this.readVarint(),D=T>>3,z=this.pos;this.type=7&T,f(D,u,this),this.pos===z&&this.skip(T)}return u},readMessage:function(f,u){return this.readFields(f,u,this.readVarint()+this.pos)},readFixed32:function(){var f=Rm(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=K4(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=Rm(this.buf,this.pos)+Rm(this.buf,this.pos+4)*Hv;return this.pos+=8,f},readSFixed64:function(){var f=Rm(this.buf,this.pos)+K4(this.buf,this.pos+4)*Hv;return this.pos+=8,f},readFloat:function(){var f=Q4(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=Q4(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var u,p,T=this.buf;return u=127&(p=T[this.pos++]),p<128?u:(u|=(127&(p=T[this.pos++]))<<7,p<128?u:(u|=(127&(p=T[this.pos++]))<<14,p<128?u:(u|=(127&(p=T[this.pos++]))<<21,p<128?u:function(D,z,F){var $,Z,re=F.buf;if($=(112&(Z=re[F.pos++]))>>4,Z<128||($|=(127&(Z=re[F.pos++]))<<3,Z<128)||($|=(127&(Z=re[F.pos++]))<<10,Z<128)||($|=(127&(Z=re[F.pos++]))<<17,Z<128)||($|=(127&(Z=re[F.pos++]))<<24,Z<128)||($|=(1&(Z=re[F.pos++]))<<31,Z<128))return Ff(D,$,z);throw new Error("Expected varint not more than 10 bytes")}(u|=(15&(p=T[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var f=this.readVarint()+this.pos,u=this.pos;return this.pos=f,f-u>=12&&Y4?function(p,T,D){return Y4.decode(p.subarray(T,D))}(this.buf,u,f):function(p,T,D){for(var z="",F=T;F<D;){var $,Z,re,Ae=p[F],ce=null,pe=Ae>239?4:Ae>223?3:Ae>191?2:1;if(F+pe>D)break;pe===1?Ae<128&&(ce=Ae):pe===2?(192&($=p[F+1]))==128&&(ce=(31&Ae)<<6|63&$)<=127&&(ce=null):pe===3?(Z=p[F+2],(192&($=p[F+1]))==128&&(192&Z)==128&&((ce=(15&Ae)<<12|(63&$)<<6|63&Z)<=2047||ce>=55296&&ce<=57343)&&(ce=null)):pe===4&&(Z=p[F+2],re=p[F+3],(192&($=p[F+1]))==128&&(192&Z)==128&&(192&re)==128&&((ce=(15&Ae)<<18|(63&$)<<12|(63&Z)<<6|63&re)<=65535||ce>=1114112)&&(ce=null)),ce===null?(ce=65533,pe=1):ce>65535&&(ce-=65536,z+=String.fromCharCode(ce>>>10&1023|55296),ce=56320|1023&ce),z+=String.fromCharCode(ce),F+=pe}return z}(this.buf,u,f)},readBytes:function(){var f=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,f);return this.pos=f,u},readPackedVarint:function(f,u){if(this.type!==Sr.Bytes)return f.push(this.readVarint(u));var p=gu(this);for(f=f||[];this.pos<p;)f.push(this.readVarint(u));return f},readPackedSVarint:function(f){if(this.type!==Sr.Bytes)return f.push(this.readSVarint());var u=gu(this);for(f=f||[];this.pos<u;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==Sr.Bytes)return f.push(this.readBoolean());var u=gu(this);for(f=f||[];this.pos<u;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==Sr.Bytes)return f.push(this.readFloat());var u=gu(this);for(f=f||[];this.pos<u;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==Sr.Bytes)return f.push(this.readDouble());var u=gu(this);for(f=f||[];this.pos<u;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==Sr.Bytes)return f.push(this.readFixed32());var u=gu(this);for(f=f||[];this.pos<u;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==Sr.Bytes)return f.push(this.readSFixed32());var u=gu(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==Sr.Bytes)return f.push(this.readFixed64());var u=gu(this);for(f=f||[];this.pos<u;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==Sr.Bytes)return f.push(this.readSFixed64());var u=gu(this);for(f=f||[];this.pos<u;)f.push(this.readSFixed64());return f},skip:function(f){var u=7&f;if(u===Sr.Varint)for(;this.buf[this.pos++]>127;);else if(u===Sr.Bytes)this.pos=this.readVarint()+this.pos;else if(u===Sr.Fixed32)this.pos+=4;else{if(u!==Sr.Fixed64)throw new Error("Unimplemented type: "+u);this.pos+=8}},writeTag:function(f,u){this.writeVarint(f<<3|u)},realloc:function(f){for(var u=this.length||16;u<this.pos+f;)u*=2;if(u!==this.length){var p=new Uint8Array(u);p.set(this.buf),this.buf=p,this.length=u}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),Nf(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),Nf(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),Nf(this.buf,-1&f,this.pos),Nf(this.buf,Math.floor(f*Z4),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),Nf(this.buf,-1&f,this.pos),Nf(this.buf,Math.floor(f*Z4),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(u,p){var T,D;if(u>=0?(T=u%4294967296|0,D=u/4294967296|0):(D=~(-u/4294967296),4294967295^(T=~(-u%4294967296))?T=T+1|0:(T=0,D=D+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");p.realloc(10),function(z,F,$){$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,z>>>=7,$.buf[$.pos++]=127&z|128,$.buf[$.pos]=127&(z>>>=7)}(T,0,p),function(z,F){var $=(7&z)<<4;F.buf[F.pos++]|=$|((z>>>=3)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z|((z>>>=7)?128:0),z&&(F.buf[F.pos++]=127&z)))))}(D,p)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(!!f)},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var u=this.pos;this.pos=function(T,D,z){for(var F,$,Z=0;Z<D.length;Z++){if((F=D.charCodeAt(Z))>55295&&F<57344){if(!$){F>56319||Z+1===D.length?(T[z++]=239,T[z++]=191,T[z++]=189):$=F;continue}if(F<56320){T[z++]=239,T[z++]=191,T[z++]=189,$=F;continue}F=$-55296<<10|F-56320|65536,$=null}else $&&(T[z++]=239,T[z++]=191,T[z++]=189,$=null);F<128?T[z++]=F:(F<2048?T[z++]=F>>6|192:(F<65536?T[z++]=F>>12|224:(T[z++]=F>>18|240,T[z++]=F>>12&63|128),T[z++]=F>>6&63|128),T[z++]=63&F|128)}return z}(this.buf,f,this.pos);var p=this.pos-u;p>=128&&X4(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeFloat:function(f){this.realloc(4),q4(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),q4(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var u=f.length;this.writeVarint(u),this.realloc(u);for(var p=0;p<u;p++)this.buf[this.pos++]=f[p]},writeRawMessage:function(f,u){this.pos++;var p=this.pos;f(u,this);var T=this.pos-p;T>=128&&X4(p,T,this),this.pos=p-1,this.writeVarint(T),this.pos+=T},writeMessage:function(f,u,p){this.writeTag(f,Sr.Bytes),this.writeRawMessage(u,p)},writePackedVarint:function(f,u){u.length&&this.writeMessage(f,_N,u)},writePackedSVarint:function(f,u){u.length&&this.writeMessage(f,vN,u)},writePackedBoolean:function(f,u){u.length&&this.writeMessage(f,bN,u)},writePackedFloat:function(f,u){u.length&&this.writeMessage(f,xN,u)},writePackedDouble:function(f,u){u.length&&this.writeMessage(f,wN,u)},writePackedFixed32:function(f,u){u.length&&this.writeMessage(f,EN,u)},writePackedSFixed32:function(f,u){u.length&&this.writeMessage(f,TN,u)},writePackedFixed64:function(f,u){u.length&&this.writeMessage(f,SN,u)},writePackedSFixed64:function(f,u){u.length&&this.writeMessage(f,MN,u)},writeBytesField:function(f,u){this.writeTag(f,Sr.Bytes),this.writeBytes(u)},writeFixed32Field:function(f,u){this.writeTag(f,Sr.Fixed32),this.writeFixed32(u)},writeSFixed32Field:function(f,u){this.writeTag(f,Sr.Fixed32),this.writeSFixed32(u)},writeFixed64Field:function(f,u){this.writeTag(f,Sr.Fixed64),this.writeFixed64(u)},writeSFixed64Field:function(f,u){this.writeTag(f,Sr.Fixed64),this.writeSFixed64(u)},writeVarintField:function(f,u){this.writeTag(f,Sr.Varint),this.writeVarint(u)},writeSVarintField:function(f,u){this.writeTag(f,Sr.Varint),this.writeSVarint(u)},writeStringField:function(f,u){this.writeTag(f,Sr.Bytes),this.writeString(u)},writeFloatField:function(f,u){this.writeTag(f,Sr.Fixed32),this.writeFloat(u)},writeDoubleField:function(f,u){this.writeTag(f,Sr.Fixed64),this.writeDouble(u)},writeBooleanField:function(f,u){this.writeVarintField(f,!!u)}};class Wv{constructor(u,{pixelRatio:p,version:T,stretchX:D,stretchY:z,content:F}){this.paddedRect=u,this.pixelRatio=p,this.stretchX=D,this.stretchY=z,this.content=F,this.version=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class e5{constructor(u,p){const T={},D={};this.haveRenderCallbacks=[];const z=[];this.addImages(u,T,z),this.addImages(p,D,z);const{w:F,h:$}=J4(z),Z=new _a({width:F||1,height:$||1});for(const re in u){const Ae=u[re],ce=T[re].paddedRect;_a.copy(Ae.data,Z,{x:0,y:0},{x:ce.x+1,y:ce.y+1},Ae.data)}for(const re in p){const Ae=p[re],ce=D[re].paddedRect,pe=ce.x+1,ye=ce.y+1,_e=Ae.data.width,Ue=Ae.data.height;_a.copy(Ae.data,Z,{x:0,y:0},{x:pe,y:ye},Ae.data),_a.copy(Ae.data,Z,{x:0,y:Ue-1},{x:pe,y:ye-1},{width:_e,height:1}),_a.copy(Ae.data,Z,{x:0,y:0},{x:pe,y:ye+Ue},{width:_e,height:1}),_a.copy(Ae.data,Z,{x:_e-1,y:0},{x:pe-1,y:ye},{width:1,height:Ue}),_a.copy(Ae.data,Z,{x:0,y:0},{x:pe+_e,y:ye},{width:1,height:Ue})}this.image=Z,this.iconPositions=T,this.patternPositions=D}addImages(u,p,T){for(const D in u){const z=u[D],F={x:0,y:0,w:z.data.width+2,h:z.data.height+2};T.push(F),p[D]=new Wv(F,z),z.hasRenderCallback&&this.haveRenderCallbacks.push(D)}}patchUpdatedImages(u,p){u.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const T in u.updatedImages)this.patchUpdatedImage(this.iconPositions[T],u.getImage(T),p),this.patchUpdatedImage(this.patternPositions[T],u.getImage(T),p)}patchUpdatedImage(u,p,T){if(!u||!p||u.version===p.version)return;u.version=p.version;const[D,z]=u.tl;T.update(p.data,void 0,{x:D,y:z})}}Nt("ImagePosition",Wv),Nt("ImageAtlas",e5),o.WritingMode=void 0,(wc=o.WritingMode||(o.WritingMode={}))[wc.none=0]="none",wc[wc.horizontal=1]="horizontal",wc[wc.vertical=2]="vertical",wc[wc.horizontalOnly=3]="horizontalOnly";const Bm=-17;class Hd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(u,p){const T=new Hd;return T.scale=u||1,T.fontStack=p,T}static forImage(u){const p=new Hd;return p.imageName=u,p}}class Uf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(u,p){const T=new Uf;for(let D=0;D<u.sections.length;D++){const z=u.sections[D];z.image?T.addImageSection(z):T.addTextSection(z,p)}return T}length(){return this.text.length}getSection(u){return this.sections[this.sectionIndex[u]]}getSectionIndex(u){return this.sectionIndex[u]}getCharCode(u){return this.text.charCodeAt(u)}verticalizePunctuation(){this.text=function(u){let p="";for(let T=0;T<u.length;T++){const D=u.charCodeAt(T+1)||null,z=u.charCodeAt(T-1)||null;p+=D&&Gs(D)&&!jd[u[T+1]]||z&&Gs(z)&&!jd[u[T-1]]||!jd[u[T]]?u[T]:jd[u[T]]}return p}(this.text)}trim(){let u=0;for(let T=0;T<this.text.length&&Om[this.text.charCodeAt(T)];T++)u++;let p=this.text.length;for(let T=this.text.length-1;T>=0&&T>=u&&Om[this.text.charCodeAt(T)];T--)p--;this.text=this.text.substring(u,p),this.sectionIndex=this.sectionIndex.slice(u,p)}substring(u,p){const T=new Uf;return T.text=this.text.substring(u,p),T.sectionIndex=this.sectionIndex.slice(u,p),T.sections=this.sections,T}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((u,p)=>Math.max(u,this.sections[p].scale),0)}addTextSection(u,p){this.text+=u.text,this.sections.push(Hd.forText(u.scale,u.fontStack||p));const T=this.sections.length-1;for(let D=0;D<u.text.length;++D)this.sectionIndex.push(T)}addImageSection(u){const p=u.image?u.image.name:"";if(p.length===0)return void me("Can't add FormattedSection with an empty image.");const T=this.getNextImageSectionCharCode();T?(this.text+=String.fromCharCode(T),this.sections.push(Hd.forImage(p)),this.sectionIndex.push(this.sections.length-1)):me("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function zm(f,u,p,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ue){const ze=Uf.fromFeature(f,D);let tt;ce===o.WritingMode.vertical&&ze.verticalizePunctuation();const{processBidirectionalText:At,processStyledBidirectionalText:et}=cs;if(At&&ze.sections.length===1){tt=[];const pt=At(ze.toString(),Qv(ze,re,z,u,T,ye,_e));for(const Zt of pt){const tn=new Uf;tn.text=Zt,tn.sections=ze.sections;for(let Ht=0;Ht<Zt.length;Ht++)tn.sectionIndex.push(0);tt.push(tn)}}else if(et){tt=[];const pt=et(ze.text,ze.sectionIndex,Qv(ze,re,z,u,T,ye,_e));for(const Zt of pt){const tn=new Uf;tn.text=Zt[0],tn.sectionIndex=Zt[1],tn.sections=ze.sections,tt.push(tn)}}else tt=function(pt,Zt){const tn=[],Ht=pt.text;let Ut=0;for(const Ot of Zt)tn.push(pt.substring(Ut,Ot)),Ut=Ot;return Ut<Ht.length&&tn.push(pt.substring(Ut,Ht.length)),tn}(ze,Qv(ze,re,z,u,T,ye,_e));const ot=[],gt={positionedLines:ot,text:ze.toString(),top:Ae[1],bottom:Ae[1],left:Ae[0],right:Ae[0],writingMode:ce,iconsInText:!1,verticalizable:!1};return function(pt,Zt,tn,Ht,Ut,Ot,Wt,$t,St,gn,ln,jn){let zr=0,Vr=Bm,Di=0,xa=0;const hs=$t==="right"?1:$t==="left"?0:.5;let vi=0;for(const xi of Ut){xi.trim();const ds=xi.getMaxScale(),Ms=(ds-1)*Xi,Zs={positionedGlyphs:[],lineOffset:0};pt.positionedLines[vi]=Zs;const bo=Zs.positionedGlyphs;let Eo=0;if(!xi.length()){Vr+=Ot,++vi;continue}for(let Hi=0;Hi<xi.length();Hi++){const Xn=xi.getSection(Hi),qo=xi.getSectionIndex(Hi),ps=xi.getCharCode(Hi);let Cs=0,Ka=null,zl=null,Ol=null,yu=Xi;const Ja=!(St===o.WritingMode.horizontal||!ln&&!qa(ps)||ln&&(Om[ps]||(ji=ps,Vt.Arabic(ji)||Vt["Arabic Supplement"](ji)||Vt["Arabic Extended-A"](ji)||Vt["Arabic Presentation Forms-A"](ji)||Vt["Arabic Presentation Forms-B"](ji))));if(Xn.imageName){const wa=Ht[Xn.imageName];if(!wa)continue;Ol=Xn.imageName,pt.iconsInText=pt.iconsInText||!0,zl=wa.paddedRect;const To=wa.displaySize;Xn.scale=Xn.scale*Xi/jn,Ka={width:To[0],height:To[1],left:1,top:-3,advance:Ja?To[1]:To[0]},Cs=Ms+(Xi-To[1]*Xn.scale),yu=Ka.advance;const _u=Ja?To[0]*Xn.scale-Xi*ds:To[1]*Xn.scale-Xi*ds;_u>0&&_u>Eo&&(Eo=_u)}else{const wa=tn[Xn.fontStack],To=wa&&wa[ps];if(To&&To.rect)zl=To.rect,Ka=To.metrics;else{const _u=Zt[Xn.fontStack],qd=_u&&_u[ps];if(!qd)continue;Ka=qd.metrics}Cs=(ds-Xn.scale)*Xi}Ja?(pt.verticalizable=!0,bo.push({glyph:ps,imageName:Ol,x:zr,y:Vr+Cs,vertical:Ja,scale:Xn.scale,fontStack:Xn.fontStack,sectionIndex:qo,metrics:Ka,rect:zl}),zr+=yu*Xn.scale+gn):(bo.push({glyph:ps,imageName:Ol,x:zr,y:Vr+Cs,vertical:Ja,scale:Xn.scale,fontStack:Xn.fontStack,sectionIndex:qo,metrics:Ka,rect:zl}),zr+=Ka.advance*Xn.scale+gn)}bo.length!==0&&(Di=Math.max(zr-gn,Di),DN(bo,0,bo.length-1,hs,Eo)),zr=0;const qr=Ot*ds+Eo;Zs.lineOffset=Math.max(Eo,Ms),Vr+=qr,xa=Math.max(qr,xa),++vi}var ji;const fs=Vr-Bm,{horizontalAlign:Ss,verticalAlign:wo}=qv(Wt);(function(xi,ds,Ms,Zs,bo,Eo,qr,Hi,Xn){const qo=(ds-Ms)*bo;let ps=0;ps=Eo!==qr?-Hi*Zs-Bm:(-Zs*Xn+.5)*qr;for(const Cs of xi)for(const Ka of Cs.positionedGlyphs)Ka.x+=qo,Ka.y+=ps})(pt.positionedLines,hs,Ss,wo,Di,xa,Ot,fs,Ut.length),pt.top+=-wo*fs,pt.bottom=pt.top+fs,pt.left+=-Ss*Di,pt.right=pt.left+Di}(gt,u,p,T,tt,F,$,Z,ce,re,pe,Ue),!function(pt){for(const Zt of pt)if(Zt.positionedGlyphs.length!==0)return!1;return!0}(ot)&&gt}const Om={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},kN={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function t5(f,u,p,T,D,z){if(u.imageName){const F=T[u.imageName];return F?F.displaySize[0]*u.scale*Xi/z+D:0}{const F=p[u.fontStack],$=F&&F[f];return $?$.metrics.advance*u.scale+D:0}}function n5(f,u,p,T){const D=Math.pow(f-u,2);return T?f<u?D/2:2*D:D+Math.abs(p)*p}function LN(f,u,p){let T=0;return f===10&&(T-=1e4),p&&(T+=150),f!==40&&f!==65288||(T+=50),u!==41&&u!==65289||(T+=50),T}function r5(f,u,p,T,D,z){let F=null,$=n5(u,p,D,z);for(const Z of T){const re=n5(u-Z.x,p,D,z)+Z.badness;re<=$&&(F=Z,$=re)}return{index:f,x:u,priorBreak:F,badness:$}}function i5(f){return f?i5(f.priorBreak).concat(f.index):[]}function Qv(f,u,p,T,D,z,F){if(z!=="point")return[];if(!f)return[];const $=[],Z=function(pe,ye,_e,Ue,ze,tt){let At=0;for(let et=0;et<pe.length();et++){const ot=pe.getSection(et);At+=t5(pe.getCharCode(et),ot,Ue,ze,ye,tt)}return At/Math.max(1,Math.ceil(At/_e))}(f,u,p,T,D,F),re=f.text.indexOf("")>=0;let Ae=0;for(let pe=0;pe<f.length();pe++){const ye=f.getSection(pe),_e=f.getCharCode(pe);if(Om[_e]||(Ae+=t5(_e,ye,T,D,u,F)),pe<f.length()-1){const Ue=!((ce=_e)<11904||!(Vt["Bopomofo Extended"](ce)||Vt.Bopomofo(ce)||Vt["CJK Compatibility Forms"](ce)||Vt["CJK Compatibility Ideographs"](ce)||Vt["CJK Compatibility"](ce)||Vt["CJK Radicals Supplement"](ce)||Vt["CJK Strokes"](ce)||Vt["CJK Symbols and Punctuation"](ce)||Vt["CJK Unified Ideographs Extension A"](ce)||Vt["CJK Unified Ideographs"](ce)||Vt["Enclosed CJK Letters and Months"](ce)||Vt["Halfwidth and Fullwidth Forms"](ce)||Vt.Hiragana(ce)||Vt["Ideographic Description Characters"](ce)||Vt["Kangxi Radicals"](ce)||Vt["Katakana Phonetic Extensions"](ce)||Vt.Katakana(ce)||Vt["Vertical Forms"](ce)||Vt["Yi Radicals"](ce)||Vt["Yi Syllables"](ce)));(kN[_e]||Ue||ye.imageName)&&$.push(r5(pe+1,Ae,Z,$,LN(_e,f.getCharCode(pe+1),Ue&&re),!1))}}var ce;return i5(r5(f.length(),Ae,Z,$,0,!0))}function qv(f){let u=.5,p=.5;switch(f){case"right":case"top-right":case"bottom-right":u=1;break;case"left":case"top-left":case"bottom-left":u=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":p=1;break;case"top":case"top-right":case"top-left":p=0}return{horizontalAlign:u,verticalAlign:p}}function DN(f,u,p,T,D){if(!T&&!D)return;const z=f[p],F=(f[p].x+z.metrics.advance*z.scale)*T;for(let $=u;$<=p;$++)f[$].x-=F,f[$].y+=D}function RN(f,u,p){const{horizontalAlign:T,verticalAlign:D}=qv(p),z=u[0]-f.displaySize[0]*T,F=u[1]-f.displaySize[1]*D;return{image:f,top:F,bottom:F+f.displaySize[1],left:z,right:z+f.displaySize[0]}}function s5(f,u,p,T,D,z){const F=f.image;let $;if(F.content){const ze=F.content,tt=F.pixelRatio||1;$=[ze[0]/tt,ze[1]/tt,F.displaySize[0]-ze[2]/tt,F.displaySize[1]-ze[3]/tt]}const Z=u.left*z,re=u.right*z;let Ae,ce,pe,ye;p==="width"||p==="both"?(ye=D[0]+Z-T[3],ce=D[0]+re+T[1]):(ye=D[0]+(Z+re-F.displaySize[0])/2,ce=ye+F.displaySize[0]);const _e=u.top*z,Ue=u.bottom*z;return p==="height"||p==="both"?(Ae=D[1]+_e-T[0],pe=D[1]+Ue+T[2]):(Ae=D[1]+(_e+Ue-F.displaySize[1])/2,pe=Ae+F.displaySize[1]),{image:F,top:Ae,right:ce,bottom:pe,left:ye,collisionPadding:$}}const mu=128;function o5(f,u){const{expression:p}=u;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new br(f+1))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:T,interpolationType:D}=p;let z=0;for(;z<T.length&&T[z]<=f;)z++;z=Math.max(0,z-1);let F=z;for(;F<T.length&&T[F]<f+1;)F++;F=Math.min(T.length-1,F);const $=T[z],Z=T[F];return p.kind==="composite"?{kind:"composite",minZoom:$,maxZoom:Z,interpolationType:D}:{kind:"camera",minZoom:$,maxZoom:Z,minSize:p.evaluate(new br($)),maxSize:p.evaluate(new br(Z)),interpolationType:D}}}class bc extends Tt{constructor(u,p,T,D){super(u,p),this.angle=T,D!==void 0&&(this.segment=D)}clone(){return new bc(this.x,this.y,this.angle,this.segment)}}function a5(f,u,p,T,D){if(u.segment===void 0)return!0;let z=u,F=u.segment+1,$=0;for(;$>-p/2;){if(F--,F<0)return!1;$-=f[F].dist(z),z=f[F]}$+=f[F].dist(f[F+1]),F++;const Z=[];let re=0;for(;$<p/2;){const Ae=f[F],ce=f[F+1];if(!ce)return!1;let pe=f[F-1].angleTo(Ae)-Ae.angleTo(ce);for(pe=Math.abs((pe+3*Math.PI)%(2*Math.PI)-Math.PI),Z.push({distance:$,angleDelta:pe}),re+=pe;$-Z[0].distance>T;)re-=Z.shift().angleDelta;if(re>D)return!1;F++,$+=Ae.dist(ce)}return!0}function l5(f){let u=0;for(let p=0;p<f.length-1;p++)u+=f[p].dist(f[p+1]);return u}function A5(f,u,p){return f?.6*u*p:0}function u5(f,u){return Math.max(f?f.right-f.left:0,u?u.right-u.left:0)}function BN(f,u,p,T,D,z){const F=A5(p,D,z),$=u5(p,T)*z;let Z=0;const re=l5(f)/2;for(let Ae=0;Ae<f.length-1;Ae++){const ce=f[Ae],pe=f[Ae+1],ye=ce.dist(pe);if(Z+ye>re){const _e=(re-Z)/ye,Ue=en(ce.x,pe.x,_e),ze=en(ce.y,pe.y,_e),tt=new bc(Ue,ze,pe.angleTo(ce),Ae);return tt._round(),!F||a5(f,tt,$,F,u)?tt:void 0}Z+=ye}}function zN(f,u,p,T,D,z,F,$,Z){const re=A5(T,z,F),Ae=u5(T,D),ce=Ae*F,pe=f[0].x===0||f[0].x===Z||f[0].y===0||f[0].y===Z;return u-ce<u/4&&(u=ce+u/4),c5(f,pe?u/2*$%u:(Ae/2+2*z)*F*$%u,u,re,p,ce,pe,!1,Z)}function c5(f,u,p,T,D,z,F,$,Z){const re=z/2,Ae=l5(f);let ce=0,pe=u-p,ye=[];for(let _e=0;_e<f.length-1;_e++){const Ue=f[_e],ze=f[_e+1],tt=Ue.dist(ze),At=ze.angleTo(Ue);for(;pe+p<ce+tt;){pe+=p;const et=(pe-ce)/tt,ot=en(Ue.x,ze.x,et),gt=en(Ue.y,ze.y,et);if(ot>=0&&ot<Z&&gt>=0&&gt<Z&&pe-re>=0&&pe+re<=Ae){const pt=new bc(ot,gt,At,_e);pt._round(),T&&!a5(f,pt,z,T,D)||ye.push(pt)}}ce+=tt}return $||ye.length||F||(ye=c5(f,ce/2,p,T,D,z,F,!0,Z)),ye}function h5(f,u,p,T,D){const z=[];for(let F=0;F<f.length;F++){const $=f[F];let Z;for(let re=0;re<$.length-1;re++){let Ae=$[re],ce=$[re+1];Ae.x<u&&ce.x<u||(Ae.x<u?Ae=new Tt(u,Ae.y+(u-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x<u&&(ce=new Tt(u,Ae.y+(u-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y<p&&ce.y<p||(Ae.y<p?Ae=new Tt(Ae.x+(p-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),p)._round():ce.y<p&&(ce=new Tt(Ae.x+(p-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),p)._round()),Ae.x>=T&&ce.x>=T||(Ae.x>=T?Ae=new Tt(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round():ce.x>=T&&(ce=new Tt(T,Ae.y+(T-Ae.x)/(ce.x-Ae.x)*(ce.y-Ae.y))._round()),Ae.y>=D&&ce.y>=D||(Ae.y>=D?Ae=new Tt(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round():ce.y>=D&&(ce=new Tt(Ae.x+(D-Ae.y)/(ce.y-Ae.y)*(ce.x-Ae.x),D)._round()),Z&&Ae.equals(Z[Z.length-1])||(Z=[Ae],z.push(Z)),Z.push(ce)))))}}return z}function f5(f,u,p,T){const D=[],z=f.image,F=z.pixelRatio,$=z.paddedRect.w-2,Z=z.paddedRect.h-2,re=f.right-f.left,Ae=f.bottom-f.top,ce=z.stretchX||[[0,$]],pe=z.stretchY||[[0,Z]],ye=(Ot,Wt)=>Ot+Wt[1]-Wt[0],_e=ce.reduce(ye,0),Ue=pe.reduce(ye,0),ze=$-_e,tt=Z-Ue;let At=0,et=_e,ot=0,gt=Ue,pt=0,Zt=ze,tn=0,Ht=tt;if(z.content&&T){const Ot=z.content;At=Fm(ce,0,Ot[0]),ot=Fm(pe,0,Ot[1]),et=Fm(ce,Ot[0],Ot[2]),gt=Fm(pe,Ot[1],Ot[3]),pt=Ot[0]-At,tn=Ot[1]-ot,Zt=Ot[2]-Ot[0]-et,Ht=Ot[3]-Ot[1]-gt}const Ut=(Ot,Wt,$t,St)=>{const gn=Nm(Ot.stretch-At,et,re,f.left),ln=Um(Ot.fixed-pt,Zt,Ot.stretch,_e),jn=Nm(Wt.stretch-ot,gt,Ae,f.top),zr=Um(Wt.fixed-tn,Ht,Wt.stretch,Ue),Vr=Nm($t.stretch-At,et,re,f.left),Di=Um($t.fixed-pt,Zt,$t.stretch,_e),xa=Nm(St.stretch-ot,gt,Ae,f.top),hs=Um(St.fixed-tn,Ht,St.stretch,Ue),vi=new Tt(gn,jn),ji=new Tt(Vr,jn),fs=new Tt(Vr,xa),Ss=new Tt(gn,xa),wo=new Tt(ln/F,zr/F),xi=new Tt(Di/F,hs/F),ds=u*Math.PI/180;if(ds){const bo=Math.sin(ds),Eo=Math.cos(ds),qr=[Eo,-bo,bo,Eo];vi._matMult(qr),ji._matMult(qr),Ss._matMult(qr),fs._matMult(qr)}const Ms=Ot.stretch+Ot.fixed,Zs=Wt.stretch+Wt.fixed;return{tl:vi,tr:ji,bl:Ss,br:fs,tex:{x:z.paddedRect.x+1+Ms,y:z.paddedRect.y+1+Zs,w:$t.stretch+$t.fixed-Ms,h:St.stretch+St.fixed-Zs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:wo,pixelOffsetBR:xi,minFontScaleX:Zt/F/re,minFontScaleY:Ht/F/Ae,isSDF:p}};if(T&&(z.stretchX||z.stretchY)){const Ot=d5(ce,ze,_e),Wt=d5(pe,tt,Ue);for(let $t=0;$t<Ot.length-1;$t++){const St=Ot[$t],gn=Ot[$t+1];for(let ln=0;ln<Wt.length-1;ln++)D.push(Ut(St,Wt[ln],gn,Wt[ln+1]))}}else D.push(Ut({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:$+1},{fixed:0,stretch:Z+1}));return D}function Fm(f,u,p){let T=0;for(const D of f)T+=Math.max(u,Math.min(p,D[1]))-Math.max(u,Math.min(p,D[0]));return T}function d5(f,u,p){const T=[{fixed:-1,stretch:0}];for(const[D,z]of f){const F=T[T.length-1];T.push({fixed:D-F.stretch,stretch:F.stretch}),T.push({fixed:D-F.stretch,stretch:F.stretch+(z-D)})}return T.push({fixed:u+1,stretch:p}),T}function Nm(f,u,p,T){return f/u*p+T}function Um(f,u,p,T){return f-u*p/T}Nt("Anchor",bc);class Vm{constructor(u,p,T,D,z,F,$,Z,re,Ae){if(this.boxStartIndex=u.length,re){let ce=F.top,pe=F.bottom;const ye=F.collisionPadding;ye&&(ce-=ye[1],pe+=ye[3]);let _e=pe-ce;_e>0&&(_e=Math.max(10,_e),this.circleDiameter=_e)}else{let ce=F.top*$-Z[0],pe=F.bottom*$+Z[2],ye=F.left*$-Z[3],_e=F.right*$+Z[1];const Ue=F.collisionPadding;if(Ue&&(ye-=Ue[0]*$,ce-=Ue[1]*$,_e+=Ue[2]*$,pe+=Ue[3]*$),Ae){const ze=new Tt(ye,ce),tt=new Tt(_e,ce),At=new Tt(ye,pe),et=new Tt(_e,pe),ot=Ae*Math.PI/180;ze._rotate(ot),tt._rotate(ot),At._rotate(ot),et._rotate(ot),ye=Math.min(ze.x,tt.x,At.x,et.x),_e=Math.max(ze.x,tt.x,At.x,et.x),ce=Math.min(ze.y,tt.y,At.y,et.y),pe=Math.max(ze.y,tt.y,At.y,et.y)}u.emplaceBack(p.x,p.y,ye,ce,_e,pe,T,D,z)}this.boxEndIndex=u.length}}class ON{constructor(u=[],p=FN){if(this.data=u,this.length=this.data.length,this.compare=p,this.length>0)for(let T=(this.length>>1)-1;T>=0;T--)this._down(T)}push(u){this.data.push(u),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const u=this.data[0],p=this.data.pop();return this.length--,this.length>0&&(this.data[0]=p,this._down(0)),u}peek(){return this.data[0]}_up(u){const{data:p,compare:T}=this,D=p[u];for(;u>0;){const z=u-1>>1,F=p[z];if(T(D,F)>=0)break;p[u]=F,u=z}p[u]=D}_down(u){const{data:p,compare:T}=this,D=this.length>>1,z=p[u];for(;u<D;){let F=1+(u<<1),$=p[F];const Z=F+1;if(Z<this.length&&T(p[Z],$)<0&&(F=Z,$=p[Z]),T($,z)>=0)break;p[u]=$,u=F}p[u]=z}}function FN(f,u){return f<u?-1:f>u?1:0}function NN(f,u=1,p=!1){let T=1/0,D=1/0,z=-1/0,F=-1/0;const $=f[0];for(let ye=0;ye<$.length;ye++){const _e=$[ye];(!ye||_e.x<T)&&(T=_e.x),(!ye||_e.y<D)&&(D=_e.y),(!ye||_e.x>z)&&(z=_e.x),(!ye||_e.y>F)&&(F=_e.y)}const Z=Math.min(z-T,F-D);let re=Z/2;const Ae=new ON([],UN);if(Z===0)return new Tt(T,D);for(let ye=T;ye<z;ye+=Z)for(let _e=D;_e<F;_e+=Z)Ae.push(new Vf(ye+re,_e+re,re,f));let ce=function(ye){let _e=0,Ue=0,ze=0;const tt=ye[0];for(let At=0,et=tt.length,ot=et-1;At<et;ot=At++){const gt=tt[At],pt=tt[ot],Zt=gt.x*pt.y-pt.x*gt.y;Ue+=(gt.x+pt.x)*Zt,ze+=(gt.y+pt.y)*Zt,_e+=3*Zt}return new Vf(Ue/_e,ze/_e,0,ye)}(f),pe=Ae.length;for(;Ae.length;){const ye=Ae.pop();(ye.d>ce.d||!ce.d)&&(ce=ye,p&&console.log("found best %d after %d probes",Math.round(1e4*ye.d)/1e4,pe)),ye.max-ce.d<=u||(re=ye.h/2,Ae.push(new Vf(ye.p.x-re,ye.p.y-re,re,f)),Ae.push(new Vf(ye.p.x+re,ye.p.y-re,re,f)),Ae.push(new Vf(ye.p.x-re,ye.p.y+re,re,f)),Ae.push(new Vf(ye.p.x+re,ye.p.y+re,re,f)),pe+=4)}return p&&(console.log(`num probes: ${pe}`),console.log(`best distance: ${ce.d}`)),ce.p}function UN(f,u){return u.max-f.max}function Vf(f,u,p,T){this.p=new Tt(f,u),this.h=p,this.d=function(D,z){let F=!1,$=1/0;for(let Z=0;Z<z.length;Z++){const re=z[Z];for(let Ae=0,ce=re.length,pe=ce-1;Ae<ce;pe=Ae++){const ye=re[Ae],_e=re[pe];ye.y>D.y!=_e.y>D.y&&D.x<(_e.x-ye.x)*(D.y-ye.y)/(_e.y-ye.y)+ye.x&&(F=!F),$=Math.min($,w4(D,ye,_e))}}return(F?1:-1)*Math.sqrt($)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}const Zv=Number.POSITIVE_INFINITY;function p5(f,u){return u[1]!==Zv?function(p,T,D){let z=0,F=0;switch(T=Math.abs(T),D=Math.abs(D),p){case"top-right":case"top-left":case"top":F=D-7;break;case"bottom-right":case"bottom-left":case"bottom":F=7-D}switch(p){case"top-right":case"bottom-right":case"right":z=-T;break;case"top-left":case"bottom-left":case"left":z=T}return[z,F]}(f,u[0],u[1]):function(p,T){let D=0,z=0;T<0&&(T=0);const F=T/Math.sqrt(2);switch(p){case"top-right":case"top-left":z=F-7;break;case"bottom-right":case"bottom-left":z=7-F;break;case"bottom":z=7-T;break;case"top":z=T-7}switch(p){case"top-right":case"bottom-right":D=-F;break;case"top-left":case"bottom-left":D=F;break;case"left":D=T;break;case"right":D=-T}return[D,z]}(f,u[0])}function Yv(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function VN(f,u,p,T,D,z,F,$,Z,re,Ae){let ce=z.textMaxSize.evaluate(u,{});ce===void 0&&(ce=F);const pe=f.layers[0].layout,ye=pe.get("icon-offset").evaluate(u,{},Ae),_e=m5(p.horizontal),Ue=F/24,ze=f.tilePixelRatio*Ue,tt=f.tilePixelRatio*ce/24,At=f.tilePixelRatio*$,et=f.tilePixelRatio*pe.get("symbol-spacing"),ot=pe.get("text-padding")*f.tilePixelRatio,gt=function(St,gn,ln,jn=1){const zr=St.get("icon-padding").evaluate(gn,{},ln),Vr=zr&&zr.values;return[Vr[0]*jn,Vr[1]*jn,Vr[2]*jn,Vr[3]*jn]}(pe,u,Ae,f.tilePixelRatio),pt=pe.get("text-max-angle")/180*Math.PI,Zt=pe.get("text-rotation-alignment")!=="viewport"&&pe.get("symbol-placement")!=="point",tn=pe.get("icon-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point",Ht=pe.get("symbol-placement"),Ut=et/2,Ot=pe.get("icon-text-fit");let Wt;T&&Ot!=="none"&&(f.allowVerticalPlacement&&p.vertical&&(Wt=s5(T,p.vertical,Ot,pe.get("icon-text-fit-padding"),ye,Ue)),_e&&(T=s5(T,_e,Ot,pe.get("icon-text-fit-padding"),ye,Ue)));const $t=(St,gn)=>{gn.x<0||gn.x>=Li||gn.y<0||gn.y>=Li||function(ln,jn,zr,Vr,Di,xa,hs,vi,ji,fs,Ss,wo,xi,ds,Ms,Zs,bo,Eo,qr,Hi,Xn,qo,ps,Cs,Ka){const zl=ln.addToLineVertexArray(jn,zr);let Ol,yu,Ja,wa,To=0,_u=0,qd=0,D5=0,ox=-1,ax=-1;const vu={};let R5=wn.exports(""),lx=0,Ax=0;if(vi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[lx,Ax]=vi.layout.get("text-offset").evaluate(Xn,{},Cs).map(So=>So*Xi):(lx=vi.layout.get("text-radial-offset").evaluate(Xn,{},Cs)*Xi,Ax=Zv),ln.allowVerticalPlacement&&Vr.vertical){const So=vi.layout.get("text-rotate").evaluate(Xn,{},Cs)+90;Ja=new Vm(ji,jn,fs,Ss,wo,Vr.vertical,xi,ds,Ms,So),hs&&(wa=new Vm(ji,jn,fs,Ss,wo,hs,bo,Eo,Ms,So))}if(Di){const So=vi.layout.get("icon-rotate").evaluate(Xn,{}),vA=vi.layout.get("icon-text-fit")!=="none",Zd=f5(Di,So,ps,vA),Yd=hs?f5(hs,So,ps,vA):void 0;yu=new Vm(ji,jn,fs,Ss,wo,Di,bo,Eo,!1,So),To=4*Zd.length;const O5=ln.iconSizeData;let Eh=null;O5.kind==="source"?(Eh=[mu*vi.layout.get("icon-size").evaluate(Xn,{})],Eh[0]>Ec&&me(`${ln.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):O5.kind==="composite"&&(Eh=[mu*qo.compositeIconSizes[0].evaluate(Xn,{},Cs),mu*qo.compositeIconSizes[1].evaluate(Xn,{},Cs)],(Eh[0]>Ec||Eh[1]>Ec)&&me(`${ln.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ln.addSymbols(ln.icon,Zd,Eh,Hi,qr,Xn,o.WritingMode.none,jn,zl.lineStartIndex,zl.lineLength,-1,Cs),ox=ln.icon.placedSymbolArray.length-1,Yd&&(_u=4*Yd.length,ln.addSymbols(ln.icon,Yd,Eh,Hi,qr,Xn,o.WritingMode.vertical,jn,zl.lineStartIndex,zl.lineLength,-1,Cs),ax=ln.icon.placedSymbolArray.length-1)}const B5=Object.keys(Vr.horizontal);for(const So of B5){const vA=Vr.horizontal[So];if(!Ol){R5=wn.exports(vA.text);const Yd=vi.layout.get("text-rotate").evaluate(Xn,{},Cs);Ol=new Vm(ji,jn,fs,Ss,wo,vA,xi,ds,Ms,Yd)}const Zd=vA.positionedLines.length===1;if(qd+=g5(ln,jn,vA,xa,vi,Ms,Xn,Zs,zl,Vr.vertical?o.WritingMode.horizontal:o.WritingMode.horizontalOnly,Zd?B5:[So],vu,ox,qo,Cs),Zd)break}Vr.vertical&&(D5+=g5(ln,jn,Vr.vertical,xa,vi,Ms,Xn,Zs,zl,o.WritingMode.vertical,["vertical"],vu,ax,qo,Cs));const e9=Ol?Ol.boxStartIndex:ln.collisionBoxArray.length,t9=Ol?Ol.boxEndIndex:ln.collisionBoxArray.length,n9=Ja?Ja.boxStartIndex:ln.collisionBoxArray.length,r9=Ja?Ja.boxEndIndex:ln.collisionBoxArray.length,i9=yu?yu.boxStartIndex:ln.collisionBoxArray.length,s9=yu?yu.boxEndIndex:ln.collisionBoxArray.length,o9=wa?wa.boxStartIndex:ln.collisionBoxArray.length,a9=wa?wa.boxEndIndex:ln.collisionBoxArray.length;let Fl=-1;const Wm=(So,vA)=>So&&So.circleDiameter?Math.max(So.circleDiameter,vA):vA;Fl=Wm(Ol,Fl),Fl=Wm(Ja,Fl),Fl=Wm(yu,Fl),Fl=Wm(wa,Fl);const z5=Fl>-1?1:0;z5&&(Fl*=Ka/Xi),ln.glyphOffsetArray.length>=Gf.MAX_GLYPHS&&me("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Xn.sortKey!==void 0&&ln.addToSortKeyRanges(ln.symbolInstances.length,Xn.sortKey),ln.symbolInstances.emplaceBack(jn.x,jn.y,vu.right>=0?vu.right:-1,vu.center>=0?vu.center:-1,vu.left>=0?vu.left:-1,vu.vertical||-1,ox,ax,R5,e9,t9,n9,r9,i9,s9,o9,a9,fs,qd,D5,To,_u,z5,0,xi,lx,Ax,Fl)}(f,gn,St,p,T,D,Wt,f.layers[0],f.collisionBoxArray,u.index,u.sourceLayerIndex,f.index,ze,[ot,ot,ot,ot],Zt,Z,At,gt,tn,ye,u,z,re,Ae,F)};if(Ht==="line")for(const St of h5(u.geometry,0,0,Li,Li)){const gn=zN(St,et,pt,p.vertical||_e,T,24,tt,f.overscaling,Li);for(const ln of gn){const jn=_e;jn&&GN(f,jn.text,Ut,ln)||$t(St,ln)}}else if(Ht==="line-center"){for(const St of u.geometry)if(St.length>1){const gn=BN(St,pt,p.vertical||_e,T,24,tt);gn&&$t(St,gn)}}else if(u.type==="Polygon")for(const St of Ov(u.geometry,0)){const gn=NN(St,16);$t(St[0],new bc(gn.x,gn.y,0))}else if(u.type==="LineString")for(const St of u.geometry)$t(St,new bc(St[0].x,St[0].y,0));else if(u.type==="Point")for(const St of u.geometry)for(const gn of St)$t([gn],new bc(gn.x,gn.y,0))}const Ec=32640;function g5(f,u,p,T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e){const Ue=function(At,et,ot,gt,pt,Zt,tn,Ht){const Ut=gt.layout.get("text-rotate").evaluate(Zt,{})*Math.PI/180,Ot=[];for(const Wt of et.positionedLines)for(const $t of Wt.positionedGlyphs){if(!$t.rect)continue;const St=$t.rect||{};let gn=4,ln=!0,jn=1,zr=0;const Vr=(pt||Ht)&&$t.vertical,Di=$t.metrics.advance*$t.scale/2;if(Ht&&et.verticalizable){const qr=($t.scale-1)*Xi,Hi=(Xi-$t.metrics.width*$t.scale)/2;zr=Wt.lineOffset/2-($t.imageName?-Hi:qr)}if($t.imageName){const qr=tn[$t.imageName];ln=qr.sdf,jn=qr.pixelRatio,gn=1/jn}const xa=pt?[$t.x+Di,$t.y]:[0,0];let hs=pt?[0,0]:[$t.x+Di+ot[0],$t.y+ot[1]-zr],vi=[0,0];Vr&&(vi=hs,hs=[0,0]);const ji=($t.metrics.left-gn)*$t.scale-Di+hs[0],fs=(-$t.metrics.top-gn)*$t.scale+hs[1],Ss=ji+St.w*$t.scale/jn,wo=fs+St.h*$t.scale/jn,xi=new Tt(ji,fs),ds=new Tt(Ss,fs),Ms=new Tt(ji,wo),Zs=new Tt(Ss,wo);if(Vr){const qr=new Tt(-Di,Di-Bm),Hi=-Math.PI/2,Xn=12-Di,qo=new Tt(22-Xn,-($t.imageName?Xn:0)),ps=new Tt(...vi);xi._rotateAround(Hi,qr)._add(qo)._add(ps),ds._rotateAround(Hi,qr)._add(qo)._add(ps),Ms._rotateAround(Hi,qr)._add(qo)._add(ps),Zs._rotateAround(Hi,qr)._add(qo)._add(ps)}if(Ut){const qr=Math.sin(Ut),Hi=Math.cos(Ut),Xn=[Hi,-qr,qr,Hi];xi._matMult(Xn),ds._matMult(Xn),Ms._matMult(Xn),Zs._matMult(Xn)}const bo=new Tt(0,0),Eo=new Tt(0,0);Ot.push({tl:xi,tr:ds,bl:Ms,br:Zs,tex:St,writingMode:et.writingMode,glyphOffset:xa,sectionIndex:$t.sectionIndex,isSDF:ln,pixelOffsetTL:bo,pixelOffsetBR:Eo,minFontScaleX:0,minFontScaleY:0})}return Ot}(0,p,$,D,z,F,T,f.allowVerticalPlacement),ze=f.textSizeData;let tt=null;ze.kind==="source"?(tt=[mu*D.layout.get("text-size").evaluate(F,{})],tt[0]>Ec&&me(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ze.kind==="composite"&&(tt=[mu*ye.compositeTextSizes[0].evaluate(F,{},_e),mu*ye.compositeTextSizes[1].evaluate(F,{},_e)],(tt[0]>Ec||tt[1]>Ec)&&me(`${f.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),f.addSymbols(f.text,Ue,tt,$,z,F,re,u,Z.lineStartIndex,Z.lineLength,pe,_e);for(const At of Ae)ce[At]=f.text.placedSymbolArray.length-1;return 4*Ue.length}function m5(f){for(const u in f)return f[u];return null}function GN(f,u,p,T){const D=f.compareText;if(u in D){const z=D[u];for(let F=z.length-1;F>=0;F--)if(T.dist(z[F])<p)return!0}else D[u]=[];return D[u].push(T),!1}const $N=xc.VectorTileFeature.types,jN=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Gm(f,u,p,T,D,z,F,$,Z,re,Ae,ce,pe){const ye=$?Math.min(Ec,Math.round($[0])):0,_e=$?Math.min(Ec,Math.round($[1])):0;f.emplaceBack(u,p,Math.round(32*T),Math.round(32*D),z,F,(ye<<1)+(Z?1:0),_e,16*re,16*Ae,256*ce,256*pe)}function Xv(f,u,p){f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p),f.emplaceBack(u.x,u.y,p)}function HN(f){for(const u of f.sections)if(gc(u.text))return!0;return!1}class Kv{constructor(u){this.layoutVertexArray=new Be,this.indexArray=new st,this.programConfigurations=u,this.segments=new dt,this.dynamicLayoutVertexArray=new Xe,this.opacityVertexArray=new ht,this.placedSymbolArray=new y}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(u,p,T,D){this.isEmpty()||(T&&(this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,dN.members),this.indexBuffer=u.createIndexBuffer(this.indexArray,p),this.dynamicLayoutVertexBuffer=u.createVertexBuffer(this.dynamicLayoutVertexArray,pN.members,!0),this.opacityVertexBuffer=u.createVertexBuffer(this.opacityVertexArray,jN,!0),this.opacityVertexBuffer.itemSize=1),(T||D)&&this.programConfigurations.upload(u))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Nt("SymbolBuffers",Kv);class Jv{constructor(u,p,T){this.layoutVertexArray=new u,this.layoutAttributes=p,this.indexArray=new T,this.segments=new dt,this.collisionVertexArray=new it}upload(u){this.layoutVertexBuffer=u.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=u.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=u.createVertexBuffer(this.collisionVertexArray,gN.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Nt("CollisionBuffers",Jv);class Gf{constructor(u){this.collisionBoxArray=u.collisionBoxArray,this.zoom=u.zoom,this.overscaling=u.overscaling,this.layers=u.layers,this.layerIds=this.layers.map(F=>F.id),this.index=u.index,this.pixelRatio=u.pixelRatio,this.sourceLayerIndex=u.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=kv([]),this.placementViewportMatrix=kv([]);const p=this.layers[0]._unevaluatedLayout._values;this.textSizeData=o5(this.zoom,p["text-size"]),this.iconSizeData=o5(this.zoom,p["icon-size"]);const T=this.layers[0].layout,D=T.get("symbol-sort-key"),z=T.get("symbol-z-order");this.canOverlap=tx(T,"text-overlap","text-allow-overlap")!=="never"||tx(T,"icon-overlap","icon-allow-overlap")!=="never"||T.get("text-ignore-placement")||T.get("icon-ignore-placement"),this.sortFeaturesByKey=z!=="viewport-y"&&!D.isConstant(),this.sortFeaturesByY=(z==="viewport-y"||z==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,T.get("symbol-placement")==="point"&&(this.writingModes=T.get("text-writing-mode").map(F=>o.WritingMode[F])),this.stateDependentLayerIds=this.layers.filter(F=>F.isStateDependent()).map(F=>F.id),this.sourceID=u.sourceID}createArrays(){this.text=new Kv(new _h(this.layers,this.zoom,u=>/^text/.test(u))),this.icon=new Kv(new _h(this.layers,this.zoom,u=>/^icon/.test(u))),this.glyphOffsetArray=new E,this.lineVertexArray=new P,this.symbolInstances=new v}calculateGlyphDependencies(u,p,T,D,z){for(let F=0;F<u.length;F++)if(p[u.charCodeAt(F)]=!0,(T||D)&&z){const $=jd[u.charAt(F)];$&&(p[$.charCodeAt(0)]=!0)}}populate(u,p,T){const D=this.layers[0],z=D.layout,F=z.get("text-font"),$=z.get("text-field"),Z=z.get("icon-image"),re=($.value.kind!=="constant"||$.value.value instanceof Ie&&!$.value.value.isEmpty()||$.value.value.toString().length>0)&&(F.value.kind!=="constant"||F.value.value.length>0),Ae=Z.value.kind!=="constant"||!!Z.value.value||Object.keys(Z.parameters).length>0,ce=z.get("symbol-sort-key");if(this.features=[],!re&&!Ae)return;const pe=p.iconDependencies,ye=p.glyphDependencies,_e=p.availableImages,Ue=new br(this.zoom);for(const{feature:ze,id:tt,index:At,sourceLayerIndex:et}of u){const ot=D._featureFilter.needGeometry,gt=xh(ze,ot);if(!D._featureFilter.filter(Ue,gt,T))continue;let pt,Zt;if(ot||(gt.geometry=vh(ze)),re){const Ht=D.getValueAndResolveTokens("text-field",gt,T,_e),Ut=Ie.factory(Ht);HN(Ut)&&(this.hasRTLText=!0),(!this.hasRTLText||Ll()==="unavailable"||this.hasRTLText&&cs.isParsed())&&(pt=yN(Ut,D,gt))}if(Ae){const Ht=D.getValueAndResolveTokens("icon-image",gt,T,_e);Zt=Ht instanceof ke?Ht:ke.fromString(Ht)}if(!pt&&!Zt)continue;const tn=this.sortFeaturesByKey?ce.evaluate(gt,{},T):void 0;if(this.features.push({id:tt,text:pt,icon:Zt,index:At,sourceLayerIndex:et,geometry:gt.geometry,properties:ze.properties,type:$N[ze.type],sortKey:tn}),Zt&&(pe[Zt.name]=!0),pt){const Ht=F.evaluate(gt,{},T).join(","),Ut=z.get("text-rotation-alignment")!=="viewport"&&z.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(o.WritingMode.vertical)>=0;for(const Ot of pt.sections)if(Ot.image)pe[Ot.image.name]=!0;else{const Wt=yA(pt.toString()),$t=Ot.fontStack||Ht,St=ye[$t]=ye[$t]||{};this.calculateGlyphDependencies(Ot.text,St,Ut,this.allowVerticalPlacement,Wt)}}}z.get("symbol-placement")==="line"&&(this.features=function(ze){const tt={},At={},et=[];let ot=0;function gt(Ht){et.push(ze[Ht]),ot++}function pt(Ht,Ut,Ot){const Wt=At[Ht];return delete At[Ht],At[Ut]=Wt,et[Wt].geometry[0].pop(),et[Wt].geometry[0]=et[Wt].geometry[0].concat(Ot[0]),Wt}function Zt(Ht,Ut,Ot){const Wt=tt[Ut];return delete tt[Ut],tt[Ht]=Wt,et[Wt].geometry[0].shift(),et[Wt].geometry[0]=Ot[0].concat(et[Wt].geometry[0]),Wt}function tn(Ht,Ut,Ot){const Wt=Ot?Ut[0][Ut[0].length-1]:Ut[0][0];return`${Ht}:${Wt.x}:${Wt.y}`}for(let Ht=0;Ht<ze.length;Ht++){const Ut=ze[Ht],Ot=Ut.geometry,Wt=Ut.text?Ut.text.toString():null;if(!Wt){gt(Ht);continue}const $t=tn(Wt,Ot),St=tn(Wt,Ot,!0);if($t in At&&St in tt&&At[$t]!==tt[St]){const gn=Zt($t,St,Ot),ln=pt($t,St,et[gn].geometry);delete tt[$t],delete At[St],At[tn(Wt,et[ln].geometry,!0)]=ln,et[gn].geometry=null}else $t in At?pt($t,St,Ot):St in tt?Zt($t,St,Ot):(gt(Ht),tt[$t]=ot-1,At[St]=ot-1)}return et.filter(Ht=>Ht.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ze,tt)=>ze.sortKey-tt.sortKey)}update(u,p,T){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(u,p,this.layers,T),this.icon.programConfigurations.updatePaintArrays(u,p,this.layers,T))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(u){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(u),this.iconCollisionBox.upload(u)),this.text.upload(u,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(u,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(u,p){const T=this.lineVertexArray.length;if(u.segment!==void 0){let D=u.dist(p[u.segment+1]),z=u.dist(p[u.segment]);const F={};for(let $=u.segment+1;$<p.length;$++)F[$]={x:p[$].x,y:p[$].y,tileUnitDistanceFromAnchor:D},$<p.length-1&&(D+=p[$+1].dist(p[$]));for(let $=u.segment||0;$>=0;$--)F[$]={x:p[$].x,y:p[$].y,tileUnitDistanceFromAnchor:z},$>0&&(z+=p[$-1].dist(p[$]));for(let $=0;$<p.length;$++){const Z=F[$];this.lineVertexArray.emplaceBack(Z.x,Z.y,Z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:T,lineLength:this.lineVertexArray.length-T}}addSymbols(u,p,T,D,z,F,$,Z,re,Ae,ce,pe){const ye=u.indexArray,_e=u.layoutVertexArray,Ue=u.segments.prepareSegment(4*p.length,_e,ye,this.canOverlap?F.sortKey:void 0),ze=this.glyphOffsetArray.length,tt=Ue.vertexLength,At=this.allowVerticalPlacement&&$===o.WritingMode.vertical?Math.PI/2:0,et=F.text&&F.text.sections;for(let ot=0;ot<p.length;ot++){const{tl:gt,tr:pt,bl:Zt,br:tn,tex:Ht,pixelOffsetTL:Ut,pixelOffsetBR:Ot,minFontScaleX:Wt,minFontScaleY:$t,glyphOffset:St,isSDF:gn,sectionIndex:ln}=p[ot],jn=Ue.vertexLength,zr=St[1];Gm(_e,Z.x,Z.y,gt.x,zr+gt.y,Ht.x,Ht.y,T,gn,Ut.x,Ut.y,Wt,$t),Gm(_e,Z.x,Z.y,pt.x,zr+pt.y,Ht.x+Ht.w,Ht.y,T,gn,Ot.x,Ut.y,Wt,$t),Gm(_e,Z.x,Z.y,Zt.x,zr+Zt.y,Ht.x,Ht.y+Ht.h,T,gn,Ut.x,Ot.y,Wt,$t),Gm(_e,Z.x,Z.y,tn.x,zr+tn.y,Ht.x+Ht.w,Ht.y+Ht.h,T,gn,Ot.x,Ot.y,Wt,$t),Xv(u.dynamicLayoutVertexArray,Z,At),ye.emplaceBack(jn,jn+1,jn+2),ye.emplaceBack(jn+1,jn+2,jn+3),Ue.vertexLength+=4,Ue.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(St[0]),ot!==p.length-1&&ln===p[ot+1].sectionIndex||u.programConfigurations.populatePaintArrays(_e.length,F,F.index,{},pe,et&&et[ln])}u.placedSymbolArray.emplaceBack(Z.x,Z.y,ze,this.glyphOffsetArray.length-ze,tt,re,Ae,Z.segment,T?T[0]:0,T?T[1]:0,D[0],D[1],$,0,!1,0,ce)}_addCollisionDebugVertex(u,p,T,D,z,F){return p.emplaceBack(0,0),u.emplaceBack(T.x,T.y,D,z,Math.round(F.x),Math.round(F.y))}addCollisionDebugVertices(u,p,T,D,z,F,$){const Z=z.segments.prepareSegment(4,z.layoutVertexArray,z.indexArray),re=Z.vertexLength,Ae=z.layoutVertexArray,ce=z.collisionVertexArray,pe=$.anchorX,ye=$.anchorY;this._addCollisionDebugVertex(Ae,ce,F,pe,ye,new Tt(u,p)),this._addCollisionDebugVertex(Ae,ce,F,pe,ye,new Tt(T,p)),this._addCollisionDebugVertex(Ae,ce,F,pe,ye,new Tt(T,D)),this._addCollisionDebugVertex(Ae,ce,F,pe,ye,new Tt(u,D)),Z.vertexLength+=4;const _e=z.indexArray;_e.emplaceBack(re,re+1),_e.emplaceBack(re+1,re+2),_e.emplaceBack(re+2,re+3),_e.emplaceBack(re+3,re),Z.primitiveLength+=4}addDebugCollisionBoxes(u,p,T,D){for(let z=u;z<p;z++){const F=this.collisionBoxArray.get(z);this.addCollisionDebugVertices(F.x1,F.y1,F.x2,F.y2,D?this.textCollisionBox:this.iconCollisionBox,F.anchorPoint,T)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Jv(ut,W4.members,Je),this.iconCollisionBox=new Jv(ut,W4.members,Je);for(let u=0;u<this.symbolInstances.length;u++){const p=this.symbolInstances.get(u);this.addDebugCollisionBoxes(p.textBoxStartIndex,p.textBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p,!0),this.addDebugCollisionBoxes(p.iconBoxStartIndex,p.iconBoxEndIndex,p,!1),this.addDebugCollisionBoxes(p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p,!1)}}_deserializeCollisionBoxesForSymbol(u,p,T,D,z,F,$,Z,re){const Ae={};for(let ce=p;ce<T;ce++){const pe=u.get(ce);Ae.textBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.textFeatureIndex=pe.featureIndex;break}for(let ce=D;ce<z;ce++){const pe=u.get(ce);Ae.verticalTextBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalTextFeatureIndex=pe.featureIndex;break}for(let ce=F;ce<$;ce++){const pe=u.get(ce);Ae.iconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.iconFeatureIndex=pe.featureIndex;break}for(let ce=Z;ce<re;ce++){const pe=u.get(ce);Ae.verticalIconBox={x1:pe.x1,y1:pe.y1,x2:pe.x2,y2:pe.y2,anchorPointX:pe.anchorPointX,anchorPointY:pe.anchorPointY},Ae.verticalIconFeatureIndex=pe.featureIndex;break}return Ae}deserializeCollisionBoxes(u){this.collisionArrays=[];for(let p=0;p<this.symbolInstances.length;p++){const T=this.symbolInstances.get(p);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(u,T.textBoxStartIndex,T.textBoxEndIndex,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T.iconBoxStartIndex,T.iconBoxEndIndex,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(u,p){const T=u.placedSymbolArray.get(p),D=T.vertexStartIndex+4*T.numGlyphs;for(let z=T.vertexStartIndex;z<D;z+=4)u.indexArray.emplaceBack(z,z+1,z+2),u.indexArray.emplaceBack(z+1,z+2,z+3)}getSortedSymbolIndexes(u){if(this.sortedAngle===u&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const p=Math.sin(u),T=Math.cos(u),D=[],z=[],F=[];for(let $=0;$<this.symbolInstances.length;++$){F.push($);const Z=this.symbolInstances.get($);D.push(0|Math.round(p*Z.anchorX+T*Z.anchorY)),z.push(Z.featureIndex)}return F.sort(($,Z)=>D[$]-D[Z]||z[Z]-z[$]),F}addToSortKeyRanges(u,p){const T=this.sortKeyRanges[this.sortKeyRanges.length-1];T&&T.sortKey===p?T.symbolInstanceEnd=u+1:this.sortKeyRanges.push({sortKey:p,symbolInstanceStart:u,symbolInstanceEnd:u+1})}sortFeatures(u){if(this.sortFeaturesByY&&this.sortedAngle!==u&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(u),this.sortedAngle=u,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const p of this.symbolInstanceIndexes){const T=this.symbolInstances.get(p);this.featureSortOrder.push(T.featureIndex),[T.rightJustifiedTextSymbolIndex,T.centerJustifiedTextSymbolIndex,T.leftJustifiedTextSymbolIndex].forEach((D,z,F)=>{D>=0&&F.indexOf(D)===z&&this.addIndicesForPlacedSymbol(this.text,D)}),T.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,T.verticalPlacedTextSymbolIndex),T.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.placedIconSymbolIndex),T.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,T.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Nt("SymbolBucket",Gf,{omit:["layers","collisionBoxArray","features","compareText"]}),Gf.MAX_GLYPHS=65535,Gf.addDynamicAttributes=Xv;const WN=new Nr({"symbol-placement":new Yt(ct.layout_symbol["symbol-placement"]),"symbol-spacing":new Yt(ct.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Yt(ct.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xt(ct.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Yt(ct.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Yt(ct.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Yt(ct.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Yt(ct.layout_symbol["icon-ignore-placement"]),"icon-optional":new Yt(ct.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Yt(ct.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xt(ct.layout_symbol["icon-size"]),"icon-text-fit":new Yt(ct.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Yt(ct.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xt(ct.layout_symbol["icon-image"]),"icon-rotate":new Xt(ct.layout_symbol["icon-rotate"]),"icon-padding":new Xt(ct.layout_symbol["icon-padding"]),"icon-keep-upright":new Yt(ct.layout_symbol["icon-keep-upright"]),"icon-offset":new Xt(ct.layout_symbol["icon-offset"]),"icon-anchor":new Xt(ct.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Yt(ct.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Yt(ct.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Yt(ct.layout_symbol["text-rotation-alignment"]),"text-field":new Xt(ct.layout_symbol["text-field"]),"text-font":new Xt(ct.layout_symbol["text-font"]),"text-size":new Xt(ct.layout_symbol["text-size"]),"text-max-width":new Xt(ct.layout_symbol["text-max-width"]),"text-line-height":new Yt(ct.layout_symbol["text-line-height"]),"text-letter-spacing":new Xt(ct.layout_symbol["text-letter-spacing"]),"text-justify":new Xt(ct.layout_symbol["text-justify"]),"text-radial-offset":new Xt(ct.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Yt(ct.layout_symbol["text-variable-anchor"]),"text-anchor":new Xt(ct.layout_symbol["text-anchor"]),"text-max-angle":new Yt(ct.layout_symbol["text-max-angle"]),"text-writing-mode":new Yt(ct.layout_symbol["text-writing-mode"]),"text-rotate":new Xt(ct.layout_symbol["text-rotate"]),"text-padding":new Yt(ct.layout_symbol["text-padding"]),"text-keep-upright":new Yt(ct.layout_symbol["text-keep-upright"]),"text-transform":new Xt(ct.layout_symbol["text-transform"]),"text-offset":new Xt(ct.layout_symbol["text-offset"]),"text-allow-overlap":new Yt(ct.layout_symbol["text-allow-overlap"]),"text-overlap":new Yt(ct.layout_symbol["text-overlap"]),"text-ignore-placement":new Yt(ct.layout_symbol["text-ignore-placement"]),"text-optional":new Yt(ct.layout_symbol["text-optional"])});var ex={paint:new Nr({"icon-opacity":new Xt(ct.paint_symbol["icon-opacity"]),"icon-color":new Xt(ct.paint_symbol["icon-color"]),"icon-halo-color":new Xt(ct.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xt(ct.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xt(ct.paint_symbol["icon-halo-blur"]),"icon-translate":new Yt(ct.paint_symbol["icon-translate"]),"icon-translate-anchor":new Yt(ct.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xt(ct.paint_symbol["text-opacity"]),"text-color":new Xt(ct.paint_symbol["text-color"],{runtimeType:Cr,getOverride:f=>f.textColor,hasOverride:f=>!!f.textColor}),"text-halo-color":new Xt(ct.paint_symbol["text-halo-color"]),"text-halo-width":new Xt(ct.paint_symbol["text-halo-width"]),"text-halo-blur":new Xt(ct.paint_symbol["text-halo-blur"]),"text-translate":new Yt(ct.paint_symbol["text-translate"]),"text-translate-anchor":new Yt(ct.paint_symbol["text-translate-anchor"])}),layout:WN};class y5{constructor(u){if(u.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=u.property.overrides?u.property.overrides.runtimeType:ss,this.defaultValue=u}evaluate(u){if(u.formattedSection){const p=this.defaultValue.property.overrides;if(p&&p.hasOverride(u.formattedSection))return p.getOverride(u.formattedSection)}return u.feature&&u.featureState?this.defaultValue.evaluate(u.feature,u.featureState):this.defaultValue.property.specification.default}eachChild(u){this.defaultValue.isConstant()||u(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nt("FormatSectionOverride",y5,{omit:["defaultValue"]});class $m extends Ts{constructor(u){super(u,ex)}recalculate(u,p){if(super.recalculate(u,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const T=this.layout.get("text-writing-mode");if(T){const D=[];for(const z of T)D.indexOf(z)<0&&D.push(z);this.layout._values["text-writing-mode"]=D}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(u,p,T,D){const z=this.layout.get(u).evaluate(p,{},T,D),F=this._unevaluatedLayout._values[u];return F.isDataDriven()||El(F.value)||!z?z:function($,Z){return Z.replace(/{([^{}]+)}/g,(re,Ae)=>Ae in $?String($[Ae]):"")}(p.properties,z)}createBucket(u){return new Gf(u)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const u of ex.paint.overridableProperties){if(!$m.hasPaintOverride(this.layout,u))continue;const p=this.paint.get(u),T=new y5(p),D=new Ns(T,p.property.specification);let z=null;z=p.value.kind==="constant"||p.value.kind==="source"?new fa("source",D):new Tl("composite",D,p.value.zoomStops),this.paint._values[u]=new pr(p.property,z,p.parameters)}}_handleOverridablePaintPropertyUpdate(u,p,T){return!(!this.layout||p.isDataDriven()||T.isDataDriven())&&$m.hasPaintOverride(this.layout,u)}static hasPaintOverride(u,p){const T=u.get("text-field"),D=ex.paint.properties[p];let z=!1;const F=$=>{for(const Z of $)if(D.overrides&&D.overrides.hasOverride(Z))return void(z=!0)};if(T.value.kind==="constant"&&T.value.value instanceof Ie)F(T.value.value.sections);else if(T.value.kind==="source"){const $=re=>{z||(re instanceof Dt&&We(re.value)===jr?F(re.value.sections):re instanceof pA?F(re.sections):re.eachChild($))},Z=T.value;Z._styleExpression&&$(Z._styleExpression.expression)}return z}}function tx(f,u,p){let T="never";const D=f.get(u);return D?T=D:f.get(p)&&(T="always"),T}var QN={paint:new Nr({"background-color":new Yt(ct.paint_background["background-color"]),"background-pattern":new Yi(ct.paint_background["background-pattern"]),"background-opacity":new Yt(ct.paint_background["background-opacity"])})},qN={paint:new Nr({"raster-opacity":new Yt(ct.paint_raster["raster-opacity"]),"raster-hue-rotate":new Yt(ct.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Yt(ct.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Yt(ct.paint_raster["raster-brightness-max"]),"raster-saturation":new Yt(ct.paint_raster["raster-saturation"]),"raster-contrast":new Yt(ct.paint_raster["raster-contrast"]),"raster-resampling":new Yt(ct.paint_raster["raster-resampling"]),"raster-fade-duration":new Yt(ct.paint_raster["raster-fade-duration"])})};class ZN extends Ts{constructor(u){super(u,{}),this.onAdd=p=>{this.implementation.onAdd&&this.implementation.onAdd(p,p.painter.context.gl)},this.onRemove=p=>{this.implementation.onRemove&&this.implementation.onRemove(p,p.painter.context.gl)},this.implementation=u}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const YN={circle:class extends Ts{constructor(f){super(f,M7)}createBucket(f){return new Cv(f)}queryRadius(f){const u=f;return Bd("circle-radius",this,u)+Bd("circle-stroke-width",this,u)+Sm(this.paint.get("circle-translate"))}queryIntersectsFeature(f,u,p,T,D,z,F,$){const Z=Mm(f,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),z.angle,F),re=this.paint.get("circle-radius").evaluate(u,p)+this.paint.get("circle-stroke-width").evaluate(u,p),Ae=this.paint.get("circle-pitch-alignment")==="map",ce=Ae?Z:function(ye,_e){return ye.map(Ue=>P4(Ue,_e))}(Z,$),pe=Ae?re*F:re;for(const ye of T)for(const _e of ye){const Ue=Ae?_e:P4(_e,$);let ze=pe;const tt=Cm([],[_e.x,_e.y,0,1],$);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ze*=tt[3]/z.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ze*=z.cameraToCenterDistance/tt[3]),w7(ce,Ue,ze))return!0}return!1}},heatmap:class extends Ts{constructor(f){super(f,P7),this._updateColorRamp()}createBucket(f){return new I4(f)}_handleSpecialPaintPropertyUpdate(f){f==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=L4({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Ts{constructor(f){super(f,I7)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Ts{constructor(f){super(f,W7)}recalculate(f,u){super.recalculate(f,u);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(f){return new Uv(f)}queryRadius(){return Sm(this.paint.get("fill-translate"))}queryIntersectsFeature(f,u,p,T,D,z,F){return x4(Mm(f,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),z.angle,F),T)}isTileClipped(){return!0}},"fill-extrusion":class extends Ts{constructor(f){super(f,oN)}createBucket(f){return new Gv(f)}queryRadius(){return Sm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(f,u,p,T,D,z,F,$){const Z=Mm(f,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),z.angle,F),re=this.paint.get("fill-extrusion-height").evaluate(u,p),Ae=this.paint.get("fill-extrusion-base").evaluate(u,p),ce=function(ye,_e,Ue,ze){const tt=[];for(const At of ye){const et=[At.x,At.y,0,1];Cm(et,et,_e),tt.push(new Tt(et[0]/et[3],et[1]/et[3]))}return tt}(Z,$),pe=function(ye,_e,Ue,ze){const tt=[],At=[],et=ze[8]*_e,ot=ze[9]*_e,gt=ze[10]*_e,pt=ze[11]*_e,Zt=ze[8]*Ue,tn=ze[9]*Ue,Ht=ze[10]*Ue,Ut=ze[11]*Ue;for(const Ot of ye){const Wt=[],$t=[];for(const St of Ot){const gn=St.x,ln=St.y,jn=ze[0]*gn+ze[4]*ln+ze[12],zr=ze[1]*gn+ze[5]*ln+ze[13],Vr=ze[2]*gn+ze[6]*ln+ze[14],Di=ze[3]*gn+ze[7]*ln+ze[15],xa=Vr+gt,hs=Di+pt,vi=jn+Zt,ji=zr+tn,fs=Vr+Ht,Ss=Di+Ut,wo=new Tt((jn+et)/hs,(zr+ot)/hs);wo.z=xa/hs,Wt.push(wo);const xi=new Tt(vi/Ss,ji/Ss);xi.z=fs/Ss,$t.push(xi)}tt.push(Wt),At.push($t)}return[tt,At]}(T,Ae,re,$);return function(ye,_e,Ue){let ze=1/0;x4(Ue,_e)&&(ze=V4(Ue,_e[0]));for(let tt=0;tt<_e.length;tt++){const At=_e[tt],et=ye[tt];for(let ot=0;ot<At.length-1;ot++){const gt=At[ot],pt=[gt,At[ot+1],et[ot+1],et[ot],gt];v4(Ue,pt)&&(ze=Math.min(ze,V4(Ue,pt)))}}return ze!==1/0&&ze}(pe[0],pe[1],ce)}},line:class extends Ts{constructor(f){super(f,$4),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(f){f==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Mr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(f,u){super.recalculate(f,u),this.paint._values["line-floorwidth"]=j4.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,f)}createBucket(f){return new $v(f)}queryRadius(f){const u=f,p=H4(Bd("line-width",this,u),Bd("line-gap-width",this,u)),T=Bd("line-offset",this,u);return p/2+Math.abs(T)+Sm(this.paint.get("line-translate"))}queryIntersectsFeature(f,u,p,T,D,z,F){const $=Mm(f,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),z.angle,F),Z=F/2*H4(this.paint.get("line-width").evaluate(u,p),this.paint.get("line-gap-width").evaluate(u,p)),re=this.paint.get("line-offset").evaluate(u,p);return re&&(T=function(Ae,ce){const pe=[];for(let ye=0;ye<Ae.length;ye++){const _e=Ae[ye],Ue=[];for(let ze=0;ze<_e.length;ze++){const tt=_e[ze-1],At=_e[ze],et=_e[ze+1],ot=ze===0?new Tt(0,0):At.sub(tt)._unit()._perp(),gt=ze===_e.length-1?new Tt(0,0):et.sub(At)._unit()._perp(),pt=ot._add(gt)._unit(),Zt=pt.x*gt.x+pt.y*gt.y;Zt!==0&&pt._mult(1/Zt),Ue.push(pt._mult(ce)._add(At))}pe.push(Ue)}return pe}(T,re*F)),function(Ae,ce,pe){for(let ye=0;ye<ce.length;ye++){const _e=ce[ye];if(Ae.length>=3){for(let Ue=0;Ue<_e.length;Ue++)if(Bf(Ae,_e[Ue]))return!0}if(b7(Ae,_e,pe))return!0}return!1}($,T,Z)}isTileClipped(){return!0}},symbol:$m,background:class extends Ts{constructor(f){super(f,QN)}},raster:class extends Ts{constructor(f){super(f,qN)}}};class XN{constructor(u){this._callback=u,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const _5=63710088e-1;class Ai{constructor(u,p){if(isNaN(u)||isNaN(p))throw new Error(`Invalid LngLat object: (${u}, ${p})`);if(this.lng=+u,this.lat=+p,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ai(U(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(u){const p=Math.PI/180,T=this.lat*p,D=u.lat*p,z=Math.sin(T)*Math.sin(D)+Math.cos(T)*Math.cos(D)*Math.cos((u.lng-this.lng)*p);return _5*Math.acos(Math.min(z,1))}toBounds(u=0){const p=360*u/40075017,T=p/Math.cos(Math.PI/180*this.lat);return new bh(new Ai(this.lng-T,this.lat-p),new Ai(this.lng+T,this.lat+p))}static convert(u){if(u instanceof Ai)return u;if(Array.isArray(u)&&(u.length===2||u.length===3))return new Ai(Number(u[0]),Number(u[1]));if(!Array.isArray(u)&&typeof u=="object"&&u!==null)return new Ai(Number("lng"in u?u.lng:u.lon),Number(u.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class bh{constructor(u,p){u&&(p?this.setSouthWest(u).setNorthEast(p):u.length===4?this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]]):this.setSouthWest(u[0]).setNorthEast(u[1]))}setNorthEast(u){return this._ne=u instanceof Ai?new Ai(u.lng,u.lat):Ai.convert(u),this}setSouthWest(u){return this._sw=u instanceof Ai?new Ai(u.lng,u.lat):Ai.convert(u),this}extend(u){const p=this._sw,T=this._ne;let D,z;if(u instanceof Ai)D=u,z=u;else{if(!(u instanceof bh))return Array.isArray(u)?u.length===4||u.every(Array.isArray)?this.extend(bh.convert(u)):this.extend(Ai.convert(u)):this;if(D=u._sw,z=u._ne,!D||!z)return this}return p||T?(p.lng=Math.min(D.lng,p.lng),p.lat=Math.min(D.lat,p.lat),T.lng=Math.max(z.lng,T.lng),T.lat=Math.max(z.lat,T.lat)):(this._sw=new Ai(D.lng,D.lat),this._ne=new Ai(z.lng,z.lat)),this}getCenter(){return new Ai((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ai(this.getWest(),this.getNorth())}getSouthEast(){return new Ai(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(u){const{lng:p,lat:T}=Ai.convert(u);let D=this._sw.lng<=p&&p<=this._ne.lng;return this._sw.lng>this._ne.lng&&(D=this._sw.lng>=p&&p>=this._ne.lng),this._sw.lat<=T&&T<=this._ne.lat&&D}static convert(u){return u instanceof bh?u:u&&new bh(u)}}const v5=2*Math.PI*_5;function x5(f){return v5*Math.cos(f*Math.PI/180)}function w5(f){return(180+f)/360}function b5(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function E5(f,u){return f/x5(u)}function nx(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}class jm{constructor(u,p,T=0){this.x=+u,this.y=+p,this.z=+T}static fromLngLat(u,p=0){const T=Ai.convert(u);return new jm(w5(T.lng),b5(T.lat),E5(p,T.lat))}toLngLat(){return new Ai(360*this.x-180,nx(this.y))}toAltitude(){return this.z*x5(nx(this.y))}meterInMercatorCoordinateUnits(){return 1/v5*(u=nx(this.y),1/Math.cos(u*Math.PI/180));var u}}function T5(f,u,p){var T=2*Math.PI*6378137/256/Math.pow(2,p);return[f*T-2*Math.PI*6378137/2,u*T-2*Math.PI*6378137/2]}class rx{constructor(u,p,T){if(u<0||u>25||T<0||T>=Math.pow(2,u)||p<0||p>=Math.pow(2,u))throw new Error(`x=${p}, y=${T}, z=${u} outside of bounds. 0<=x<${Math.pow(2,u)}, 0<=y<${Math.pow(2,u)} 0<=z<=25 `);this.z=u,this.x=p,this.y=T,this.key=Wd(0,u,u,p,T)}equals(u){return this.z===u.z&&this.x===u.x&&this.y===u.y}url(u,p,T){const D=(F=this.y,$=this.z,Z=T5(256*(z=this.x),256*(F=Math.pow(2,$)-F-1),$),re=T5(256*(z+1),256*(F+1),$),Z[0]+","+Z[1]+","+re[0]+","+re[1]);var z,F,$,Z,re;const Ae=function(ce,pe,ye){let _e,Ue="";for(let ze=ce;ze>0;ze--)_e=1<<ze-1,Ue+=(pe&_e?1:0)+(ye&_e?2:0);return Ue}(this.z,this.x,this.y);return u[(this.x+this.y)%u.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(T==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,p>1?"@2x":"").replace(/{quadkey}/g,Ae).replace(/{bbox-epsg-3857}/g,D)}isChildOf(u){const p=this.z-u.z;return p>0&&u.x===this.x>>p&&u.y===this.y>>p}getTilePoint(u){const p=Math.pow(2,this.z);return new Tt((u.x*p-this.x)*Li,(u.y*p-this.y)*Li)}toString(){return`${this.z}/${this.x}/${this.y}`}}class S5{constructor(u,p){this.wrap=u,this.canonical=p,this.key=Wd(u,p.z,p.z,p.x,p.y)}}class va{constructor(u,p,T,D,z){if(u<T)throw new Error(`overscaledZ should be >= z; overscaledZ = ${u}; z = ${T}`);this.overscaledZ=u,this.wrap=p,this.canonical=new rx(T,+D,+z),this.key=Wd(p,u,T,D,z)}clone(){return new va(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(u){return this.overscaledZ===u.overscaledZ&&this.wrap===u.wrap&&this.canonical.equals(u.canonical)}scaledTo(u){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-u;return u>this.canonical.z?new va(u,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new va(u,this.wrap,u,this.canonical.x>>p,this.canonical.y>>p)}calculateScaledKey(u,p){if(u>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${u}; overscaledZ = ${this.overscaledZ}`);const T=this.canonical.z-u;return u>this.canonical.z?Wd(this.wrap*+p,u,this.canonical.z,this.canonical.x,this.canonical.y):Wd(this.wrap*+p,u,u,this.canonical.x>>T,this.canonical.y>>T)}isChildOf(u){if(u.wrap!==this.wrap)return!1;const p=this.canonical.z-u.canonical.z;return u.overscaledZ===0||u.overscaledZ<this.overscaledZ&&u.canonical.x===this.canonical.x>>p&&u.canonical.y===this.canonical.y>>p}children(u){if(this.overscaledZ>=u)return[new va(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const p=this.canonical.z+1,T=2*this.canonical.x,D=2*this.canonical.y;return[new va(p,this.wrap,p,T,D),new va(p,this.wrap,p,T+1,D),new va(p,this.wrap,p,T,D+1),new va(p,this.wrap,p,T+1,D+1)]}isLessThan(u){return this.wrap<u.wrap||!(this.wrap>u.wrap)&&(this.overscaledZ<u.overscaledZ||!(this.overscaledZ>u.overscaledZ)&&(this.canonical.x<u.canonical.x||!(this.canonical.x>u.canonical.x)&&this.canonical.y<u.canonical.y))}wrapped(){return new va(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(u){return new va(this.overscaledZ,u,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new S5(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(u){return this.canonical.getTilePoint(new jm(u.x-this.wrap,u.y))}}function Wd(f,u,p,T,D){(f*=2)<0&&(f=-1*f-1);const z=1<<p;return(z*z*f+z*D+T).toString(36)+p.toString(36)+u.toString(36)}Nt("CanonicalTileID",rx),Nt("OverscaledTileID",va,{omit:["posMatrix"]});class M5{constructor(u,p,T){if(this.uid=u,p.height!==p.width)throw new RangeError("DEM tiles must be square");if(T&&T!=="mapbox"&&T!=="terrarium")return void me(`"${T}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=p.height;const D=this.dim=p.height-2;this.data=new Uint32Array(p.data.buffer),this.encoding=T||"mapbox";for(let z=0;z<D;z++)this.data[this._idx(-1,z)]=this.data[this._idx(0,z)],this.data[this._idx(D,z)]=this.data[this._idx(D-1,z)],this.data[this._idx(z,-1)]=this.data[this._idx(z,0)],this.data[this._idx(z,D)]=this.data[this._idx(z,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let z=0;z<D;z++)for(let F=0;F<D;F++){const $=this.get(z,F);$>this.max&&(this.max=$),$<this.min&&(this.min=$)}}get(u,p){const T=new Uint8Array(this.data.buffer),D=4*this._idx(u,p);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(T[D],T[D+1],T[D+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(u,p){if(u<-1||u>=this.dim+1||p<-1||p>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(p+1)*this.stride+(u+1)}_unpackMapbox(u,p,T){return(256*u*256+256*p+T)/10-1e4}_unpackTerrarium(u,p,T){return 256*u+p+T/256-32768}getPixels(){return new _a({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(u,p,T){if(this.dim!==u.dim)throw new Error("dem dimension mismatch");let D=p*this.dim,z=p*this.dim+this.dim,F=T*this.dim,$=T*this.dim+this.dim;switch(p){case-1:D=z-1;break;case 1:z=D+1}switch(T){case-1:F=$-1;break;case 1:$=F+1}const Z=-p*this.dim,re=-T*this.dim;for(let Ae=F;Ae<$;Ae++)for(let ce=D;ce<z;ce++)this.data[this._idx(ce,Ae)]=u.data[this._idx(ce+Z,Ae+re)]}}Nt("DEMData",M5);class C5{constructor(u){this._stringToNumber={},this._numberToString=[];for(let p=0;p<u.length;p++){const T=u[p];this._stringToNumber[T]=p,this._numberToString[p]=T}}encode(u){return this._stringToNumber[u]}decode(u){if(u>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${u} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[u]}}class P5{constructor(u,p,T,D,z){this.type="Feature",this._vectorTileFeature=u,u._z=p,u._x=T,u._y=D,this.properties=u.properties,this.id=z}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(u){this._geometry=u}toJSON(){const u={geometry:this.geometry};for(const p in this)p!=="_geometry"&&p!=="_vectorTileFeature"&&(u[p]=this[p]);return u}}class I5{constructor(u,p){this.tileID=u,this.x=u.canonical.x,this.y=u.canonical.y,this.z=u.canonical.z,this.grid=new ga(Li,16,0),this.grid3D=new ga(Li,16,0),this.featureIndexArray=new O,this.promoteId=p}insert(u,p,T,D,z,F){const $=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(T,D,z);const Z=F?this.grid3D:this.grid;for(let re=0;re<p.length;re++){const Ae=p[re],ce=[1/0,1/0,-1/0,-1/0];for(let pe=0;pe<Ae.length;pe++){const ye=Ae[pe];ce[0]=Math.min(ce[0],ye.x),ce[1]=Math.min(ce[1],ye.y),ce[2]=Math.max(ce[2],ye.x),ce[3]=Math.max(ce[3],ye.y)}ce[0]<Li&&ce[1]<Li&&ce[2]>=0&&ce[3]>=0&&Z.insert($,ce[0],ce[1],ce[2],ce[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new xc.VectorTile(new jv(this.rawTileData)).layers,this.sourceLayerCoder=new C5(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(u,p,T,D){this.loadVTLayers();const z=u.params||{},F=Li/u.tileSize/u.scale,$=Us(z.filter),Z=u.queryGeometry,re=u.queryPadding*F,Ae=L5(Z),ce=this.grid.query(Ae.minX-re,Ae.minY-re,Ae.maxX+re,Ae.maxY+re),pe=L5(u.cameraQueryGeometry),ye=this.grid3D.query(pe.minX-re,pe.minY-re,pe.maxX+re,pe.maxY+re,(ze,tt,At,et)=>function(ot,gt,pt,Zt,tn){for(const Ut of ot)if(gt<=Ut.x&&pt<=Ut.y&&Zt>=Ut.x&&tn>=Ut.y)return!0;const Ht=[new Tt(gt,pt),new Tt(gt,tn),new Tt(Zt,tn),new Tt(Zt,pt)];if(ot.length>2){for(const Ut of Ht)if(Bf(ot,Ut))return!0}for(let Ut=0;Ut<ot.length-1;Ut++)if(T7(ot[Ut],ot[Ut+1],Ht))return!0;return!1}(u.cameraQueryGeometry,ze-re,tt-re,At+re,et+re));for(const ze of ye)ce.push(ze);ce.sort(KN);const _e={};let Ue;for(let ze=0;ze<ce.length;ze++){const tt=ce[ze];if(tt===Ue)continue;Ue=tt;const At=this.featureIndexArray.get(tt);let et=null;this.loadMatchingFeature(_e,At.bucketIndex,At.sourceLayerIndex,At.featureIndex,$,z.layers,z.availableImages,p,T,D,(ot,gt,pt)=>(et||(et=vh(ot)),gt.queryIntersectsFeature(Z,ot,pt,et,this.z,u.transform,F,u.pixelPosMatrix)))}return _e}loadMatchingFeature(u,p,T,D,z,F,$,Z,re,Ae,ce){const pe=this.bucketLayerIDs[p];if(F&&!function(ze,tt){for(let At=0;At<ze.length;At++)if(tt.indexOf(ze[At])>=0)return!0;return!1}(F,pe))return;const ye=this.sourceLayerCoder.decode(T),_e=this.vtLayers[ye].feature(D);if(z.needGeometry){const ze=xh(_e,!0);if(!z.filter(new br(this.tileID.overscaledZ),ze,this.tileID.canonical))return}else if(!z.filter(new br(this.tileID.overscaledZ),_e))return;const Ue=this.getId(_e,ye);for(let ze=0;ze<pe.length;ze++){const tt=pe[ze];if(F&&F.indexOf(tt)<0)continue;const At=Z[tt];if(!At)continue;let et={};Ue&&Ae&&(et=Ae.getState(At.sourceLayer||"_geojsonTileLayer",Ue));const ot=H({},re[tt]);ot.paint=k5(ot.paint,At.paint,_e,et,$),ot.layout=k5(ot.layout,At.layout,_e,et,$);const gt=!ce||ce(_e,At,et);if(!gt)continue;const pt=new P5(_e,this.z,this.x,this.y,Ue);pt.layer=ot;let Zt=u[tt];Zt===void 0&&(Zt=u[tt]=[]),Zt.push({featureIndex:D,feature:pt,intersectionZ:gt})}}lookupSymbolFeatures(u,p,T,D,z,F,$,Z){const re={};this.loadVTLayers();const Ae=Us(z);for(const ce of u)this.loadMatchingFeature(re,T,D,ce,Ae,F,$,Z,p);return re}hasLayer(u){for(const p of this.bucketLayerIDs)for(const T of p)if(u===T)return!0;return!1}getId(u,p){let T=u.id;return this.promoteId&&(T=u.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[p]],typeof T=="boolean"&&(T=Number(T))),T}}function k5(f,u,p,T,D){return X(f,(z,F)=>{const $=u instanceof Rl?u.get(F):null;return $&&$.evaluate?$.evaluate(p,T,D):$})}function L5(f){let u=1/0,p=1/0,T=-1/0,D=-1/0;for(const z of f)u=Math.min(u,z.x),p=Math.min(p,z.y),T=Math.max(T,z.x),D=Math.max(D,z.y);return{minX:u,minY:p,maxX:T,maxY:D}}function KN(f,u){return u-f}var ix;Nt("FeatureIndex",I5,{omit:["rawTileData","sourceLayerCoder"]}),o.PerformanceMarkers=void 0,(ix=o.PerformanceMarkers||(o.PerformanceMarkers={})).create="create",ix.load="load",ix.fullLoad="fullLoad";let Hm=null,Qd=[];const sx=1e3/30,JN={mark(f){performance.mark(f)},frame(f){const u=f;Hm!=null&&Qd.push(u-Hm),Hm=u},clearMetrics(){Hm=null,Qd=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const f in o.PerformanceMarkers)performance.clearMarks(o.PerformanceMarkers[f])},getPerformanceMetrics(){performance.measure("loadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.load),performance.measure("fullLoadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.fullLoad);const f=performance.getEntriesByName("loadTime")[0].duration,u=performance.getEntriesByName("fullLoadTime")[0].duration,p=Qd.length,T=1/(Qd.reduce((z,F)=>z+F,0)/p/1e3),D=Qd.filter(z=>z>sx).reduce((z,F)=>z+(F-sx)/sx,0);return{loadTime:f,fullLoadTime:u,fps:T,percentDroppedFrames:D/(p+D)*100}}};o.AJAXError=er,o.ARRAY_TYPE=qs,o.Actor=class{constructor(f,u,p){this.target=f,this.parent=u,this.mapId=p,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},se(["receive","process"],this),this.invoker=new XN(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Qe()?f:window}send(f,u,p,T,D=!1){const z=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(this.callbacks[z]=p);const F=Ze(this.globalScope)?void 0:[];return this.target.postMessage({id:z,type:f,hasCallback:!!p,targetMapId:T,mustQueue:D,sourceMapId:this.mapId,data:ma(u,F)},F),{cancel:()=>{p&&delete this.callbacks[z],this.target.postMessage({id:z,type:"<cancel>",targetMapId:T,sourceMapId:this.mapId})}}}receive(f){const u=f.data,p=u.id;if(p&&(!u.targetMapId||this.mapId===u.targetMapId))if(u.type==="<cancel>"){delete this.tasks[p];const T=this.cancelCallbacks[p];delete this.cancelCallbacks[p],T&&T()}else Qe()||u.mustQueue?(this.tasks[p]=u,this.taskQueue.push(p),this.invoker.trigger()):this.processTask(p,u)}process(){if(!this.taskQueue.length)return;const f=this.taskQueue.shift(),u=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),u&&this.processTask(f,u)}processTask(f,u){if(u.type==="<response>"){const p=this.callbacks[f];delete this.callbacks[f],p&&(u.error?p(Wo(u.error)):p(null,Wo(u.data)))}else{let p=!1;const T=Ze(this.globalScope)?void 0:[],D=u.hasCallback?($,Z)=>{p=!0,delete this.cancelCallbacks[f],this.target.postMessage({id:f,type:"<response>",sourceMapId:this.mapId,error:$?ma($):null,data:ma(Z,T)},T)}:$=>{p=!0};let z=null;const F=Wo(u.data);if(this.parent[u.type])z=this.parent[u.type](u.sourceMapId,F,D);else if(this.parent.getWorkerSource){const $=u.type.split(".");z=this.parent.getWorkerSource(u.sourceMapId,$[0],F.source)[$[1]](F,D)}else D(new Error(`Could not find function ${u.type}`));!p&&z&&z.cancel&&(this.cancelCallbacks[f]=z.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.AlphaImage=Od,o.CanonicalTileID=rx,o.CollisionBoxArray=Ve,o.CollisionCircleLayoutArray=class extends B{},o.Color=a,o.DEMData=M5,o.DataConstantProperty=Yt,o.DictionaryCoder=C5,o.EXTENT=Li,o.ErrorEvent=Oo,o.EvaluationParameters=br,o.Event=Mi,o.Evented=is,o.FeatureIndex=I5,o.FillBucket=Uv,o.FillExtrusionBucket=Gv,o.GeoJSONFeature=P5,o.ImageAtlas=e5,o.ImagePosition=Wv,o.LineBucket=$v,o.LineStripIndexArray=class extends ve{},o.LngLat=Ai,o.LngLatBounds=bh,o.MercatorCoordinate=jm,o.ONE_EM=Xi,o.OverscaledTileID=va,o.PerformanceUtils=JN,o.PosArray=N,o.Properties=Nr,o.QuadTriangleArray=class extends j{},o.RGBAImage=_a,o.RasterBoundsArray=class extends L{},o.RequestPerformance=class{constructor(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let f=performance.getEntriesByName(this._marks.measure);return f.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),f=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),f}},o.ResourceType=xt,o.SegmentVector=dt,o.SymbolBucket=Gf,o.Transitionable=hu,o.TriangleIndexArray=st,o.Uniform1f=du,o.Uniform1i=class extends Xa{constructor(f,u){super(f,u),this.current=0}set(f){this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},o.Uniform2f=class extends Xa{constructor(f,u){super(f,u),this.current=[0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1]))}},o.Uniform3f=class extends Xa{constructor(f,u){super(f,u),this.current=[0,0,0]}set(f){f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2]))}},o.Uniform4f=Df,o.UniformColor=g4,o.UniformMatrix4f=class extends Xa{constructor(f,u){super(f,u),this.current=v7}set(f){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let u=1;u<16;u++)if(f[u]!==this.current[u]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}},o.UnwrappedTileID=S5,o.ValidationError=kt,o.ZoomHistory=ou,o.add=function(f,u,p){return f[0]=u[0]+p[0],f[1]=u[1]+p[1],f[2]=u[2]+p[2],f},o.addDynamicAttributes=Xv,o.asyncAll=function(f,u,p){if(!f.length)return p(null,[]);let T=f.length;const D=new Array(f.length);let z=null;f.forEach((F,$)=>{u(F,(Z,re)=>{Z&&(z=Z),D[$]=re,--T==0&&p(z,D)})})},o.bezier=C,o.bindAll=se,o.cacheEntryPossiblyAdded=function(f){ir++,ir>Tr&&(f.getActor().send("enforceCacheSizeLimit",Tn),ir=0)},o.clamp=k,o.clearTileCache=function(f){const u=caches.delete(Et);f&&u.catch(f).then(()=>f())},o.clipLine=h5,o.clone=function(f){var u=new qs(16);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5],u[6]=f[6],u[7]=f[7],u[8]=f[8],u[9]=f[9],u[10]=f[10],u[11]=f[11],u[12]=f[12],u[13]=f[13],u[14]=f[14],u[15]=f[15],u},o.clone$1=ie,o.clone$2=function(f){var u=new qs(3);return u[0]=f[0],u[1]=f[1],u[2]=f[2],u},o.collisionCircleLayout=mN,o.config=_t,o.copy=function(f,u){return f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[4]=u[4],f[5]=u[5],f[6]=u[6],f[7]=u[7],f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},o.create=function(){var f=new qs(16);return qs!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},o.create$1=E4,o.createExpression=Ga,o.createFilter=Us,o.createLayout=Ur,o.createStyleLayer=function(f){return f.type==="custom"?new ZN(f):new YN[f.type](f)},o.cross=function(f,u,p){var T=u[0],D=u[1],z=u[2],F=p[0],$=p[1],Z=p[2];return f[0]=D*Z-z*$,f[1]=z*F-T*Z,f[2]=T*$-D*F,f},o.dot=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]},o.dot$1=function(f,u){return f[0]*u[0]+f[1]*u[1]+f[2]*u[2]+f[3]*u[3]},o.ease=I,o.emitValidationErrors=Qa,o.enforceCacheSizeLimit=function(f){Jn(),Jt&&Jt.then(u=>{u.keys().then(p=>{for(let T=0;T<p.length-f;T++)u.delete(p[T])})})},o.equals=function(f,u){var p=f[0],T=f[1],D=f[2],z=f[3],F=f[4],$=f[5],Z=f[6],re=f[7],Ae=f[8],ce=f[9],pe=f[10],ye=f[11],_e=f[12],Ue=f[13],ze=f[14],tt=f[15],At=u[0],et=u[1],ot=u[2],gt=u[3],pt=u[4],Zt=u[5],tn=u[6],Ht=u[7],Ut=u[8],Ot=u[9],Wt=u[10],$t=u[11],St=u[12],gn=u[13],ln=u[14],jn=u[15];return Math.abs(p-At)<=Qs*Math.max(1,Math.abs(p),Math.abs(At))&&Math.abs(T-et)<=Qs*Math.max(1,Math.abs(T),Math.abs(et))&&Math.abs(D-ot)<=Qs*Math.max(1,Math.abs(D),Math.abs(ot))&&Math.abs(z-gt)<=Qs*Math.max(1,Math.abs(z),Math.abs(gt))&&Math.abs(F-pt)<=Qs*Math.max(1,Math.abs(F),Math.abs(pt))&&Math.abs($-Zt)<=Qs*Math.max(1,Math.abs($),Math.abs(Zt))&&Math.abs(Z-tn)<=Qs*Math.max(1,Math.abs(Z),Math.abs(tn))&&Math.abs(re-Ht)<=Qs*Math.max(1,Math.abs(re),Math.abs(Ht))&&Math.abs(Ae-Ut)<=Qs*Math.max(1,Math.abs(Ae),Math.abs(Ut))&&Math.abs(ce-Ot)<=Qs*Math.max(1,Math.abs(ce),Math.abs(Ot))&&Math.abs(pe-Wt)<=Qs*Math.max(1,Math.abs(pe),Math.abs(Wt))&&Math.abs(ye-$t)<=Qs*Math.max(1,Math.abs(ye),Math.abs($t))&&Math.abs(_e-St)<=Qs*Math.max(1,Math.abs(_e),Math.abs(St))&&Math.abs(Ue-gn)<=Qs*Math.max(1,Math.abs(Ue),Math.abs(gn))&&Math.abs(ze-ln)<=Qs*Math.max(1,Math.abs(ze),Math.abs(ln))&&Math.abs(tt-jn)<=Qs*Math.max(1,Math.abs(tt),Math.abs(jn))},o.evaluateSizeForFeature=function(f,{uSize:u,uSizeT:p},{lowerSize:T,upperSize:D}){return f.kind==="source"?T/mu:f.kind==="composite"?en(T/mu,D/mu,p):u},o.evaluateSizeForZoom=function(f,u){let p=0,T=0;if(f.kind==="constant")T=f.layoutSize;else if(f.kind!=="source"){const{interpolationType:D,minZoom:z,maxZoom:F}=f,$=D?k(zn.interpolationFactor(D,u,z,F),0,1):0;f.kind==="camera"?T=en(f.minSize,f.maxSize,$):p=$}return{uSizeT:p,uSize:T}},o.evaluateVariableOffset=p5,o.evented=Br,o.exported=Kt,o.exported$1=ur,o.extend=H,o.filterObject=te,o.fromRotation=function(f,u){var p=Math.sin(u),T=Math.cos(u);return f[0]=T,f[1]=p,f[2]=0,f[3]=-p,f[4]=T,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},o.fromScaling=function(f,u){return f[0]=u[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=u[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=u[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f},o.getAnchorAlignment=qv,o.getAnchorJustification=Yv,o.getArrayBuffer=tr,o.getImage=Fi,o.getJSON=function(f,u){return or(H(f,{type:"json"}),u)},o.getOverlapMode=tx,o.getRTLTextPluginStatus=Ll,o.getReferrer=Hn,o.getVideo=function(f,u){const p=window.document.createElement("video");p.muted=!0,p.onloadstart=function(){u(null,p)};for(let T=0;T<f.length;T++){const D=window.document.createElement("source");Kr(f[T])||(p.crossOrigin="Anonymous"),D.src=f[T],p.appendChild(D)}return{cancel:()=>{}}},o.identity=kv,o.invert=function(f,u){var p=u[0],T=u[1],D=u[2],z=u[3],F=u[4],$=u[5],Z=u[6],re=u[7],Ae=u[8],ce=u[9],pe=u[10],ye=u[11],_e=u[12],Ue=u[13],ze=u[14],tt=u[15],At=p*$-T*F,et=p*Z-D*F,ot=p*re-z*F,gt=T*Z-D*$,pt=T*re-z*$,Zt=D*re-z*Z,tn=Ae*Ue-ce*_e,Ht=Ae*ze-pe*_e,Ut=Ae*tt-ye*_e,Ot=ce*ze-pe*Ue,Wt=ce*tt-ye*Ue,$t=pe*tt-ye*ze,St=At*$t-et*Wt+ot*Ot+gt*Ut-pt*Ht+Zt*tn;return St?(f[0]=($*$t-Z*Wt+re*Ot)*(St=1/St),f[1]=(D*Wt-T*$t-z*Ot)*St,f[2]=(Ue*Zt-ze*pt+tt*gt)*St,f[3]=(pe*pt-ce*Zt-ye*gt)*St,f[4]=(Z*Ut-F*$t-re*Ht)*St,f[5]=(p*$t-D*Ut+z*Ht)*St,f[6]=(ze*ot-_e*Zt-tt*et)*St,f[7]=(Ae*Zt-pe*ot+ye*et)*St,f[8]=(F*Wt-$*Ut+re*tn)*St,f[9]=(T*Ut-p*Wt-z*tn)*St,f[10]=(_e*pt-Ue*ot+tt*At)*St,f[11]=(ce*ot-Ae*pt-ye*At)*St,f[12]=($*Ht-F*Ot-Z*tn)*St,f[13]=(p*Ot-T*Ht+D*tn)*St,f[14]=(Ue*et-_e*gt-ze*At)*St,f[15]=(Ae*gt-ce*et+pe*At)*St,f):null},o.isImageBitmap=mt,o.isSafari=Ze,o.isWorker=Qe,o.keysDifference=function(f,u){const p=[];for(const T in f)T in u||p.push(T);return p},o.lazyLoadRTLTextPlugin=function(){cs.isLoading()||cs.isLoaded()||Ll()!=="deferred"||mc()},o.makeRequest=or,o.mapObject=X,o.mercatorXfromLng=w5,o.mercatorYfromLat=b5,o.mercatorZfromAltitude=E5,o.mul=C7,o.mul$1=function(f,u,p){return f[0]=u[0]*p[0],f[1]=u[1]*p[1],f[2]=u[2]*p[2],f[3]=u[3]*p[3],f},o.multiply=T4,o.nextPowerOfTwo=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},o.normalize=function(f,u){var p=u[0],T=u[1],D=u[2],z=p*p+T*T+D*D;return z>0&&(z=1/Math.sqrt(z)),f[0]=u[0]*z,f[1]=u[1]*z,f[2]=u[2]*z,f},o.number=en,o.ortho=function(f,u,p,T,D,z,F){var $=1/(u-p),Z=1/(T-D),re=1/(z-F);return f[0]=-2*$,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*Z,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*re,f[11]=0,f[12]=(u+p)*$,f[13]=(D+T)*Z,f[14]=(F+z)*re,f[15]=1,f},o.parseCacheControl=Ke,o.parseGlyphPbf=function(f){return new jv(f).readFields(CN,[])},o.pbf=jv,o.performSymbolLayout=function(f){f.bucket.createArrays(),f.bucket.tilePixelRatio=Li/(512*f.bucket.overscaling),f.bucket.compareText={},f.bucket.iconsNeedLinear=!1;const u=f.bucket.layers[0].layout,p=f.bucket.layers[0]._unevaluatedLayout._values,T={layoutIconSize:p["icon-size"].possiblyEvaluate(new br(f.bucket.zoom+1),f.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new br(f.bucket.zoom+1),f.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new br(18))};if(f.bucket.textSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.textSizeData;T.compositeTextSizes=[p["text-size"].possiblyEvaluate(new br(Z),f.canonical),p["text-size"].possiblyEvaluate(new br(re),f.canonical)]}if(f.bucket.iconSizeData.kind==="composite"){const{minZoom:Z,maxZoom:re}=f.bucket.iconSizeData;T.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new br(Z),f.canonical),p["icon-size"].possiblyEvaluate(new br(re),f.canonical)]}const D=u.get("text-line-height")*Xi,z=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",F=u.get("text-keep-upright"),$=u.get("text-size");for(const Z of f.bucket.features){const re=u.get("text-font").evaluate(Z,{},f.canonical).join(","),Ae=$.evaluate(Z,{},f.canonical),ce=T.layoutTextSize.evaluate(Z,{},f.canonical),pe=T.layoutIconSize.evaluate(Z,{},f.canonical),ye={horizontal:{},vertical:void 0},_e=Z.text;let Ue,ze=[0,0];if(_e){const et=_e.toString(),ot=u.get("text-letter-spacing").evaluate(Z,{},f.canonical)*Xi,gt=kl(et)?ot:0,pt=u.get("text-anchor").evaluate(Z,{},f.canonical),Zt=u.get("text-variable-anchor");if(!Zt){const Wt=u.get("text-radial-offset").evaluate(Z,{},f.canonical);ze=Wt?p5(pt,[Wt*Xi,Zv]):u.get("text-offset").evaluate(Z,{},f.canonical).map($t=>$t*Xi)}let tn=z?"center":u.get("text-justify").evaluate(Z,{},f.canonical);const Ht=u.get("symbol-placement"),Ut=Ht==="point"?u.get("text-max-width").evaluate(Z,{},f.canonical)*Xi:0,Ot=()=>{f.bucket.allowVerticalPlacement&&yA(et)&&(ye.vertical=zm(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,pt,"left",gt,ze,o.WritingMode.vertical,!0,Ht,ce,Ae))};if(!z&&Zt){const Wt=tn==="auto"?Zt.map(St=>Yv(St)):[tn];let $t=!1;for(let St=0;St<Wt.length;St++){const gn=Wt[St];if(!ye.horizontal[gn])if($t)ye.horizontal[gn]=ye.horizontal[0];else{const ln=zm(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,"center",gn,gt,ze,o.WritingMode.horizontal,!1,Ht,ce,Ae);ln&&(ye.horizontal[gn]=ln,$t=ln.positionedLines.length===1)}}Ot()}else{tn==="auto"&&(tn=Yv(pt));const Wt=zm(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,pt,tn,gt,ze,o.WritingMode.horizontal,!1,Ht,ce,Ae);Wt&&(ye.horizontal[tn]=Wt),Ot(),yA(et)&&z&&F&&(ye.vertical=zm(_e,f.glyphMap,f.glyphPositions,f.imagePositions,re,Ut,D,pt,tn,gt,ze,o.WritingMode.vertical,!1,Ht,ce,Ae))}}let tt=!1;if(Z.icon&&Z.icon.name){const et=f.imageMap[Z.icon.name];et&&(Ue=RN(f.imagePositions[Z.icon.name],u.get("icon-offset").evaluate(Z,{},f.canonical),u.get("icon-anchor").evaluate(Z,{},f.canonical)),tt=!!et.sdf,f.bucket.sdfIcons===void 0?f.bucket.sdfIcons=tt:f.bucket.sdfIcons!==tt&&me("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(et.pixelRatio!==f.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(f.bucket.iconsNeedLinear=!0))}const At=m5(ye.horizontal)||ye.vertical;f.bucket.iconsInText=!!At&&At.iconsInText,(At||Ue)&&VN(f.bucket,Z,ye,Ue,f.imageMap,T,ce,pe,ze,tt,f.canonical)}f.showCollisionBoxes&&f.bucket.generateCollisionDebugBuffers()},o.perspective=function(f,u,p,T,D){var z,F=1/Math.tan(u/2);return f[0]=F/p,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=F,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,D!=null&&D!==1/0?(f[10]=(D+T)*(z=1/(T-D)),f[14]=2*D*T*z):(f[10]=-1,f[14]=-2*T),f},o.pick=function(f,u){const p={};for(let T=0;T<u.length;T++){const D=u[T];D in f&&(p[D]=f[D])}return p},o.plugin=cs,o.pointGeometry=Tt,o.polygonIntersectsPolygon=v4,o.potpack=J4,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=Nt,o.registerForPluginStateChange=function(f){return f({pluginStatus:ki,pluginURL:xo}),Br.on("pluginStateChange",f),f},o.renderColorRamp=L4,o.rotateX=function(f,u,p){var T=Math.sin(p),D=Math.cos(p),z=u[4],F=u[5],$=u[6],Z=u[7],re=u[8],Ae=u[9],ce=u[10],pe=u[11];return u!==f&&(f[0]=u[0],f[1]=u[1],f[2]=u[2],f[3]=u[3],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[4]=z*D+re*T,f[5]=F*D+Ae*T,f[6]=$*D+ce*T,f[7]=Z*D+pe*T,f[8]=re*D-z*T,f[9]=Ae*D-F*T,f[10]=ce*D-$*T,f[11]=pe*D-Z*T,f},o.rotateZ=function(f,u,p){var T=Math.sin(p),D=Math.cos(p),z=u[0],F=u[1],$=u[2],Z=u[3],re=u[4],Ae=u[5],ce=u[6],pe=u[7];return u!==f&&(f[8]=u[8],f[9]=u[9],f[10]=u[10],f[11]=u[11],f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15]),f[0]=z*D+re*T,f[1]=F*D+Ae*T,f[2]=$*D+ce*T,f[3]=Z*D+pe*T,f[4]=re*D-z*T,f[5]=Ae*D-F*T,f[6]=ce*D-$*T,f[7]=pe*D-Z*T,f},o.scale=function(f,u,p){var T=p[0],D=p[1],z=p[2];return f[0]=u[0]*T,f[1]=u[1]*T,f[2]=u[2]*T,f[3]=u[3]*T,f[4]=u[4]*D,f[5]=u[5]*D,f[6]=u[6]*D,f[7]=u[7]*D,f[8]=u[8]*z,f[9]=u[9]*z,f[10]=u[10]*z,f[11]=u[11]*z,f[12]=u[12],f[13]=u[13],f[14]=u[14],f[15]=u[15],f},o.scale$1=function(f,u,p){return f[0]=u[0]*p,f[1]=u[1]*p,f[2]=u[2]*p,f},o.setCacheLimits=function(f,u){Tn=f,Tr=u},o.setRTLTextPlugin=function(f,u,p=!1){if(ki===lu||ki===Au||ki===uu)throw new Error("setRTLTextPlugin cannot be called multiple times.");xo=Kt.resolveURL(f),ki=lu,$s=u,ya(),p||mc()},o.spec=ct,o.sphericalToCartesian=function([f,u,p]){return u+=90,u*=Math.PI/180,p*=Math.PI/180,{x:f*Math.cos(u)*Math.sin(p),y:f*Math.sin(u)*Math.sin(p),z:f*Math.cos(p)}},o.sqrLen=function(f){var u=f[0],p=f[1];return u*u+p*p},o.sub=function(f,u,p){return f[0]=u[0]-p[0],f[1]=u[1]-p[1],f[2]=u[2]-p[2],f},o.toEvaluationFeature=xh,o.transformMat3=function(f,u,p){var T=u[0],D=u[1],z=u[2];return f[0]=T*p[0]+D*p[3]+z*p[6],f[1]=T*p[1]+D*p[4]+z*p[7],f[2]=T*p[2]+D*p[5]+z*p[8],f},o.transformMat4=Cm,o.transformMat4$1=function(f,u,p){var T=u[0],D=u[1];return f[0]=p[0]*T+p[4]*D+p[12],f[1]=p[1]*T+p[5]*D+p[13],f},o.translate=function(f,u,p){var T,D,z,F,$,Z,re,Ae,ce,pe,ye,_e,Ue=p[0],ze=p[1],tt=p[2];return u===f?(f[12]=u[0]*Ue+u[4]*ze+u[8]*tt+u[12],f[13]=u[1]*Ue+u[5]*ze+u[9]*tt+u[13],f[14]=u[2]*Ue+u[6]*ze+u[10]*tt+u[14],f[15]=u[3]*Ue+u[7]*ze+u[11]*tt+u[15]):(D=u[1],z=u[2],F=u[3],$=u[4],Z=u[5],re=u[6],Ae=u[7],ce=u[8],pe=u[9],ye=u[10],_e=u[11],f[0]=T=u[0],f[1]=D,f[2]=z,f[3]=F,f[4]=$,f[5]=Z,f[6]=re,f[7]=Ae,f[8]=ce,f[9]=pe,f[10]=ye,f[11]=_e,f[12]=T*Ue+$*ze+ce*tt+u[12],f[13]=D*Ue+Z*ze+pe*tt+u[13],f[14]=z*Ue+re*ze+ye*tt+u[14],f[15]=F*Ue+Ae*ze+_e*tt+u[15]),f},o.triggerPluginCompletionEvent=cu,o.unicodeBlockLookup=Vt,o.uniqueId=function(){return q++},o.validateCustomStyleLayer=function(f){const u=[],p=f.id;return p===void 0&&u.push({message:`layers.${p}: missing required property "id"`}),f.render===void 0&&u.push({message:`layers.${p}: missing required method "render"`}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&u.push({message:`layers.${p}: property "renderingMode" must be either "2d" or "3d"`}),u},o.validateLight=Wa,o.validateStyle=Il,o.vectorTile=xc,o.warnOnce=me,o.wrap=U}),s(["./shared"],function(o){function g(K){const W=typeof K;if(W==="number"||W==="boolean"||W==="string"||K==null)return JSON.stringify(K);if(Array.isArray(K)){let a="[";for(const G of K)a+=`${g(G)},`;return`${a}]`}const ee=Object.keys(K).sort();let he="{";for(let a=0;a<ee.length;a++)he+=`${JSON.stringify(ee[a])}:${g(K[ee[a]])},`;return`${he}}`}function w(K){let W="";for(const ee of o.refProperties)W+=`/${g(K[ee])}`;return W}class C{constructor(W){this.keyCache={},W&&this.replace(W)}replace(W){this._layerConfigs={},this._layers={},this.update(W,[])}update(W,ee){for(const a of W){this._layerConfigs[a.id]=a;const G=this._layers[a.id]=o.createStyleLayer(a);G._featureFilter=o.createFilter(G.filter),this.keyCache[a.id]&&delete this.keyCache[a.id]}for(const a of ee)delete this.keyCache[a],delete this._layerConfigs[a],delete this._layers[a];this.familiesBySource={};const he=function(a,G){const Le={};for(let Pe=0;Pe<a.length;Pe++){const ke=G&&G[a[Pe].id]||w(a[Pe]);G&&(G[a[Pe].id]=ke);let qe=Le[ke];qe||(qe=Le[ke]=[]),qe.push(a[Pe])}const Ie=[];for(const Pe in Le)Ie.push(Le[Pe]);return Ie}(Object.values(this._layerConfigs),this.keyCache);for(const a of he){const G=a.map(lt=>this._layers[lt.id]),Le=G[0];if(Le.visibility==="none")continue;const Ie=Le.source||"";let Pe=this.familiesBySource[Ie];Pe||(Pe=this.familiesBySource[Ie]={});const ke=Le.sourceLayer||"_geojsonTileLayer";let qe=Pe[ke];qe||(qe=Pe[ke]=[]),qe.push(G)}}}class I{constructor(W){const ee={},he=[];for(const Ie in W){const Pe=W[Ie],ke=ee[Ie]={};for(const qe in Pe){const lt=Pe[+qe];if(!lt||lt.bitmap.width===0||lt.bitmap.height===0)continue;const We={x:0,y:0,w:lt.bitmap.width+2,h:lt.bitmap.height+2};he.push(We),ke[qe]={rect:We,metrics:lt.metrics}}}const{w:a,h:G}=o.potpack(he),Le=new o.AlphaImage({width:a||1,height:G||1});for(const Ie in W){const Pe=W[Ie];for(const ke in Pe){const qe=Pe[+ke];if(!qe||qe.bitmap.width===0||qe.bitmap.height===0)continue;const lt=ee[Ie][ke].rect;o.AlphaImage.copy(qe.bitmap,Le,{x:0,y:0},{x:lt.x+1,y:lt.y+1},qe.bitmap)}}this.image=Le,this.positions=ee}}o.register("GlyphAtlas",I);class k{constructor(W){this.tileID=new o.OverscaledTileID(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId}parse(W,ee,he,a,G){this.status="parsing",this.data=W,this.collisionBoxArray=new o.CollisionBoxArray;const Le=new o.DictionaryCoder(Object.keys(W.layers).sort()),Ie=new o.FeatureIndex(this.tileID,this.promoteId);Ie.bucketLayerIDs=[];const Pe={},ke={featureIndex:Ie,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:he},qe=ee.familiesBySource[this.source];for(const qt in qe){const an=W.layers[qt];if(!an)continue;an.version===1&&o.warnOnce(`Vector tile source "${this.source}" layer "${qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xn=Le.encode(qt),Ft=[];for(let Oe=0;Oe<an.length;Oe++){const Ct=an.feature(Oe),Me=Ie.getId(Ct,qt);Ft.push({feature:Ct,id:Me,index:Oe,sourceLayerIndex:xn})}for(const Oe of qe[qt]){const Ct=Oe[0];Ct.source!==this.source&&o.warnOnce(`layer.source = ${Ct.source} does not equal this.source = ${this.source}`),Ct.minzoom&&this.zoom<Math.floor(Ct.minzoom)||Ct.maxzoom&&this.zoom>=Ct.maxzoom||Ct.visibility!=="none"&&(U(Oe,this.zoom,he),(Pe[Ct.id]=Ct.createBucket({index:Ie.bucketLayerIDs.length,layers:Oe,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xn,sourceID:this.source})).populate(Ft,ke,this.tileID.canonical),Ie.bucketLayerIDs.push(Oe.map(Me=>Me.id)))}}let lt,We,ft,Dt;const Rt=o.mapObject(ke.glyphDependencies,qt=>Object.keys(qt).map(Number));Object.keys(Rt).length?a.send("getGlyphs",{uid:this.uid,stacks:Rt},(qt,an)=>{lt||(lt=qt,We=an,pn.call(this))}):We={};const sn=Object.keys(ke.iconDependencies);sn.length?a.send("getImages",{icons:sn,source:this.source,tileID:this.tileID,type:"icons"},(qt,an)=>{lt||(lt=qt,ft=an,pn.call(this))}):ft={};const jt=Object.keys(ke.patternDependencies);function pn(){if(lt)return G(lt);if(We&&ft&&Dt){const qt=new I(We),an=new o.ImageAtlas(ft,Dt);for(const xn in Pe){const Ft=Pe[xn];Ft instanceof o.SymbolBucket?(U(Ft.layers,this.zoom,he),o.performSymbolLayout({bucket:Ft,glyphMap:We,glyphPositions:qt.positions,imageMap:ft,imagePositions:an.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ft.hasPattern&&(Ft instanceof o.LineBucket||Ft instanceof o.FillBucket||Ft instanceof o.FillExtrusionBucket)&&(U(Ft.layers,this.zoom,he),Ft.addFeatures(ke,this.tileID.canonical,an.patternPositions))}this.status="done",G(null,{buckets:Object.values(Pe).filter(xn=>!xn.isEmpty()),featureIndex:Ie,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:qt.image,imageAtlas:an,glyphMap:this.returnDependencies?We:null,iconMap:this.returnDependencies?ft:null,glyphPositions:this.returnDependencies?qt.positions:null})}}jt.length?a.send("getImages",{icons:jt,source:this.source,tileID:this.tileID,type:"patterns"},(qt,an)=>{lt||(lt=qt,Dt=an,pn.call(this))}):Dt={},pn.call(this)}}function U(K,W,ee){const he=new o.EvaluationParameters(W);for(const a of K)a.recalculate(he,ee)}function H(K,W){const ee=o.getArrayBuffer(K.request,(he,a,G,Le)=>{he?W(he):a&&W(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(a)),rawData:a,cacheControl:G,expires:Le})});return()=>{ee.cancel(),W()}}class q{constructor(W,ee,he,a){this.actor=W,this.layerIndex=ee,this.availableImages=he,this.loadVectorData=a||H,this.loading={},this.loaded={}}loadTile(W,ee){const he=W.uid;this.loading||(this.loading={});const a=!!(W&&W.request&&W.request.collectResourceTiming)&&new o.RequestPerformance(W.request),G=this.loading[he]=new k(W);G.abort=this.loadVectorData(W,(Le,Ie)=>{if(delete this.loading[he],Le||!Ie)return G.status="done",this.loaded[he]=G,ee(Le);const Pe=Ie.rawData,ke={};Ie.expires&&(ke.expires=Ie.expires),Ie.cacheControl&&(ke.cacheControl=Ie.cacheControl);const qe={};if(a){const lt=a.finish();lt&&(qe.resourceTiming=JSON.parse(JSON.stringify(lt)))}G.vectorTile=Ie.vectorTile,G.parse(Ie.vectorTile,this.layerIndex,this.availableImages,this.actor,(lt,We)=>{if(lt||!We)return ee(lt);ee(null,o.extend({rawTileData:Pe.slice(0)},We,ke,qe))}),this.loaded=this.loaded||{},this.loaded[he]=G})}reloadTile(W,ee){const he=this.loaded,a=W.uid,G=this;if(he&&he[a]){const Le=he[a];Le.showCollisionBoxes=W.showCollisionBoxes;const Ie=(Pe,ke)=>{const qe=Le.reloadCallback;qe&&(delete Le.reloadCallback,Le.parse(Le.vectorTile,G.layerIndex,this.availableImages,G.actor,qe)),ee(Pe,ke)};Le.status==="parsing"?Le.reloadCallback=Ie:Le.status==="done"&&(Le.vectorTile?Le.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,Ie):Ie())}}abortTile(W,ee){const he=this.loading,a=W.uid;he&&he[a]&&he[a].abort&&(he[a].abort(),delete he[a]),ee()}removeTile(W,ee){const he=this.loaded,a=W.uid;he&&he[a]&&delete he[a],ee()}}class se{constructor(){this.loaded={}}loadTile(W,ee){const{uid:he,encoding:a,rawImageData:G}=W,Le=o.isImageBitmap(G)?this.getImageData(G):G,Ie=new o.DEMData(he,Le,a);this.loaded=this.loaded||{},this.loaded[he]=Ie,ee(null,Ie)}getImageData(W){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(W.width,W.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=W.width,this.offscreenCanvas.height=W.height,this.offscreenCanvasContext.drawImage(W,0,0,W.width,W.height);const ee=this.offscreenCanvasContext.getImageData(-1,-1,W.width+2,W.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:ee.width,height:ee.height},ee.data)}removeTile(W){const ee=this.loaded,he=W.uid;ee&&ee[he]&&delete ee[he]}}var X=function K(W,ee){var he,a=W&&W.type;if(a==="FeatureCollection")for(he=0;he<W.features.length;he++)K(W.features[he],ee);else if(a==="GeometryCollection")for(he=0;he<W.geometries.length;he++)K(W.geometries[he],ee);else if(a==="Feature")K(W.geometry,ee);else if(a==="Polygon")te(W.coordinates,ee);else if(a==="MultiPolygon")for(he=0;he<W.coordinates.length;he++)te(W.coordinates[he],ee);return W};function te(K,W){if(K.length!==0){ie(K[0],W);for(var ee=1;ee<K.length;ee++)ie(K[ee],!W)}}function ie(K,W){for(var ee=0,he=0,a=0,G=K.length,Le=G-1;a<G;Le=a++){var Ie=(K[a][0]-K[Le][0])*(K[Le][1]+K[a][1]),Pe=ee+Ie;he+=Math.abs(ee)>=Math.abs(Ie)?ee-Pe+Ie:Ie-Pe+ee,ee=Pe}ee+he>=0!=!!W&&K.reverse()}const fe=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class me{constructor(W){this._feature=W,this.extent=o.EXTENT,this.type=W.type,this.properties=W.tags,"id"in W&&!isNaN(W.id)&&(this.id=parseInt(W.id,10))}loadGeometry(){if(this._feature.type===1){const W=[];for(const ee of this._feature.geometry)W.push([new o.pointGeometry(ee[0],ee[1])]);return W}{const W=[];for(const ee of this._feature.geometry){const he=[];for(const a of ee)he.push(new o.pointGeometry(a[0],a[1]));W.push(he)}return W}}toGeoJSON(W,ee,he){return fe.call(this,W,ee,he)}}class Se{constructor(W){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=W.length,this._features=W}feature(W){return new me(this._features[W])}}var He={exports:{}},Qe=o.pointGeometry,Ke=o.vectorTile.VectorTileFeature,nt=Ne;function Ne(K,W){this.options=W||{},this.features=K,this.length=K.length}function rt(K,W){this.id=typeof K.id=="number"?K.id:void 0,this.type=K.type,this.rawGeometry=K.type===1?[K.geometry]:K.geometry,this.properties=K.tags,this.extent=W||4096}Ne.prototype.feature=function(K){return new rt(this.features[K],this.options.extent)},rt.prototype.loadGeometry=function(){var K=this.rawGeometry;this.geometry=[];for(var W=0;W<K.length;W++){for(var ee=K[W],he=[],a=0;a<ee.length;a++)he.push(new Qe(ee[a][0],ee[a][1]));this.geometry.push(he)}return this.geometry},rt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var K=this.geometry,W=1/0,ee=-1/0,he=1/0,a=-1/0,G=0;G<K.length;G++)for(var Le=K[G],Ie=0;Ie<Le.length;Ie++){var Pe=Le[Ie];W=Math.min(W,Pe.x),ee=Math.max(ee,Pe.x),he=Math.min(he,Pe.y),a=Math.max(a,Pe.y)}return[W,he,ee,a]},rt.prototype.toGeoJSON=Ke.prototype.toGeoJSON;var Ze=o.pbf,mt=nt;function Kt(K){var W=new Ze;return function(ee,he){for(var a in ee.layers)he.writeMessage(3,Tt,ee.layers[a])}(K,W),W.finish()}function Tt(K,W){var ee;W.writeVarintField(15,K.version||1),W.writeStringField(1,K.name||""),W.writeVarintField(5,K.extent||4096);var he={keys:[],values:[],keycache:{},valuecache:{}};for(ee=0;ee<K.length;ee++)he.feature=K.feature(ee),W.writeMessage(2,dn,he);var a=he.keys;for(ee=0;ee<a.length;ee++)W.writeStringField(3,a[ee]);var G=he.values;for(ee=0;ee<G.length;ee++)W.writeMessage(4,Tn,G[ee])}function dn(K,W){var ee=K.feature;ee.id!==void 0&&W.writeVarintField(1,ee.id),W.writeMessage(2,_t,K),W.writeVarintField(3,ee.type),W.writeMessage(4,kn,ee)}function _t(K,W){var ee=K.feature,he=K.keys,a=K.values,G=K.keycache,Le=K.valuecache;for(var Ie in ee.properties){var Pe=ee.properties[Ie],ke=G[Ie];if(Pe!==null){ke===void 0&&(he.push(Ie),G[Ie]=ke=he.length-1),W.writeVarint(ke);var qe=typeof Pe;qe!=="string"&&qe!=="boolean"&&qe!=="number"&&(Pe=JSON.stringify(Pe));var lt=qe+":"+Pe,We=Le[lt];We===void 0&&(a.push(Pe),Le[lt]=We=a.length-1),W.writeVarint(We)}}}function Et(K,W){return(W<<3)+(7&K)}function Jt(K){return K<<1^K>>31}function kn(K,W){for(var ee=K.loadGeometry(),he=K.type,a=0,G=0,Le=ee.length,Ie=0;Ie<Le;Ie++){var Pe=ee[Ie],ke=1;he===1&&(ke=Pe.length),W.writeVarint(Et(1,ke));for(var qe=he===3?Pe.length-1:Pe.length,lt=0;lt<qe;lt++){lt===1&&he!==1&&W.writeVarint(Et(2,qe-1));var We=Pe[lt].x-a,ft=Pe[lt].y-G;W.writeVarint(Jt(We)),W.writeVarint(Jt(ft)),a+=We,G+=ft}he===3&&W.writeVarint(Et(7,1))}}function Tn(K,W){var ee=typeof K;ee==="string"?W.writeStringField(1,K):ee==="boolean"?W.writeBooleanField(7,K):ee==="number"&&(K%1!=0?W.writeDoubleField(3,K):K<0?W.writeSVarintField(6,K):W.writeVarintField(5,K))}function Tr(K,W,ee,he,a,G){if(a-he<=ee)return;const Le=he+a>>1;Jn(K,W,Le,he,a,G%2),Tr(K,W,ee,he,Le-1,G+1),Tr(K,W,ee,Le+1,a,G+1)}function Jn(K,W,ee,he,a,G){for(;a>he;){if(a-he>600){const ke=a-he+1,qe=ee-he+1,lt=Math.log(ke),We=.5*Math.exp(2*lt/3),ft=.5*Math.sqrt(lt*We*(ke-We)/ke)*(qe-ke/2<0?-1:1);Jn(K,W,ee,Math.max(he,Math.floor(ee-qe*We/ke+ft)),Math.min(a,Math.floor(ee+(ke-qe)*We/ke+ft)),G)}const Le=W[2*ee+G];let Ie=he,Pe=a;for(ir(K,W,he,ee),W[2*a+G]>Le&&ir(K,W,he,a);Ie<Pe;){for(ir(K,W,Ie,Pe),Ie++,Pe--;W[2*Ie+G]<Le;)Ie++;for(;W[2*Pe+G]>Le;)Pe--}W[2*he+G]===Le?ir(K,W,he,Pe):(Pe++,ir(K,W,Pe,a)),Pe<=ee&&(he=Pe+1),ee<=Pe&&(a=Pe-1)}}function ir(K,W,ee,he){ur(K,ee,he),ur(W,2*ee,2*he),ur(W,2*ee+1,2*he+1)}function ur(K,W,ee){const he=K[W];K[W]=K[ee],K[ee]=he}function Un(K,W,ee,he){const a=K-ee,G=W-he;return a*a+G*G}He.exports=Kt,He.exports.fromVectorTileJs=Kt,He.exports.fromGeojsonVt=function(K,W){W=W||{};var ee={};for(var he in K)ee[he]=new mt(K[he].features,W),ee[he].name=he,ee[he].version=W.version,ee[he].extent=W.extent;return Kt({layers:ee})},He.exports.GeoJSONWrapper=mt;const wr=K=>K[0],wt=K=>K[1];class rn{constructor(W,ee=wr,he=wt,a=64,G=Float64Array){this.nodeSize=a,this.points=W;const Le=W.length<65536?Uint16Array:Uint32Array,Ie=this.ids=new Le(W.length),Pe=this.coords=new G(2*W.length);for(let ke=0;ke<W.length;ke++)Ie[ke]=ke,Pe[2*ke]=ee(W[ke]),Pe[2*ke+1]=he(W[ke]);Tr(Ie,Pe,a,0,Ie.length-1,0)}range(W,ee,he,a){return function(G,Le,Ie,Pe,ke,qe,lt){const We=[0,G.length-1,0],ft=[];let Dt,Rt;for(;We.length;){const sn=We.pop(),jt=We.pop(),pn=We.pop();if(jt-pn<=lt){for(let xn=pn;xn<=jt;xn++)Dt=Le[2*xn],Rt=Le[2*xn+1],Dt>=Ie&&Dt<=ke&&Rt>=Pe&&Rt<=qe&&ft.push(G[xn]);continue}const qt=Math.floor((pn+jt)/2);Dt=Le[2*qt],Rt=Le[2*qt+1],Dt>=Ie&&Dt<=ke&&Rt>=Pe&&Rt<=qe&&ft.push(G[qt]);const an=(sn+1)%2;(sn===0?Ie<=Dt:Pe<=Rt)&&(We.push(pn),We.push(qt-1),We.push(an)),(sn===0?ke>=Dt:qe>=Rt)&&(We.push(qt+1),We.push(jt),We.push(an))}return ft}(this.ids,this.coords,W,ee,he,a,this.nodeSize)}within(W,ee,he){return function(a,G,Le,Ie,Pe,ke){const qe=[0,a.length-1,0],lt=[],We=Pe*Pe;for(;qe.length;){const ft=qe.pop(),Dt=qe.pop(),Rt=qe.pop();if(Dt-Rt<=ke){for(let an=Rt;an<=Dt;an++)Un(G[2*an],G[2*an+1],Le,Ie)<=We&&lt.push(a[an]);continue}const sn=Math.floor((Rt+Dt)/2),jt=G[2*sn],pn=G[2*sn+1];Un(jt,pn,Le,Ie)<=We&&lt.push(a[sn]);const qt=(ft+1)%2;(ft===0?Le-Pe<=jt:Ie-Pe<=pn)&&(qe.push(Rt),qe.push(sn-1),qe.push(qt)),(ft===0?Le+Pe>=jt:Ie+Pe>=pn)&&(qe.push(sn+1),qe.push(Dt),qe.push(qt))}return lt}(this.ids,this.coords,W,ee,he,this.nodeSize)}}const Cn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:K=>K},xt=Math.fround||(er=new Float32Array(1),K=>(er[0]=+K,er[0]));var er;class Hn{constructor(W){this.options=Fi(Object.create(Cn),W),this.trees=new Array(this.options.maxZoom+1)}load(W){const{log:ee,minZoom:he,maxZoom:a,nodeSize:G}=this.options;ee&&console.time("total time");const Le=`prepare ${W.length} points`;ee&&console.time(Le),this.points=W;let Ie=[];for(let Pe=0;Pe<W.length;Pe++)W[Pe].geometry&&Ie.push(or(W[Pe],Pe));this.trees[a+1]=new rn(Ie,fo,Fr,G,Float32Array),ee&&console.timeEnd(Le);for(let Pe=a;Pe>=he;Pe--){const ke=+Date.now();Ie=this._cluster(Ie,Pe),this.trees[Pe]=new rn(Ie,fo,Fr,G,Float32Array),ee&&console.log("z%d: %d clusters in %dms",Pe,Ie.length,+Date.now()-ke)}return ee&&console.timeEnd("total time"),this}getClusters(W,ee){let he=((W[0]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,W[1]));let G=W[2]===180?180:((W[2]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)he=-180,G=180;else if(he>G){const qe=this.getClusters([he,a,180,Le],ee),lt=this.getClusters([-180,a,G,Le],ee);return qe.concat(lt)}const Ie=this.trees[this._limitZoom(ee)],Pe=Ie.range(Vn(he),Si(Le),Vn(G),Si(a)),ke=[];for(const qe of Pe){const lt=Ie.points[qe];ke.push(lt.numPoints?tr(lt):this.points[lt.index])}return ke}getChildren(W){const ee=this._getOriginId(W),he=this._getOriginZoom(W),a="No cluster with the specified id.",G=this.trees[he];if(!G)throw new Error(a);const Le=G.points[ee];if(!Le)throw new Error(a);const Ie=this.options.radius/(this.options.extent*Math.pow(2,he-1)),Pe=G.within(Le.x,Le.y,Ie),ke=[];for(const qe of Pe){const lt=G.points[qe];lt.parentId===W&&ke.push(lt.numPoints?tr(lt):this.points[lt.index])}if(ke.length===0)throw new Error(a);return ke}getLeaves(W,ee,he){const a=[];return this._appendLeaves(a,W,ee=ee||10,he=he||0,0),a}getTile(W,ee,he){const a=this.trees[this._limitZoom(W)],G=Math.pow(2,W),{extent:Le,radius:Ie}=this.options,Pe=Ie/Le,ke=(he-Pe)/G,qe=(he+1+Pe)/G,lt={features:[]};return this._addTileFeatures(a.range((ee-Pe)/G,ke,(ee+1+Pe)/G,qe),a.points,ee,he,G,lt),ee===0&&this._addTileFeatures(a.range(1-Pe/G,ke,1,qe),a.points,G,he,G,lt),ee===G-1&&this._addTileFeatures(a.range(0,ke,Pe/G,qe),a.points,-1,he,G,lt),lt.features.length?lt:null}getClusterExpansionZoom(W){let ee=this._getOriginZoom(W)-1;for(;ee<=this.options.maxZoom;){const he=this.getChildren(W);if(ee++,he.length!==1)break;W=he[0].properties.cluster_id}return ee}_appendLeaves(W,ee,he,a,G){const Le=this.getChildren(ee);for(const Ie of Le){const Pe=Ie.properties;if(Pe&&Pe.cluster?G+Pe.point_count<=a?G+=Pe.point_count:G=this._appendLeaves(W,Pe.cluster_id,he,a,G):G<a?G++:W.push(Ie),W.length===he)break}return G}_addTileFeatures(W,ee,he,a,G,Le){for(const Ie of W){const Pe=ee[Ie],ke=Pe.numPoints;let qe,lt,We;if(ke)qe=Kr(Pe),lt=Pe.x,We=Pe.y;else{const Rt=this.points[Pe.index];qe=Rt.properties,lt=Vn(Rt.geometry.coordinates[0]),We=Si(Rt.geometry.coordinates[1])}const ft={type:1,geometry:[[Math.round(this.options.extent*(lt*G-he)),Math.round(this.options.extent*(We*G-a))]],tags:qe};let Dt;ke?Dt=Pe.id:this.options.generateId?Dt=Pe.index:this.points[Pe.index].id&&(Dt=this.points[Pe.index].id),Dt!==void 0&&(ft.id=Dt),Le.features.push(ft)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))}_cluster(W,ee){const he=[],{radius:a,extent:G,reduce:Le,minPoints:Ie}=this.options,Pe=a/(G*Math.pow(2,ee));for(let ke=0;ke<W.length;ke++){const qe=W[ke];if(qe.zoom<=ee)continue;qe.zoom=ee;const lt=this.trees[ee+1],We=lt.within(qe.x,qe.y,Pe),ft=qe.numPoints||1;let Dt=ft;for(const Rt of We){const sn=lt.points[Rt];sn.zoom>ee&&(Dt+=sn.numPoints||1)}if(Dt>ft&&Dt>=Ie){let Rt=qe.x*ft,sn=qe.y*ft,jt=Le&&ft>1?this._map(qe,!0):null;const pn=(ke<<5)+(ee+1)+this.points.length;for(const qt of We){const an=lt.points[qt];if(an.zoom<=ee)continue;an.zoom=ee;const xn=an.numPoints||1;Rt+=an.x*xn,sn+=an.y*xn,an.parentId=pn,Le&&(jt||(jt=this._map(qe,!0)),Le(jt,this._map(an)))}qe.parentId=pn,he.push(mr(Rt/Dt,sn/Dt,pn,Dt,jt))}else if(he.push(qe),Dt>1)for(const Rt of We){const sn=lt.points[Rt];sn.zoom<=ee||(sn.zoom=ee,he.push(sn))}}return he}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,ee){if(W.numPoints)return ee?Fi({},W.properties):W.properties;const he=this.points[W.index].properties,a=this.options.map(he);return ee&&a===he?Fi({},a):a}}function mr(K,W,ee,he,a){return{x:xt(K),y:xt(W),zoom:1/0,id:ee,parentId:-1,numPoints:he,properties:a}}function or(K,W){const[ee,he]=K.geometry.coordinates;return{x:xt(Vn(ee)),y:xt(Si(he)),zoom:1/0,index:W,parentId:-1}}function tr(K){return{type:"Feature",id:K.id,properties:Kr(K),geometry:{type:"Point",coordinates:[(W=K.x,360*(W-.5)),Wn(K.y)]}};var W}function Kr(K){const W=K.numPoints,ee=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W;return Fi(Fi({},K.properties),{cluster:!0,cluster_id:K.id,point_count:W,point_count_abbreviated:ee})}function Vn(K){return K/360+.5}function Si(K){const W=Math.sin(K*Math.PI/180),ee=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return ee<0?0:ee>1?1:ee}function Wn(K){const W=(180-360*K)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function Fi(K,W){for(const ee in W)K[ee]=W[ee];return K}function fo(K){return K.x}function Fr(K){return K.y}function Mi(K,W,ee,he){for(var a,G=he,Le=ee-W>>1,Ie=ee-W,Pe=K[W],ke=K[W+1],qe=K[ee],lt=K[ee+1],We=W+3;We<ee;We+=3){var ft=Oo(K[We],K[We+1],Pe,ke,qe,lt);if(ft>G)a=We,G=ft;else if(ft===G){var Dt=Math.abs(We-Le);Dt<Ie&&(a=We,Ie=Dt)}}G>he&&(a-W>3&&Mi(K,W,a,he),K[a+2]=G,ee-a>3&&Mi(K,a,ee,he))}function Oo(K,W,ee,he,a,G){var Le=a-ee,Ie=G-he;if(Le!==0||Ie!==0){var Pe=((K-ee)*Le+(W-he)*Ie)/(Le*Le+Ie*Ie);Pe>1?(ee=a,he=G):Pe>0&&(ee+=Le*Pe,he+=Ie*Pe)}return(Le=K-ee)*Le+(Ie=W-he)*Ie}function is(K,W,ee,he){var a={id:K===void 0?null:K,type:W,geometry:ee,tags:he,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(G){var Le=G.geometry,Ie=G.type;if(Ie==="Point"||Ie==="MultiPoint"||Ie==="LineString")ct(G,Le);else if(Ie==="Polygon"||Ie==="MultiLineString")for(var Pe=0;Pe<Le.length;Pe++)ct(G,Le[Pe]);else if(Ie==="MultiPolygon")for(Pe=0;Pe<Le.length;Pe++)for(var ke=0;ke<Le[Pe].length;ke++)ct(G,Le[Pe][ke])}(a),a}function ct(K,W){for(var ee=0;ee<W.length;ee+=3)K.minX=Math.min(K.minX,W[ee]),K.minY=Math.min(K.minY,W[ee+1]),K.maxX=Math.max(K.maxX,W[ee]),K.maxY=Math.max(K.maxY,W[ee+1])}function kt(K,W,ee,he){if(W.geometry){var a=W.geometry.coordinates,G=W.geometry.type,Le=Math.pow(ee.tolerance/((1<<ee.maxZoom)*ee.extent),2),Ie=[],Pe=W.id;if(ee.promoteId?Pe=W.properties[ee.promoteId]:ee.generateId&&(Pe=he||0),G==="Point")Bs(a,Ie);else if(G==="MultiPoint")for(var ke=0;ke<a.length;ke++)Bs(a[ke],Ie);else if(G==="LineString")yi(a,Ie,Le,!1);else if(G==="MultiLineString"){if(ee.lineMetrics){for(ke=0;ke<a.length;ke++)yi(a[ke],Ie=[],Le,!1),K.push(is(Pe,"LineString",Ie,W.properties));return}Bn(a,Ie,Le,!1)}else if(G==="Polygon")Bn(a,Ie,Le,!0);else{if(G!=="MultiPolygon"){if(G==="GeometryCollection"){for(ke=0;ke<W.geometry.geometries.length;ke++)kt(K,{id:Pe,geometry:W.geometry.geometries[ke],properties:W.properties},ee,he);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ke=0;ke<a.length;ke++){var qe=[];Bn(a[ke],qe,Le,!0),Ie.push(qe)}}K.push(is(Pe,G,Ie,W.properties))}}function Bs(K,W){W.push(Ni(K[0])),W.push(Ci(K[1])),W.push(0)}function yi(K,W,ee,he){for(var a,G,Le=0,Ie=0;Ie<K.length;Ie++){var Pe=Ni(K[Ie][0]),ke=Ci(K[Ie][1]);W.push(Pe),W.push(ke),W.push(0),Ie>0&&(Le+=he?(a*ke-Pe*G)/2:Math.sqrt(Math.pow(Pe-a,2)+Math.pow(ke-G,2))),a=Pe,G=ke}var qe=W.length-3;W[2]=1,Mi(W,0,qe,ee),W[qe+2]=1,W.size=Math.abs(Le),W.start=0,W.end=W.size}function Bn(K,W,ee,he){for(var a=0;a<K.length;a++){var G=[];yi(K[a],G,ee,he),W.push(G)}}function Ni(K){return K/360+.5}function Ci(K){var W=Math.sin(K*Math.PI/180),ee=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return ee<0?0:ee>1?1:ee}function Pi(K,W,ee,he,a,G,Le,Ie){if(he/=W,G>=(ee/=W)&&Le<he)return K;if(Le<ee||G>=he)return null;for(var Pe=[],ke=0;ke<K.length;ke++){var qe=K[ke],lt=qe.geometry,We=qe.type,ft=a===0?qe.minX:qe.minY,Dt=a===0?qe.maxX:qe.maxY;if(ft>=ee&&Dt<he)Pe.push(qe);else if(!(Dt<ee||ft>=he)){var Rt=[];if(We==="Point"||We==="MultiPoint")ss(lt,Rt,ee,he,a);else if(We==="LineString")Lt(lt,Rt,ee,he,a,!1,Ie.lineMetrics);else if(We==="MultiLineString")bn(lt,Rt,ee,he,a,!1);else if(We==="Polygon")bn(lt,Rt,ee,he,a,!0);else if(We==="MultiPolygon")for(var sn=0;sn<lt.length;sn++){var jt=[];bn(lt[sn],jt,ee,he,a,!0),jt.length&&Rt.push(jt)}if(Rt.length){if(Ie.lineMetrics&&We==="LineString"){for(sn=0;sn<Rt.length;sn++)Pe.push(is(qe.id,We,Rt[sn],qe.tags));continue}We!=="LineString"&&We!=="MultiLineString"||(Rt.length===1?(We="LineString",Rt=Rt[0]):We="MultiLineString"),We!=="Point"&&We!=="MultiPoint"||(We=Rt.length===3?"Point":"MultiPoint"),Pe.push(is(qe.id,We,Rt,qe.tags))}}}return Pe.length?Pe:null}function ss(K,W,ee,he,a){for(var G=0;G<K.length;G+=3){var Le=K[G+a];Le>=ee&&Le<=he&&(W.push(K[G]),W.push(K[G+1]),W.push(K[G+2]))}}function Lt(K,W,ee,he,a,G,Le){for(var Ie,Pe,ke=Sn(K),qe=a===0?xs:yn,lt=K.start,We=0;We<K.length-3;We+=3){var ft=K[We],Dt=K[We+1],Rt=K[We+2],sn=K[We+3],jt=K[We+4],pn=a===0?ft:Dt,qt=a===0?sn:jt,an=!1;Le&&(Ie=Math.sqrt(Math.pow(ft-sn,2)+Math.pow(Dt-jt,2))),pn<ee?qt>ee&&(Pe=qe(ke,ft,Dt,sn,jt,ee),Le&&(ke.start=lt+Ie*Pe)):pn>he?qt<he&&(Pe=qe(ke,ft,Dt,sn,jt,he),Le&&(ke.start=lt+Ie*Pe)):Cr(ke,ft,Dt,Rt),qt<ee&&pn>=ee&&(Pe=qe(ke,ft,Dt,sn,jt,ee),an=!0),qt>he&&pn<=he&&(Pe=qe(ke,ft,Dt,sn,jt,he),an=!0),!G&&an&&(Le&&(ke.end=lt+Ie*Pe),W.push(ke),ke=Sn(K)),Le&&(lt+=Ie)}var xn=K.length-3;ft=K[xn],Dt=K[xn+1],Rt=K[xn+2],(pn=a===0?ft:Dt)>=ee&&pn<=he&&Cr(ke,ft,Dt,Rt),xn=ke.length-3,G&&xn>=3&&(ke[xn]!==ke[0]||ke[xn+1]!==ke[1])&&Cr(ke,ke[0],ke[1],ke[2]),ke.length&&W.push(ke)}function Sn(K){var W=[];return W.size=K.size,W.start=K.start,W.end=K.end,W}function bn(K,W,ee,he,a,G){for(var Le=0;Le<K.length;Le++)Lt(K[Le],W,ee,he,a,G,!1)}function Cr(K,W,ee,he){K.push(W),K.push(ee),K.push(he)}function xs(K,W,ee,he,a,G){var Le=(G-W)/(he-W);return K.push(G),K.push(ee+(a-ee)*Le),K.push(1),Le}function yn(K,W,ee,he,a,G){var Le=(G-ee)/(a-ee);return K.push(W+(he-W)*Le),K.push(G),K.push(1),Le}function Ye(K,W){for(var ee=[],he=0;he<K.length;he++){var a,G=K[he],Le=G.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")a=jr(G.geometry,W);else if(Le==="MultiLineString"||Le==="Polygon"){a=[];for(var Ie=0;Ie<G.geometry.length;Ie++)a.push(jr(G.geometry[Ie],W))}else if(Le==="MultiPolygon")for(a=[],Ie=0;Ie<G.geometry.length;Ie++){for(var Pe=[],ke=0;ke<G.geometry[Ie].length;ke++)Pe.push(jr(G.geometry[Ie][ke],W));a.push(Pe)}ee.push(is(G.id,Le,a,G.tags))}return ee}function jr(K,W){var ee=[];ee.size=K.size,K.start!==void 0&&(ee.start=K.start,ee.end=K.end);for(var he=0;he<K.length;he+=3)ee.push(K[he]+W,K[he+1],K[he+2]);return ee}function zs(K,W){if(K.transformed)return K;var ee,he,a,G=1<<K.z,Le=K.x,Ie=K.y;for(ee=0;ee<K.features.length;ee++){var Pe=K.features[ee],ke=Pe.geometry,qe=Pe.type;if(Pe.geometry=[],qe===1)for(he=0;he<ke.length;he+=2)Pe.geometry.push(Dr(ke[he],ke[he+1],W,G,Le,Ie));else for(he=0;he<ke.length;he++){var lt=[];for(a=0;a<ke[he].length;a+=2)lt.push(Dr(ke[he][a],ke[he][a+1],W,G,Le,Ie));Pe.geometry.push(lt)}}return K.transformed=!0,K}function Dr(K,W,ee,he,a,G){return[Math.round(ee*(K*he-a)),Math.round(ee*(W*he-G))]}function oi(K,W,ee,he,a){for(var G=W===a.maxZoom?0:a.tolerance/((1<<W)*a.extent),Le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ee,y:he,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ie=0;Ie<K.length;Ie++){Le.numFeatures++,Zn(Le,K[Ie],G,a);var Pe=K[Ie].minX,ke=K[Ie].minY,qe=K[Ie].maxX,lt=K[Ie].maxY;Pe<Le.minX&&(Le.minX=Pe),ke<Le.minY&&(Le.minY=ke),qe>Le.maxX&&(Le.maxX=qe),lt>Le.maxY&&(Le.maxY=lt)}return Le}function Zn(K,W,ee,he){var a=W.geometry,G=W.type,Le=[];if(G==="Point"||G==="MultiPoint")for(var Ie=0;Ie<a.length;Ie+=3)Le.push(a[Ie]),Le.push(a[Ie+1]),K.numPoints++,K.numSimplified++;else if(G==="LineString")Os(Le,a,K,ee,!1,!1);else if(G==="MultiLineString"||G==="Polygon")for(Ie=0;Ie<a.length;Ie++)Os(Le,a[Ie],K,ee,G==="Polygon",Ie===0);else if(G==="MultiPolygon")for(var Pe=0;Pe<a.length;Pe++){var ke=a[Pe];for(Ie=0;Ie<ke.length;Ie++)Os(Le,ke[Ie],K,ee,!0,Ie===0)}if(Le.length){var qe=W.tags||null;if(G==="LineString"&&he.lineMetrics){for(var lt in qe={},W.tags)qe[lt]=W.tags[lt];qe.mapbox_clip_start=a.start/a.size,qe.mapbox_clip_end=a.end/a.size}var We={geometry:Le,type:G==="Polygon"||G==="MultiPolygon"?3:G==="LineString"||G==="MultiLineString"?2:1,tags:qe};W.id!==null&&(We.id=W.id),K.features.push(We)}}function Os(K,W,ee,he,a,G){var Le=he*he;if(he>0&&W.size<(a?Le:he))ee.numPoints+=W.length/3;else{for(var Ie=[],Pe=0;Pe<W.length;Pe+=3)(he===0||W[Pe+2]>Le)&&(ee.numSimplified++,Ie.push(W[Pe]),Ie.push(W[Pe+1])),ee.numPoints++;a&&function(ke,qe){for(var lt=0,We=0,ft=ke.length,Dt=ft-2;We<ft;Dt=We,We+=2)lt+=(ke[We]-ke[Dt])*(ke[We+1]+ke[Dt+1]);if(lt>0===qe)for(We=0,ft=ke.length;We<ft/2;We+=2){var Rt=ke[We],sn=ke[We+1];ke[We]=ke[ft-2-We],ke[We+1]=ke[ft-1-We],ke[ft-2-We]=Rt,ke[ft-1-We]=sn}}(Ie,G),K.push(Ie)}}function Ui(K,W){var ee=(W=this.options=function(a,G){for(var Le in G)a[Le]=G[Le];return a}(Object.create(this.options),W)).debug;if(ee&&console.time("preprocess data"),W.maxZoom<0||W.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(W.promoteId&&W.generateId)throw new Error("promoteId and generateId cannot be used together.");var he=function(a,G){var Le=[];if(a.type==="FeatureCollection")for(var Ie=0;Ie<a.features.length;Ie++)kt(Le,a.features[Ie],G,Ie);else kt(Le,a.type==="Feature"?a:{geometry:a},G);return Le}(K,W);this.tiles={},this.tileCoords=[],ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",W.indexMaxZoom,W.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(a,G){var Le=G.buffer/G.extent,Ie=a,Pe=Pi(a,1,-1-Le,Le,0,-1,2,G),ke=Pi(a,1,1-Le,2+Le,0,-1,2,G);return(Pe||ke)&&(Ie=Pi(a,1,-Le,1+Le,0,-1,2,G)||[],Pe&&(Ie=Ye(Pe,1).concat(Ie)),ke&&(Ie=Ie.concat(Ye(ke,-1)))),Ie}(he,W),he.length&&this.splitTile(he,0,0,0),ee&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Vi(K,W,ee){return 32*((1<<K)*ee+W)+K}function Ii(K,W){const ee=K.tileID.canonical;if(!this._geoJSONIndex)return W(null,null);const he=this._geoJSONIndex.getTile(ee.z,ee.x,ee.y);if(!he)return W(null,null);const a=new Se(he.features);let G=He.exports(a);G.byteOffset===0&&G.byteLength===G.buffer.byteLength||(G=new Uint8Array(G)),W(null,{vectorTile:a,rawData:G.buffer})}Ui.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ui.prototype.splitTile=function(K,W,ee,he,a,G,Le){for(var Ie=[K,W,ee,he],Pe=this.options,ke=Pe.debug;Ie.length;){he=Ie.pop(),ee=Ie.pop(),W=Ie.pop(),K=Ie.pop();var qe=1<<W,lt=Vi(W,ee,he),We=this.tiles[lt];if(!We&&(ke>1&&console.time("creation"),We=this.tiles[lt]=oi(K,W,ee,he,Pe),this.tileCoords.push({z:W,x:ee,y:he}),ke)){ke>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",W,ee,he,We.numFeatures,We.numPoints,We.numSimplified),console.timeEnd("creation"));var ft="z"+W;this.stats[ft]=(this.stats[ft]||0)+1,this.total++}if(We.source=K,a){if(W===Pe.maxZoom||W===a)continue;var Dt=1<<a-W;if(ee!==Math.floor(G/Dt)||he!==Math.floor(Le/Dt))continue}else if(W===Pe.indexMaxZoom||We.numPoints<=Pe.indexMaxPoints)continue;if(We.source=null,K.length!==0){ke>1&&console.time("clipping");var Rt,sn,jt,pn,qt,an,xn=.5*Pe.buffer/Pe.extent,Ft=.5-xn,Oe=.5+xn,Ct=1+xn;Rt=sn=jt=pn=null,qt=Pi(K,qe,ee-xn,ee+Oe,0,We.minX,We.maxX,Pe),an=Pi(K,qe,ee+Ft,ee+Ct,0,We.minX,We.maxX,Pe),K=null,qt&&(Rt=Pi(qt,qe,he-xn,he+Oe,1,We.minY,We.maxY,Pe),sn=Pi(qt,qe,he+Ft,he+Ct,1,We.minY,We.maxY,Pe),qt=null),an&&(jt=Pi(an,qe,he-xn,he+Oe,1,We.minY,We.maxY,Pe),pn=Pi(an,qe,he+Ft,he+Ct,1,We.minY,We.maxY,Pe),an=null),ke>1&&console.timeEnd("clipping"),Ie.push(Rt||[],W+1,2*ee,2*he),Ie.push(sn||[],W+1,2*ee,2*he+1),Ie.push(jt||[],W+1,2*ee+1,2*he),Ie.push(pn||[],W+1,2*ee+1,2*he+1)}}},Ui.prototype.getTile=function(K,W,ee){var he=this.options,a=he.extent,G=he.debug;if(K<0||K>24)return null;var Le=1<<K,Ie=Vi(K,W=(W%Le+Le)%Le,ee);if(this.tiles[Ie])return zs(this.tiles[Ie],a);G>1&&console.log("drilling down to z%d-%d-%d",K,W,ee);for(var Pe,ke=K,qe=W,lt=ee;!Pe&&ke>0;)ke--,qe=Math.floor(qe/2),lt=Math.floor(lt/2),Pe=this.tiles[Vi(ke,qe,lt)];return Pe&&Pe.source?(G>1&&console.log("found parent tile z%d-%d-%d",ke,qe,lt),G>1&&console.time("drilling down"),this.splitTile(Pe.source,ke,qe,lt,K,W,ee),G>1&&console.timeEnd("drilling down"),this.tiles[Ie]?zs(this.tiles[Ie],a):null):null};class os extends q{constructor(W,ee,he,a){super(W,ee,he,Ii),a&&(this.loadGeoJSON=a)}loadData(W,ee){var he;(he=this._pendingRequest)===null||he===void 0||he.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const a=!!(W&&W.request&&W.request.collectResourceTiming)&&new o.RequestPerformance(W.request);this._pendingCallback=ee,this._pendingRequest=this.loadGeoJSON(W,(G,Le)=>{if(delete this._pendingCallback,delete this._pendingRequest,G||!Le)return ee(G);if(typeof Le!="object")return ee(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`));{X(Le,!0);try{if(W.filter){const Pe=o.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Pe.result==="error")throw new Error(Pe.value.map(qe=>`${qe.key}: ${qe.message}`).join(", "));Le={type:"FeatureCollection",features:Le.features.filter(qe=>Pe.value.evaluate({zoom:0},qe))}}this._geoJSONIndex=W.cluster?new Hn(function({superclusterOptions:Pe,clusterProperties:ke}){if(!ke||!Pe)return Pe;const qe={},lt={},We={accumulated:null,zoom:0},ft={properties:null},Dt=Object.keys(ke);for(const Rt of Dt){const[sn,jt]=ke[Rt],pn=o.createExpression(jt),qt=o.createExpression(typeof sn=="string"?[sn,["accumulated"],["get",Rt]]:sn);qe[Rt]=pn.value,lt[Rt]=qt.value}return Pe.map=Rt=>{ft.properties=Rt;const sn={};for(const jt of Dt)sn[jt]=qe[jt].evaluate(We,ft);return sn},Pe.reduce=(Rt,sn)=>{ft.properties=sn;for(const jt of Dt)We.accumulated=Rt[jt],Rt[jt]=lt[jt].evaluate(We,ft)},Pe}(W)).load(Le.features):function(Pe,ke){return new Ui(Pe,ke)}(Le,W.geojsonVtOptions)}catch(Pe){return ee(Pe)}this.loaded={};const Ie={};if(a){const Pe=a.finish();Pe&&(Ie.resourceTiming={},Ie.resourceTiming[W.source]=JSON.parse(JSON.stringify(Pe)))}ee(null,Ie)}})}reloadTile(W,ee){const he=this.loaded;return he&&he[W.uid]?super.reloadTile(W,ee):this.loadTile(W,ee)}loadGeoJSON(W,ee){if(W.request)return o.getJSON(W.request,ee);if(typeof W.data=="string")try{ee(null,JSON.parse(W.data))}catch{ee(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`))}else ee(new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(W,ee){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ee()}getClusterExpansionZoom(W,ee){try{ee(null,this._geoJSONIndex.getClusterExpansionZoom(W.clusterId))}catch(he){ee(he)}}getClusterChildren(W,ee){try{ee(null,this._geoJSONIndex.getChildren(W.clusterId))}catch(he){ee(he)}}getClusterLeaves(W,ee){try{ee(null,this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset))}catch(he){ee(he)}}}class Rr{constructor(W){this.self=W,this.actor=new o.Actor(W,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:q,geojson:os},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ee,he)=>{if(this.workerSourceTypes[ee])throw new Error(`Worker source with name "${ee}" already registered.`);this.workerSourceTypes[ee]=he},this.self.registerRTLTextPlugin=ee=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=ee.applyArabicShaping,o.plugin.processBidirectionalText=ee.processBidirectionalText,o.plugin.processStyledBidirectionalText=ee.processStyledBidirectionalText}}setReferrer(W,ee){this.referrer=ee}setImages(W,ee,he){this.availableImages[W]=ee;for(const a in this.workerSources[W]){const G=this.workerSources[W][a];for(const Le in G)G[Le].availableImages=ee}he()}setLayers(W,ee,he){this.getLayerIndex(W).replace(ee),he()}updateLayers(W,ee,he){this.getLayerIndex(W).update(ee.layers,ee.removedIds),he()}loadTile(W,ee,he){this.getWorkerSource(W,ee.type,ee.source).loadTile(ee,he)}loadDEMTile(W,ee,he){this.getDEMWorkerSource(W,ee.source).loadTile(ee,he)}reloadTile(W,ee,he){this.getWorkerSource(W,ee.type,ee.source).reloadTile(ee,he)}abortTile(W,ee,he){this.getWorkerSource(W,ee.type,ee.source).abortTile(ee,he)}removeTile(W,ee,he){this.getWorkerSource(W,ee.type,ee.source).removeTile(ee,he)}removeDEMTile(W,ee){this.getDEMWorkerSource(W,ee.source).removeTile(ee)}removeSource(W,ee,he){if(!this.workerSources[W]||!this.workerSources[W][ee.type]||!this.workerSources[W][ee.type][ee.source])return;const a=this.workerSources[W][ee.type][ee.source];delete this.workerSources[W][ee.type][ee.source],a.removeSource!==void 0?a.removeSource(ee,he):he()}loadWorkerSource(W,ee,he){try{this.self.importScripts(ee.url),he()}catch(a){he(a.toString())}}syncRTLPluginState(W,ee,he){try{o.plugin.setState(ee);const a=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&a!=null){this.self.importScripts(a);const G=o.plugin.isParsed();he(G?void 0:new Error(`RTL Text Plugin failed to import scripts from ${a}`),G)}}catch(a){he(a.toString())}}getAvailableImages(W){let ee=this.availableImages[W];return ee||(ee=[]),ee}getLayerIndex(W){let ee=this.layerIndexes[W];return ee||(ee=this.layerIndexes[W]=new C),ee}getWorkerSource(W,ee,he){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][ee]||(this.workerSources[W][ee]={}),!this.workerSources[W][ee][he]){const a={send:(G,Le,Ie)=>{this.actor.send(G,Le,Ie,W)}};this.workerSources[W][ee][he]=new this.workerSourceTypes[ee](a,this.getLayerIndex(W),this.getAvailableImages(W))}return this.workerSources[W][ee][he]}getDEMWorkerSource(W,ee){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][ee]||(this.demWorkerSources[W][ee]=new se),this.demWorkerSources[W][ee]}enforceCacheSizeLimit(W,ee){o.enforceCacheSizeLimit(ee)}}return o.isWorker()&&(self.worker=new Rr(self)),Rr}),s(["./shared"],function(o){var g=w;function w(L){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var l,h,d=new Blob([""],{type:"text/javascript"}),x=URL.createObjectURL(d);try{h=new Worker(x),l=!0}catch{l=!1}return h&&h.terminate(),URL.revokeObjectURL(x),l}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var l=document.createElement("canvas");l.width=l.height=1;var h=l.getContext("2d");if(!h)return!1;var d=h.getImageData(0,0,1,1);return d&&d.width===l.width}()?(C[_=c&&c.failIfMajorPerformanceCaveat]===void 0&&(C[_]=function(l){var h,d=function(x){var b=document.createElement("canvas"),S=Object.create(w.webGLContextAttributes);return S.failIfMajorPerformanceCaveat=x,b.getContext("webgl",S)||b.getContext("experimental-webgl",S)}(l);if(!d)return!1;try{h=d.createShader(d.VERTEX_SHADER)}catch{return!1}return!(!h||d.isContextLost())&&(d.shaderSource(h,"void main() {}"),d.compileShader(h),d.getShaderParameter(h,d.COMPILE_STATUS)===!0)}(_)),C[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var _}(L)}var C={};function I(L,c){if(Array.isArray(L)){if(!Array.isArray(c)||L.length!==c.length)return!1;for(let _=0;_<L.length;_++)if(!I(L[_],c[_]))return!1;return!0}if(typeof L=="object"&&L!==null&&c!==null){if(typeof c!="object"||Object.keys(L).length!==Object.keys(c).length)return!1;for(const _ in L)if(!I(L[_],c[_]))return!1;return!0}return L===c}w.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class k{static testProp(c){if(!k.docStyle)return c[0];for(let _=0;_<c.length;_++)if(c[_]in k.docStyle)return c[_];return c[0]}static create(c,_,l){const h=window.document.createElement(c);return _!==void 0&&(h.className=_),l&&l.appendChild(h),h}static createNS(c,_){return window.document.createElementNS(c,_)}static disableDrag(){k.docStyle&&k.selectProp&&(k.userSelect=k.docStyle[k.selectProp],k.docStyle[k.selectProp]="none")}static enableDrag(){k.docStyle&&k.selectProp&&(k.docStyle[k.selectProp]=k.userSelect)}static setTransform(c,_){c.style[k.transformProp]=_}static addEventListener(c,_,l,h={}){c.addEventListener(_,l,"passive"in h?h:h.capture)}static removeEventListener(c,_,l,h={}){c.removeEventListener(_,l,"passive"in h?h:h.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",k.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",k.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",k.suppressClickInternal,!0)},0)}static mousePos(c,_){const l=c.getBoundingClientRect();return new o.pointGeometry(_.clientX-l.left-c.clientLeft,_.clientY-l.top-c.clientTop)}static touchPos(c,_){const l=c.getBoundingClientRect(),h=[];for(let d=0;d<_.length;d++)h.push(new o.pointGeometry(_[d].clientX-l.left-c.clientLeft,_[d].clientY-l.top-c.clientTop));return h}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}}k.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,k.selectProp=k.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),k.transformProp=k.testProp(["transform","WebkitTransform"]);class U{constructor(c){this._transformRequestFn=c}transformRequest(c,_){return this._transformRequestFn&&this._transformRequestFn(c,_)||{url:c}}normalizeSpriteURL(c,_,l){const h=function(d){const x=d.match(H);if(!x)throw new Error(`Unable to parse URL "${d}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(c);return h.path+=`${_}${l}`,function(d){const x=d.params.length?`?${d.params.join("&")}`:"";return`${d.protocol}://${d.authority}${d.path}${x}`}(h)}setTransformRequest(c){this._transformRequestFn=c}}const H=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class q{constructor(c,_,l,h){this.context=c,this.format=l,this.texture=c.gl.createTexture(),this.update(_,h)}update(c,_,l){const{width:h,height:d}=c,x=!(this.size&&this.size[0]===h&&this.size[1]===d||l),{context:b}=this,{gl:S}=b;if(this.useMipmap=!!(_&&_.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!_||_.premultiply!==!1)),x)this.size=[h,d],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,c):S.texImage2D(S.TEXTURE_2D,0,this.format,h,d,0,this.format,S.UNSIGNED_BYTE,c.data);else{const{x:M,y:B}=l||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?S.texSubImage2D(S.TEXTURE_2D,0,M,B,S.RGBA,S.UNSIGNED_BYTE,c):S.texSubImage2D(S.TEXTURE_2D,0,M,B,h,d,S.RGBA,S.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(c,_,l){const{context:h}=this,{gl:d}=h;d.bindTexture(d.TEXTURE_2D,this.texture),l!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=d.LINEAR),c!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,l||c),this.filter=c),_!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,_),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,_),this.wrap=_)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}function se(L){const{userImage:c}=L;return!!(c&&c.render&&c.render())&&(L.data.replace(new Uint8Array(c.data.buffer)),!0)}class X extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:_,callback:l}of this.requestors)this._notify(_,l);this.requestors=[]}}getImage(c){return this.images[c]}addImage(c,_){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,_)&&(this.images[c]=_)}_validate(c,_){let l=!0;return this._validateStretch(_.stretchX,_.data&&_.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),l=!1),this._validateStretch(_.stretchY,_.data&&_.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),l=!1),this._validateContent(_.content,_)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),l=!1),l}_validateStretch(c,_){if(!c)return!0;let l=0;for(const h of c){if(h[0]<l||h[1]<h[0]||_<h[1])return!1;l=h[1]}return!0}_validateContent(c,_){return!(c&&(c.length!==4||c[0]<0||_.data.width<c[0]||c[1]<0||_.data.height<c[1]||c[2]<0||_.data.width<c[2]||c[3]<0||_.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,_){const l=this.images[c];if(l.data.width!==_.data.width||l.data.height!==_.data.height)throw new Error(`size mismatch between old image (${l.data.width}x${l.data.height}) and new image (${_.data.width}x${_.data.height}).`);_.version=l.version+1,this.images[c]=_,this.updatedImages[c]=!0}removeImage(c){const _=this.images[c];delete this.images[c],delete this.patterns[c],_.userImage&&_.userImage.onRemove&&_.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,_){let l=!0;if(!this.isLoaded())for(const h of c)this.images[h]||(l=!1);this.isLoaded()||l?this._notify(c,_):this.requestors.push({ids:c,callback:_})}_notify(c,_){const l={};for(const h of c){this.images[h]||this.fire(new o.Event("styleimagemissing",{id:h}));const d=this.images[h];d?l[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:o.warnOnce(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}_(null,l)}getPixelSize(){const{width:c,height:_}=this.atlasImage;return{width:c,height:_}}getPattern(c){const _=this.patterns[c],l=this.getImage(c);if(!l)return null;if(_&&_.position.version===l.version)return _.position;if(_)_.position.version=l.version;else{const h={w:l.data.width+2,h:l.data.height+2,x:0,y:0},d=new o.ImagePosition(h,l);this.patterns[c]={bin:h,position:d}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const _=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new q(c,this.atlasImage,_.RGBA),this.atlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const d in this.patterns)c.push(this.patterns[d].bin);const{w:_,h:l}=o.potpack(c),h=this.atlasImage;h.resize({width:_||1,height:l||1});for(const d in this.patterns){const{bin:x}=this.patterns[d],b=x.x+1,S=x.y+1,M=this.images[d].data,B=M.width,V=M.height;o.RGBAImage.copy(M,h,{x:0,y:0},{x:b,y:S},{width:B,height:V}),o.RGBAImage.copy(M,h,{x:0,y:V-1},{x:b,y:S-1},{width:B,height:1}),o.RGBAImage.copy(M,h,{x:0,y:0},{x:b,y:S+V},{width:B,height:1}),o.RGBAImage.copy(M,h,{x:B-1,y:0},{x:b-1,y:S},{width:1,height:V}),o.RGBAImage.copy(M,h,{x:0,y:0},{x:b+B,y:S},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const _ of c){if(this.callbackDispatchedThisFrame[_])continue;this.callbackDispatchedThisFrame[_]=!0;const l=this.images[_];l||o.warnOnce(`Image with ID: "${_}" was not found`),se(l)&&this.updateImage(_,l)}}}const te=1e20;function ie(L,c,_,l,h,d,x,b,S){for(let M=c;M<c+l;M++)fe(L,_*d+M,d,h,x,b,S);for(let M=_;M<_+h;M++)fe(L,M*d+c,1,l,x,b,S)}function fe(L,c,_,l,h,d,x){d[0]=0,x[0]=-te,x[1]=te,h[0]=L[c];for(let b=1,S=0,M=0;b<l;b++){h[b]=L[c+b*_];const B=b*b;do{const V=d[S];M=(h[b]-h[V]+B-V*V)/(b-V)/2}while(M<=x[S]&&--S>-1);S++,d[S]=b,x[S]=M,x[S+1]=te}for(let b=0,S=0;b<l;b++){for(;x[S+1]<b;)S++;const M=d[S],B=b-M;L[c+b*_]=h[M]+B*B}}class me{constructor(c,_){this.requestManager=c,this.localIdeographFontFamily=_,this.entries={}}setURL(c){this.url=c}getGlyphs(c,_){const l=[];for(const h in c)for(const d of c[h])l.push({stack:h,id:d});o.asyncAll(l,({stack:h,id:d},x)=>{let b=this.entries[h];b||(b=this.entries[h]={glyphs:{},requests:{},ranges:{}});let S=b.glyphs[d];if(S!==void 0)return void x(null,{stack:h,id:d,glyph:S});if(S=this._tinySDF(b,h,d),S)return b.glyphs[d]=S,void x(null,{stack:h,id:d,glyph:S});const M=Math.floor(d/256);if(256*M>65535)return void x(new Error("glyphs > 65535 not supported"));if(b.ranges[M])return void x(null,{stack:h,id:d,glyph:S});let B=b.requests[M];B||(B=b.requests[M]=[],me.loadGlyphRange(h,M,this.url,this.requestManager,(V,j)=>{if(j){for(const Y in j)this._doesCharSupportLocalGlyph(+Y)||(b.glyphs[+Y]=j[+Y]);b.ranges[M]=!0}for(const Y of B)Y(V,j);delete b.requests[M]})),B.push((V,j)=>{V?x(V):j&&x(null,{stack:h,id:d,glyph:j[d]||null})})},(h,d)=>{if(h)_(h);else if(d){const x={};for(const{stack:b,id:S,glyph:M}of d)(x[b]||(x[b]={}))[S]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};_(null,x)}})}_doesCharSupportLocalGlyph(c){return!!this.localIdeographFontFamily&&(o.unicodeBlockLookup["CJK Unified Ideographs"](c)||o.unicodeBlockLookup["Hangul Syllables"](c)||o.unicodeBlockLookup.Hiragana(c)||o.unicodeBlockLookup.Katakana(c))}_tinySDF(c,_,l){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let d=c.tinySDF;if(!d){let b="400";/bold/i.test(_)?b="900":/medium/i.test(_)?b="500":/light/i.test(_)&&(b="200"),d=c.tinySDF=new me.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:h,fontWeight:b})}const x=d.draw(String.fromCharCode(l));return{id:l,bitmap:new o.AlphaImage({width:x.width||30,height:x.height||30},x.data),metrics:{width:x.glyphWidth||24,height:x.glyphHeight||24,left:x.glyphLeft||0,top:x.glyphTop-27||-8,advance:x.glyphAdvance||24}}}}me.loadGlyphRange=function(L,c,_,l,h){const d=256*c,x=d+255,b=l.transformRequest(_.replace("{fontstack}",L).replace("{range}",`${d}-${x}`),o.ResourceType.Glyphs);o.getArrayBuffer(b,(S,M)=>{if(S)h(S);else if(M){const B={};for(const V of o.parseGlyphPbf(M))B[V.id]=V;h(null,B)}})},me.TinySDF=class{constructor({fontSize:L=24,buffer:c=3,radius:_=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:d="normal",fontStyle:x="normal"}={}){this.buffer=c,this.cutoff=l,this.radius=_;const b=this.size=L+4*c,S=this._createCanvas(b),M=this.ctx=S.getContext("2d",{willReadFrequently:!0});M.font=`${x} ${d} ${L}px ${h}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(L){const c=document.createElement("canvas");return c.width=c.height=L,c}draw(L){const{width:c,actualBoundingBoxAscent:_,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:d}=this.ctx.measureText(L),x=Math.ceil(_),b=Math.min(this.size-this.buffer,Math.ceil(d-h)),S=Math.min(this.size-this.buffer,x+Math.ceil(l)),M=b+2*this.buffer,B=S+2*this.buffer,V=Math.max(M*B,0),j=new Uint8ClampedArray(V),Y={data:j,width:M,height:B,glyphWidth:b,glyphHeight:S,glyphTop:x,glyphLeft:0,glyphAdvance:c};if(b===0||S===0)return Y;const{ctx:ae,buffer:ne,gridInner:ue,gridOuter:be}=this;ae.clearRect(ne,ne,b,S),ae.fillText(L,ne,ne+x);const Ce=ae.getImageData(ne,ne,b,S);be.fill(te,0,V),ue.fill(0,0,V);for(let ve=0;ve<S;ve++)for(let Ge=0;Ge<b;Ge++){const Te=Ce.data[4*(ve*b+Ge)+3]/255;if(Te===0)continue;const Ve=(ve+ne)*M+Ge+ne;if(Te===1)be[Ve]=0,ue[Ve]=te;else{const xe=.5-Te;be[Ve]=xe>0?xe*xe:0,ue[Ve]=xe<0?xe*xe:0}}ie(be,0,0,M,B,M,this.f,this.v,this.z),ie(ue,ne,ne,b,S,M,this.f,this.v,this.z);for(let ve=0;ve<V;ve++){const Ge=Math.sqrt(be[ve])-Math.sqrt(ue[ve]);j[ve]=Math.round(255-255*(Ge/this.radius+this.cutoff))}return Y}};const Se=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(L,c){return o.sphericalToCartesian(L.expression.evaluate(c))}interpolate(L,c,_){return{x:o.number(L.x,c.x,_),y:o.number(L.y,c.y,_),z:o.number(L.z,c.z,_)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),He="-transition";class Qe extends o.Evented{constructor(c){super(),this._transitionable=new o.Transitionable(Se),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,_={}){if(!this._validate(o.validateLight,c,_))for(const l in c){const h=c[l];l.endsWith(He)?this._transitionable.setTransition(l.slice(0,-He.length),h):this._transitionable.setValue(l,h)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,_,l){return(!l||l.validate!==!1)&&o.emitValidationErrors(this,c.call(o.validateStyle,o.extend({value:_,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Ke{constructor(c,_){this.width=c,this.height=_,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,_){const l=c.join(",")+String(_);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(c,_)),this.dashEntry[l]}getDashRanges(c,_,l){const h=[];let d=c.length%2==1?-c[c.length-1]*l:0,x=c[0]*l,b=!0;h.push({left:d,right:x,isDash:b,zeroLength:c[0]===0});let S=c[0];for(let M=1;M<c.length;M++){b=!b;const B=c[M];d=S*l,S+=B,x=S*l,h.push({left:d,right:x,isDash:b,zeroLength:B===0})}return h}addRoundDash(c,_,l){const h=_/2;for(let d=-l;d<=l;d++){const x=this.width*(this.nextRow+l+d);let b=0,S=c[b];for(let M=0;M<this.width;M++){M/S.right>1&&(S=c[++b]);const B=Math.abs(M-S.left),V=Math.abs(M-S.right),j=Math.min(B,V);let Y;const ae=d/l*(h+1);if(S.isDash){const ne=h-Math.abs(ae);Y=Math.sqrt(j*j+ne*ne)}else Y=h-Math.sqrt(j*j+ae*ae);this.data[x+M]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(c){for(let b=c.length-1;b>=0;--b){const S=c[b],M=c[b+1];S.zeroLength?c.splice(b,1):M&&M.isDash===S.isDash&&(M.left=S.left,c.splice(b,1))}const _=c[0],l=c[c.length-1];_.isDash===l.isDash&&(_.left=l.left-this.width,l.right=_.right+this.width);const h=this.width*this.nextRow;let d=0,x=c[d];for(let b=0;b<this.width;b++){b/x.right>1&&(x=c[++d]);const S=Math.abs(b-x.left),M=Math.abs(b-x.right),B=Math.min(S,M);this.data[h+b]=Math.max(0,Math.min(255,(x.isDash?B:-B)+128))}}addDash(c,_){const l=_?7:0,h=2*l+1;if(this.nextRow+h>this.height)return o.warnOnce("LineAtlas out of space"),null;let d=0;for(let b=0;b<c.length;b++)d+=c[b];if(d!==0){const b=this.width/d,S=this.getDashRanges(c,this.width,b);_?this.addRoundDash(S,b,l):this.addRegularDash(S)}const x={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:d};return this.nextRow+=h,this.dirty=!0,x}bind(c){const _=c.gl;this.texture?(_.bindTexture(_.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,_.texSubImage2D(_.TEXTURE_2D,0,0,0,this.width,this.height,_.ALPHA,_.UNSIGNED_BYTE,this.data))):(this.texture=_.createTexture(),_.bindTexture(_.TEXTURE_2D,this.texture),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.REPEAT),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR),_.texImage2D(_.TEXTURE_2D,0,_.ALPHA,this.width,this.height,0,_.ALPHA,_.UNSIGNED_BYTE,this.data))}}class nt{constructor(c,_){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const l=this.workerPool.acquire(this.id);for(let h=0;h<l.length;h++){const d=new nt.Actor(l[h],_,this.id);d.name=`Worker ${h}`,this.actors.push(d)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,_,l){o.asyncAll(this.actors,(h,d)=>{h.send(c,_,d)},l=l||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ne(L,c,_){const l=function(h,d){if(h)return _(h);if(d){const x=o.pick(o.extend(d,L),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);d.vector_layers&&(x.vectorLayers=d.vector_layers,x.vectorLayerIds=x.vectorLayers.map(b=>b.id)),_(null,x)}};return L.url?o.getJSON(c.transformRequest(L.url,o.ResourceType.Source),l):o.exported.frame(()=>l(null,L))}nt.Actor=o.Actor;class rt{constructor(c,_,l){this.bounds=o.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=_||0,this.maxzoom=l||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const _=Math.pow(2,c.z),l=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*_),h=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*_),d=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*_),x=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*_);return c.x>=l&&c.x<d&&c.y>=h&&c.y<x}}class Ze extends o.Evented{constructor(c,_,l,h){if(super(),this.id=c,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(_,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},_),this._collectResourceTiming=_.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ne(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),c?this.fire(new o.ErrorEvent(c)):_&&(o.extend(this,_),_.bounds&&(this.tileBounds=new rt(_.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(c,_){const l=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(l,o.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function d(x,b){return delete c.request,c.aborted?_(null):x&&x.status!==404?_(x):(b&&b.resourceTiming&&(c.resourceTiming=b.resourceTiming),this.map._refreshExpiredTiles&&b&&c.setExpiryData(b),c.loadVectorData(b,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),_(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}h.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired"?c.state==="loading"?c.reloadCallback=_:c.request=c.actor.send("reloadTile",h,d.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",h,d.bind(this)))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class mt extends o.Evented{constructor(c,_,l,h){super(),this.id=c,this.dispatcher=l,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},_),o.extend(this,o.pick(_,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ne(this._options,this.map._requestManager,(c,_)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new o.ErrorEvent(c)):_&&(o.extend(this,_),_.bounds&&(this.tileBounds=new rt(_.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,_){const l=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.request=o.getImage(this.map._requestManager.transformRequest(l,o.ResourceType.Tile),(h,d,x)=>{if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(h)c.state="errored",_(h);else if(d){this.map._refreshExpiredTiles&&c.setExpiryData(x);const b=this.map.painter.context,S=b.gl;c.texture=this.map.painter.getTileTexture(d.width),c.texture?c.texture.update(d,{useMipmap:!0}):(c.texture=new q(b,d,S.RGBA,{useMipmap:!0}),c.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),b.extTextureFilterAnisotropic&&S.texParameterf(S.TEXTURE_2D,b.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,b.extTextureFilterAnisotropicMax)),c.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),_(null)}})}abortTile(c,_){c.request&&(c.request.cancel(),delete c.request),_()}unloadTile(c,_){c.texture&&this.map.painter.saveTileTexture(c.texture),_()}hasTransition(){return!1}}let Kt;class Tt extends mt{constructor(c,_,l,h){super(c,_,l,h),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},_),this.encoding=_.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(c,_){const l=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function h(d,x){d&&(c.state="errored",_(d)),x&&(c.dem=x,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded",_(null))}c.request=o.getImage(this.map._requestManager.transformRequest(l,o.ResourceType.Tile),function(d,x){if(delete c.request,c.aborted)c.state="unloaded",_(null);else if(d)c.state="errored",_(d);else if(x){this.map._refreshExpiredTiles&&c.setExpiryData(x),delete x.cacheControl,delete x.expires;const b=o.isImageBitmap(x)&&(Kt==null&&(Kt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Kt)?x:o.exported.getImageData(x,1),S={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:b,encoding:this.encoding};c.actor&&c.state!=="expired"||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",S,h.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)}_getNeighboringTiles(c){const _=c.canonical,l=Math.pow(2,_.z),h=(_.x-1+l)%l,d=_.x===0?c.wrap-1:c.wrap,x=(_.x+1+l)%l,b=_.x+1===l?c.wrap+1:c.wrap,S={};return S[new o.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y).key]={backfilled:!1},_.y>0&&(S[new o.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y-1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y-1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y-1).key]={backfilled:!1}),_.y+1<l&&(S[new o.OverscaledTileID(c.overscaledZ,d,_.z,h,_.y+1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,c.wrap,_.z,_.x,_.y+1).key]={backfilled:!1},S[new o.OverscaledTileID(c.overscaledZ,b,_.z,x,_.y+1).key]={backfilled:!1}),S}unloadTile(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})}}class dn extends o.Evented{constructor(c,_,l,h){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(h),this._data=_.data,this._options=o.extend({},_),this._collectResourceTiming=_.collectResourceTiming,_.maxzoom!==void 0&&(this.maxzoom=_.maxzoom),_.type&&(this.type=_.type),_.attribution&&(this.attribution=_.attribution),this.promoteId=_.promoteId;const d=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:_.cluster||!1,geojsonVtOptions:{buffer:(_.buffer!==void 0?_.buffer:128)*d,tolerance:(_.tolerance!==void 0?_.tolerance:.375)*d,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:_.lineMetrics||!1,generateId:_.generateId||!1},superclusterOptions:{maxZoom:_.clusterMaxZoom!==void 0?_.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,_.clusterMinPoints||2),extent:o.EXTENT,radius:(_.clusterRadius||50)*d,log:!1,generateId:_.generateId||!1},clusterProperties:_.clusterProperties,filter:_.filter},_.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(c){this.map=c,this.load()}setData(c){return this._data=c,this._updateWorkerData("content"),this}getClusterExpansionZoom(c,_){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},_),this}getClusterChildren(c,_){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},_),this}getClusterLeaves(c,_,l,h){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:_,offset:l},h),this}_updateWorkerData(c){const _=o.extend({},this.workerOptions),l=this._data;typeof l=="string"?(_.request=this.map._requestManager.transformRequest(o.exported.resolveURL(l),o.ResourceType.Source),_.request.collectResourceTiming=this._collectResourceTiming):_.data=JSON.stringify(l),this._pendingLoads++,this.fire(new o.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,_,(h,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new o.Event("dataabort",{dataType:"source",sourceDataType:c}));let x=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(x=d.resourceTiming[this.id].slice(0)),h)return void this.fire(new o.ErrorEvent(h));const b={dataType:"source",sourceDataType:c};this._collectResourceTiming&&x&&x.length>0&&o.extend(b,{resourceTiming:x}),this.fire(new o.Event("data",b))})}loaded(){return this._pendingLoads===0}loadTile(c,_){const l=c.actor?"reloadTile":"loadTile";c.actor=this.actor;const h={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request=this.actor.send(l,h,(d,x)=>(delete c.request,c.unloadVectorData(),c.aborted?_(null):d?_(d):(c.loadVectorData(x,this.map.painter,l==="reloadTile"),_(null))))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0}unloadTile(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var _t=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Et extends o.Evented{constructor(c,_,l,h){super(),this.id=c,this.dispatcher=l,this.coordinates=_.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=_}load(c,_){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(l,h)=>{this._loaded=!0,l?this.fire(new o.ErrorEvent(l)):h&&(this.image=h,c&&(this.coordinates=c),_&&_(),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}setCoordinates(c){this.coordinates=c;const _=c.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(h){let d=1/0,x=1/0,b=-1/0,S=-1/0;for(const j of h)d=Math.min(d,j.x),x=Math.min(x,j.y),b=Math.max(b,j.x),S=Math.max(S,j.y);const M=Math.max(b-d,S-x),B=Math.max(0,Math.floor(-Math.log(M)/Math.LN2)),V=Math.pow(2,B);return new o.CanonicalTileID(B,Math.floor((d+b)/2*V),Math.floor((x+S)/2*V))}(_),this.minzoom=this.maxzoom=this.tileID.z;const l=_.map(h=>this.tileID.getTilePoint(h)._round());return this._boundsArray=new o.RasterBoundsArray,this._boundsArray.emplaceBack(l[0].x,l[0].y,0,0),this._boundsArray.emplaceBack(l[1].x,l[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(l[3].x,l[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(l[2].x,l[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new q(c,this.image,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const l in this.tiles){const h=this.tiles[l];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}loadTile(c,_){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},_(null)):(c.state="errored",_(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Jt extends Et{constructor(c,_,l,h){super(c,_,l,h),this.roundZoom=!0,this.type="video",this.options=_}load(){this._loaded=!1;const c=this.options;this.urls=[];for(const _ of c.urls)this.urls.push(this.map._requestManager.transformRequest(_,o.ResourceType.Source).url);o.getVideo(this.urls,(_,l)=>{this._loaded=!0,_?this.fire(new o.ErrorEvent(_)):l&&(this.video=l,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const _=this.video.seekable;c<_.start(0)||c>_.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${_.start(0)} and ${_.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,_=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE),_.texSubImage2D(_.TEXTURE_2D,0,0,0,_.RGBA,_.UNSIGNED_BYTE,this.video)):(this.texture=new q(c,this.video,_.RGBA),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE));for(const l in this.tiles){const h=this.tiles[l];h.state!=="loaded"&&(h.state="loaded",h.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class kn extends Et{constructor(c,_,l,h){super(c,_,l,h),_.coordinates?Array.isArray(_.coordinates)&&_.coordinates.length===4&&!_.coordinates.some(d=>!Array.isArray(d)||d.length!==2||d.some(x=>typeof x!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "coordinates"'))),_.animate&&typeof _.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),_.canvas?typeof _.canvas=="string"||_.canvas instanceof HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "canvas"'))),this.options=_,this.animate=_.animate===void 0||_.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const _=this.map.painter.context,l=_.gl;this.boundsBuffer||(this.boundsBuffer=_.createVertexBuffer(this._boundsArray,_t.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new q(_,this.canvas,l.RGBA,{premultiply:!0});for(const h in this.tiles){const d=this.tiles[h];d.state!=="loaded"&&(d.state="loaded",d.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}const Tn={vector:Ze,raster:mt,"raster-dem":Tt,geojson:dn,video:Jt,image:Et,canvas:kn};function Tr(L,c){const _=o.create();return o.translate(_,_,[1,1,0]),o.scale(_,_,[.5*L.width,.5*L.height,1]),o.multiply(_,_,L.calculatePosMatrix(c.toUnwrapped()))}function Jn(L,c,_,l,h,d){const x=function(V,j,Y){if(V)for(const ae of V){const ne=j[ae];if(ne&&ne.source===Y&&ne.type==="fill-extrusion")return!0}else for(const ae in j){const ne=j[ae];if(ne.source===Y&&ne.type==="fill-extrusion")return!0}return!1}(h&&h.layers,c,L.id),b=d.maxPitchScaleFactor(),S=L.tilesIn(l,b,x);S.sort(ir);const M=[];for(const V of S)M.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(c,_,L._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,h,d,b,Tr(L.transform,V.tileID))});const B=function(V){const j={},Y={};for(const ae of V){const ne=ae.queryResults,ue=ae.wrappedTileID,be=Y[ue]=Y[ue]||{};for(const Ce in ne){const ve=ne[Ce],Ge=be[Ce]=be[Ce]||{},Te=j[Ce]=j[Ce]||[];for(const Ve of ve)Ge[Ve.featureIndex]||(Ge[Ve.featureIndex]=!0,Te.push(Ve))}}return j}(M);for(const V in B)B[V].forEach(j=>{const Y=j.feature,ae=L.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=ae});return B}function ir(L,c){const _=L.tileID,l=c.tileID;return _.overscaledZ-l.overscaledZ||_.canonical.y-l.canonical.y||_.wrap-l.wrap||_.canonical.x-l.canonical.x}class ur{constructor(c,_){this.tileID=c,this.uid=o.uniqueId(),this.uses=0,this.tileSize=_,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(c){const _=c+this.timeAdded;_<o.exported.now()||this.fadeEndTime&&_<this.fadeEndTime||(this.fadeEndTime=_)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.textures.forEach(_=>c.saveTileTexture(_)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(c,_,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(h,d){const x={};if(!d)return x;for(const b of h){const S=b.layerIds.map(M=>d.getLayer(M)).filter(Boolean);if(S.length!==0){b.layers=S,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(M=>S.filter(B=>B.id===M)[0]));for(const M of S)x[M.id]=b}}return x}(c.buckets,_.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const d=this.buckets[h];if(d instanceof o.SymbolBucket){if(this.hasSymbolBuckets=!0,!l)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const d=this.buckets[h];if(d instanceof o.SymbolBucket&&d.hasRTLText){this.hasRTLText=!0,o.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const h in this.buckets){const d=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,_.style.getLayer(h).queryRadius(d))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new o.CollisionBoxArray}unloadVectorData(){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(c)}const _=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new q(c,this.imageAtlas.image,_.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new q(c,this.glyphAtlasImage,_.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,_,l,h,d,x,b,S,M,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:d,scale:x,tileSize:this.tileSize,pixelPosMatrix:B,transform:S,params:b,queryPadding:this.queryPadding*M},c,_,l):{}}querySourceFeatures(c,_){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),d=_?_.sourceLayer:"",x=h._geojsonTileLayer||h[d];if(!x)return;const b=o.createFilter(_&&_.filter),{z:S,x:M,y:B}=this.tileID.canonical,V={z:S,x:M,y:B};for(let j=0;j<x.length;j++){const Y=x.feature(j);if(b.needGeometry){const ue=o.toEvaluationFeature(Y,!0);if(!b.filter(new o.EvaluationParameters(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!b.filter(new o.EvaluationParameters(this.tileID.overscaledZ),Y))continue;const ae=l.getId(Y,d),ne=new o.GeoJSONFeature(Y,S,M,B,ae);ne.tile=V,c.push(ne)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const _=this.expirationTime;if(c.cacheControl){const l=o.parseCacheControl(c.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(_)if(this.expirationTime<_)h=!0;else{const d=this.expirationTime-_;d?this.expirationTime=l+Math.max(d,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,_){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!_.style.hasLayer(h))continue;const d=this.buckets[h],x=d.layers[0].sourceLayer||"_geojsonTileLayer",b=l[x],S=c[x];if(!b||!S||Object.keys(S).length===0)continue;d.update(S,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});const M=_&&_.style&&_.style.getLayer(h);M&&(this.queryPadding=Math.max(this.queryPadding,M.queryRadius(d)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=o.exported.now()+c}setDependencies(c,_){const l={};for(const h of _)l[h]=!0;this.dependencies[c]=l}hasDependency(c,_){for(const l of c){const h=this.dependencies[l];if(h){for(const d of _)if(h[d])return!0}}return!1}}class Un{constructor(c,_){this.max=c,this.onRemove=_,this.reset()}reset(){for(const c in this.data)for(const _ of this.data[c])_.timeout&&clearTimeout(_.timeout),this.onRemove(_.value);return this.data={},this.order=[],this}add(c,_,l){const h=c.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const d={value:_,timeout:void 0};if(l!==void 0&&(d.timeout=setTimeout(()=>{this.remove(c,d)},l)),this.data[h].push(d),this.order.push(h),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const _=this.data[c].shift();return _.timeout&&clearTimeout(_.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),_.value}getByKey(c){const _=this.data[c];return _?_[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,_){if(!this.has(c))return this;const l=c.wrapped().key,h=_===void 0?0:this.data[l].indexOf(_),d=this.data[l][h];return this.data[l].splice(h,1),d.timeout&&clearTimeout(d.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(d.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}filter(c){const _=[];for(const l in this.data)for(const h of this.data[l])c(h.value)||_.push(h);for(const l of _)this.remove(l.value.tileID,l)}}class wr{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,_,l){const h=String(_);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][h]=this.stateChanges[c][h]||{},o.extend(this.stateChanges[c][h],l),this.deletedStates[c]===null){this.deletedStates[c]={};for(const d in this.state[c])d!==h&&(this.deletedStates[c][d]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][h]===null){this.deletedStates[c][h]={};for(const d in this.state[c][h])l[d]||(this.deletedStates[c][h][d]=null)}else for(const d in l)this.deletedStates[c]&&this.deletedStates[c][h]&&this.deletedStates[c][h][d]===null&&delete this.deletedStates[c][h][d]}removeFeatureState(c,_,l){if(this.deletedStates[c]===null)return;const h=String(_);if(this.deletedStates[c]=this.deletedStates[c]||{},l&&_!==void 0)this.deletedStates[c][h]!==null&&(this.deletedStates[c][h]=this.deletedStates[c][h]||{},this.deletedStates[c][h][l]=null);else if(_!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][h])for(l in this.deletedStates[c][h]={},this.stateChanges[c][h])this.deletedStates[c][h][l]=null;else this.deletedStates[c][h]=null;else this.deletedStates[c]=null}getState(c,_){const l=String(_),h=o.extend({},(this.state[c]||{})[l],(this.stateChanges[c]||{})[l]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const d=this.deletedStates[c][_];if(d===null)return{};for(const x in d)delete h[x]}return h}initializeTileState(c,_){c.setFeatureState(this.state,_)}coalesceChanges(c,_){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const d={};for(const x in this.stateChanges[h])this.state[h][x]||(this.state[h][x]={}),o.extend(this.state[h][x],this.stateChanges[h][x]),d[x]=this.state[h][x];l[h]=d}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const d={};if(this.deletedStates[h]===null)for(const x in this.state[h])d[x]={},this.state[h][x]={};else for(const x in this.deletedStates[h]){if(this.deletedStates[h][x]===null)this.state[h][x]={};else for(const b of Object.keys(this.deletedStates[h][x]))delete this.state[h][x][b];d[x]=this.state[h][x]}l[h]=l[h]||{},o.extend(l[h],d)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in c)c[h].setFeatureState(l,_)}}class wt extends o.Evented{constructor(c,_,l){super(),this.id=c,this.dispatcher=l,this.on("data",h=>{h.dataType==="source"&&h.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&h.dataType==="source"&&h.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(h,d,x,b){const S=new Tn[d.type](h,d,x,b);if(S.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${S.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],S),S}(c,_,l,this),this._tiles={},this._cache=new Un(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new wr}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles){const _=this._tiles[c];if(_.state!=="loaded"&&_.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,_){return this._source.loadTile(c,_)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){this._source.abortTile&&this._source.abortTile(c,()=>{}),this._source.fire(new o.Event("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const _ in this._tiles){const l=this._tiles[_];l.upload(c),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(rn).map(c=>c.key)}getRenderableIds(c){const _=[];for(const l in this._tiles)this._isIdRenderable(l,c)&&_.push(this._tiles[l]);return c?_.sort((l,h)=>{const d=l.tileID,x=h.tileID,b=new o.pointGeometry(d.canonical.x,d.canonical.y)._rotate(this.transform.angle),S=new o.pointGeometry(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return d.overscaledZ-x.overscaledZ||S.y-b.y||S.x-b.x}).map(l=>l.tileID.key):_.map(l=>l.tileID).sort(rn).map(l=>l.key)}hasRenderableParent(c){const _=this.findLoadedParent(c,0);return!!_&&this._isIdRenderable(_.tileID.key)}_isIdRenderable(c,_){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(_||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(c,_){const l=this._tiles[c];l&&(l.state!=="loading"&&(l.state=_),this._loadTile(l,this._tileLoaded.bind(this,l,c,_)))}_tileLoaded(c,_,l,h){if(h)return c.state="errored",void(h.status!==404?this._source.fire(new o.ErrorEvent(h,{tile:c})):this.update(this.transform,this.terrain));c.timeAdded=o.exported.now(),l==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(_,c),this.getSource().type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new o.Event("data",{dataType:"source",tile:c,coord:c.tileID}))}_backfillDEM(c){const _=this.getRenderableIds();for(let h=0;h<_.length;h++){const d=_[h];if(c.neighboringTiles&&c.neighboringTiles[d]){const x=this.getTileByID(d);l(c,x),l(x,c)}}function l(h,d){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let x=d.tileID.canonical.x-h.tileID.canonical.x;const b=d.tileID.canonical.y-h.tileID.canonical.y,S=Math.pow(2,h.tileID.canonical.z),M=d.tileID.key;x===0&&b===0||Math.abs(b)>1||(Math.abs(x)>1&&(Math.abs(x+S)===1?x+=S:Math.abs(x-S)===1&&(x-=S)),d.dem&&h.dem&&(h.dem.backfillBorder(d.dem,x,b),h.neighboringTiles&&h.neighboringTiles[M]&&(h.neighboringTiles[M].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,_,l,h){for(const d in this._tiles){let x=this._tiles[d];if(h[d]||!x.hasData()||x.tileID.overscaledZ<=_||x.tileID.overscaledZ>l)continue;let b=x.tileID;for(;x&&x.tileID.overscaledZ>_+1;){const M=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[M.key],x&&x.hasData()&&(b=M)}let S=b;for(;S.overscaledZ>_;)if(S=S.scaledTo(S.overscaledZ-1),c[S.key]){h[b.key]=b;break}}}findLoadedParent(c,_){if(c.key in this._loadedParentTiles){const l=this._loadedParentTiles[c.key];return l&&l.tileID.overscaledZ>=_?l:null}for(let l=c.overscaledZ-1;l>=_;l--){const h=c.scaledTo(l),d=this._getLoadedTile(h);if(d)return d}}_getLoadedTile(c){const _=this._tiles[c.key];return _&&_.hasData()?_:this._cache.getByKey(c.wrapped().key)}updateCacheSize(c){const _=Math.ceil(c.width/this._source.tileSize)+1,l=Math.ceil(c.height/this._source.tileSize)+1,h=Math.floor(_*l*5),d=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(d)}handleWrapJump(c){const _=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,_){const l={};for(const h in this._tiles){const d=this._tiles[h];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+_),l[d.tileID.key]=d}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}update(c,_){if(this.transform=c,this.terrain=_,!this._sourceLoaded||this._paused)return;let l;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new o.OverscaledTileID(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(l=c.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:_}),this._source.hasTile&&(l=l.filter(M=>this._source.hasTile(M)))):l=[];const h=c.coveringZoomLevel(this._source),d=Math.max(h-wt.maxOverzooming,this._source.minzoom),x=Math.max(h+wt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const B of l)if(B.canonical.z>this._source.minzoom){const V=B.scaledTo(B.canonical.z-1);M[V.key]=V;const j=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));M[j.key]=j}l=l.concat(Object.values(M))}const b=this._updateRetainedTiles(l,h);if(Cn(this._source.type)){const M={},B={},V=Object.keys(b);for(const j of V){const Y=b[j],ae=this._tiles[j];if(!ae||ae.fadeEndTime&&ae.fadeEndTime<=o.exported.now())continue;const ne=this.findLoadedParent(Y,d);ne&&(this._addTile(ne.tileID),M[ne.tileID.key]=ne.tileID),B[j]=Y}this._retainLoadedChildren(B,h,x,b);for(const j in M)b[j]||(this._coveredTiles[j]=!0,b[j]=M[j]);if(_){const j={},Y={};for(const ae of l)this._tiles[ae.key].hasData()?j[ae.key]=ae:Y[ae.key]=ae;for(const ae in Y){const ne=Y[ae].children(this._source.maxzoom);this._tiles[ne[0].key]&&this._tiles[ne[1].key]&&this._tiles[ne[2].key]&&this._tiles[ne[3].key]&&(j[ne[0].key]=b[ne[0].key]=ne[0],j[ne[1].key]=b[ne[1].key]=ne[1],j[ne[2].key]=b[ne[2].key]=ne[2],j[ne[3].key]=b[ne[3].key]=ne[3],delete Y[ae])}for(const ae in Y){const ne=this.findLoadedParent(Y[ae],this._source.minzoom);if(ne){j[ne.tileID.key]=b[ne.tileID.key]=ne.tileID;for(const ue in j)j[ue].isChildOf(ne.tileID)&&delete j[ue]}}for(const ae in this._tiles)j[ae]||(this._coveredTiles[ae]=!0)}}for(const M in b)this._tiles[M].clearFadeHold();const S=o.keysDifference(this._tiles,b);for(const M of S){const B=this._tiles[M];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)}_updateRetainedTiles(c,_){const l={},h={},d=Math.max(_-wt.maxOverzooming,this._source.minzoom),x=Math.max(_+wt.maxUnderzooming,this._source.minzoom),b={};for(const S of c){const M=this._addTile(S);l[S.key]=S,M.hasData()||_<this._source.maxzoom&&(b[S.key]=S)}this._retainLoadedChildren(b,_,x,l);for(const S of c){let M=this._tiles[S.key];if(M.hasData())continue;if(_+1>this._source.maxzoom){const V=S.children(this._source.maxzoom)[0],j=this.getTile(V);if(j&&j.hasData()){l[V.key]=V;continue}}else{const V=S.children(this._source.maxzoom);if(l[V[0].key]&&l[V[1].key]&&l[V[2].key]&&l[V[3].key])continue}let B=M.wasRequested();for(let V=S.overscaledZ-1;V>=d;--V){const j=S.scaledTo(V);if(h[j.key]||(h[j.key]=!0,M=this.getTile(j),!M&&B&&(M=this._addTile(j)),M&&(l[j.key]=j,B=M.wasRequested(),M.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const _=[];let l,h=this._tiles[c].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}_.push(h.key);const d=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(d),l)break;h=d}for(const d of _)this._loadedParentTiles[d]=l}}_addTile(c){let _=this._tiles[c.key];if(_)return _;_=this._cache.getAndRemove(c),_&&(this._setTileReloadTimer(c.key,_),_.tileID=c,this._state.initializeTileState(_,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,_)));const l=_;return _||(_=new ur(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(_,this._tileLoaded.bind(this,_,c.key,_.state))),_.uses++,this._tiles[c.key]=_,l||this._source.fire(new o.Event("dataloading",{tile:_,coord:_.tileID,dataType:"source"})),_}_setTileReloadTimer(c,_){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const l=_.getExpiryTimeout();l&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},l))}_removeTile(c){const _=this._tiles[c];_&&(_.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),_.uses>0||(_.hasData()&&_.state!=="reloading"?this._cache.add(_.tileID,_,_.getExpiryTimeout()):(_.aborted=!0,this._abortTile(_),this._unloadTile(_))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(c);this._cache.reset()}tilesIn(c,_,l){const h=[],d=this.transform;if(!d)return h;const x=l?d.getCameraQueryGeometry(c):c,b=c.map(ae=>d.pointCoordinate(ae,this.terrain)),S=x.map(ae=>d.pointCoordinate(ae,this.terrain)),M=this.getIds();let B=1/0,V=1/0,j=-1/0,Y=-1/0;for(const ae of S)B=Math.min(B,ae.x),V=Math.min(V,ae.y),j=Math.max(j,ae.x),Y=Math.max(Y,ae.y);for(let ae=0;ae<M.length;ae++){const ne=this._tiles[M[ae]];if(ne.holdingForFade())continue;const ue=ne.tileID,be=Math.pow(2,d.zoom-ne.tileID.overscaledZ),Ce=_*ne.queryPadding*o.EXTENT/ne.tileSize/be,ve=[ue.getTilePoint(new o.MercatorCoordinate(B,V)),ue.getTilePoint(new o.MercatorCoordinate(j,Y))];if(ve[0].x-Ce<o.EXTENT&&ve[0].y-Ce<o.EXTENT&&ve[1].x+Ce>=0&&ve[1].y+Ce>=0){const Ge=b.map(Ve=>ue.getTilePoint(Ve)),Te=S.map(Ve=>ue.getTilePoint(Ve));h.push({tile:ne,tileID:ue,queryGeometry:Ge,cameraQueryGeometry:Te,scale:be})}}return h}getVisibleCoordinates(c){const _=this.getRenderableIds(c).map(l=>this._tiles[l].tileID);for(const l of _)l.posMatrix=this.transform.calculatePosMatrix(l.toUnwrapped());return _}hasTransition(){if(this._source.hasTransition())return!0;if(Cn(this._source.type))for(const c in this._tiles){const _=this._tiles[c];if(_.fadeEndTime!==void 0&&_.fadeEndTime>=o.exported.now())return!0}return!1}setFeatureState(c,_,l){this._state.updateState(c=c||"_geojsonTileLayer",_,l)}removeFeatureState(c,_,l){this._state.removeFeatureState(c=c||"_geojsonTileLayer",_,l)}getFeatureState(c,_){return this._state.getState(c=c||"_geojsonTileLayer",_)}setDependencies(c,_,l){const h=this._tiles[c];h&&h.setDependencies(_,l)}reloadTilesForDependencies(c,_){for(const l in this._tiles)this._tiles[l].hasDependency(c,_)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(c,_))}}function rn(L,c){const _=Math.abs(2*L.wrap)-+(L.wrap<0),l=Math.abs(2*c.wrap)-+(c.wrap<0);return L.overscaledZ-c.overscaledZ||l-_||c.canonical.y-L.canonical.y||c.canonical.x-L.canonical.x}function Cn(L){return L==="raster"||L==="image"||L==="video"}wt.maxOverzooming=10,wt.maxUnderzooming=3;const xt="mapboxgl_preloaded_worker_pool";class er{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<er.workerCount;)this.workers.push(new Worker(Ws.workerUrl));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(_=>{_.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[xt]}numActive(){return Object.keys(this.active).length}}const Hn=Math.floor(o.exported.hardwareConcurrency/2);let mr;function or(){return mr||(mr=new er),mr}function tr(L,c){const _={};for(const l in L)l!=="ref"&&(_[l]=L[l]);return o.refProperties.forEach(l=>{l in c&&(_[l]=c[l])}),_}function Kr(L){L=L.slice();const c=Object.create(null);for(let _=0;_<L.length;_++)c[L[_].id]=L[_];for(let _=0;_<L.length;_++)"ref"in L[_]&&(L[_]=tr(L[_],c[L[_].ref]));return L}er.workerCount=Math.max(Math.min(Hn,6),1);const Vn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Si(L,c,_){_.push({command:Vn.addSource,args:[L,c[L]]})}function Wn(L,c,_){c.push({command:Vn.removeSource,args:[L]}),_[L]=!0}function Fi(L,c,_,l){Wn(L,_,l),Si(L,c,_)}function fo(L,c,_){let l;for(l in L[_])if(Object.prototype.hasOwnProperty.call(L[_],l)&&l!=="data"&&!I(L[_][l],c[_][l]))return!1;for(l in c[_])if(Object.prototype.hasOwnProperty.call(c[_],l)&&l!=="data"&&!I(L[_][l],c[_][l]))return!1;return!0}function Fr(L,c,_,l,h,d){let x;for(x in c=c||{},L=L||{})Object.prototype.hasOwnProperty.call(L,x)&&(I(L[x],c[x])||_.push({command:d,args:[l,x,c[x],h]}));for(x in c)Object.prototype.hasOwnProperty.call(c,x)&&!Object.prototype.hasOwnProperty.call(L,x)&&(I(L[x],c[x])||_.push({command:d,args:[l,x,c[x],h]}))}function Mi(L){return L.id}function Oo(L,c){return L[c.id]=c,L}class is{constructor(c,_){this.reset(c,_)}reset(c,_){this.points=c||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(_||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=o.clamp(c,0,1);let _=1,l=this._distances[_];const h=c*this.paddedLength+this.padding;for(;l<h&&_<this._distances.length;)l=this._distances[++_];const d=_-1,x=this._distances[d],b=l-x,S=b>0?(h-x)/b:0;return this.points[d].mult(1-S).add(this.points[_].mult(S))}}function ct(L,c){let _=!0;return L==="always"||L!=="never"&&c!=="never"||(_=!1),_}class kt{constructor(c,_,l){const h=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(c/l),this.yCellCount=Math.ceil(_/l);for(let x=0;x<this.xCellCount*this.yCellCount;x++)h.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=_,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/_,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,_,l,h,d){this._forEachCell(_,l,h,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(_),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(d)}insertCircle(c,_,l,h){this._forEachCell(_-h,l-h,_+h,l+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(_),this.circles.push(l),this.circles.push(h)}_insertBoxCell(c,_,l,h,d,x){this.boxCells[d].push(x)}_insertCircleCell(c,_,l,h,d,x){this.circleCells[d].push(x)}_query(c,_,l,h,d,x,b){if(l<0||c>this.width||h<0||_>this.height)return[];const S=[];if(c<=0&&_<=0&&this.width<=l&&this.height<=h){if(d)return[{key:null,x1:c,y1:_,x2:l,y2:h}];for(let M=0;M<this.boxKeys.length;M++)S.push({key:this.boxKeys[M],x1:this.bboxes[4*M],y1:this.bboxes[4*M+1],x2:this.bboxes[4*M+2],y2:this.bboxes[4*M+3]});for(let M=0;M<this.circleKeys.length;M++){const B=this.circles[3*M],V=this.circles[3*M+1],j=this.circles[3*M+2];S.push({key:this.circleKeys[M],x1:B-j,y1:V-j,x2:B+j,y2:V+j})}}else this._forEachCell(c,_,l,h,this._queryCell,S,{hitTest:d,overlapMode:x,seenUids:{box:{},circle:{}}},b);return S}query(c,_,l,h){return this._query(c,_,l,h,!1,null)}hitTest(c,_,l,h,d,x){return this._query(c,_,l,h,!0,d,x).length>0}hitTestCircle(c,_,l,h,d){const x=c-l,b=c+l,S=_-l,M=_+l;if(b<0||x>this.width||M<0||S>this.height)return!1;const B=[];return this._forEachCell(x,S,b,M,this._queryCellCircle,B,{hitTest:!0,overlapMode:h,circle:{x:c,y:_,radius:l},seenUids:{box:{},circle:{}}},d),B.length>0}_queryCell(c,_,l,h,d,x,b,S){const{seenUids:M,hitTest:B,overlapMode:V}=b,j=this.boxCells[d];if(j!==null){const ae=this.bboxes;for(const ne of j)if(!M.box[ne]){M.box[ne]=!0;const ue=4*ne,be=this.boxKeys[ne];if(c<=ae[ue+2]&&_<=ae[ue+3]&&l>=ae[ue+0]&&h>=ae[ue+1]&&(!S||S(be))&&(!B||!ct(V,be.overlapMode))&&(x.push({key:be,x1:ae[ue],y1:ae[ue+1],x2:ae[ue+2],y2:ae[ue+3]}),B))return!0}}const Y=this.circleCells[d];if(Y!==null){const ae=this.circles;for(const ne of Y)if(!M.circle[ne]){M.circle[ne]=!0;const ue=3*ne,be=this.circleKeys[ne];if(this._circleAndRectCollide(ae[ue],ae[ue+1],ae[ue+2],c,_,l,h)&&(!S||S(be))&&(!B||!ct(V,be.overlapMode))){const Ce=ae[ue],ve=ae[ue+1],Ge=ae[ue+2];if(x.push({key:be,x1:Ce-Ge,y1:ve-Ge,x2:Ce+Ge,y2:ve+Ge}),B)return!0}}}return!1}_queryCellCircle(c,_,l,h,d,x,b,S){const{circle:M,seenUids:B,overlapMode:V}=b,j=this.boxCells[d];if(j!==null){const ae=this.bboxes;for(const ne of j)if(!B.box[ne]){B.box[ne]=!0;const ue=4*ne,be=this.boxKeys[ne];if(this._circleAndRectCollide(M.x,M.y,M.radius,ae[ue+0],ae[ue+1],ae[ue+2],ae[ue+3])&&(!S||S(be))&&!ct(V,be.overlapMode))return x.push(!0),!0}}const Y=this.circleCells[d];if(Y!==null){const ae=this.circles;for(const ne of Y)if(!B.circle[ne]){B.circle[ne]=!0;const ue=3*ne,be=this.circleKeys[ne];if(this._circlesCollide(ae[ue],ae[ue+1],ae[ue+2],M.x,M.y,M.radius)&&(!S||S(be))&&!ct(V,be.overlapMode))return x.push(!0),!0}}}_forEachCell(c,_,l,h,d,x,b,S){const M=this._convertToXCellCoord(c),B=this._convertToYCellCoord(_),V=this._convertToXCellCoord(l),j=this._convertToYCellCoord(h);for(let Y=M;Y<=V;Y++)for(let ae=B;ae<=j;ae++)if(d.call(this,c,_,l,h,this.xCellCount*ae+Y,x,b,S))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,_,l,h,d,x){const b=h-c,S=d-_,M=l+x;return M*M>b*b+S*S}_circleAndRectCollide(c,_,l,h,d,x,b){const S=(x-h)/2,M=Math.abs(c-(h+S));if(M>S+l)return!1;const B=(b-d)/2,V=Math.abs(_-(d+B));if(V>B+l)return!1;if(M<=S||V<=B)return!0;const j=M-S,Y=V-B;return j*j+Y*Y<=l*l}}function Bs(L,c,_,l,h){const d=o.create();return c?(o.scale(d,d,[1/h,1/h,1]),_||o.rotateZ(d,d,l.angle)):o.multiply(d,l.labelPlaneMatrix,L),d}function yi(L,c,_,l,h){if(c){const d=o.clone(L);return o.scale(d,d,[h,h,1]),_||o.rotateZ(d,d,-l.angle),d}return l.glCoordMatrix}function Bn(L,c,_){let l;_?(l=[L.x,L.y,_(L.x,L.y),1],o.transformMat4(l,l,c)):(l=[L.x,L.y,0,1],Ye(l,l,c));const h=l[3];return{point:new o.pointGeometry(l[0]/h,l[1]/h),signedDistanceFromCamera:h}}function Ni(L,c){return .5+L/c*.5}function Ci(L,c){const _=L[0]/L[3],l=L[1]/L[3];return _>=-c[0]&&_<=c[0]&&l>=-c[1]&&l<=c[1]}function Pi(L,c,_,l,h,d,x,b,S,M){const B=l?L.textSizeData:L.iconSizeData,V=o.evaluateSizeForZoom(B,_.transform.zoom),j=[256/_.width*2+1,256/_.height*2+1],Y=l?L.text.dynamicLayoutVertexArray:L.icon.dynamicLayoutVertexArray;Y.clear();const ae=L.lineVertexArray,ne=l?L.text.placedSymbolArray:L.icon.placedSymbolArray,ue=_.transform.width/_.transform.height;let be=!1;for(let Ce=0;Ce<ne.length;Ce++){const ve=ne.get(Ce);if(ve.hidden||ve.writingMode===o.WritingMode.vertical&&!be){yn(ve.numGlyphs,Y);continue}let Ge;if(be=!1,M?(Ge=[ve.anchorX,ve.anchorY,M(ve.anchorX,ve.anchorY),1],o.transformMat4(Ge,Ge,c)):(Ge=[ve.anchorX,ve.anchorY,0,1],Ye(Ge,Ge,c)),!Ci(Ge,j)){yn(ve.numGlyphs,Y);continue}const Te=Ni(_.transform.cameraToCenterDistance,Ge[3]),Ve=o.evaluateSizeForFeature(B,V,ve),xe=x?Ve/Te:Ve*Te,y=new o.pointGeometry(ve.anchorX,ve.anchorY),m=Bn(y,h,M).point,v={},E=Sn(ve,xe,!1,b,c,h,d,L.glyphOffsetArray,ae,Y,m,y,v,ue,S,M);be=E.useVertical,(E.notEnoughRoom||be||E.needsFlipping&&Sn(ve,xe,!0,b,c,h,d,L.glyphOffsetArray,ae,Y,m,y,v,ue,S,M).notEnoughRoom)&&yn(ve.numGlyphs,Y)}l?L.text.dynamicLayoutVertexBuffer.updateData(Y):L.icon.dynamicLayoutVertexBuffer.updateData(Y)}function ss(L,c,_,l,h,d,x,b,S,M,B,V,j){const Y=b.glyphStartIndex+b.numGlyphs,ae=b.lineStartIndex,ne=b.lineStartIndex+b.lineLength,ue=c.getoffsetX(b.glyphStartIndex),be=c.getoffsetX(Y-1),Ce=Cr(L*ue,_,l,h,d,x,b.segment,ae,ne,S,M,B,V,j);if(!Ce)return null;const ve=Cr(L*be,_,l,h,d,x,b.segment,ae,ne,S,M,B,V,j);return ve?{first:Ce,last:ve}:null}function Lt(L,c,_,l){return L===o.WritingMode.horizontal&&Math.abs(_.y-c.y)>Math.abs(_.x-c.x)*l?{useVertical:!0}:(L===o.WritingMode.vertical?c.y<_.y:c.x>_.x)?{needsFlipping:!0}:null}function Sn(L,c,_,l,h,d,x,b,S,M,B,V,j,Y,ae,ne){const ue=c/24,be=L.lineOffsetX*ue,Ce=L.lineOffsetY*ue;let ve;if(L.numGlyphs>1){const Ge=L.glyphStartIndex+L.numGlyphs,Te=L.lineStartIndex,Ve=L.lineStartIndex+L.lineLength,xe=ss(ue,b,be,Ce,_,B,V,L,S,d,j,ae,ne);if(!xe)return{notEnoughRoom:!0};const y=Bn(xe.first.point,x,ne).point,m=Bn(xe.last.point,x,ne).point;if(l&&!_){const v=Lt(L.writingMode,y,m,Y);if(v)return v}ve=[xe.first];for(let v=L.glyphStartIndex+1;v<Ge-1;v++)ve.push(Cr(ue*b.getoffsetX(v),be,Ce,_,B,V,L.segment,Te,Ve,S,d,j,ae,ne));ve.push(xe.last)}else{if(l&&!_){const Te=Bn(V,h,ne).point,Ve=L.lineStartIndex+L.segment+1,xe=new o.pointGeometry(S.getx(Ve),S.gety(Ve)),y=Bn(xe,h,ne),m=y.signedDistanceFromCamera>0?y.point:bn(V,xe,Te,1,h,ne),v=Lt(L.writingMode,Te,m,Y);if(v)return v}const Ge=Cr(ue*b.getoffsetX(L.glyphStartIndex),be,Ce,_,B,V,L.segment,L.lineStartIndex,L.lineStartIndex+L.lineLength,S,d,j,ae,ne);if(!Ge)return{notEnoughRoom:!0};ve=[Ge]}for(const Ge of ve)o.addDynamicAttributes(M,Ge.point,Ge.angle);return{}}function bn(L,c,_,l,h,d){const x=Bn(L.add(L.sub(c)._unit()),h,d).point,b=_.sub(x);return _.add(b._mult(l/b.mag()))}function Cr(L,c,_,l,h,d,x,b,S,M,B,V,j,Y){const ae=l?L-c:L+c;let ne=ae>0?1:-1,ue=0;l&&(ne*=-1,ue=Math.PI),ne<0&&(ue+=Math.PI);let be=ne>0?b+x:b+x+1,Ce=h,ve=h,Ge=0,Te=0;const Ve=Math.abs(ae),xe=[];for(;Ge+Te<=Ve;){if(be+=ne,be<b||be>=S)return null;if(ve=Ce,xe.push(Ce),Ce=V[be],Ce===void 0){const P=new o.pointGeometry(M.getx(be),M.gety(be)),R=Bn(P,B,Y);if(R.signedDistanceFromCamera>0)Ce=V[be]=R.point;else{const O=be-ne;Ce=bn(Ge===0?d:new o.pointGeometry(M.getx(O),M.gety(O)),P,ve,Ve-Ge+1,B,Y)}}Ge+=Te,Te=ve.dist(Ce)}const y=(Ve-Ge)/Te,m=Ce.sub(ve),v=m.mult(y)._add(ve);v._add(m._unit()._perp()._mult(_*ne));const E=ue+Math.atan2(Ce.y-ve.y,Ce.x-ve.x);return xe.push(v),{point:v,angle:j?E:0,path:xe}}const xs=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function yn(L,c){for(let _=0;_<L;_++){const l=c.length;c.resize(l+4),c.float32.set(xs,3*l)}}function Ye(L,c,_){const l=c[0],h=c[1];return L[0]=_[0]*l+_[4]*h+_[12],L[1]=_[1]*l+_[5]*h+_[13],L[3]=_[3]*l+_[7]*h+_[15],L}const jr=100;class zs{constructor(c,_=new kt(c.width+200,c.height+200,25),l=new kt(c.width+200,c.height+200,25)){this.transform=c,this.grid=_,this.ignoredGrid=l,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+jr,this.screenBottomBoundary=c.height+jr,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,_,l,h,d,x){const b=this.projectAndGetPerspectiveRatio(h,c.anchorPointX,c.anchorPointY,x),S=l*b.perspectiveRatio,M=c.x1*S+b.point.x,B=c.y1*S+b.point.y,V=c.x2*S+b.point.x,j=c.y2*S+b.point.y;return!this.isInsideGrid(M,B,V,j)||_!=="always"&&this.grid.hitTest(M,B,V,j,_,d)||b.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[M,B,V,j],offscreen:this.isOffscreen(M,B,V,j)}}placeCollisionCircles(c,_,l,h,d,x,b,S,M,B,V,j,Y,ae){const ne=[],ue=new o.pointGeometry(_.anchorX,_.anchorY),be=Bn(ue,x,ae),Ce=Ni(this.transform.cameraToCenterDistance,be.signedDistanceFromCamera),ve=(B?d/Ce:d*Ce)/o.ONE_EM,Ge=Bn(ue,b,ae).point,Te=ss(ve,h,_.lineOffsetX*ve,_.lineOffsetY*ve,!1,Ge,ue,_,l,b,{},!1,ae);let Ve=!1,xe=!1,y=!0;if(Te){const m=.5*j*Ce+Y,v=new o.pointGeometry(-100,-100),E=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),P=new is,R=Te.first,O=Te.last;let N=[];for(let le=R.path.length-1;le>=1;le--)N.push(R.path[le]);for(let le=1;le<O.path.length;le++)N.push(O.path[le]);const Q=2.5*m;if(S){const le=N.map(de=>Bn(de,S,ae));N=le.some(de=>de.signedDistanceFromCamera<=0)?[]:le.map(de=>de.point)}let J=[];if(N.length>0){const le=N[0].clone(),de=N[0].clone();for(let Re=1;Re<N.length;Re++)le.x=Math.min(le.x,N[Re].x),le.y=Math.min(le.y,N[Re].y),de.x=Math.max(de.x,N[Re].x),de.y=Math.max(de.y,N[Re].y);J=le.x>=v.x&&de.x<=E.x&&le.y>=v.y&&de.y<=E.y?[N]:de.x<v.x||le.x>E.x||de.y<v.y||le.y>E.y?[]:o.clipLine([N],v.x,v.y,E.x,E.y)}for(const le of J){P.reset(le,.25*m);let de=0;de=P.length<=.5*m?1:Math.ceil(P.paddedLength/Q)+1;for(let Re=0;Re<de;Re++){const $e=Re/Math.max(de-1,1),Be=P.lerp($e),Xe=Be.x+jr,ht=Be.y+jr;ne.push(Xe,ht,m,0);const ut=Xe-m,it=ht-m,st=Xe+m,Je=ht+m;if(y=y&&this.isOffscreen(ut,it,st,Je),xe=xe||this.isInsideGrid(ut,it,st,Je),c!=="always"&&this.grid.hitTestCircle(Xe,ht,m,c,V)&&(Ve=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Ve}}}}return{circles:!M&&Ve||!xe||Ce<this.perspectiveRatioCutoff?[]:ne,offscreen:y,collisionDetected:Ve}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const _=[];let l=1/0,h=1/0,d=-1/0,x=-1/0;for(const B of c){const V=new o.pointGeometry(B.x+jr,B.y+jr);l=Math.min(l,V.x),h=Math.min(h,V.y),d=Math.max(d,V.x),x=Math.max(x,V.y),_.push(V)}const b=this.grid.query(l,h,d,x).concat(this.ignoredGrid.query(l,h,d,x)),S={},M={};for(const B of b){const V=B.key;if(S[V.bucketInstanceId]===void 0&&(S[V.bucketInstanceId]={}),S[V.bucketInstanceId][V.featureIndex])continue;const j=[new o.pointGeometry(B.x1,B.y1),new o.pointGeometry(B.x2,B.y1),new o.pointGeometry(B.x2,B.y2),new o.pointGeometry(B.x1,B.y2)];o.polygonIntersectsPolygon(_,j)&&(S[V.bucketInstanceId][V.featureIndex]=!0,M[V.bucketInstanceId]===void 0&&(M[V.bucketInstanceId]=[]),M[V.bucketInstanceId].push(V.featureIndex))}return M}insertCollisionBox(c,_,l,h,d,x){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:d,collisionGroupID:x,overlapMode:_},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,_,l,h,d,x){const b=l?this.ignoredGrid:this.grid,S={bucketInstanceId:h,featureIndex:d,collisionGroupID:x,overlapMode:_};for(let M=0;M<c.length;M+=4)b.insertCircle(S,c[M],c[M+1],c[M+2])}projectAndGetPerspectiveRatio(c,_,l,h){let d;return h?(d=[_,l,h(_,l),1],o.transformMat4(d,d,c)):(d=[_,l,0,1],Ye(d,d,c)),{point:new o.pointGeometry((d[0]/d[3]+1)/2*this.transform.width+jr,(-d[1]/d[3]+1)/2*this.transform.height+jr),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}}isOffscreen(c,_,l,h){return l<jr||c>=this.screenRightBoundary||h<jr||_>this.screenBottomBoundary}isInsideGrid(c,_,l,h){return l>=0&&c<this.gridRightBoundary&&h>=0&&_<this.gridBottomBoundary}getViewportMatrix(){const c=o.identity([]);return o.translate(c,c,[-100,-100,0]),c}}function Dr(L,c,_){return c*(o.EXTENT/(L.tileSize*Math.pow(2,_-L.tileID.overscaledZ)))}class oi{constructor(c,_,l,h){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?_:-_))):h&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Zn{constructor(c,_,l,h,d){this.text=new oi(c?c.text:null,_,l,d),this.icon=new oi(c?c.icon:null,_,h,d)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Os{constructor(c,_,l){this.text=c,this.icon=_,this.skipFade=l}}class Ui{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Vi{constructor(c,_,l,h,d){this.bucketInstanceId=c,this.featureIndex=_,this.sourceLayerIndex=l,this.bucketIndex=h,this.tileID=d}}class Ii{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const _=++this.maxGroupID;this.collisionGroups[c]={ID:_,predicate:l=>l.collisionGroupID===_}}return this.collisionGroups[c]}}function os(L,c,_,l,h){const{horizontalAlign:d,verticalAlign:x}=o.getAnchorAlignment(L),b=-(d-.5)*c,S=-(x-.5)*_,M=o.evaluateVariableOffset(L,l);return new o.pointGeometry(b+M[0]*h,S+M[1]*h)}function Rr(L,c,_,l,h,d){const{x1:x,x2:b,y1:S,y2:M,anchorPointX:B,anchorPointY:V}=L,j=new o.pointGeometry(c,_);return l&&j._rotate(h?d:-d),{x1:x+j.x,y1:S+j.y,x2:b+j.x,y2:M+j.y,anchorPointX:B,anchorPointY:V}}class K{constructor(c,_,l,h,d){this.transform=c.clone(),this.terrain=_,this.collisionIndex=new zs(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Ii(h),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,_,l,h){const d=l.getBucket(_),x=l.latestFeatureIndex;if(!d||!x||_.id!==d.layerIds[0])return;const b=l.collisionBoxArray,S=d.layers[0].layout,M=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),B=l.tileSize/o.EXTENT,V=this.transform.calculatePosMatrix(l.tileID.toUnwrapped()),j=S.get("text-pitch-alignment")==="map",Y=S.get("text-rotation-alignment")==="map",ae=Dr(l,1,this.transform.zoom),ne=Bs(V,j,Y,this.transform,ae);let ue=null;if(j){const Ce=yi(V,j,Y,this.transform,ae);ue=o.multiply([],this.transform.labelPlaneMatrix,Ce)}this.retainedQueryData[d.bucketInstanceId]=new Vi(d.bucketInstanceId,x,d.sourceLayerIndex,d.index,l.tileID);const be={bucket:d,layout:S,posMatrix:V,textLabelPlaneMatrix:ne,labelToScreenMatrix:ue,scale:M,textPixelRatio:B,holdingForFade:l.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(d.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(h)for(const Ce of d.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:Ge,symbolInstanceEnd:Te}=Ce;c.push({sortKey:ve,symbolInstanceStart:Ge,symbolInstanceEnd:Te,parameters:be})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:be})}attemptAnchorPlacement(c,_,l,h,d,x,b,S,M,B,V,j,Y,ae,ne,ue){const be=[j.textOffset0,j.textOffset1],Ce=os(c,l,h,be,d),ve=this.collisionIndex.placeCollisionBox(Rr(_,Ce.x,Ce.y,x,b,this.transform.angle),V,S,M,B.predicate,ue);if((!ne||this.collisionIndex.placeCollisionBox(Rr(ne,Ce.x,Ce.y,x,b,this.transform.angle),V,S,M,B.predicate,ue).box.length!==0)&&ve.box.length>0){let Ge;if(this.prevPlacement&&this.prevPlacement.variableOffsets[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID]&&this.prevPlacement.placements[j.crossTileID].text&&(Ge=this.prevPlacement.variableOffsets[j.crossTileID].anchor),j.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[j.crossTileID]={textOffset:be,width:l,height:h,anchor:c,textBoxScale:d,prevAnchor:Ge},this.markUsedJustification(Y,c,j,ae),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,ae,j),this.placedOrientations[j.crossTileID]=ae),{shift:Ce,placedGlyphBoxes:ve}}}placeLayerBucketPart(c,_,l){const{bucket:h,layout:d,posMatrix:x,textLabelPlaneMatrix:b,labelToScreenMatrix:S,textPixelRatio:M,holdingForFade:B,collisionBoxArray:V,partiallyEvaluatedTextSize:j,collisionGroup:Y}=c.parameters,ae=d.get("text-optional"),ne=d.get("icon-optional"),ue=o.getOverlapMode(d,"text-overlap","text-allow-overlap"),be=ue==="always",Ce=o.getOverlapMode(d,"icon-overlap","icon-allow-overlap"),ve=Ce==="always",Ge=d.get("text-rotation-alignment")==="map",Te=d.get("text-pitch-alignment")==="map",Ve=d.get("icon-text-fit")!=="none",xe=d.get("symbol-z-order")==="viewport-y",y=be&&(ve||!h.hasIconData()||ne),m=ve&&(be||!h.hasTextData()||ae);!h.collisionArrays&&V&&h.deserializeCollisionBoxes(V);const v=(E,P)=>{if(_[E.crossTileID])return;if(B)return void(this.placements[E.crossTileID]=new Os(!1,!1,!1));let R=!1,O=!1,N=!0,Q=null,J={box:null,offscreen:null},le={box:null,offscreen:null},de=null,Re=null,$e=null,Be=0,Xe=0,ht=0;P.textFeatureIndex?Be=P.textFeatureIndex:E.useRuntimeCollisionCircles&&(Be=E.featureIndex),P.verticalTextFeatureIndex&&(Xe=P.verticalTextFeatureIndex);const ut=this.retainedQueryData[h.bucketInstanceId].tileID,it=this.terrain?(zt,dt)=>this.terrain.getElevation(ut,zt,dt):null;for(const zt of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const dt=P[zt];dt&&(dt.elevation=it?it(dt.anchorPointX,dt.anchorPointY):0)}const st=P.textBox;if(st){const zt=vt=>{let Pn=o.WritingMode.horizontal;if(h.allowVerticalPlacement&&!vt&&this.prevPlacement){const wn=this.prevPlacement.placedOrientations[E.crossTileID];wn&&(this.placedOrientations[E.crossTileID]=wn,Pn=wn,this.markUsedOrientation(h,Pn,E))}return Pn},dt=(vt,Pn)=>{if(h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&P.verticalTextBox){for(const wn of h.writingModes)if(wn===o.WritingMode.vertical?(J=Pn(),le=J):J=vt(),J&&J.box&&J.box.length)break}else J=vt()};if(d.get("text-variable-anchor")){let vt=d.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[E.crossTileID]){const mn=this.prevPlacement.variableOffsets[E.crossTileID];vt.indexOf(mn.anchor)>0&&(vt=vt.filter(_n=>_n!==mn.anchor),vt.unshift(mn.anchor))}const Pn=(mn,_n,En)=>{const Dn=mn.x2-mn.x1,sr=mn.y2-mn.y1,In=E.textBoxScale,vr=Ve&&Ce==="never"?_n:null;let Qr={box:[],offscreen:!1};const Xa=ue!=="never"?2*vt.length:vt.length;for(let du=0;du<Xa;++du){const Df=this.attemptAnchorPlacement(vt[du%vt.length],mn,Dn,sr,In,Ge,Te,M,x,Y,du>=vt.length?ue:"never",E,h,En,vr,it);if(Df&&(Qr=Df.placedGlyphBoxes,Qr&&Qr.box&&Qr.box.length)){R=!0,Q=Df.shift;break}}return Qr};dt(()=>Pn(st,P.iconBox,o.WritingMode.horizontal),()=>{const mn=P.verticalTextBox;return h.allowVerticalPlacement&&!(J&&J.box&&J.box.length)&&E.numVerticalGlyphVertices>0&&mn?Pn(mn,P.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),J&&(R=J.box,N=J.offscreen);const wn=zt(J&&J.box);if(!R&&this.prevPlacement){const mn=this.prevPlacement.variableOffsets[E.crossTileID];mn&&(this.variableOffsets[E.crossTileID]=mn,this.markUsedJustification(h,mn.anchor,E,wn))}}else{const vt=(Pn,wn)=>{const mn=this.collisionIndex.placeCollisionBox(Pn,ue,M,x,Y.predicate,it);return mn&&mn.box&&mn.box.length&&(this.markUsedOrientation(h,wn,E),this.placedOrientations[E.crossTileID]=wn),mn};dt(()=>vt(st,o.WritingMode.horizontal),()=>{const Pn=P.verticalTextBox;return h.allowVerticalPlacement&&E.numVerticalGlyphVertices>0&&Pn?vt(Pn,o.WritingMode.vertical):{box:null,offscreen:null}}),zt(J&&J.box&&J.box.length)}}if(de=J,R=de&&de.box&&de.box.length>0,N=de&&de.offscreen,E.useRuntimeCollisionCircles){const zt=h.text.placedSymbolArray.get(E.centerJustifiedTextSymbolIndex),dt=o.evaluateSizeForFeature(h.textSizeData,j,zt),vt=d.get("text-padding");Re=this.collisionIndex.placeCollisionCircles(ue,zt,h.lineVertexArray,h.glyphOffsetArray,dt,x,b,S,l,Te,Y.predicate,E.collisionCircleDiameter,vt,it),Re.circles.length&&Re.collisionDetected&&!l&&o.warnOnce("Collisions detected, but collision boxes are not shown"),R=be||Re.circles.length>0&&!Re.collisionDetected,N=N&&Re.offscreen}if(P.iconFeatureIndex&&(ht=P.iconFeatureIndex),P.iconBox){const zt=dt=>{const vt=Ve&&Q?Rr(dt,Q.x,Q.y,Ge,Te,this.transform.angle):dt;return this.collisionIndex.placeCollisionBox(vt,Ce,M,x,Y.predicate,it)};le&&le.box&&le.box.length&&P.verticalIconBox?($e=zt(P.verticalIconBox),O=$e.box.length>0):($e=zt(P.iconBox),O=$e.box.length>0),N=N&&$e.offscreen}const Je=ae||E.numHorizontalGlyphVertices===0&&E.numVerticalGlyphVertices===0,Gt=ne||E.numIconVertices===0;if(Je||Gt?Gt?Je||(O=O&&R):R=O&&R:O=R=O&&R,R&&de&&de.box&&this.collisionIndex.insertCollisionBox(de.box,ue,d.get("text-ignore-placement"),h.bucketInstanceId,le&&le.box&&Xe?Xe:Be,Y.ID),O&&$e&&this.collisionIndex.insertCollisionBox($e.box,Ce,d.get("icon-ignore-placement"),h.bucketInstanceId,ht,Y.ID),Re&&(R&&this.collisionIndex.insertCollisionCircles(Re.circles,ue,d.get("text-ignore-placement"),h.bucketInstanceId,Be,Y.ID),l)){const zt=h.bucketInstanceId;let dt=this.collisionCircleArrays[zt];dt===void 0&&(dt=this.collisionCircleArrays[zt]=new Ui);for(let vt=0;vt<Re.circles.length;vt+=4)dt.circles.push(Re.circles[vt+0]),dt.circles.push(Re.circles[vt+1]),dt.circles.push(Re.circles[vt+2]),dt.circles.push(Re.collisionDetected?1:0)}if(E.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[E.crossTileID]=new Os(R||y,O||m,N||h.justReloaded),_[E.crossTileID]=!0};if(xe){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const E=h.getSortedSymbolIndexes(this.transform.angle);for(let P=E.length-1;P>=0;--P){const R=E[P];v(h.symbolInstances.get(R),h.collisionArrays[R])}}else for(let E=c.symbolInstanceStart;E<c.symbolInstanceEnd;E++)v(h.symbolInstances.get(E),h.collisionArrays[E]);if(l&&h.bucketInstanceId in this.collisionCircleArrays){const E=this.collisionCircleArrays[h.bucketInstanceId];o.invert(E.invProjMatrix,x),E.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(c,_,l,h){let d;d=h===o.WritingMode.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(_)];const x=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const b of x)b>=0&&(c.text.placedSymbolArray.get(b).crossTileID=d>=0&&b!==d?0:l.crossTileID)}markUsedOrientation(c,_,l){const h=_===o.WritingMode.horizontal||_===o.WritingMode.horizontalOnly?_:0,d=_===o.WritingMode.vertical?_:0,x=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const b of x)c.text.placedSymbolArray.get(b).placedOrientation=h;l.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=d)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const _=this.prevPlacement;let l=!1;this.prevZoomAdjustment=_?_.zoomAdjustment(this.transform.zoom):0;const h=_?_.symbolFadeChange(c):1,d=_?_.opacities:{},x=_?_.variableOffsets:{},b=_?_.placedOrientations:{};for(const S in this.placements){const M=this.placements[S],B=d[S];B?(this.opacities[S]=new Zn(B,h,M.text,M.icon),l=l||M.text!==B.text.placed||M.icon!==B.icon.placed):(this.opacities[S]=new Zn(null,h,M.text,M.icon,M.skipFade),l=l||M.text||M.icon)}for(const S in d){const M=d[S];if(!this.opacities[S]){const B=new Zn(M,h,!1,!1);B.isHidden()||(this.opacities[S]=B,l=l||M.text.placed||M.icon.placed)}}for(const S in x)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=x[S]);for(const S in b)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=b[S]);if(_&&_.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=_?_.lastPlacementChangeTime:c)}updateLayerOpacities(c,_){const l={};for(const h of _){const d=h.getBucket(c);d&&h.latestFeatureIndex&&c.id===d.layerIds[0]&&this.updateBucketOpacities(d,l,h.collisionBoxArray)}}updateBucketOpacities(c,_,l){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const h=c.layers[0].layout,d=new Zn(null,0,!1,!1,!0),x=h.get("text-allow-overlap"),b=h.get("icon-allow-overlap"),S=h.get("text-variable-anchor"),M=h.get("text-rotation-alignment")==="map",B=h.get("text-pitch-alignment")==="map",V=h.get("icon-text-fit")!=="none",j=new Zn(null,0,x&&(b||!c.hasIconData()||h.get("icon-optional")),b&&(x||!c.hasTextData()||h.get("text-optional")),!0);!c.collisionArrays&&l&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(l);const Y=(ae,ne,ue)=>{for(let be=0;be<ne/4;be++)ae.opacityVertexArray.emplaceBack(ue)};for(let ae=0;ae<c.symbolInstances.length;ae++){const ne=c.symbolInstances.get(ae),{numHorizontalGlyphVertices:ue,numVerticalGlyphVertices:be,crossTileID:Ce}=ne;let ve=this.opacities[Ce];_[Ce]?ve=d:ve||(ve=j,this.opacities[Ce]=ve),_[Ce]=!0;const Ge=ne.numIconVertices>0,Te=this.placedOrientations[ne.crossTileID],Ve=Te===o.WritingMode.vertical,xe=Te===o.WritingMode.horizontal||Te===o.WritingMode.horizontalOnly;if(ue>0||be>0){const y=ke(ve.text);Y(c.text,ue,Ve?qe:y),Y(c.text,be,xe?qe:y);const m=ve.text.isHidden();[ne.rightJustifiedTextSymbolIndex,ne.centerJustifiedTextSymbolIndex,ne.leftJustifiedTextSymbolIndex].forEach(P=>{P>=0&&(c.text.placedSymbolArray.get(P).hidden=m||Ve?1:0)}),ne.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(ne.verticalPlacedTextSymbolIndex).hidden=m||xe?1:0);const v=this.variableOffsets[ne.crossTileID];v&&this.markUsedJustification(c,v.anchor,ne,Te);const E=this.placedOrientations[ne.crossTileID];E&&(this.markUsedJustification(c,"left",ne,E),this.markUsedOrientation(c,E,ne))}if(Ge){const y=ke(ve.icon),m=!(V&&ne.verticalPlacedIconSymbolIndex&&Ve);ne.placedIconSymbolIndex>=0&&(Y(c.icon,ne.numIconVertices,m?y:qe),c.icon.placedSymbolArray.get(ne.placedIconSymbolIndex).hidden=ve.icon.isHidden()),ne.verticalPlacedIconSymbolIndex>=0&&(Y(c.icon,ne.numVerticalIconVertices,m?qe:y),c.icon.placedSymbolArray.get(ne.verticalPlacedIconSymbolIndex).hidden=ve.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const y=c.collisionArrays[ae];if(y){let m=new o.pointGeometry(0,0);if(y.textBox||y.verticalTextBox){let E=!0;if(S){const P=this.variableOffsets[Ce];P?(m=os(P.anchor,P.width,P.height,P.textOffset,P.textBoxScale),M&&m._rotate(B?this.transform.angle:-this.transform.angle)):E=!1}y.textBox&&W(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||Ve,m.x,m.y),y.verticalTextBox&&W(c.textCollisionBox.collisionVertexArray,ve.text.placed,!E||xe,m.x,m.y)}const v=!!(!xe&&y.verticalIconBox);y.iconBox&&W(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,v,V?m.x:0,V?m.y:0),y.verticalIconBox&&W(c.iconCollisionBox.collisionVertexArray,ve.icon.placed,!v,V?m.x:0,V?m.y:0)}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);if(c.bucketInstanceId in this.collisionCircleArrays){const ae=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=ae.invProjMatrix,c.placementViewportMatrix=ae.viewportMatrix,c.collisionCircleArray=ae.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,_){const l=this.zoomAtLastRecencyCheck===_?1-this.zoomAdjustment(_):1;return this.zoomAtLastRecencyCheck=_,this.commitTime+this.fadeDuration*l>c}setStale(){this.stale=!0}}function W(L,c,_,l,h){L.emplaceBack(c?1:0,_?1:0,l||0,h||0),L.emplaceBack(c?1:0,_?1:0,l||0,h||0),L.emplaceBack(c?1:0,_?1:0,l||0,h||0),L.emplaceBack(c?1:0,_?1:0,l||0,h||0)}const ee=Math.pow(2,25),he=Math.pow(2,24),a=Math.pow(2,17),G=Math.pow(2,16),Le=Math.pow(2,9),Ie=Math.pow(2,8),Pe=Math.pow(2,1);function ke(L){if(L.opacity===0&&!L.placed)return 0;if(L.opacity===1&&L.placed)return 4294967295;const c=L.placed?1:0,_=Math.floor(127*L.opacity);return _*ee+c*he+_*a+c*G+_*Le+c*Ie+_*Pe+c}const qe=0;class lt{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,_,l,h,d){const x=this._bucketParts;for(;this._currentTileIndex<c.length;)if(_.getBucketParts(x,h,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((b,S)=>b.sortKey-S.sortKey));this._currentPartIndex<x.length;)if(_.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,d())return!0;return!1}}class We{constructor(c,_,l,h,d,x,b,S){this.placement=new K(c,_,x,b,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=d,this._done=!1}isDone(){return this._done}continuePlacement(c,_,l){const h=o.exported.now(),d=()=>{const x=o.exported.now()-h;return!this._forceFullPlacement&&x>2};for(;this._currentPlacementIndex>=0;){const x=_[c[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=b)&&(!x.maxzoom||x.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new lt(x)),this._inProgressLayer.continuePlacement(l[x.source],this.placement,this._showCollisionBoxes,x,d))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const ft=512/o.EXTENT/2;class Dt{constructor(c,_,l){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=l;for(let h=0;h<_.length;h++){const d=_.get(h),x=d.key;this.indexedSymbolInstances[x]||(this.indexedSymbolInstances[x]=[]),this.indexedSymbolInstances[x].push({crossTileID:d.crossTileID,coord:this.getScaledCoordinates(d,c)})}}getScaledCoordinates(c,_){const l=ft/Math.pow(2,_.canonical.z-this.tileID.canonical.z);return{x:Math.floor((_.canonical.x*o.EXTENT+c.anchorX)*l),y:Math.floor((_.canonical.y*o.EXTENT+c.anchorY)*l)}}findMatches(c,_,l){const h=this.tileID.canonical.z<_.canonical.z?1:Math.pow(2,this.tileID.canonical.z-_.canonical.z);for(let d=0;d<c.length;d++){const x=c.get(d);if(x.crossTileID)continue;const b=this.indexedSymbolInstances[x.key];if(!b)continue;const S=this.getScaledCoordinates(x,_);for(const M of b)if(Math.abs(M.coord.x-S.x)<=h&&Math.abs(M.coord.y-S.y)<=h&&!l[M.crossTileID]){l[M.crossTileID]=!0,x.crossTileID=M.crossTileID;break}}}}class Rt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class sn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const _=Math.round((c-this.lng)/360);if(_!==0)for(const l in this.indexes){const h=this.indexes[l],d={};for(const x in h){const b=h[x];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+_),d[b.tileID.key]=b}this.indexes[l]=d}this.lng=c}addBucket(c,_,l){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===_.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let d=0;d<_.symbolInstances.length;d++)_.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const h=this.usedCrossTileIDs[c.overscaledZ];for(const d in this.indexes){const x=this.indexes[d];if(Number(d)>c.overscaledZ)for(const b in x){const S=x[b];S.tileID.isChildOf(c)&&S.findMatches(_.symbolInstances,c,h)}else{const b=x[c.scaledTo(Number(d)).key];b&&b.findMatches(_.symbolInstances,c,h)}}for(let d=0;d<_.symbolInstances.length;d++){const x=_.symbolInstances.get(d);x.crossTileID||(x.crossTileID=l.generate(),h[x.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Dt(c,_.symbolInstances,_.bucketInstanceId),!0}removeBucketCrossTileIDs(c,_){for(const l in _.indexedSymbolInstances)for(const h of _.indexedSymbolInstances[l])delete this.usedCrossTileIDs[c][h.crossTileID]}removeStaleBuckets(c){let _=!1;for(const l in this.indexes){const h=this.indexes[l];for(const d in h)c[h[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,h[d]),delete h[d],_=!0)}return _}}class jt{constructor(){this.layerIndexes={},this.crossTileIDs=new Rt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,_,l){let h=this.layerIndexes[c.id];h===void 0&&(h=this.layerIndexes[c.id]=new sn);let d=!1;const x={};h.handleWrapJump(l);for(const b of _){const S=b.getBucket(c);S&&c.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(b.tileID,S,this.crossTileIDs)&&(d=!0),x[S.bucketInstanceId]=!0)}return h.removeStaleBuckets(x)&&(d=!0),d}pruneUnusedLayers(c){const _={};c.forEach(l=>{_[l]=!0});for(const l in this.layerIndexes)_[l]||delete this.layerIndexes[l]}}var pn=o.createLayout([{name:"a_pos",type:"Int16",components:2}]);class qt extends o.Evented{constructor(c){super(),this.sourceCache=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=c._cache.max,c.usedForTerrain=!0,c.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const c in this._tiles){const _=this._tiles[c];_.textures.forEach(l=>l.destroy()),_.textures=[]}}update(c,_){this.sourceCache.update(c,_),this._renderableTilesKeys=[];for(const l of c.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:_}))this._renderableTilesKeys.push(l.key),this._tiles[l.key]||(l.posMatrix=new Float64Array(16),o.ortho(l.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),this._tiles[l.key]=new ur(l,this.tileSize))}removeOutdated(c){const _={};this.renderHistory=this.renderHistory.filter((l,h)=>this.renderHistory.indexOf(l)===h).slice(0,this.renderHistorySize);for(const l of this._renderableTilesKeys)_[l]=!0;for(const l of this.renderHistory)_[l]=!0;for(const l in this._tiles)_[l]||(this._tiles[l].clearTextures(c),delete this._tiles[l])}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c){const _={};for(const l of this._renderableTilesKeys){const h=this._tiles[l].tileID;if(h.canonical.equals(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16),o.ortho(d.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),_[l]=d}else if(h.canonical.isChildOf(c.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const x=h.canonical.z-c.canonical.z,b=h.canonical.x-(h.canonical.x>>x<<x),S=h.canonical.y-(h.canonical.y>>x<<x),M=o.EXTENT>>x;o.ortho(d.posMatrix,0,M,0,M,0,1),o.translate(d.posMatrix,d.posMatrix,[-b*M,-S*M,0]),_[l]=d}else if(c.canonical.isChildOf(h.canonical)){const d=c.clone();d.posMatrix=new Float64Array(16);const x=c.canonical.z-h.canonical.z,b=c.canonical.x-(c.canonical.x>>x<<x),S=c.canonical.y-(c.canonical.y>>x<<x),M=o.EXTENT>>x;o.ortho(d.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),o.translate(d.posMatrix,d.posMatrix,[b*M,S*M,0]),o.scale(d.posMatrix,d.posMatrix,[1/2**x,1/2**x,0]),_[l]=d}}return _}getSourceTile(c,_){const l=this.sourceCache._source;let h=c.overscaledZ-this.deltaZoom;if(h>l.maxzoom&&(h=l.maxzoom),h<l.minzoom)return null;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(h).key);let d=this.sourceCache.getTileByID(this._sourceTileCache[c.key]);if((!d||!d.dem)&&_)for(;h>=l.minzoom&&(!d||!d.dem);)d=this.sourceCache.getTileByID(c.scaledTo(h--).key);return d}tilesAfterTime(c=Date.now()){return Object.values(this._tiles).filter(_=>_.timeLoaded>=c)}}class an{constructor(c,_,l){this.style=c,this.sourceCache=new qt(_),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.elevationOffset=typeof l.elevationOffset=="number"?l.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(c,_,l,h=o.EXTENT){if(!(_>=0&&_<h&&l>=0&&l<h))return this.elevationOffset;let d=0;const x=this.getTerrainData(c);if(x.tile&&x.tile.dem){const b=o.transformMat4$1([],[_/h*o.EXTENT,l/h*o.EXTENT],x.u_terrain_matrix),S=[b[0]*x.tile.dem.dim,b[1]*x.tile.dem.dim],M=[Math.floor(S[0]),Math.floor(S[1])],B=x.tile.dem.get(M[0],M[1]),V=x.tile.dem.get(M[0],M[1]+1),j=x.tile.dem.get(M[0]+1,M[1]),Y=x.tile.dem.get(M[0]+1,M[1]+1);d=o.number(o.number(B,V,S[0]-M[0]),o.number(j,Y,S[0]-M[0]),S[1]-M[1])}return d}rememberForRerender(c,_){for(const l in this.sourceCache._tiles){const h=this.sourceCache._tiles[l];(h.tileID.equals(_)||h.tileID.isChildOf(_))&&(c===this.sourceCache.sourceCache.id&&(h.timeLoaded=Date.now()),this._rerender[c]=this._rerender[c]||{},this._rerender[c][h.tileID.key]=!0)}}needsRerender(c,_){return this._rerender[c]&&this._rerender[c][_.key]}clearRerenderCache(){this._rerender={}}getElevation(c,_,l,h=o.EXTENT){return(this.getDEMElevation(c,_,l,h)+this.elevationOffset)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){const h=this.style.map.painter.context,d=new o.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new q(h,d,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new q(h,new o.RGBAImage({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.identity([])}const _=this.sourceCache.getSourceTile(c,!0);if(_&&_.dem&&(!_.demTexture||_.needsTerrainPrepare)){const h=this.style.map.painter.context;_.demTexture=this.style.map.painter.getTileTexture(_.dem.stride),_.demTexture?_.demTexture.update(_.dem.getPixels(),{premultiply:!1}):_.demTexture=new q(h,_.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),_.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),_.needsTerrainPrepare=!1}const l=_&&_+_.tileID.key+c.key;if(l&&!this._demMatrixCache[l]){const h=this.sourceCache.sourceCache._source.maxzoom;let d=c.canonical.z-_.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=h?d=c.canonical.z-h:o.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=c.canonical.x-(c.canonical.x>>d<<d),b=c.canonical.y-(c.canonical.y>>d<<d),S=o.fromScaling(new Float64Array(16),[1/(o.EXTENT<<d),1/(o.EXTENT<<d),0]);o.translate(S,S,[x*o.EXTENT,b*o.EXTENT,0]),this._demMatrixCache[c.key]={matrix:S,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:_&&_.dem&&_.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:_&&_.dem&&_.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(_&&_.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:_}}getRTTFramebuffer(){const c=this.style.map.painter;if(!this._rttFramebuffer){const _=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=c.context.createFramebuffer(_,_,!0),this._rttFramebuffer.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,_,_))}return this._rttFramebuffer}getFramebuffer(c){const _=this.style.map.painter,l=_.width/devicePixelRatio,h=_.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new q(_.context,{width:l,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new q(_.context,{width:l,height:h,data:null},_.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(_.context.gl.NEAREST,_.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=_.context.createFramebuffer(l,h,!0),this._fbo.depthAttachment.set(_.context.createRenderbuffer(_.context.gl.DEPTH_COMPONENT16,l,h))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const c=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const _=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let d=0,x=0;d<this._coordsTextureSize;d++)for(let b=0;b<this._coordsTextureSize;b++,x+=4)_[x+0]=255&b,_[x+1]=255&d,_[x+2]=b>>8<<4|d>>8,_[x+3]=0;const l=new o.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(_.buffer)),h=new q(c,l,c.gl.RGBA,{premultiply:!1});return h.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(c){const _=new Uint8Array(4),l=this.style.map.painter,h=l.context,d=h.gl;h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(c.x,l.height/devicePixelRatio-c.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,_),h.bindFramebuffer.set(null);const x=_[0]+(_[2]>>4<<8),b=_[1]+((15&_[2])<<8),S=this.coordsIndex[255-_[3]],M=S&&this.sourceCache.getTileByID(S);if(!M)return null;const B=this._coordsTextureSize,V=(1<<M.tileID.canonical.z)*B;return new o.MercatorCoordinate((M.tileID.canonical.x*B+x)/V,(M.tileID.canonical.y*B+b)/V,this.getElevation(M.tileID,x,b,B))}getTerrainMesh(){if(this._mesh)return this._mesh;const c=this.style.map.painter.context,_=new o.PosArray,l=new o.TriangleIndexArray,h=this.meshSize,d=o.EXTENT/h,x=h*h;for(let b=0;b<=h;b++)for(let S=0;S<=h;S++)_.emplaceBack(S*d,b*d);for(let b=0;b<x;b+=h+1)for(let S=0;S<h;S++)l.emplaceBack(S+b,h+S+b+1,h+S+b+2),l.emplaceBack(S+b,h+S+b+2,S+b+1);return this._mesh={indexBuffer:c.createIndexBuffer(l),vertexBuffer:c.createVertexBuffer(_,pn.members),segments:o.SegmentVector.simpleSegment(0,0,_.length,l.length)},this._mesh}getMinMaxElevation(c){const _=this.getTerrainData(c).tile,l={minElevation:null,maxElevation:null};return _&&_.dem&&(l.minElevation=(_.dem.min+this.elevationOffset)*this.exaggeration,l.maxElevation=(_.dem.max+this.elevationOffset)*this.exaggeration),l}}const xn=(L,c)=>o.emitValidationErrors(L,c&&c.filter(_=>_.identifier!=="source.canvas")),Ft=o.pick(Vn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Oe=o.pick(Vn,["setCenter","setZoom","setBearing","setPitch"]),Ct=function(){const L={},c=o.spec.$version;for(const _ in o.spec.$root){const l=o.spec.$root[_];if(l.required){let h=null;h=_==="version"?c:l.type==="array"?[]:{},h!=null&&(L[_]=h)}}return L}();class Me extends o.Evented{constructor(c,_={}){super(),this.map=c,this.dispatcher=new nt(or(),this),this.imageManager=new X,this.imageManager.setEventedParent(this),this.glyphManager=new me(c._requestManager,_.localIdeographFontFamily),this.lineAtlas=new Ke(256,512),this.crossTileSymbolIndex=new jt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const l=this;this._rtlTextPluginCallback=Me.registerForPluginStateChange(h=>{l.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:h.pluginStatus,pluginURL:h.pluginURL},(d,x)=>{if(o.triggerPluginCompletionEvent(d),x&&x.every(b=>b))for(const b in l.sourceCaches)l.sourceCaches[b].reload()})}),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const x=d.getSource();if(x&&x.vectorLayerIds)for(const b in this._layers){const S=this._layers[b];S.source===x.id&&this._validateLayer(S)}})}loadURL(c,_={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const l=typeof _.validate!="boolean"||_.validate,h=this.map._requestManager.transformRequest(c,o.ResourceType.Style);this._request=o.getJSON(h,(d,x)=>{this._request=null,d?this.fire(new o.ErrorEvent(d)):x&&this._load(x,l)})}loadJSON(c,_={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(c,_.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Ct,!1)}_load(c,_){if(_&&xn(this,o.validateStyle(c)))return;this._loaded=!0,this.stylesheet=c;for(const h in c.sources)this.addSource(h,c.sources[h],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);const l=Kr(this.stylesheet.layers);this._order=l.map(h=>h.id),this._layers={},this._serializedLayers={};for(let h of l)h=o.createStyleLayer(h),h.setEventedParent(this,{layer:{id:h.id}}),this._layers[h.id]=h,this._serializedLayers[h.id]=h.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Qe(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}_loadSprite(c){this._spriteRequest=function(_,l,h,d){let x,b,S;const M=h>1?"@2x":"";let B=o.getJSON(l.transformRequest(l.normalizeSpriteURL(_,M,".json"),o.ResourceType.SpriteJSON),(Y,ae)=>{B=null,S||(S=Y,x=ae,j())}),V=o.getImage(l.transformRequest(l.normalizeSpriteURL(_,M,".png"),o.ResourceType.SpriteImage),(Y,ae)=>{V=null,S||(S=Y,b=ae,j())});function j(){if(S)d(S);else if(x&&b){const Y=o.exported.getImageData(b),ae={};for(const ne in x){const{width:ue,height:be,x:Ce,y:ve,sdf:Ge,pixelRatio:Te,stretchX:Ve,stretchY:xe,content:y}=x[ne],m=new o.RGBAImage({width:ue,height:be});o.RGBAImage.copy(Y,m,{x:Ce,y:ve},{x:0,y:0},{width:ue,height:be}),ae[ne]={data:m,pixelRatio:Te,sdf:Ge,stretchX:Ve,stretchY:xe,content:y}}d(null,ae)}}return{cancel(){B&&(B.cancel(),B=null),V&&(V.cancel(),V=null)}}}(c,this.map._requestManager,this.map.getPixelRatio(),(_,l)=>{if(this._spriteRequest=null,_)this.fire(new o.ErrorEvent(_));else if(l)for(const h in l)this.imageManager.addImage(h,l[h]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(c){const _=this.sourceCaches[c.source];if(!_)return;const l=c.sourceLayer;if(!l)return;const h=_.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(l)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${l}" does not exist on source "${h.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const _=[];for(const l of c){const h=this._layers[l];h.type!=="custom"&&_.push(h.serialize())}return _}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;const _=this._changed;if(this._changed){const h=Object.keys(this._updatedLayers),d=Object.keys(this._removedLayers);(h.length||d.length)&&this._updateWorkerLayers(h,d);for(const x in this._updatedSources){const b=this._updatedSources[x];if(b==="reload")this._reloadSource(x);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(x)}}this._updateTilesForChangedImages();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}const l={};for(const h in this.sourceCaches){const d=this.sourceCaches[h];l[h]=d.used,d.used=!1}for(const h of this._order){const d=this._layers[h];d.recalculate(c,this._availableImages),!d.isHidden(c.zoom)&&d.source&&(this.sourceCaches[d.source].used=!0)}for(const h in l){const d=this.sourceCaches[h];l[h]!==d.used&&d.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(c),this.z=c.zoom,_&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const _ in this.sourceCaches)this.sourceCaches[_].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,_){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:_})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(c){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),c){const _=this.sourceCaches[c.source];if(!_)throw new Error(`cannot load terrain, because there exists no source with ID: ${c.source}`);this.terrain=new an(this,_,c),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=l=>{l.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=l=>{l.tile&&(l.sourceId===c.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(l.sourceId,l.tile.tileID)):l.source.type==="geojson"&&this.terrain.rememberForRerender(l.sourceId,l.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new o.Event("terrain",{terrain:c}))}setState(c){if(this._checkLoaded(),xn(this,o.validateStyle(c)))return!1;(c=o.clone$1(c)).layers=Kr(c.layers);const _=function(h,d){if(!h)return[{command:Vn.setStyle,args:[d]}];let x=[];try{if(!I(h.version,d.version))return[{command:Vn.setStyle,args:[d]}];I(h.center,d.center)||x.push({command:Vn.setCenter,args:[d.center]}),I(h.zoom,d.zoom)||x.push({command:Vn.setZoom,args:[d.zoom]}),I(h.bearing,d.bearing)||x.push({command:Vn.setBearing,args:[d.bearing]}),I(h.pitch,d.pitch)||x.push({command:Vn.setPitch,args:[d.pitch]}),I(h.sprite,d.sprite)||x.push({command:Vn.setSprite,args:[d.sprite]}),I(h.glyphs,d.glyphs)||x.push({command:Vn.setGlyphs,args:[d.glyphs]}),I(h.transition,d.transition)||x.push({command:Vn.setTransition,args:[d.transition]}),I(h.light,d.light)||x.push({command:Vn.setLight,args:[d.light]});const b={},S=[];(function(B,V,j,Y){let ae;for(ae in V=V||{},B=B||{})Object.prototype.hasOwnProperty.call(B,ae)&&(Object.prototype.hasOwnProperty.call(V,ae)||Wn(ae,j,Y));for(ae in V)Object.prototype.hasOwnProperty.call(V,ae)&&(Object.prototype.hasOwnProperty.call(B,ae)?I(B[ae],V[ae])||(B[ae].type==="geojson"&&V[ae].type==="geojson"&&fo(B,V,ae)?j.push({command:Vn.setGeoJSONSourceData,args:[ae,V[ae].data]}):Fi(ae,V,j,Y)):Si(ae,V,j))})(h.sources,d.sources,S,b);const M=[];h.layers&&h.layers.forEach(B=>{b[B.source]?x.push({command:Vn.removeLayer,args:[B.id]}):M.push(B)}),x=x.concat(S),function(B,V,j){V=V||[];const Y=(B=B||[]).map(Mi),ae=V.map(Mi),ne=B.reduce(Oo,{}),ue=V.reduce(Oo,{}),be=Y.slice(),Ce=Object.create(null);let ve,Ge,Te,Ve,xe,y,m;for(ve=0,Ge=0;ve<Y.length;ve++)Te=Y[ve],Object.prototype.hasOwnProperty.call(ue,Te)?Ge++:(j.push({command:Vn.removeLayer,args:[Te]}),be.splice(be.indexOf(Te,Ge),1));for(ve=0,Ge=0;ve<ae.length;ve++)Te=ae[ae.length-1-ve],be[be.length-1-ve]!==Te&&(Object.prototype.hasOwnProperty.call(ne,Te)?(j.push({command:Vn.removeLayer,args:[Te]}),be.splice(be.lastIndexOf(Te,be.length-Ge),1)):Ge++,y=be[be.length-ve],j.push({command:Vn.addLayer,args:[ue[Te],y]}),be.splice(be.length-ve,0,Te),Ce[Te]=!0);for(ve=0;ve<ae.length;ve++)if(Te=ae[ve],Ve=ne[Te],xe=ue[Te],!Ce[Te]&&!I(Ve,xe))if(I(Ve.source,xe.source)&&I(Ve["source-layer"],xe["source-layer"])&&I(Ve.type,xe.type)){for(m in Fr(Ve.layout,xe.layout,j,Te,null,Vn.setLayoutProperty),Fr(Ve.paint,xe.paint,j,Te,null,Vn.setPaintProperty),I(Ve.filter,xe.filter)||j.push({command:Vn.setFilter,args:[Te,xe.filter]}),I(Ve.minzoom,xe.minzoom)&&I(Ve.maxzoom,xe.maxzoom)||j.push({command:Vn.setLayerZoomRange,args:[Te,xe.minzoom,xe.maxzoom]}),Ve)Object.prototype.hasOwnProperty.call(Ve,m)&&m!=="layout"&&m!=="paint"&&m!=="filter"&&m!=="metadata"&&m!=="minzoom"&&m!=="maxzoom"&&(m.indexOf("paint.")===0?Fr(Ve[m],xe[m],j,Te,m.slice(6),Vn.setPaintProperty):I(Ve[m],xe[m])||j.push({command:Vn.setLayerProperty,args:[Te,m,xe[m]]}));for(m in xe)Object.prototype.hasOwnProperty.call(xe,m)&&!Object.prototype.hasOwnProperty.call(Ve,m)&&m!=="layout"&&m!=="paint"&&m!=="filter"&&m!=="metadata"&&m!=="minzoom"&&m!=="maxzoom"&&(m.indexOf("paint.")===0?Fr(Ve[m],xe[m],j,Te,m.slice(6),Vn.setPaintProperty):I(Ve[m],xe[m])||j.push({command:Vn.setLayerProperty,args:[Te,m,xe[m]]}))}else j.push({command:Vn.removeLayer,args:[Te]}),y=be[be.lastIndexOf(Te)+1],j.push({command:Vn.addLayer,args:[xe,y]})}(M,d.layers,x)}catch(b){console.warn("Unable to compute style diff:",b),x=[{command:Vn.setStyle,args:[d]}]}return x}(this.serialize(),c).filter(h=>!(h.command in Oe));if(_.length===0)return!1;const l=_.filter(h=>!(h.command in Ft));if(l.length>0)throw new Error(`Unimplemented: ${l.map(h=>h.command).join(", ")}.`);return _.forEach(h=>{h.command!=="setTransition"&&this[h.command].apply(this,h.args)}),this.stylesheet=c,!0}addImage(c,_){if(this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,_),this._afterImageUpdated(c)}updateImage(c,_){this.imageManager.updateImage(c,_)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,_,l={}){if(this._checkLoaded(),this.sourceCaches[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!_.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(_).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(_.type)>=0&&this._validate(o.validateStyle.source,`sources.${c}`,_,null,l))return;this.map&&this.map._collectResourceTiming&&(_.collectResourceTiming=!0);const h=this.sourceCaches[c]=new wt(c,_,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:h.serialize(),sourceId:c})),h.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===c)return this.fire(new o.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${l}" is using it.`)));const _=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],_.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),_.setEventedParent(null),_.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,_){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error(`There is no source with this ID=${c}`);const l=this.sourceCaches[c].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(_),this._changed=!0}getSource(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()}addLayer(c,_,l={}){this._checkLoaded();const h=c.id;if(this.getLayer(h))return void this.fire(new o.ErrorEvent(new Error(`Layer "${h}" already exists on this map.`)));let d;if(c.type==="custom"){if(xn(this,o.validateCustomStyleLayer(c)))return;d=o.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(h,c.source),c=o.clone$1(c),c=o.extend(c,{source:h})),this._validate(o.validateStyle.layer,`layers.${h}`,c,{arrayIndex:-1},l))return;d=o.createStyleLayer(c),this._validateLayer(d),d.setEventedParent(this,{layer:{id:h}}),this._serializedLayers[d.id]=d.serialize()}const x=_?this._order.indexOf(_):this._order.length;if(_&&x===-1)this.fire(new o.ErrorEvent(new Error(`Cannot add layer "${h}" before non-existing layer "${_}".`)));else{if(this._order.splice(x,0,h),this._layerOrderChanged=!0,this._layers[h]=d,this._removedLayers[h]&&d.source&&d.type!=="custom"){const b=this._removedLayers[h];delete this._removedLayers[h],b.type!==d.type?this._updatedSources[d.source]="clear":(this._updatedSources[d.source]="reload",this.sourceCaches[d.source].pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map)}}moveLayer(c,_){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===_)return;const l=this._order.indexOf(c);this._order.splice(l,1);const h=_?this._order.indexOf(_):this._order.length;_&&h===-1?this.fire(new o.ErrorEvent(new Error(`Cannot move layer "${c}" before non-existing layer "${_}".`))):(this._order.splice(h,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();const _=this._layers[c];if(!_)return void this.fire(new o.ErrorEvent(new Error(`Cannot remove non-existing layer "${c}".`)));_.setEventedParent(null);const l=this._order.indexOf(c);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=_,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],_.onRemove&&_.onRemove(this.map)}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,_,l){this._checkLoaded();const h=this.getLayer(c);h?h.minzoom===_&&h.maxzoom===l||(_!=null&&(h.minzoom=_),l!=null&&(h.maxzoom=l),this._updateLayer(h)):this.fire(new o.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,_,l={}){this._checkLoaded();const h=this.getLayer(c);if(h){if(!I(h.filter,_))return _==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(o.validateStyle.filter,`layers.${h.id}.filter`,_,null,l)||(h.filter=o.clone$1(_),this._updateLayer(h)))}else this.fire(new o.ErrorEvent(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return o.clone$1(this.getLayer(c).filter)}setLayoutProperty(c,_,l,h={}){this._checkLoaded();const d=this.getLayer(c);d?I(d.getLayoutProperty(_),l)||(d.setLayoutProperty(_,l,h),this._updateLayer(d)):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,_){const l=this.getLayer(c);if(l)return l.getLayoutProperty(_);this.fire(new o.ErrorEvent(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,_,l,h={}){this._checkLoaded();const d=this.getLayer(c);d?I(d.getPaintProperty(_),l)||(d.setPaintProperty(_,l,h)&&this._updateLayer(d),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getPaintProperty(c,_){return this.getLayer(c).getPaintProperty(_)}setFeatureState(c,_){this._checkLoaded();const l=c.source,h=c.sourceLayer,d=this.sourceCaches[l];if(d===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)));const x=d.getSource().type;x==="geojson"&&h?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||h?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),d.setFeatureState(h,c.id,_)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,_){this._checkLoaded();const l=c.source,h=this.sourceCaches[l];if(h===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)));const d=h.getSource().type,x=d==="vector"?c.sourceLayer:void 0;d!=="vector"||x?_&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(x,c.id,_):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();const _=c.source,l=c.sourceLayer,h=this.sourceCaches[_];if(h!==void 0)return h.getSource().type!=="vector"||l?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),h.getFeatureState(l,c.id)):void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,c=>c.serialize()),layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.sourceCaches[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(c){const _=x=>this._layers[x].type==="fill-extrusion",l={},h=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(_(b)){l[b]=x;for(const S of c){const M=S[b];if(M)for(const B of M)h.push(B)}}}h.sort((x,b)=>b.intersectionZ-x.intersectionZ);const d=[];for(let x=this._order.length-1;x>=0;x--){const b=this._order[x];if(_(b))for(let S=h.length-1;S>=0;S--){const M=h[S].feature;if(l[M.layer.id]<x)break;d.push(M),h.pop()}else for(const S of c){const M=S[b];if(M)for(const B of M)d.push(B.feature)}}return d}queryRenderedFeatures(c,_,l){_&&_.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",_.filter,null,_);const h={};if(_&&_.layers){if(!Array.isArray(_.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const x of _.layers){const b=this._layers[x];if(!b)return this.fire(new o.ErrorEvent(new Error(`The layer '${x}' does not exist in the map's style and cannot be queried for features.`))),[];h[b.source]=!0}}const d=[];_.availableImages=this._availableImages;for(const x in this.sourceCaches)_.layers&&!h[x]||d.push(Jn(this.sourceCaches[x],this._layers,this._serializedLayers,c,_,l));return this.placement&&d.push(function(x,b,S,M,B,V,j){const Y={},ae=V.queryRenderedSymbols(M),ne=[];for(const ue of Object.keys(ae).map(Number))ne.push(j[ue]);ne.sort(ir);for(const ue of ne){const be=ue.featureIndex.lookupSymbolFeatures(ae[ue.bucketInstanceId],b,ue.bucketIndex,ue.sourceLayerIndex,B.filter,B.layers,B.availableImages,x);for(const Ce in be){const ve=Y[Ce]=Y[Ce]||[],Ge=be[Ce];Ge.sort((Te,Ve)=>{const xe=ue.featureSortOrder;if(xe){const y=xe.indexOf(Te.featureIndex);return xe.indexOf(Ve.featureIndex)-y}return Ve.featureIndex-Te.featureIndex});for(const Te of Ge)ve.push(Te)}}for(const ue in Y)Y[ue].forEach(be=>{const Ce=be.feature,ve=S[x[ue].source].getFeatureState(Ce.layer["source-layer"],Ce.id);Ce.source=Ce.layer.source,Ce.layer["source-layer"]&&(Ce.sourceLayer=Ce.layer["source-layer"]),Ce.state=ve});return Y}(this._layers,this._serializedLayers,this.sourceCaches,c,_,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(c,_){_&&_.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",_.filter,null,_);const l=this.sourceCaches[c];return l?function(h,d){const x=h.getRenderableIds().map(M=>h.getTileByID(M)),b=[],S={};for(let M=0;M<x.length;M++){const B=x[M],V=B.tileID.canonical.key;S[V]||(S[V]=!0,B.querySourceFeatures(b,d))}return b}(l,_):[]}addSourceType(c,_,l){return Me.getSourceType(c)?l(new Error(`A source type called "${c}" already exists.`)):(Me.setSourceType(c,_),_.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:_.workerSourceURL},l):l(null,null))}getLight(){return this.light.getLight()}setLight(c,_={}){this._checkLoaded();const l=this.light.getLight();let h=!1;for(const x in c)if(!I(c[x],l[x])){h=!0;break}if(!h)return;const d={now:o.exported.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,_),this.light.updateTransitions(d)}_validate(c,_,l,h,d={}){return(!d||d.validate!==!1)&&xn(this,c.call(o.validateStyle,o.extend({key:_,style:this.serialize(),value:l,styleSpec:o.spec},h)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const _=this.sourceCaches[c];_.setEventedParent(null),_.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){this.sourceCaches[c].clearTiles()}_reloadSource(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()}_updateSources(c){for(const _ in this.sourceCaches)this.sourceCaches[_].update(c,this.terrain)}_generateCollisionBoxes(){for(const c in this.sourceCaches)this._reloadSource(c)}_updatePlacement(c,_,l,h,d=!1){let x=!1,b=!1;const S={};for(const M of this._order){const B=this._layers[M];if(B.type!=="symbol")continue;if(!S[B.source]){const j=this.sourceCaches[B.source];S[B.source]=j.getRenderableIds(!0).map(Y=>j.getTileByID(Y)).sort((Y,ae)=>ae.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(ae.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(B,S[B.source],c.center.lng);x=x||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((d=d||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),c.zoom))&&(this.pauseablePlacement=new We(c,this.terrain,this._order,d,_,l,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),b=!0),x&&this.pauseablePlacement.placement.setStale()),b||x)for(const M of this._order){const B=this._layers[M];B.type==="symbol"&&this.placement.updateLayerOpacities(B,S[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,_,l){this.imageManager.getImages(_.icons,l),this._updateTilesForChangedImages();const h=this.sourceCaches[_.source];h&&h.setDependencies(_.tileID.key,_.type,_.icons)}getGlyphs(c,_,l){this.glyphManager.getGlyphs(_.stacks,l)}getResource(c,_,l){return o.makeRequest(_,l)}}Me.getSourceType=function(L){return Tn[L]},Me.setSourceType=function(L,c){Tn[L]=c},Me.registerForPluginStateChange=o.registerForPluginStateChange;var un="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const ai={prelude:nr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:nr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:nr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:nr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:nr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:nr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:nr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:nr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:nr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:nr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:nr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:nr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:nr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:nr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:nr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:nr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:nr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:nr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:nr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:nr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:nr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:nr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:nr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:nr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:nr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:nr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:nr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",un),terrainDepth:nr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",un),terrainCoords:nr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",un)};function nr(L,c){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=c.match(/attribute ([\w]+) ([\w]+)/g),h=L.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),d=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=d?d.concat(h):h,b={};return{fragmentSource:L=L.replace(_,(S,M,B,V,j)=>(b[j]=!0,M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
varying ${B} ${V} ${j};
#else
uniform ${B} ${V} u_${j};
#endif
`:`
#ifdef HAS_UNIFORM_u_${j}
    ${B} ${V} ${j} = u_${j};
#endif
`)),vertexSource:c=c.replace(_,(S,M,B,V,j)=>{const Y=V==="float"?"vec2":"vec4",ae=j.match(/color/)?"color":Y;return b[j]?M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${B} ${Y} a_${j};
varying ${B} ${V} ${j};
#else
uniform ${B} ${V} u_${j};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = a_${j};
#else
    ${B} ${V} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${j} = unpack_mix_${ae}(a_${j}, u_${j}_t);
#else
    ${B} ${V} ${j} = u_${j};
#endif
`:M==="define"?`
#ifndef HAS_UNIFORM_u_${j}
uniform lowp float u_${j}_t;
attribute ${B} ${Y} a_${j};
#else
uniform ${B} ${V} u_${j};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${j}
    ${B} ${V} ${j} = a_${j};
#else
    ${B} ${V} ${j} = u_${j};
#endif
`:`
#ifndef HAS_UNIFORM_u_${j}
    ${B} ${V} ${j} = unpack_mix_${ae}(a_${j}, u_${j}_t);
#else
    ${B} ${V} ${j} = u_${j};
#endif
`}),staticAttributes:l,staticUniforms:x}}class aa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,_,l,h,d,x,b,S,M){this.context=c;let B=this.boundPaintVertexBuffers.length!==h.length;for(let V=0;!B&&V<h.length;V++)this.boundPaintVertexBuffers[V]!==h[V]&&(B=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===_&&this.boundLayoutVertexBuffer===l&&!B&&this.boundIndexBuffer===d&&this.boundVertexOffset===x&&this.boundDynamicVertexBuffer===b&&this.boundDynamicVertexBuffer2===S&&this.boundDynamicVertexBuffer3===M?(c.bindVertexArrayOES.set(this.vao),b&&b.bind(),d&&d.dynamicDraw&&d.bind(),S&&S.bind(),M&&M.bind()):this.freshBind(_,l,h,d,x,b,S,M)}freshBind(c,_,l,h,d,x,b,S){let M;const B=c.numAttributes,V=this.context,j=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),M=0,this.boundProgram=c,this.boundLayoutVertexBuffer=_,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=h,this.boundVertexOffset=d,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=S;else{M=V.currentNumAttributes||0;for(let Y=B;Y<M;Y++)j.disableVertexAttribArray(Y)}_.enableAttributes(j,c);for(const Y of l)Y.enableAttributes(j,c);x&&x.enableAttributes(j,c),b&&b.enableAttributes(j,c),S&&S.enableAttributes(j,c),_.bind(),_.setVertexAttribPointers(j,c,d);for(const Y of l)Y.bind(),Y.setVertexAttribPointers(j,c,d);x&&(x.bind(),x.setVertexAttribPointers(j,c,d)),h&&h.bind(),b&&(b.bind(),b.setVertexAttribPointers(j,c,d)),S&&(S.bind(),S.setVertexAttribPointers(j,c,d)),V.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function De(L){const c=[];for(let _=0;_<L.length;_++){if(L[_]===null)continue;const l=L[_].split(" ");c.push(l.pop())}return c}class za{constructor(c,_,l,h,d,x,b){const S=c.gl;this.program=S.createProgram();const M=De(l.staticAttributes),B=h?h.getBinderAttributes():[],V=M.concat(B),j=ai.prelude.staticUniforms?De(ai.prelude.staticUniforms):[],Y=l.staticUniforms?De(l.staticUniforms):[],ae=h?h.getBinderUniforms():[],ne=j.concat(Y).concat(ae),ue=[];for(const xe of ne)ue.indexOf(xe)<0&&ue.push(xe);const be=h?h.defines():[];x&&be.push("#define OVERDRAW_INSPECTOR;"),b&&be.push("#define TERRAIN3D;");const Ce=be.concat(ai.prelude.fragmentSource,l.fragmentSource).join(`
`),ve=be.concat(ai.prelude.vertexSource,l.vertexSource).join(`
`),Ge=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(Ge,Ce),S.compileShader(Ge),S.attachShader(this.program,Ge);const Te=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(Te,ve),S.compileShader(Te),S.attachShader(this.program,Te),this.attributes={};const Ve={};this.numAttributes=V.length;for(let xe=0;xe<this.numAttributes;xe++)V[xe]&&(S.bindAttribLocation(this.program,xe,V[xe]),this.attributes[V[xe]]=xe);S.linkProgram(this.program),S.deleteShader(Te),S.deleteShader(Ge);for(let xe=0;xe<ue.length;xe++){const y=ue[xe];if(y&&!Ve[y]){const m=S.getUniformLocation(this.program,y);m&&(Ve[y]=m)}}this.fixedUniforms=d(c,Ve),this.terrainUniforms=((xe,y)=>({u_depth:new o.Uniform1i(xe,y.u_depth),u_terrain:new o.Uniform1i(xe,y.u_terrain),u_terrain_dim:new o.Uniform1f(xe,y.u_terrain_dim),u_terrain_matrix:new o.UniformMatrix4f(xe,y.u_terrain_matrix),u_terrain_unpack:new o.Uniform4f(xe,y.u_terrain_unpack),u_terrain_offset:new o.Uniform1f(xe,y.u_terrain_offset),u_terrain_exaggeration:new o.Uniform1f(xe,y.u_terrain_exaggeration)}))(c,Ve),this.binderUniforms=h?h.getUniforms(c,Ve):[]}draw(c,_,l,h,d,x,b,S,M,B,V,j,Y,ae,ne,ue,be,Ce){const ve=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(l),c.setStencilMode(h),c.setColorMode(d),c.setCullFace(x),S){c.activeTexture.set(ve.TEXTURE2),ve.bindTexture(ve.TEXTURE_2D,S.depthTexture),c.activeTexture.set(ve.TEXTURE3),ve.bindTexture(ve.TEXTURE_2D,S.texture);for(const Te in this.terrainUniforms)this.terrainUniforms[Te].set(S[Te])}for(const Te in this.fixedUniforms)this.fixedUniforms[Te].set(b[Te]);ne&&ne.setUniforms(c,this.binderUniforms,Y,{zoom:ae});let Ge=0;switch(_){case ve.LINES:Ge=2;break;case ve.TRIANGLES:Ge=3;break;case ve.LINE_STRIP:Ge=1}for(const Te of j.get()){const Ve=Te.vaos||(Te.vaos={});(Ve[M]||(Ve[M]=new aa)).bind(c,this,B,ne?ne.getPaintVertexBuffers():[],V,Te.vertexOffset,ue,be,Ce),ve.drawElements(_,Te.primitiveLength*Ge,ve.UNSIGNED_SHORT,Te.primitiveOffset*Ge*2)}}}function we(L,c,_){const l=1/Dr(_,1,c.transform.tileZoom),h=Math.pow(2,_.tileID.overscaledZ),d=_.tileSize*Math.pow(2,c.transform.tileZoom)/h,x=d*(_.tileID.canonical.x+_.tileID.wrap*h),b=d*_.tileID.canonical.y;return{u_image:0,u_texsize:_.imageAtlasTexture.size,u_scale:[l,L.fromScale,L.toScale],u_fade:L.t,u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}}const Fo=(L,c,_,l)=>{const h=c.style.light,d=h.properties.get("position"),x=[d.x,d.y,d.z],b=o.create$1();h.properties.get("anchor")==="viewport"&&o.fromRotation(b,-c.transform.angle),o.transformMat3(x,x,b);const S=h.properties.get("color");return{u_matrix:L,u_lightpos:x,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+_,u_opacity:l}},ws=(L,c,_,l,h,d,x)=>o.extend(Fo(L,c,_,l),we(d,c,x),{u_height_factor:-Math.pow(2,h.overscaledZ)/x.tileSize/8}),Oa=L=>({u_matrix:L}),Fa=(L,c,_,l)=>o.extend(Oa(L),we(_,c,l)),la=(L,c)=>({u_matrix:L,u_world:c}),gl=(L,c,_,l,h)=>o.extend(Fa(L,c,_,l),{u_world:h}),Aa=(L,c,_,l)=>{const h=L.transform;let d,x;if(l.paint.get("circle-pitch-alignment")==="map"){const b=Dr(_,1,h.zoom);d=!0,x=[b,b]}else d=!1,x=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_matrix:L.translatePosMatrix(c.posMatrix,_,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_pitch_with_map:+d,u_device_pixel_ratio:L.pixelRatio,u_extrude_scale:x}},Jr=(L,c,_)=>{const l=Dr(_,1,c.zoom),h=Math.pow(2,c.zoom-_.tileID.overscaledZ),d=_.tileID.overscaleFactor();return{u_matrix:L,u_camera_to_center_distance:c.cameraToCenterDistance,u_pixels_to_tile_units:l,u_extrude_scale:[c.pixelsToGLUnits[0]/(l*h),c.pixelsToGLUnits[1]/(l*h)],u_overscale_factor:d}},ge=(L,c,_=1)=>({u_matrix:L,u_color:c,u_overlay:0,u_overlay_scale:_}),Ee=L=>({u_matrix:L}),Fe=(L,c,_,l)=>({u_matrix:L,u_extrude_scale:Dr(c,1,_),u_intensity:l});function at(L,c){const _=Math.pow(2,c.canonical.z),l=c.canonical.y;return[new o.MercatorCoordinate(0,l/_).toLngLat().lat,new o.MercatorCoordinate(0,(l+1)/_).toLngLat().lat]}const bt=(L,c,_,l)=>{const h=L.transform;return{u_matrix:Pr(L,c,_,l),u_ratio:1/Dr(c,1,h.zoom),u_device_pixel_ratio:L.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Qt=(L,c,_,l,h)=>o.extend(bt(L,c,_,h),{u_image:0,u_image_height:l}),Ln=(L,c,_,l,h)=>{const d=L.transform,x=en(c,d);return{u_matrix:Pr(L,c,_,h),u_texsize:c.imageAtlasTexture.size,u_ratio:1/Dr(c,1,d.zoom),u_device_pixel_ratio:L.pixelRatio,u_image:0,u_scale:[x,l.fromScale,l.toScale],u_fade:l.t,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Mr=(L,c,_,l,h,d)=>{const x=L.lineAtlas,b=en(c,L.transform),S=_.layout.get("line-cap")==="round",M=x.getDash(l.from,S),B=x.getDash(l.to,S),V=M.width*h.fromScale,j=B.width*h.toScale;return o.extend(bt(L,c,_,d),{u_patternscale_a:[b/V,-M.height/2],u_patternscale_b:[b/j,-B.height/2],u_sdfgamma:x.width/(256*Math.min(V,j)*L.pixelRatio)/2,u_image:0,u_tex_y_a:M.y,u_tex_y_b:B.y,u_mix:h.t})};function en(L,c){return 1/Dr(L,1,c.tileZoom)}function Pr(L,c,_,l){return L.translatePosMatrix(l?l.posMatrix:c.tileID.posMatrix,c,_.paint.get("line-translate"),_.paint.get("line-translate-anchor"))}const Gn=(L,c,_,l,h)=>{return{u_matrix:L,u_tl_parent:c,u_scale_parent:_,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(x=h.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(d=h.paint.get("raster-contrast"),d>0?1/(1-d):1+d),u_spin_weights:lA(h.paint.get("raster-hue-rotate"))};var d,x};function lA(L){L*=Math.PI/180;const c=Math.sin(L),_=Math.cos(L);return[(2*_+1)/3,(-Math.sqrt(3)*c-_+1)/3,(Math.sqrt(3)*c-_+1)/3]}const AA=(L,c,_,l,h,d,x,b,S,M)=>{const B=h.transform;return{u_is_size_zoom_constant:+(L==="constant"||L==="source"),u_is_size_feature_constant:+(L==="constant"||L==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+_,u_aspect_ratio:B.width/B.height,u_fade_change:h.options.fadeDuration?h.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:x,u_coord_matrix:b,u_is_text:+S,u_pitch_with_map:+l,u_texsize:M,u_texture:0}},uA=(L,c,_,l,h,d,x,b,S,M,B)=>{const V=h.transform;return o.extend(AA(L,c,_,l,h,d,x,b,S,M),{u_gamma_scale:l?Math.cos(V._pitch)*V.cameraToCenterDistance:1,u_device_pixel_ratio:h.pixelRatio,u_is_halo:+B})},QA=(L,c,_,l,h,d,x,b,S,M)=>o.extend(uA(L,c,_,l,h,d,x,b,!0,S,!0),{u_texsize_icon:M,u_texture_icon:1}),qA=(L,c,_)=>({u_matrix:L,u_opacity:c,u_color:_}),cA=(L,c,_,l,h,d)=>o.extend(function(x,b,S,M){const B=S.imageManager.getPattern(x.from.toString()),V=S.imageManager.getPattern(x.to.toString()),{width:j,height:Y}=S.imageManager.getPixelSize(),ae=Math.pow(2,M.tileID.overscaledZ),ne=M.tileSize*Math.pow(2,S.transform.tileZoom)/ae,ue=ne*(M.tileID.canonical.x+M.tileID.wrap*ae),be=ne*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:V.tl,u_pattern_br_b:V.br,u_texsize:[j,Y],u_mix:b.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:V.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/Dr(M,1,S.transform.tileZoom),u_pixel_coord_upper:[ue>>16,be>>16],u_pixel_coord_lower:[65535&ue,65535&be]}}(l,d,_,h),{u_matrix:L,u_opacity:c}),ml={fillExtrusion:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_lightpos:new o.Uniform3f(L,c.u_lightpos),u_lightintensity:new o.Uniform1f(L,c.u_lightintensity),u_lightcolor:new o.Uniform3f(L,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(L,c.u_vertical_gradient),u_opacity:new o.Uniform1f(L,c.u_opacity)}),fillExtrusionPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_lightpos:new o.Uniform3f(L,c.u_lightpos),u_lightintensity:new o.Uniform1f(L,c.u_lightintensity),u_lightcolor:new o.Uniform3f(L,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(L,c.u_vertical_gradient),u_height_factor:new o.Uniform1f(L,c.u_height_factor),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade),u_opacity:new o.Uniform1f(L,c.u_opacity)}),fill:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),fillPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),fillOutline:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world)}),fillOutlinePattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world),u_image:new o.Uniform1i(L,c.u_image),u_texsize:new o.Uniform2f(L,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),circle:(L,c)=>({u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(L,c.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(L,c.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),collisionBox:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(L,c.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(L,c.u_extrude_scale),u_overscale_factor:new o.Uniform1f(L,c.u_overscale_factor)}),collisionCircle:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_inv_matrix:new o.UniformMatrix4f(L,c.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(L,c.u_viewport_size)}),debug:(L,c)=>({u_color:new o.UniformColor(L,c.u_color),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_overlay:new o.Uniform1i(L,c.u_overlay),u_overlay_scale:new o.Uniform1f(L,c.u_overlay_scale)}),clippingMask:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),heatmap:(L,c)=>({u_extrude_scale:new o.Uniform1f(L,c.u_extrude_scale),u_intensity:new o.Uniform1f(L,c.u_intensity),u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),heatmapTexture:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_world:new o.Uniform2f(L,c.u_world),u_image:new o.Uniform1i(L,c.u_image),u_color_ramp:new o.Uniform1i(L,c.u_color_ramp),u_opacity:new o.Uniform1f(L,c.u_opacity)}),hillshade:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_latrange:new o.Uniform2f(L,c.u_latrange),u_light:new o.Uniform2f(L,c.u_light),u_shadow:new o.UniformColor(L,c.u_shadow),u_highlight:new o.UniformColor(L,c.u_highlight),u_accent:new o.UniformColor(L,c.u_accent)}),hillshadePrepare:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_image:new o.Uniform1i(L,c.u_image),u_dimension:new o.Uniform2f(L,c.u_dimension),u_zoom:new o.Uniform1f(L,c.u_zoom),u_unpack:new o.Uniform4f(L,c.u_unpack)}),line:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels)}),lineGradient:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_image:new o.Uniform1i(L,c.u_image),u_image_height:new o.Uniform1f(L,c.u_image_height)}),linePattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texsize:new o.Uniform2f(L,c.u_texsize),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_image:new o.Uniform1i(L,c.u_image),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_scale:new o.Uniform3f(L,c.u_scale),u_fade:new o.Uniform1f(L,c.u_fade)}),lineSDF:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_ratio:new o.Uniform1f(L,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(L,c.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(L,c.u_patternscale_a),u_patternscale_b:new o.Uniform2f(L,c.u_patternscale_b),u_sdfgamma:new o.Uniform1f(L,c.u_sdfgamma),u_image:new o.Uniform1i(L,c.u_image),u_tex_y_a:new o.Uniform1f(L,c.u_tex_y_a),u_tex_y_b:new o.Uniform1f(L,c.u_tex_y_b),u_mix:new o.Uniform1f(L,c.u_mix)}),raster:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_tl_parent:new o.Uniform2f(L,c.u_tl_parent),u_scale_parent:new o.Uniform1f(L,c.u_scale_parent),u_buffer_scale:new o.Uniform1f(L,c.u_buffer_scale),u_fade_t:new o.Uniform1f(L,c.u_fade_t),u_opacity:new o.Uniform1f(L,c.u_opacity),u_image0:new o.Uniform1i(L,c.u_image0),u_image1:new o.Uniform1i(L,c.u_image1),u_brightness_low:new o.Uniform1f(L,c.u_brightness_low),u_brightness_high:new o.Uniform1f(L,c.u_brightness_high),u_saturation_factor:new o.Uniform1f(L,c.u_saturation_factor),u_contrast_factor:new o.Uniform1f(L,c.u_contrast_factor),u_spin_weights:new o.Uniform3f(L,c.u_spin_weights)}),symbolIcon:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texture:new o.Uniform1i(L,c.u_texture)}),symbolSDF:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texture:new o.Uniform1i(L,c.u_texture),u_gamma_scale:new o.Uniform1f(L,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(L,c.u_is_halo)}),symbolTextAndIcon:(L,c)=>({u_is_size_zoom_constant:new o.Uniform1i(L,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(L,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(L,c.u_size_t),u_size:new o.Uniform1f(L,c.u_size),u_camera_to_center_distance:new o.Uniform1f(L,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(L,c.u_pitch),u_rotate_symbol:new o.Uniform1i(L,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(L,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(L,c.u_fade_change),u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(L,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(L,c.u_coord_matrix),u_is_text:new o.Uniform1i(L,c.u_is_text),u_pitch_with_map:new o.Uniform1i(L,c.u_pitch_with_map),u_texsize:new o.Uniform2f(L,c.u_texsize),u_texsize_icon:new o.Uniform2f(L,c.u_texsize_icon),u_texture:new o.Uniform1i(L,c.u_texture),u_texture_icon:new o.Uniform1i(L,c.u_texture_icon),u_gamma_scale:new o.Uniform1f(L,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(L,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(L,c.u_is_halo)}),background:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_opacity:new o.Uniform1f(L,c.u_opacity),u_color:new o.UniformColor(L,c.u_color)}),backgroundPattern:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_opacity:new o.Uniform1f(L,c.u_opacity),u_image:new o.Uniform1i(L,c.u_image),u_pattern_tl_a:new o.Uniform2f(L,c.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(L,c.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(L,c.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(L,c.u_pattern_br_b),u_texsize:new o.Uniform2f(L,c.u_texsize),u_mix:new o.Uniform1f(L,c.u_mix),u_pattern_size_a:new o.Uniform2f(L,c.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(L,c.u_pattern_size_b),u_scale_a:new o.Uniform1f(L,c.u_scale_a),u_scale_b:new o.Uniform1f(L,c.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(L,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(L,c.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(L,c.u_tile_units_to_pixels)}),terrain:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texture:new o.Uniform1i(L,c.u_texture)}),terrainDepth:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix)}),terrainCoords:(L,c)=>({u_matrix:new o.UniformMatrix4f(L,c.u_matrix),u_texture:new o.Uniform1i(L,c.u_texture),u_terrain_coords_id:new o.Uniform1f(L,c.u_terrain_coords_id)})};class yl{constructor(c,_,l){this.context=c;const h=c.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const _=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),_.bufferSubData(_.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const hA={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fA{constructor(c,_,l,h){this.length=_.length,this.attributes=l,this.itemSize=_.bytesPerElement,this.dynamicDraw=h,this.context=c;const d=c.gl;this.buffer=d.createBuffer(),c.bindVertexBuffer.set(this.buffer),d.bufferData(d.ARRAY_BUFFER,_.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete _.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);const _=this.context.gl;this.bind(),_.bufferSubData(_.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,_){for(let l=0;l<this.attributes.length;l++){const h=_.attributes[this.attributes[l].name];h!==void 0&&c.enableVertexAttribArray(h)}}setVertexAttribPointers(c,_,l){for(let h=0;h<this.attributes.length;h++){const d=this.attributes[h],x=_.attributes[d.name];x!==void 0&&c.vertexAttribPointer(x,d.components,c[hA[d.type]],!1,this.itemSize,d.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Yn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ZA extends Yn{getDefault(){return o.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class lc extends Yn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class _l extends Yn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Hr extends Yn{getDefault(){return[!0,!0,!0,!0]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class No extends Yn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class zn extends Yn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class bs extends Yn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const _=this.current;(c.func!==_.func||c.ref!==_.ref||c.mask!==_.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class ei extends Yn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class po extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.STENCIL_TEST):_.disable(_.STENCIL_TEST),this.current=c,this.dirty=!1}}class vl extends Yn{getDefault(){return[0,1]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Uo extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.DEPTH_TEST):_.disable(_.DEPTH_TEST),this.current=c,this.dirty=!1}}class ua extends Yn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class go extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.BLEND):_.disable(_.BLEND),this.current=c,this.dirty=!1}}class dA extends Yn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class Na extends Yn{getDefault(){return o.Color.transparent}set(c){const _=this.current;(c.r!==_.r||c.g!==_.g||c.b!==_.b||c.a!==_.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Vo extends Yn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Gi extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;c?_.enable(_.CULL_FACE):_.disable(_.CULL_FACE),this.current=c,this.dirty=!1}}class $i extends Yn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class YA extends Yn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class xl extends Yn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class mo extends Yn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Go extends Yn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const _=this.current;(c[0]!==_[0]||c[1]!==_[1]||c[2]!==_[2]||c[3]!==_[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Ac extends Yn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindFramebuffer(_.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class XA extends Yn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindRenderbuffer(_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class wl extends Yn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindTexture(_.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class pA extends Yn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.bindBuffer(_.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class KA extends Yn{getDefault(){return null}set(c){const _=this.gl;_.bindBuffer(_.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class $o extends Yn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class Ua extends Yn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class JA extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class eu extends Yn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const _=this.gl;_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class yo extends Yn{constructor(c,_){super(c),this.context=c,this.parent=_}getDefault(){return null}}class ca extends yo{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferTexture2D(_.FRAMEBUFFER,_.COLOR_ATTACHMENT0,_.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class tu extends yo{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const _=this.gl;_.framebufferRenderbuffer(_.FRAMEBUFFER,_.DEPTH_ATTACHMENT,_.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class ha{constructor(c,_,l,h){this.context=c,this.width=_,this.height=l;const d=c.gl,x=this.framebuffer=d.createFramebuffer();if(this.colorAttachment=new ca(c,x),h&&(this.depthAttachment=new tu(c,x)),d.checkFramebufferStatus(d.FRAMEBUFFER)!==d.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const c=this.context.gl,_=this.colorAttachment.get();if(_&&c.deleteTexture(_),this.depthAttachment){const l=this.depthAttachment.get();l&&c.deleteRenderbuffer(l)}c.deleteFramebuffer(this.framebuffer)}}class cr{constructor(c,_,l){this.blendFunction=c,this.blendColor=_,this.mask=l}}cr.Replace=[1,0],cr.disabled=new cr(cr.Replace,o.Color.transparent,[!1,!1,!1,!1]),cr.unblended=new cr(cr.Replace,o.Color.transparent,[!0,!0,!0,!0]),cr.alphaBlended=new cr([1,771],o.Color.transparent,[!0,!0,!0,!0]);class Fs{constructor(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ZA(this),this.clearDepth=new lc(this),this.clearStencil=new _l(this),this.colorMask=new Hr(this),this.depthMask=new No(this),this.stencilMask=new zn(this),this.stencilFunc=new bs(this),this.stencilOp=new ei(this),this.stencilTest=new po(this),this.depthRange=new vl(this),this.depthTest=new Uo(this),this.depthFunc=new ua(this),this.blend=new go(this),this.blendFunc=new dA(this),this.blendColor=new Na(this),this.blendEquation=new Vo(this),this.cullFace=new Gi(this),this.cullFaceSide=new $i(this),this.frontFace=new YA(this),this.program=new xl(this),this.activeTexture=new mo(this),this.viewport=new Go(this),this.bindFramebuffer=new Ac(this),this.bindRenderbuffer=new XA(this),this.bindTexture=new wl(this),this.bindVertexBuffer=new pA(this),this.bindElementBuffer=new KA(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new $o(this),this.pixelStoreUnpack=new Ua(this),this.pixelStoreUnpackPremultiplyAlpha=new JA(this),this.pixelStoreUnpackFlipY=new eu(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,_){return new yl(this,c,_)}createVertexBuffer(c,_,l){return new fA(this,c,_,l)}createRenderbuffer(c,_,l){const h=this.gl,d=h.createRenderbuffer();return this.bindRenderbuffer.set(d),h.renderbufferStorage(h.RENDERBUFFER,c,_,l),this.bindRenderbuffer.set(null),d}createFramebuffer(c,_,l){return new ha(this,c,_,l)}clear({color:c,depth:_}){const l=this.gl;let h=0;c&&(h|=l.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),_!==void 0&&(h|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(_),this.depthMask.set(!0)),l.clear(h)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){I(c.blendFunction,cr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class $n{constructor(c,_,l){this.func=c,this.mask=_,this.range=l}}$n.ReadOnly=!1,$n.ReadWrite=!0,$n.disabled=new $n(519,$n.ReadOnly,[0,1]);const Qn=7680;class _r{constructor(c,_,l,h,d,x){this.test=c,this.ref=_,this.mask=l,this.fail=h,this.depthFail=d,this.pass=x}}_r.disabled=new _r({func:519,mask:0},0,0,Qn,Qn,Qn);class fr{constructor(c,_,l){this.enable=c,this.mode=_,this.frontFace=l}}let bl;function jo(L,c,_,l,h,d,x){const b=L.context,S=b.gl,M=L.useProgram("collisionBox"),B=[];let V=0,j=0;for(let ve=0;ve<l.length;ve++){const Ge=l[ve],Te=c.getTile(Ge),Ve=Te.getBucket(_);if(!Ve)continue;let xe=Ge.posMatrix;h[0]===0&&h[1]===0||(xe=L.translatePosMatrix(Ge.posMatrix,Te,h,d));const y=x?Ve.textCollisionBox:Ve.iconCollisionBox,m=Ve.collisionCircleArray;if(m.length>0){const v=o.create(),E=xe;o.mul(v,Ve.placementInvProjMatrix,L.transform.glCoordMatrix),o.mul(v,v,Ve.placementViewportMatrix),B.push({circleArray:m,circleOffset:j,transform:E,invTransform:v,coord:Ge}),V+=m.length/4,j=V}y&&M.draw(b,S.LINES,$n.disabled,_r.disabled,L.colorModeForRenderPass(),fr.disabled,Jr(xe,L.transform,Te),L.style.terrain&&L.style.terrain.getTerrainData(Ge),_.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,null,L.transform.zoom,null,null,y.collisionVertexBuffer)}if(!x||!B.length)return;const Y=L.useProgram("collisionCircle"),ae=new o.CollisionCircleLayoutArray;ae.resize(4*V),ae._trim();let ne=0;for(const ve of B)for(let Ge=0;Ge<ve.circleArray.length/4;Ge++){const Te=4*Ge,Ve=ve.circleArray[Te+0],xe=ve.circleArray[Te+1],y=ve.circleArray[Te+2],m=ve.circleArray[Te+3];ae.emplace(ne++,Ve,xe,y,m,0),ae.emplace(ne++,Ve,xe,y,m,1),ae.emplace(ne++,Ve,xe,y,m,2),ae.emplace(ne++,Ve,xe,y,m,3)}(!bl||bl.length<2*V)&&(bl=function(ve){const Ge=2*ve,Te=new o.QuadTriangleArray;Te.resize(Ge),Te._trim();for(let Ve=0;Ve<Ge;Ve++){const xe=6*Ve;Te.uint16[xe+0]=4*Ve+0,Te.uint16[xe+1]=4*Ve+1,Te.uint16[xe+2]=4*Ve+2,Te.uint16[xe+3]=4*Ve+2,Te.uint16[xe+4]=4*Ve+3,Te.uint16[xe+5]=4*Ve+0}return Te}(V));const ue=b.createIndexBuffer(bl,!0),be=b.createVertexBuffer(ae,o.collisionCircleLayout.members,!0);for(const ve of B){const Ge={u_matrix:ve.transform,u_inv_matrix:ve.invTransform,u_camera_to_center_distance:(Ce=L.transform).cameraToCenterDistance,u_viewport_size:[Ce.width,Ce.height]};Y.draw(b,S.TRIANGLES,$n.disabled,_r.disabled,L.colorModeForRenderPass(),fr.disabled,Ge,L.style.terrain&&L.style.terrain.getTerrainData(ve.coord),_.id,be,ue,o.SegmentVector.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,L.transform.zoom,null,null,null)}var Ce;be.destroy(),ue.destroy()}fr.disabled=new fr(!1,1029,2305),fr.backCCW=new fr(!0,1029,2305);const uc=o.identity(new Float32Array(16));function Va(L,c,_,l,h,d){const{horizontalAlign:x,verticalAlign:b}=o.getAnchorAlignment(L),S=-(x-.5)*c,M=-(b-.5)*_,B=o.evaluateVariableOffset(L,l);return new o.pointGeometry((S/h+B[0])*d,(M/h+B[1])*d)}function cc(L,c,_,l,h,d,x,b,S,M,B){const V=L.text.placedSymbolArray,j=L.text.dynamicLayoutVertexArray,Y=L.icon.dynamicLayoutVertexArray,ae={};j.clear();for(let ne=0;ne<V.length;ne++){const ue=V.get(ne),be=L.allowVerticalPlacement&&!ue.placedOrientation,Ce=ue.hidden||!ue.crossTileID||be?null:l[ue.crossTileID];if(Ce){const ve=new o.pointGeometry(ue.anchorX,ue.anchorY),Ge=Bn(ve,_?x:d,B),Te=Ni(h.cameraToCenterDistance,Ge.signedDistanceFromCamera);let Ve=o.evaluateSizeForFeature(L.textSizeData,S,ue)*Te/o.ONE_EM;_&&(Ve*=L.tilePixelRatio/b);const{width:xe,height:y,anchor:m,textOffset:v,textBoxScale:E}=Ce,P=Va(m,xe,y,v,E,Ve),R=_?Bn(ve.add(P),d,B).point:Ge.point.add(c?P.rotate(-h.angle):P),O=L.allowVerticalPlacement&&ue.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let N=0;N<ue.numGlyphs;N++)o.addDynamicAttributes(j,R,O);M&&ue.associatedIconIndex>=0&&(ae[ue.associatedIconIndex]={shiftedAnchor:R,angle:O})}else yn(ue.numGlyphs,j)}if(M){Y.clear();const ne=L.icon.placedSymbolArray;for(let ue=0;ue<ne.length;ue++){const be=ne.get(ue);if(be.hidden)yn(be.numGlyphs,Y);else{const Ce=ae[ue];if(Ce)for(let ve=0;ve<be.numGlyphs;ve++)o.addDynamicAttributes(Y,Ce.shiftedAnchor,Ce.angle);else yn(be.numGlyphs,Y)}}L.icon.dynamicLayoutVertexBuffer.updateData(Y)}L.text.dynamicLayoutVertexBuffer.updateData(j)}function nu(L,c,_){return _.iconsInText&&c?"symbolTextAndIcon":L?"symbolSDF":"symbolIcon"}function Ns(L,c,_,l,h,d,x,b,S,M,B,V){const j=L.context,Y=j.gl,ae=L.transform,ne=b==="map",ue=S==="map",be=b!=="viewport"&&_.layout.get("symbol-placement")!=="point",Ce=ne&&!ue&&!be,ve=!_.layout.get("symbol-sort-key").isConstant();let Ge=!1;const Te=L.depthModeForSublayer(0,$n.ReadOnly),Ve=_.layout.get("text-variable-anchor"),xe=[];for(const y of l){const m=c.getTile(y),v=m.getBucket(_);if(!v)continue;const E=h?v.text:v.icon;if(!E||!E.segments.get().length)continue;const P=E.programConfigurations.get(_.id),R=h||v.sdfIcons,O=h?v.textSizeData:v.iconSizeData,N=ue||ae.pitch!==0,Q=L.useProgram(nu(R,h,v),P),J=o.evaluateSizeForZoom(O,ae.zoom),le=L.style.terrain&&L.style.terrain.getTerrainData(y);let de,Re,$e,Be,Xe=[0,0],ht=null;if(h){if(Re=m.glyphAtlasTexture,$e=Y.LINEAR,de=m.glyphAtlasTexture.size,v.iconsInText){Xe=m.imageAtlasTexture.size,ht=m.imageAtlasTexture;const _n=O.kind==="composite"||O.kind==="camera";Be=N||L.options.rotating||L.options.zooming||_n?Y.LINEAR:Y.NEAREST}}else{const _n=_.layout.get("icon-size").constantOr(0)!==1||v.iconsNeedLinear;Re=m.imageAtlasTexture,$e=R||L.options.rotating||L.options.zooming||_n||N?Y.LINEAR:Y.NEAREST,de=m.imageAtlasTexture.size}const ut=Dr(m,1,L.transform.zoom),it=Bs(y.posMatrix,ue,ne,L.transform,ut),st=yi(y.posMatrix,ue,ne,L.transform,ut),Je=Ve&&v.hasTextData(),Gt=_.layout.get("icon-text-fit")!=="none"&&Je&&v.hasIconData();if(be){const _n=L.style.terrain?(Dn,sr)=>L.style.terrain.getElevation(y,Dn,sr):null,En=_.layout.get("text-rotation-alignment")==="map";Pi(v,y.posMatrix,L,h,it,st,ue,M,En,_n)}const zt=L.translatePosMatrix(y.posMatrix,m,d,x),dt=be||h&&Ve||Gt?uc:it,vt=L.translatePosMatrix(st,m,d,x,!0),Pn=R&&_.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let wn;wn=R?v.iconsInText?QA(O.kind,J,Ce,ue,L,zt,dt,vt,de,Xe):uA(O.kind,J,Ce,ue,L,zt,dt,vt,h,de,!0):AA(O.kind,J,Ce,ue,L,zt,dt,vt,h,de);const mn={program:Q,buffers:E,uniformValues:wn,atlasTexture:Re,atlasTextureIcon:ht,atlasInterpolation:$e,atlasInterpolationIcon:Be,isSDF:R,hasHalo:Pn};if(ve&&v.canOverlap){Ge=!0;const _n=E.segments.get();for(const En of _n)xe.push({segments:new o.SegmentVector([En]),sortKey:En.sortKey,state:mn,terrainData:le})}else xe.push({segments:E.segments,sortKey:0,state:mn,terrainData:le})}Ge&&xe.sort((y,m)=>y.sortKey-m.sortKey);for(const y of xe){const m=y.state;if(j.activeTexture.set(Y.TEXTURE0),m.atlasTexture.bind(m.atlasInterpolation,Y.CLAMP_TO_EDGE),m.atlasTextureIcon&&(j.activeTexture.set(Y.TEXTURE1),m.atlasTextureIcon&&m.atlasTextureIcon.bind(m.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),m.isSDF){const v=m.uniformValues;m.hasHalo&&(v.u_is_halo=1,El(m.buffers,y.segments,_,L,m.program,Te,B,V,v,y.terrainData)),v.u_is_halo=0}El(m.buffers,y.segments,_,L,m.program,Te,B,V,m.uniformValues,y.terrainData)}}function El(L,c,_,l,h,d,x,b,S,M){const B=l.context;h.draw(B,B.gl.TRIANGLES,d,x,b,fr.disabled,S,M,_.id,L.layoutVertexBuffer,L.indexBuffer,c,_.paint,l.transform.zoom,L.programConfigurations.get(_.id),L.dynamicLayoutVertexBuffer,L.opacityVertexBuffer)}function Ga(L,c,_,l,h,d,x){const b=L.context.gl,S=_.paint.get("fill-pattern"),M=S&&S.constantOr(1),B=_.getCrossfadeParameters();let V,j,Y,ae,ne;x?(j=M&&!_.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",V=b.LINES):(j=M?"fillPattern":"fill",V=b.TRIANGLES);for(const ue of l){const be=c.getTile(ue);if(M&&!be.patternsLoaded())continue;const Ce=be.getBucket(_);if(!Ce)continue;const ve=Ce.programConfigurations.get(_.id),Ge=L.useProgram(j,ve),Te=L.style.terrain&&L.style.terrain.getTerrainData(ue);M&&(L.context.activeTexture.set(b.TEXTURE0),be.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),ve.updatePaintBuffers(B));const Ve=S.constantOr(null);if(Ve&&be.imageAtlas){const m=be.imageAtlas,v=m.patternPositions[Ve.to.toString()],E=m.patternPositions[Ve.from.toString()];v&&E&&ve.setConstantPatternPositions(v,E)}const xe=Te?ue:null,y=L.translatePosMatrix(xe?xe.posMatrix:ue.posMatrix,be,_.paint.get("fill-translate"),_.paint.get("fill-translate-anchor"));if(x){ae=Ce.indexBuffer2,ne=Ce.segments2;const m=[b.drawingBufferWidth,b.drawingBufferHeight];Y=j==="fillOutlinePattern"&&M?gl(y,L,B,be,m):la(y,m)}else ae=Ce.indexBuffer,ne=Ce.segments,Y=M?Fa(y,L,B,be):Oa(y);Ge.draw(L.context,V,h,L.stencilModeForClipping(ue),d,fr.disabled,Y,Te,_.id,Ce.layoutVertexBuffer,ae,ne,_.paint,L.transform.zoom,ve)}}function fa(L,c,_,l,h,d,x){const b=L.context,S=b.gl,M=_.paint.get("fill-extrusion-pattern"),B=M.constantOr(1),V=_.getCrossfadeParameters(),j=_.paint.get("fill-extrusion-opacity");for(const Y of l){const ae=c.getTile(Y),ne=ae.getBucket(_);if(!ne)continue;const ue=L.style.terrain&&L.style.terrain.getTerrainData(Y),be=ne.programConfigurations.get(_.id),Ce=L.useProgram(B?"fillExtrusionPattern":"fillExtrusion",be);B&&(L.context.activeTexture.set(S.TEXTURE0),ae.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),be.updatePaintBuffers(V));const ve=M.constantOr(null);if(ve&&ae.imageAtlas){const xe=ae.imageAtlas,y=xe.patternPositions[ve.to.toString()],m=xe.patternPositions[ve.from.toString()];y&&m&&be.setConstantPatternPositions(y,m)}const Ge=L.translatePosMatrix(Y.posMatrix,ae,_.paint.get("fill-extrusion-translate"),_.paint.get("fill-extrusion-translate-anchor")),Te=_.paint.get("fill-extrusion-vertical-gradient"),Ve=B?ws(Ge,L,Te,j,Y,V,ae):Fo(Ge,L,Te,j);Ce.draw(b,b.gl.TRIANGLES,h,d,x,fr.backCCW,Ve,ue,_.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,_.paint,L.transform.zoom,be,L.style.terrain&&ne.centroidVertexBuffer)}}function Tl(L,c,_,l,h,d,x){const b=L.context,S=b.gl,M=_.fbo;if(!M)return;const B=L.useProgram("hillshade"),V=L.style.terrain&&L.style.terrain.getTerrainData(c);b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,M.colorAttachment.get()),B.draw(b,S.TRIANGLES,h,d,x,fr.disabled,((j,Y,ae,ne)=>{const ue=ae.paint.get("hillshade-shadow-color"),be=ae.paint.get("hillshade-highlight-color"),Ce=ae.paint.get("hillshade-accent-color");let ve=ae.paint.get("hillshade-illumination-direction")*(Math.PI/180);ae.paint.get("hillshade-illumination-anchor")==="viewport"&&(ve-=j.transform.angle);const Ge=!j.options.moving;return{u_matrix:ne?ne.posMatrix:j.transform.calculatePosMatrix(Y.tileID.toUnwrapped(),Ge),u_image:0,u_latrange:at(0,Y.tileID),u_light:[ae.paint.get("hillshade-exaggeration"),ve],u_shadow:ue,u_highlight:be,u_accent:Ce}})(L,_,l,V?c:null),V,l.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}function Sl(L,c,_,l,h,d){const x=L.context,b=x.gl,S=c.dem;if(S&&S.data){const M=S.dim,B=S.stride,V=S.getPixels();if(x.activeTexture.set(b.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||L.getTileTexture(B),c.demTexture){const Y=c.demTexture;Y.update(V,{premultiply:!1}),Y.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else c.demTexture=new q(x,V,b.RGBA,{premultiply:!1}),c.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);x.activeTexture.set(b.TEXTURE0);let j=c.fbo;if(!j){const Y=new q(x,{width:M,height:M,data:null},b.RGBA);Y.bind(b.LINEAR,b.CLAMP_TO_EDGE),j=c.fbo=x.createFramebuffer(M,M,!0),j.colorAttachment.set(Y.texture)}x.bindFramebuffer.set(j.framebuffer),x.viewport.set([0,0,M,M]),L.useProgram("hillshadePrepare").draw(x,b.TRIANGLES,l,h,d,fr.disabled,((Y,ae)=>{const ne=ae.stride,ue=o.create();return o.ortho(ue,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(ue,ue,[0,-o.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[ne,ne],u_zoom:Y.overscaledZ,u_unpack:ae.getUnpackVector()}})(c.tileID,S),null,_.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function dr(L,c,_,l,h,d){const x=l.paint.get("raster-fade-duration");if(!d&&x>0){const b=o.exported.now(),S=(b-L.timeAdded)/x,M=c?(b-c.timeAdded)/x:-1,B=_.getSource(),V=h.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),j=!c||Math.abs(c.tileID.overscaledZ-V)>Math.abs(L.tileID.overscaledZ-V),Y=j&&L.refreshedUponExpiration?1:o.clamp(j?S:1-M,0,1);return L.refreshedUponExpiration&&S>=1&&(L.refreshedUponExpiration=!1),c?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const gA=new o.Color(1,0,0,1),as=new o.Color(0,1,0,1),ru=new o.Color(0,0,1,1),Ml=new o.Color(1,0,1,1),hc=new o.Color(0,1,1,1);function Wr(L,c,_,l){ti(L,0,c+_/2,L.transform.width,_,l)}function Ir(L,c,_,l){ti(L,c-_/2,0,_,L.transform.height,l)}function ti(L,c,_,l,h,d){const x=L.context,b=x.gl;b.enable(b.SCISSOR_TEST),b.scissor(c*L.pixelRatio,_*L.pixelRatio,l*L.pixelRatio,h*L.pixelRatio),x.clear({color:d}),b.disable(b.SCISSOR_TEST)}function iu(L,c,_){const l=L.context,h=l.gl,d=_.posMatrix,x=L.useProgram("debug"),b=$n.disabled,S=_r.disabled,M=L.colorModeForRenderPass(),B="$debug",V=L.style.terrain&&L.style.terrain.getTerrainData(_);l.activeTexture.set(h.TEXTURE0),L.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE);const j=c.getTileByID(_.key).latestRawTileData,Y=Math.floor((j&&j.byteLength||0)/1024),ae=c.getTile(_).tileSize,ne=512/Math.min(ae,512)*(_.overscaledZ/L.transform.zoom)*.5;let ue=_.canonical.toString();_.overscaledZ!==_.canonical.z&&(ue+=` => ${_.overscaledZ}`),function(be,Ce){be.initDebugOverlayCanvas();const ve=be.debugOverlayCanvas,Ge=be.context.gl,Te=be.debugOverlayCanvas.getContext("2d");Te.clearRect(0,0,ve.width,ve.height),Te.shadowColor="white",Te.shadowBlur=2,Te.lineWidth=1.5,Te.strokeStyle="white",Te.textBaseline="top",Te.font="bold 36px Open Sans, sans-serif",Te.fillText(Ce,5,5),Te.strokeText(Ce,5,5),be.debugOverlayTexture.update(ve),be.debugOverlayTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE)}(L,`${ue} ${Y}kB`),x.draw(l,h.TRIANGLES,b,S,cr.alphaBlended,fr.disabled,ge(d,o.Color.transparent,ne),null,B,L.debugBuffer,L.quadTriangleIndexBuffer,L.debugSegments),x.draw(l,h.LINE_STRIP,b,S,M,fr.disabled,ge(d,o.Color.red),V,B,L.debugBuffer,L.tileBorderIndexBuffer,L.debugSegments)}function Us(L,c,_){const l=L.context,h=l.gl,d=L.colorModeForRenderPass(),x=new $n(h.LEQUAL,$n.ReadWrite,L.depthRangeFor3D),b=L.useProgram("terrain"),S=c.getTerrainMesh(),M=c.getTerrainData(_.tileID);l.bindFramebuffer.set(null),l.viewport.set([0,0,L.width,L.height]),l.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,c.getRTTFramebuffer().colorAttachment.get());const B=L.transform.calculatePosMatrix(_.tileID.toUnwrapped());b.draw(l,h.TRIANGLES,x,_r.disabled,d,fr.backCCW,{u_matrix:B,u_texture:0},M,"terrain",S.vertexBuffer,S.indexBuffer,S.segments)}function fc(L,c,_,l){const h=L.context,d=_.tileSize*c.qualityFactor;_.textures[l]||(_.textures[l]=L.getTileTexture(d)||new q(h,{width:d,height:d,data:null},h.gl.RGBA),_.textures[l].bind(h.gl.LINEAR,h.gl.CLAMP_TO_EDGE),l===0&&c.sourceCache.renderHistory.unshift(_.tileID.key));const x=c.getRTTFramebuffer();x.colorAttachment.set(_.textures[l].texture),h.bindFramebuffer.set(x.framebuffer),h.viewport.set([0,0,d,d])}class mA{constructor(c){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=c,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=c.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const c=this.painter.style,_=c.terrain;for(const l in c.sourceCaches){this._coordsDescendingInv[l]={};const h=c.sourceCaches[l].getVisibleCoordinates();for(const d of h){const x=_.sourceCache.getTerrainCoords(d);for(const b in x)this._coordsDescendingInv[l][b]||(this._coordsDescendingInv[l][b]=[]),this._coordsDescendingInv[l][b].push(x[b])}}for(const l of c._order){const h=c._layers[l],d=h.source;if(this._renderToTexture[h.type]&&!this._coordsDescendingInvStr[d]){this._coordsDescendingInvStr[d]={};for(const x in this._coordsDescendingInv[d])this._coordsDescendingInvStr[d][x]=this._coordsDescendingInv[d][x].map(b=>b.key).sort().join()}}return this._renderableTiles.forEach(l=>{for(const h in this._coordsDescendingInvStr){const d=this._coordsDescendingInvStr[h][l.tileID.key];d&&d!==l.textureCoords[h]&&l.clearTextures(this.painter),_.needsRerender(h,l.tileID)&&l.clearTextures(this.painter)}this._rerender[l.tileID.key]=!l.textures.length}),_.clearRerenderCache(),_.sourceCache.removeOutdated(this.painter),this}renderLayer(c){const _=c.type,l=this.painter,h=l.style._order,d=l.currentLayer,x=d+1===h.length;if(this._renderToTexture[_]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(h[d]),!x))return!0;if(this._renderToTexture[this._prevType]||_==="hillshade"||this._renderToTexture[_]&&x){this._prevType=_;const b=this._stacks.length-1,S=this._stacks[b]||[];for(const M of this._renderableTiles){if(fc(l,l.style.terrain,M,b),this._rerender[M.tileID.key]){l.context.clear({color:o.Color.transparent});for(let B=0;B<S.length;B++){const V=l.style._layers[S[B]],j=V.source?this._coordsDescendingInv[V.source][M.tileID.key]:[M.tileID];l._renderTileClippingMasks(V,j),l.renderLayer(l,l.style.sourceCaches[V.source],V,j),V.source&&(M.textureCoords[V.source]=this._coordsDescendingInvStr[V.source][M.tileID.key])}}Us(l,l.style.terrain,M)}if(_==="hillshade"){this._stacks.push([h[d]]);for(const M of this._renderableTiles){const B=this._coordsDescendingInv[c.source][M.tileID.key];fc(l,l.style.terrain,M,this._stacks.length-1),l.context.clear({color:o.Color.transparent}),l._renderTileClippingMasks(c,B),l.renderLayer(l,l.style.sourceCaches[c.source],c,B),Us(l,l.style.terrain,M)}return!0}return this._renderToTexture[_]}return!1}}const li={symbol:function(L,c,_,l,h){if(L.renderPass!=="translucent")return;const d=_r.disabled,x=L.colorModeForRenderPass();_.layout.get("text-variable-anchor")&&function(b,S,M,B,V,j,Y){const ae=S.transform,ne=V==="map",ue=j==="map";for(const be of b){const Ce=B.getTile(be),ve=Ce.getBucket(M);if(!ve||!ve.text||!ve.text.segments.get().length)continue;const Ge=o.evaluateSizeForZoom(ve.textSizeData,ae.zoom),Te=Dr(Ce,1,S.transform.zoom),Ve=Bs(be.posMatrix,ue,ne,S.transform,Te),xe=M.layout.get("icon-text-fit")!=="none"&&ve.hasIconData();if(Ge){const y=Math.pow(2,ae.zoom-Ce.tileID.overscaledZ);cc(ve,ne,ue,Y,ae,Ve,be.posMatrix,y,Ge,xe,S.style.terrain?(m,v)=>S.style.terrain.getElevation(be,m,v):null)}}}(l,L,_,c,_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),h),_.paint.get("icon-opacity").constantOr(1)!==0&&Ns(L,c,_,l,!1,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),_.layout.get("icon-rotation-alignment"),_.layout.get("icon-pitch-alignment"),_.layout.get("icon-keep-upright"),d,x),_.paint.get("text-opacity").constantOr(1)!==0&&Ns(L,c,_,l,!0,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),_.layout.get("text-rotation-alignment"),_.layout.get("text-pitch-alignment"),_.layout.get("text-keep-upright"),d,x),c.map.showCollisionBoxes&&(jo(L,c,_,l,_.paint.get("text-translate"),_.paint.get("text-translate-anchor"),!0),jo(L,c,_,l,_.paint.get("icon-translate"),_.paint.get("icon-translate-anchor"),!1))},circle:function(L,c,_,l){if(L.renderPass!=="translucent")return;const h=_.paint.get("circle-opacity"),d=_.paint.get("circle-stroke-width"),x=_.paint.get("circle-stroke-opacity"),b=!_.layout.get("circle-sort-key").isConstant();if(h.constantOr(1)===0&&(d.constantOr(1)===0||x.constantOr(1)===0))return;const S=L.context,M=S.gl,B=L.depthModeForSublayer(0,$n.ReadOnly),V=_r.disabled,j=L.colorModeForRenderPass(),Y=[];for(let ae=0;ae<l.length;ae++){const ne=l[ae],ue=c.getTile(ne),be=ue.getBucket(_);if(!be)continue;const Ce=be.programConfigurations.get(_.id),ve=L.useProgram("circle",Ce),Ge=be.layoutVertexBuffer,Te=be.indexBuffer,Ve=L.style.terrain&&L.style.terrain.getTerrainData(ne),xe={programConfiguration:Ce,program:ve,layoutVertexBuffer:Ge,indexBuffer:Te,uniformValues:Aa(L,ne,ue,_),terrainData:Ve};if(b){const y=be.segments.get();for(const m of y)Y.push({segments:new o.SegmentVector([m]),sortKey:m.sortKey,state:xe})}else Y.push({segments:be.segments,sortKey:0,state:xe})}b&&Y.sort((ae,ne)=>ae.sortKey-ne.sortKey);for(const ae of Y){const{programConfiguration:ne,program:ue,layoutVertexBuffer:be,indexBuffer:Ce,uniformValues:ve,terrainData:Ge}=ae.state;ue.draw(S,M.TRIANGLES,B,V,j,fr.disabled,ve,Ge,_.id,be,Ce,ae.segments,_.paint,L.transform.zoom,ne)}},heatmap:function(L,c,_,l){if(_.paint.get("heatmap-opacity")!==0)if(L.renderPass==="offscreen"){const h=L.context,d=h.gl,x=_r.disabled,b=new cr([d.ONE,d.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(S,M,B){const V=S.gl;S.activeTexture.set(V.TEXTURE1),S.viewport.set([0,0,M.width/4,M.height/4]);let j=B.heatmapFbo;if(j)V.bindTexture(V.TEXTURE_2D,j.colorAttachment.get()),S.bindFramebuffer.set(j.framebuffer);else{const Y=V.createTexture();V.bindTexture(V.TEXTURE_2D,Y),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),j=B.heatmapFbo=S.createFramebuffer(M.width/4,M.height/4,!1),function(ae,ne,ue,be){const Ce=ae.gl;Ce.texImage2D(Ce.TEXTURE_2D,0,Ce.RGBA,ne.width/4,ne.height/4,0,Ce.RGBA,ae.extRenderToTextureHalfFloat?ae.extTextureHalfFloat.HALF_FLOAT_OES:Ce.UNSIGNED_BYTE,null),be.colorAttachment.set(ue)}(S,M,Y,j)}})(h,L,_),h.clear({color:o.Color.transparent});for(let S=0;S<l.length;S++){const M=l[S];if(c.hasRenderableParent(M))continue;const B=c.getTile(M),V=B.getBucket(_);if(!V)continue;const j=V.programConfigurations.get(_.id),Y=L.useProgram("heatmap",j),{zoom:ae}=L.transform;Y.draw(h,d.TRIANGLES,$n.disabled,x,b,fr.disabled,Fe(M.posMatrix,B,ae,_.paint.get("heatmap-intensity")),null,_.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,_.paint,L.transform.zoom,j)}h.viewport.set([0,0,L.width,L.height])}else L.renderPass==="translucent"&&(L.context.setColorMode(L.colorModeForRenderPass()),function(h,d){const x=h.context,b=x.gl,S=d.heatmapFbo;if(!S)return;x.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,S.colorAttachment.get()),x.activeTexture.set(b.TEXTURE1);let M=d.colorRampTexture;M||(M=d.colorRampTexture=new q(x,d.colorRamp,b.RGBA)),M.bind(b.LINEAR,b.CLAMP_TO_EDGE),h.useProgram("heatmapTexture").draw(x,b.TRIANGLES,$n.disabled,_r.disabled,h.colorModeForRenderPass(),fr.disabled,((B,V,j,Y)=>{const ae=o.create();o.ortho(ae,0,B.width,B.height,0,0,1);const ne=B.context.gl;return{u_matrix:ae,u_world:[ne.drawingBufferWidth,ne.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:V.paint.get("heatmap-opacity")}})(h,d),null,d.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments,d.paint,h.transform.zoom)}(L,_))},line:function(L,c,_,l){if(L.renderPass!=="translucent")return;const h=_.paint.get("line-opacity"),d=_.paint.get("line-width");if(h.constantOr(1)===0||d.constantOr(1)===0)return;const x=L.depthModeForSublayer(0,$n.ReadOnly),b=L.colorModeForRenderPass(),S=_.paint.get("line-dasharray"),M=_.paint.get("line-pattern"),B=M.constantOr(1),V=_.paint.get("line-gradient"),j=_.getCrossfadeParameters(),Y=B?"linePattern":S?"lineSDF":V?"lineGradient":"line",ae=L.context,ne=ae.gl;let ue=!0;for(const be of l){const Ce=c.getTile(be);if(B&&!Ce.patternsLoaded())continue;const ve=Ce.getBucket(_);if(!ve)continue;const Ge=ve.programConfigurations.get(_.id),Te=L.context.program.get(),Ve=L.useProgram(Y,Ge),xe=ue||Ve.program!==Te,y=L.style.terrain&&L.style.terrain.getTerrainData(be),m=M.constantOr(null);if(m&&Ce.imageAtlas){const P=Ce.imageAtlas,R=P.patternPositions[m.to.toString()],O=P.patternPositions[m.from.toString()];R&&O&&Ge.setConstantPatternPositions(R,O)}const v=y?be:null,E=B?Ln(L,Ce,_,j,v):S?Mr(L,Ce,_,S,j,v):V?Qt(L,Ce,_,ve.lineClipsArray.length,v):bt(L,Ce,_,v);if(B)ae.activeTexture.set(ne.TEXTURE0),Ce.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),Ge.updatePaintBuffers(j);else if(S&&(xe||L.lineAtlas.dirty))ae.activeTexture.set(ne.TEXTURE0),L.lineAtlas.bind(ae);else if(V){const P=ve.gradients[_.id];let R=P.texture;if(_.gradientVersion!==P.version){let O=256;if(_.stepInterpolant){const N=c.getSource().maxzoom,Q=be.canonical.z===N?Math.ceil(1<<L.transform.maxZoom-be.canonical.z):1;O=o.clamp(o.nextPowerOfTwo(ve.maxLineLength/o.EXTENT*1024*Q),256,ae.maxTextureSize)}P.gradient=o.renderColorRamp({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:O,image:P.gradient||void 0,clips:ve.lineClipsArray}),P.texture?P.texture.update(P.gradient):P.texture=new q(ae,P.gradient,ne.RGBA),P.version=_.gradientVersion,R=P.texture}ae.activeTexture.set(ne.TEXTURE0),R.bind(_.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}Ve.draw(ae,ne.TRIANGLES,x,L.stencilModeForClipping(be),b,fr.disabled,E,y,_.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,_.paint,L.transform.zoom,Ge,ve.layoutVertexBuffer2),ue=!1}},fill:function(L,c,_,l){const h=_.paint.get("fill-color"),d=_.paint.get("fill-opacity");if(d.constantOr(1)===0)return;const x=L.colorModeForRenderPass(),b=_.paint.get("fill-pattern"),S=L.opaquePassEnabledForLayer()&&!b.constantOr(1)&&h.constantOr(o.Color.transparent).a===1&&d.constantOr(0)===1?"opaque":"translucent";if(L.renderPass===S){const M=L.depthModeForSublayer(1,L.renderPass==="opaque"?$n.ReadWrite:$n.ReadOnly);Ga(L,c,_,l,M,x,!1)}if(L.renderPass==="translucent"&&_.paint.get("fill-antialias")){const M=L.depthModeForSublayer(_.getPaintProperty("fill-outline-color")?2:0,$n.ReadOnly);Ga(L,c,_,l,M,x,!0)}},"fill-extrusion":function(L,c,_,l){const h=_.paint.get("fill-extrusion-opacity");if(h!==0&&L.renderPass==="translucent"){const d=new $n(L.context.gl.LEQUAL,$n.ReadWrite,L.depthRangeFor3D);if(h!==1||_.paint.get("fill-extrusion-pattern").constantOr(1))fa(L,c,_,l,d,_r.disabled,cr.disabled),fa(L,c,_,l,d,L.stencilModeFor3D(),L.colorModeForRenderPass());else{const x=L.colorModeForRenderPass();fa(L,c,_,l,d,_r.disabled,x)}}},hillshade:function(L,c,_,l){if(L.renderPass!=="offscreen"&&L.renderPass!=="translucent")return;const h=L.context,d=L.depthModeForSublayer(0,$n.ReadOnly),x=L.colorModeForRenderPass(),[b,S]=L.renderPass==="translucent"?L.stencilConfigForOverlap(l):[{},l];for(const M of S){const B=c.getTile(M);B.needsHillshadePrepare!==void 0&&B.needsHillshadePrepare&&L.renderPass==="offscreen"?Sl(L,B,_,d,_r.disabled,x):L.renderPass==="translucent"&&Tl(L,M,B,_,d,b[M.overscaledZ],x)}h.viewport.set([0,0,L.width,L.height])},raster:function(L,c,_,l){if(L.renderPass!=="translucent"||_.paint.get("raster-opacity")===0||!l.length)return;const h=L.context,d=h.gl,x=c.getSource(),b=L.useProgram("raster"),S=L.colorModeForRenderPass(),[M,B]=x instanceof Et?[{},l]:L.stencilConfigForOverlap(l),V=B[B.length-1].overscaledZ,j=!L.options.moving;for(const Y of B){const ae=L.depthModeForSublayer(Y.overscaledZ-V,_.paint.get("raster-opacity")===1?$n.ReadWrite:$n.ReadOnly,d.LESS),ne=c.getTile(Y);ne.registerFadeDuration(_.paint.get("raster-fade-duration"));const ue=c.findLoadedParent(Y,0),be=dr(ne,ue,c,_,L.transform,L.style.terrain);let Ce,ve;const Ge=_.paint.get("raster-resampling")==="nearest"?d.NEAREST:d.LINEAR;h.activeTexture.set(d.TEXTURE0),ne.texture.bind(Ge,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),h.activeTexture.set(d.TEXTURE1),ue?(ue.texture.bind(Ge,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST),Ce=Math.pow(2,ue.tileID.overscaledZ-ne.tileID.overscaledZ),ve=[ne.tileID.canonical.x*Ce%1,ne.tileID.canonical.y*Ce%1]):ne.texture.bind(Ge,d.CLAMP_TO_EDGE,d.LINEAR_MIPMAP_NEAREST);const Te=L.style.terrain&&L.style.terrain.getTerrainData(Y),Ve=Te?Y:null,xe=Ve?Ve.posMatrix:L.transform.calculatePosMatrix(Y.toUnwrapped(),j),y=Gn(xe,ve||[0,0],Ce||1,be,_);x instanceof Et?b.draw(h,d.TRIANGLES,ae,_r.disabled,S,fr.disabled,y,Te,_.id,x.boundsBuffer,L.quadTriangleIndexBuffer,x.boundsSegments):b.draw(h,d.TRIANGLES,ae,M[Y.overscaledZ],S,fr.disabled,y,Te,_.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}},background:function(L,c,_,l){const h=_.paint.get("background-color"),d=_.paint.get("background-opacity");if(d===0)return;const x=L.context,b=x.gl,S=L.transform,M=S.tileSize,B=_.paint.get("background-pattern");if(L.isPatternMissing(B))return;const V=!B&&h.a===1&&d===1&&L.opaquePassEnabledForLayer()?"opaque":"translucent";if(L.renderPass!==V)return;const j=_r.disabled,Y=L.depthModeForSublayer(0,V==="opaque"?$n.ReadWrite:$n.ReadOnly),ae=L.colorModeForRenderPass(),ne=L.useProgram(B?"backgroundPattern":"background"),ue=l||S.coveringTiles({tileSize:M,terrain:L.style.terrain});B&&(x.activeTexture.set(b.TEXTURE0),L.imageManager.bind(L.context));const be=_.getCrossfadeParameters();for(const Ce of ue){const ve=l?Ce.posMatrix:L.transform.calculatePosMatrix(Ce.toUnwrapped()),Ge=B?cA(ve,d,L,B,{tileID:Ce,tileSize:M},be):qA(ve,d,h),Te=L.style.terrain&&L.style.terrain.getTerrainData(Ce);ne.draw(x,b.TRIANGLES,Y,j,ae,fr.disabled,Ge,Te,_.id,L.tileExtentBuffer,L.quadTriangleIndexBuffer,L.tileExtentSegments)}},debug:function(L,c,_){for(let l=0;l<_.length;l++)iu(L,c,_[l])},custom:function(L,c,_){const l=L.context,h=_.implementation;if(L.renderPass==="offscreen"){const d=h.prerender;d&&(L.setCustomLayerDefaults(),l.setColorMode(L.colorModeForRenderPass()),d.call(h,l.gl,L.transform.customLayerMatrix()),l.setDirty(),L.setBaseState())}else if(L.renderPass==="translucent"){L.setCustomLayerDefaults(),l.setColorMode(L.colorModeForRenderPass()),l.setStencilMode(_r.disabled);const d=h.renderingMode==="3d"?new $n(L.context.gl.LEQUAL,$n.ReadWrite,L.depthRangeFor3D):L.depthModeForSublayer(0,$n.ReadOnly);l.setDepthMode(d),h.render(l.gl,L.transform.customLayerMatrix()),l.setDirty(),L.setBaseState(),l.bindFramebuffer.set(null)}}};class _i{constructor(c,_){this.context=new Fs(c),this.transform=_,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.create(),renderTime:0},this.setup(),this.numSublayers=wt.maxUnderzooming+wt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new jt,this.gpuTimers={}}resize(c,_,l){if(this.width=c*l,this.height=_*l,this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const c=this.context,_=new o.PosArray;_.emplaceBack(0,0),_.emplaceBack(o.EXTENT,0),_.emplaceBack(0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(_,pn.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const l=new o.PosArray;l.emplaceBack(0,0),l.emplaceBack(o.EXTENT,0),l.emplaceBack(0,o.EXTENT),l.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=c.createVertexBuffer(l,pn.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const h=new o.RasterBoundsArray;h.emplaceBack(0,0,0,0),h.emplaceBack(o.EXTENT,0,o.EXTENT,0),h.emplaceBack(0,o.EXTENT,0,o.EXTENT),h.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(h,_t.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const d=new o.PosArray;d.emplaceBack(0,0),d.emplaceBack(1,0),d.emplaceBack(0,1),d.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(d,pn.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const x=new o.LineStripIndexArray;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(x);const b=new o.TriangleIndexArray;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(b),this.emptyTexture=new q(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);const S=this.context.gl;this.stencilClearMode=new _r({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO)}clearStencil(){const c=this.context,_=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=o.create();o.ortho(l,0,this.width,this.height,0,0,1),o.scale(l,l,[_.drawingBufferWidth,_.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,_.TRIANGLES,$n.disabled,this.stencilClearMode,cr.disabled,fr.disabled,Ee(l),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,_){if(this.currentStencilSource===c.source||!c.isTileClipped()||!_||!_.length)return;this.currentStencilSource=c.source;const l=this.context,h=l.gl;this.nextStencilID+_.length>256&&this.clearStencil(),l.setColorMode(cr.disabled),l.setDepthMode($n.disabled);const d=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of _){const b=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,S=this.style.terrain&&this.style.terrain.getTerrainData(x);d.draw(l,h.TRIANGLES,$n.disabled,new _r({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),cr.disabled,fr.disabled,Ee(x.posMatrix),S,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,_=this.context.gl;return new _r({func:_.NOTEQUAL,mask:255},c,255,_.KEEP,_.KEEP,_.REPLACE)}stencilModeForClipping(c){const _=this.context.gl;return new _r({func:_.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,_.KEEP,_.KEEP,_.REPLACE)}stencilConfigForOverlap(c){const _=this.context.gl,l=c.sort((x,b)=>b.overscaledZ-x.overscaledZ),h=l[l.length-1].overscaledZ,d=l[0].overscaledZ-h+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const x={};for(let b=0;b<d;b++)x[b+h]=new _r({func:_.GEQUAL,mask:255},b+this.nextStencilID,255,_.KEEP,_.KEEP,_.REPLACE);return this.nextStencilID+=d,[x,l]}return[{[h]:_r.disabled},l]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new cr([c.CONSTANT_COLOR,c.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?cr.unblended:cr.alphaBlended}depthModeForSublayer(c,_,l){if(!this.opaquePassEnabledForLayer())return $n.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new $n(l||this.context.gl.LEQUAL,_,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,_){this.style=c,this.options=_,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const l=this.style._order,h=this.style.sourceCaches,d=this.style.terrain&&new mA(this);for(const M in h){const B=h[M];B.used&&B.prepare(this.context)}const x={},b={},S={};for(const M in h){const B=h[M];x[M]=B.getVisibleCoordinates(),b[M]=x[M].slice().reverse(),S[M]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let M=0;M<l.length;M++)if(this.style._layers[l[M]].is3D()){this.opaquePassCutoff=M;break}if(d){this.opaquePassCutoff=0;const M=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!o.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||M.length)&&(o.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,V){const j=B.context,Y=j.gl,ae=cr.unblended,ne=new $n(Y.LEQUAL,$n.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.sourceCache.getRenderableTiles(),Ce=B.useProgram("terrainDepth");j.bindFramebuffer.set(V.getFramebuffer("depth").framebuffer),j.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),j.clear({color:o.Color.transparent,depth:1});for(const ve of be){const Ge=V.getTerrainData(ve.tileID),Te=B.transform.calculatePosMatrix(ve.tileID.toUnwrapped());Ce.draw(j,Y.TRIANGLES,ne,_r.disabled,ae,fr.backCCW,{u_matrix:Te},Ge,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments)}j.bindFramebuffer.set(null),j.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain),function(B,V){const j=B.context,Y=j.gl,ae=cr.unblended,ne=new $n(Y.LEQUAL,$n.ReadWrite,[0,1]),ue=V.getTerrainMesh(),be=V.getCoordsTexture(),Ce=V.sourceCache.getRenderableTiles(),ve=B.useProgram("terrainCoords");j.bindFramebuffer.set(V.getFramebuffer("coords").framebuffer),j.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),j.clear({color:o.Color.transparent,depth:1}),V.coordsIndex=[];for(const Ge of Ce){const Te=V.getTerrainData(Ge.tileID);j.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,be.texture);const Ve=B.transform.calculatePosMatrix(Ge.tileID.toUnwrapped());ve.draw(j,Y.TRIANGLES,ne,_r.disabled,ae,fr.backCCW,{u_matrix:Ve,u_terrain_coords_id:(255-V.coordsIndex.length)/255,u_texture:0},Te,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),V.coordsIndex.push(Ge.tileID.key)}j.bindFramebuffer.set(null),j.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const M of l){const B=this.style._layers[M];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const V=b[B.source];(B.type==="custom"||V.length)&&this.renderLayer(this,h[B.source],B,V)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:_.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=_.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!d)for(this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){const M=this.style._layers[l[this.currentLayer]],B=h[M.source],V=x[M.source];this._renderTileClippingMasks(M,V),this.renderLayer(this,B,M,V)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){const M=this.style._layers[l[this.currentLayer]],B=h[M.source];if(d&&d.renderLayer(M))continue;const V=(M.type==="symbol"?S:b)[M.source];this._renderTileClippingMasks(M,x[M.source]),this.renderLayer(this,B,M,V)}if(this.options.showTileBoundaries){let M,B;Object.values(this.style._layers).forEach(V=>{V.source&&!V.isHidden(this.transform.zoom)&&(V.source!==(B&&B.id)&&(B=this.style.sourceCaches[V.source]),(!M||M.getSource().maxzoom<B.getSource().maxzoom)&&(M=B))}),M&&li.debug(this,M,M.getVisibleCoordinates())}this.options.showPadding&&function(M){const B=M.transform.padding;Wr(M,M.transform.height-(B.top||0),3,gA),Wr(M,B.bottom||0,3,as),Ir(M,B.left||0,3,ru),Ir(M,M.transform.width-(B.right||0),3,Ml);const V=M.transform.centerPoint;(function(j,Y,ae,ne){ti(j,Y-1,ae-10,2,20,ne),ti(j,Y-10,ae-1,20,2,ne)})(M,V.x,M.transform.height-V.y,hc)}(this),this.context.setDefault()}renderLayer(c,_,l,h){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(h||[]).length)&&(this.id=l.id,this.gpuTimingStart(l),li[l.type](c,_,l,h,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const _=this.context.extTimerQuery;let l=this.gpuTimers[c.id];l||(l=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:_.createQueryEXT()}),l.calls++,_.beginQueryEXT(_.TIME_ELAPSED_EXT,l.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}queryGpuTimers(c){const _={};for(const l in c){const h=c[l],d=this.context.extTimerQuery,x=d.getQueryObjectEXT(h.query,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(h.query),_[l]=x}return _}translatePosMatrix(c,_,l,h,d){if(!l[0]&&!l[1])return c;const x=d?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(x){const M=Math.sin(x),B=Math.cos(x);l=[l[0]*B-l[1]*M,l[0]*M+l[1]*B]}const b=[d?l[0]:Dr(_,l[0],this.transform.zoom),d?l[1]:Dr(_,l[1],this.transform.zoom),0],S=new Float32Array(16);return o.translate(S,c,b),S}saveTileTexture(c){const _=this._tileTextures[c.size[0]];_?_.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const _=this._tileTextures[c];return _&&_.length>0?_.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const _=this.imageManager.getPattern(c.from.toString()),l=this.imageManager.getPattern(c.to.toString());return!_||!l}useProgram(c,_){this.cache=this.cache||{};const l=c+(_?_.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[l]||(this.cache[l]=new za(this.context,c,ai[c],_,ml[c],this._showOverdrawInspector,this.style.terrain)),this.cache[l]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new q(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class ls{constructor(c,_){this.points=c,this.planes=_}static fromInvProjectionMatrix(c,_,l){const h=Math.pow(2,l),d=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const S=1/(b=o.transformMat4([],b,c))[3]/_*h;return o.mul$1(b,b,[S,S,1/b[3],S])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const S=o.sub([],d[b[0]],d[b[1]]),M=o.sub([],d[b[2]],d[b[1]]),B=o.normalize([],o.cross([],S,M)),V=-o.dot(B,d[b[1]]);return B.concat(V)});return new ls(d,x)}}class da{constructor(c,_){this.min=c,this.max=_,this.center=o.scale$1([],o.add([],this.min,this.max),.5)}quadrant(c){const _=[c%2==0,c<2],l=o.clone$2(this.min),h=o.clone$2(this.max);for(let d=0;d<_.length;d++)l[d]=_[d]?this.min[d]:this.center[d],h[d]=_[d]?this.center[d]:this.max[d];return h[2]=this.max[2],new da(l,h)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersects(c){const _=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let l=!0;for(let h=0;h<c.planes.length;h++){const d=c.planes[h];let x=0;for(let b=0;b<_.length;b++)o.dot$1(d,_[b])>=0&&x++;if(x===0)return 0;x!==_.length&&(l=!1)}if(l)return 2;for(let h=0;h<3;h++){let d=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let b=0;b<c.points.length;b++){const S=c.points[b][h]-this.min[h];d=Math.min(d,S),x=Math.max(x,S)}if(x<0||d>this.max[h]-this.min[h])return 0}return 1}}class qi{constructor(c=0,_=0,l=0,h=0){if(isNaN(c)||c<0||isNaN(_)||_<0||isNaN(l)||l<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=_,this.left=l,this.right=h}interpolate(c,_,l){return _.top!=null&&c.top!=null&&(this.top=o.number(c.top,_.top,l)),_.bottom!=null&&c.bottom!=null&&(this.bottom=o.number(c.bottom,_.bottom,l)),_.left!=null&&c.left!=null&&(this.left=o.number(c.left,_.left,l)),_.right!=null&&c.right!=null&&(this.right=o.number(c.right,_.right,l)),this}getCenter(c,_){const l=o.clamp((this.left+c-this.right)/2,0,c),h=o.clamp((this.top+_-this.bottom)/2,0,_);return new o.pointGeometry(l,h)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new qi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class _o{constructor(c,_,l,h,d){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=d===void 0||!!d,this._minZoom=c||0,this._maxZoom=_||22,this._minPitch=l??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new qi,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const c=new _o(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c._elevation=this._elevation,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){const _=-o.wrap(c,-180,180)*Math.PI/180;var l;this.angle!==_&&(this._unmodified=!1,this.angle=_,this._calcMatrices(),this.rotationMatrix=(l=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(l[1]=0,l[2]=0),l[0]=1,l[3]=1,l),function(h,d,x){var b=d[0],S=d[1],M=d[2],B=d[3],V=Math.sin(x),j=Math.cos(x);h[0]=b*j+M*V,h[1]=S*j+B*V,h[2]=b*-V+M*j,h[3]=S*-V+B*j}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const _=o.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==_&&(this._unmodified=!1,this._pitch=_,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(c){const _=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==_&&(this._unmodified=!1,this._zoom=_,this.scale=this.zoomScale(_),this.tileZoom=Math.floor(_),this.zoomFraction=_-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(c){c!==this._elevation&&(this._elevation=c,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,_,l){this._unmodified=!1,this._edgeInsets.interpolate(c,_,l),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const _=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,_)}getVisibleUnwrappedCoordinates(c){const _=[new o.UnwrappedTileID(0,c)];if(this._renderWorldCopies){const l=this.pointCoordinate(new o.pointGeometry(0,0)),h=this.pointCoordinate(new o.pointGeometry(this.width,0)),d=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),x=this.pointCoordinate(new o.pointGeometry(0,this.height)),b=Math.floor(Math.min(l.x,h.x,d.x,x.x)),S=Math.floor(Math.max(l.x,h.x,d.x,x.x)),M=1;for(let B=b-M;B<=S+M;B++)B!==0&&_.push(new o.UnwrappedTileID(B,c))}return _}coveringTiles(c){var _,l;let h=this.coveringZoomLevel(c);const d=h;if(c.minzoom!==void 0&&h<c.minzoom)return[];c.maxzoom!==void 0&&h>c.maxzoom&&(h=c.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),b=o.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,h),M=[S*x.x,S*x.y,0],B=[S*b.x,S*b.y,0],V=ls.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h);let j=c.minzoom||0;!c.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(j=h);const Y=c.terrain?2/Math.min(this.tileSize,c.tileSize)*this.tileSize:3,ae=ve=>({aabb:new da([ve*S,0,0],[(ve+1)*S,S,0]),zoom:0,x:0,y:0,wrap:ve,fullyVisible:!1}),ne=[],ue=[],be=h,Ce=c.reparseOverscaled?d:h;if(this._renderWorldCopies)for(let ve=1;ve<=3;ve++)ne.push(ae(-ve)),ne.push(ae(ve));for(ne.push(ae(0));ne.length>0;){const ve=ne.pop(),Ge=ve.x,Te=ve.y;let Ve=ve.fullyVisible;if(!Ve){const P=ve.aabb.intersects(V);if(P===0)continue;Ve=P===2}const xe=c.terrain?M:B,y=ve.aabb.distanceX(xe),m=ve.aabb.distanceY(xe),v=Math.max(Math.abs(y),Math.abs(m)),E=Y+(1<<be-ve.zoom)-2;if(ve.zoom===be||v>E&&ve.zoom>=j){const P=be-ve.zoom,R=M[0]-.5-(Ge<<P),O=M[1]-.5-(Te<<P);ue.push({tileID:new o.OverscaledTileID(ve.zoom===be?Ce:ve.zoom,ve.wrap,ve.zoom,Ge,Te),distanceSq:o.sqrLen([B[0]-.5-Ge,B[1]-.5-Te]),tileDistanceToCamera:Math.sqrt(R*R+O*O)})}else for(let P=0;P<4;P++){const R=(Ge<<1)+P%2,O=(Te<<1)+(P>>1),N=ve.zoom+1;let Q=ve.aabb.quadrant(P);if(c.terrain){const J=new o.OverscaledTileID(N,ve.wrap,N,R,O),le=c.terrain.getMinMaxElevation(J),de=(_=le.minElevation)!==null&&_!==void 0?_:this.elevation,Re=(l=le.maxElevation)!==null&&l!==void 0?l:this.elevation;Q=new da([Q.min[0],Q.min[1],de],[Q.max[0],Q.max[1],Re])}ne.push({aabb:Q,zoom:N,x:R,y:O,wrap:ve.wrap,fullyVisible:Ve})}}return ue.sort((ve,Ge)=>ve.distanceSq-Ge.distanceSq).map(ve=>ve.tileID)}resize(c,_){this.width=c,this.height=_,this.pixelsToGLUnits=[2/c,-2/_],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const _=o.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.pointGeometry(o.mercatorXfromLng(c.lng)*this.worldSize,o.mercatorYfromLat(_)*this.worldSize)}unproject(c){return new o.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(c){this.freezeElevation||(this.elevation=c?this.getElevation(this._center,c):0)}getElevation(c,_){const l=o.MercatorCoordinate.fromLngLat(c),h=(1<<this.tileZoom)*o.EXTENT,d=l.x*h,x=l.y*h,b=Math.floor(d/o.EXTENT),S=Math.floor(x/o.EXTENT),M=new o.OverscaledTileID(this.tileZoom,0,this.tileZoom,b,S);return _.getElevation(M,d%o.EXTENT,x%o.EXTENT,o.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(c){const _=this.pointLocation(this.centerPoint,c),l=this.getElevation(_,c);if(!(this.elevation-l))return;const h=this.getCameraPosition(),d=o.MercatorCoordinate.fromLngLat(h.lngLat,h.altitude),x=o.MercatorCoordinate.fromLngLat(_,l),b=d.x-x.x,S=d.y-x.y,M=d.z-x.z,B=Math.sqrt(b*b+S*S+M*M),V=this.scaleZoom(this.cameraToCenterDistance/B/this.tileSize);this._elevation=l,this._center=_,this.zoom=V}setLocationAtPoint(c,_){const l=this.pointCoordinate(_),h=this.pointCoordinate(this.centerPoint),d=this.locationCoordinate(c),x=new o.MercatorCoordinate(d.x-(l.x-h.x),d.y-(l.y-h.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c,_){return _?this.coordinatePoint(this.locationCoordinate(c),this.getElevation(c,_),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(c))}pointLocation(c,_){return this.coordinateLocation(this.pointCoordinate(c,_))}locationCoordinate(c){return o.MercatorCoordinate.fromLngLat(c)}coordinateLocation(c){return c&&c.toLngLat()}pointCoordinate(c,_){if(_){const j=_.pointCoordinate(c);if(j!=null)return j}const l=[c.x,c.y,0,1],h=[c.x,c.y,1,1];o.transformMat4(l,l,this.pixelMatrixInverse),o.transformMat4(h,h,this.pixelMatrixInverse);const d=l[3],x=h[3],b=l[1]/d,S=h[1]/x,M=l[2]/d,B=h[2]/x,V=M===B?0:(0-M)/(B-M);return new o.MercatorCoordinate(o.number(l[0]/d,h[0]/x,V)/this.worldSize,o.number(b,S,V)/this.worldSize)}coordinatePoint(c,_=0,l=this.pixelMatrix){const h=[c.x*this.worldSize,c.y*this.worldSize,_,1];return o.transformMat4(h,h,l),new o.pointGeometry(h[0]/h[3],h[1]/h[3])}getBounds(){const c=Math.max(0,this.height/2-this.getHorizon());return new o.LngLatBounds().extend(this.pointLocation(new o.pointGeometry(0,c))).extend(this.pointLocation(new o.pointGeometry(this.width,c))).extend(this.pointLocation(new o.pointGeometry(this.width,this.height))).extend(this.pointLocation(new o.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(c,_=!1){const l=c.key,h=_?this._alignedPosMatrixCache:this._posMatrixCache;if(h[l])return h[l];const d=c.canonical,x=this.worldSize/this.zoomScale(d.z),b=d.x+Math.pow(2,d.z)*c.wrap,S=o.identity(new Float64Array(16));return o.translate(S,S,[b*x,d.y*x,0]),o.scale(S,S,[x/o.EXTENT,x/o.EXTENT,1]),o.multiply(S,_?this.alignedProjMatrix:this.projMatrix,S),h[l]=new Float32Array(S),h[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let c,_,l,h,d=-90,x=90,b=-180,S=180;const M=this.size,B=this._unmodified;if(this.latRange){const Y=this.latRange;d=o.mercatorYfromLat(Y[1])*this.worldSize,x=o.mercatorYfromLat(Y[0])*this.worldSize,c=x-d<M.y?M.y/(x-d):0}if(this.lngRange){const Y=this.lngRange;b=o.wrap(o.mercatorXfromLng(Y[0])*this.worldSize,0,this.worldSize),S=o.wrap(o.mercatorXfromLng(Y[1])*this.worldSize,0,this.worldSize),S<b&&(S+=this.worldSize),_=S-b<M.x?M.x/(S-b):0}const V=this.point,j=Math.max(_||0,c||0);if(j)return this.center=this.unproject(new o.pointGeometry(_?(S+b)/2:V.x,c?(x+d)/2:V.y)),this.zoom+=this.scaleZoom(j),this._unmodified=B,void(this._constraining=!1);if(this.latRange){const Y=V.y,ae=M.y/2;Y-ae<d&&(h=d+ae),Y+ae>x&&(h=x-ae)}if(this.lngRange){const Y=(b+S)/2,ae=o.wrap(V.x,Y-this.worldSize/2,Y+this.worldSize/2),ne=M.x/2;ae-ne<b&&(l=b+ne),ae+ne>S&&(l=S-ne)}l===void 0&&h===void 0||(this.center=this.unproject(new o.pointGeometry(l!==void 0?l:V.x,h!==void 0?h:V.y)).wrap()),this._unmodified=B,this._constraining=!1}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,_=this.point.x,l=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let h=o.identity(new Float64Array(16));o.scale(h,h,[this.width/2,-this.height/2,1]),o.translate(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=o.identity(new Float64Array(16)),o.scale(h,h,[1,-1,1]),o.translate(h,h,[-1,-1,0]),o.scale(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const d=Math.PI/2+this._pitch,x=this._fov*(.5+c.y/this.height),b=Math.sin(x)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-d-x,.01,Math.PI-.01)),S=this.getHorizon(),M=2*Math.atan(S/this.cameraToCenterDistance)*(.5+c.y/(2*S)),B=Math.sin(M)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-d-M,.01,Math.PI-.01)),V=Math.cos(Math.PI/2-this._pitch)*b+this.cameraToSeaLevelDistance,j=Math.cos(Math.PI/2-this._pitch)*B+this.cameraToSeaLevelDistance,Y=1.01*Math.min(V,j),ae=this.height/50;h=new Float64Array(16),o.perspective(h,this._fov,this.width/this.height,ae,Y),h[8]=2*-c.x/this.width,h[9]=2*c.y/this.height,o.scale(h,h,[1,-1,1]),o.translate(h,h,[0,0,-this.cameraToCenterDistance]),o.rotateX(h,h,this._pitch),o.rotateZ(h,h,this.angle),o.translate(h,h,[-_,-l,0]),this.mercatorMatrix=o.scale([],h,[this.worldSize,this.worldSize,this.worldSize]),o.scale(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,h),o.translate(h,h,[0,0,-this.elevation]),this.projMatrix=h,this.invProjMatrix=o.invert([],h),this.pixelMatrix3D=o.multiply(new Float64Array(16),this.labelPlaneMatrix,h);const ne=this.width%2/2,ue=this.height%2/2,be=Math.cos(this.angle),Ce=Math.sin(this.angle),ve=_-Math.round(_)+be*ne+Ce*ue,Ge=l-Math.round(l)+be*ue+Ce*ne,Te=new Float64Array(h);if(o.translate(Te,Te,[ve>.5?ve-1:ve,Ge>.5?Ge-1:Ge,0]),this.alignedProjMatrix=Te,h=o.invert(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const c=this.pointCoordinate(new o.pointGeometry(0,0)),_=[c.x*this.worldSize,c.y*this.worldSize,0,1];return o.transformMat4(_,_,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,c))}getCameraQueryGeometry(c){const _=this.getCameraPoint();if(c.length===1)return[c[0],_];{let l=_.x,h=_.y,d=_.x,x=_.y;for(const b of c)l=Math.min(l,b.x),h=Math.min(h,b.y),d=Math.max(d,b.x),x=Math.max(x,b.y);return[new o.pointGeometry(l,h),new o.pointGeometry(d,h),new o.pointGeometry(d,x),new o.pointGeometry(l,x),new o.pointGeometry(l,h)]}}}class hi{constructor(c){this._hashName=c&&encodeURIComponent(c),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(_,l){let h=!1,d=null;const x=()=>{d=null,h&&(_(),d=setTimeout(x,300),h=!1)};return()=>(h=!0,d||x(),d)}(this._updateHashUnthrottled.bind(this))}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){const _=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,h=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,h),x=Math.round(_.lng*d)/d,b=Math.round(_.lat*d)/d,S=this._map.getBearing(),M=this._map.getPitch();let B="";if(B+=c?`/${x}/${b}/${l}`:`${l}/${b}/${x}`,(S||M)&&(B+="/"+Math.round(10*S)/10),M&&(B+=`/${Math.round(M)}`),this._hashName){const V=this._hashName;let j=!1;const Y=window.location.hash.slice(1).split("&").map(ae=>{const ne=ae.split("=")[0];return ne===V?(j=!0,`${ne}=${B}`):ae}).filter(ae=>ae);return j||Y.push(`${V}=${B}`),`#${Y.join("&")}`}return`#${B}`}_getCurrentHash(){const c=window.location.hash.replace("#","");if(this._hashName){let _;return c.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(_=l)}),(_&&_[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._getCurrentHash();if(c.length>=3&&!c.some(_=>isNaN(_))){const _=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:_,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,c)}catch{}}}const $a={linearity:.3,easing:o.bezier(0,0,.3,1)},Cl=o.extend({deceleration:2500,maxSpeed:1400},$a),ja=o.extend({deceleration:20,maxSpeed:1400},$a),Vs=o.extend({deceleration:1e3,maxSpeed:360},$a),As=o.extend({deceleration:1e3,maxSpeed:90},$a);class dc{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,_=o.exported.now();for(;c.length>0&&_-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const _={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)_.zoom+=d.zoomDelta||0,_.bearing+=d.bearingDelta||0,_.pitch+=d.pitchDelta||0,d.panDelta&&_.pan._add(d.panDelta),d.around&&(_.around=d.around),d.pinchAround&&(_.pinchAround=d.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(_.pan.mag()){const d=Ha(_.pan.mag(),l,o.extend({},Cl,c||{}));h.offset=_.pan.mult(d.amount/_.pan.mag()),h.center=this._map.transform.center,pa(h,d)}if(_.zoom){const d=Ha(_.zoom,l,ja);h.zoom=this._map.transform.zoom+d.amount,pa(h,d)}if(_.bearing){const d=Ha(_.bearing,l,Vs);h.bearing=this._map.transform.bearing+o.clamp(d.amount,-179,179),pa(h,d)}if(_.pitch){const d=Ha(_.pitch,l,As);h.pitch=this._map.transform.pitch+d.amount,pa(h,d)}if(h.zoom||h.bearing){const d=_.pinchAround===void 0?_.around:_.pinchAround;h.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),o.extend(h,{noMoveStart:!0})}}function pa(L,c){(!L.duration||L.duration<c.duration)&&(L.duration=c.duration,L.easing=c.easing)}function Ha(L,c,_){const{maxSpeed:l,linearity:h,deceleration:d}=_,x=o.clamp(L*h/(c/1e3),-l,l),b=Math.abs(x)/(d*h);return{easing:_.easing,duration:1e3*b,amount:x*(b/2)}}class ni extends o.Event{constructor(c,_,l,h={}){const d=k.mousePos(_.getCanvasContainer(),l),x=_.unproject(d);super(c,o.extend({point:d,lngLat:x,originalEvent:l},h)),this._defaultPrevented=!1,this.target=_}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Es extends o.Event{constructor(c,_,l){const h=c==="touchend"?l.changedTouches:l.touches,d=k.touchPos(_.getCanvasContainer(),h),x=d.map(S=>_.unproject(S)),b=d.reduce((S,M,B,V)=>S.add(M.div(V.length)),new o.pointGeometry(0,0));super(c,{points:d,point:b,lngLats:x,lngLat:_.unproject(b),originalEvent:l}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Zi extends o.Event{constructor(c,_,l){super(c,{originalEvent:l}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Pl{constructor(c,_){this._map=c,this._clickTolerance=_.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new Zi(c.type,this._map,c))}mousedown(c,_){return this._mousedownPos=_,this._firePreventable(new ni(c.type,this._map,c))}mouseup(c){this._map.fire(new ni(c.type,this._map,c))}click(c,_){this._mousedownPos&&this._mousedownPos.dist(_)>=this._clickTolerance||this._map.fire(new ni(c.type,this._map,c))}dblclick(c){return this._firePreventable(new ni(c.type,this._map,c))}mouseover(c){this._map.fire(new ni(c.type,this._map,c))}mouseout(c){this._map.fire(new ni(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Es(c.type,this._map,c))}touchmove(c){this._map.fire(new Es(c.type,this._map,c))}touchend(c){this._map.fire(new Es(c.type,this._map,c))}touchcancel(c){this._map.fire(new Es(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ho{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new ni(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ni("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new ni(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pc{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=_.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,_){this.isEnabled()&&c.shiftKey&&c.button===0&&(k.disableDrag(),this._startPos=this._lastPos=_,this._active=!0)}mousemoveWindow(c,_){if(!this._active)return;const l=_;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=l,this._box||(this._box=k.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const d=Math.min(h.x,l.x),x=Math.max(h.x,l.x),b=Math.min(h.y,l.y),S=Math.max(h.y,l.y);k.setTransform(this._box,`translate(${d}px,${b}px)`),this._box.style.width=x-d+"px",this._box.style.height=S-b+"px"}mouseupWindow(c,_){if(!this._active||c.button!==0)return;const l=this._startPos,h=_;if(this.reset(),k.suppressClick(),l.x!==h.x||l.y!==h.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:d=>d.fitScreenCoordinates(l,h,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(k.remove(this._box),this._box=null),k.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,_){return this._map.fire(new o.Event(c,{originalEvent:_}))}}function vo(L,c){if(L.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${L.length}, points ${c.length}`);const _={};for(let l=0;l<L.length;l++)_[L[l].identifier]=c[l];return _}class Il{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,_,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),l.length===this.numTouches&&(this.centroid=function(h){const d=new o.pointGeometry(0,0);for(const x of h)d._add(x);return d.div(h.length)}(_),this.touches=vo(l,_)))}touchmove(c,_,l){if(this.aborted||!this.centroid)return;const h=vo(l,_);for(const d in this.touches){const x=this.touches[d],b=h[d];(!b||b.dist(x)>30)&&(this.aborted=!0)}}touchend(c,_,l){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class Wa{constructor(c){this.singleTap=new Il(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,_,l){this.singleTap.touchstart(c,_,l)}touchmove(c,_,l){this.singleTap.touchmove(c,_,l)}touchend(c,_,l){const h=this.singleTap.touchend(c,_,l);if(h){const d=c.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(h)<30;if(d&&x||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class gh{constructor(){this._zoomIn=new Wa({numTouches:1,numTaps:2}),this._zoomOut=new Wa({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,_,l){this._zoomIn.touchstart(c,_,l),this._zoomOut.touchstart(c,_,l)}touchmove(c,_,l){this._zoomIn.touchmove(c,_,l),this._zoomOut.touchmove(c,_,l)}touchend(c,_,l){const h=this._zoomIn.touchend(c,_,l),d=this._zoomOut.touchend(c,_,l);return h?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()+1,around:x.unproject(h)},{originalEvent:c})}):d?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:x.getZoom()-1,around:x.unproject(d)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const mh={0:1,2:2};class Qa{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(c,_){return!1}_move(c,_){return{}}mousedown(c,_){if(this._lastPoint)return;const l=k.mouseButton(c);this._correctButton(c,l)&&(this._lastPoint=_,this._eventButton=l)}mousemoveWindow(c,_){const l=this._lastPoint;if(l){if(c.preventDefault(),function(h,d){const x=mh[d];return h.buttons===void 0||(h.buttons&x)!==x}(c,this._eventButton))this.reset();else if(this._moved||!(_.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=_,this._move(l,_)}}mouseupWindow(c){this._lastPoint&&k.mouseButton(c)===this._eventButton&&(this._moved&&k.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ga extends Qa{mousedown(c,_){super.mousedown(c,_),this._lastPoint&&(this._active=!0)}_correctButton(c,_){return _===0&&!c.ctrlKey}_move(c,_){return{around:_,panDelta:_.sub(c)}}}class us extends Qa{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const l=.8*(_.x-c.x);if(l)return this._active=!0,{bearingDelta:l}}contextmenu(c){c.preventDefault()}}class Nt extends Qa{_correctButton(c,_){return _===0&&c.ctrlKey||_===2}_move(c,_){const l=-.5*(_.y-c.y);if(l)return this._active=!0,{pitchDelta:l}}contextmenu(c){c.preventDefault()}}class su{constructor(c,_){this._minTouches=c.cooperativeGestures?2:1,this._clickTolerance=c.clickTolerance||1,this._map=_,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(c,_,l){return this._calculateTransform(c,_,l)}touchmove(c,_,l){if(this._map._cooperativeGestures&&(this._minTouches===2&&l.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(c,!1,l.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(l.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,_,l)}touchend(c,_,l){this._calculateTransform(c,_,l),this._active&&l.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,_,l){l.length>0&&(this._active=!0);const h=vo(l,_),d=new o.pointGeometry(0,0),x=new o.pointGeometry(0,0);let b=0;for(const M in h){const B=h[M],V=this._touches[M];V&&(d._add(B),x._add(B.sub(V)),b++,h[M]=B)}if(this._touches=h,b<this._minTouches||!x.mag())return;const S=x.div(b);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(b),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ma{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(c){}_move(c,_,l){return{}}touchstart(c,_,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([_[0],_[1]]))}touchmove(c,_,l){if(!this._firstTwoTouches)return;c.preventDefault();const[h,d]=this._firstTwoTouches,x=Wo(l,_,h),b=Wo(l,_,d);if(!x||!b)return;const S=this._aroundCenter?null:x.add(b).div(2);return this._move([x,b],S,c)}touchend(c,_,l){if(!this._firstTwoTouches)return;const[h,d]=this._firstTwoTouches,x=Wo(l,_,h),b=Wo(l,_,d);x&&b||(this._active&&k.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Wo(L,c,_){for(let l=0;l<L.length;l++)if(L[l].identifier===_)return c[l]}function ou(L,c){return Math.log(L/c)/Math.LN2}class Vt extends ma{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,_){const l=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(ou(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ou(this._distance,l),pinchAround:_}}}function yA(L,c){return 180*L.angleWith(c)/Math.PI}class kl extends ma{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,_){const l=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:yA(this._vector,l),pinchAround:_}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const _=25/(Math.PI*this._minDiameter)*360,l=yA(c,this._startVector);return Math.abs(l)<_}}function _A(L){return Math.abs(L.y)>Math.abs(L.x)}class qa extends ma{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,_,l){super.touchstart(c,_,l),this._currentTouchCount=l.length}_start(c){this._lastPoints=c,_A(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,_,l){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const h=c[0].sub(this._lastPoints[0]),d=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,d,l.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(h.y+d.y)/2*-.5}):void 0}gestureBeginsVertically(c,_,l){if(this._valid!==void 0)return this._valid;const h=c.mag()>=2,d=_.mag()>=2;if(!h&&!d)return;if(!h||!d)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const x=c.y>0==_.y>0;return _A(c)&&_A(_)&&x}}const Gs={panStep:100,bearingStep:15,pitchStep:10};class au{constructor(){const c=Gs;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let _=0,l=0,h=0,d=0,x=0;switch(c.keyCode){case 61:case 107:case 171:case 187:_=1;break;case 189:case 109:case 173:_=-1;break;case 37:c.shiftKey?l=-1:(c.preventDefault(),d=-1);break;case 39:c.shiftKey?l=1:(c.preventDefault(),d=1);break;case 38:c.shiftKey?h=1:(c.preventDefault(),x=-1);break;case 40:c.shiftKey?h=-1:(c.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(l=0,h=0),{cameraAnimation:b=>{const S=b.getZoom();b.easeTo({duration:300,easeId:"keyboardHandler",easing:yh,zoom:_?Math.round(S)+_*(c.shiftKey?2:1):S,bearing:b.getBearing()+l*this._bearingStep,pitch:b.getPitch()+h*this._pitchStep,offset:[-d*this._panStep,-x*this._panStep],center:b.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function yh(L){return L*(2-L)}const gc=4.000244140625;class lu{constructor(c,_){this._map=c,this._el=c.getCanvasContainer(),this._handler=_,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;c.preventDefault()}let _=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const l=o.exported.now(),h=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,_!==0&&_%gc==0?this._type="wheel":_!==0&&Math.abs(_)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=_,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(h*_)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,_+=this._lastValue)),c.shiftKey&&_&&(_/=4),this._type&&(this._lastWheelEvent=c,this._delta-=_,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const _=k.mousePos(this._el,c);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(_)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>gc?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&S!==0&&(S=1/S);const M=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(M*S))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,l=this._startZoom,h=this._easing;let d,x=!1;if(this._type==="wheel"&&l&&h){const b=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),S=h(b);d=o.number(l,_,S),b<1?this._frameId||(this._frameId=!0):x=!0}else d=_,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:d-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let _=o.ease;if(this._prevEase){const l=this._prevEase,h=(o.exported.now()-l.start)/l.duration,d=l.easing(h+.01)-l.easing(h),x=.27/Math.sqrt(d*d+1e-4)*.01,b=Math.sqrt(.0729-x*x);_=o.bezier(x,b,.25,1)}return this._prevEase={start:o.exported.now(),duration:c,easing:_},_}reset(){this._active=!1}}class Au{constructor(c,_){this._clickZoom=c,this._tapZoom=_}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class uu{constructor(){this.reset()}reset(){this._active=!1}dblclick(c,_){return c.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:l.getZoom()+(c.shiftKey?-1:1),around:l.unproject(_)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $s{constructor(){this._tap=new Wa({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(c,_,l){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=_[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(c,_,l))}touchmove(c,_,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const h=_[0],d=h.y-this._swipePoint.y;return this._swipePoint=h,c.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(c,_,l)}touchend(c,_,l){this._tapTime?this._swipePoint&&l.length===0&&this.reset():this._tap.touchend(c,_,l)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ki{constructor(c,_,l){this._el=c,this._mousePan=_,this._touchPan=l}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xo{constructor(c,_,l){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=_,this._mousePitch=l}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class cu{constructor(c,_,l,h){this._el=c,this._touchZoom=_,this._touchRotate=l,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ya=L=>L.zoom||L.drag||L.pitch||L.rotate;class Br extends o.Event{}function Ll(L){return L.panDelta&&L.panDelta.mag()||L.zoomDelta||L.bearingDelta||L.pitchDelta}class mc{constructor(c,_){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new dc(c),this._bearingSnap=_.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(_),o.bindAll(["handleEvent","handleWindowEvent"],this);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,d,x]of this._listeners)k.addEventListener(h,d,h===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[c,_,l]of this._listeners)k.removeEventListener(c,_,c===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(c){const _=this._map,l=_.getCanvasContainer();this._add("mapEvent",new Pl(_,c));const h=_.boxZoom=new pc(_,c);this._add("boxZoom",h);const d=new gh,x=new uu;_.doubleClickZoom=new Au(x,d),this._add("tapZoom",d),this._add("clickZoom",x);const b=new $s;this._add("tapDragZoom",b);const S=_.touchPitch=new qa(_);this._add("touchPitch",S);const M=new us(c),B=new Nt(c);_.dragRotate=new xo(c,M,B),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const V=new ga(c),j=new su(c,_);_.dragPan=new ki(l,V,j),this._add("mousePan",V),this._add("touchPan",j,["touchZoom","touchRotate"]);const Y=new kl,ae=new Vt;_.touchZoomRotate=new cu(l,ae,Y,b),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",ae,["touchPan","touchRotate"]);const ne=_.scrollZoom=new lu(_,this);this._add("scrollZoom",ne,["mousePan"]);const ue=_.keyboard=new au;this._add("keyboard",ue),this._add("blockableMapEvent",new Ho(_));for(const be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[be]&&_[be].enable(c[be])}_add(c,_,l){this._handlers.push({handlerName:c,handler:_,allowed:l}),this._handlersById[c]=_}stop(c){if(!this._updatingCamera){for(const{handler:_}of this._handlers)_.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ya(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,_,l){for(const h in c)if(h!==l&&(!_||_.indexOf(h)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const _=[];for(const l of c)this._el.contains(l.target)&&_.push(l);return _}handleEvent(c,_){if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const l=c.type==="renderFrame"?void 0:c,h={needsRenderFrame:!1},d={},x={},b=c.touches,S=b?this._getMapTouches(b):void 0,M=S?k.touchPos(this._el,S):k.mousePos(this._el,c);for(const{handlerName:j,handler:Y,allowed:ae}of this._handlers){if(!Y.isEnabled())continue;let ne;this._blockedByActive(x,ae,j)?Y.reset():Y[_||c.type]&&(ne=Y[_||c.type](c,M,S),this.mergeHandlerResult(h,d,ne,j,l),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()),(ne||Y.isActive())&&(x[j]=Y)}const B={};for(const j in this._previousActiveHandlers)x[j]||(B[j]=l);this._previousActiveHandlers=x,(Object.keys(B).length||Ll(h))&&(this._changes.push([h,d,B]),this._triggerRenderFrame()),(Object.keys(x).length||Ll(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=h;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(c,_,l,h,d){if(!l)return;o.extend(c,l);const x={handlerName:h,originalEvent:l.originalEvent||d};l.zoomDelta!==void 0&&(_.zoom=x),l.panDelta!==void 0&&(_.drag=x),l.pitchDelta!==void 0&&(_.pitch=x),l.bearingDelta!==void 0&&(_.rotate=x)}_applyChanges(){const c={},_={},l={};for(const[h,d,x]of this._changes)h.panDelta&&(c.panDelta=(c.panDelta||new o.pointGeometry(0,0))._add(h.panDelta)),h.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(c.around=h.around),h.pinchAround!==void 0&&(c.pinchAround=h.pinchAround),h.noInertia&&(c.noInertia=h.noInertia),o.extend(_,d),o.extend(l,x);this._updateMapTransform(c,_,l),this._changes=[]}_updateMapTransform(c,_,l){const h=this._map,d=h.transform,x=h.style&&h.style.terrain;if(!(Ll(c)||x&&this._drag))return this._fireEvents(_,l,!0);let{panDelta:b,zoomDelta:S,bearingDelta:M,pitchDelta:B,around:V,pinchAround:j}=c;j!==void 0&&(V=j),h._stop(!0),V=V||h.transform.centerPoint;const Y=d.pointLocation(b?V.sub(b):V);M&&(d.bearing+=M),B&&(d.pitch+=B),S&&(d.zoom+=S),x?_.drag&&!this._drag?(this._drag={center:d.centerPoint,lngLat:d.pointLocation(V),point:V,handlerName:_.drag.handlerName},h.fire(new o.Event("freezeElevation",{freeze:!0}))):this._drag&&l[this._drag.handlerName]?(h.fire(new o.Event("freezeElevation",{freeze:!1})),this._drag=null):_.drag&&this._drag&&(d.center=d.pointLocation(d.centerPoint.sub(b))):d.setLocationAtPoint(Y,V),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(_,l,!0)}_fireEvents(c,_,l){const h=ya(this._eventsInProgress),d=ya(c),x={};for(const B in c){const{originalEvent:V}=c[B];this._eventsInProgress[B]||(x[`${B}start`]=V),this._eventsInProgress[B]=c[B]}!h&&d&&this._fireEvent("movestart",d.originalEvent);for(const B in x)this._fireEvent(B,x[B]);d&&this._fireEvent("move",d.originalEvent);for(const B in c){const{originalEvent:V}=c[B];this._fireEvent(B,V)}const b={};let S;for(const B in this._eventsInProgress){const{handlerName:V,originalEvent:j}=this._eventsInProgress[B];this._handlersById[V].isActive()||(delete this._eventsInProgress[B],S=_[V]||j,b[`${B}end`]=S)}for(const B in b)this._fireEvent(B,b[B]);const M=ya(this._eventsInProgress);if(l&&(h||d)&&!M){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=j=>j!==0&&-this._bearingSnap<j&&j<this._bearingSnap;B?(V(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:S})):(this._map.fire(new o.Event("moveend",{originalEvent:S})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,_){this._map.fire(new o.Event(c,_?{originalEvent:_}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new Br("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const cs={extend:(L,...c)=>o.extend(L,...c),run(L){L()},logToElement(L,c=!1,_="log"){const l=window.document.getElementById(_);l&&(c&&(l.innerHTML=""),l.innerHTML+=`<br>${L}`)}};class br extends o.Evented{constructor(c,_){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=_.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,_){return this.jumpTo({center:c},_)}panBy(c,_,l){return c=o.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,o.extend({offset:c},_),l)}panTo(c,_,l){return this.easeTo(o.extend({center:c},_),l)}getZoom(){return this.transform.zoom}setZoom(c,_){return this.jumpTo({zoom:c},_),this}zoomTo(c,_,l){return this.easeTo(o.extend({zoom:c},_),l)}zoomIn(c,_){return this.zoomTo(this.getZoom()+1,c,_),this}zoomOut(c,_){return this.zoomTo(this.getZoom()-1,c,_),this}getBearing(){return this.transform.bearing}setBearing(c,_){return this.jumpTo({bearing:c},_),this}getPadding(){return this.transform.padding}setPadding(c,_){return this.jumpTo({padding:c},_),this}rotateTo(c,_,l){return this.easeTo(o.extend({bearing:c},_),l)}resetNorth(c,_){return this.rotateTo(0,o.extend({duration:1e3},c),_),this}resetNorthPitch(c,_){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},c),_),this}snapToNorth(c,_){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,_):this}getPitch(){return this.transform.pitch}setPitch(c,_){return this.jumpTo({pitch:c},_),this}cameraForBounds(c,_){c=o.LngLatBounds.convert(c);const l=_&&_.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),l,_)}_cameraForBoxAndBearing(c,_,l,h){const d={top:0,bottom:0,right:0,left:0};if(typeof(h=o.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const Te=h.padding;h.padding={top:Te,bottom:Te,right:Te,left:Te}}h.padding=o.extend(d,h.padding);const x=this.transform,b=x.padding,S=x.project(o.LngLat.convert(c)),M=x.project(o.LngLat.convert(_)),B=S.rotate(-l*Math.PI/180),V=M.rotate(-l*Math.PI/180),j=new o.pointGeometry(Math.max(B.x,V.x),Math.max(B.y,V.y)),Y=new o.pointGeometry(Math.min(B.x,V.x),Math.min(B.y,V.y)),ae=j.sub(Y),ne=(x.width-(b.left+b.right+h.padding.left+h.padding.right))/ae.x,ue=(x.height-(b.top+b.bottom+h.padding.top+h.padding.bottom))/ae.y;if(ue<0||ne<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const be=Math.min(x.scaleZoom(x.scale*Math.min(ne,ue)),h.maxZoom),Ce=o.pointGeometry.convert(h.offset),ve=new o.pointGeometry((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(l*Math.PI/180),Ge=Ce.add(ve).mult(x.scale/x.zoomScale(be));return{center:x.unproject(S.add(M).div(2).sub(Ge)),zoom:be,bearing:l}}fitBounds(c,_,l){return this._fitInternal(this.cameraForBounds(c,_),_,l)}fitScreenCoordinates(c,_,l,h,d){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(c)),this.transform.pointLocation(o.pointGeometry.convert(_)),l,h),h,d)}_fitInternal(c,_,l){return c?(delete(_=o.extend(c,_)).padding,_.linear?this.easeTo(_,l):this.flyTo(_,l)):this}jumpTo(c,_){this.stop();const l=this.transform;let h=!1,d=!1,x=!1;return"zoom"in c&&l.zoom!==+c.zoom&&(h=!0,l.zoom=+c.zoom),c.center!==void 0&&(l.center=o.LngLat.convert(c.center)),"bearing"in c&&l.bearing!==+c.bearing&&(d=!0,l.bearing=+c.bearing),"pitch"in c&&l.pitch!==+c.pitch&&(x=!0,l.pitch=+c.pitch),c.padding==null||l.isPaddingEqual(c.padding)||(l.padding=c.padding),this.fire(new o.Event("movestart",_)).fire(new o.Event("move",_)),h&&this.fire(new o.Event("zoomstart",_)).fire(new o.Event("zoom",_)).fire(new o.Event("zoomend",_)),d&&this.fire(new o.Event("rotatestart",_)).fire(new o.Event("rotate",_)).fire(new o.Event("rotateend",_)),x&&this.fire(new o.Event("pitchstart",_)).fire(new o.Event("pitch",_)).fire(new o.Event("pitchend",_)),this.fire(new o.Event("moveend",_))}calculateCameraOptionsFromTo(c,_,l,h=0){const d=o.MercatorCoordinate.fromLngLat(c,_),x=o.MercatorCoordinate.fromLngLat(l,h),b=x.x-d.x,S=x.y-d.y,M=x.z-d.z,B=Math.hypot(b,S,M);if(B===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(b,S),j=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),Y=180*Math.atan2(b,-S)/Math.PI;let ae=180*Math.acos(V/B)/Math.PI;return ae=M<0?90-ae:90+ae,{center:x.toLngLat(),zoom:j,pitch:ae,bearing:Y}}easeTo(c,_){this._stop(!1,c.easeId),((c=o.extend({offset:[0,0],duration:500,easing:o.ease},c)).animate===!1||!c.essential&&o.exported.prefersReducedMotion)&&(c.duration=0);const l=this.transform,h=this.getZoom(),d=this.getBearing(),x=this.getPitch(),b=this.getPadding(),S="zoom"in c?+c.zoom:h,M="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:x,V="padding"in c?c.padding:l.padding,j=o.pointGeometry.convert(c.offset);let Y=l.centerPoint.add(j);const ae=l.pointLocation(Y),ne=o.LngLat.convert(c.center||ae);this._normalizeCenter(ne);const ue=l.project(ae),be=l.project(ne).sub(ue),Ce=l.zoomScale(S-h);let ve,Ge;c.around&&(ve=o.LngLat.convert(c.around),Ge=l.locationPoint(ve));const Te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||S!==h,this._rotating=this._rotating||d!==M,this._pitching=this._pitching||B!==x,this._padding=!l.isPaddingEqual(V),this._easeId=c.easeId,this._prepareEase(_,c.noMoveStart,Te),this._ease(Ve=>{if(this._zooming&&(l.zoom=o.number(h,S,Ve)),this._rotating&&(l.bearing=o.number(d,M,Ve)),this._pitching&&(l.pitch=o.number(x,B,Ve)),this._padding&&(l.interpolatePadding(b,V,Ve),Y=l.centerPoint.add(j)),ve)l.setLocationAtPoint(ve,Ge);else{const xe=l.zoomScale(l.zoom-h),y=S>h?Math.min(2,Ce):Math.max(.5,Ce),m=Math.pow(y,1-Ve),v=l.unproject(ue.add(be.mult(Ve*m)).mult(xe));l.setLocationAtPoint(l.renderWorldCopies?v.wrap():v,Y)}this._fireMoveEvents(_)},Ve=>{this._afterEase(_,Ve)},c),this}_prepareEase(c,_,l={}){this._moving=!0,this.fire(new o.Event("freezeElevation",{freeze:!0})),_||l.moving||this.fire(new o.Event("movestart",c)),this._zooming&&!l.zooming&&this.fire(new o.Event("zoomstart",c)),this._rotating&&!l.rotating&&this.fire(new o.Event("rotatestart",c)),this._pitching&&!l.pitching&&this.fire(new o.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new o.Event("move",c)),this._zooming&&this.fire(new o.Event("zoom",c)),this._rotating&&this.fire(new o.Event("rotate",c)),this._pitching&&this.fire(new o.Event("pitch",c))}_afterEase(c,_){if(this._easeId&&_&&this._easeId===_)return;delete this._easeId,this.fire(new o.Event("freezeElevation",{freeze:!1}));const l=this._zooming,h=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,l&&this.fire(new o.Event("zoomend",c)),h&&this.fire(new o.Event("rotateend",c)),d&&this.fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c))}flyTo(c,_){if(!c.essential&&o.exported.prefersReducedMotion){const N=o.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(N,_)}this.stop(),c=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},c);const l=this.transform,h=this.getZoom(),d=this.getBearing(),x=this.getPitch(),b=this.getPadding(),S="zoom"in c?o.clamp(+c.zoom,l.minZoom,l.maxZoom):h,M="bearing"in c?this._normalizeBearing(c.bearing,d):d,B="pitch"in c?+c.pitch:x,V="padding"in c?c.padding:l.padding,j=l.zoomScale(S-h),Y=o.pointGeometry.convert(c.offset);let ae=l.centerPoint.add(Y);const ne=l.pointLocation(ae),ue=o.LngLat.convert(c.center||ne);this._normalizeCenter(ue);const be=l.project(ne),Ce=l.project(ue).sub(be);let ve=c.curve;const Ge=Math.max(l.width,l.height),Te=Ge/j,Ve=Ce.mag();if("minZoom"in c){const N=o.clamp(Math.min(c.minZoom,h,S),l.minZoom,l.maxZoom),Q=Ge/l.zoomScale(N-h);ve=Math.sqrt(Q/Ve*2)}const xe=ve*ve;function y(N){const Q=(Te*Te-Ge*Ge+(N?-1:1)*xe*xe*Ve*Ve)/(2*(N?Te:Ge)*xe*Ve);return Math.log(Math.sqrt(Q*Q+1)-Q)}function m(N){return(Math.exp(N)-Math.exp(-N))/2}function v(N){return(Math.exp(N)+Math.exp(-N))/2}const E=y(0);let P=function(N){return v(E)/v(E+ve*N)},R=function(N){return Ge*((v(E)*(m(Q=E+ve*N)/v(Q))-m(E))/xe)/Ve;var Q},O=(y(1)-E)/ve;if(Math.abs(Ve)<1e-6||!isFinite(O)){if(Math.abs(Ge-Te)<1e-6)return this.easeTo(c,_);const N=Te<Ge?-1:1;O=Math.abs(Math.log(Te/Ge))/ve,R=function(){return 0},P=function(Q){return Math.exp(N*ve*Q)}}return c.duration="duration"in c?+c.duration:1e3*O/("screenSpeed"in c?+c.screenSpeed/ve:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=d!==M,this._pitching=B!==x,this._padding=!l.isPaddingEqual(V),this._prepareEase(_,!1),this._ease(N=>{const Q=N*O,J=1/P(Q);l.zoom=N===1?S:h+l.scaleZoom(J),this._rotating&&(l.bearing=o.number(d,M,N)),this._pitching&&(l.pitch=o.number(x,B,N)),this._padding&&(l.interpolatePadding(b,V,N),ae=l.centerPoint.add(Y));const le=N===1?ue:l.unproject(be.add(Ce.mult(R(Q))).mult(J));l.setLocationAtPoint(l.renderWorldCopies?le.wrap():le,ae),this._fireMoveEvents(_)},()=>this._afterEase(_),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,_){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const l=this._onEaseEnd;delete this._onEaseEnd,l.call(this,_)}if(!c){const l=this.handlers;l&&l.stop(!1)}return this}_ease(c,_,l){l.animate===!1||l.duration===0?(c(1),_()):(this._easeStart=o.exported.now(),this._easeOptions=l,this._onEaseFrame=c,this._onEaseEnd=_,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,_){c=o.wrap(c,-180,180);const l=Math.abs(c-_);return Math.abs(c-360-_)<l&&(c-=360),Math.abs(c+360-_)<l&&(c+=360),c}_normalizeCenter(c){const _=this.transform;if(!_.renderWorldCopies||_.lngRange)return;const l=c.lng-_.center.lng;c.lng+=l>180?-360:l<-180?360:0}}class Za{constructor(c={}){this.options=c,o.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options&&this.options.compact,this._container=k.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=k.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=k.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){k.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,_){const l=this._map._getUIString(`AttributionControl.${_}`);c.title=l,c.setAttribute("aria-label",l)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const _=this._map.style.sourceCaches;for(const h in _){const d=_[h];if(d.used||d.usedForTerrain){const x=d.getSource();x.attribution&&c.indexOf(x.attribution)<0&&c.push(x.attribution)}}c=c.filter(h=>String(h).trim()),c.sort((h,d)=>h.length-d.length),c=c.filter((h,d)=>{for(let x=d+1;x<c.length;x++)if(c[x].indexOf(h)>=0)return!1;return!0});const l=c.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,c.length?(this._innerContainer.innerHTML=l,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Dl{constructor(c={}){this.options=c,o.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=k.create("div","maplibregl-ctrl mapboxgl-ctrl");const _=k.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return _.target="_blank",_.rel="noopener nofollow",_.href="https://maplibre.org/",_.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),_.setAttribute("rel","noopener nofollow"),this._container.appendChild(_),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){k.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const c=this._container.children;if(c.length){const _=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&_.classList.add("maplibregl-compact","mapboxgl-compact"):_.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class hu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const _=++this._id;return this._queue.push({callback:c,id:_,cancelled:!1}),_}remove(c){const _=this._currentlyRunning,l=_?this._queue.concat(_):this._queue;for(const h of l)if(h.id===c)return void(h.cancelled=!0)}run(c=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const _=this._currentlyRunning=this._queue;this._queue=[];for(const l of _)if(!l.cancelled&&(l.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const yc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},fu={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},_c={showCompass:!0,showZoom:!0,visualizePitch:!1};class pr{constructor(c,_,l=!1){this._clickTolerance=10,this.element=_,this.mouseRotate=new us({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,l&&(this.mousePitch=new Nt({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),k.addEventListener(_,"mousedown",this.mousedown),k.addEventListener(_,"touchstart",this.touchstart,{passive:!1}),k.addEventListener(_,"touchmove",this.touchmove),k.addEventListener(_,"touchend",this.touchend),k.addEventListener(_,"touchcancel",this.reset)}down(c,_){this.mouseRotate.mousedown(c,_),this.mousePitch&&this.mousePitch.mousedown(c,_),k.disableDrag()}move(c,_){const l=this.map,h=this.mouseRotate.mousemoveWindow(c,_);if(h&&h.bearingDelta&&l.setBearing(l.getBearing()+h.bearingDelta),this.mousePitch){const d=this.mousePitch.mousemoveWindow(c,_);d&&d.pitchDelta&&l.setPitch(l.getPitch()+d.pitchDelta)}}off(){const c=this.element;k.removeEventListener(c,"mousedown",this.mousedown),k.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),k.removeEventListener(c,"touchmove",this.touchmove),k.removeEventListener(c,"touchend",this.touchend),k.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){k.enableDrag(),k.removeEventListener(window,"mousemove",this.mousemove),k.removeEventListener(window,"mouseup",this.mouseup)}mousedown(c){this.down(o.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),k.mousePos(this.element,c)),k.addEventListener(window,"mousemove",this.mousemove),k.addEventListener(window,"mouseup",this.mouseup)}mousemove(c){this.move(c,k.mousePos(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=k.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=k.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Rl(L,c,_){if(L=new o.LngLat(L.lng,L.lat),c){const l=new o.LngLat(L.lng-360,L.lat),h=new o.LngLat(L.lng+360,L.lat),d=_.locationPoint(L).distSqr(c);_.locationPoint(l).distSqr(c)<d?L=l:_.locationPoint(h).distSqr(c)<d&&(L=h)}for(;Math.abs(L.lng-_.center.lng)>180;){const l=_.locationPoint(L);if(l.x>=0&&l.y>=0&&l.x<=_.width&&l.y<=_.height)break;L.lng>_.center.lng?L.lng-=360:L.lng+=360}return L}const Yt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Xt(L,c,_){const l=L.classList;for(const h in Yt)l.remove(`maplibregl-${_}-anchor-${h}`,`mapboxgl-${_}-anchor-${h}`);l.add(`maplibregl-${_}-anchor-${c}`,`mapboxgl-${_}-anchor-${c}`)}class hn extends o.Evented{constructor(c,_){if(super(),(c instanceof HTMLElement||_)&&(c=o.extend({element:c},_)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=o.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=k.create("div"),this._element.setAttribute("aria-label","Map marker");const l=k.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;l.setAttributeNS(null,"display","block"),l.setAttributeNS(null,"height",`${h}px`),l.setAttributeNS(null,"width",`${d}px`),l.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const x=k.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const b=k.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const S=k.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ce of M){const ve=k.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",Ce.rx),ve.setAttributeNS(null,"ry",Ce.ry),S.appendChild(ve)}const B=k.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const V=k.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(V);const j=k.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const Y=k.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(Y);const ae=k.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ae.setAttributeNS(null,"fill","#FFFFFF");const ne=k.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=k.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const be=k.createNS("http://www.w3.org/2000/svg","circle");be.setAttributeNS(null,"fill","#FFFFFF"),be.setAttributeNS(null,"cx","5.5"),be.setAttributeNS(null,"cy","5.5"),be.setAttributeNS(null,"r","5.4999962"),ne.appendChild(ue),ne.appendChild(be),b.appendChild(S),b.appendChild(B),b.appendChild(j),b.appendChild(ae),b.appendChild(ne),l.appendChild(b),l.setAttributeNS(null,"height",h*this._scale+"px"),l.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(l),this._offset=o.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",l=>{l.preventDefault()}),this._element.addEventListener("mousedown",l=>{l.preventDefault()}),Xt(this._element,this._anchor,"marker"),this._popup=null}addTo(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),k.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=o.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const h=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(c){const _=c.code,l=c.charCode||c.keyCode;_!=="Space"&&_!=="Enter"&&l!==32&&l!==13||this.togglePopup()}_onMapClick(c){const _=c.originalEvent.target,l=this._element;this._popup&&(_===l||l.contains(_))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this}_update(c){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Rl(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let l="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?l="rotateX(0deg)":this._pitchAlignment==="map"&&(l=`rotateX(${this._map.getPitch()}deg)`),c&&c.type!=="moveend"||(this._pos=this._pos.round()),k.setTransform(this._element,`${Yt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${l} ${_}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const h=this._map.unproject(this._pos),d=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=h.distanceTo(this._lngLat)>20*d?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(c){return this._offset=o.pointGeometry.convert(c),this._update(),this}_onMove(c){if(!this._isDragging){const _=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=_}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Yi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Qo,Nr=0,js=!1;const Ts={maxWidth:100,unit:"metric"};function Hs(L,c,_){const l=_&&_.maxWidth||100,h=L._container.clientHeight/2,d=L.unproject([0,h]),x=L.unproject([l,h]),b=d.distanceTo(x);if(_&&_.unit==="imperial"){const S=3.2808*b;S>5280?Mt(c,l,S/5280,L._getUIString("ScaleControl.Miles")):Mt(c,l,S,L._getUIString("ScaleControl.Feet"))}else _&&_.unit==="nautical"?Mt(c,l,b/1852,L._getUIString("ScaleControl.NauticalMiles")):b>=1e3?Mt(c,l,b/1e3,L._getUIString("ScaleControl.Kilometers")):Mt(c,l,b,L._getUIString("ScaleControl.Meters"))}function Mt(L,c,_,l){const h=function(d){const x=Math.pow(10,`${Math.floor(d)}`.length-1);let b=d/x;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(S){const M=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*M)/M}(b),x*b}(_);L.style.width=c*(h/_)+"px",L.innerHTML=`${h}&nbsp;${l}`}const Pt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ur=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ya(L){if(L){if(typeof L=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(L,2)));return{center:new o.pointGeometry(0,0),top:new o.pointGeometry(0,L),"top-left":new o.pointGeometry(c,c),"top-right":new o.pointGeometry(-c,c),bottom:new o.pointGeometry(0,-L),"bottom-left":new o.pointGeometry(c,-c),"bottom-right":new o.pointGeometry(-c,-c),left:new o.pointGeometry(L,0),right:new o.pointGeometry(-L,0)}}if(L instanceof o.pointGeometry||Array.isArray(L)){const c=o.pointGeometry.convert(L);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:o.pointGeometry.convert(L.center||[0,0]),top:o.pointGeometry.convert(L.top||[0,0]),"top-left":o.pointGeometry.convert(L["top-left"]||[0,0]),"top-right":o.pointGeometry.convert(L["top-right"]||[0,0]),bottom:o.pointGeometry.convert(L.bottom||[0,0]),"bottom-left":o.pointGeometry.convert(L["bottom-left"]||[0,0]),"bottom-right":o.pointGeometry.convert(L["bottom-right"]||[0,0]),left:o.pointGeometry.convert(L.left||[0,0]),right:o.pointGeometry.convert(L.right||[0,0])}}return Ya(new o.pointGeometry(0,0))}const Ws={supported:g,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends br{constructor(L){var c;if(o.PerformanceUtils.mark(o.PerformanceMarkers.create),(L=o.extend({},fu,L)).minZoom!=null&&L.maxZoom!=null&&L.minZoom>L.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(L.minPitch!=null&&L.maxPitch!=null&&L.minPitch>L.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(L.minPitch!=null&&L.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(L.maxPitch!=null&&L.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new _o(L.minZoom,L.maxZoom,L.minPitch,L.maxPitch,L.renderWorldCopies),{bearingSnap:L.bearingSnap}),this._interactive=L.interactive,this._cooperativeGestures=L.cooperativeGestures,this._maxTileCacheSize=L.maxTileCacheSize,this._failIfMajorPerformanceCaveat=L.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=L.preserveDrawingBuffer,this._antialias=L.antialias,this._trackResize=L.trackResize,this._bearingSnap=L.bearingSnap,this._refreshExpiredTiles=L.refreshExpiredTiles,this._fadeDuration=L.fadeDuration,this._crossSourceCollisions=L.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=L.collectResourceTiming,this._renderTaskQueue=new hu,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},yc,L.locale),this._clickTolerance=L.clickTolerance,this._pixelRatio=(c=L.pixelRatio)!==null&&c!==void 0?c:devicePixelRatio,this._requestManager=new U(L.transformRequest),typeof L.container=="string"){if(this._container=document.getElementById(L.container),!this._container)throw new Error(`Container '${L.container}' not found.`)}else{if(!(L.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=L.container}if(L.maxBounds&&this.setMaxBounds(L.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new mc(this,L),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=L.hash&&new hi(typeof L.hash=="string"&&L.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:L.center,zoom:L.zoom,bearing:L.bearing,pitch:L.pitch}),L.bounds&&(this.resize(),this.fitBounds(L.bounds,o.extend({},L.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=L.localIdeographFontFamily,L.style&&this.setStyle(L.style,{localIdeographFontFamily:L.localIdeographFontFamily}),L.attributionControl&&this.addControl(new Za({customAttribution:L.customAttribution})),L.maplibreLogo&&this.addControl(new Dl,L.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",_=>{this._update(_.dataType==="style"),this.fire(new o.Event(`${_.dataType}data`,_))}),this.on("dataloading",_=>{this.fire(new o.Event(`${_.dataType}dataloading`,_))}),this.on("dataabort",_=>{this.fire(new o.Event("sourcedataabort",_))})}_getMapId(){return this._mapId}addControl(L,c){if(c===void 0&&(c=L.getDefaultPosition?L.getDefaultPosition():"top-right"),!L||!L.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const _=L.onAdd(this);this._controls.push(L);const l=this._controlPositions[c];return c.indexOf("bottom")!==-1?l.insertBefore(_,l.firstChild):l.appendChild(_),this}removeControl(L){if(!L||!L.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(L);return c>-1&&this._controls.splice(c,1),L.onRemove(this),this}hasControl(L){return this._controls.indexOf(L)>-1}calculateCameraOptionsFromTo(L,c,_,l){return l==null&&this.style.terrain&&(l=this.transform.getElevation(_,this.style.terrain)),super.calculateCameraOptionsFromTo(L,c,_,l)}resize(L){const c=this._containerDimensions(),_=c[0],l=c[1];this._resizeCanvas(_,l,this.getPixelRatio()),this.transform.resize(_,l),this.painter.resize(_,l,this.getPixelRatio());const h=!this._moving;return h&&(this.stop(),this.fire(new o.Event("movestart",L)).fire(new o.Event("move",L))),this.fire(new o.Event("resize",L)),h&&this.fire(new o.Event("moveend",L)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(L){const[c,_]=this._containerDimensions();this._pixelRatio=L,this._resizeCanvas(c,_,L),this.painter.resize(c,_,L)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(L){return this.transform.setMaxBounds(o.LngLatBounds.convert(L)),this._update()}setMinZoom(L){if((L=L??-2)>=-2&&L<=this.transform.maxZoom)return this.transform.minZoom=L,this._update(),this.getZoom()<L&&this.setZoom(L),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(L){if((L=L??22)>=this.transform.minZoom)return this.transform.maxZoom=L,this._update(),this.getZoom()>L&&this.setZoom(L),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(L){if((L=L??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(L>=0&&L<=this.transform.maxPitch)return this.transform.minPitch=L,this._update(),this.getPitch()<L&&this.setPitch(L),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(L){if((L=L??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(L>=this.transform.minPitch)return this.transform.maxPitch=L,this._update(),this.getPitch()>L&&this.setPitch(L),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(L){return this.transform.renderWorldCopies=L,this._update()}project(L){return this.transform.locationPoint(o.LngLat.convert(L),this.style&&this.style.terrain)}unproject(L){return this.transform.pointLocation(o.pointGeometry.convert(L),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(L,c,_){if(L==="mouseenter"||L==="mouseover"){let l=!1;return{layer:c,listener:_,delegates:{mousemove:d=>{const x=this.getLayer(c)?this.queryRenderedFeatures(d.point,{layers:[c]}):[];x.length?l||(l=!0,_.call(this,new ni(L,this,d.originalEvent,{features:x}))):l=!1},mouseout:()=>{l=!1}}}}if(L==="mouseleave"||L==="mouseout"){let l=!1;return{layer:c,listener:_,delegates:{mousemove:x=>{(this.getLayer(c)?this.queryRenderedFeatures(x.point,{layers:[c]}):[]).length?l=!0:l&&(l=!1,_.call(this,new ni(L,this,x.originalEvent)))},mouseout:x=>{l&&(l=!1,_.call(this,new ni(L,this,x.originalEvent)))}}}}{const l=h=>{const d=this.getLayer(c)?this.queryRenderedFeatures(h.point,{layers:[c]}):[];d.length&&(h.features=d,_.call(this,h),delete h.features)};return{layer:c,listener:_,delegates:{[L]:l}}}}on(L,c,_){if(_===void 0)return super.on(L,c);const l=this._createDelegatedListener(L,c,_);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[L]=this._delegatedListeners[L]||[],this._delegatedListeners[L].push(l);for(const h in l.delegates)this.on(h,l.delegates[h]);return this}once(L,c,_){if(_===void 0)return super.once(L,c);const l=this._createDelegatedListener(L,c,_);for(const h in l.delegates)this.once(h,l.delegates[h]);return this}off(L,c,_){return _===void 0?super.off(L,c):(this._delegatedListeners&&this._delegatedListeners[L]&&(l=>{const h=this._delegatedListeners[L];for(let d=0;d<h.length;d++){const x=h[d];if(x.layer===c&&x.listener===_){for(const b in x.delegates)this.off(b,x.delegates[b]);return h.splice(d,1),this}}})(),this)}queryRenderedFeatures(L,c){if(!this.style)return[];let _;if(c!==void 0||L===void 0||L instanceof o.pointGeometry||Array.isArray(L)||(c=L,L=void 0),c=c||{},(L=L||[[0,0],[this.transform.width,this.transform.height]])instanceof o.pointGeometry||typeof L[0]=="number")_=[o.pointGeometry.convert(L)];else{const l=o.pointGeometry.convert(L[0]),h=o.pointGeometry.convert(L[1]);_=[l,new o.pointGeometry(h.x,l.y),h,new o.pointGeometry(l.x,h.y),l]}return this.style.queryRenderedFeatures(_,c,this.transform)}querySourceFeatures(L,c){return this.style.querySourceFeatures(L,c)}setStyle(L,c){return(c=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&L?(this._diffStyle(L,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(L,c))}setTransformRequest(L){return this._requestManager.setTransformRequest(L),this}_getUIString(L){const c=this._locale[L];if(c==null)throw new Error(`Missing UI string '${L}'`);return c}_updateStyle(L,c){return this.style&&(this.style.setEventedParent(null),this.style._remove()),L?(this.style=new Me(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof L=="string"?this.style.loadURL(L):this.style.loadJSON(L),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Me(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(L,c){if(typeof L=="string"){const _=this._requestManager.transformRequest(L,o.ResourceType.Style);o.getJSON(_,(l,h)=>{l?this.fire(new o.ErrorEvent(l)):h&&this._updateDiff(h,c)})}else typeof L=="object"&&this._updateDiff(L,c)}_updateDiff(L,c){try{this.style.setState(L)&&this._update(!0)}catch(_){o.warnOnce(`Unable to perform style diff: ${_.message||_.error||_}.  Rebuilding the style from scratch.`),this._updateStyle(L,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")}addSource(L,c){return this._lazyInitEmptyStyle(),this.style.addSource(L,c),this._update(!0)}isSourceLoaded(L){const c=this.style&&this.style.sourceCaches[L];if(c!==void 0)return c.loaded();this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${L}'`)))}setTerrain(L){return this.style.setTerrain(L),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const L=this.style&&this.style.sourceCaches;for(const c in L){const _=L[c]._tiles;for(const l in _){const h=_[l];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}addSourceType(L,c,_){return this._lazyInitEmptyStyle(),this.style.addSourceType(L,c,_)}removeSource(L){return this.style.removeSource(L),this._update(!0)}getSource(L){return this.style.getSource(L)}addImage(L,c,{pixelRatio:_=1,sdf:l=!1,stretchX:h,stretchY:d,content:x}={}){if(this._lazyInitEmptyStyle(),c instanceof HTMLImageElement||o.isImageBitmap(c)){const{width:b,height:S,data:M}=o.exported.getImageData(c);this.style.addImage(L,{data:new o.RGBAImage({width:b,height:S},M),pixelRatio:_,stretchX:h,stretchY:d,content:x,sdf:l,version:0})}else{if(c.width===void 0||c.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:b,height:S,data:M}=c,B=c;this.style.addImage(L,{data:new o.RGBAImage({width:b,height:S},new Uint8Array(M)),pixelRatio:_,stretchX:h,stretchY:d,content:x,sdf:l,version:0,userImage:B}),B.onAdd&&B.onAdd(this,L)}}}updateImage(L,c){const _=this.style.getImage(L);if(!_)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=c instanceof HTMLImageElement||o.isImageBitmap(c)?o.exported.getImageData(c):c,{width:h,height:d,data:x}=l;if(h===void 0||d===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==_.data.width||d!==_.data.height)return this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const b=!(c instanceof HTMLImageElement||o.isImageBitmap(c));_.data.replace(x,b),this.style.updateImage(L,_)}hasImage(L){return L?!!this.style.getImage(L):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(L){this.style.removeImage(L)}loadImage(L,c){o.getImage(this._requestManager.transformRequest(L,o.ResourceType.Image),c)}listImages(){return this.style.listImages()}addLayer(L,c){return this._lazyInitEmptyStyle(),this.style.addLayer(L,c),this._update(!0)}moveLayer(L,c){return this.style.moveLayer(L,c),this._update(!0)}removeLayer(L){return this.style.removeLayer(L),this._update(!0)}getLayer(L){return this.style.getLayer(L)}setLayerZoomRange(L,c,_){return this.style.setLayerZoomRange(L,c,_),this._update(!0)}setFilter(L,c,_={}){return this.style.setFilter(L,c,_),this._update(!0)}getFilter(L){return this.style.getFilter(L)}setPaintProperty(L,c,_,l={}){return this.style.setPaintProperty(L,c,_,l),this._update(!0)}getPaintProperty(L,c){return this.style.getPaintProperty(L,c)}setLayoutProperty(L,c,_,l={}){return this.style.setLayoutProperty(L,c,_,l),this._update(!0)}getLayoutProperty(L,c){return this.style.getLayoutProperty(L,c)}setLight(L,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(L,c),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(L,c){return this.style.setFeatureState(L,c),this._update()}removeFeatureState(L,c){return this.style.removeFeatureState(L,c),this._update()}getFeatureState(L){return this.style.getFeatureState(L)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let L=0,c=0;return this._container&&(L=this._container.clientWidth||400,c=this._container.clientHeight||300),[L,c]}_setupContainer(){const L=this._container;L.classList.add("maplibregl-map","mapboxgl-map");const c=this._canvasContainer=k.create("div","maplibregl-canvas-container mapboxgl-canvas-container",L);this._interactive&&c.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=k.create("canvas","maplibregl-canvas mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const _=this._containerDimensions();this._resizeCanvas(_[0],_[1],this.getPixelRatio());const l=this._controlContainer=k.create("div","maplibregl-control-container mapboxgl-control-container",L),h=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(d=>{h[d]=k.create("div",`maplibregl-ctrl-${d} mapboxgl-ctrl-${d}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const L=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=k.create("div","maplibregl-cooperative-gesture-screen",L);let c="Control",_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(_=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map",c="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${_}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",l=>{l.key===c&&(this._metaPress=!0)}),document.addEventListener("keyup",l=>{l.key===c&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",l=>{this._onCooperativeGesture(l,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(L,c,_){this._canvas.width=_*L,this._canvas.height=_*c,this._canvas.style.width=`${L}px`,this._canvas.style.height=`${c}px`}_setupPainter(){const L=o.extend({},g.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl",L)||this._canvas.getContext("experimental-webgl",L);c?(this.painter=new _i(c,this.transform),o.exported$1.testSupport(c)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(L){L.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:L}))}_contextRestored(L){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:L}))}_onMapScroll(L){if(L.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(L,c,_){return!c&&_<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(L){return this.style?(this._styleDirty=this._styleDirty||L,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(L){return this._update(),this._renderTaskQueue.add(L)}_cancelRenderFrame(L){this._renderTaskQueue.remove(L)}_render(L){let c,_=0;const l=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(c=l.createQueryEXT(),l.beginQueryEXT(l.TIME_ELAPSED_EXT,c),_=o.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(L),this._removed)return;let h=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const x=this.transform.zoom,b=o.exported.now();this.style.zoomHistory.update(x,b);const S=new o.EvaluationParameters(x,{now:b,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),M=S.crossFadingFactor();M===1&&M===this._crossFadingFactor||(h=!0,this._crossFadingFactor=M),this.style.update(S)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.load),this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||h)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const x=o.exported.now()-_;l.endQueryEXT(l.TIME_ELAPSED_EXT,c),setTimeout(()=>{const b=l.getQueryObjectEXT(c,l.QUERY_RESULT_EXT)/1e6;l.deleteQueryEXT(c),this.fire(new o.Event("gpu-timing-frame",{cpuTime:x,gpuTime:b}))},50)}if(this.listens("gpu-timing-layer")){const x=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(x);this.fire(new o.Event("gpu-timing-layer",{layerTimes:b}))},50)}const d=this._sourcesDirty||this._styleDirty||this._placementDirty;return d||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||d||(this._fullyLoaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const L=this.painter.context.gl.getExtension("WEBGL_lose_context");L&&L.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),k.remove(this._canvasContainer),k.remove(this._controlContainer),this._cooperativeGestures&&k.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),o.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=o.exported.frame(L=>{o.PerformanceUtils.frame(L),this._frame=null,this._render(L)}))}_onWindowOnline(){this._update()}_onWindowResize(L){this._trackResize&&this.resize({originalEvent:L})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(L){this._showTileBoundaries!==L&&(this._showTileBoundaries=L,this._update())}get showPadding(){return!!this._showPadding}set showPadding(L){this._showPadding!==L&&(this._showPadding=L,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(L){this._showCollisionBoxes!==L&&(this._showCollisionBoxes=L,L?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(L){this._showOverdrawInspector!==L&&(this._showOverdrawInspector=L,this._update())}get repaint(){return!!this._repaint}set repaint(L){this._repaint!==L&&(this._repaint=L,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(L){this._vertices=L,this._update()}_setCacheLimits(L,c){o.setCacheLimits(L,c)}get version(){return"2.4.0"}},NavigationControl:class{constructor(L){this.options=o.extend({},_c,L),this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const L=this._map.getZoom(),c=L===this._map.getMaxZoom(),_=L===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const L=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=L}onAdd(L){return this._map=L,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){k.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(L,c){const _=k.create("button",L,this._container);return _.type="button",_.addEventListener("click",c),_}_setButtonTitle(L,c){const _=this._map._getUIString(`NavigationControl.${c}`);L.title=_,L.setAttribute("aria-label",_)}},GeolocateControl:class extends o.Evented{constructor(L){super(),this.options=o.extend({},Yi,L),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(L){var c;return this._map=L,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Qo!==void 0?c(Qo):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(_=>{Qo=_.state!=="denied",c(Qo)}):(Qo=!!window.navigator.geolocation,c(Qo)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),k.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Nr=0,js=!1}_isOutOfMapMaxBounds(L){const c=this._map.getMaxBounds(),_=L.coords;return c&&(_.longitude<c.getWest()||_.longitude>c.getEast()||_.latitude<c.getSouth()||_.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(L){if(this._map){if(this._isOutOfMapMaxBounds(L))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",L)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=L,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(L),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(L),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",L)),this._finish()}}_updateCamera(L){const c=new o.LngLat(L.coords.longitude,L.coords.latitude),_=L.coords.accuracy,l=this._map.getBearing(),h=o.extend({bearing:l},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(_),h,{geolocateSource:!0})}_updateMarker(L){if(L){const c=new o.LngLat(L.coords.longitude,L.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=L.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const L=this._map._container.clientHeight/2,c=this._map.unproject([0,L]),_=this._map.unproject([1,L]),l=c.distanceTo(_),h=Math.ceil(2*this._accuracy/l);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(L){if(this._map){if(this.options.trackUserLocation)if(L.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(L.code===3&&js)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",L)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(L){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=k.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",L===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new hn(this._dotElement),this._circleElement=k.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new hn({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Nr--,js=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let L;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Nr++,Nr>1?(L={maximumAge:6e5,timeout:0},js=!0):(L=this.options.positionOptions,js=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,L)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Za,LogoControl:Dl,ScaleControl:class{constructor(L){this.options=o.extend({},Ts,L),o.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Hs(this._map,this._container,this.options)}onAdd(L){return this._map=L,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",L.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){k.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(L){this.options.unit=L,Hs(this._map,this._container,this.options)}},FullscreenControl:class{constructor(L){this._fullscreen=!1,L&&L.container&&(L.container instanceof HTMLElement?this._container=L.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(L){return this._map=L,this._container||(this._container=this._map.getContainer()),this._controlContainer=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){k.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const L=this._fullscreenButton=k.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",L).setAttribute("aria-hidden","true"),L.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const L=this._getTitle();this._fullscreenButton.setAttribute("aria-label",L),this._fullscreenButton.title=L}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(L){this.options=L,o.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(L){return this._map=L,this._container=k.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=k.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),k.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){k.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends o.Evented{constructor(L){super(),this.options=o.extend(Object.create(Pt),L),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(L){return this._map&&this.remove(),this._map=L,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&k.remove(this._content),this._container&&(k.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(L){return this._lngLat=o.LngLat.convert(L),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(L){return this.setDOMContent(document.createTextNode(L))}setHTML(L){const c=document.createDocumentFragment(),_=document.createElement("body");let l;for(_.innerHTML=L;l=_.firstChild,l;)c.appendChild(l);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(L){return this.options.maxWidth=L,this._update(),this}setDOMContent(L){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=k.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(L),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(L){this._container&&this._container.classList.add(L)}removeClassName(L){this._container&&this._container.classList.remove(L)}setOffset(L){return this.options.offset=L,this._update(),this}toggleClassName(L){if(this._container)return this._container.classList.toggle(L)}_createCloseButton(){this.options.closeButton&&(this._closeButton=k.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(L){this._update(L.point)}_onMouseMove(L){this._update(L.point)}_onDrag(L){this._update(L.point)}_update(L){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=k.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=k.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(d=>this._container.classList.add(d)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Rl(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!L))return;const c=this._pos=this._trackPointer&&L?L:this._map.project(this._lngLat);let _=this.options.anchor;const l=Ya(this.options.offset);if(!_){const d=this._container.offsetWidth,x=this._container.offsetHeight;let b;b=c.y+l.bottom.y<x?["top"]:c.y>this._map.transform.height-x?["bottom"]:[],c.x<d/2?b.push("left"):c.x>this._map.transform.width-d/2&&b.push("right"),_=b.length===0?"bottom":b.join("-")}const h=c.add(l[_]).round();k.setTransform(this._container,`${Yt[_]} translate(${h.x}px,${h.y}px)`),Xt(this._container,_,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const L=this._container.querySelector(Ur);L&&L.focus()}_onClose(){this.remove()}},Marker:hn,Style:Me,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,AJAXError:o.AJAXError,config:o.config,CanvasSource:kn,GeoJSONSource:dn,ImageSource:Et,RasterDEMTileSource:Tt,RasterTileSource:mt,VectorTileSource:Ze,VideoSource:Jt,prewarm:function(){or().acquire(xt)},clearPrewarmedResources:function(){const L=mr;L&&(L.isPreloaded()&&L.numActive()===1?(L.release(xt),mr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return er.workerCount},set workerCount(L){er.workerCount=L},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(L){o.config.MAX_PARALLEL_IMAGE_REQUESTS=L},clearStorage(L){o.clearTileCache(L)},workerUrl:"",addProtocol(L,c){o.config.REGISTERED_PROTOCOLS[L]=c},removeProtocol(L){delete o.config.REGISTERED_PROTOCOLS[L]}};return cs.extend(Ws,{isSafari:o.isSafari,getPerformanceMetrics:o.PerformanceUtils.getPerformanceMetrics}),Ws});var A=i;return A})})(ez);var nz=ez.exports;const fl=b2(nz),Hte=ME({__proto__:null,default:fl},[nz]),Wte="modulepreload",Qte=function(t){return"/"+t},AI={},rz=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Qte(s),s in AI)return;AI[s]=!0;const A=s.endsWith(".css"),o=A?'[rel="stylesheet"]':"";if(!!r)for(let C=i.length-1;C>=0;C--){const I=i[C];if(I.href===s&&(!A||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const w=document.createElement("link");if(w.rel=A?"stylesheet":Wte,A||(w.as="script",w.crossOrigin=""),w.href=s,document.head.appendChild(w),A)return new Promise((C,I)=>{w.addEventListener("load",C),w.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const A=new Event("vite:preloadError",{cancelable:!0});if(A.payload=s,window.dispatchEvent(A),!A.defaultPrevented)throw s})},iz=je.createContext(null);function qte(){var t;const e=(t=je.useContext(iz))===null||t===void 0?void 0:t.maps,n=je.useContext(fm);return je.useMemo(()=>({...e,current:n?.map}),[e,n])}function Zte(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function Iu(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Iu(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!Iu(t[i],e[i]))return!1;return!0}return!1}function Yte(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function uI(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();Iu(n,r)||e.setProjection(n)}function cI(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function hI(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const Xte=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function fI(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const A of Xte)A in s&&(i[A]=s[A])}return i||r});return{...t,layers:n}}const dI={version:8,sources:{},layers:[]},pI={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},gw={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},gI={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Kte=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Jte=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class ad{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[gI[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[pI[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[gw[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=ad.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const A=i._resizeObserver;A&&(A.disconnect(),A.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:o}=e;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):r._updateViewState(o,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=dI}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||ene()||null,container:e,style:fI(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const C=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=C,n.gl)}const A=new this._MapClass(i);s.padding&&A.setPadding(s.padding),n.cursor&&(A.getCanvas().style.cursor=n.cursor),this._createShadowTransform(A);const o=A._render;A._render=C=>{this._inRender=!0,o.call(A,C),this._inRender=!1};const g=A._renderTaskQueue.run;A._renderTaskQueue.run=C=>{g.call(A._renderTaskQueue,C),this._onBeforeRepaint()},A.on("render",()=>this._onAfterRepaint());const w=A.fire;A.fire=this._fireEvent.bind(this,w),A.on("resize",()=>{this._renderTransform.resize(A.transform.width,A.transform.height)}),A.on("styledata",()=>{this._updateStyleComponents(this.props,{}),uI(A.transform,this._renderTransform)}),A.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const C in pI)A.on(C,this._onPointerEvent);for(const C in gw)A.on(C,this._onCameraEvent);for(const C in gI)A.on(C,this._onEvent);this._map=A}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n?.remove(),ad.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=Yte(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:A,bearing:o}=i,g=r.isMoving();g&&(i.cameraElevationReference="sea");const w=hI(i,{...cI(r.transform),...e});if(g&&(i.cameraElevationReference="ground"),w&&n){const C=this._deferredEvents;C.move=!0,C.zoom||(C.zoom=s!==i.zoom),C.rotate||(C.rotate=o!==i.bearing),C.pitch||(C.pitch=A!==i.pitch)}return g||hI(r.transform,e),w}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of Kte)if(s in e&&!Iu(e[s],n[s])){i=!0;const A=r[`set${s[0].toUpperCase()}${s.slice(1)}`];A?.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=dI,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(fI(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!Iu(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!Iu(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!Iu(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let A=!1;for(const o of Jte){const g=(r=e[o])!==null&&r!==void 0?r:!0,w=(i=n[o])!==null&&i!==void 0?i:!0;Iu(g,w)||(A=!0,g?s[o].enable(g):s[o].disable())}return A}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,A=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,o=this._queryRenderedFeatures(e.point),g=o.length>0;!g&&A&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=o,g&&!A&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,A=typeof n=="string"?n:n.type;return A==="move"&&this._updateViewState(this.props,!1),A in gw&&(typeof n=="object"&&(n.viewState=cI(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{uI(this._renderTransform,n),e.transform=n}}}ad.savedMaps=[];function ene(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const tne=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function nne(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const A=e.queryTerrainElevation(r,i);return e.transform=s,A},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const A=e.queryRenderedFeatures(r,i);return e.transform=s,A}};for(const r of rne(e))!(r in n)&&!tne.includes(r)&&(n[r]=e[r].bind(e));return n}function rne(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const ine=typeof document<"u"?je.useLayoutEffect:je.useEffect,sne=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function one(t,e){for(const r of sne)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const fm=je.createContext(null);function sz(t,e,n){const r=je.useContext(iz),[i,s]=je.useState(null),A=je.useRef(),{current:o}=je.useRef({mapLib:null,map:null});je.useEffect(()=>{const C=t.mapLib;let I=!0,k;return Promise.resolve(C||n).then(U=>{if(!I)return;if(!U)throw new Error("Invalid mapLib");const H="Map"in U?U:U.default;if(!H.Map)throw new Error("Invalid mapLib");if(one(H,t),!H.supported||H.supported(t))t.reuseMaps&&(k=ad.reuse(t,A.current)),k||(k=new ad(H.Map,t,A.current)),o.map=nne(k),o.mapLib=H,s(k),r?.onMapMount(o.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(U=>{const{onError:H}=t;H?H({type:"error",target:null,originalEvent:null,error:U}):console.error(U)}),()=>{I=!1,k&&(r?.onMapUnmount(t.id),t.reuseMaps?k.recycle():k.destroy())}},[]),ine(()=>{i&&i.setProps(t)}),je.useImperativeHandle(e,()=>o.map,[i]);const g=je.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),w={height:"100%"};return je.createElement("div",{id:t.id,ref:A,style:g},i&&je.createElement(fm.Provider,{value:o},je.createElement("div",{"mapboxgl-children":"",style:w},t.children)))}const ane=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Mf(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!ane.test(r)?n[r]=`${i}px`:n[r]=i}}function lne(t,e){const{map:n,mapLib:r}=je.useContext(fm),i=je.useRef({props:t});i.current.props=t;const s=je.useMemo(()=>{let q=!1;je.Children.forEach(t.children,te=>{te&&(q=!0)});const se={...t,element:q?document.createElement("div"):null},X=new r.Marker(se);return X.setLngLat([t.longitude,t.latitude]),X.getElement().addEventListener("click",te=>{var ie,fe;(fe=(ie=i.current.props).onClick)===null||fe===void 0||fe.call(ie,{type:"click",target:X,originalEvent:te})}),X.on("dragstart",te=>{var ie,fe;const me=te;me.lngLat=s.getLngLat(),(fe=(ie=i.current.props).onDragStart)===null||fe===void 0||fe.call(ie,me)}),X.on("drag",te=>{var ie,fe;const me=te;me.lngLat=s.getLngLat(),(fe=(ie=i.current.props).onDrag)===null||fe===void 0||fe.call(ie,me)}),X.on("dragend",te=>{var ie,fe;const me=te;me.lngLat=s.getLngLat(),(fe=(ie=i.current.props).onDragEnd)===null||fe===void 0||fe.call(ie,me)}),X},[]);je.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:A,latitude:o,offset:g,style:w,draggable:C=!1,popup:I=null,rotation:k=0,rotationAlignment:U="auto",pitchAlignment:H="auto"}=t;return je.useEffect(()=>{Mf(s.getElement(),w)},[w]),je.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==A||s.getLngLat().lat!==o)&&s.setLngLat([A,o]),g&&!Zte(s.getOffset(),g)&&s.setOffset(g),s.isDraggable()!==C&&s.setDraggable(C),s.getRotation()!==k&&s.setRotation(k),s.getRotationAlignment()!==U&&s.setRotationAlignment(U),s.getPitchAlignment()!==H&&s.setPitchAlignment(H),s.getPopup()!==I&&s.setPopup(I),wT.createPortal(t.children,s.getElement())}je.memo(je.forwardRef(lne));function mI(t){return new Set(t?t.trim().split(/\s+/):[])}function Ane(t,e){const{map:n,mapLib:r}=je.useContext(fm),i=je.useMemo(()=>document.createElement("div"),[]),s=je.useRef({props:t});s.current.props=t;const A=je.useMemo(()=>{const o={...t},g=new r.Popup(o);return g.setLngLat([t.longitude,t.latitude]),g.once("open",w=>{var C,I;(I=(C=s.current.props).onOpen)===null||I===void 0||I.call(C,w)}),g},[]);if(je.useEffect(()=>{const o=g=>{var w,C;(C=(w=s.current.props).onClose)===null||C===void 0||C.call(w,g)};return A.on("close",o),A.setDOMContent(i).addTo(n.getMap()),()=>{A.off("close",o),A.isOpen()&&A.remove()}},[]),je.useEffect(()=>{Mf(A.getElement(),t.style)},[t.style]),je.useImperativeHandle(e,()=>A,[]),A.isOpen()&&((A.getLngLat().lng!==t.longitude||A.getLngLat().lat!==t.latitude)&&A.setLngLat([t.longitude,t.latitude]),t.offset&&!Iu(A.options.offset,t.offset)&&A.setOffset(t.offset),(A.options.anchor!==t.anchor||A.options.maxWidth!==t.maxWidth)&&(A.options.anchor=t.anchor,A.setMaxWidth(t.maxWidth)),A.options.className!==t.className)){const o=mI(A.options.className),g=mI(t.className);for(const w of o)g.has(w)||A.removeClassName(w);for(const w of g)o.has(w)||A.addClassName(w);A.options.className=t.className}return wT.createPortal(t.children,i)}je.memo(je.forwardRef(Ane));function dm(t,e,n,r){const i=je.useContext(fm),s=je.useMemo(()=>t(i),[]);return je.useEffect(()=>{const A=r||n||e,o=typeof e=="function"&&typeof n=="function"?e:null,g=typeof n=="function"?n:typeof e=="function"?e:null,{map:w}=i;return w.hasControl(s)||(w.addControl(s,A?.position),o&&o(i)),()=>{g&&g(i),w.hasControl(s)&&w.removeControl(s)}},[]),s}function une(t){const e=dm(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return je.useEffect(()=>{Mf(e._container,t.style)},[t.style]),null}je.memo(une);function cne(t){const e=dm(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return je.useEffect(()=>{Mf(e._controlContainer,t.style)},[t.style]),null}je.memo(cne);function hne(t,e){const n=je.useRef({props:t}),r=dm(({mapLib:i})=>{const s=new i.GeolocateControl(t),A=s._setupUI;return s._setupUI=o=>{s._container.hasChildNodes()||A(o)},s.on("geolocate",o=>{var g,w;(w=(g=n.current.props).onGeolocate)===null||w===void 0||w.call(g,o)}),s.on("error",o=>{var g,w;(w=(g=n.current.props).onError)===null||w===void 0||w.call(g,o)}),s.on("outofmaxbounds",o=>{var g,w;(w=(g=n.current.props).onOutOfMaxBounds)===null||w===void 0||w.call(g,o)}),s.on("trackuserlocationstart",o=>{var g,w;(w=(g=n.current.props).onTrackUserLocationStart)===null||w===void 0||w.call(g,o)}),s.on("trackuserlocationend",o=>{var g,w;(w=(g=n.current.props).onTrackUserLocationEnd)===null||w===void 0||w.call(g,o)}),s},{position:t.position});return n.current.props=t,je.useImperativeHandle(e,()=>r,[]),je.useEffect(()=>{Mf(r._container,t.style)},[t.style]),null}je.memo(je.forwardRef(hne));function fne(t){const e=dm(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return je.useEffect(()=>{Mf(e._container,t.style)},[t.style]),null}je.memo(fne);function dne(t){const e=dm(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=je.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),je.useEffect(()=>{Mf(e._container,i)},[i]),null}je.memo(dne);function pne(){return qte()}const gne=rz(()=>import("./__vite-optional-peer-dep_mapbox-gl_react-map-gl-b25bb000.js"),[]),zA=(()=>je.forwardRef(function(e,n){return sz(e,n,gne)}))(),mne=8,yne="Positron",_ne={},vne={carto:{type:"vector",url:"https://tiles.basemaps.cartocdn.com/vector/carto.streets/v1/tiles.json"}},xne="https://tiles.basemaps.cartocdn.com/gl/positron-gl-style/sprite",wne="https://tiles.basemaps.cartocdn.com/fonts/{fontstack}/{range}.pbf",bne=[{id:"waterway_label",type:"symbol",source:"carto","source-layer":"waterway",filter:["all",["has","name"],["==","class","river"]],layout:{"text-field":"{name_en}","text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-placement":"line","symbol-spacing":100,"symbol-avoid-edges":!1,"text-size":27,"text-padding":2,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-offset":[0,-.2],"text-letter-spacing":0,"text-keep-upright":!0},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"watername_ocean",type:"symbol",source:"carto","source-layer":"water_name",minzoom:0,maxzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","ocean"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_sea",type:"symbol",source:"carto","source-layer":"water_name",minzoom:5,filter:["all",["has","name"],["==","$type","Point"],["==","class","sea"]],layout:{"text-field":"{name}","symbol-placement":"point","text-size":27,"text-font":["Montserrat Medium Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-max-width":6,"text-letter-spacing":.1},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":0}},{id:"watername_lake",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","Point"],["==","class","lake"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"point","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-line-height":1.2,"text-padding":2,"text-allow-overlap":!1,"text-ignore-placement":!1,"text-pitch-alignment":"auto","text-rotation-alignment":"auto"},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"watername_lake_line",type:"symbol",source:"carto","source-layer":"water_name",filter:["all",["has","name"],["==","$type","LineString"]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"symbol-placement":"line","text-size":27,"text-font":["Montserrat Regular Italic","Open Sans Italic","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"symbol-spacing":350,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-line-height":1.2},paint:{"text-color":"#000000","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1,"text-halo-blur":1}},{id:"place_city_r6",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",6]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,12],[9,13],[10,14],[13,17],[14,20]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_r5",type:"symbol",source:"carto","source-layer":"place",minzoom:8,maxzoom:15,filter:["all",["==","class","city"],[">=","rank",0],["<=","rank",5]],layout:{"text-field":{stops:[[8,"{name_en}"],[13,"{name}"]]},"text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[8,14],[10,16],[13,19],[14,22]]},"icon-image":"","icon-offset":[16,0],"text-anchor":"center","icon-size":1,"text-max-width":10,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_city_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",["!has","capital"],["!in","class","country","state"],[">=","rank",0],["<=","rank",7]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2]},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"place_capital_dot_z7",type:"symbol",source:"carto","source-layer":"place",minzoom:7,maxzoom:8,filter:["all",[">","capital",0]],layout:{"text-field":"{name_en}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":12,"icon-image":"circle-11","icon-offset":[16,5],"text-anchor":"right","icon-size":.4,"text-max-width":8,"text-keep-upright":!0,"text-offset":[.2,.2],"text-transform":"uppercase"},paint:{"text-color":"#697b89","icon-color":"#697b89","icon-translate-anchor":"map","text-halo-color":"rgba(255,255,255,0.5)","text-halo-width":1}},{id:"poi_stadium",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["in","class","stadium","cemetery","attraction"],["<=","rank",3]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"poi_park",type:"symbol",source:"carto","source-layer":"poi",minzoom:15,filter:["all",["==","class","park"]],layout:{"text-field":"{name}","text-font":["Montserrat Medium","Open Sans Bold","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,8],[17,9],[18,10]]},"text-transform":"uppercase"},paint:{"text-color":"#7d9c83","text-halo-color":"#f5f5f3","text-halo-width":1}},{id:"roadname_minor",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:16,filter:["all",["in","class","minor","service"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":9,"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_sec",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:15,filter:["all",["in","class","secondary","tertiary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[15,9],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":200,"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center"},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_pri",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:14,filter:["all",["in","class","primary"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[14,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}},{id:"roadname_major",type:"symbol",source:"carto","source-layer":"transportation_name",minzoom:13,filter:["all",["in","class","trunk","motorway"]],layout:{"symbol-placement":"line","text-font":["Montserrat Regular","Open Sans Regular","Noto Sans Regular","HanWangHeiLight Regular","NanumBarunGothic Regular"],"text-size":{stops:[[14,10],[15,10],[16,11],[18,12]]},"text-field":"{name}","symbol-avoid-edges":!1,"symbol-spacing":{stops:[[6,200],[16,250]]},"text-pitch-alignment":"auto","text-rotation-alignment":"auto","text-justify":"center","text-letter-spacing":{stops:[[13,0],[16,.2]]}},paint:{"text-color":"#838383","text-halo-color":"#fff","text-halo-width":1}}],Ene="voyager",Tne="Carto",OA={version:mne,name:yne,metadata:_ne,sources:vne,sprite:xne,glyphs:wne,layers:bne,id:Ene,owner:Tne};function xy(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Sne(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function sS(t){let e,n,r;t.length!==2?(e=xy,n=(o,g)=>xy(t(o),g),r=(o,g)=>t(o)-g):(e=t===xy||t===Sne?t:Mne,n=t,r=t);function i(o,g,w=0,C=o.length){if(w<C){if(e(g,g)!==0)return C;do{const I=w+C>>>1;n(o[I],g)<0?w=I+1:C=I}while(w<C)}return w}function s(o,g,w=0,C=o.length){if(w<C){if(e(g,g)!==0)return C;do{const I=w+C>>>1;n(o[I],g)<=0?w=I+1:C=I}while(w<C)}return w}function A(o,g,w=0,C=o.length){const I=i(o,g,w,C-1);return I>w&&r(o[I-1],g)>-r(o[I],g)?I-1:I}return{left:i,center:A,right:s}}function Mne(){return 0}function Cne(t){return t===null?NaN:+t}const Pne=sS(xy),Ine=Pne.right;sS(Cne).center;const oz=Ine;function M1(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}const kne=Math.sqrt(50),Lne=Math.sqrt(10),Dne=Math.sqrt(2);function M_(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),A=s>=kne?10:s>=Lne?5:s>=Dne?2:1;let o,g,w;return i<0?(w=Math.pow(10,-i)/A,o=Math.round(t*w),g=Math.round(e*w),o/w<t&&++o,g/w>e&&--g,w=-w):(w=Math.pow(10,i)*A,o=Math.round(t/w),g=Math.round(e/w),o*w<t&&++o,g*w>e&&--g),g<o&&.5<=n&&n<2?M_(t,e,n*2):[o,g,w]}function k3(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,A]=r?M_(e,t,n):M_(t,e,n);if(!(s>=i))return[];const o=s-i+1,g=new Array(o);if(r)if(A<0)for(let w=0;w<o;++w)g[w]=(s-w)/-A;else for(let w=0;w<o;++w)g[w]=(s-w)*A;else if(A<0)for(let w=0;w<o;++w)g[w]=(i+w)/-A;else for(let w=0;w<o;++w)g[w]=(i+w)*A;return g}function L3(t,e,n){return e=+e,t=+t,n=+n,M_(t,e,n)[2]}function D3(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?L3(e,t,n):L3(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Rne(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Bne(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var zne={value:()=>{}};function az(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new wy(n)}function wy(t){this._=t}function One(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}wy.prototype=az.prototype={constructor:wy,on:function(t,e){var n=this._,r=One(t+"",n),i,s=-1,A=r.length;if(arguments.length<2){for(;++s<A;)if((i=(t=r[s]).type)&&(i=Fne(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<A;)if(i=(t=r[s]).type)n[i]=yI(n[i],t.name,e);else if(e==null)for(i in n)n[i]=yI(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new wy(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function Fne(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function yI(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=zne,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var R3="http://www.w3.org/1999/xhtml";const _I={svg:"http://www.w3.org/2000/svg",xhtml:R3,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function q2(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),_I.hasOwnProperty(e)?{space:_I[e],local:t}:t}function Nne(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===R3&&e.documentElement.namespaceURI===R3?e.createElement(t):e.createElementNS(n,t)}}function Une(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function lz(t){var e=q2(t);return(e.local?Une:Nne)(e)}function Vne(){}function oS(t){return t==null?Vne:function(){return this.querySelector(t)}}function Gne(t){typeof t!="function"&&(t=oS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,o=r[i]=new Array(A),g,w,C=0;C<A;++C)(g=s[C])&&(w=t.call(g,g.__data__,C,s))&&("__data__"in g&&(w.__data__=g.__data__),o[C]=w);return new Ro(r,this._parents)}function Az(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function $ne(){return[]}function uz(t){return t==null?$ne:function(){return this.querySelectorAll(t)}}function jne(t){return function(){return Az(t.apply(this,arguments))}}function Hne(t){typeof t=="function"?t=jne(t):t=uz(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var A=e[s],o=A.length,g,w=0;w<o;++w)(g=A[w])&&(r.push(t.call(g,g.__data__,w,A)),i.push(g));return new Ro(r,i)}function cz(t){return function(){return this.matches(t)}}function hz(t){return function(e){return e.matches(t)}}var Wne=Array.prototype.find;function Qne(t){return function(){return Wne.call(this.children,t)}}function qne(){return this.firstElementChild}function Zne(t){return this.select(t==null?qne:Qne(typeof t=="function"?t:hz(t)))}var Yne=Array.prototype.filter;function Xne(){return Array.from(this.children)}function Kne(t){return function(){return Yne.call(this.children,t)}}function Jne(t){return this.selectAll(t==null?Xne:Kne(typeof t=="function"?t:hz(t)))}function ere(t){typeof t!="function"&&(t=cz(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,o=r[i]=[],g,w=0;w<A;++w)(g=s[w])&&t.call(g,g.__data__,w,s)&&o.push(g);return new Ro(r,this._parents)}function fz(t){return new Array(t.length)}function tre(){return new Ro(this._enter||this._groups.map(fz),this._parents)}function C_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}C_.prototype={constructor:C_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function nre(t){return function(){return t}}function rre(t,e,n,r,i,s){for(var A=0,o,g=e.length,w=s.length;A<w;++A)(o=e[A])?(o.__data__=s[A],r[A]=o):n[A]=new C_(t,s[A]);for(;A<g;++A)(o=e[A])&&(i[A]=o)}function ire(t,e,n,r,i,s,A){var o,g,w=new Map,C=e.length,I=s.length,k=new Array(C),U;for(o=0;o<C;++o)(g=e[o])&&(k[o]=U=A.call(g,g.__data__,o,e)+"",w.has(U)?i[o]=g:w.set(U,g));for(o=0;o<I;++o)U=A.call(t,s[o],o,s)+"",(g=w.get(U))?(r[o]=g,g.__data__=s[o],w.delete(U)):n[o]=new C_(t,s[o]);for(o=0;o<C;++o)(g=e[o])&&w.get(k[o])===g&&(i[o]=g)}function sre(t){return t.__data__}function ore(t,e){if(!arguments.length)return Array.from(this,sre);var n=e?ire:rre,r=this._parents,i=this._groups;typeof t!="function"&&(t=nre(t));for(var s=i.length,A=new Array(s),o=new Array(s),g=new Array(s),w=0;w<s;++w){var C=r[w],I=i[w],k=I.length,U=are(t.call(C,C&&C.__data__,w,r)),H=U.length,q=o[w]=new Array(H),se=A[w]=new Array(H),X=g[w]=new Array(k);n(C,I,q,se,X,U,e);for(var te=0,ie=0,fe,me;te<H;++te)if(fe=q[te]){for(te>=ie&&(ie=te+1);!(me=se[ie])&&++ie<H;);fe._next=me||null}}return A=new Ro(A,r),A._enter=o,A._exit=g,A}function are(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function lre(){return new Ro(this._exit||this._groups.map(fz),this._parents)}function Are(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function ure(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,A=Math.min(i,s),o=new Array(i),g=0;g<A;++g)for(var w=n[g],C=r[g],I=w.length,k=o[g]=new Array(I),U,H=0;H<I;++H)(U=w[H]||C[H])&&(k[H]=U);for(;g<i;++g)o[g]=n[g];return new Ro(o,this._parents)}function cre(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],A;--i>=0;)(A=r[i])&&(s&&A.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(A,s),s=A);return this}function hre(t){t||(t=fre);function e(I,k){return I&&k?t(I.__data__,k.__data__):!I-!k}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var A=n[s],o=A.length,g=i[s]=new Array(o),w,C=0;C<o;++C)(w=A[C])&&(g[C]=w);g.sort(e)}return new Ro(i,this._parents).order()}function fre(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function dre(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function pre(){return Array.from(this)}function gre(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var A=r[i];if(A)return A}return null}function mre(){let t=0;for(const e of this)++t;return t}function yre(){return!this.node()}function _re(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,A=i.length,o;s<A;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this}function vre(t){return function(){this.removeAttribute(t)}}function xre(t){return function(){this.removeAttributeNS(t.space,t.local)}}function wre(t,e){return function(){this.setAttribute(t,e)}}function bre(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ere(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Tre(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Sre(t,e){var n=q2(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?xre:vre:typeof e=="function"?n.local?Tre:Ere:n.local?bre:wre)(n,e))}function dz(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Mre(t){return function(){this.style.removeProperty(t)}}function Cre(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Pre(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Ire(t,e,n){return arguments.length>1?this.each((e==null?Mre:typeof e=="function"?Pre:Cre)(t,e,n??"")):ld(this.node(),t)}function ld(t,e){return t.style.getPropertyValue(e)||dz(t).getComputedStyle(t,null).getPropertyValue(e)}function kre(t){return function(){delete this[t]}}function Lre(t,e){return function(){this[t]=e}}function Dre(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Rre(t,e){return arguments.length>1?this.each((e==null?kre:typeof e=="function"?Dre:Lre)(t,e)):this.node()[t]}function pz(t){return t.trim().split(/^|\s+/)}function aS(t){return t.classList||new gz(t)}function gz(t){this._node=t,this._names=pz(t.getAttribute("class")||"")}gz.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function mz(t,e){for(var n=aS(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function yz(t,e){for(var n=aS(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Bre(t){return function(){mz(this,t)}}function zre(t){return function(){yz(this,t)}}function Ore(t,e){return function(){(e.apply(this,arguments)?mz:yz)(this,t)}}function Fre(t,e){var n=pz(t+"");if(arguments.length<2){for(var r=aS(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Ore:e?Bre:zre)(n,e))}function Nre(){this.textContent=""}function Ure(t){return function(){this.textContent=t}}function Vre(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Gre(t){return arguments.length?this.each(t==null?Nre:(typeof t=="function"?Vre:Ure)(t)):this.node().textContent}function $re(){this.innerHTML=""}function jre(t){return function(){this.innerHTML=t}}function Hre(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Wre(t){return arguments.length?this.each(t==null?$re:(typeof t=="function"?Hre:jre)(t)):this.node().innerHTML}function Qre(){this.nextSibling&&this.parentNode.appendChild(this)}function qre(){return this.each(Qre)}function Zre(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Yre(){return this.each(Zre)}function Xre(t){var e=typeof t=="function"?t:lz(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Kre(){return null}function Jre(t,e){var n=typeof t=="function"?t:lz(t),r=e==null?Kre:typeof e=="function"?e:oS(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function eie(){var t=this.parentNode;t&&t.removeChild(this)}function tie(){return this.each(eie)}function nie(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rie(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function iie(t){return this.select(t?rie:nie)}function sie(t){return arguments.length?this.property("__data__",t):this.node().__data__}function oie(t){return function(e){t.call(this,e,this.__data__)}}function aie(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function lie(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function Aie(t,e,n){return function(){var r=this.__on,i,s=oie(e);if(r){for(var A=0,o=r.length;A<o;++A)if((i=r[A]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function uie(t,e,n){var r=aie(t+""),i,s=r.length,A;if(arguments.length<2){var o=this.node().__on;if(o){for(var g=0,w=o.length,C;g<w;++g)for(i=0,C=o[g];i<s;++i)if((A=r[i]).type===C.type&&A.name===C.name)return C.value}return}for(o=e?Aie:lie,i=0;i<s;++i)this.each(o(r[i],e,n));return this}function _z(t,e,n){var r=dz(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function cie(t,e){return function(){return _z(this,t,e)}}function hie(t,e){return function(){return _z(this,t,e.apply(this,arguments))}}function fie(t,e){return this.each((typeof e=="function"?hie:cie)(t,e))}function*die(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,A;i<s;++i)(A=r[i])&&(yield A)}var lS=[null];function Ro(t,e){this._groups=t,this._parents=e}function pm(){return new Ro([[document.documentElement]],lS)}function pie(){return this}Ro.prototype=pm.prototype={constructor:Ro,select:Gne,selectAll:Hne,selectChild:Zne,selectChildren:Jne,filter:ere,data:ore,enter:tre,exit:lre,join:Are,merge:ure,selection:pie,order:cre,sort:hre,call:dre,nodes:pre,node:gre,size:mre,empty:yre,each:_re,attr:Sre,style:Ire,property:Rre,classed:Fre,text:Gre,html:Wre,raise:qre,lower:Yre,append:Xre,insert:Jre,remove:tie,clone:iie,datum:sie,on:uie,dispatch:fie,[Symbol.iterator]:die};function io(t){return typeof t=="string"?new Ro([[document.querySelector(t)]],[document.documentElement]):new Ro([[t]],lS)}function gie(t){return typeof t=="string"?new Ro([document.querySelectorAll(t)],[document.documentElement]):new Ro([Az(t)],lS)}function gm(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Z2(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Cf(){}var Pg=.7,P_=1/Pg,U0="\\s*([+-]?\\d+)\\s*",Ig="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",FA="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mie=/^#([0-9a-f]{3,8})$/,yie=new RegExp(`^rgb\\(${U0},${U0},${U0}\\)$`),_ie=new RegExp(`^rgb\\(${FA},${FA},${FA}\\)$`),vie=new RegExp(`^rgba\\(${U0},${U0},${U0},${Ig}\\)$`),xie=new RegExp(`^rgba\\(${FA},${FA},${FA},${Ig}\\)$`),wie=new RegExp(`^hsl\\(${Ig},${FA},${FA}\\)$`),bie=new RegExp(`^hsla\\(${Ig},${FA},${FA},${Ig}\\)$`),vI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};gm(Cf,lf,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:xI,formatHex:xI,formatHex8:Eie,formatHsl:Tie,formatRgb:wI,toString:wI});function xI(){return this.rgb().formatHex()}function Eie(){return this.rgb().formatHex8()}function Tie(){return xz(this).formatHsl()}function wI(){return this.rgb().formatRgb()}function lf(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=mie.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?bI(e):n===3?new uo(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?C1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?C1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=yie.exec(t))?new uo(e[1],e[2],e[3],1):(e=_ie.exec(t))?new uo(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=vie.exec(t))?C1(e[1],e[2],e[3],e[4]):(e=xie.exec(t))?C1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=wie.exec(t))?SI(e[1],e[2]/100,e[3]/100,1):(e=bie.exec(t))?SI(e[1],e[2]/100,e[3]/100,e[4]):vI.hasOwnProperty(t)?bI(vI[t]):t==="transparent"?new uo(NaN,NaN,NaN,0):null}function bI(t){return new uo(t>>16&255,t>>8&255,t&255,1)}function C1(t,e,n,r){return r<=0&&(t=e=n=NaN),new uo(t,e,n,r)}function vz(t){return t instanceof Cf||(t=lf(t)),t?(t=t.rgb(),new uo(t.r,t.g,t.b,t.opacity)):new uo}function kg(t,e,n,r){return arguments.length===1?vz(t):new uo(t,e,n,r??1)}function uo(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}gm(uo,kg,Z2(Cf,{brighter(t){return t=t==null?P_:Math.pow(P_,t),new uo(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Pg:Math.pow(Pg,t),new uo(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new uo(Wh(this.r),Wh(this.g),Wh(this.b),I_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:EI,formatHex:EI,formatHex8:Sie,formatRgb:TI,toString:TI}));function EI(){return`#${Gh(this.r)}${Gh(this.g)}${Gh(this.b)}`}function Sie(){return`#${Gh(this.r)}${Gh(this.g)}${Gh(this.b)}${Gh((isNaN(this.opacity)?1:this.opacity)*255)}`}function TI(){const t=I_(this.opacity);return`${t===1?"rgb(":"rgba("}${Wh(this.r)}, ${Wh(this.g)}, ${Wh(this.b)}${t===1?")":`, ${t})`}`}function I_(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Wh(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Gh(t){return t=Wh(t),(t<16?"0":"")+t.toString(16)}function SI(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new jl(t,e,n,r)}function xz(t){if(t instanceof jl)return new jl(t.h,t.s,t.l,t.opacity);if(t instanceof Cf||(t=lf(t)),!t)return new jl;if(t instanceof jl)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),A=NaN,o=s-i,g=(s+i)/2;return o?(e===s?A=(n-r)/o+(n<r)*6:n===s?A=(r-e)/o+2:A=(e-n)/o+4,o/=g<.5?s+i:2-s-i,A*=60):o=g>0&&g<1?0:A,new jl(A,o,g,t.opacity)}function Mie(t,e,n,r){return arguments.length===1?xz(t):new jl(t,e,n,r??1)}function jl(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}gm(jl,Mie,Z2(Cf,{brighter(t){return t=t==null?P_:Math.pow(P_,t),new jl(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Pg:Math.pow(Pg,t),new jl(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new uo(mw(t>=240?t-240:t+120,i,r),mw(t,i,r),mw(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new jl(MI(this.h),P1(this.s),P1(this.l),I_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=I_(this.opacity);return`${t===1?"hsl(":"hsla("}${MI(this.h)}, ${P1(this.s)*100}%, ${P1(this.l)*100}%${t===1?")":`, ${t})`}`}}));function MI(t){return t=(t||0)%360,t<0?t+360:t}function P1(t){return Math.max(0,Math.min(1,t||0))}function mw(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Cie=Math.PI/180,Pie=180/Math.PI,k_=18,wz=.96422,bz=1,Ez=.82521,Tz=4/29,V0=6/29,Sz=3*V0*V0,Iie=V0*V0*V0;function Mz(t){if(t instanceof NA)return new NA(t.l,t.a,t.b,t.opacity);if(t instanceof DA)return Pz(t);t instanceof uo||(t=vz(t));var e=xw(t.r),n=xw(t.g),r=xw(t.b),i=yw((.2225045*e+.7168786*n+.0606169*r)/bz),s,A;return e===n&&n===r?s=A=i:(s=yw((.4360747*e+.3850649*n+.1430804*r)/wz),A=yw((.0139322*e+.0971045*n+.7141733*r)/Ez)),new NA(116*i-16,500*(s-i),200*(i-A),t.opacity)}function kie(t,e,n,r){return arguments.length===1?Mz(t):new NA(t,e,n,r??1)}function NA(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}gm(NA,kie,Z2(Cf,{brighter(t){return new NA(this.l+k_*(t??1),this.a,this.b,this.opacity)},darker(t){return new NA(this.l-k_*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=wz*_w(e),t=bz*_w(t),n=Ez*_w(n),new uo(vw(3.1338561*e-1.6168667*t-.4906146*n),vw(-.9787684*e+1.9161415*t+.033454*n),vw(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function yw(t){return t>Iie?Math.pow(t,1/3):t/Sz+Tz}function _w(t){return t>V0?t*t*t:Sz*(t-Tz)}function vw(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function xw(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Cz(t){if(t instanceof DA)return new DA(t.h,t.c,t.l,t.opacity);if(t instanceof NA||(t=Mz(t)),t.a===0&&t.b===0)return new DA(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Pie;return new DA(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function CI(t,e,n,r){return arguments.length===1?Cz(t):new DA(n,e,t,r??1)}function Lie(t,e,n,r){return arguments.length===1?Cz(t):new DA(t,e,n,r??1)}function DA(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Pz(t){if(isNaN(t.h))return new NA(t.l,0,0,t.opacity);var e=t.h*Cie;return new NA(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}gm(DA,Lie,Z2(Cf,{brighter(t){return new DA(this.h,this.c,this.l+k_*(t??1),this.opacity)},darker(t){return new DA(this.h,this.c,this.l-k_*(t??1),this.opacity)},rgb(){return Pz(this).rgb()}}));function Die(t,e,n,r,i){var s=t*t,A=s*t;return((1-3*t+3*s-A)*e+(4-6*s+3*A)*n+(1+3*t+3*s-3*A)*r+A*i)/6}function Rie(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],s=t[r+1],A=r>0?t[r-1]:2*i-s,o=r<e-1?t[r+2]:2*s-i;return Die((n-r/e)*e,A,i,s,o)}}const AS=t=>()=>t;function Bie(t,e){return function(n){return t+n*e}}function zie(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Oie(t){return(t=+t)==1?Iz:function(e,n){return n-e?zie(e,n,t):AS(isNaN(e)?n:e)}}function Iz(t,e){var n=e-t;return n?Bie(t,n):AS(isNaN(t)?e:t)}const L_=function t(e){var n=Oie(e);function r(i,s){var A=n((i=kg(i)).r,(s=kg(s)).r),o=n(i.g,s.g),g=n(i.b,s.b),w=Iz(i.opacity,s.opacity);return function(C){return i.r=A(C),i.g=o(C),i.b=g(C),i.opacity=w(C),i+""}}return r.gamma=t,r}(1);function Fie(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),s=new Array(n),A,o;for(A=0;A<n;++A)o=kg(e[A]),r[A]=o.r||0,i[A]=o.g||0,s[A]=o.b||0;return r=t(r),i=t(i),s=t(s),o.opacity=1,function(g){return o.r=r(g),o.g=i(g),o.b=s(g),o+""}}}var kz=Fie(Rie);function Nie(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function Uie(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Vie(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),A;for(A=0;A<r;++A)i[A]=uS(t[A],e[A]);for(;A<n;++A)s[A]=e[A];return function(o){for(A=0;A<r;++A)s[A]=i[A](o);return s}}function Gie(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function $l(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function $ie(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=uS(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var B3=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ww=new RegExp(B3.source,"g");function jie(t){return function(){return t}}function Hie(t){return function(e){return t(e)+""}}function Lz(t,e){var n=B3.lastIndex=ww.lastIndex=0,r,i,s,A=-1,o=[],g=[];for(t=t+"",e=e+"";(r=B3.exec(t))&&(i=ww.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[A]?o[A]+=s:o[++A]=s),(r=r[0])===(i=i[0])?o[A]?o[A]+=i:o[++A]=i:(o[++A]=null,g.push({i:A,x:$l(r,i)})),n=ww.lastIndex;return n<e.length&&(s=e.slice(n),o[A]?o[A]+=s:o[++A]=s),o.length<2?g[0]?Hie(g[0].x):jie(e):(e=g.length,function(w){for(var C=0,I;C<e;++C)o[(I=g[C]).i]=I.x(w);return o.join("")})}function uS(t,e){var n=typeof e,r;return e==null||n==="boolean"?AS(e):(n==="number"?$l:n==="string"?(r=lf(e))?(e=r,L_):Lz:e instanceof lf?L_:e instanceof Date?Gie:Uie(e)?Nie:Array.isArray(e)?Vie:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?$ie:$l)(t,e)}function Wie(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var PI=180/Math.PI,z3={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Dz(t,e,n,r,i,s){var A,o,g;return(A=Math.sqrt(t*t+e*e))&&(t/=A,e/=A),(g=t*n+e*r)&&(n-=t*g,r-=e*g),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,g/=o),t*r<e*n&&(t=-t,e=-e,g=-g,A=-A),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*PI,skewX:Math.atan(g)*PI,scaleX:A,scaleY:o}}var I1;function Qie(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?z3:Dz(e.a,e.b,e.c,e.d,e.e,e.f)}function qie(t){return t==null||(I1||(I1=document.createElementNS("http://www.w3.org/2000/svg","g")),I1.setAttribute("transform",t),!(t=I1.transform.baseVal.consolidate()))?z3:(t=t.matrix,Dz(t.a,t.b,t.c,t.d,t.e,t.f))}function Rz(t,e,n,r){function i(w){return w.length?w.pop()+" ":""}function s(w,C,I,k,U,H){if(w!==I||C!==k){var q=U.push("translate(",null,e,null,n);H.push({i:q-4,x:$l(w,I)},{i:q-2,x:$l(C,k)})}else(I||k)&&U.push("translate("+I+e+k+n)}function A(w,C,I,k){w!==C?(w-C>180?C+=360:C-w>180&&(w+=360),k.push({i:I.push(i(I)+"rotate(",null,r)-2,x:$l(w,C)})):C&&I.push(i(I)+"rotate("+C+r)}function o(w,C,I,k){w!==C?k.push({i:I.push(i(I)+"skewX(",null,r)-2,x:$l(w,C)}):C&&I.push(i(I)+"skewX("+C+r)}function g(w,C,I,k,U,H){if(w!==I||C!==k){var q=U.push(i(U)+"scale(",null,",",null,")");H.push({i:q-4,x:$l(w,I)},{i:q-2,x:$l(C,k)})}else(I!==1||k!==1)&&U.push(i(U)+"scale("+I+","+k+")")}return function(w,C){var I=[],k=[];return w=t(w),C=t(C),s(w.translateX,w.translateY,C.translateX,C.translateY,I,k),A(w.rotate,C.rotate,I,k),o(w.skewX,C.skewX,I,k),g(w.scaleX,w.scaleY,C.scaleX,C.scaleY,I,k),w=C=null,function(U){for(var H=-1,q=k.length,se;++H<q;)I[(se=k[H]).i]=se.x(U);return I.join("")}}}var Zie=Rz(Qie,"px, ","px)","deg)"),Yie=Rz(qie,", ",")",")");function II(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}var Ad=0,Rp=0,fp=0,Bz=1e3,D_,Bp,R_=0,Af=0,Y2=0,Lg=typeof performance=="object"&&performance.now?performance:Date,zz=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function cS(){return Af||(zz(Xie),Af=Lg.now()+Y2)}function Xie(){Af=0}function B_(){this._call=this._time=this._next=null}B_.prototype=Oz.prototype={constructor:B_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?cS():+n)+(e==null?0:+e),!this._next&&Bp!==this&&(Bp?Bp._next=this:D_=this,Bp=this),this._call=t,this._time=n,O3()},stop:function(){this._call&&(this._call=null,this._time=1/0,O3())}};function Oz(t,e,n){var r=new B_;return r.restart(t,e,n),r}function Kie(){cS(),++Ad;for(var t=D_,e;t;)(e=Af-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ad}function kI(){Af=(R_=Lg.now())+Y2,Ad=Rp=0;try{Kie()}finally{Ad=0,ese(),Af=0}}function Jie(){var t=Lg.now(),e=t-R_;e>Bz&&(Y2-=e,R_=t)}function ese(){for(var t,e=D_,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:D_=n);Bp=t,O3(r)}function O3(t){if(!Ad){Rp&&(Rp=clearTimeout(Rp));var e=t-Af;e>24?(t<1/0&&(Rp=setTimeout(kI,t-Lg.now()-Y2)),fp&&(fp=clearInterval(fp))):(fp||(R_=Lg.now(),fp=setInterval(Jie,Bz)),Ad=1,zz(kI))}}function LI(t,e,n){var r=new B_;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var tse=az("start","end","cancel","interrupt"),nse=[],Fz=0,DI=1,F3=2,by=3,RI=4,N3=5,Ey=6;function X2(t,e,n,r,i,s){var A=t.__transition;if(!A)t.__transition={};else if(n in A)return;rse(t,n,{name:e,index:r,group:i,on:tse,tween:nse,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Fz})}function hS(t,e){var n=sA(t,e);if(n.state>Fz)throw new Error("too late; already scheduled");return n}function WA(t,e){var n=sA(t,e);if(n.state>by)throw new Error("too late; already running");return n}function sA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function rse(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Oz(s,0,n.time);function s(w){n.state=DI,n.timer.restart(A,n.delay,n.time),n.delay<=w&&A(w-n.delay)}function A(w){var C,I,k,U;if(n.state!==DI)return g();for(C in r)if(U=r[C],U.name===n.name){if(U.state===by)return LI(A);U.state===RI?(U.state=Ey,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete r[C]):+C<e&&(U.state=Ey,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete r[C])}if(LI(function(){n.state===by&&(n.state=RI,n.timer.restart(o,n.delay,n.time),o(w))}),n.state=F3,n.on.call("start",t,t.__data__,n.index,n.group),n.state===F3){for(n.state=by,i=new Array(k=n.tween.length),C=0,I=-1;C<k;++C)(U=n.tween[C].value.call(t,t.__data__,n.index,n.group))&&(i[++I]=U);i.length=I+1}}function o(w){for(var C=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(g),n.state=N3,1),I=-1,k=i.length;++I<k;)i[I].call(t,C);n.state===N3&&(n.on.call("end",t,t.__data__,n.index,n.group),g())}function g(){n.state=Ey,n.timer.stop(),delete r[e];for(var w in r)return;delete t.__transition}}function ise(t,e){var n=t.__transition,r,i,s=!0,A;if(n){e=e==null?null:e+"";for(A in n){if((r=n[A]).name!==e){s=!1;continue}i=r.state>F3&&r.state<N3,r.state=Ey,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[A]}s&&delete t.__transition}}function sse(t){return this.each(function(){ise(this,t)})}function ose(t,e){var n,r;return function(){var i=WA(this,t),s=i.tween;if(s!==n){r=n=s;for(var A=0,o=r.length;A<o;++A)if(r[A].name===e){r=r.slice(),r.splice(A,1);break}}i.tween=r}}function ase(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=WA(this,t),A=s.tween;if(A!==r){i=(r=A).slice();for(var o={name:e,value:n},g=0,w=i.length;g<w;++g)if(i[g].name===e){i[g]=o;break}g===w&&i.push(o)}s.tween=i}}function lse(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=sA(this.node(),n).tween,i=0,s=r.length,A;i<s;++i)if((A=r[i]).name===t)return A.value;return null}return this.each((e==null?ose:ase)(n,t,e))}function fS(t,e,n){var r=t._id;return t.each(function(){var i=WA(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return sA(i,r).value[e]}}function Nz(t,e){var n;return(typeof e=="number"?$l:e instanceof lf?L_:(n=lf(e))?(e=n,L_):Lz)(t,e)}function Ase(t){return function(){this.removeAttribute(t)}}function use(t){return function(){this.removeAttributeNS(t.space,t.local)}}function cse(t,e,n){var r,i=n+"",s;return function(){var A=this.getAttribute(t);return A===i?null:A===r?s:s=e(r=A,n)}}function hse(t,e,n){var r,i=n+"",s;return function(){var A=this.getAttributeNS(t.space,t.local);return A===i?null:A===r?s:s=e(r=A,n)}}function fse(t,e,n){var r,i,s;return function(){var A,o=n(this),g;return o==null?void this.removeAttribute(t):(A=this.getAttribute(t),g=o+"",A===g?null:A===r&&g===i?s:(i=g,s=e(r=A,o)))}}function dse(t,e,n){var r,i,s;return function(){var A,o=n(this),g;return o==null?void this.removeAttributeNS(t.space,t.local):(A=this.getAttributeNS(t.space,t.local),g=o+"",A===g?null:A===r&&g===i?s:(i=g,s=e(r=A,o)))}}function pse(t,e){var n=q2(t),r=n==="transform"?Yie:Nz;return this.attrTween(t,typeof e=="function"?(n.local?dse:fse)(n,r,fS(this,"attr."+t,e)):e==null?(n.local?use:Ase)(n):(n.local?hse:cse)(n,r,e))}function gse(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function mse(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function yse(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&mse(t,s)),n}return i._value=e,i}function _se(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&gse(t,s)),n}return i._value=e,i}function vse(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=q2(t);return this.tween(n,(r.local?yse:_se)(r,e))}function xse(t,e){return function(){hS(this,t).delay=+e.apply(this,arguments)}}function wse(t,e){return e=+e,function(){hS(this,t).delay=e}}function bse(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?xse:wse)(e,t)):sA(this.node(),e).delay}function Ese(t,e){return function(){WA(this,t).duration=+e.apply(this,arguments)}}function Tse(t,e){return e=+e,function(){WA(this,t).duration=e}}function Sse(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ese:Tse)(e,t)):sA(this.node(),e).duration}function Mse(t,e){if(typeof e!="function")throw new Error;return function(){WA(this,t).ease=e}}function Cse(t){var e=this._id;return arguments.length?this.each(Mse(e,t)):sA(this.node(),e).ease}function Pse(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;WA(this,t).ease=n}}function Ise(t){if(typeof t!="function")throw new Error;return this.each(Pse(this._id,t))}function kse(t){typeof t!="function"&&(t=cz(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,o=r[i]=[],g,w=0;w<A;++w)(g=s[w])&&t.call(g,g.__data__,w,s)&&o.push(g);return new Ju(r,this._parents,this._name,this._id)}function Lse(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),A=new Array(r),o=0;o<s;++o)for(var g=e[o],w=n[o],C=g.length,I=A[o]=new Array(C),k,U=0;U<C;++U)(k=g[U]||w[U])&&(I[U]=k);for(;o<r;++o)A[o]=e[o];return new Ju(A,this._parents,this._name,this._id)}function Dse(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Rse(t,e,n){var r,i,s=Dse(e)?hS:WA;return function(){var A=s(this,t),o=A.on;o!==r&&(i=(r=o).copy()).on(e,n),A.on=i}}function Bse(t,e){var n=this._id;return arguments.length<2?sA(this.node(),n).on.on(t):this.each(Rse(n,t,e))}function zse(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Ose(){return this.on("end.remove",zse(this._id))}function Fse(t){var e=this._name,n=this._id;typeof t!="function"&&(t=oS(t));for(var r=this._groups,i=r.length,s=new Array(i),A=0;A<i;++A)for(var o=r[A],g=o.length,w=s[A]=new Array(g),C,I,k=0;k<g;++k)(C=o[k])&&(I=t.call(C,C.__data__,k,o))&&("__data__"in C&&(I.__data__=C.__data__),w[k]=I,X2(w[k],e,n,k,w,sA(C,n)));return new Ju(s,this._parents,e,n)}function Nse(t){var e=this._name,n=this._id;typeof t!="function"&&(t=uz(t));for(var r=this._groups,i=r.length,s=[],A=[],o=0;o<i;++o)for(var g=r[o],w=g.length,C,I=0;I<w;++I)if(C=g[I]){for(var k=t.call(C,C.__data__,I,g),U,H=sA(C,n),q=0,se=k.length;q<se;++q)(U=k[q])&&X2(U,e,n,q,k,H);s.push(k),A.push(C)}return new Ju(s,A,e,n)}var Use=pm.prototype.constructor;function Vse(){return new Use(this._groups,this._parents)}function Gse(t,e){var n,r,i;return function(){var s=ld(this,t),A=(this.style.removeProperty(t),ld(this,t));return s===A?null:s===n&&A===r?i:i=e(n=s,r=A)}}function Uz(t){return function(){this.style.removeProperty(t)}}function $se(t,e,n){var r,i=n+"",s;return function(){var A=ld(this,t);return A===i?null:A===r?s:s=e(r=A,n)}}function jse(t,e,n){var r,i,s;return function(){var A=ld(this,t),o=n(this),g=o+"";return o==null&&(g=o=(this.style.removeProperty(t),ld(this,t))),A===g?null:A===r&&g===i?s:(i=g,s=e(r=A,o))}}function Hse(t,e){var n,r,i,s="style."+e,A="end."+s,o;return function(){var g=WA(this,t),w=g.on,C=g.value[s]==null?o||(o=Uz(e)):void 0;(w!==n||i!==C)&&(r=(n=w).copy()).on(A,i=C),g.on=r}}function Wse(t,e,n){var r=(t+="")=="transform"?Zie:Nz;return e==null?this.styleTween(t,Gse(t,r)).on("end.style."+t,Uz(t)):typeof e=="function"?this.styleTween(t,jse(t,r,fS(this,"style."+t,e))).each(Hse(this._id,t)):this.styleTween(t,$se(t,r,e),n).on("end.style."+t,null)}function Qse(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function qse(t,e,n){var r,i;function s(){var A=e.apply(this,arguments);return A!==i&&(r=(i=A)&&Qse(t,A,n)),r}return s._value=e,s}function Zse(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,qse(t,e,n??""))}function Yse(t){return function(){this.textContent=t}}function Xse(t){return function(){var e=t(this);this.textContent=e??""}}function Kse(t){return this.tween("text",typeof t=="function"?Xse(fS(this,"text",t)):Yse(t==null?"":t+""))}function Jse(t){return function(e){this.textContent=t.call(this,e)}}function eoe(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Jse(i)),e}return r._value=t,r}function toe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,eoe(t))}function noe(){for(var t=this._name,e=this._id,n=Vz(),r=this._groups,i=r.length,s=0;s<i;++s)for(var A=r[s],o=A.length,g,w=0;w<o;++w)if(g=A[w]){var C=sA(g,e);X2(g,t,n,w,A,{time:C.time+C.delay+C.duration,delay:0,duration:C.duration,ease:C.ease})}return new Ju(r,this._parents,t,n)}function roe(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,A){var o={value:A},g={value:function(){--i===0&&s()}};n.each(function(){var w=WA(this,r),C=w.on;C!==t&&(e=(t=C).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(g)),w.on=e}),i===0&&s()})}var ioe=0;function Ju(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Vz(){return++ioe}var wu=pm.prototype;Ju.prototype={constructor:Ju,select:Fse,selectAll:Nse,selectChild:wu.selectChild,selectChildren:wu.selectChildren,filter:kse,merge:Lse,selection:Vse,transition:noe,call:wu.call,nodes:wu.nodes,node:wu.node,size:wu.size,empty:wu.empty,each:wu.each,on:Bse,attr:pse,attrTween:vse,style:Wse,styleTween:Zse,text:Kse,textTween:toe,remove:Ose,tween:lse,delay:bse,duration:Sse,ease:Cse,easeVarying:Ise,end:roe,[Symbol.iterator]:wu[Symbol.iterator]};function soe(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var ooe={time:null,delay:0,duration:250,ease:soe};function aoe(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function loe(t){var e,n;t instanceof Ju?(e=t._id,t=t._name):(e=Vz(),(n=ooe).time=cS(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var A=r[s],o=A.length,g,w=0;w<o;++w)(g=A[w])&&X2(g,t,e,w,A,n||aoe(g,e));return new Ju(r,this._parents,t,e)}pm.prototype.interrupt=sse;pm.prototype.transition=loe;const U3=Math.PI,V3=2*U3,zh=1e-6,Aoe=V3-zh;function Gz(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function uoe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Gz;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let coe=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Gz:uoe(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,A){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+A}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let A=this._x1,o=this._y1,g=r-e,w=i-n,C=A-e,I=o-n,k=C*C+I*I;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(k>zh)if(!(Math.abs(I*g-w*C)>zh)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let U=r-A,H=i-o,q=g*g+w*w,se=U*U+H*H,X=Math.sqrt(q),te=Math.sqrt(k),ie=s*Math.tan((U3-Math.acos((q+k-se)/(2*X*te)))/2),fe=ie/te,me=ie/X;Math.abs(fe-1)>zh&&this._append`L${e+fe*C},${n+fe*I}`,this._append`A${s},${s},0,0,${+(I*U>C*H)},${this._x1=e+me*g},${this._y1=n+me*w}`}}arc(e,n,r,i,s,A){if(e=+e,n=+n,r=+r,A=!!A,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),g=r*Math.sin(i),w=e+o,C=n+g,I=1^A,k=A?i-s:s-i;this._x1===null?this._append`M${w},${C}`:(Math.abs(this._x1-w)>zh||Math.abs(this._y1-C)>zh)&&this._append`L${w},${C}`,r&&(k<0&&(k=k%V3+V3),k>Aoe?this._append`A${r},${r},0,1,${I},${e-o},${n-g}A${r},${r},0,1,${I},${this._x1=w},${this._y1=C}`:k>zh&&this._append`A${r},${r},0,${+(k>=U3)},${I},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};const $u=11102230246251565e-32,Js=134217729,hoe=(3+8*$u)*$u;function bw(t,e,n,r,i){let s,A,o,g,w=e[0],C=r[0],I=0,k=0;C>w==C>-w?(s=w,w=e[++I]):(s=C,C=r[++k]);let U=0;if(I<t&&k<n)for(C>w==C>-w?(A=w+s,o=s-(A-w),w=e[++I]):(A=C+s,o=s-(A-C),C=r[++k]),s=A,o!==0&&(i[U++]=o);I<t&&k<n;)C>w==C>-w?(A=s+w,g=A-s,o=s-(A-g)+(w-g),w=e[++I]):(A=s+C,g=A-s,o=s-(A-g)+(C-g),C=r[++k]),s=A,o!==0&&(i[U++]=o);for(;I<t;)A=s+w,g=A-s,o=s-(A-g)+(w-g),w=e[++I],s=A,o!==0&&(i[U++]=o);for(;k<n;)A=s+C,g=A-s,o=s-(A-g)+(C-g),C=r[++k],s=A,o!==0&&(i[U++]=o);return(s!==0||U===0)&&(i[U++]=s),U}function foe(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function mm(t){return new Float64Array(t)}const doe=(3+16*$u)*$u,poe=(2+12*$u)*$u,goe=(9+64*$u)*$u*$u,e0=mm(4),BI=mm(8),zI=mm(12),OI=mm(16),Mo=mm(4);function moe(t,e,n,r,i,s,A){let o,g,w,C,I,k,U,H,q,se,X,te,ie,fe,me,Se,He,Qe;const Ke=t-i,nt=n-i,Ne=e-s,rt=r-s;fe=Ke*rt,k=Js*Ke,U=k-(k-Ke),H=Ke-U,k=Js*rt,q=k-(k-rt),se=rt-q,me=H*se-(fe-U*q-H*q-U*se),Se=Ne*nt,k=Js*Ne,U=k-(k-Ne),H=Ne-U,k=Js*nt,q=k-(k-nt),se=nt-q,He=H*se-(Se-U*q-H*q-U*se),X=me-He,I=me-X,e0[0]=me-(X+I)+(I-He),te=fe+X,I=te-fe,ie=fe-(te-I)+(X-I),X=ie-Se,I=ie-X,e0[1]=ie-(X+I)+(I-Se),Qe=te+X,I=Qe-te,e0[2]=te-(Qe-I)+(X-I),e0[3]=Qe;let Ze=foe(4,e0),mt=poe*A;if(Ze>=mt||-Ze>=mt||(I=t-Ke,o=t-(Ke+I)+(I-i),I=n-nt,w=n-(nt+I)+(I-i),I=e-Ne,g=e-(Ne+I)+(I-s),I=r-rt,C=r-(rt+I)+(I-s),o===0&&g===0&&w===0&&C===0)||(mt=goe*A+hoe*Math.abs(Ze),Ze+=Ke*C+rt*o-(Ne*w+nt*g),Ze>=mt||-Ze>=mt))return Ze;fe=o*rt,k=Js*o,U=k-(k-o),H=o-U,k=Js*rt,q=k-(k-rt),se=rt-q,me=H*se-(fe-U*q-H*q-U*se),Se=g*nt,k=Js*g,U=k-(k-g),H=g-U,k=Js*nt,q=k-(k-nt),se=nt-q,He=H*se-(Se-U*q-H*q-U*se),X=me-He,I=me-X,Mo[0]=me-(X+I)+(I-He),te=fe+X,I=te-fe,ie=fe-(te-I)+(X-I),X=ie-Se,I=ie-X,Mo[1]=ie-(X+I)+(I-Se),Qe=te+X,I=Qe-te,Mo[2]=te-(Qe-I)+(X-I),Mo[3]=Qe;const Kt=bw(4,e0,4,Mo,BI);fe=Ke*C,k=Js*Ke,U=k-(k-Ke),H=Ke-U,k=Js*C,q=k-(k-C),se=C-q,me=H*se-(fe-U*q-H*q-U*se),Se=Ne*w,k=Js*Ne,U=k-(k-Ne),H=Ne-U,k=Js*w,q=k-(k-w),se=w-q,He=H*se-(Se-U*q-H*q-U*se),X=me-He,I=me-X,Mo[0]=me-(X+I)+(I-He),te=fe+X,I=te-fe,ie=fe-(te-I)+(X-I),X=ie-Se,I=ie-X,Mo[1]=ie-(X+I)+(I-Se),Qe=te+X,I=Qe-te,Mo[2]=te-(Qe-I)+(X-I),Mo[3]=Qe;const Tt=bw(Kt,BI,4,Mo,zI);fe=o*C,k=Js*o,U=k-(k-o),H=o-U,k=Js*C,q=k-(k-C),se=C-q,me=H*se-(fe-U*q-H*q-U*se),Se=g*w,k=Js*g,U=k-(k-g),H=g-U,k=Js*w,q=k-(k-w),se=w-q,He=H*se-(Se-U*q-H*q-U*se),X=me-He,I=me-X,Mo[0]=me-(X+I)+(I-He),te=fe+X,I=te-fe,ie=fe-(te-I)+(X-I),X=ie-Se,I=ie-X,Mo[1]=ie-(X+I)+(I-Se),Qe=te+X,I=Qe-te,Mo[2]=te-(Qe-I)+(X-I),Mo[3]=Qe;const dn=bw(Tt,zI,4,Mo,OI);return OI[dn-1]}function yoe(t,e,n,r,i,s){const A=(e-s)*(n-i),o=(t-i)*(r-s),g=A-o,w=Math.abs(A+o);return Math.abs(g)>=doe*w?g:-moe(t,e,n,r,i,s,w)}function _oe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function z_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function ud(t){return t=z_(Math.abs(t)),t?t[1]:NaN}function voe(t,e){return function(n,r){for(var i=n.length,s=[],A=0,o=t[0],g=0;i>0&&o>0&&(g+o+1>r&&(o=Math.max(1,r-g)),s.push(n.substring(i-=o,i+o)),!((g+=o+1)>r));)o=t[A=(A+1)%t.length];return s.reverse().join(e)}}function xoe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var woe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function O_(t){if(!(e=woe.exec(t)))throw new Error("invalid format: "+t);var e;return new dS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}O_.prototype=dS.prototype;function dS(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}dS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function boe(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var $z;function Eoe(t,e){var n=z_(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-($z=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,A=r.length;return s===A?r:s>A?r+new Array(s-A+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+z_(t,Math.max(0,e+s-1))[0]}function FI(t,e){var n=z_(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const NI={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:_oe,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>FI(t*100,e),r:FI,s:Eoe,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function UI(t){return t}var VI=Array.prototype.map,GI=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Toe(t){var e=t.grouping===void 0||t.thousands===void 0?UI:voe(VI.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?UI:xoe(VI.call(t.numerals,String)),A=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"":t.minus+"",g=t.nan===void 0?"NaN":t.nan+"";function w(I){I=O_(I);var k=I.fill,U=I.align,H=I.sign,q=I.symbol,se=I.zero,X=I.width,te=I.comma,ie=I.precision,fe=I.trim,me=I.type;me==="n"?(te=!0,me="g"):NI[me]||(ie===void 0&&(ie=12),fe=!0,me="g"),(se||k==="0"&&U==="=")&&(se=!0,k="0",U="=");var Se=q==="$"?n:q==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",He=q==="$"?r:/[%p]/.test(me)?A:"",Qe=NI[me],Ke=/[defgprs%]/.test(me);ie=ie===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,ie)):Math.max(0,Math.min(20,ie));function nt(Ne){var rt=Se,Ze=He,mt,Kt,Tt;if(me==="c")Ze=Qe(Ne)+Ze,Ne="";else{Ne=+Ne;var dn=Ne<0||1/Ne<0;if(Ne=isNaN(Ne)?g:Qe(Math.abs(Ne),ie),fe&&(Ne=boe(Ne)),dn&&+Ne==0&&H!=="+"&&(dn=!1),rt=(dn?H==="("?H:o:H==="-"||H==="("?"":H)+rt,Ze=(me==="s"?GI[8+$z/3]:"")+Ze+(dn&&H==="("?")":""),Ke){for(mt=-1,Kt=Ne.length;++mt<Kt;)if(Tt=Ne.charCodeAt(mt),48>Tt||Tt>57){Ze=(Tt===46?i+Ne.slice(mt+1):Ne.slice(mt))+Ze,Ne=Ne.slice(0,mt);break}}}te&&!se&&(Ne=e(Ne,1/0));var _t=rt.length+Ne.length+Ze.length,Et=_t<X?new Array(X-_t+1).join(k):"";switch(te&&se&&(Ne=e(Et+Ne,Et.length?X-Ze.length:1/0),Et=""),U){case"<":Ne=rt+Ne+Ze+Et;break;case"=":Ne=rt+Et+Ne+Ze;break;case"^":Ne=Et.slice(0,_t=Et.length>>1)+rt+Ne+Ze+Et.slice(_t);break;default:Ne=Et+rt+Ne+Ze;break}return s(Ne)}return nt.toString=function(){return I+""},nt}function C(I,k){var U=w((I=O_(I),I.type="f",I)),H=Math.max(-8,Math.min(8,Math.floor(ud(k)/3)))*3,q=Math.pow(10,-H),se=GI[8+H/3];return function(X){return U(q*X)+se}}return{format:w,formatPrefix:C}}var k1,jz,Hz;Soe({thousands:",",grouping:[3],currency:["$",""]});function Soe(t){return k1=Toe(t),jz=k1.format,Hz=k1.formatPrefix,k1}function Moe(t){return Math.max(0,-ud(Math.abs(t)))}function Coe(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ud(e)/3)))*3-ud(Math.abs(t)))}function Poe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ud(e)-ud(t))+1}function pS(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Ioe(t){return function(){return t}}function koe(t){return+t}var $I=[0,1];function _0(t){return t}function G3(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Ioe(isNaN(e)?NaN:.5)}function Loe(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Doe(t,e,n){var r=t[0],i=t[1],s=e[0],A=e[1];return i<r?(r=G3(i,r),s=n(A,s)):(r=G3(r,i),s=n(s,A)),function(o){return s(r(o))}}function Roe(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),A=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++A<r;)i[A]=G3(t[A],t[A+1]),s[A]=n(e[A],e[A+1]);return function(o){var g=oz(t,o,1,r)-1;return s[g](i[g](o))}}function Wz(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Boe(){var t=$I,e=$I,n=uS,r,i,s,A=_0,o,g,w;function C(){var k=Math.min(t.length,e.length);return A!==_0&&(A=Loe(t[0],t[k-1])),o=k>2?Roe:Doe,g=w=null,I}function I(k){return k==null||isNaN(k=+k)?s:(g||(g=o(t.map(r),e,n)))(r(A(k)))}return I.invert=function(k){return A(i((w||(w=o(e,t.map(r),$l)))(k)))},I.domain=function(k){return arguments.length?(t=Array.from(k,koe),C()):t.slice()},I.range=function(k){return arguments.length?(e=Array.from(k),C()):e.slice()},I.rangeRound=function(k){return e=Array.from(k),n=Wie,C()},I.clamp=function(k){return arguments.length?(A=k?!0:_0,C()):A!==_0},I.interpolate=function(k){return arguments.length?(n=k,C()):n},I.unknown=function(k){return arguments.length?(s=k,I):s},function(k,U){return r=k,i=U,C()}}function Qz(){return Boe()(_0,_0)}function zoe(t,e,n,r){var i=D3(t,e,n),s;switch(r=O_(r??",f"),r.type){case"s":{var A=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=Coe(i,A))&&(r.precision=s),Hz(r,A)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Poe(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=Moe(i))&&(r.precision=s-(r.type==="%")*2);break}}return jz(r)}function qz(t){var e=t.domain;return t.ticks=function(n){var r=e();return k3(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return zoe(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,A=r[i],o=r[s],g,w,C=10;for(o<A&&(w=A,A=o,o=w,w=i,i=s,s=w);C-- >0;){if(w=L3(A,o,n),w===g)return r[i]=A,r[s]=o,e(r);if(w>0)A=Math.floor(A/w)*w,o=Math.ceil(o/w)*w;else if(w<0)A=Math.ceil(A*w)/w,o=Math.floor(o*w)/w;else break;g=w}return t},t}function ms(){var t=Qz();return t.copy=function(){return Wz(t,ms())},pS.apply(t,arguments),qz(t)}function Ooe(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],s=t[r],A;return s<i&&(A=n,n=r,r=A,A=i,i=s,s=A),t[n]=e.floor(i),t[r]=e.ceil(s),t}function ea(){var t=0,e=1,n=1,r=[.5],i=[0,1],s;function A(g){return g!=null&&g<=g?i[oz(r,g,0,n)]:s}function o(){var g=-1;for(r=new Array(n);++g<n;)r[g]=((g+1)*e-(g-n)*t)/(n+1);return A}return A.domain=function(g){return arguments.length?([t,e]=g,t=+t,e=+e,o()):[t,e]},A.range=function(g){return arguments.length?(n=(i=Array.from(g)).length-1,o()):i.slice()},A.invertExtent=function(g){var w=i.indexOf(g);return w<0?[NaN,NaN]:w<1?[t,r[0]]:w>=n?[r[n-1],e]:[r[w-1],r[w]]},A.unknown=function(g){return arguments.length&&(s=g),A},A.thresholds=function(){return r.slice()},A.copy=function(){return ea().domain([t,e]).range(i).unknown(s)},pS.apply(qz(A),arguments)}const Ew=new Date,Tw=new Date;function rs(t,e,n,r){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const A=i(s),o=i.ceil(s);return s-A<o-s?A:o},i.offset=(s,A)=>(e(s=new Date(+s),A==null?1:Math.floor(A)),s),i.range=(s,A,o)=>{const g=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<A)||!(o>0))return g;let w;do g.push(w=new Date(+s)),e(s,o),t(s);while(w<s&&s<A);return g},i.filter=s=>rs(A=>{if(A>=A)for(;t(A),!s(A);)A.setTime(A-1)},(A,o)=>{if(A>=A)if(o<0)for(;++o<=0;)for(;e(A,-1),!s(A););else for(;--o>=0;)for(;e(A,1),!s(A););}),n&&(i.count=(s,A)=>(Ew.setTime(+s),Tw.setTime(+A),t(Ew),t(Tw),Math.floor(n(Ew,Tw))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?A=>r(A)%s===0:A=>i.count(0,A)%s===0):i)),i}const F_=rs(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);F_.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?rs(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):F_);F_.range;const Du=1e3,ll=Du*60,Ru=ll*60,ec=Ru*24,gS=ec*7,jI=ec*30,Sw=ec*365,v0=rs(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Du)},(t,e)=>(e-t)/Du,t=>t.getUTCSeconds());v0.range;const mS=rs(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Du)},(t,e)=>{t.setTime(+t+e*ll)},(t,e)=>(e-t)/ll,t=>t.getMinutes());mS.range;const Foe=rs(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*ll)},(t,e)=>(e-t)/ll,t=>t.getUTCMinutes());Foe.range;const yS=rs(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Du-t.getMinutes()*ll)},(t,e)=>{t.setTime(+t+e*Ru)},(t,e)=>(e-t)/Ru,t=>t.getHours());yS.range;const Noe=rs(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Ru)},(t,e)=>(e-t)/Ru,t=>t.getUTCHours());Noe.range;const ym=rs(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ll)/ec,t=>t.getDate()-1);ym.range;const _S=rs(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ec,t=>t.getUTCDate()-1);_S.range;const Uoe=rs(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ec,t=>Math.floor(t/ec));Uoe.range;function Pf(t){return rs(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*ll)/gS)}const K2=Pf(0),N_=Pf(1),Voe=Pf(2),Goe=Pf(3),cd=Pf(4),$oe=Pf(5),joe=Pf(6);K2.range;N_.range;Voe.range;Goe.range;cd.range;$oe.range;joe.range;function If(t){return rs(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/gS)}const Zz=If(0),U_=If(1),Hoe=If(2),Woe=If(3),hd=If(4),Qoe=If(5),qoe=If(6);Zz.range;U_.range;Hoe.range;Woe.range;hd.range;Qoe.range;qoe.range;const vS=rs(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());vS.range;const Zoe=rs(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Zoe.range;const tc=rs(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());tc.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:rs(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});tc.range;const uf=rs(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());uf.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:rs(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});uf.range;function Yoe(t,e,n,r,i,s){const A=[[v0,1,Du],[v0,5,5*Du],[v0,15,15*Du],[v0,30,30*Du],[s,1,ll],[s,5,5*ll],[s,15,15*ll],[s,30,30*ll],[i,1,Ru],[i,3,3*Ru],[i,6,6*Ru],[i,12,12*Ru],[r,1,ec],[r,2,2*ec],[n,1,gS],[e,1,jI],[e,3,3*jI],[t,1,Sw]];function o(w,C,I){const k=C<w;k&&([w,C]=[C,w]);const U=I&&typeof I.range=="function"?I:g(w,C,I),H=U?U.range(w,+C+1):[];return k?H.reverse():H}function g(w,C,I){const k=Math.abs(C-w)/I,U=sS(([,,se])=>se).right(A,k);if(U===A.length)return t.every(D3(w/Sw,C/Sw,I));if(U===0)return F_.every(Math.max(D3(w,C,I),1));const[H,q]=A[k/A[U-1][2]<A[U][2]/k?U-1:U];return H.every(q)}return[o,g]}const[Xoe,Koe]=Yoe(tc,vS,K2,ym,yS,mS);function Mw(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Cw(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function dp(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Joe(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,A=t.shortDays,o=t.months,g=t.shortMonths,w=pp(i),C=gp(i),I=pp(s),k=gp(s),U=pp(A),H=gp(A),q=pp(o),se=gp(o),X=pp(g),te=gp(g),ie={a:dn,A:_t,b:Et,B:Jt,c:null,d:YI,e:YI,f:wae,g:Lae,G:Rae,H:_ae,I:vae,j:xae,L:Yz,m:bae,M:Eae,p:kn,q:Tn,Q:JI,s:ek,S:Tae,u:Sae,U:Mae,V:Cae,w:Pae,W:Iae,x:null,X:null,y:kae,Y:Dae,Z:Bae,"%":KI},fe={a:Tr,A:Jn,b:ir,B:ur,c:null,d:XI,e:XI,f:Nae,g:Zae,G:Xae,H:zae,I:Oae,j:Fae,L:Kz,m:Uae,M:Vae,p:Un,q:wr,Q:JI,s:ek,S:Gae,u:$ae,U:jae,V:Hae,w:Wae,W:Qae,x:null,X:null,y:qae,Y:Yae,Z:Kae,"%":KI},me={a:nt,A:Ne,b:rt,B:Ze,c:mt,d:qI,e:qI,f:pae,g:QI,G:WI,H:ZI,I:ZI,j:cae,L:dae,m:uae,M:hae,p:Ke,q:Aae,Q:mae,s:yae,S:fae,u:iae,U:sae,V:oae,w:rae,W:aae,x:Kt,X:Tt,y:QI,Y:WI,Z:lae,"%":gae};ie.x=Se(n,ie),ie.X=Se(r,ie),ie.c=Se(e,ie),fe.x=Se(n,fe),fe.X=Se(r,fe),fe.c=Se(e,fe);function Se(wt,rn){return function(Cn){var xt=[],er=-1,Hn=0,mr=wt.length,or,tr,Kr;for(Cn instanceof Date||(Cn=new Date(+Cn));++er<mr;)wt.charCodeAt(er)===37&&(xt.push(wt.slice(Hn,er)),(tr=HI[or=wt.charAt(++er)])!=null?or=wt.charAt(++er):tr=or==="e"?" ":"0",(Kr=rn[or])&&(or=Kr(Cn,tr)),xt.push(or),Hn=er+1);return xt.push(wt.slice(Hn,er)),xt.join("")}}function He(wt,rn){return function(Cn){var xt=dp(1900,void 0,1),er=Qe(xt,wt,Cn+="",0),Hn,mr;if(er!=Cn.length)return null;if("Q"in xt)return new Date(xt.Q);if("s"in xt)return new Date(xt.s*1e3+("L"in xt?xt.L:0));if(rn&&!("Z"in xt)&&(xt.Z=0),"p"in xt&&(xt.H=xt.H%12+xt.p*12),xt.m===void 0&&(xt.m="q"in xt?xt.q:0),"V"in xt){if(xt.V<1||xt.V>53)return null;"w"in xt||(xt.w=1),"Z"in xt?(Hn=Cw(dp(xt.y,0,1)),mr=Hn.getUTCDay(),Hn=mr>4||mr===0?U_.ceil(Hn):U_(Hn),Hn=_S.offset(Hn,(xt.V-1)*7),xt.y=Hn.getUTCFullYear(),xt.m=Hn.getUTCMonth(),xt.d=Hn.getUTCDate()+(xt.w+6)%7):(Hn=Mw(dp(xt.y,0,1)),mr=Hn.getDay(),Hn=mr>4||mr===0?N_.ceil(Hn):N_(Hn),Hn=ym.offset(Hn,(xt.V-1)*7),xt.y=Hn.getFullYear(),xt.m=Hn.getMonth(),xt.d=Hn.getDate()+(xt.w+6)%7)}else("W"in xt||"U"in xt)&&("w"in xt||(xt.w="u"in xt?xt.u%7:"W"in xt?1:0),mr="Z"in xt?Cw(dp(xt.y,0,1)).getUTCDay():Mw(dp(xt.y,0,1)).getDay(),xt.m=0,xt.d="W"in xt?(xt.w+6)%7+xt.W*7-(mr+5)%7:xt.w+xt.U*7-(mr+6)%7);return"Z"in xt?(xt.H+=xt.Z/100|0,xt.M+=xt.Z%100,Cw(xt)):Mw(xt)}}function Qe(wt,rn,Cn,xt){for(var er=0,Hn=rn.length,mr=Cn.length,or,tr;er<Hn;){if(xt>=mr)return-1;if(or=rn.charCodeAt(er++),or===37){if(or=rn.charAt(er++),tr=me[or in HI?rn.charAt(er++):or],!tr||(xt=tr(wt,Cn,xt))<0)return-1}else if(or!=Cn.charCodeAt(xt++))return-1}return xt}function Ke(wt,rn,Cn){var xt=w.exec(rn.slice(Cn));return xt?(wt.p=C.get(xt[0].toLowerCase()),Cn+xt[0].length):-1}function nt(wt,rn,Cn){var xt=U.exec(rn.slice(Cn));return xt?(wt.w=H.get(xt[0].toLowerCase()),Cn+xt[0].length):-1}function Ne(wt,rn,Cn){var xt=I.exec(rn.slice(Cn));return xt?(wt.w=k.get(xt[0].toLowerCase()),Cn+xt[0].length):-1}function rt(wt,rn,Cn){var xt=X.exec(rn.slice(Cn));return xt?(wt.m=te.get(xt[0].toLowerCase()),Cn+xt[0].length):-1}function Ze(wt,rn,Cn){var xt=q.exec(rn.slice(Cn));return xt?(wt.m=se.get(xt[0].toLowerCase()),Cn+xt[0].length):-1}function mt(wt,rn,Cn){return Qe(wt,e,rn,Cn)}function Kt(wt,rn,Cn){return Qe(wt,n,rn,Cn)}function Tt(wt,rn,Cn){return Qe(wt,r,rn,Cn)}function dn(wt){return A[wt.getDay()]}function _t(wt){return s[wt.getDay()]}function Et(wt){return g[wt.getMonth()]}function Jt(wt){return o[wt.getMonth()]}function kn(wt){return i[+(wt.getHours()>=12)]}function Tn(wt){return 1+~~(wt.getMonth()/3)}function Tr(wt){return A[wt.getUTCDay()]}function Jn(wt){return s[wt.getUTCDay()]}function ir(wt){return g[wt.getUTCMonth()]}function ur(wt){return o[wt.getUTCMonth()]}function Un(wt){return i[+(wt.getUTCHours()>=12)]}function wr(wt){return 1+~~(wt.getUTCMonth()/3)}return{format:function(wt){var rn=Se(wt+="",ie);return rn.toString=function(){return wt},rn},parse:function(wt){var rn=He(wt+="",!1);return rn.toString=function(){return wt},rn},utcFormat:function(wt){var rn=Se(wt+="",fe);return rn.toString=function(){return wt},rn},utcParse:function(wt){var rn=He(wt+="",!0);return rn.toString=function(){return wt},rn}}}var HI={"-":"",_:" ",0:"0"},vs=/^\s*\d+/,eae=/^%/,tae=/[\\^$*+?|[\]().{}]/g;function Er(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function nae(t){return t.replace(tae,"\\$&")}function pp(t){return new RegExp("^(?:"+t.map(nae).join("|")+")","i")}function gp(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function rae(t,e,n){var r=vs.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function iae(t,e,n){var r=vs.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function sae(t,e,n){var r=vs.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function oae(t,e,n){var r=vs.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function aae(t,e,n){var r=vs.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function WI(t,e,n){var r=vs.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function QI(t,e,n){var r=vs.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function lae(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Aae(t,e,n){var r=vs.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function uae(t,e,n){var r=vs.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function qI(t,e,n){var r=vs.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function cae(t,e,n){var r=vs.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function ZI(t,e,n){var r=vs.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function hae(t,e,n){var r=vs.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function fae(t,e,n){var r=vs.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function dae(t,e,n){var r=vs.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function pae(t,e,n){var r=vs.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function gae(t,e,n){var r=eae.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function mae(t,e,n){var r=vs.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function yae(t,e,n){var r=vs.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function YI(t,e){return Er(t.getDate(),e,2)}function _ae(t,e){return Er(t.getHours(),e,2)}function vae(t,e){return Er(t.getHours()%12||12,e,2)}function xae(t,e){return Er(1+ym.count(tc(t),t),e,3)}function Yz(t,e){return Er(t.getMilliseconds(),e,3)}function wae(t,e){return Yz(t,e)+"000"}function bae(t,e){return Er(t.getMonth()+1,e,2)}function Eae(t,e){return Er(t.getMinutes(),e,2)}function Tae(t,e){return Er(t.getSeconds(),e,2)}function Sae(t){var e=t.getDay();return e===0?7:e}function Mae(t,e){return Er(K2.count(tc(t)-1,t),e,2)}function Xz(t){var e=t.getDay();return e>=4||e===0?cd(t):cd.ceil(t)}function Cae(t,e){return t=Xz(t),Er(cd.count(tc(t),t)+(tc(t).getDay()===4),e,2)}function Pae(t){return t.getDay()}function Iae(t,e){return Er(N_.count(tc(t)-1,t),e,2)}function kae(t,e){return Er(t.getFullYear()%100,e,2)}function Lae(t,e){return t=Xz(t),Er(t.getFullYear()%100,e,2)}function Dae(t,e){return Er(t.getFullYear()%1e4,e,4)}function Rae(t,e){var n=t.getDay();return t=n>=4||n===0?cd(t):cd.ceil(t),Er(t.getFullYear()%1e4,e,4)}function Bae(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Er(e/60|0,"0",2)+Er(e%60,"0",2)}function XI(t,e){return Er(t.getUTCDate(),e,2)}function zae(t,e){return Er(t.getUTCHours(),e,2)}function Oae(t,e){return Er(t.getUTCHours()%12||12,e,2)}function Fae(t,e){return Er(1+_S.count(uf(t),t),e,3)}function Kz(t,e){return Er(t.getUTCMilliseconds(),e,3)}function Nae(t,e){return Kz(t,e)+"000"}function Uae(t,e){return Er(t.getUTCMonth()+1,e,2)}function Vae(t,e){return Er(t.getUTCMinutes(),e,2)}function Gae(t,e){return Er(t.getUTCSeconds(),e,2)}function $ae(t){var e=t.getUTCDay();return e===0?7:e}function jae(t,e){return Er(Zz.count(uf(t)-1,t),e,2)}function Jz(t){var e=t.getUTCDay();return e>=4||e===0?hd(t):hd.ceil(t)}function Hae(t,e){return t=Jz(t),Er(hd.count(uf(t),t)+(uf(t).getUTCDay()===4),e,2)}function Wae(t){return t.getUTCDay()}function Qae(t,e){return Er(U_.count(uf(t)-1,t),e,2)}function qae(t,e){return Er(t.getUTCFullYear()%100,e,2)}function Zae(t,e){return t=Jz(t),Er(t.getUTCFullYear()%100,e,2)}function Yae(t,e){return Er(t.getUTCFullYear()%1e4,e,4)}function Xae(t,e){var n=t.getUTCDay();return t=n>=4||n===0?hd(t):hd.ceil(t),Er(t.getUTCFullYear()%1e4,e,4)}function Kae(){return"+0000"}function KI(){return"%"}function JI(t){return+t}function ek(t){return Math.floor(+t/1e3)}var t0,eO;Jae({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Jae(t){return t0=Joe(t),eO=t0.format,t0.parse,t0.utcFormat,t0.utcParse,t0}function ele(t){return new Date(t)}function tle(t){return t instanceof Date?+t:+new Date(+t)}function tO(t,e,n,r,i,s,A,o,g,w){var C=Qz(),I=C.invert,k=C.domain,U=w(".%L"),H=w(":%S"),q=w("%I:%M"),se=w("%I %p"),X=w("%a %d"),te=w("%b %d"),ie=w("%B"),fe=w("%Y");function me(Se){return(g(Se)<Se?U:o(Se)<Se?H:A(Se)<Se?q:s(Se)<Se?se:r(Se)<Se?i(Se)<Se?X:te:n(Se)<Se?ie:fe)(Se)}return C.invert=function(Se){return new Date(I(Se))},C.domain=function(Se){return arguments.length?k(Array.from(Se,tle)):k().map(ele)},C.ticks=function(Se){var He=k();return t(He[0],He[He.length-1],Se??10)},C.tickFormat=function(Se,He){return He==null?me:w(He)},C.nice=function(Se){var He=k();return(!Se||typeof Se.range!="function")&&(Se=e(He[0],He[He.length-1],Se??10)),Se?k(Ooe(He,Se)):C},C.copy=function(){return Wz(C,tO(t,e,n,r,i,s,A,o,g,w))},C}function nle(){return pS.apply(tO(Xoe,Koe,tc,vS,K2,ym,yS,mS,v0,eO).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Cd(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const Pd=t=>kz(t[t.length-1]);var rle=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Cd);const ile=Pd(rle);var sle=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Cd);const ole=Pd(sle);var ale=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Cd);const lle=Pd(ale);var Ale=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Cd);const ule=Pd(Ale);var cle=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Cd);const tk=Pd(cle);var hle=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Cd);const nk=Pd(hle);function Xo(t){return function(){return t}}const rk=Math.abs,eo=Math.atan2,Ph=Math.cos,fle=Math.max,Pw=Math.min,TA=Math.sin,x0=Math.sqrt,ro=1e-12,Dg=Math.PI,V_=Dg/2,dle=2*Dg;function ple(t){return t>1?0:t<-1?Dg:Math.acos(t)}function ik(t){return t>=1?V_:t<=-1?-V_:Math.asin(t)}function nO(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new coe(e)}function gle(t){return t.innerRadius}function mle(t){return t.outerRadius}function yle(t){return t.startAngle}function _le(t){return t.endAngle}function vle(t){return t&&t.padAngle}function xle(t,e,n,r,i,s,A,o){var g=n-t,w=r-e,C=A-i,I=o-s,k=I*g-C*w;if(!(k*k<ro))return k=(C*(e-s)-I*(t-i))/k,[t+k*g,e+k*w]}function L1(t,e,n,r,i,s,A){var o=t-n,g=e-r,w=(A?s:-s)/x0(o*o+g*g),C=w*g,I=-w*o,k=t+C,U=e+I,H=n+C,q=r+I,se=(k+H)/2,X=(U+q)/2,te=H-k,ie=q-U,fe=te*te+ie*ie,me=i-s,Se=k*q-H*U,He=(ie<0?-1:1)*x0(fle(0,me*me*fe-Se*Se)),Qe=(Se*ie-te*He)/fe,Ke=(-Se*te-ie*He)/fe,nt=(Se*ie+te*He)/fe,Ne=(-Se*te+ie*He)/fe,rt=Qe-se,Ze=Ke-X,mt=nt-se,Kt=Ne-X;return rt*rt+Ze*Ze>mt*mt+Kt*Kt&&(Qe=nt,Ke=Ne),{cx:Qe,cy:Ke,x01:-C,y01:-I,x11:Qe*(i/me-1),y11:Ke*(i/me-1)}}function sk(){var t=gle,e=mle,n=Xo(0),r=null,i=yle,s=_le,A=vle,o=null,g=nO(w);function w(){var C,I,k=+t.apply(this,arguments),U=+e.apply(this,arguments),H=i.apply(this,arguments)-V_,q=s.apply(this,arguments)-V_,se=rk(q-H),X=q>H;if(o||(o=C=g()),U<k&&(I=U,U=k,k=I),!(U>ro))o.moveTo(0,0);else if(se>dle-ro)o.moveTo(U*Ph(H),U*TA(H)),o.arc(0,0,U,H,q,!X),k>ro&&(o.moveTo(k*Ph(q),k*TA(q)),o.arc(0,0,k,q,H,X));else{var te=H,ie=q,fe=H,me=q,Se=se,He=se,Qe=A.apply(this,arguments)/2,Ke=Qe>ro&&(r?+r.apply(this,arguments):x0(k*k+U*U)),nt=Pw(rk(U-k)/2,+n.apply(this,arguments)),Ne=nt,rt=nt,Ze,mt;if(Ke>ro){var Kt=ik(Ke/k*TA(Qe)),Tt=ik(Ke/U*TA(Qe));(Se-=Kt*2)>ro?(Kt*=X?1:-1,fe+=Kt,me-=Kt):(Se=0,fe=me=(H+q)/2),(He-=Tt*2)>ro?(Tt*=X?1:-1,te+=Tt,ie-=Tt):(He=0,te=ie=(H+q)/2)}var dn=U*Ph(te),_t=U*TA(te),Et=k*Ph(me),Jt=k*TA(me);if(nt>ro){var kn=U*Ph(ie),Tn=U*TA(ie),Tr=k*Ph(fe),Jn=k*TA(fe),ir;if(se<Dg)if(ir=xle(dn,_t,Tr,Jn,kn,Tn,Et,Jt)){var ur=dn-ir[0],Un=_t-ir[1],wr=kn-ir[0],wt=Tn-ir[1],rn=1/TA(ple((ur*wr+Un*wt)/(x0(ur*ur+Un*Un)*x0(wr*wr+wt*wt)))/2),Cn=x0(ir[0]*ir[0]+ir[1]*ir[1]);Ne=Pw(nt,(k-Cn)/(rn-1)),rt=Pw(nt,(U-Cn)/(rn+1))}else Ne=rt=0}He>ro?rt>ro?(Ze=L1(Tr,Jn,dn,_t,U,rt,X),mt=L1(kn,Tn,Et,Jt,U,rt,X),o.moveTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),rt<nt?o.arc(Ze.cx,Ze.cy,rt,eo(Ze.y01,Ze.x01),eo(mt.y01,mt.x01),!X):(o.arc(Ze.cx,Ze.cy,rt,eo(Ze.y01,Ze.x01),eo(Ze.y11,Ze.x11),!X),o.arc(0,0,U,eo(Ze.cy+Ze.y11,Ze.cx+Ze.x11),eo(mt.cy+mt.y11,mt.cx+mt.x11),!X),o.arc(mt.cx,mt.cy,rt,eo(mt.y11,mt.x11),eo(mt.y01,mt.x01),!X))):(o.moveTo(dn,_t),o.arc(0,0,U,te,ie,!X)):o.moveTo(dn,_t),!(k>ro)||!(Se>ro)?o.lineTo(Et,Jt):Ne>ro?(Ze=L1(Et,Jt,kn,Tn,k,-Ne,X),mt=L1(dn,_t,Tr,Jn,k,-Ne,X),o.lineTo(Ze.cx+Ze.x01,Ze.cy+Ze.y01),Ne<nt?o.arc(Ze.cx,Ze.cy,Ne,eo(Ze.y01,Ze.x01),eo(mt.y01,mt.x01),!X):(o.arc(Ze.cx,Ze.cy,Ne,eo(Ze.y01,Ze.x01),eo(Ze.y11,Ze.x11),!X),o.arc(0,0,k,eo(Ze.cy+Ze.y11,Ze.cx+Ze.x11),eo(mt.cy+mt.y11,mt.cx+mt.x11),X),o.arc(mt.cx,mt.cy,Ne,eo(mt.y11,mt.x11),eo(mt.y01,mt.x01),!X))):o.arc(0,0,k,me,fe,X)}if(o.closePath(),C)return o=null,C+""||null}return w.centroid=function(){var C=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,I=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-Dg/2;return[Ph(I)*C,TA(I)*C]},w.innerRadius=function(C){return arguments.length?(t=typeof C=="function"?C:Xo(+C),w):t},w.outerRadius=function(C){return arguments.length?(e=typeof C=="function"?C:Xo(+C),w):e},w.cornerRadius=function(C){return arguments.length?(n=typeof C=="function"?C:Xo(+C),w):n},w.padRadius=function(C){return arguments.length?(r=C==null?null:typeof C=="function"?C:Xo(+C),w):r},w.startAngle=function(C){return arguments.length?(i=typeof C=="function"?C:Xo(+C),w):i},w.endAngle=function(C){return arguments.length?(s=typeof C=="function"?C:Xo(+C),w):s},w.padAngle=function(C){return arguments.length?(A=typeof C=="function"?C:Xo(+C),w):A},w.context=function(C){return arguments.length?(o=C??null,w):o},w}function wle(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function rO(t){this._context=t}rO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function iO(t){return new rO(t)}function ble(t){return t[0]}function Ele(t){return t[1]}function sO(t,e){var n=Xo(!0),r=null,i=iO,s=null,A=nO(o);t=typeof t=="function"?t:t===void 0?ble:Xo(t),e=typeof e=="function"?e:e===void 0?Ele:Xo(e);function o(g){var w,C=(g=wle(g)).length,I,k=!1,U;for(r==null&&(s=i(U=A())),w=0;w<=C;++w)!(w<C&&n(I=g[w],w,g))===k&&((k=!k)?s.lineStart():s.lineEnd()),k&&s.point(+t(I,w,g),+e(I,w,g));if(U)return s=null,U+""||null}return o.x=function(g){return arguments.length?(t=typeof g=="function"?g:Xo(+g),o):t},o.y=function(g){return arguments.length?(e=typeof g=="function"?g:Xo(+g),o):e},o.defined=function(g){return arguments.length?(n=typeof g=="function"?g:Xo(!!g),o):n},o.curve=function(g){return arguments.length?(i=g,r!=null&&(s=i(r)),o):i},o.context=function(g){return arguments.length?(g==null?r=s=null:s=i(r=g),o):r},o}var Tle=aO(iO);function oO(t){this._curve=t}oO.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function aO(t){function e(n){return new oO(t(n))}return e._curve=t,e}function Sle(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(aO(n)):e()._curve},t}function ok(){return Sle(sO().curve(Tle))}function ak(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function xS(t,e){this._context=t,this._k=(1-e)/6}xS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ak(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:ak(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(r){return new xS(r,e)}return n.tension=function(r){return t(+r)},n})(0);function Mle(t,e,n){var r=t._x1,i=t._y1,s=t._x2,A=t._y2;if(t._l01_a>ro){var o=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,g=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*o-t._x0*t._l12_2a+t._x2*t._l01_2a)/g,i=(i*o-t._y0*t._l12_2a+t._y2*t._l01_2a)/g}if(t._l23_a>ro){var w=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,C=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*w+t._x1*t._l23_2a-e*t._l12_2a)/C,A=(A*w+t._y1*t._l23_2a-n*t._l12_2a)/C}t._context.bezierCurveTo(r,i,s,A,t._x2,t._y2)}function lO(t,e){this._context=t,this._alpha=e}lO.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Mle(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const lk=function t(e){function n(r){return e?new lO(r,e):new xS(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function zp(t,e,n){this.k=t,this.x=e,this.y=n}zp.prototype={constructor:zp,scale:function(t){return t===1?this:new zp(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new zp(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};zp.prototype;const Cle=new Uint16Array([0,2,1,0,3,2]),Ple=new Float32Array([0,1,0,0,1,0,1,1]);function Ile(t,e){if(!e)return kle(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,s=Math.ceil(r/e)+1,A=(i-1)*(s-1)*6,o=new Uint32Array(A),g=new Float32Array(i*s*2),w=new Float64Array(i*s*3);let C=0,I=0;for(let k=0;k<i;k++){const U=k/(i-1);for(let H=0;H<s;H++){const q=H/(s-1),se=Lle(t,U,q);w[C*3+0]=se[0],w[C*3+1]=se[1],w[C*3+2]=se[2]||0,g[C*2+0]=U,g[C*2+1]=1-q,k>0&&H>0&&(o[I++]=C-s,o[I++]=C-s-1,o[I++]=C-1,o[I++]=C-s,o[I++]=C-1,o[I++]=C),C++}}return{vertexCount:A,positions:w,indices:o,texCoords:g}}function kle(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:Cle,texCoords:Ple}}function Lle(t,e,n){return ul(ul(t[0],t[1],n),ul(t[3],t[2],n),e)}const Dle=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,Rle=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,Ble=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(Rle,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),zle={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:ar.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class cf extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:Dle,fs:Ble,modules:[Tf,Sf]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){const i=this.getAttributeManager();if(r.extensionsChanged){var s;const{gl:A}=this.context;(s=this.state.model)===null||s===void 0||s.delete(),this.state.model=this._getModel(A),i.invalidateAll()}if(e.bounds!==n.bounds){const A=this.state.mesh,o=this._createMesh();this.state.model.setVertexCount(o.vertexCount);for(const g in o)A&&A[g]!==o[g]&&i.invalidate(g);this.setState({mesh:o,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:s}=n;r.index=0;const A=Ole(r.color),o=[Math.floor(A[0]*i),Math.floor(A[1]*s)];return r.bitmap={size:{width:i,height:s},uv:A,pixel:o},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return Ak(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),Ile(n,this.context.viewport.resolution)}_getModel(e){return e?new Yu(e,{...this.getShaders(),id:this.props.id,geometry:new Vu({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:s,bounds:A,disablePicking:o}=this.state,{image:g,desaturate:w,transparentColor:C,tintColor:I}=this.props;r.pickingActive&&o||g&&i&&i.setUniforms(n).setUniforms({bitmapTexture:g,desaturate:w,transparentColor:C.map(k=>k/255),tintColor:I.slice(0,3).map(k=>k/255),coordinateConversion:s,bounds:A}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=ar;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:s}=this.props;if(!Ak(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const A=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&A===n)return{coordinateConversion:-1,bounds:s};if(i===n&&A===e){const o=nA([s[0],s[1]]),g=nA([s[2],s[3]]);return{coordinateConversion:1,bounds:[o[0],o[1],g[0],g[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}oe(cf,"layerName","BitmapLayer");oe(cf,"defaultProps",zle);function Ole(t){const[e,n,r]=t,i=(r&240)/256,s=(r&15)/16;return[(e+s)/256,(n+i)/256]}function Ak(t){return Number.isFinite(t[0])}const Fle=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,Nle=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Ule=1024,Vle=4,uk=()=>{},ck={10241:9987,10240:9729,10242:33071,10243:33071};function Gle(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function $le(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),A=Math.floor(e.height*i);return i===1?{data:e,width:s,height:A}:(t.canvas.height=A,t.canvas.width=s,t.clearRect(0,0,s,A),t.drawImage(e,0,0,e.width,e.height,0,0,s,A),{data:t.canvas,width:s,height:A})}function Rg(t){return t&&(t.id||t.url)}function jle(t,e,n,r){const i=t.width,s=t.height,A=new oa(t.gl,{width:e,height:n,parameters:r});return WW(t,A,{targetY:0,width:i,height:s}),t.delete(),A}function hk(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],A=Rg(i);t[A]={...i,x:s,y:n}}}function Hle({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:A}){let o=[];for(let g=0;g<t.length;g++){const w=t[g],C=Rg(w);if(!n[C]){const{height:I,width:k}=w;r+k+e>A&&(hk(n,o,i),r=0,i=s+i+e,s=0,o=[]),o.push({icon:w,xOffset:r}),r=r+k+e,s=Math.max(s,I)}}return o.length>0&&hk(n,o,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:A,canvasHeight:Gle(s+i+e)}}function Wle(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Td(t);for(const A of i){s.index++;const o=e(A,s),g=Rg(o);if(!o)throw new Error("Icon is missing.");if(!o.url)throw new Error("Icon url is missing.");!r[g]&&(!n[g]||o.url!==n[g].url)&&(r[g]={...o,source:A,sourceIndex:s.index})}return r}class Qle{constructor(e,{onUpdate:n=uk,onError:r=uk}){oe(this,"gl",void 0),oe(this,"onUpdate",void 0),oe(this,"onError",void 0),oe(this,"_loadOptions",null),oe(this,"_texture",null),oe(this,"_externalTexture",null),oe(this,"_mapping",{}),oe(this,"_textureParameters",null),oe(this,"_pendingCount",0),oe(this,"_autoPacking",!1),oe(this,"_xOffset",0),oe(this,"_yOffset",0),oe(this,"_rowHeight",0),oe(this,"_buffer",Vle),oe(this,"_canvasWidth",Ule),oe(this,"_canvasHeight",0),oe(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Rg(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var A;(A=this._texture)===null||A===void 0||A.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(Wle(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:A,rowHeight:o,canvasHeight:g}=Hle({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=s,this._yOffset=A,this._canvasHeight=g,this._texture||(this._texture=new oa(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||ck})),this._texture.height!==this._canvasHeight&&(this._texture=jle(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||ck)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,c_(r.url,this._loadOptions).then(i=>{const s=Rg(r),A=this._mapping[s],{x:o,y:g,width:w,height:C}=A,{data:I,width:k,height:U}=$le(n,i,w,C);this._texture.setSubImageData({data:I,x:o+(w-k)/2,y:g+(C-U)/2,width:k,height:U}),A.width=k,A.height=U,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const AO=[0,0,0,255],qle={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:AO},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class J2 extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:Fle,fs:Nle,modules:[Tf,Sf]})}initializeState(){this.state={iconManager:new Qle(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:AO},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:A,iconMapping:o,data:g,getIcon:w,textureParameters:C}=n,{iconManager:I}=this.state,k=A||this.internalState.isAsyncPropLoading("iconAtlas");if(I.setProps({loadOptions:n.loadOptions,autoPacking:!k,iconAtlas:A,iconMapping:k?o:null,textureParameters:C}),k?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&I.packIcons(g,w),i.extensionsChanged){var U;const{gl:H}=this.context;(U=this.state.model)===null||U===void 0||U.delete(),this.state.model=this._getModel(H),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:A,alphaCutoff:o}=this.props,{iconManager:g}=this.state,w=g.getTexture();w&&this.state.model.setUniforms(e).setUniforms({iconsTexture:w,iconsTextureDim:[w.width,w.height],sizeUnits:Jh[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:A,alphaCutoff:o}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Yu(e,{...this.getShaders(),id:this.props.id,geometry:new Vu({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):rr.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}oe(J2,"defaultProps",qle);oe(J2,"layerName","IconLayer");const Zle=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,Yle=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,fk=[0,0,0,255],Xle={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:fk},getLineColor:{type:"accessor",value:fk},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class wS extends iA{getShaders(){return super.getShaders({vs:Zle,fs:Yle,modules:[Tf,Sf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:A,filled:o,billboard:g,antialiasing:w,lineWidthUnits:C,lineWidthScale:I,lineWidthMinPixels:k,lineWidthMaxPixels:U}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:A?1:0,filled:o,billboard:g,antialiasing:w,radiusUnits:Jh[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:Jh[C],lineWidthScale:I,lineWidthMinPixels:k,lineWidthMaxPixels:U}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Yu(e,{...this.getShaders(),id:this.props.id,geometry:new Vu({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}oe(wS,"defaultProps",Xle);oe(wS,"layerName","ScatterplotLayer");const uO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function cO(t,e,n={}){return Kle(t,n)!==e?(eAe(t,n),!0):!1}function Kle(t,e={}){return Math.sign(Jle(t,e))}function Jle(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let A=n,o=r-i;A<r;A+=i)s+=(t[A]-t[o])*(t[A+1]+t[o+1]),o=A;return s/2}function eAe(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,A=Math.floor(s/2);for(let o=0;o<A;++o){const g=n+o*i,w=n+(s-1-o)*i;for(let C=0;C<i;++C){const I=t[g+C];t[g+C]=t[w+C],t[w+C]=I}}}function ql(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function $3(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Bg(t,e,n,r,i=[]){const s=r+e*n;for(let A=0;A<n;A++)i[A]=t[s+A];return i}function j3(t,e,n,r,i=[]){let s,A;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),A=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),A=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),A=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),A=0;else return null;for(let o=0;o<t.length;o++)i[o]=(A&1)===o?r[A]:s*(e[o]-t[o])+t[o];return i}function Ty(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function hO(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:A=0,endIndex:o=t.length}=e||{},g=(o-A)/n;let w=[];const C=[w],I=Bg(t,0,n,A);let k,U;const H=dO(I,i,s,[]),q=[];ql(w,I);for(let se=1;se<g;se++){for(k=Bg(t,se,n,A,k),U=Ty(k,H);U;){j3(I,k,U,H,q);const X=Ty(q,H);X&&(j3(I,q,X,H,q),U=X),ql(w,q),$3(I,q),nAe(H,i,U),r&&w.length>n&&(w=[],C.push(w),ql(w,I)),U=Ty(k,H)}ql(w,k),$3(I,k)}return r?C:C[0]}const dk=0,tAe=1;function D1(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function fO(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:A=!1}=n||{},o=[],g=[{pos:t,types:A?new Array(t.length/r).fill(tAe):null,holes:e||[]}],w=[[],[]];let C=[];for(;g.length;){const{pos:I,types:k,holes:U}=g.shift();rAe(I,r,U[0]||I.length,w),C=dO(w[0],i,s,C);const H=Ty(w[1],C);if(H){let q=pk(I,k,r,0,U[0]||I.length,C,H);const se={pos:q[0].pos,types:q[0].types,holes:[]},X={pos:q[1].pos,types:q[1].types,holes:[]};g.push(se,X);for(let te=0;te<U.length;te++)q=pk(I,k,r,U[te],U[te+1]||I.length,C,H),q[0]&&(se.holes.push(se.pos.length),se.pos=D1(se.pos,q[0].pos),A&&(se.types=D1(se.types,q[0].types))),q[1]&&(X.holes.push(X.pos.length),X.pos=D1(X.pos,q[1].pos),A&&(X.types=D1(X.types,q[1].types)))}else{const q={positions:I};A&&(q.edgeTypes=k),U.length&&(q.holeIndices=U),o.push(q)}}return o}function pk(t,e,n,r,i,s,A){const o=(i-r)/n,g=[],w=[],C=[],I=[],k=[];let U,H,q;const se=Bg(t,o-1,n,r);let X=Math.sign(A&8?se[1]-s[3]:se[0]-s[2]),te=e&&e[o-1],ie=0,fe=0;for(let me=0;me<o;me++)U=Bg(t,me,n,r,U),H=Math.sign(A&8?U[1]-s[3]:U[0]-s[2]),q=e&&e[r/n+me],H&&X&&X!==H&&(j3(se,U,A,s,k),ql(g,k)&&C.push(te),ql(w,k)&&I.push(te)),H<=0?(ql(g,U)&&C.push(q),ie-=H):C.length&&(C[C.length-1]=dk),H>=0?(ql(w,U)&&I.push(q),fe+=H):I.length&&(I[I.length-1]=dk),$3(se,U),X=H,te=q;return[ie?{pos:g,types:e&&C}:null,fe?{pos:w,types:e&&I}:null]}function dO(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function nAe(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function rAe(t,e,n,r){let i=1/0,s=-1/0,A=1/0,o=-1/0;for(let g=0;g<n;g+=e){const w=t[g],C=t[g+1];i=w<i?w:i,s=w>s?w:s,A=C<A?C:A,o=C>o?C:o}return r[0][0]=i,r[0][1]=A,r[1][0]=s,r[1][1]=o,r}const iAe=85.051129;function sAe(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},A=t.slice(r,i);pO(A,n,0,i-r);const o=hO(A,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const g of o)gO(g,n);return o}function oAe(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const A=[],o=[];let g=0,w=0;for(let I=0;I<=e.length;I++){const k=e[I]||t.length,U=w,H=aAe(t,r,g,k);for(let q=H;q<k;q++)A[w++]=t[q];for(let q=g;q<H;q++)A[w++]=t[q];pO(A,r,U,w),lAe(A,r,U,w,n?.maxLatitude),g=k,o[I]=w}o.pop();const C=fO(A,o,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const I of C)gO(I.positions,r);return C}function aAe(t,e,n,r){let i=-1,s=-1;for(let A=n+1;A<r;A+=e){const o=Math.abs(t[A]);o>i&&(i=o,s=A-1)}return s}function lAe(t,e,n,r,i=iAe){const s=t[n],A=t[r-e];if(Math.abs(s-A)>180){const o=Bg(t,0,e,n);o[0]+=Math.round((A-s)/360)*360,ql(t,o),o[1]=Math.sign(o[1])*i,ql(t,o),o[0]=s,ql(t,o)}}function pO(t,e,n,r){let i=t[0],s;for(let A=n;A<r;A+=e){s=t[A];const o=s-i;(o>180||o<-180)&&(s-=Math.round(o/360)*360),t[A]=i=s}}function gO(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function AAe(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let A=0;A<t.length;A++)for(let o=0;o<e;o++)i[A*e+o]=t[A][o]||0}else i=t;return n?hO(i,{size:e,gridResolution:n}):r?sAe(i,{size:e}):i}const uAe=1,cAe=2,Iw=4;class hAe extends YB{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?AAe(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(gk(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&gk(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:A}=n;r.fill(0,s,s+A),i?(r[s]=Iw,r[s+A-2]=Iw):(r[s]+=uAe,r[s+A-2]+=cAe),r[s+A-1]=Iw}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,A=new Array(3);for(let o=i,g=0;g<s;o++,g++)this.getPointOnPath(e,g,A),r[o*3]=A[0],r[o*3+1]=A[1],r[o*3+2]=A[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function gk(t){return Array.isArray(t[0])}const fAe=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,dAe=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,mO=[0,0,0,255],pAe={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:mO},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},kw={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class ev extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:fAe,fs:dAe,modules:[Tf,Sf]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:kw,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:kw,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:kw,defaultValue:mO},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new hAe({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:o}=this.state,g=n.data.attributes||{};o.updateGeometry({data:n.data,geometryBuffer:g.getPath,buffers:g,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var A;const{gl:o}=this.context;(A=this.state.model)===null||A===void 0||A.delete(),this.state.model=this._getModel(o),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:A,widthScale:o,widthMinPixels:g,widthMaxPixels:w}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Jh[A],widthScale:o,miterLimit:s,widthMinPixels:g,widthMaxPixels:w}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Yu(e,{...this.getShaders(),id:this.props.id,geometry:new Vu({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}oe(ev,"defaultProps",pAe);oe(ev,"layerName","PathLayer");var bS={exports:{}};bS.exports=tv;bS.exports.default=tv;function tv(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=yO(t,0,i,n,!0),A=[];if(!s||s.next===s.prev)return A;var o,g,w,C,I,k,U;if(r&&(s=vAe(t,e,s,n)),t.length>80*n){o=w=t[0],g=C=t[1];for(var H=n;H<i;H+=n)I=t[H],k=t[H+1],I<o&&(o=I),k<g&&(g=k),I>w&&(w=I),k>C&&(C=k);U=Math.max(w-o,C-g),U=U!==0?32767/U:0}return zg(s,A,n,o,g,U,0),A}function yO(t,e,n,r,i){var s,A;if(i===Q3(t,e,n,r)>0)for(s=e;s<n;s+=r)A=mk(s,t[s],t[s+1],A);else for(s=n-r;s>=e;s-=r)A=mk(s,t[s],t[s+1],A);return A&&nv(A,A.next)&&(Fg(A),A=A.next),A}function hf(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(nv(n,n.next)||pi(n.prev,n,n.next)===0)){if(Fg(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function zg(t,e,n,r,i,s,A){if(t){!A&&s&&TAe(t,r,i,s);for(var o=t,g,w;t.prev!==t.next;){if(g=t.prev,w=t.next,s?mAe(t,r,i,s):gAe(t)){e.push(g.i/n|0),e.push(t.i/n|0),e.push(w.i/n|0),Fg(t),t=w.next,o=w.next;continue}if(t=w,t===o){A?A===1?(t=yAe(hf(t),e,n),zg(t,e,n,r,i,s,2)):A===2&&_Ae(t,e,n,r,i,s):zg(hf(t),e,n,r,i,s,1);break}}}}function gAe(t){var e=t.prev,n=t,r=t.next;if(pi(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,A=r.x,o=e.y,g=n.y,w=r.y,C=i<s?i<A?i:A:s<A?s:A,I=o<g?o<w?o:w:g<w?g:w,k=i>s?i>A?i:A:s>A?s:A,U=o>g?o>w?o:w:g>w?g:w,H=r.next;H!==e;){if(H.x>=C&&H.x<=k&&H.y>=I&&H.y<=U&&w0(i,o,s,g,A,w,H.x,H.y)&&pi(H.prev,H,H.next)>=0)return!1;H=H.next}return!0}function mAe(t,e,n,r){var i=t.prev,s=t,A=t.next;if(pi(i,s,A)>=0)return!1;for(var o=i.x,g=s.x,w=A.x,C=i.y,I=s.y,k=A.y,U=o<g?o<w?o:w:g<w?g:w,H=C<I?C<k?C:k:I<k?I:k,q=o>g?o>w?o:w:g>w?g:w,se=C>I?C>k?C:k:I>k?I:k,X=H3(U,H,e,n,r),te=H3(q,se,e,n,r),ie=t.prevZ,fe=t.nextZ;ie&&ie.z>=X&&fe&&fe.z<=te;){if(ie.x>=U&&ie.x<=q&&ie.y>=H&&ie.y<=se&&ie!==i&&ie!==A&&w0(o,C,g,I,w,k,ie.x,ie.y)&&pi(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,fe.x>=U&&fe.x<=q&&fe.y>=H&&fe.y<=se&&fe!==i&&fe!==A&&w0(o,C,g,I,w,k,fe.x,fe.y)&&pi(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;ie&&ie.z>=X;){if(ie.x>=U&&ie.x<=q&&ie.y>=H&&ie.y<=se&&ie!==i&&ie!==A&&w0(o,C,g,I,w,k,ie.x,ie.y)&&pi(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;fe&&fe.z<=te;){if(fe.x>=U&&fe.x<=q&&fe.y>=H&&fe.y<=se&&fe!==i&&fe!==A&&w0(o,C,g,I,w,k,fe.x,fe.y)&&pi(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function yAe(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!nv(i,s)&&_O(i,r,r.next,s)&&Og(i,s)&&Og(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),Fg(r),Fg(r.next),r=t=s),r=r.next}while(r!==t);return hf(r)}function _Ae(t,e,n,r,i,s){var A=t;do{for(var o=A.next.next;o!==A.prev;){if(A.i!==o.i&&CAe(A,o)){var g=vO(A,o);A=hf(A,A.next),g=hf(g,g.next),zg(A,e,n,r,i,s,0),zg(g,e,n,r,i,s,0);return}o=o.next}A=A.next}while(A!==t)}function vAe(t,e,n,r){var i=[],s,A,o,g,w;for(s=0,A=e.length;s<A;s++)o=e[s]*r,g=s<A-1?e[s+1]*r:t.length,w=yO(t,o,g,r,!1),w===w.next&&(w.steiner=!0),i.push(MAe(w));for(i.sort(xAe),s=0;s<i.length;s++)n=wAe(i[s],n);return n}function xAe(t,e){return t.x-e.x}function wAe(t,e){var n=bAe(t,e);if(!n)return e;var r=vO(n,t);return hf(r,r.next),hf(n,n.next)}function bAe(t,e){var n=e,r=t.x,i=t.y,s=-1/0,A;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var o=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>s&&(s=o,A=n.x<n.next.x?n:n.next,o===r))return A}n=n.next}while(n!==e);if(!A)return null;var g=A,w=A.x,C=A.y,I=1/0,k;n=A;do r>=n.x&&n.x>=w&&r!==n.x&&w0(i<C?r:s,i,w,C,i<C?s:r,i,n.x,n.y)&&(k=Math.abs(i-n.y)/(r-n.x),Og(n,t)&&(k<I||k===I&&(n.x>A.x||n.x===A.x&&EAe(A,n)))&&(A=n,I=k)),n=n.next;while(n!==g);return A}function EAe(t,e){return pi(t.prev,t,e.prev)<0&&pi(e.next,t,t.next)<0}function TAe(t,e,n,r){var i=t;do i.z===0&&(i.z=H3(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,SAe(i)}function SAe(t){var e,n,r,i,s,A,o,g,w=1;do{for(n=t,t=null,s=null,A=0;n;){for(A++,r=n,o=0,e=0;e<w&&(o++,r=r.nextZ,!!r);e++);for(g=w;o>0||g>0&&r;)o!==0&&(g===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,g--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,w*=2}while(A>1);return t}function H3(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function MAe(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function w0(t,e,n,r,i,s,A,o){return(i-A)*(e-o)>=(t-A)*(s-o)&&(t-A)*(r-o)>=(n-A)*(e-o)&&(n-A)*(s-o)>=(i-A)*(r-o)}function CAe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!PAe(t,e)&&(Og(t,e)&&Og(e,t)&&IAe(t,e)&&(pi(t.prev,t,e.prev)||pi(t,e.prev,e))||nv(t,e)&&pi(t.prev,t,t.next)>0&&pi(e.prev,e,e.next)>0)}function pi(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function nv(t,e){return t.x===e.x&&t.y===e.y}function _O(t,e,n,r){var i=B1(pi(t,e,n)),s=B1(pi(t,e,r)),A=B1(pi(n,r,t)),o=B1(pi(n,r,e));return!!(i!==s&&A!==o||i===0&&R1(t,n,e)||s===0&&R1(t,r,e)||A===0&&R1(n,t,r)||o===0&&R1(n,e,r))}function R1(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function B1(t){return t>0?1:t<0?-1:0}function PAe(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&_O(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Og(t,e){return pi(t.prev,t,t.next)<0?pi(t,e,t.next)>=0&&pi(t,t.prev,e)>=0:pi(t,e,t.prev)<0||pi(t,t.next,e)<0}function IAe(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function vO(t,e){var n=new W3(t.i,t.x,t.y),r=new W3(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function mk(t,e,n,r){var i=new W3(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Fg(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function W3(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}tv.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,A=Math.abs(Q3(t,0,s,n));if(i)for(var o=0,g=e.length;o<g;o++){var w=e[o]*n,C=o<g-1?e[o+1]*n:t.length;A-=Math.abs(Q3(t,w,C,n))}var I=0;for(o=0;o<r.length;o+=3){var k=r[o]*n,U=r[o+1]*n,H=r[o+2]*n;I+=Math.abs((t[k]-t[H])*(t[U+1]-t[k+1])-(t[k]-t[U])*(t[H+1]-t[k+1]))}return A===0&&I===0?0:Math.abs((I-A)/A)};function Q3(t,e,n,r){for(var i=0,s=e,A=n-r;s<n;s+=r)i+=(t[A]-t[s])*(t[s+1]+t[A+1]),A=s;return i}tv.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var A=0;A<e;A++)n.vertices.push(t[i][s][A]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var kAe=bS.exports;const LAe=b2(kAe),z1=uO.CLOCKWISE,yk=uO.COUNTER_CLOCKWISE,Hc={isClosed:!0};function DAe(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function Op(t){return"positions"in t?t.positions:t}function Sy(t){return"holeIndices"in t?t.holeIndices:null}function RAe(t){return Array.isArray(t[0])}function BAe(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function zAe(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function OAe(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function _k(t,e,n,r,i){let s=e;const A=n.length;for(let o=0;o<A;o++)for(let g=0;g<r;g++)t[s++]=n[o][g]||0;if(!zAe(n))for(let o=0;o<r;o++)t[s++]=n[0][o]||0;return Hc.start=e,Hc.end=s,Hc.size=r,cO(t,i,Hc),s}function vk(t,e,n,r,i=0,s,A){s=s||n.length;const o=s-i;if(o<=0)return e;let g=e;for(let w=0;w<o;w++)t[g++]=n[i+w];if(!OAe(n,r,i,s))for(let w=0;w<r;w++)t[g++]=n[i+w];return Hc.start=e,Hc.end=g,Hc.size=r,cO(t,A,Hc),g}function xO(t,e){DAe(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let A=0;for(let o=0;o<=s.length;o++)A=vk(n,A,i,e,s[o-1],s[o],o===0?z1:yk),r.push(A);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!RAe(t))return vk(n,0,t,e,0,n.length,z1),n;if(!BAe(t)){let i=0;for(const[s,A]of t.entries())i=_k(n,i,A,e,s===0?z1:yk),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return _k(n,0,t,e,z1),n}function Lw(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const A=(s+1)%r;i+=t[s*3+e]*t[A*3+n],i-=t[A*3+e]*t[s*3+n]}return Math.abs(i/2)}function xk(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const A=s*3,o=t[A+0],g=t[A+1],w=t[A+2];t[A+e]=o,t[A+n]=g,t[A+r]=w}}function FAe(t,e,n,r){let i=Sy(t);i&&(i=i.map(o=>o/e));let s=Op(t);const A=r&&e===3;if(n){const o=s.length;s=s.slice();const g=[];for(let w=0;w<o;w+=e){g[0]=s[w],g[1]=s[w+1],A&&(g[2]=s[w+2]);const C=n(g);s[w]=C[0],s[w+1]=C[1],A&&(s[w+2]=C[2])}}if(A){const o=Lw(s,0,1),g=Lw(s,0,2),w=Lw(s,1,2);if(!o&&!g&&!w)return[];o>g&&o>w||(g>w?(n||(s=s.slice()),xk(s,0,2,1)):(n||(s=s.slice()),xk(s,2,0,1)))}return LAe(s,i,e)}class NAe extends YB{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=xO(e,this.positionSize);return this.opts.resolution?fO(Op(n),Sy(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?oAe(Op(n),Sy(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(wk(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return Op(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&wk(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:A,typedArrayManager:o}=this;let g=s.indices;if(!g||!e)return;let w=i;const C=FAe(e,this.positionSize,this.opts.preproject,this.opts.full3d);g=o.allocate(g,i+C.length,{copy:!0});for(let I=0;I<C.length;I++)g[w++]=C[I]+r;A[n+1]=i+C.length,s.indices=g}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const A=Op(e);for(let o=n,g=0;g<r;o++,g++){const w=A[g*s],C=A[g*s+1],I=s>2?A[g*s+2]:0;i[o*3]=w,i[o*3+1]=C,i[o*3+2]=I}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,A=e&&Sy(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),A)for(let o=0;o<A.length;o++)s[n+A[o]/i-1]=0;s[n+r-1]=0}}function wk(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const wO=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,UAe=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(wO,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),VAe=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(wO,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),GAe=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,G_=[0,0,0,255],$Ae={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:G_},getLineColor:{type:"accessor",value:G_},material:!0},O1={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class rv extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?UAe:VAe,fs:GAe,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Tf,YY,Sf]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===ar.DEFAULT&&(r=ar.LNGLAT);let s;r===ar.LNGLAT&&(i?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new NAe({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||FT(e,Yr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const A=this.getAttributeManager(),o=!0;A.remove(["instancePickingColors"]),A.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:O1,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,transition:O1,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:O1,accessor:"getFillColor",defaultValue:G_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:O1,accessor:"getLineColor",defaultValue:G_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(g,{index:w,target:C})=>this.encodePickingColor(g&&g.__source?g.__source.index:w,C),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:A,sideModel:o,polygonTesselator:g}=this.state,w={...e,extruded:!!n,elevationScale:s};o&&(o.setInstanceCount(g.instanceCount-1),o.setUniforms(w),i&&(o.setDrawMode(3),o.setUniforms({isWireframe:!0}).draw()),r&&(o.setDrawMode(6),o.setUniforms({isWireframe:!1}).draw())),A&&(A.setVertexCount(g.vertexCount),A.setUniforms(w).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var o;(o=this.state.models)===null||o===void 0||o.forEach(g=>g.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,A=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:A.getPolygon,buffers:A,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,A;if(r){const o=this.getShaders("top");o.defines.NON_INSTANCED_MODEL=1,s=new Yu(e,{...o,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(A=new Yu(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Vu({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),A.userData.excludeAttributes={indices:!0}),{models:[A,s].filter(Boolean),topModel:s,sideModel:A}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}oe(rv,"defaultProps",$Ae);oe(rv,"layerName","SolidPolygonLayer");function bO({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,A=t.length;let o=A,g=A;for(let k=0;k<A;k++){const U=e(t[k]);if(o>k&&U>=i&&(o=k),U>=s){g=k;break}}let w=o;const I=g-o!==r.length?t.slice(g):void 0;for(let k=0;k<r.length;k++)t[w++]=r[k];if(I){for(let k=0;k<I.length;k++)t[w++]=I[k];t.length=w}return{startRow:o,endRow:o+r.length}}const EO=[0,0,0,255],jAe=[0,0,0,255],HAe={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:jAe},getLineColor:{type:"accessor",value:EO},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class kf extends Ar{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&rr.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(s=>bO({data:r,getIndex:A=>A.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:s}=this.props,A=[],o=i==="XY"?2:3,{startRow:g,endRow:w}=e,{iterable:C,objectInfo:I}=Td(n,g,w);for(const k of C){I.index++;let U=r(k,I);s&&(U=xO(U,o));const{holeIndices:H}=U,q=U.positions||U;if(H)for(let se=0;se<=H.length;se++){const X=q.slice(H[se-1]||0,H[se]||q.length);A.push(this.getSubLayerRow({path:X},k,I.index))}else A.push(this.getSubLayerRow({path:q},k,I.index))}return A}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:s,wireframe:A,_normalize:o,_windingOrder:g,elevationScale:w,transitions:C,positionFormat:I}=this.props,{lineWidthUnits:k,lineWidthScale:U,lineWidthMinPixels:H,lineWidthMaxPixels:q,lineJointRounded:se,lineMiterLimit:X,lineDashJustified:te}=this.props,{getFillColor:ie,getLineColor:fe,getLineWidth:me,getLineDashArray:Se,getElevation:He,getPolygon:Qe,updateTriggers:Ke,material:nt}=this.props,{paths:Ne,pathsDiff:rt}=this.state,Ze=this.getSubLayerClass("fill",rv),mt=this.getSubLayerClass("stroke",ev),Kt=this.shouldRenderSubLayer("fill",Ne)&&new Ze({_dataDiff:n,extruded:s,elevationScale:w,filled:i,wireframe:A,_normalize:o,_windingOrder:g,getElevation:He,getFillColor:ie,getLineColor:s&&A?fe:EO,material:nt,transitions:C},this.getSubLayerProps({id:"fill",updateTriggers:Ke&&{getPolygon:Ke.getPolygon,getElevation:Ke.getElevation,getFillColor:Ke.getFillColor,lineColors:s&&A,getLineColor:Ke.getLineColor}}),{data:e,positionFormat:I,getPolygon:Qe}),Tt=!s&&r&&this.shouldRenderSubLayer("stroke",Ne)&&new mt({_dataDiff:rt&&(()=>rt),widthUnits:k,widthScale:U,widthMinPixels:H,widthMaxPixels:q,jointRounded:se,miterLimit:X,dashJustified:te,_pathType:"loop",transitions:C&&{getWidth:C.getLineWidth,getColor:C.getLineColor,getPath:C.getPolygon},getColor:this.getSubLayerAccessor(fe),getWidth:this.getSubLayerAccessor(me),getDashArray:this.getSubLayerAccessor(Se)},this.getSubLayerProps({id:"stroke",updateTriggers:Ke&&{getWidth:Ke.getLineWidth,getColor:Ke.getLineColor,getDashArray:Ke.getLineDashArray}}),{data:Ne,positionFormat:I,getPath:dn=>dn.path});return[!s&&Kt,Tt,s&&Kt]}}oe(kf,"layerName","PolygonLayer");oe(kf,"defaultProps",HAe);function WAe(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?QAe(t,r,n):null}function QAe(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function qAe(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let A=0;A<i.length;A++)e(i[A],s),n[r][A*3+0]=s[0],n[r][A*3+1]=s[1],n[r][A*3+2]=s[2]}return n}const ZAe=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Dw=192/256,bk=[],YAe={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class ES extends J2{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:ZAe}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&rr.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,A=i?Math.max(r,Dw*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Dw,outlineBuffer:A,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:o}=this.state;o.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Dw}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):bk}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):bk}}oe(ES,"defaultProps",YAe);oe(ES,"layerName","MultiIconLayer");const ng=1e20;class XAe{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:A="normal",fontStyle:o="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const g=this.size=e+n*4,w=this._createCanvas(g),C=this.ctx=w.getContext("2d",{willReadFrequently:!0});C.font=`${o} ${A} ${e}px ${s}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:A}=this.ctx.measureText(e),o=Math.ceil(r),g=0,w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(A-s))),C=Math.min(this.size-this.buffer,o+Math.ceil(i)),I=w+2*this.buffer,k=C+2*this.buffer,U=Math.max(I*k,0),H=new Uint8ClampedArray(U),q={data:H,width:I,height:k,glyphWidth:w,glyphHeight:C,glyphTop:o,glyphLeft:g,glyphAdvance:n};if(w===0||C===0)return q;const{ctx:se,buffer:X,gridInner:te,gridOuter:ie}=this;se.clearRect(X,X,w,C),se.fillText(e,X,X+o);const fe=se.getImageData(X,X,w,C);ie.fill(ng,0,U),te.fill(0,0,U);for(let me=0;me<C;me++)for(let Se=0;Se<w;Se++){const He=fe.data[4*(me*w+Se)+3]/255;if(He===0)continue;const Qe=(me+X)*I+Se+X;if(He===1)ie[Qe]=0,te[Qe]=ng;else{const Ke=.5-He;ie[Qe]=Ke>0?Ke*Ke:0,te[Qe]=Ke<0?Ke*Ke:0}}Ek(ie,0,0,I,k,I,this.f,this.v,this.z),Ek(te,X,X,w,C,I,this.f,this.v,this.z);for(let me=0;me<U;me++){const Se=Math.sqrt(ie[me])-Math.sqrt(te[me]);H[me]=Math.round(255-255*(Se/this.radius+this.cutoff))}return q}}function Ek(t,e,n,r,i,s,A,o,g){for(let w=e;w<e+r;w++)Tk(t,n*s+w,s,i,A,o,g);for(let w=n;w<n+i;w++)Tk(t,w*s+e,1,r,A,o,g)}function Tk(t,e,n,r,i,s,A){s[0]=0,A[0]=-ng,A[1]=ng,i[0]=t[e];for(let o=1,g=0,w=0;o<r;o++){i[o]=t[e+o*n];const C=o*o;do{const I=s[g];w=(i[o]-i[I]+C-I*I)/(o-I)/2}while(w<=A[g]&&--g>-1);g++,s[g]=o,A[g]=w,A[g+1]=ng}for(let o=0,g=0;o<r;o++){for(;A[g+1]<o;)g++;const w=s[g],C=o-w;t[e+o*n]=i[w]+C*C}}const KAe=32,JAe=[];function eue(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function tue({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:A=0,yOffset:o=0}){let g=0,w=A;const C=n+r*2;for(const I of t)if(!s[I]){const k=e(I);w+k+r*2>i&&(w=0,g++),s[I]={x:w+r,y:o+g*C+r,width:k,height:C,layoutWidth:k,layoutHeight:n},w+=k+r*2}return{mapping:s,xOffset:w,yOffset:o+g*C,canvasHeight:eue(o+(g+1)*C)}}function TO(t,e,n,r){let i=0;for(let A=e;A<n;A++){var s;const o=t[A];i+=((s=r[o])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function SO(t,e,n,r,i,s){let A=e,o=0;for(let g=e;g<n;g++){const w=TO(t,g,g+1,i);o+w>r&&(A<g&&s.push(g),A=g,o=0),o+=w}return o}function nue(t,e,n,r,i,s){let A=e,o=e,g=e,w=0;for(let C=e;C<n;C++)if((t[C]===" "||t[C+1]===" "||C+1===n)&&(g=C+1),g>o){let I=TO(t,o,g,i);w+I>r&&(A<o&&(s.push(o),A=o,w=0),I>r&&(I=SO(t,o,g,r,i,s),A=s[s.length-1])),o=g,w+=I}return w}function rue(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const A=[];return e==="break-all"?SO(t,i,s,n,r,A):nue(t,i,s,n,r,A),A}function iue(t,e,n,r,i,s){let A=0,o=0;for(let g=e;g<n;g++){const w=t[g],C=r[w];C?(o||(o=C.layoutHeight),i[g]=A+C.layoutWidth/2,A+=C.layoutWidth):(rr.warn("Missing character: ".concat(w," (").concat(w.codePointAt(0),")"))(),i[g]=A,A+=KAe)}s[0]=A,s[1]=o}function sue(t,e,n,r,i){const s=Array.from(t),A=s.length,o=new Array(A),g=new Array(A),w=new Array(A),C=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,I=[0,0],k=[0,0];let U=0,H=0,q=0;for(let X=0;X<=A;X++){const te=s[X];if((te===`
`||X===A)&&(q=X),q>H){const ie=C?rue(s,n,r,i,H,q):JAe;for(let fe=0;fe<=ie.length;fe++){const me=fe===0?H:ie[fe-1],Se=fe<ie.length?ie[fe]:q;iue(s,me,Se,i,o,k);for(let He=me;He<Se;He++){var se;const Qe=s[He],Ke=((se=i[Qe])===null||se===void 0?void 0:se.layoutOffsetY)||0;g[He]=U+k[1]/2+Ke,w[He]=k[0]}U=U+k[1]*e,I[0]=Math.max(I[0],k[0])}H=q}te===`
`&&(o[H]=0,g[H]=0,w[H]=0,H++)}return I[1]=U,{x:o,y:g,rowWidth:w,size:I}}function oue({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const A=t.BYTES_PER_ELEMENT,o=n?n/A:1,g=r?r/A:0,w=i[e]||Math.ceil((t.length-g)/o),C=s&&new Set,I=new Array(e);let k=t;if(o>1||g>0){const U=t.constructor;k=new U(w);for(let H=0;H<w;H++)k[H]=t[H*o+g]}for(let U=0;U<e;U++){const H=i[U],q=i[U+1]||w,se=k.subarray(H,q);I[U]=String.fromCodePoint.apply(null,se),C&&se.forEach(C.add,C)}if(C)for(const U of C)s.add(String.fromCodePoint(U));return{texts:I,characterCount:w}}class MO{constructor(e=5){oe(this,"limit",void 0),oe(this,"_cache",{}),oe(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function aue(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const G0={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:aue(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},Sk=1024,Mk=.9,Ck=1.2,CO=3;let $_=new MO(CO);function lue(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=$_.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function Aue(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function Pk(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function uue(t){rr.assert(Number.isFinite(t)&&t>=CO,"Invalid cache limit"),$_=new MO(t)}class cue{constructor(){oe(this,"props",{...G0}),oe(this,"_key",void 0),oe(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*Ck+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=lue(this._key,this.props.characterSet),r=$_.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,$_.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:A,sdf:o,radius:g,cutoff:w}=this.props;let C=n&&n.data;C||(C=document.createElement("canvas"),C.width=Sk);const I=C.getContext("2d",{willReadFrequently:!0});Pk(I,r,s,i);const{mapping:k,canvasHeight:U,xOffset:H,yOffset:q}=tue({getFontWidth:se=>I.measureText(se).width,fontHeight:s*Ck,buffer:A,characterSet:e,maxCanvasWidth:Sk,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(C.height!==U){const se=I.getImageData(0,0,C.width,C.height);C.height=U,I.putImageData(se,0,0)}if(Pk(I,r,s,i),o){const se=new XAe({fontSize:s,buffer:A,radius:g,cutoff:w,fontFamily:r,fontWeight:"".concat(i)});for(const X of e){const{data:te,width:ie,height:fe,glyphTop:me}=se.draw(X);k[X].width=ie,k[X].layoutOffsetY=s*Mk-me;const Se=I.createImageData(ie,fe);Aue(te,Se),I.putImageData(Se,k[X].x,k[X].y)}}else for(const se of e)I.fillText(se,k[se].x,k[se].y+A+s*Mk);return{xOffset:H,yOffset:q,mapping:k,data:C,width:C.width,height:C.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:A,cutoff:o}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(A," ").concat(o):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const hue=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,fue=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,due={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class TS extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){return super.getShaders({vs:hue,fs:fue,modules:[Tf,Sf]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:A,getLineWidth:o}=this.props;let{padding:g}=this.props;g.length<4&&(g=[g[0],g[1],g[0],g[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!o,padding:g,sizeUnits:Jh[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:A}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Yu(e,{...this.getShaders(),id:this.props.id,geometry:new Vu({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}oe(TS,"defaultProps",due);oe(TS,"layerName","TextBackgroundLayer");const Ik={start:1,middle:0,end:-1},kk={top:1,center:0,bottom:-1},Rw=[0,0,0,255],pue=1,gue={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Rw},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:G0.characterSet},fontFamily:G0.fontFamily,fontWeight:G0.fontWeight,lineHeight:pue,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Rw},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Rw},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class SS extends Ar{constructor(...e){super(...e),oe(this,"state",void 0),oe(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:A}=this.state.fontAtlasManager.props;i/=A,s/=A;const{getTextAnchor:o,getAlignmentBaseline:g}=this.props,w=Ik[typeof o=="function"?o(n,r):o],C=kk[typeof g=="function"?g(n,r):g];return[(w-1)*i/2,(C-1)*s/2,i,s]}),oe(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:A,y:o,rowWidth:g,size:[w,C]}=this.transformParagraph(n,r),I=Ik[typeof i=="function"?i(n,r):i],k=kk[typeof s=="function"?s(n,r):s],U=A.length,H=new Array(U*2);let q=0;for(let se=0;se<U;se++){const X=(1-I)*(w-g[se])/2;H[q++]=(I-1)*w/2+X+A[se],H[q++]=(k-1)*C/2+o[se]}return H})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new cue},this.props.maxWidth>0&&rr.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,A={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(A),!0;for(const o in A)if(A[o]!==i.props[o])return i.setProps(A),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,A=n.startIndices,o;const g=r==="auto"&&new Set;if(i&&A){const{texts:w,characterCount:C}=oue({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:A,characterSet:g});o=C,s=(I,{index:k})=>w[k]}else{const{iterable:w,objectInfo:C}=Td(n);A=[0],o=0;for(const I of w){C.index++;const k=Array.from(s(I,C)||"");g&&k.forEach(g.add,g),o+=k.length,A.push(o)}}this.setState({getText:s,startIndices:A,numInstances:o,characterSet:g||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:A,lineHeight:o,maxWidth:g}=this.props,w=s(e,n)||"";return sue(w,o,A,g*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:A},styleVersion:o}=this.state,{data:g,_dataDiff:w,getPosition:C,getColor:I,getSize:k,getAngle:U,getPixelOffset:H,getBackgroundColor:q,getBorderColor:se,getBorderWidth:X,backgroundPadding:te,background:ie,billboard:fe,fontSettings:me,outlineWidth:Se,outlineColor:He,sizeScale:Qe,sizeUnits:Ke,sizeMinPixels:nt,sizeMaxPixels:Ne,transitions:rt,updateTriggers:Ze}=this.props,mt=this.getSubLayerClass("characters",ES),Kt=this.getSubLayerClass("background",TS);return[ie&&new Kt({getFillColor:q,getLineColor:se,getLineWidth:X,padding:te,getPosition:C,getSize:k,getAngle:U,getPixelOffset:H,billboard:fe,sizeScale:Qe,sizeUnits:Ke,sizeMinPixels:nt,sizeMaxPixels:Ne,transitions:rt&&{getPosition:rt.getPosition,getAngle:rt.getAngle,getSize:rt.getSize,getFillColor:rt.getBackgroundColor,getLineColor:rt.getBorderColor,getLineWidth:rt.getBorderWidth,getPixelOffset:rt.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Ze.getPosition,getAngle:Ze.getAngle,getSize:Ze.getSize,getFillColor:Ze.getBackgroundColor,getLineColor:Ze.getBorderColor,getLineWidth:Ze.getBorderWidth,getPixelOffset:Ze.getPixelOffset,getBoundingRect:{getText:Ze.getText,getTextAnchor:Ze.getTextAnchor,getAlignmentBaseline:Ze.getAlignmentBaseline,styleVersion:o}}}),{data:g.attributes&&g.attributes.background?{length:g.length,attributes:g.attributes.background}:g,_dataDiff:w,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new mt({sdf:me.sdf,smoothing:Number.isFinite(me.smoothing)?me.smoothing:G0.smoothing,outlineWidth:Se/(me.radius||G0.radius),outlineColor:He,iconAtlas:s,iconMapping:A,getPosition:C,getColor:I,getSize:k,getAngle:U,getPixelOffset:H,billboard:fe,sizeScale:Qe*i,sizeUnits:Ke,sizeMinPixels:nt*i,sizeMaxPixels:Ne*i,transitions:rt&&{getPosition:rt.getPosition,getAngle:rt.getAngle,getColor:rt.getColor,getSize:rt.getSize,getPixelOffset:rt.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Ze.getText,getPosition:Ze.getPosition,getAngle:Ze.getAngle,getColor:Ze.getColor,getSize:Ze.getSize,getPixelOffset:Ze.getPixelOffset,getIconOffsets:{getTextAnchor:Ze.getTextAnchor,getAlignmentBaseline:Ze.getAlignmentBaseline,styleVersion:o}}}),{data:g,_dataDiff:w,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){uue(e)}}oe(SS,"defaultProps",gue);oe(SS,"layerName","TextLayer");const My={circle:{type:wS,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:J2,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:SS,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Cy={type:ev,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},q3={type:rv,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function mp({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function Bw(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const A=e[s];let o=t.props[s];s.startsWith("get")&&(o=t.getSubLayerAccessor(o),i.updateTriggers[A]=r[s],n&&(i.transitions[A]=n[s])),i[A]=o}return i}function mue(t){if(Array.isArray(t))return t;switch(rr.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return rr.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function Lk(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let A=i;A<s;A++){const o=t[A],{geometry:g}=o;if(g)if(g.type==="GeometryCollection"){rr.assert(Array.isArray(g.geometries),"GeoJSON does not have geometries array");const{geometries:w}=g;for(let C=0;C<w.length;C++){const I=w[C];Dk(I,r,e,o,A)}}else Dk(g,r,e,o,A)}return r}function Dk(t,e,n,r,i){const{type:s,coordinates:A}=t,{pointFeatures:o,lineFeatures:g,polygonFeatures:w,polygonOutlineFeatures:C}=e;if(!_ue(s,A)){rr.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":o.push(n({geometry:t},r,i));break;case"MultiPoint":A.forEach(I=>{o.push(n({geometry:{type:"Point",coordinates:I}},r,i))});break;case"LineString":g.push(n({geometry:t},r,i));break;case"MultiLineString":A.forEach(I=>{g.push(n({geometry:{type:"LineString",coordinates:I}},r,i))});break;case"Polygon":w.push(n({geometry:t},r,i)),A.forEach(I=>{C.push(n({geometry:{type:"LineString",coordinates:I}},r,i))});break;case"MultiPolygon":A.forEach(I=>{w.push(n({geometry:{type:"Polygon",coordinates:I}},r,i)),I.forEach(k=>{C.push(n({geometry:{type:"LineString",coordinates:k}},r,i))})});break}}const yue={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function _ue(t,e){let n=yue[t];for(rr.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function PO(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function F1(t){return t.geometry.coordinates}function vue(t,e){const n=PO(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:A}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=F1,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=F1,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=F1,n.polygonsOutline.data=A,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=F1,n}function xue(t,e){const n=PO(),{points:r,lines:i,polygons:s}=t,A=qAe(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:A.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:A.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:A.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:A.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const wue=["points","linestrings","polygons"],bue={...mp(My.circle),...mp(My.icon),...mp(My.text),...mp(Cy),...mp(q3),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class ns extends Ar{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=xue(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=mue(e.data),i=this.getSubLayerRow.bind(this);let s={};const A={};if(Array.isArray(n.dataChanged)){const g=this.state.features;for(const w in g)s[w]=g[w].slice(),A[w]=[];for(const w of n.dataChanged){const C=Lk(r,i,w);for(const I in g)A[I].push(bO({data:s[I],getIndex:k=>k.__source.index,dataRange:w,replace:C[I]}))}}else s=Lk(r,i);const o=vue(s,A);this.setState({features:s,featuresDiff:A,layerProps:o})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=wue.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,q3.type);if(s){const A=Bw(this,q3.props),o=e&&n;return o||delete A.getLineColor,A.updateTriggers.lineColors=o,new s(A,this.getSubLayerProps({id:i,updateTriggers:A.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",A=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,Cy.type),o=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,Cy.type);if(A||o){const g=Bw(this,Cy.props);return[A&&new A(g,this.getSubLayerProps({id:i,updateTriggers:g.updateTriggers}),r.polygonsOutline),o&&new o(g,this.getSubLayerProps({id:s,updateTriggers:g.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(o=>o.__source.index===i));const s=new Set(e.split("+")),A=[];for(const o of s){const g="points-".concat(o),w=My[o],C=w&&this.shouldRenderSubLayer(g,n.points.data)&&this.getSubLayerClass(g,w.type);if(C){const I=Bw(this,w.props);let k=n.points;if(o==="text"&&r){const{instancePickingColors:U,...H}=k.data.attributes;k={...k,data:{...k.data,attributes:H}}}A.push(new C(I,this.getSubLayerProps({id:g,updateTriggers:I.updateTriggers,highlightedObjectIndex:i}),k))}}return A}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:A}=i,o=WAe(s,A);return e(o,i)}}}oe(ns,"layerName","GeoJsonLayer");oe(ns,"defaultProps",bue);class Eue{constructor(e){oe(this,"index",void 0),oe(this,"isVisible",void 0),oe(this,"isSelected",void 0),oe(this,"parent",void 0),oe(this,"children",void 0),oe(this,"content",void 0),oe(this,"state",void 0),oe(this,"layers",void 0),oe(this,"id",void 0),oe(this,"zoom",void 0),oe(this,"userData",void 0),oe(this,"boundingBox",void 0),oe(this,"_abortController",void 0),oe(this,"_loader",void 0),oe(this,"_loaderId",void 0),oe(this,"_isLoaded",void 0),oe(this,"_isCancelled",void 0),oe(this,"_needsReload",void 0),oe(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:s,id:A,bbox:o,userData:g,zoom:w}=this,C=this._loaderId;this._abortController=new AbortController;const{signal:I}=this._abortController,k=await n.scheduleRequest(this,q=>q.isSelected?1:-1);if(!k){this._isCancelled=!0;return}if(this._isCancelled){k.done();return}let U=null,H;try{U=await e({index:s,id:A,bbox:o,userData:g,zoom:w,signal:I})}catch(q){H=q||!0}finally{k.done()}if(C===this._loaderId){if(this._loader=void 0,this.content=U,this._isCancelled&&!U){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,H?i(H,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const ao={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},Rk=new An,Tue=new An;class MS{constructor(e=[0,0,0],n=[0,0,0],r){oe(this,"center",void 0),oe(this,"halfDiagonal",void 0),oe(this,"minimum",void 0),oe(this,"maximum",void 0),r=r||Rk.copy(e).add(n).scale(.5),this.center=new An(r),this.halfDiagonal=new An(n).subtract(this.center),this.minimum=new An(e),this.maximum=new An(n)}clone(){return new MS(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=Tue.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),s=this.center.dot(r)+e.distance;return s-i>0?ao.INSIDE:s+i<0?ao.OUTSIDE:ao.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=Rk.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,s;return s=Math.abs(n.x)-r.x,s>0&&(i+=s*s),s=Math.abs(n.y)-r.y,s>0&&(i+=s*s),s=Math.abs(n.z)-r.z,s>0&&(i+=s*s),i}}const yp=new An,Bk=new An;class CS{constructor(e=[0,0,0],n=0){oe(this,"center",void 0),oe(this,"radius",void 0),this.radius=-0,this.center=new An,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=yp.from(n),this.center=new An().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new CS(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,s=e.radius,A=yp.copy(i).subtract(n),o=A.magnitude();if(r>=o+s)return this.clone();if(s>=o+r)return e.clone();const g=(r+o+s)*.5;return Bk.copy(A).scale((-r+g)/o).add(n),this.center.copy(Bk),this.radius=g,this}expand(e){const r=yp.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=rY(yp,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=yp.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,s=e.normal.dot(n)+e.distance;return s<-r?ao.OUTSIDE:s<r?ao.INTERSECTING:ao.INSIDE}}const Sue=new An,Mue=new An,N1=new An,U1=new An,V1=new An,Cue=new An,Pue=new An,bu={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class PS{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){oe(this,"center",void 0),oe(this,"halfAxes",void 0),this.center=new An().from(e),this.halfAxes=new ks(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new An(e).len(),new An(n).len(),new An(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new An(e).normalize(),s=new An(n).normalize(),A=new An(r).normalize();return new xP().fromMatrix3(new ks([...i,...s,...A]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new xP(r),s=new ks().fromQuaternion(i);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new An().from(e),this.halfAxes=s,this}clone(){return new PS(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new CS){const n=this.halfAxes,r=n.getColumn(0,N1),i=n.getColumn(1,U1),s=n.getColumn(2,V1),A=Sue.copy(r).add(i).add(s);return e.center.copy(this.center),e.radius=A.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,s=r.x,A=r.y,o=r.z,g=Math.abs(s*i[bu.COLUMN0ROW0]+A*i[bu.COLUMN0ROW1]+o*i[bu.COLUMN0ROW2])+Math.abs(s*i[bu.COLUMN1ROW0]+A*i[bu.COLUMN1ROW1]+o*i[bu.COLUMN1ROW2])+Math.abs(s*i[bu.COLUMN2ROW0]+A*i[bu.COLUMN2ROW1]+o*i[bu.COLUMN2ROW2]),w=r.dot(n)+e.distance;return w<=-g?ao.OUTSIDE:w>=g?ao.INSIDE:ao.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=Mue.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,N1),s=r.getColumn(1,U1),A=r.getColumn(2,V1),o=i.magnitude(),g=s.magnitude(),w=A.magnitude();i.normalize(),s.normalize(),A.normalize();let C=0,I;return I=Math.abs(n.dot(i))-o,I>0&&(C+=I*I),I=Math.abs(n.dot(s))-g,I>0&&(C+=I*I),I=Math.abs(n.dot(A))-w,I>0&&(C+=I*I),C}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const A=this.center,o=this.halfAxes,g=o.getColumn(0,N1),w=o.getColumn(1,U1),C=o.getColumn(2,V1),I=Cue.copy(g).add(w).add(C).add(A),k=Pue.copy(I).subtract(e);let U=n.dot(k);return i=Math.min(U,i),s=Math.max(U,s),I.copy(A).add(g).add(w).subtract(C),k.copy(I).subtract(e),U=n.dot(k),i=Math.min(U,i),s=Math.max(U,s),I.copy(A).add(g).subtract(w).add(C),k.copy(I).subtract(e),U=n.dot(k),i=Math.min(U,i),s=Math.max(U,s),I.copy(A).add(g).subtract(w).subtract(C),k.copy(I).subtract(e),U=n.dot(k),i=Math.min(U,i),s=Math.max(U,s),A.copy(I).subtract(g).add(w).add(C),k.copy(I).subtract(e),U=n.dot(k),i=Math.min(U,i),s=Math.max(U,s),A.copy(I).subtract(g).add(w).subtract(C),k.copy(I).subtract(e),U=n.dot(k),i=Math.min(U,i),s=Math.max(U,s),A.copy(I).subtract(g).subtract(w).add(C),k.copy(I).subtract(e),U=n.dot(k),i=Math.min(U,i),s=Math.max(U,s),A.copy(I).subtract(g).subtract(w).subtract(C),k.copy(I).subtract(e),U=n.dot(k),i=Math.min(U,i),s=Math.max(U,s),r[0]=i,r[1]=s,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,N1);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,U1);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,V1);return i.transformAsPoint(e),this.halfAxes=new ks([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const zk=new An,Ok=new An;class fd{constructor(e=[0,0,1],n=0){oe(this,"normal",void 0),oe(this,"distance",void 0),this.normal=new An,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return Cg(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=zk.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),Cg(Uu(this.normal.len(),1)),this.distance=i,this}clone(){return new fd(this.normal,this.distance)}equals(e){return Uu(this.distance,e.distance)&&Uu(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=Ok.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=zk.from(e);const r=this.getPointDistance(e),i=Ok.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const Fk=[new An([1,0,0]),new An([0,1,0]),new An([0,0,1])],Nk=new An,Iue=new An;new fd(new An(1,0,0),0);class Bu{constructor(e=[]){oe(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*Fk.length;const n=e.center,r=e.radius;let i=0;for(const s of Fk){let A=this.planes[i],o=this.planes[i+1];A||(A=this.planes[i]=new fd),o||(o=this.planes[i+1]=new fd);const g=Nk.copy(s).scale(-r).add(n);-s.dot(g),A.fromPointNormal(g,s);const w=Nk.copy(s).scale(r).add(n),C=Iue.copy(s).negate();-C.dot(w),o.fromPointNormal(w,C),i+=2}return this}computeVisibility(e){let n=ao.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case ao.OUTSIDE:return ao.OUTSIDE;case ao.INTERSECTING:n=ao.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(Cg(Number.isFinite(n),"parentPlaneMask is required."),n===Bu.MASK_OUTSIDE||n===Bu.MASK_INSIDE)return n;let r=Bu.MASK_INSIDE;const i=this.planes;for(let s=0;s<this.planes.length;++s){const A=s<31?1<<s:0;if(s<31&&!(n&A))continue;const o=i[s],g=e.intersectPlane(o);if(g===ao.OUTSIDE)return Bu.MASK_OUTSIDE;g===ao.INTERSECTING&&(r|=A)}return r}}oe(Bu,"MASK_OUTSIDE",4294967295);oe(Bu,"MASK_INSIDE",0);oe(Bu,"MASK_INDETERMINATE",2147483647);new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;new An;const MA=new ks,kue=new ks,Lue=new ks,G1=new ks,Uk=new ks;function Due(t,e={}){const n=lB.EPSILON20,r=10;let i=0,s=0;const A=kue,o=Lue;A.identity(),o.copy(t);const g=n*Rue(o);for(;s<r&&Bue(o)>g;)zue(o,G1),Uk.copy(G1).transpose(),o.multiplyRight(G1),o.multiplyLeft(Uk),A.multiplyRight(G1),++i>2&&(++s,i=0);return e.unitary=A.toTarget(e.unitary),e.diagonal=o.toTarget(e.diagonal),e}function Rue(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const Z3=[1,0,0],Y3=[2,2,1];function Bue(t){let e=0;for(let n=0;n<3;++n){const r=t[MA.getElementIndex(Y3[n],Z3[n])];e+=2*r*r}return Math.sqrt(e)}function zue(t,e){const n=lB.EPSILON15;let r=0,i=1;for(let w=0;w<3;++w){const C=Math.abs(t[MA.getElementIndex(Y3[w],Z3[w])]);C>r&&(i=w,r=C)}const s=Z3[i],A=Y3[i];let o=1,g=0;if(Math.abs(t[MA.getElementIndex(A,s)])>n){const w=t[MA.getElementIndex(A,A)],C=t[MA.getElementIndex(s,s)],I=t[MA.getElementIndex(A,s)],k=(w-C)/2/I;let U;k<0?U=-1/(-k+Math.sqrt(1+k*k)):U=1/(k+Math.sqrt(1+k*k)),o=1/Math.sqrt(1+U*U),g=U*o}return ks.IDENTITY.to(e),e[MA.getElementIndex(s,s)]=e[MA.getElementIndex(A,A)]=o,e[MA.getElementIndex(A,s)]=g,e[MA.getElementIndex(s,A)]=-g,e}const kc=new An,Oue=new An,Fue=new An,Nue=new An,Uue=new An,Vue=new ks,Gue={diagonal:new ks,unitary:new ks};function $ue(t,e=new PS){if(!t||t.length===0)return e.halfAxes=new ks([0,0,0,0,0,0,0,0,0]),e.center=new An,e;const n=t.length,r=new An(0,0,0);for(const Ke of t)r.add(Ke);const i=1/n;r.multiplyByScalar(i);let s=0,A=0,o=0,g=0,w=0,C=0;for(const Ke of t){const nt=kc.copy(Ke).subtract(r);s+=nt.x*nt.x,A+=nt.x*nt.y,o+=nt.x*nt.z,g+=nt.y*nt.y,w+=nt.y*nt.z,C+=nt.z*nt.z}s*=i,A*=i,o*=i,g*=i,w*=i,C*=i;const I=Vue;I[0]=s,I[1]=A,I[2]=o,I[3]=A,I[4]=g,I[5]=w,I[6]=o,I[7]=w,I[8]=C;const{unitary:k}=Due(I,Gue),U=e.halfAxes.copy(k);let H=U.getColumn(0,Fue),q=U.getColumn(1,Nue),se=U.getColumn(2,Uue),X=-Number.MAX_VALUE,te=-Number.MAX_VALUE,ie=-Number.MAX_VALUE,fe=Number.MAX_VALUE,me=Number.MAX_VALUE,Se=Number.MAX_VALUE;for(const Ke of t)kc.copy(Ke),X=Math.max(kc.dot(H),X),te=Math.max(kc.dot(q),te),ie=Math.max(kc.dot(se),ie),fe=Math.min(kc.dot(H),fe),me=Math.min(kc.dot(q),me),Se=Math.min(kc.dot(se),Se);H=H.multiplyByScalar(.5*(fe+X)),q=q.multiplyByScalar(.5*(me+te)),se=se.multiplyByScalar(.5*(Se+ie)),e.center.copy(H).add(q).add(se);const He=Oue.set(X-fe,te-me,ie-Se).multiplyByScalar(.5),Qe=new ks([He[0],0,0,0,He[1],0,0,0,He[2]]);return e.halfAxes.multiplyRight(Qe),e}const b0=512,Vk=3,IO=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],kO=IO.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),jue=kO.concat([[.25,.5],[.75,.5]]);class E0{constructor(e,n,r){oe(this,"x",void 0),oe(this,"y",void 0),oe(this,"z",void 0),oe(this,"childVisible",void 0),oe(this,"selected",void 0),oe(this,"_children",void 0),this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new E0(e,n,r),new E0(e,n+1,r),new E0(e+1,n,r),new E0(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:s,maxZ:A,bounds:o,offset:g,project:w}=e,C=this.getBoundingVolume(i,g,w);if(o&&!this.insideBounds(o)||r.computeVisibility(C)<0)return!1;if(!this.childVisible){let{z:k}=this;if(k<A&&k>=s){const U=C.distanceTo(n.cameraPosition)*n.scale/n.height;k+=Math.floor(Math.log2(U))}if(k>=A)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const k of this.children)k.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const s=Math.pow(2,this.z),A=b0/s;return this.x*A<r&&this.y*A<i&&(this.x+1)*A>e&&(this.y+1)*A>n}getBoundingVolume(e,n,r){if(r){const g=this.z<1?jue:this.z<2?kO:IO,w=[];for(const C of g){const I=K3(this.x+C[0],this.y+C[1],this.z);I[2]=e[0],w.push(r(I)),e[0]!==e[1]&&(I[2]=e[1],w.push(r(I)))}return $ue(w)}const i=Math.pow(2,this.z),s=b0/i,A=this.x*s+n*b0,o=b0-(this.y+1)*s;return new MS([A,o,e[0]],[A+s,o+s,e[1]])}}function Hue(t,e,n,r){const i=t instanceof kte&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:U,distance:H})=>new fd(U.clone().negate(),H)),A=new Bu(s),o=t.distanceScales.unitsPerMeter[2],g=n&&n[0]*o||0,w=n&&n[1]*o||0,C=t instanceof Ku&&t.pitch<=60?e:0;if(r){const[U,H,q,se]=r,X=nA([U,se]),te=nA([q,H]);r=[X[0],b0-X[1],te[0],b0-te[1]]}const I=new E0(0,0,0),k={viewport:t,project:i,cullingVolume:A,elevationBounds:[g,w],minZ:C,maxZ:e,bounds:r,offset:0};if(I.update(k),t instanceof Ku&&t.subViewports&&t.subViewports.length>1){for(k.offset=-1;I.update(k)&&!(--k.offset<-Vk););for(k.offset=1;I.update(k)&&!(++k.offset>Vk););}return I.getSelected()}const nc=512,Wue=[-1/0,-1/0,1/0,1/0],Que={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function LO(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function que(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function Zue(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const s=que(r)%t.length;t=t[s]}let i=t;for(const s of Object.keys(n)){const A=new RegExp("{".concat(s,"}"),"g");i=i.replace(A,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function Yue(t,e,n){let r;if(e&&e.length===2){const[i,s]=e,A=t.getBounds({z:i}),o=t.getBounds({z:s});r=[Math.min(A[0],o[0]),Math.min(A[1],o[1]),Math.max(A[2],o[2]),Math.max(A[3],o[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function Xue({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(i=>X3(i,e,n))}function X3(t,e,n){if(!Array.isArray(e)){const s=n.x-t.x,A=n.y-t.y,{width:o,height:g}=n,w={targetZ:e},C=t.unproject([s,A],w),I=t.unproject([s+o,A],w),k=t.unproject([s,A+g],w),U=t.unproject([s+o,A+g],w);return[Math.min(C[0],I[0],k[0],U[0]),Math.min(C[1],I[1],k[1],U[1]),Math.max(C[0],I[0],k[0],U[0]),Math.max(C[1],I[1],k[1],U[1])]}const r=X3(t,e[0],n),i=X3(t,e[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function Kue(t,e,n){return n?LO(t,n).map(i=>i*e/nc):t.map(r=>r*e/nc)}function IS(t,e){return Math.pow(2,t)*nc/e}function K3(t,e,n){const r=IS(n,nc),i=t/r*360-180,s=Math.PI-2*Math.PI*e/r,A=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[i,A]}function Gk(t,e,n,r){const i=IS(n,r);return[t/i*nc,e/i*nc]}function Jue(t,e,n,r,i=nc){if(t.isGeospatial){const[w,C]=K3(e,n,r),[I,k]=K3(e+1,n+1,r);return{west:w,north:C,east:I,south:k}}const[s,A]=Gk(e,n,r,i),[o,g]=Gk(e+1,n+1,r,i);return{left:s,top:A,right:o,bottom:g}}function ece(t,e,n,r,i){const s=Yue(t,null,r),A=IS(e,n),[o,g,w,C]=Kue(s,A,i),I=[];for(let k=Math.floor(o);k<w;k++)for(let U=Math.floor(g);U<C;U++)I.push({x:k,y:U,z:e});return I}function tce({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:s=nc,modelMatrix:A,modelMatrixInverse:o,zoomOffset:g=0}){let w=t.isGeospatial?Math.round(t.zoom+Math.log2(nc/s))+g:Math.ceil(t.zoom)+g;if(typeof n=="number"&&Number.isFinite(n)&&w<n){if(!i)return[];w=n}typeof e=="number"&&Number.isFinite(e)&&w>e&&(w=e);let C=i;return A&&o&&i&&!t.isGeospatial&&(C=LO(i,A)),t.isGeospatial?Hue(t,w,r,i):ece(t,w,s,C||Wue,o)}function nce(t){let e={},n;return r=>{for(const i in r)if(!rce(r[i],e[i])){n=t(r),e=r;break}return n}}function rce(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}const $k=1,iv=2,ice="never",sce="no-overlap",kS="best-available",oce=5,ace={[kS]:uce,[sce]:cce,[ice]:()=>{}},lce={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class Ace{constructor(e){oe(this,"opts",void 0),oe(this,"_requestScheduler",void 0),oe(this,"_cache",void 0),oe(this,"_dirty",void 0),oe(this,"_tiles",void 0),oe(this,"_cacheByteSize",void 0),oe(this,"_viewport",void 0),oe(this,"_zRange",void 0),oe(this,"_selectedTiles",void 0),oe(this,"_frameNumber",void 0),oe(this,"_modelMatrix",void 0),oe(this,"_modelMatrixInverse",void 0),oe(this,"_maxZoom",void 0),oe(this,"_minZoom",void 0),oe(this,"onTileLoad",void 0),oe(this,"_getCullBounds",nce(Xue)),this.opts={...lce,...e},this.onTileLoad=n=>{var r,i;(r=(i=this.opts).onTileLoad)===null||r===void 0||r.call(i,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new n$({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new ia,this._modelMatrixInverse=new ia,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={}){const i=new ia(r),s=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Uu(this._zRange,n)||s){s&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const o=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=o.map(g=>this._getTile(g,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(o=>this._getTile(o.index,!0)));const A=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),A&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const r=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:i}=e;for(const[s,A,o,g]of r){let w;if("west"in i)w=i.west<o&&i.east>s&&i.south<g&&i.north>A;else{const C=Math.min(i.top,i.bottom),I=Math.max(i.top,i.bottom);w=i.left<o&&i.right>s&&C<g&&I>A}if(w)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:s,modelMatrixInverse:A}){const{tileSize:o,extent:g,zoomOffset:w}=this.opts;return tce({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:o,extent:g,modelMatrix:s,modelMatrixInverse:A,zoomOffset:w})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:Jue(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||kS,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:ace[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:oce*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[g,w]of e){if(!w.isVisible&&!w.isSelected){var A,o;this._cacheByteSize-=n.maxCacheByteSize?w.byteLength:0,e.delete(g),(A=(o=this.opts).onTileUnload)===null||A===void 0||A.call(o,w)}if(e.size<=r&&this._cacheByteSize<=i)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((g,w)=>g.zoom-w.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),s=!1;return!i&&n?(i=new Eue(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),s=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(s=!0),i&&s&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function uce(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!DO(e)&&LS(e);for(const e of t)e.isVisible=!!(e.state&iv)}function cce(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&DO(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=!!(n.state&iv),n.children&&(n.isVisible||n.state&$k))for(const r of n.children)r.state=$k;else n.isSelected&&LS(n)}function DO(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=iv,!0;e=e.parent}return!1}function LS(t){for(const e of t.children)e.isLoaded||e.content?e.state|=iv:LS(e)}const hce={TilesetClass:Ace,data:{type:"data",value:[]},dataComparator:Que.equal,renderSubLayers:{type:"function",value:t=>new ns(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:kS,zRange:null,maxRequests:6,zoomOffset:0};class ff extends Ar{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,r;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(r=n.selectedTiles)===null||r===void 0?void 0:r.every(i=>i.isLoaded&&i.layers&&i.layers.every(s=>s.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:s,maxZoom:A,minZoom:o,maxRequests:g,zoomOffset:w}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:A,minZoom:o,tileSize:e,refinementStrategy:i,extent:s,maxRequests:g,zoomOffset:w,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:s}=e,A=this.state.isLoaded!==s,o=this.state.frameNumber!==i;s&&(A||o)&&this._onViewportLoad(),o&&this.setState({frameNumber:i}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?Zue(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const r=n.props.tile;return e.picked&&(e.tile=r),e.sourceTile=r,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const r of n.layers)r.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=of(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}}oe(ff,"defaultProps",hce);oe(ff,"layerName","TileLayer");const zw=Math.PI/180,$1=new Float32Array(16),jk=new Float32Array(12);function Hk(t,e,n){const r=e[0]*zw,i=e[1]*zw,s=e[2]*zw,A=Math.sin(s),o=Math.sin(r),g=Math.sin(i),w=Math.cos(s),C=Math.cos(r),I=Math.cos(i),k=n[0],U=n[1],H=n[2];t[0]=k*I*C,t[1]=k*g*C,t[2]=k*-o,t[3]=U*(-g*w+I*o*A),t[4]=U*(I*w+g*o*A),t[5]=U*C*A,t[6]=H*(g*A+I*o*w),t[7]=H*(-I*A+g*o*w),t[8]=H*C*w}function Wk(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const fce={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:s,getTranslation:A,getTransformMatrix:o}=this.props,g=Array.isArray(o),w=g&&o.length===16,C=Array.isArray(s),I=Array.isArray(i),k=Array.isArray(A),U=w||!g&&!!o(r[0]);U?t.constant=w:t.constant=I&&C&&k;const H=t.value;if(t.constant){let q;U?($1.set(o),q=Wk($1)):(q=jk,Hk(q,i,s),q.set(A,9)),t.value=new Float32Array(q)}else{let q=e*t.size;const{iterable:se,objectInfo:X}=Td(r,e,n);for(const te of se){X.index++;let ie;if(U)$1.set(w?o:o(te,X)),ie=Wk($1);else{ie=jk;const fe=I?i:i(te,X),me=C?s:s(te,X);Hk(ie,fe,me),ie.set(k?A:A(te,X),9)}H[q++]=ie[0],H[q++]=ie[1],H[q++]=ie[2],H[q++]=ie[3],H[q++]=ie[4],H[q++]=ie[5],H[q++]=ie[6],H[q++]=ie[7],H[q++]=ie[8],H[q++]=ie[9],H[q++]=ie[10],H[q++]=ie[11]}}}};function dce(t,e){return e===ar.CARTESIAN||e===ar.METER_OFFSETS||e===ar.DEFAULT&&!t.isGeospatial}const pce=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,gce=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function RO(t){let e=1/0,n=1/0,r=1/0,i=-1/0,s=-1/0,A=-1/0;const o=t.POSITION?t.POSITION.value:[],g=o&&o.length;for(let w=0;w<g;w+=3){const C=o[w],I=o[w+1],k=o[w+2];e=C<e?C:e,n=I<n?I:n,r=k<r?k:r,i=C>i?C:i,s=I>s?I:s,A=k>A?k:A}return[[e,n,r],[i,s,A]]}function mce(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class T0{constructor(e,n){oe(this,"fields",void 0),oe(this,"metadata",void 0),mce(Array.isArray(e)),yce(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const A of r)e[A]=!0;const s=this.fields.filter(A=>e[A.name]);return new T0(s,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n.map(s=>this.fields[s]).filter(Boolean);return new T0(i,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof T0){const A=e;n=A.fields,r=Qk(Qk(new Map,this.metadata),A.metadata)}else n=e;const i=Object.create(null);for(const A of this.fields)i[A.name]=A;for(const A of n)i[A.name]=A;const s=Object.values(i);return new T0(s,r)}}function yce(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function Qk(t,e){return new Map([...t||new Map,...e||new Map])}class rg{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;oe(this,"name",void 0),oe(this,"type",void 0),oe(this,"nullable",void 0),oe(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new rg(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let bi=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),BO,zO,OO;class DS{static isNull(e){return e&&e.typeId===bi.Null}static isInt(e){return e&&e.typeId===bi.Int}static isFloat(e){return e&&e.typeId===bi.Float}static isBinary(e){return e&&e.typeId===bi.Binary}static isUtf8(e){return e&&e.typeId===bi.Utf8}static isBool(e){return e&&e.typeId===bi.Bool}static isDecimal(e){return e&&e.typeId===bi.Decimal}static isDate(e){return e&&e.typeId===bi.Date}static isTime(e){return e&&e.typeId===bi.Time}static isTimestamp(e){return e&&e.typeId===bi.Timestamp}static isInterval(e){return e&&e.typeId===bi.Interval}static isList(e){return e&&e.typeId===bi.List}static isStruct(e){return e&&e.typeId===bi.Struct}static isUnion(e){return e&&e.typeId===bi.Union}static isFixedSizeBinary(e){return e&&e.typeId===bi.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===bi.FixedSizeList}static isMap(e){return e&&e.typeId===bi.Map}static isDictionary(e){return e&&e.typeId===bi.Dictionary}get typeId(){return bi.NONE}compareTo(e){return this===e}}BO=Symbol.toStringTag;class Id extends DS{constructor(e,n){super(),oe(this,"isSigned",void 0),oe(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return bi.Int}get[BO](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class _ce extends Id{constructor(){super(!0,8)}}class vce extends Id{constructor(){super(!0,16)}}class xce extends Id{constructor(){super(!0,32)}}class wce extends Id{constructor(){super(!1,8)}}class bce extends Id{constructor(){super(!1,16)}}class Ece extends Id{constructor(){super(!1,32)}}const FO={HALF:16,SINGLE:32,DOUBLE:64};zO=Symbol.toStringTag;class NO extends DS{constructor(e){super(),oe(this,"precision",void 0),this.precision=e}get typeId(){return bi.Float}get[zO](){return"Float"}toString(){return"Float".concat(this.precision)}}class Tce extends NO{constructor(){super(FO.SINGLE)}}class Sce extends NO{constructor(){super(FO.DOUBLE)}}OO=Symbol.toStringTag;class Mce extends DS{constructor(e,n){super(),oe(this,"listSize",void 0),oe(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return bi.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[OO](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function Cce(t){switch(t.constructor){case Int8Array:return new _ce;case Uint8Array:return new wce;case Int16Array:return new vce;case Uint16Array:return new bce;case Int32Array:return new xce;case Uint32Array:return new Ece;case Float32Array:return new Tce;case Float64Array:return new Sce;default:throw new Error("array type not supported")}}function qk(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),rr.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Zk(t,e){if(t.attributes)return qk(t.attributes,e),t instanceof Vu?t:new Vu(t);if(t.positions||t.POSITION)return qk(t,e),new Vu({attributes:t});throw Error("Invalid mesh")}const Pce=[0,0,0,255],Ice={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Pce},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class sv extends iA{constructor(...e){super(...e),oe(this,"state",void 0)}getShaders(){const e=!lr(this.context.gl),n={};return kR(this.context.gl,Yr.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:pce,fs:gce,modules:[Tf,XY,Sf],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:r}=this.props;if(!r)return null;if(n=(e=r.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:i}=Zk(r,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,n=RO(i)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:fce}),this.setState({emptyTexture:new oa(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){var s;if(this.state.positionBounds=null,(s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const A=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(A.NORMAL||A.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!s||dce(n,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new Yu(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:Zk(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return n.setUniforms({sampler:r||i,hasTexture:!!r}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:!!e})}}oe(sv,"defaultProps",Ice);oe(sv,"layerName","SimpleMeshLayer");const kce={inject:{"vs:#decl":`
attribute vec2 instanceDashArrays;
attribute float instanceDashOffsets;
varying vec2 vDashArray;
varying float vDashOffset;
`,"vs:#main-end":`
vDashArray = instanceDashArrays;
vDashOffset = instanceDashOffsets / width.x;
`,"fs:#decl":`
uniform float dashAlignMode;
uniform float capType;
uniform bool dashGapPickable;
varying vec2 vDashArray;
varying float vDashOffset;

float round(float x) {
  return floor(x + 0.5);
}
`,"fs:#main-start":`
  float solidLength = vDashArray.x;
  float gapLength = vDashArray.y;
  float unitLength = solidLength + gapLength;

  float offset;

  if (unitLength > 0.0) {
    if (dashAlignMode == 0.0) {
      offset = vDashOffset;
    } else {
      unitLength = vPathLength / round(vPathLength / unitLength);
      offset = solidLength / 2.0;
    }

    float unitOffset = mod(vPathPosition.y + offset, unitLength);

    if (gapLength > 0.0 && unitOffset > solidLength) {
      if (capType <= 0.5) {
        if (!(dashGapPickable && picking_uActive)) {
          discard;
        }
      } else {
        float distToEnd = length(vec2(
          min(unitOffset - solidLength, unitLength - unitOffset),
          vPathPosition.x
        ));
        if (distToEnd > 1.0) {
          if (!(dashGapPickable && picking_uActive)) {
            discard;
          }
        }
      }
    }
  }
`}},Lce={inject:{"vs:#decl":`
attribute float instanceOffsets;
`,"vs:DECKGL_FILTER_SIZE":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  size *= offsetWidth;
`,"vs:#main-end":`
  float offsetWidth = abs(instanceOffsets * 2.0) + 1.0;
  float offsetDir = sign(instanceOffsets);
  vPathPosition.x = (vPathPosition.x + offsetDir) * offsetWidth - offsetDir;
  vPathPosition.y *= offsetWidth;
  vPathLength *= offsetWidth;
`,"fs:#main-start":`
  float isInside;
  isInside = step(-1.0, vPathPosition.x) * step(vPathPosition.x, 1.0);
  if (isInside == 0.0) {
    discard;
  }
`}},Dce={getDashArray:{type:"accessor",value:[0,0]},getOffset:{type:"accessor",value:0},dashJustified:!1,dashGapPickable:!1};class ov extends iS{constructor({dash:e=!1,offset:n=!1,highPrecisionDash:r=!1}={}){super({dash:e||r,offset:n,highPrecisionDash:r})}isEnabled(e){return"pathTesselator"in e.state}getShaders(e){if(!e.isEnabled(this))return null;let n={};return e.opts.dash&&(n=S3(n,kce)),e.opts.offset&&(n=S3(n,Lce)),n}initializeState(e,n){const r=this.getAttributeManager();!r||!n.isEnabled(this)||(n.opts.dash&&r.addInstanced({instanceDashArrays:{size:2,accessor:"getDashArray"}}),n.opts.highPrecisionDash&&r.addInstanced({instanceDashOffsets:{size:1,accessor:"getPath",transform:n.getDashOffsets.bind(this)}}),n.opts.offset&&r.addInstanced({instanceOffsets:{size:1,accessor:"getOffset"}}))}updateState(e,n){if(!n.isEnabled(this))return;const r={};n.opts.dash&&(r.dashAlignMode=this.props.dashJustified?1:0,r.dashGapPickable=!!this.props.dashGapPickable),this.state.model.setUniforms(r)}getDashOffsets(e){const n=[0],r=this.props.positionFormat==="XY"?2:3,i=Array.isArray(e[0]),s=i?e.length:e.length/r;let A,o;for(let g=0;g<s-1;g++)A=i?e[g]:e.slice(g*r,g*r+r),A=this.projectPosition(A),g>0&&(n[g]=n[g-1]+VZ(o,A)),o=A;return n}}oe(ov,"defaultProps",Dce);oe(ov,"extensionName","PathStyleExtension");function UO(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Rce(t){return t.length===1&&(t=Bce(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function Bce(t){return function(e,n){return UO(t(e),n)}}Rce(UO);function Ng(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var Ow=Array.prototype.slice;function zce(t){return t}var Py=1,Iy=2,J3=3,j1=4,Yk=1e-6;function Oce(t){return"translate("+(t+.5)+",0)"}function Fce(t){return"translate(0,"+(t+.5)+")"}function Nce(t){return function(e){return+t(e)}}function Uce(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function Vce(){return!this.__axis}function RS(t,e){var n=[],r=null,i=null,s=6,A=6,o=3,g=t===Py||t===j1?-1:1,w=t===j1||t===Iy?"x":"y",C=t===Py||t===J3?Oce:Fce;function I(k){var U=r??(e.ticks?e.ticks.apply(e,n):e.domain()),H=i??(e.tickFormat?e.tickFormat.apply(e,n):zce),q=Math.max(s,0)+o,se=e.range(),X=+se[0]+.5,te=+se[se.length-1]+.5,ie=(e.bandwidth?Uce:Nce)(e.copy()),fe=k.selection?k.selection():k,me=fe.selectAll(".domain").data([null]),Se=fe.selectAll(".tick").data(U,e).order(),He=Se.exit(),Qe=Se.enter().append("g").attr("class","tick"),Ke=Se.select("line"),nt=Se.select("text");me=me.merge(me.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Se=Se.merge(Qe),Ke=Ke.merge(Qe.append("line").attr("stroke","currentColor").attr(w+"2",g*s)),nt=nt.merge(Qe.append("text").attr("fill","currentColor").attr(w,g*q).attr("dy",t===Py?"0em":t===J3?"0.71em":"0.32em")),k!==fe&&(me=me.transition(k),Se=Se.transition(k),Ke=Ke.transition(k),nt=nt.transition(k),He=He.transition(k).attr("opacity",Yk).attr("transform",function(Ne){return isFinite(Ne=ie(Ne))?C(Ne):this.getAttribute("transform")}),Qe.attr("opacity",Yk).attr("transform",function(Ne){var rt=this.parentNode.__axis;return C(rt&&isFinite(rt=rt(Ne))?rt:ie(Ne))})),He.remove(),me.attr("d",t===j1||t==Iy?A?"M"+g*A+","+X+"H0.5V"+te+"H"+g*A:"M0.5,"+X+"V"+te:A?"M"+X+","+g*A+"V0.5H"+te+"V"+g*A:"M"+X+",0.5H"+te),Se.attr("opacity",1).attr("transform",function(Ne){return C(ie(Ne))}),Ke.attr(w+"2",g*s),nt.attr(w,g*q).text(H),fe.filter(Vce).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Iy?"start":t===j1?"end":"middle"),fe.each(function(){this.__axis=ie})}return I.scale=function(k){return arguments.length?(e=k,I):e},I.ticks=function(){return n=Ow.call(arguments),I},I.tickArguments=function(k){return arguments.length?(n=k==null?[]:Ow.call(k),I):n.slice()},I.tickValues=function(k){return arguments.length?(r=k==null?null:Ow.call(k),I):r&&r.slice()},I.tickFormat=function(k){return arguments.length?(i=k,I):i},I.tickSize=function(k){return arguments.length?(s=A=+k,I):s},I.tickSizeInner=function(k){return arguments.length?(s=+k,I):s},I.tickSizeOuter=function(k){return arguments.length?(A=+k,I):A},I.tickPadding=function(k){return arguments.length?(o=+k,I):o},I}function Gce(t){return RS(Py,t)}function VO(t){return RS(Iy,t)}function $ce(t){return RS(J3,t)}var jce={value:function(){}};function GO(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ky(n)}function ky(t){this._=t}function Hce(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ky.prototype=GO.prototype={constructor:ky,on:function(t,e){var n=this._,r=Hce(t+"",n),i,s=-1,A=r.length;if(arguments.length<2){for(;++s<A;)if((i=(t=r[s]).type)&&(i=Wce(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<A;)if(i=(t=r[s]).type)n[i]=Xk(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Xk(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new ky(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function Wce(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Xk(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=jce,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var eE="http://www.w3.org/1999/xhtml";const Kk={svg:"http://www.w3.org/2000/svg",xhtml:eE,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function av(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Kk.hasOwnProperty(e)?{space:Kk[e],local:t}:t}function Qce(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===eE&&e.documentElement.namespaceURI===eE?e.createElement(t):e.createElementNS(n,t)}}function qce(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function $O(t){var e=av(t);return(e.local?qce:Qce)(e)}function Zce(){}function BS(t){return t==null?Zce:function(){return this.querySelector(t)}}function Yce(t){typeof t!="function"&&(t=BS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,o=r[i]=new Array(A),g,w,C=0;C<A;++C)(g=s[C])&&(w=t.call(g,g.__data__,C,s))&&("__data__"in g&&(w.__data__=g.__data__),o[C]=w);return new rA(r,this._parents)}function Xce(){return[]}function jO(t){return t==null?Xce:function(){return this.querySelectorAll(t)}}function Kce(t){typeof t!="function"&&(t=jO(t));for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var A=e[s],o=A.length,g,w=0;w<o;++w)(g=A[w])&&(r.push(t.call(g,g.__data__,w,A)),i.push(g));return new rA(r,i)}function HO(t){return function(){return this.matches(t)}}function Jce(t){typeof t!="function"&&(t=HO(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,o=r[i]=[],g,w=0;w<A;++w)(g=s[w])&&t.call(g,g.__data__,w,s)&&o.push(g);return new rA(r,this._parents)}function WO(t){return new Array(t.length)}function ehe(){return new rA(this._enter||this._groups.map(WO),this._parents)}function j_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}j_.prototype={constructor:j_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function the(t){return function(){return t}}var Jk="$";function nhe(t,e,n,r,i,s){for(var A=0,o,g=e.length,w=s.length;A<w;++A)(o=e[A])?(o.__data__=s[A],r[A]=o):n[A]=new j_(t,s[A]);for(;A<g;++A)(o=e[A])&&(i[A]=o)}function rhe(t,e,n,r,i,s,A){var o,g,w={},C=e.length,I=s.length,k=new Array(C),U;for(o=0;o<C;++o)(g=e[o])&&(k[o]=U=Jk+A.call(g,g.__data__,o,e),U in w?i[o]=g:w[U]=g);for(o=0;o<I;++o)U=Jk+A.call(t,s[o],o,s),(g=w[U])?(r[o]=g,g.__data__=s[o],w[U]=null):n[o]=new j_(t,s[o]);for(o=0;o<C;++o)(g=e[o])&&w[k[o]]===g&&(i[o]=g)}function ihe(t,e){if(!t)return U=new Array(this.size()),w=-1,this.each(function(Se){U[++w]=Se}),U;var n=e?rhe:nhe,r=this._parents,i=this._groups;typeof t!="function"&&(t=the(t));for(var s=i.length,A=new Array(s),o=new Array(s),g=new Array(s),w=0;w<s;++w){var C=r[w],I=i[w],k=I.length,U=t.call(C,C&&C.__data__,w,r),H=U.length,q=o[w]=new Array(H),se=A[w]=new Array(H),X=g[w]=new Array(k);n(C,I,q,se,X,U,e);for(var te=0,ie=0,fe,me;te<H;++te)if(fe=q[te]){for(te>=ie&&(ie=te+1);!(me=se[ie])&&++ie<H;);fe._next=me||null}}return A=new rA(A,r),A._enter=o,A._exit=g,A}function she(){return new rA(this._exit||this._groups.map(WO),this._parents)}function ohe(t,e,n){var r=this.enter(),i=this,s=this.exit();return r=typeof t=="function"?t(r):r.append(t+""),e!=null&&(i=e(i)),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function ahe(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),A=new Array(r),o=0;o<s;++o)for(var g=e[o],w=n[o],C=g.length,I=A[o]=new Array(C),k,U=0;U<C;++U)(k=g[U]||w[U])&&(I[U]=k);for(;o<r;++o)A[o]=e[o];return new rA(A,this._parents)}function lhe(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],A;--i>=0;)(A=r[i])&&(s&&A.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(A,s),s=A);return this}function Ahe(t){t||(t=uhe);function e(I,k){return I&&k?t(I.__data__,k.__data__):!I-!k}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var A=n[s],o=A.length,g=i[s]=new Array(o),w,C=0;C<o;++C)(w=A[C])&&(g[C]=w);g.sort(e)}return new rA(i,this._parents).order()}function uhe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function che(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function hhe(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t}function fhe(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var A=r[i];if(A)return A}return null}function dhe(){var t=0;return this.each(function(){++t}),t}function phe(){return!this.node()}function ghe(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,A=i.length,o;s<A;++s)(o=i[s])&&t.call(o,o.__data__,s,i);return this}function mhe(t){return function(){this.removeAttribute(t)}}function yhe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function _he(t,e){return function(){this.setAttribute(t,e)}}function vhe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function xhe(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function whe(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function bhe(t,e){var n=av(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?yhe:mhe:typeof e=="function"?n.local?whe:xhe:n.local?vhe:_he)(n,e))}function QO(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ehe(t){return function(){this.style.removeProperty(t)}}function The(t,e,n){return function(){this.style.setProperty(t,e,n)}}function She(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Mhe(t,e,n){return arguments.length>1?this.each((e==null?Ehe:typeof e=="function"?She:The)(t,e,n??"")):dd(this.node(),t)}function dd(t,e){return t.style.getPropertyValue(e)||QO(t).getComputedStyle(t,null).getPropertyValue(e)}function Che(t){return function(){delete this[t]}}function Phe(t,e){return function(){this[t]=e}}function Ihe(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function khe(t,e){return arguments.length>1?this.each((e==null?Che:typeof e=="function"?Ihe:Phe)(t,e)):this.node()[t]}function qO(t){return t.trim().split(/^|\s+/)}function zS(t){return t.classList||new ZO(t)}function ZO(t){this._node=t,this._names=qO(t.getAttribute("class")||"")}ZO.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function YO(t,e){for(var n=zS(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function XO(t,e){for(var n=zS(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Lhe(t){return function(){YO(this,t)}}function Dhe(t){return function(){XO(this,t)}}function Rhe(t,e){return function(){(e.apply(this,arguments)?YO:XO)(this,t)}}function Bhe(t,e){var n=qO(t+"");if(arguments.length<2){for(var r=zS(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?Rhe:e?Lhe:Dhe)(n,e))}function zhe(){this.textContent=""}function Ohe(t){return function(){this.textContent=t}}function Fhe(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Nhe(t){return arguments.length?this.each(t==null?zhe:(typeof t=="function"?Fhe:Ohe)(t)):this.node().textContent}function Uhe(){this.innerHTML=""}function Vhe(t){return function(){this.innerHTML=t}}function Ghe(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function $he(t){return arguments.length?this.each(t==null?Uhe:(typeof t=="function"?Ghe:Vhe)(t)):this.node().innerHTML}function jhe(){this.nextSibling&&this.parentNode.appendChild(this)}function Hhe(){return this.each(jhe)}function Whe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Qhe(){return this.each(Whe)}function qhe(t){var e=typeof t=="function"?t:$O(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Zhe(){return null}function Yhe(t,e){var n=typeof t=="function"?t:$O(t),r=e==null?Zhe:typeof e=="function"?e:BS(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Xhe(){var t=this.parentNode;t&&t.removeChild(this)}function Khe(){return this.each(Xhe)}function Jhe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function efe(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function tfe(t){return this.select(t?efe:Jhe)}function nfe(t){return arguments.length?this.property("__data__",t):this.node().__data__}var KO={};if(typeof document<"u"){var rfe=document.documentElement;"onmouseenter"in rfe||(KO={mouseenter:"mouseover",mouseleave:"mouseout"})}function ife(t,e,n){return t=JO(t,e,n),function(r){var i=r.relatedTarget;(!i||i!==this&&!(i.compareDocumentPosition(this)&8))&&t.call(this,r)}}function JO(t,e,n){return function(r){try{t.call(this,this.__data__,e,n)}finally{}}}function sfe(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function ofe(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.capture):e[++r]=s;++r?e.length=r:delete this.__on}}}function afe(t,e,n){var r=KO.hasOwnProperty(t.type)?ife:JO;return function(i,s,A){var o=this.__on,g,w=r(e,s,A);if(o){for(var C=0,I=o.length;C<I;++C)if((g=o[C]).type===t.type&&g.name===t.name){this.removeEventListener(g.type,g.listener,g.capture),this.addEventListener(g.type,g.listener=w,g.capture=n),g.value=e;return}}this.addEventListener(t.type,w,n),g={type:t.type,name:t.name,value:e,listener:w,capture:n},o?o.push(g):this.__on=[g]}}function lfe(t,e,n){var r=sfe(t+""),i,s=r.length,A;if(arguments.length<2){var o=this.node().__on;if(o){for(var g=0,w=o.length,C;g<w;++g)for(i=0,C=o[g];i<s;++i)if((A=r[i]).type===C.type&&A.name===C.name)return C.value}return}for(o=e?afe:ofe,n==null&&(n=!1),i=0;i<s;++i)this.each(o(r[i],e,n));return this}function eF(t,e,n){var r=QO(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Afe(t,e){return function(){return eF(this,t,e)}}function ufe(t,e){return function(){return eF(this,t,e.apply(this,arguments))}}function cfe(t,e){return this.each((typeof e=="function"?ufe:Afe)(t,e))}var hfe=[null];function rA(t,e){this._groups=t,this._parents=e}function _m(){return new rA([[document.documentElement]],hfe)}rA.prototype=_m.prototype={constructor:rA,select:Yce,selectAll:Kce,filter:Jce,data:ihe,enter:ehe,exit:she,join:ohe,merge:ahe,order:lhe,sort:Ahe,call:che,nodes:hhe,node:fhe,size:dhe,empty:phe,each:ghe,attr:bhe,style:Mhe,property:khe,classed:Bhe,text:Nhe,html:$he,raise:Hhe,lower:Qhe,append:qhe,insert:Yhe,remove:Khe,clone:tfe,datum:nfe,on:lfe,dispatch:cfe};function vm(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function lv(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Lf(){}var Ug=.7,H_=1/Ug,$0="\\s*([+-]?\\d+)\\s*",Vg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",UA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ffe=/^#([0-9a-f]{3,8})$/,dfe=new RegExp("^rgb\\("+[$0,$0,$0]+"\\)$"),pfe=new RegExp("^rgb\\("+[UA,UA,UA]+"\\)$"),gfe=new RegExp("^rgba\\("+[$0,$0,$0,Vg]+"\\)$"),mfe=new RegExp("^rgba\\("+[UA,UA,UA,Vg]+"\\)$"),yfe=new RegExp("^hsl\\("+[Vg,UA,UA]+"\\)$"),_fe=new RegExp("^hsla\\("+[Vg,UA,UA,Vg]+"\\)$"),e6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vm(Lf,df,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:t6,formatHex:t6,formatHsl:vfe,formatRgb:n6,toString:n6});function t6(){return this.rgb().formatHex()}function vfe(){return nF(this).formatHsl()}function n6(){return this.rgb().formatRgb()}function df(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ffe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?r6(e):n===3?new ko(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?H1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?H1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=dfe.exec(t))?new ko(e[1],e[2],e[3],1):(e=pfe.exec(t))?new ko(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=gfe.exec(t))?H1(e[1],e[2],e[3],e[4]):(e=mfe.exec(t))?H1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=yfe.exec(t))?o6(e[1],e[2]/100,e[3]/100,1):(e=_fe.exec(t))?o6(e[1],e[2]/100,e[3]/100,e[4]):e6.hasOwnProperty(t)?r6(e6[t]):t==="transparent"?new ko(NaN,NaN,NaN,0):null}function r6(t){return new ko(t>>16&255,t>>8&255,t&255,1)}function H1(t,e,n,r){return r<=0&&(t=e=n=NaN),new ko(t,e,n,r)}function tF(t){return t instanceof Lf||(t=df(t)),t?(t=t.rgb(),new ko(t.r,t.g,t.b,t.opacity)):new ko}function tE(t,e,n,r){return arguments.length===1?tF(t):new ko(t,e,n,r??1)}function ko(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}vm(ko,tE,lv(Lf,{brighter:function(t){return t=t==null?H_:Math.pow(H_,t),new ko(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?Ug:Math.pow(Ug,t),new ko(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:i6,formatHex:i6,formatRgb:s6,toString:s6}));function i6(){return"#"+Fw(this.r)+Fw(this.g)+Fw(this.b)}function s6(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function Fw(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function o6(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new kA(t,e,n,r)}function nF(t){if(t instanceof kA)return new kA(t.h,t.s,t.l,t.opacity);if(t instanceof Lf||(t=df(t)),!t)return new kA;if(t instanceof kA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),A=NaN,o=s-i,g=(s+i)/2;return o?(e===s?A=(n-r)/o+(n<r)*6:n===s?A=(r-e)/o+2:A=(e-n)/o+4,o/=g<.5?s+i:2-s-i,A*=60):o=g>0&&g<1?0:A,new kA(A,o,g,t.opacity)}function nE(t,e,n,r){return arguments.length===1?nF(t):new kA(t,e,n,r??1)}function kA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}vm(kA,nE,lv(Lf,{brighter:function(t){return t=t==null?H_:Math.pow(H_,t),new kA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?Ug:Math.pow(Ug,t),new kA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new ko(Nw(t>=240?t-240:t+120,i,r),Nw(t,i,r),Nw(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function Nw(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var xfe=Math.PI/180,wfe=180/Math.PI,W_=18,rF=.96422,iF=1,sF=.82521,oF=4/29,j0=6/29,aF=3*j0*j0,bfe=j0*j0*j0;function lF(t){if(t instanceof VA)return new VA(t.l,t.a,t.b,t.opacity);if(t instanceof zu)return AF(t);t instanceof ko||(t=tF(t));var e=$w(t.r),n=$w(t.g),r=$w(t.b),i=Uw((.2225045*e+.7168786*n+.0606169*r)/iF),s,A;return e===n&&n===r?s=A=i:(s=Uw((.4360747*e+.3850649*n+.1430804*r)/rF),A=Uw((.0139322*e+.0971045*n+.7141733*r)/sF)),new VA(116*i-16,500*(s-i),200*(i-A),t.opacity)}function Gg(t,e,n,r){return arguments.length===1?lF(t):new VA(t,e,n,r??1)}function VA(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}vm(VA,Gg,lv(Lf,{brighter:function(t){return new VA(this.l+W_*(t??1),this.a,this.b,this.opacity)},darker:function(t){return new VA(this.l-W_*(t??1),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=rF*Vw(e),t=iF*Vw(t),n=sF*Vw(n),new ko(Gw(3.1338561*e-1.6168667*t-.4906146*n),Gw(-.9787684*e+1.9161415*t+.033454*n),Gw(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function Uw(t){return t>bfe?Math.pow(t,1/3):t/aF+oF}function Vw(t){return t>j0?t*t*t:aF*(t-oF)}function Gw(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function $w(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Efe(t){if(t instanceof zu)return new zu(t.h,t.c,t.l,t.opacity);if(t instanceof VA||(t=lF(t)),t.a===0&&t.b===0)return new zu(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*wfe;return new zu(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Tfe(t,e,n,r){return arguments.length===1?Efe(t):new zu(t,e,n,r??1)}function zu(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function AF(t){if(isNaN(t.h))return new VA(t.l,0,0,t.opacity);var e=t.h*xfe;return new VA(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}vm(zu,Tfe,lv(Lf,{brighter:function(t){return new zu(this.h,this.c,this.l+W_*(t??1),this.opacity)},darker:function(t){return new zu(this.h,this.c,this.l-W_*(t??1),this.opacity)},rgb:function(){return AF(this).rgb()}}));function uF(t){return function(){return t}}function Sfe(t,e){return function(n){return t+n*e}}function Mfe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Cfe(t){return(t=+t)==1?S0:function(e,n){return n-e?Mfe(e,n,t):uF(isNaN(e)?n:e)}}function S0(t,e){var n=e-t;return n?Sfe(t,n):uF(isNaN(t)?e:t)}const a6=function t(e){var n=Cfe(e);function r(i,s){var A=n((i=tE(i)).r,(s=tE(s)).r),o=n(i.g,s.g),g=n(i.b,s.b),w=S0(i.opacity,s.opacity);return function(C){return i.r=A(C),i.g=o(C),i.b=g(C),i.opacity=w(C),i+""}}return r.gamma=t,r}(1);function zc(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var rE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jw=new RegExp(rE.source,"g");function Pfe(t){return function(){return t}}function Ife(t){return function(e){return t(e)+""}}function kfe(t,e){var n=rE.lastIndex=jw.lastIndex=0,r,i,s,A=-1,o=[],g=[];for(t=t+"",e=e+"";(r=rE.exec(t))&&(i=jw.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[A]?o[A]+=s:o[++A]=s),(r=r[0])===(i=i[0])?o[A]?o[A]+=i:o[++A]=i:(o[++A]=null,g.push({i:A,x:zc(r,i)})),n=jw.lastIndex;return n<e.length&&(s=e.slice(n),o[A]?o[A]+=s:o[++A]=s),o.length<2?g[0]?Ife(g[0].x):Pfe(e):(e=g.length,function(w){for(var C=0,I;C<e;++C)o[(I=g[C]).i]=I.x(w);return o.join("")})}var l6=180/Math.PI,iE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function cF(t,e,n,r,i,s){var A,o,g;return(A=Math.sqrt(t*t+e*e))&&(t/=A,e/=A),(g=t*n+e*r)&&(n-=t*g,r-=e*g),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,g/=o),t*r<e*n&&(t=-t,e=-e,g=-g,A=-A),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*l6,skewX:Math.atan(g)*l6,scaleX:A,scaleY:o}}var _p,Hw,A6,W1;function Lfe(t){return t==="none"?iE:(_p||(_p=document.createElement("DIV"),Hw=document.documentElement,A6=document.defaultView),_p.style.transform=t,t=A6.getComputedStyle(Hw.appendChild(_p),null).getPropertyValue("transform"),Hw.removeChild(_p),t=t.slice(7,-1).split(","),cF(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}function Dfe(t){return t==null||(W1||(W1=document.createElementNS("http://www.w3.org/2000/svg","g")),W1.setAttribute("transform",t),!(t=W1.transform.baseVal.consolidate()))?iE:(t=t.matrix,cF(t.a,t.b,t.c,t.d,t.e,t.f))}function hF(t,e,n,r){function i(w){return w.length?w.pop()+" ":""}function s(w,C,I,k,U,H){if(w!==I||C!==k){var q=U.push("translate(",null,e,null,n);H.push({i:q-4,x:zc(w,I)},{i:q-2,x:zc(C,k)})}else(I||k)&&U.push("translate("+I+e+k+n)}function A(w,C,I,k){w!==C?(w-C>180?C+=360:C-w>180&&(w+=360),k.push({i:I.push(i(I)+"rotate(",null,r)-2,x:zc(w,C)})):C&&I.push(i(I)+"rotate("+C+r)}function o(w,C,I,k){w!==C?k.push({i:I.push(i(I)+"skewX(",null,r)-2,x:zc(w,C)}):C&&I.push(i(I)+"skewX("+C+r)}function g(w,C,I,k,U,H){if(w!==I||C!==k){var q=U.push(i(U)+"scale(",null,",",null,")");H.push({i:q-4,x:zc(w,I)},{i:q-2,x:zc(C,k)})}else(I!==1||k!==1)&&U.push(i(U)+"scale("+I+","+k+")")}return function(w,C){var I=[],k=[];return w=t(w),C=t(C),s(w.translateX,w.translateY,C.translateX,C.translateY,I,k),A(w.rotate,C.rotate,I,k),o(w.skewX,C.skewX,I,k),g(w.scaleX,w.scaleY,C.scaleX,C.scaleY,I,k),w=C=null,function(U){for(var H=-1,q=k.length,se;++H<q;)I[(se=k[H]).i]=se.x(U);return I.join("")}}}var Rfe=hF(Lfe,"px, ","px)","deg)"),Bfe=hF(Dfe,", ",")",")");function zfe(t,e){var n=S0((t=Gg(t)).l,(e=Gg(e)).l),r=S0(t.a,e.a),i=S0(t.b,e.b),s=S0(t.opacity,e.opacity);return function(A){return t.l=n(A),t.a=r(A),t.b=i(A),t.opacity=s(A),t+""}}var pd=0,Fp=0,vp=0,fF=1e3,Q_,Np,q_=0,pf=0,Av=0,$g=typeof performance=="object"&&performance.now?performance:Date,dF=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function uv(){return pf||(dF(Ofe),pf=$g.now()+Av)}function Ofe(){pf=0}function Z_(){this._call=this._time=this._next=null}Z_.prototype=pF.prototype={constructor:Z_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?uv():+n)+(e==null?0:+e),!this._next&&Np!==this&&(Np?Np._next=this:Q_=this,Np=this),this._call=t,this._time=n,sE()},stop:function(){this._call&&(this._call=null,this._time=1/0,sE())}};function pF(t,e,n){var r=new Z_;return r.restart(t,e,n),r}function Ffe(){uv(),++pd;for(var t=Q_,e;t;)(e=pf-t._time)>=0&&t._call.call(null,e),t=t._next;--pd}function u6(){pf=(q_=$g.now())+Av,pd=Fp=0;try{Ffe()}finally{pd=0,Ufe(),pf=0}}function Nfe(){var t=$g.now(),e=t-q_;e>fF&&(Av-=e,q_=t)}function Ufe(){for(var t,e=Q_,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Q_=n);Np=t,sE(r)}function sE(t){if(!pd){Fp&&(Fp=clearTimeout(Fp));var e=t-pf;e>24?(t<1/0&&(Fp=setTimeout(u6,t-$g.now()-Av)),vp&&(vp=clearInterval(vp))):(vp||(q_=$g.now(),vp=setInterval(Nfe,fF)),pd=1,dF(u6))}}function c6(t,e,n){var r=new Z_;return e=e==null?0:+e,r.restart(function(i){r.stop(),t(i+e)},e,n),r}var Vfe=GO("start","end","cancel","interrupt"),Gfe=[],gF=0,h6=1,oE=2,Ly=3,f6=4,aE=5,Dy=6;function cv(t,e,n,r,i,s){var A=t.__transition;if(!A)t.__transition={};else if(n in A)return;$fe(t,n,{name:e,index:r,group:i,on:Vfe,tween:Gfe,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:gF})}function OS(t,e){var n=oA(t,e);if(n.state>gF)throw new Error("too late; already scheduled");return n}function ac(t,e){var n=oA(t,e);if(n.state>Ly)throw new Error("too late; already running");return n}function oA(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function $fe(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=pF(s,0,n.time);function s(w){n.state=h6,n.timer.restart(A,n.delay,n.time),n.delay<=w&&A(w-n.delay)}function A(w){var C,I,k,U;if(n.state!==h6)return g();for(C in r)if(U=r[C],U.name===n.name){if(U.state===Ly)return c6(A);U.state===f6?(U.state=Dy,U.timer.stop(),U.on.call("interrupt",t,t.__data__,U.index,U.group),delete r[C]):+C<e&&(U.state=Dy,U.timer.stop(),U.on.call("cancel",t,t.__data__,U.index,U.group),delete r[C])}if(c6(function(){n.state===Ly&&(n.state=f6,n.timer.restart(o,n.delay,n.time),o(w))}),n.state=oE,n.on.call("start",t,t.__data__,n.index,n.group),n.state===oE){for(n.state=Ly,i=new Array(k=n.tween.length),C=0,I=-1;C<k;++C)(U=n.tween[C].value.call(t,t.__data__,n.index,n.group))&&(i[++I]=U);i.length=I+1}}function o(w){for(var C=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(g),n.state=aE,1),I=-1,k=i.length;++I<k;)i[I].call(t,C);n.state===aE&&(n.on.call("end",t,t.__data__,n.index,n.group),g())}function g(){n.state=Dy,n.timer.stop(),delete r[e];for(var w in r)return;delete t.__transition}}function jfe(t,e){var n=t.__transition,r,i,s=!0,A;if(n){e=e==null?null:e+"";for(A in n){if((r=n[A]).name!==e){s=!1;continue}i=r.state>oE&&r.state<aE,r.state=Dy,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[A]}s&&delete t.__transition}}function Hfe(t){return this.each(function(){jfe(this,t)})}function Wfe(t,e){var n,r;return function(){var i=ac(this,t),s=i.tween;if(s!==n){r=n=s;for(var A=0,o=r.length;A<o;++A)if(r[A].name===e){r=r.slice(),r.splice(A,1);break}}i.tween=r}}function Qfe(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=ac(this,t),A=s.tween;if(A!==r){i=(r=A).slice();for(var o={name:e,value:n},g=0,w=i.length;g<w;++g)if(i[g].name===e){i[g]=o;break}g===w&&i.push(o)}s.tween=i}}function qfe(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=oA(this.node(),n).tween,i=0,s=r.length,A;i<s;++i)if((A=r[i]).name===t)return A.value;return null}return this.each((e==null?Wfe:Qfe)(n,t,e))}function FS(t,e,n){var r=t._id;return t.each(function(){var i=ac(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return oA(i,r).value[e]}}function mF(t,e){var n;return(typeof e=="number"?zc:e instanceof df?a6:(n=df(e))?(e=n,a6):kfe)(t,e)}function Zfe(t){return function(){this.removeAttribute(t)}}function Yfe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Xfe(t,e,n){var r,i=n+"",s;return function(){var A=this.getAttribute(t);return A===i?null:A===r?s:s=e(r=A,n)}}function Kfe(t,e,n){var r,i=n+"",s;return function(){var A=this.getAttributeNS(t.space,t.local);return A===i?null:A===r?s:s=e(r=A,n)}}function Jfe(t,e,n){var r,i,s;return function(){var A,o=n(this),g;return o==null?void this.removeAttribute(t):(A=this.getAttribute(t),g=o+"",A===g?null:A===r&&g===i?s:(i=g,s=e(r=A,o)))}}function e0e(t,e,n){var r,i,s;return function(){var A,o=n(this),g;return o==null?void this.removeAttributeNS(t.space,t.local):(A=this.getAttributeNS(t.space,t.local),g=o+"",A===g?null:A===r&&g===i?s:(i=g,s=e(r=A,o)))}}function t0e(t,e){var n=av(t),r=n==="transform"?Bfe:mF;return this.attrTween(t,typeof e=="function"?(n.local?e0e:Jfe)(n,r,FS(this,"attr."+t,e)):e==null?(n.local?Yfe:Zfe)(n):(n.local?Kfe:Xfe)(n,r,e))}function n0e(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function r0e(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function i0e(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&r0e(t,s)),n}return i._value=e,i}function s0e(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&n0e(t,s)),n}return i._value=e,i}function o0e(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=av(t);return this.tween(n,(r.local?i0e:s0e)(r,e))}function a0e(t,e){return function(){OS(this,t).delay=+e.apply(this,arguments)}}function l0e(t,e){return e=+e,function(){OS(this,t).delay=e}}function A0e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?a0e:l0e)(e,t)):oA(this.node(),e).delay}function u0e(t,e){return function(){ac(this,t).duration=+e.apply(this,arguments)}}function c0e(t,e){return e=+e,function(){ac(this,t).duration=e}}function h0e(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?u0e:c0e)(e,t)):oA(this.node(),e).duration}function f0e(t,e){if(typeof e!="function")throw new Error;return function(){ac(this,t).ease=e}}function d0e(t){var e=this._id;return arguments.length?this.each(f0e(e,t)):oA(this.node(),e).ease}function p0e(t){typeof t!="function"&&(t=HO(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],A=s.length,o=r[i]=[],g,w=0;w<A;++w)(g=s[w])&&t.call(g,g.__data__,w,s)&&o.push(g);return new rc(r,this._parents,this._name,this._id)}function g0e(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),A=new Array(r),o=0;o<s;++o)for(var g=e[o],w=n[o],C=g.length,I=A[o]=new Array(C),k,U=0;U<C;++U)(k=g[U]||w[U])&&(I[U]=k);for(;o<r;++o)A[o]=e[o];return new rc(A,this._parents,this._name,this._id)}function m0e(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function y0e(t,e,n){var r,i,s=m0e(e)?OS:ac;return function(){var A=s(this,t),o=A.on;o!==r&&(i=(r=o).copy()).on(e,n),A.on=i}}function _0e(t,e){var n=this._id;return arguments.length<2?oA(this.node(),n).on.on(t):this.each(y0e(n,t,e))}function v0e(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function x0e(){return this.on("end.remove",v0e(this._id))}function w0e(t){var e=this._name,n=this._id;typeof t!="function"&&(t=BS(t));for(var r=this._groups,i=r.length,s=new Array(i),A=0;A<i;++A)for(var o=r[A],g=o.length,w=s[A]=new Array(g),C,I,k=0;k<g;++k)(C=o[k])&&(I=t.call(C,C.__data__,k,o))&&("__data__"in C&&(I.__data__=C.__data__),w[k]=I,cv(w[k],e,n,k,w,oA(C,n)));return new rc(s,this._parents,e,n)}function b0e(t){var e=this._name,n=this._id;typeof t!="function"&&(t=jO(t));for(var r=this._groups,i=r.length,s=[],A=[],o=0;o<i;++o)for(var g=r[o],w=g.length,C,I=0;I<w;++I)if(C=g[I]){for(var k=t.call(C,C.__data__,I,g),U,H=oA(C,n),q=0,se=k.length;q<se;++q)(U=k[q])&&cv(U,e,n,q,k,H);s.push(k),A.push(C)}return new rc(s,A,e,n)}var E0e=_m.prototype.constructor;function T0e(){return new E0e(this._groups,this._parents)}function S0e(t,e){var n,r,i;return function(){var s=dd(this,t),A=(this.style.removeProperty(t),dd(this,t));return s===A?null:s===n&&A===r?i:i=e(n=s,r=A)}}function yF(t){return function(){this.style.removeProperty(t)}}function M0e(t,e,n){var r,i=n+"",s;return function(){var A=dd(this,t);return A===i?null:A===r?s:s=e(r=A,n)}}function C0e(t,e,n){var r,i,s;return function(){var A=dd(this,t),o=n(this),g=o+"";return o==null&&(g=o=(this.style.removeProperty(t),dd(this,t))),A===g?null:A===r&&g===i?s:(i=g,s=e(r=A,o))}}function P0e(t,e){var n,r,i,s="style."+e,A="end."+s,o;return function(){var g=ac(this,t),w=g.on,C=g.value[s]==null?o||(o=yF(e)):void 0;(w!==n||i!==C)&&(r=(n=w).copy()).on(A,i=C),g.on=r}}function I0e(t,e,n){var r=(t+="")=="transform"?Rfe:mF;return e==null?this.styleTween(t,S0e(t,r)).on("end.style."+t,yF(t)):typeof e=="function"?this.styleTween(t,C0e(t,r,FS(this,"style."+t,e))).each(P0e(this._id,t)):this.styleTween(t,M0e(t,r,e),n).on("end.style."+t,null)}function k0e(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function L0e(t,e,n){var r,i;function s(){var A=e.apply(this,arguments);return A!==i&&(r=(i=A)&&k0e(t,A,n)),r}return s._value=e,s}function D0e(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,L0e(t,e,n??""))}function R0e(t){return function(){this.textContent=t}}function B0e(t){return function(){var e=t(this);this.textContent=e??""}}function z0e(t){return this.tween("text",typeof t=="function"?B0e(FS(this,"text",t)):R0e(t==null?"":t+""))}function O0e(t){return function(e){this.textContent=t.call(this,e)}}function F0e(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&O0e(i)),e}return r._value=t,r}function N0e(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,F0e(t))}function U0e(){for(var t=this._name,e=this._id,n=_F(),r=this._groups,i=r.length,s=0;s<i;++s)for(var A=r[s],o=A.length,g,w=0;w<o;++w)if(g=A[w]){var C=oA(g,e);cv(g,t,n,w,A,{time:C.time+C.delay+C.duration,delay:0,duration:C.duration,ease:C.ease})}return new rc(r,this._parents,t,n)}function V0e(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,A){var o={value:A},g={value:function(){--i===0&&s()}};n.each(function(){var w=ac(this,r),C=w.on;C!==t&&(e=(t=C).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(g)),w.on=e})})}var G0e=0;function rc(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function _F(){return++G0e}var n0=_m.prototype;rc.prototype={constructor:rc,select:w0e,selectAll:b0e,filter:p0e,merge:g0e,selection:T0e,transition:U0e,call:n0.call,nodes:n0.nodes,node:n0.node,size:n0.size,empty:n0.empty,each:n0.each,on:_0e,attr:t0e,attrTween:o0e,style:I0e,styleTween:D0e,text:z0e,textTween:N0e,remove:x0e,tween:qfe,delay:A0e,duration:h0e,ease:d0e,end:V0e};function $0e(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var lE={time:null,delay:0,duration:250,ease:$0e};function j0e(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return lE.time=uv(),lE;return n}function H0e(t){var e,n;t instanceof rc?(e=t._id,t=t._name):(e=_F(),(n=lE).time=uv(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var A=r[s],o=A.length,g,w=0;w<o;++w)(g=A[w])&&cv(g,t,e,w,A,n||j0e(g,e));return new rc(r,this._parents,t,e)}_m.prototype.interrupt=Hfe;_m.prototype.transition=H0e;var AE=Math.PI,uE=2*AE,Oh=1e-6,W0e=uE-Oh;function cE(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function vF(){return new cE}cE.prototype=vF.prototype={constructor:cE,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,s){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+s)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var s=this._x1,A=this._y1,o=n-t,g=r-e,w=s-t,C=A-e,I=w*w+C*C;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(I>Oh)if(!(Math.abs(C*o-g*w)>Oh)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var k=n-s,U=r-A,H=o*o+g*g,q=k*k+U*U,se=Math.sqrt(H),X=Math.sqrt(I),te=i*Math.tan((AE-Math.acos((H+I-q)/(2*se*X)))/2),ie=te/X,fe=te/se;Math.abs(ie-1)>Oh&&(this._+="L"+(t+ie*w)+","+(e+ie*C)),this._+="A"+i+","+i+",0,0,"+ +(C*k>w*U)+","+(this._x1=t+fe*o)+","+(this._y1=e+fe*g)}},arc:function(t,e,n,r,i,s){t=+t,e=+e,n=+n,s=!!s;var A=n*Math.cos(r),o=n*Math.sin(r),g=t+A,w=e+o,C=1^s,I=s?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+g+","+w:(Math.abs(this._x1-g)>Oh||Math.abs(this._y1-w)>Oh)&&(this._+="L"+g+","+w),n&&(I<0&&(I=I%uE+uE),I>W0e?this._+="A"+n+","+n+",0,1,"+C+","+(t-A)+","+(e-o)+"A"+n+","+n+",0,1,"+C+","+(this._x1=g)+","+(this._y1=w):I>Oh&&(this._+="A"+n+","+n+",0,"+ +(I>=AE)+","+C+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var el="$";function Y_(){}Y_.prototype=X_.prototype={constructor:Y_,has:function(t){return el+t in this},get:function(t){return this[el+t]},set:function(t,e){return this[el+t]=e,this},remove:function(t){var e=el+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===el&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===el&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===el&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===el&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===el&&++t;return t},empty:function(){for(var t in this)if(t[0]===el)return!1;return!0},each:function(t){for(var e in this)e[0]===el&&t(this[e],e.slice(1),this)}};function X_(t,e){var n=new Y_;if(t instanceof Y_)t.each(function(o,g){n.set(g,o)});else if(Array.isArray(t)){var r=-1,i=t.length,s;if(e==null)for(;++r<i;)n.set(r,t[r]);else for(;++r<i;)n.set(e(s=t[r],r,t),s)}else if(t)for(var A in t)n.set(A,t[A]);return n}function d6(){}var Ih=X_.prototype;d6.prototype={constructor:d6,has:Ih.has,add:function(t){return t+="",this[el+t]=t,this},remove:Ih.remove,clear:Ih.clear,values:Ih.keys,size:Ih.size,empty:Ih.empty,each:Ih.each};function Q0e(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function K_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function q0e(t){return t=K_(Math.abs(t)),t?t[1]:NaN}function Z0e(t,e){return function(n,r){for(var i=n.length,s=[],A=0,o=t[0],g=0;i>0&&o>0&&(g+o+1>r&&(o=Math.max(1,r-g)),s.push(n.substring(i-=o,i+o)),!((g+=o+1)>r));)o=t[A=(A+1)%t.length];return s.reverse().join(e)}}function Y0e(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var X0e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hE(t){if(!(e=X0e.exec(t)))throw new Error("invalid format: "+t);var e;return new NS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}hE.prototype=NS.prototype;function NS(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}NS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function K0e(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var xF;function J0e(t,e){var n=K_(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(xF=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,A=r.length;return s===A?r:s>A?r+new Array(s-A+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+K_(t,Math.max(0,e+s-1))[0]}function p6(t,e){var n=K_(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const g6={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Q0e,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return p6(t*100,e)},r:p6,s:J0e,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function m6(t){return t}var y6=Array.prototype.map,_6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ede(t){var e=t.grouping===void 0||t.thousands===void 0?m6:Z0e(y6.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?m6:Y0e(y6.call(t.numerals,String)),A=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",g=t.nan===void 0?"NaN":t.nan+"";function w(I){I=hE(I);var k=I.fill,U=I.align,H=I.sign,q=I.symbol,se=I.zero,X=I.width,te=I.comma,ie=I.precision,fe=I.trim,me=I.type;me==="n"?(te=!0,me="g"):g6[me]||(ie===void 0&&(ie=12),fe=!0,me="g"),(se||k==="0"&&U==="=")&&(se=!0,k="0",U="=");var Se=q==="$"?n:q==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",He=q==="$"?r:/[%p]/.test(me)?A:"",Qe=g6[me],Ke=/[defgprs%]/.test(me);ie=ie===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,ie)):Math.max(0,Math.min(20,ie));function nt(Ne){var rt=Se,Ze=He,mt,Kt,Tt;if(me==="c")Ze=Qe(Ne)+Ze,Ne="";else{Ne=+Ne;var dn=Ne<0||1/Ne<0;if(Ne=isNaN(Ne)?g:Qe(Math.abs(Ne),ie),fe&&(Ne=K0e(Ne)),dn&&+Ne==0&&H!=="+"&&(dn=!1),rt=(dn?H==="("?H:o:H==="-"||H==="("?"":H)+rt,Ze=(me==="s"?_6[8+xF/3]:"")+Ze+(dn&&H==="("?")":""),Ke){for(mt=-1,Kt=Ne.length;++mt<Kt;)if(Tt=Ne.charCodeAt(mt),48>Tt||Tt>57){Ze=(Tt===46?i+Ne.slice(mt+1):Ne.slice(mt))+Ze,Ne=Ne.slice(0,mt);break}}}te&&!se&&(Ne=e(Ne,1/0));var _t=rt.length+Ne.length+Ze.length,Et=_t<X?new Array(X-_t+1).join(k):"";switch(te&&se&&(Ne=e(Et+Ne,Et.length?X-Ze.length:1/0),Et=""),U){case"<":Ne=rt+Ne+Ze+Et;break;case"=":Ne=rt+Et+Ne+Ze;break;case"^":Ne=Et.slice(0,_t=Et.length>>1)+rt+Ne+Ze+Et.slice(_t);break;default:Ne=Et+rt+Ne+Ze;break}return s(Ne)}return nt.toString=function(){return I+""},nt}function C(I,k){var U=w((I=hE(I),I.type="f",I)),H=Math.max(-8,Math.min(8,Math.floor(q0e(k)/3)))*3,q=Math.pow(10,-H),se=_6[8+H/3];return function(X){return U(q*X)+se}}return{format:w,formatPrefix:C}}var Q1,gd;tde({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function tde(t){return Q1=ede(t),gd=Q1.format,Q1.formatPrefix,Q1}function kd(){return Math.random()}(function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,arguments.length===1?(i=r,r=0):i-=r,function(){return e()*i+r}}return n.source=t,n})(kd);const nde=function t(e){function n(r,i){var s,A;return r=r==null?0:+r,i=i==null?1:+i,function(){var o;if(s!=null)o=s,s=null;else do s=e()*2-1,o=e()*2-1,A=s*s+o*o;while(!A||A>1);return r+i*o*Math.sqrt(-2*Math.log(A)/A)}}return n.source=t,n}(kd);(function t(e){function n(){var r=nde.source(e).apply(this,arguments);return function(){return Math.exp(r())}}return n.source=t,n})(kd);const rde=function t(e){function n(r){return function(){for(var i=0,s=0;s<r;++s)i+=e();return i}}return n.source=t,n}(kd);(function t(e){function n(r){var i=rde.source(e)(r);return function(){return i()/r}}return n.source=t,n})(kd);(function t(e){function n(r){return function(){return-Math.log(1-e())/r}}return n.source=t,n})(kd);function wF(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ide(t){return t.length===1&&(t=sde(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function sde(t){return function(e,n){return wF(t(e),n)}}var ode=ide(wF),ade=ode.right;function lde(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var fE=Math.sqrt(50),dE=Math.sqrt(10),pE=Math.sqrt(2);function Ade(t,e,n){var r,i=-1,s,A,o;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(s=t,t=e,e=s),(o=Ry(t,e,n))===0||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),A=new Array(s=Math.ceil(e-t+1));++i<s;)A[i]=(t+i)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),A=new Array(s=Math.ceil(t-e+1));++i<s;)A[i]=(t-i)/o;return r&&A.reverse(),A}function Ry(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=fE?10:s>=dE?5:s>=pE?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=fE?10:s>=dE?5:s>=pE?2:1)}function ude(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=fE?i*=10:s>=dE?i*=5:s>=pE&&(i*=2),e<t?-i:i}function US(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var bF=Array.prototype,cde=bF.map,gE=bF.slice,v6={name:"implicit"};function EF(){var t=X_(),e=[],n=[],r=v6;function i(s){var A=s+"",o=t.get(A);if(!o){if(r!==v6)return r;t.set(A,o=e.push(s))}return n[(o-1)%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=X_();for(var A=-1,o=s.length,g,w;++A<o;)t.has(w=(g=s[A])+"")||t.set(w,e.push(g));return i},i.range=function(s){return arguments.length?(n=gE.call(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return EF(e,n).unknown(r)},US.apply(i,arguments),i}function TF(){var t=EF().unknown(void 0),e=t.domain,n=t.range,r=[0,1],i,s,A=!1,o=0,g=0,w=.5;delete t.unknown;function C(){var I=e().length,k=r[1]<r[0],U=r[k-0],H=r[1-k];i=(H-U)/Math.max(1,I-o+g*2),A&&(i=Math.floor(i)),U+=(H-U-i*(I-o))*w,s=i*(1-o),A&&(U=Math.round(U),s=Math.round(s));var q=lde(I).map(function(se){return U+i*se});return n(k?q.reverse():q)}return t.domain=function(I){return arguments.length?(e(I),C()):e()},t.range=function(I){return arguments.length?(r=[+I[0],+I[1]],C()):r.slice()},t.rangeRound=function(I){return r=[+I[0],+I[1]],A=!0,C()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(I){return arguments.length?(A=!!I,C()):A},t.padding=function(I){return arguments.length?(o=Math.min(1,g=+I),C()):o},t.paddingInner=function(I){return arguments.length?(o=Math.min(1,I),C()):o},t.paddingOuter=function(I){return arguments.length?(g=+I,C()):g},t.align=function(I){return arguments.length?(w=Math.max(0,Math.min(1,I)),C()):w},t.copy=function(){return TF(e(),r).round(A).paddingInner(o).paddingOuter(g).align(w)},US.apply(C(),arguments)}function SF(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return SF(e())},t}function J_(){return SF(TF.apply(null,arguments).paddingInner(1))}function VS(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function MF(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function xm(){}var jg=.7,e2=1/jg,H0="\\s*([+-]?\\d+)\\s*",Hg="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",GA="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",hde=/^#([0-9a-f]{3,8})$/,fde=new RegExp("^rgb\\("+[H0,H0,H0]+"\\)$"),dde=new RegExp("^rgb\\("+[GA,GA,GA]+"\\)$"),pde=new RegExp("^rgba\\("+[H0,H0,H0,Hg]+"\\)$"),gde=new RegExp("^rgba\\("+[GA,GA,GA,Hg]+"\\)$"),mde=new RegExp("^hsl\\("+[Hg,GA,GA]+"\\)$"),yde=new RegExp("^hsla\\("+[Hg,GA,GA,Hg]+"\\)$"),x6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};VS(xm,Wg,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:w6,formatHex:w6,formatHsl:_de,formatRgb:b6,toString:b6});function w6(){return this.rgb().formatHex()}function _de(){return CF(this).formatHsl()}function b6(){return this.rgb().formatRgb()}function Wg(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=hde.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?E6(e):n===3?new Ia(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?q1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?q1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=fde.exec(t))?new Ia(e[1],e[2],e[3],1):(e=dde.exec(t))?new Ia(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=pde.exec(t))?q1(e[1],e[2],e[3],e[4]):(e=gde.exec(t))?q1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=mde.exec(t))?M6(e[1],e[2]/100,e[3]/100,1):(e=yde.exec(t))?M6(e[1],e[2]/100,e[3]/100,e[4]):x6.hasOwnProperty(t)?E6(x6[t]):t==="transparent"?new Ia(NaN,NaN,NaN,0):null}function E6(t){return new Ia(t>>16&255,t>>8&255,t&255,1)}function q1(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ia(t,e,n,r)}function vde(t){return t instanceof xm||(t=Wg(t)),t?(t=t.rgb(),new Ia(t.r,t.g,t.b,t.opacity)):new Ia}function mE(t,e,n,r){return arguments.length===1?vde(t):new Ia(t,e,n,r??1)}function Ia(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}VS(Ia,mE,MF(xm,{brighter:function(t){return t=t==null?e2:Math.pow(e2,t),new Ia(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?jg:Math.pow(jg,t),new Ia(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T6,formatHex:T6,formatRgb:S6,toString:S6}));function T6(){return"#"+Ww(this.r)+Ww(this.g)+Ww(this.b)}function S6(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function Ww(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function M6(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new LA(t,e,n,r)}function CF(t){if(t instanceof LA)return new LA(t.h,t.s,t.l,t.opacity);if(t instanceof xm||(t=Wg(t)),!t)return new LA;if(t instanceof LA)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),A=NaN,o=s-i,g=(s+i)/2;return o?(e===s?A=(n-r)/o+(n<r)*6:n===s?A=(r-e)/o+2:A=(e-n)/o+4,o/=g<.5?s+i:2-s-i,A*=60):o=g>0&&g<1?0:A,new LA(A,o,g,t.opacity)}function xde(t,e,n,r){return arguments.length===1?CF(t):new LA(t,e,n,r??1)}function LA(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}VS(LA,xde,MF(xm,{brighter:function(t){return t=t==null?e2:Math.pow(e2,t),new LA(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?jg:Math.pow(jg,t),new LA(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ia(Qw(t>=240?t-240:t+120,i,r),Qw(t,i,r),Qw(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function Qw(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function GS(t){return function(){return t}}function wde(t,e){return function(n){return t+n*e}}function bde(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Ede(t){return(t=+t)==1?PF:function(e,n){return n-e?bde(e,n,t):GS(isNaN(e)?n:e)}}function PF(t,e){var n=e-t;return n?wde(t,n):GS(isNaN(t)?e:t)}const C6=function t(e){var n=Ede(e);function r(i,s){var A=n((i=mE(i)).r,(s=mE(s)).r),o=n(i.g,s.g),g=n(i.b,s.b),w=PF(i.opacity,s.opacity);return function(C){return i.r=A(C),i.g=o(C),i.b=g(C),i.opacity=w(C),i+""}}return r.gamma=t,r}(1);function Tde(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function Sde(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Mde(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),A;for(A=0;A<r;++A)i[A]=$S(t[A],e[A]);for(;A<n;++A)s[A]=e[A];return function(o){for(A=0;A<r;++A)s[A]=i[A](o);return s}}function Cde(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function t2(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Pde(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=$S(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var yE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qw=new RegExp(yE.source,"g");function Ide(t){return function(){return t}}function kde(t){return function(e){return t(e)+""}}function Lde(t,e){var n=yE.lastIndex=qw.lastIndex=0,r,i,s,A=-1,o=[],g=[];for(t=t+"",e=e+"";(r=yE.exec(t))&&(i=qw.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[A]?o[A]+=s:o[++A]=s),(r=r[0])===(i=i[0])?o[A]?o[A]+=i:o[++A]=i:(o[++A]=null,g.push({i:A,x:t2(r,i)})),n=qw.lastIndex;return n<e.length&&(s=e.slice(n),o[A]?o[A]+=s:o[++A]=s),o.length<2?g[0]?kde(g[0].x):Ide(e):(e=g.length,function(w){for(var C=0,I;C<e;++C)o[(I=g[C]).i]=I.x(w);return o.join("")})}function $S(t,e){var n=typeof e,r;return e==null||n==="boolean"?GS(e):(n==="number"?t2:n==="string"?(r=Wg(e))?(e=r,C6):Lde:e instanceof Wg?C6:e instanceof Date?Cde:Sde(e)?Tde:Array.isArray(e)?Mde:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Pde:t2)(t,e)}function Dde(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Rde(t){return function(){return t}}function Bde(t){return+t}var P6=[0,1];function M0(t){return t}function _E(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Rde(isNaN(e)?NaN:.5)}function I6(t){var e=t[0],n=t[t.length-1],r;return e>n&&(r=e,e=n,n=r),function(i){return Math.max(e,Math.min(n,i))}}function zde(t,e,n){var r=t[0],i=t[1],s=e[0],A=e[1];return i<r?(r=_E(i,r),s=n(A,s)):(r=_E(r,i),s=n(s,A)),function(o){return s(r(o))}}function Ode(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),A=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++A<r;)i[A]=_E(t[A],t[A+1]),s[A]=n(e[A],e[A+1]);return function(o){var g=ade(t,o,1,r)-1;return s[g](i[g](o))}}function Fde(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Nde(){var t=P6,e=P6,n=$S,r,i,s,A=M0,o,g,w;function C(){return o=Math.min(t.length,e.length)>2?Ode:zde,g=w=null,I}function I(k){return isNaN(k=+k)?s:(g||(g=o(t.map(r),e,n)))(r(A(k)))}return I.invert=function(k){return A(i((w||(w=o(e,t.map(r),t2)))(k)))},I.domain=function(k){return arguments.length?(t=cde.call(k,Bde),A===M0||(A=I6(t)),C()):t.slice()},I.range=function(k){return arguments.length?(e=gE.call(k),C()):e.slice()},I.rangeRound=function(k){return e=gE.call(k),n=Dde,C()},I.clamp=function(k){return arguments.length?(A=k?I6(t):M0,I):A!==M0},I.interpolate=function(k){return arguments.length?(n=k,C()):n},I.unknown=function(k){return arguments.length?(s=k,I):s},function(k,U){return r=k,i=U,C()}}function Ude(t,e){return Nde()(t,e)}function Vde(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function n2(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function md(t){return t=n2(Math.abs(t)),t?t[1]:NaN}function Gde(t,e){return function(n,r){for(var i=n.length,s=[],A=0,o=t[0],g=0;i>0&&o>0&&(g+o+1>r&&(o=Math.max(1,r-g)),s.push(n.substring(i-=o,i+o)),!((g+=o+1)>r));)o=t[A=(A+1)%t.length];return s.reverse().join(e)}}function $de(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var jde=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r2(t){if(!(e=jde.exec(t)))throw new Error("invalid format: "+t);var e;return new jS({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}r2.prototype=jS.prototype;function jS(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}jS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Hde(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var IF;function Wde(t,e){var n=n2(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(IF=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,A=r.length;return s===A?r:s>A?r+new Array(s-A+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+n2(t,Math.max(0,e+s-1))[0]}function k6(t,e){var n=n2(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const L6={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:Vde,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return k6(t*100,e)},r:k6,s:Wde,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function D6(t){return t}var R6=Array.prototype.map,B6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Qde(t){var e=t.grouping===void 0||t.thousands===void 0?D6:Gde(R6.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?D6:$de(R6.call(t.numerals,String)),A=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",g=t.nan===void 0?"NaN":t.nan+"";function w(I){I=r2(I);var k=I.fill,U=I.align,H=I.sign,q=I.symbol,se=I.zero,X=I.width,te=I.comma,ie=I.precision,fe=I.trim,me=I.type;me==="n"?(te=!0,me="g"):L6[me]||(ie===void 0&&(ie=12),fe=!0,me="g"),(se||k==="0"&&U==="=")&&(se=!0,k="0",U="=");var Se=q==="$"?n:q==="#"&&/[boxX]/.test(me)?"0"+me.toLowerCase():"",He=q==="$"?r:/[%p]/.test(me)?A:"",Qe=L6[me],Ke=/[defgprs%]/.test(me);ie=ie===void 0?6:/[gprs]/.test(me)?Math.max(1,Math.min(21,ie)):Math.max(0,Math.min(20,ie));function nt(Ne){var rt=Se,Ze=He,mt,Kt,Tt;if(me==="c")Ze=Qe(Ne)+Ze,Ne="";else{Ne=+Ne;var dn=Ne<0||1/Ne<0;if(Ne=isNaN(Ne)?g:Qe(Math.abs(Ne),ie),fe&&(Ne=Hde(Ne)),dn&&+Ne==0&&H!=="+"&&(dn=!1),rt=(dn?H==="("?H:o:H==="-"||H==="("?"":H)+rt,Ze=(me==="s"?B6[8+IF/3]:"")+Ze+(dn&&H==="("?")":""),Ke){for(mt=-1,Kt=Ne.length;++mt<Kt;)if(Tt=Ne.charCodeAt(mt),48>Tt||Tt>57){Ze=(Tt===46?i+Ne.slice(mt+1):Ne.slice(mt))+Ze,Ne=Ne.slice(0,mt);break}}}te&&!se&&(Ne=e(Ne,1/0));var _t=rt.length+Ne.length+Ze.length,Et=_t<X?new Array(X-_t+1).join(k):"";switch(te&&se&&(Ne=e(Et+Ne,Et.length?X-Ze.length:1/0),Et=""),U){case"<":Ne=rt+Ne+Ze+Et;break;case"=":Ne=rt+Et+Ne+Ze;break;case"^":Ne=Et.slice(0,_t=Et.length>>1)+rt+Ne+Ze+Et.slice(_t);break;default:Ne=Et+rt+Ne+Ze;break}return s(Ne)}return nt.toString=function(){return I+""},nt}function C(I,k){var U=w((I=r2(I),I.type="f",I)),H=Math.max(-8,Math.min(8,Math.floor(md(k)/3)))*3,q=Math.pow(10,-H),se=B6[8+H/3];return function(X){return U(q*X)+se}}return{format:w,formatPrefix:C}}var Z1,kF,LF;qde({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function qde(t){return Z1=Qde(t),kF=Z1.format,LF=Z1.formatPrefix,Z1}function Zde(t){return Math.max(0,-md(Math.abs(t)))}function Yde(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(md(e)/3)))*3-md(Math.abs(t)))}function Xde(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,md(e)-md(t))+1}function Kde(t,e,n,r){var i=ude(t,e,n),s;switch(r=r2(r??",f"),r.type){case"s":{var A=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=Yde(i,A))&&(r.precision=s),LF(r,A)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Xde(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=Zde(i))&&(r.precision=s-(r.type==="%")*2);break}}return kF(r)}function Jde(t){var e=t.domain;return t.ticks=function(n){var r=e();return Ade(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Kde(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,A=r[i],o=r[s],g;return o<A&&(g=A,A=o,o=g,g=i,i=s,s=g),g=Ry(A,o,n),g>0?(A=Math.floor(A/g)*g,o=Math.ceil(o/g)*g,g=Ry(A,o,n)):g<0&&(A=Math.ceil(A*g)/g,o=Math.floor(o*g)/g,g=Ry(A,o,n)),g>0?(r[i]=Math.floor(A/g)*g,r[s]=Math.ceil(o/g)*g,e(r)):g<0&&(r[i]=Math.ceil(A*g)/g,r[s]=Math.floor(o*g)/g,e(r)),t},t}function Ou(){var t=Ude(M0,M0);return t.copy=function(){return Fde(t,Ou())},US.apply(t,arguments),Jde(t)}function hv(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}function fv(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const epe=fv(hv("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));fv(hv("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));fv(hv("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));fv(hv("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Lc(t){return function(){return t}}var z6=Math.abs,to=Math.atan2,kh=Math.cos,tpe=Math.max,Zw=Math.min,SA=Math.sin,C0=Math.sqrt,Yo=1e-12,Qg=Math.PI,i2=Qg/2,npe=2*Qg;function rpe(t){return t>1?0:t<-1?Qg:Math.acos(t)}function O6(t){return t>=1?i2:t<=-1?-i2:Math.asin(t)}function ipe(t){return t.innerRadius}function spe(t){return t.outerRadius}function ope(t){return t.startAngle}function ape(t){return t.endAngle}function lpe(t){return t&&t.padAngle}function Ape(t,e,n,r,i,s,A,o){var g=n-t,w=r-e,C=A-i,I=o-s,k=I*g-C*w;if(!(k*k<Yo))return k=(C*(e-s)-I*(t-i))/k,[t+k*g,e+k*w]}function Y1(t,e,n,r,i,s,A){var o=t-n,g=e-r,w=(A?s:-s)/C0(o*o+g*g),C=w*g,I=-w*o,k=t+C,U=e+I,H=n+C,q=r+I,se=(k+H)/2,X=(U+q)/2,te=H-k,ie=q-U,fe=te*te+ie*ie,me=i-s,Se=k*q-H*U,He=(ie<0?-1:1)*C0(tpe(0,me*me*fe-Se*Se)),Qe=(Se*ie-te*He)/fe,Ke=(-Se*te-ie*He)/fe,nt=(Se*ie+te*He)/fe,Ne=(-Se*te+ie*He)/fe,rt=Qe-se,Ze=Ke-X,mt=nt-se,Kt=Ne-X;return rt*rt+Ze*Ze>mt*mt+Kt*Kt&&(Qe=nt,Ke=Ne),{cx:Qe,cy:Ke,x01:-C,y01:-I,x11:Qe*(i/me-1),y11:Ke*(i/me-1)}}function DF(){var t=ipe,e=spe,n=Lc(0),r=null,i=ope,s=ape,A=lpe,o=null;function g(){var w,C,I=+t.apply(this,arguments),k=+e.apply(this,arguments),U=i.apply(this,arguments)-i2,H=s.apply(this,arguments)-i2,q=z6(H-U),se=H>U;if(o||(o=w=vF()),k<I&&(C=k,k=I,I=C),!(k>Yo))o.moveTo(0,0);else if(q>npe-Yo)o.moveTo(k*kh(U),k*SA(U)),o.arc(0,0,k,U,H,!se),I>Yo&&(o.moveTo(I*kh(H),I*SA(H)),o.arc(0,0,I,H,U,se));else{var X=U,te=H,ie=U,fe=H,me=q,Se=q,He=A.apply(this,arguments)/2,Qe=He>Yo&&(r?+r.apply(this,arguments):C0(I*I+k*k)),Ke=Zw(z6(k-I)/2,+n.apply(this,arguments)),nt=Ke,Ne=Ke,rt,Ze;if(Qe>Yo){var mt=O6(Qe/I*SA(He)),Kt=O6(Qe/k*SA(He));(me-=mt*2)>Yo?(mt*=se?1:-1,ie+=mt,fe-=mt):(me=0,ie=fe=(U+H)/2),(Se-=Kt*2)>Yo?(Kt*=se?1:-1,X+=Kt,te-=Kt):(Se=0,X=te=(U+H)/2)}var Tt=k*kh(X),dn=k*SA(X),_t=I*kh(fe),Et=I*SA(fe);if(Ke>Yo){var Jt=k*kh(te),kn=k*SA(te),Tn=I*kh(ie),Tr=I*SA(ie),Jn;if(q<Qg&&(Jn=Ape(Tt,dn,Tn,Tr,Jt,kn,_t,Et))){var ir=Tt-Jn[0],ur=dn-Jn[1],Un=Jt-Jn[0],wr=kn-Jn[1],wt=1/SA(rpe((ir*Un+ur*wr)/(C0(ir*ir+ur*ur)*C0(Un*Un+wr*wr)))/2),rn=C0(Jn[0]*Jn[0]+Jn[1]*Jn[1]);nt=Zw(Ke,(I-rn)/(wt-1)),Ne=Zw(Ke,(k-rn)/(wt+1))}}Se>Yo?Ne>Yo?(rt=Y1(Tn,Tr,Tt,dn,k,Ne,se),Ze=Y1(Jt,kn,_t,Et,k,Ne,se),o.moveTo(rt.cx+rt.x01,rt.cy+rt.y01),Ne<Ke?o.arc(rt.cx,rt.cy,Ne,to(rt.y01,rt.x01),to(Ze.y01,Ze.x01),!se):(o.arc(rt.cx,rt.cy,Ne,to(rt.y01,rt.x01),to(rt.y11,rt.x11),!se),o.arc(0,0,k,to(rt.cy+rt.y11,rt.cx+rt.x11),to(Ze.cy+Ze.y11,Ze.cx+Ze.x11),!se),o.arc(Ze.cx,Ze.cy,Ne,to(Ze.y11,Ze.x11),to(Ze.y01,Ze.x01),!se))):(o.moveTo(Tt,dn),o.arc(0,0,k,X,te,!se)):o.moveTo(Tt,dn),!(I>Yo)||!(me>Yo)?o.lineTo(_t,Et):nt>Yo?(rt=Y1(_t,Et,Jt,kn,I,-nt,se),Ze=Y1(Tt,dn,Tn,Tr,I,-nt,se),o.lineTo(rt.cx+rt.x01,rt.cy+rt.y01),nt<Ke?o.arc(rt.cx,rt.cy,nt,to(rt.y01,rt.x01),to(Ze.y01,Ze.x01),!se):(o.arc(rt.cx,rt.cy,nt,to(rt.y01,rt.x01),to(rt.y11,rt.x11),!se),o.arc(0,0,I,to(rt.cy+rt.y11,rt.cx+rt.x11),to(Ze.cy+Ze.y11,Ze.cx+Ze.x11),se),o.arc(Ze.cx,Ze.cy,nt,to(Ze.y11,Ze.x11),to(Ze.y01,Ze.x01),!se))):o.arc(0,0,I,fe,ie,se)}if(o.closePath(),w)return o=null,w+""||null}return g.centroid=function(){var w=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,C=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-Qg/2;return[kh(C)*w,SA(C)*w]},g.innerRadius=function(w){return arguments.length?(t=typeof w=="function"?w:Lc(+w),g):t},g.outerRadius=function(w){return arguments.length?(e=typeof w=="function"?w:Lc(+w),g):e},g.cornerRadius=function(w){return arguments.length?(n=typeof w=="function"?w:Lc(+w),g):n},g.padRadius=function(w){return arguments.length?(r=w==null?null:typeof w=="function"?w:Lc(+w),g):r},g.startAngle=function(w){return arguments.length?(i=typeof w=="function"?w:Lc(+w),g):i},g.endAngle=function(w){return arguments.length?(s=typeof w=="function"?w:Lc(+w),g):s},g.padAngle=function(w){return arguments.length?(A=typeof w=="function"?w:Lc(+w),g):A},g.context=function(w){return arguments.length?(o=w??null,g):o},g}function s2(){this._=null}function dv(t){t.U=t.C=t.L=t.R=t.P=t.N=null}s2.prototype={constructor:s2,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=F6(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(xp(this,n),t=n,n=t.U),n.C=!1,r.C=!0,wp(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(wp(this,n),t=n,n=t.U),n.C=!1,r.C=!0,xp(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e=t.U,n,r=t.L,i=t.R,s,A;if(r?i?s=F6(i):s=r:s=i,e?e.L===t?e.L=s:e.R=s:this._=s,r&&i?(A=s.C,s.C=t.C,s.L=r,r.U=s,s!==i?(e=s.U,s.U=t.U,t=s.R,e.L=t,s.R=i,i.U=s):(s.U=e,e=s,t=s.R)):(A=t.C,t=s),t&&(t.U=e),!A){if(t&&t.C){t.C=!1;return}do{if(t===this._)break;if(t===e.L){if(n=e.R,n.C&&(n.C=!1,e.C=!0,xp(this,e),n=e.R),n.L&&n.L.C||n.R&&n.R.C){(!n.R||!n.R.C)&&(n.L.C=!1,n.C=!0,wp(this,n),n=e.R),n.C=e.C,e.C=n.R.C=!1,xp(this,e),t=this._;break}}else if(n=e.L,n.C&&(n.C=!1,e.C=!0,wp(this,e),n=e.L),n.L&&n.L.C||n.R&&n.R.C){(!n.L||!n.L.C)&&(n.R.C=!1,n.C=!0,xp(this,n),n=e.L),n.C=e.C,e.C=n.L.C=!1,wp(this,e),t=this._;break}n.C=!0,t=e,e=e.U}while(!t.C);t&&(t.C=!1)}}};function xp(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function wp(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function F6(t){for(;t.L;)t=t.L;return t}function Up(t,e,n,r){var i=[null,null],s=so.push(i)-1;return i.left=t,i.right=e,n&&o2(i,t,e,n),r&&o2(i,e,t,r),Ca[t.index].halfedges.push(s),Ca[e.index].halfedges.push(s),i}function bp(t,e,n){var r=[e,n];return r.left=t,r}function o2(t,e,n,r){!t[0]&&!t[1]?(t[0]=r,t.left=e,t.right=n):t.left===n?t[1]=r:t[0]=r}function upe(t,e,n,r,i){var s=t[0],A=t[1],o=s[0],g=s[1],w=A[0],C=A[1],I=0,k=1,U=w-o,H=C-g,q;if(q=e-o,!(!U&&q>0)){if(q/=U,U<0){if(q<I)return;q<k&&(k=q)}else if(U>0){if(q>k)return;q>I&&(I=q)}if(q=r-o,!(!U&&q<0)){if(q/=U,U<0){if(q>k)return;q>I&&(I=q)}else if(U>0){if(q<I)return;q<k&&(k=q)}if(q=n-g,!(!H&&q>0)){if(q/=H,H<0){if(q<I)return;q<k&&(k=q)}else if(H>0){if(q>k)return;q>I&&(I=q)}if(q=i-g,!(!H&&q<0)){if(q/=H,H<0){if(q>k)return;q>I&&(I=q)}else if(H>0){if(q<I)return;q<k&&(k=q)}return!(I>0)&&!(k<1)||(I>0&&(t[0]=[o+I*U,g+I*H]),k<1&&(t[1]=[o+k*U,g+k*H])),!0}}}}}function cpe(t,e,n,r,i){var s=t[1];if(s)return!0;var A=t[0],o=t.left,g=t.right,w=o[0],C=o[1],I=g[0],k=g[1],U=(w+I)/2,H=(C+k)/2,q,se;if(k===C){if(U<e||U>=r)return;if(w>I){if(!A)A=[U,n];else if(A[1]>=i)return;s=[U,i]}else{if(!A)A=[U,i];else if(A[1]<n)return;s=[U,n]}}else if(q=(w-I)/(k-C),se=H-q*U,q<-1||q>1)if(w>I){if(!A)A=[(n-se)/q,n];else if(A[1]>=i)return;s=[(i-se)/q,i]}else{if(!A)A=[(i-se)/q,i];else if(A[1]<n)return;s=[(n-se)/q,n]}else if(C<k){if(!A)A=[e,q*e+se];else if(A[0]>=r)return;s=[r,q*r+se]}else{if(!A)A=[r,q*r+se];else if(A[0]<e)return;s=[e,q*e+se]}return t[0]=A,t[1]=s,!0}function hpe(t,e,n,r){for(var i=so.length,s;i--;)(!cpe(s=so[i],t,e,n,r)||!upe(s,t,e,n,r)||!(Math.abs(s[0][0]-s[1][0])>ui||Math.abs(s[0][1]-s[1][1])>ui))&&delete so[i]}function fpe(t){return Ca[t.index]={site:t,halfedges:[]}}function dpe(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function RF(t,e){return e[+(e.left!==t.site)]}function ppe(t,e){return e[+(e.left===t.site)]}function gpe(){for(var t=0,e=Ca.length,n,r,i,s;t<e;++t)if((n=Ca[t])&&(s=(r=n.halfedges).length)){var A=new Array(s),o=new Array(s);for(i=0;i<s;++i)A[i]=i,o[i]=dpe(n,so[r[i]]);for(A.sort(function(g,w){return o[w]-o[g]}),i=0;i<s;++i)o[i]=r[A[i]];for(i=0;i<s;++i)r[i]=o[i]}}function mpe(t,e,n,r){var i=Ca.length,s,A,o,g,w,C,I,k,U,H,q,se,X=!0;for(s=0;s<i;++s)if(A=Ca[s]){for(o=A.site,w=A.halfedges,g=w.length;g--;)so[w[g]]||w.splice(g,1);for(g=0,C=w.length;g<C;)H=ppe(A,so[w[g]]),q=H[0],se=H[1],I=RF(A,so[w[++g%C]]),k=I[0],U=I[1],(Math.abs(q-k)>ui||Math.abs(se-U)>ui)&&(w.splice(g,0,so.push(bp(o,H,Math.abs(q-t)<ui&&r-se>ui?[t,Math.abs(k-t)<ui?U:r]:Math.abs(se-r)<ui&&n-q>ui?[Math.abs(U-r)<ui?k:n,r]:Math.abs(q-n)<ui&&se-e>ui?[n,Math.abs(k-n)<ui?U:e]:Math.abs(se-e)<ui&&q-t>ui?[Math.abs(U-e)<ui?k:t,e]:null))-1),++C);C&&(X=!1)}if(X){var te,ie,fe,me=1/0;for(s=0,X=null;s<i;++s)(A=Ca[s])&&(o=A.site,te=o[0]-t,ie=o[1]-e,fe=te*te+ie*ie,fe<me&&(me=fe,X=A));if(X){var Se=[t,e],He=[t,r],Qe=[n,r],Ke=[n,e];X.halfedges.push(so.push(bp(o=X.site,Se,He))-1,so.push(bp(o,He,Qe))-1,so.push(bp(o,Qe,Ke))-1,so.push(bp(o,Ke,Se))-1)}}for(s=0;s<i;++s)(A=Ca[s])&&(A.halfedges.length||delete Ca[s])}var BF=[],HS;function ype(){dv(this),this.x=this.y=this.arc=this.site=this.cy=null}function P0(t){var e=t.P,n=t.N;if(!(!e||!n)){var r=e.site,i=t.site,s=n.site;if(r!==s){var A=i[0],o=i[1],g=r[0]-A,w=r[1]-o,C=s[0]-A,I=s[1]-o,k=2*(g*I-w*C);if(!(k>=-bpe)){var U=g*g+w*w,H=C*C+I*I,q=(I*U-w*H)/k,se=(g*H-C*U)/k,X=BF.pop()||new ype;X.arc=t,X.site=i,X.x=q+A,X.y=(X.cy=se+o)+Math.sqrt(q*q+se*se),t.circle=X;for(var te=null,ie=qg._;ie;)if(X.y<ie.y||X.y===ie.y&&X.x<=ie.x)if(ie.L)ie=ie.L;else{te=ie.P;break}else if(ie.R)ie=ie.R;else{te=ie;break}qg.insert(te,X),te||(HS=X)}}}}function W0(t){var e=t.circle;e&&(e.P||(HS=e.N),qg.remove(e),BF.push(e),dv(e),t.circle=null)}var zF=[];function _pe(){dv(this),this.edge=this.site=this.circle=null}function N6(t){var e=zF.pop()||new _pe;return e.site=t,e}function Yw(t){W0(t),Q0.remove(t),zF.push(t),dv(t)}function vpe(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],s=t.P,A=t.N,o=[t];Yw(t);for(var g=s;g.circle&&Math.abs(n-g.circle.x)<ui&&Math.abs(r-g.circle.cy)<ui;)s=g.P,o.unshift(g),Yw(g),g=s;o.unshift(g),W0(g);for(var w=A;w.circle&&Math.abs(n-w.circle.x)<ui&&Math.abs(r-w.circle.cy)<ui;)A=w.N,o.push(w),Yw(w),w=A;o.push(w),W0(w);var C=o.length,I;for(I=1;I<C;++I)w=o[I],g=o[I-1],o2(w.edge,g.site,w.site,i);g=o[0],w=o[C-1],w.edge=Up(g.site,w.site,null,i),P0(g),P0(w)}function xpe(t){for(var e=t[0],n=t[1],r,i,s,A,o=Q0._;o;)if(s=OF(o,n)-e,s>ui)o=o.L;else if(A=e-wpe(o,n),A>ui){if(!o.R){r=o;break}o=o.R}else{s>-ui?(r=o.P,i=o):A>-ui?(r=o,i=o.N):r=i=o;break}fpe(t);var g=N6(t);if(Q0.insert(r,g),!(!r&&!i)){if(r===i){W0(r),i=N6(r.site),Q0.insert(g,i),g.edge=i.edge=Up(r.site,g.site),P0(r),P0(i);return}if(!i){g.edge=Up(r.site,g.site);return}W0(r),W0(i);var w=r.site,C=w[0],I=w[1],k=t[0]-C,U=t[1]-I,H=i.site,q=H[0]-C,se=H[1]-I,X=2*(k*se-U*q),te=k*k+U*U,ie=q*q+se*se,fe=[(se*te-U*ie)/X+C,(k*ie-q*te)/X+I];o2(i.edge,w,H,fe),g.edge=Up(w,t,null,fe),i.edge=Up(t,H,null,fe),P0(r),P0(i)}}function OF(t,e){var n=t.site,r=n[0],i=n[1],s=i-e;if(!s)return r;var A=t.P;if(!A)return-1/0;n=A.site;var o=n[0],g=n[1],w=g-e;if(!w)return o;var C=o-r,I=1/s-1/w,k=C/w;return I?(-k+Math.sqrt(k*k-2*I*(C*C/(-2*w)-g+w/2+i-s/2)))/I+r:(r+o)/2}function wpe(t,e){var n=t.N;if(n)return OF(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var ui=1e-6,bpe=1e-12,Q0,Ca,qg,so;function Epe(t,e,n){return(t[0]-n[0])*(e[1]-t[1])-(t[0]-e[0])*(n[1]-t[1])}function Tpe(t,e){return e[1]-t[1]||e[0]-t[0]}function U6(t,e){var n=t.sort(Tpe).pop(),r,i,s;for(so=[],Ca=new Array(t.length),Q0=new s2,qg=new s2;;)if(s=HS,n&&(!s||n[1]<s.y||n[1]===s.y&&n[0]<s.x))(n[0]!==r||n[1]!==i)&&(xpe(n),r=n[0],i=n[1]),n=t.pop();else if(s)vpe(s.arc);else break;if(gpe(),e){var A=+e[0][0],o=+e[0][1],g=+e[1][0],w=+e[1][1];hpe(A,o,g,w),mpe(A,o,g,w)}this.edges=so,this.cells=Ca,Q0=qg=so=Ca=null}U6.prototype={constructor:U6,polygons:function(){var t=this.edges;return this.cells.map(function(e){var n=e.halfedges.map(function(r){return RF(e,t[r])});return n.data=e.site.data,n})},triangles:function(){var t=[],e=this.edges;return this.cells.forEach(function(n,r){if(o=(s=n.halfedges).length)for(var i=n.site,s,A=-1,o,g,w=e[s[o-1]],C=w.left===i?w.right:w.left;++A<o;)g=C,w=e[s[A]],C=w.left===i?w.right:w.left,g&&C&&r<g.index&&r<C.index&&Epe(i,g,C)<0&&t.push([i.data,g.data,C.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,e,n){for(var r=this,i,s=r._found||0,A=r.cells.length,o;!(o=r.cells[s]);)if(++s>=A)return null;var g=t-o.site[0],w=e-o.site[1],C=g*g+w*w;do o=r.cells[i=s],s=null,o.halfedges.forEach(function(I){var k=r.edges[I],U=k.left;if(!((U===o.site||!U)&&!(U=k.right))){var H=t-U[0],q=e-U[1],se=H*H+q*q;se<C&&(C=se,s=U.index)}});while(s!==null);return r._found=i,n==null||C<=n*n?o.site:null}};function Vp(t,e,n){this.k=t,this.x=e,this.y=n}Vp.prototype={constructor:Vp,scale:function(t){return t===1?this:new Vp(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Vp(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Vp.prototype;function FF(t,e,n,r,i,s){var A=i||0,o=s||0,g=n||0,w=e||function(){return"#fff"},C=r,I;function k(U){k.el=U,k.setProperties()}return k.setProperties=function(){this.el&&(k.svgGroup||(k.svgGroup=k.el.append("g")),k.svgGroup.attr("transform","translate("+A+","+o+")"),k.svgGroup.selectAll("g").data(t).enter().append("g").selectAll("rect").data(function(U,H){return U.map(function(q){return{r:H,v:q}})}).enter().append("rect").datum(function(U,H){return U.c=H,U}),k.svgGroup.selectAll("g").selectAll("rect").attr("x",function(U){return g/t[U.r].length*U.c}).attr("y",function(U){return U.r*I}).attr("width",function(U){return g/t[U.r].length}).attr("height",I).attr("fill",function(U){return w(U.v)}),C&&k.svgGroup.attr("id",C))},k.data=function(U){return arguments.length?(t=U,I=g/t.length,k.setProperties(),k):t},k.x=function(U){return arguments.length?(A=U,k.setProperties(),k):A},k.y=function(U){return arguments.length?(o=U,k.setProperties(),k):o},k.size=function(U){return arguments.length?(g=U,t&&(I=g/t.length,k.setProperties()),k):g},k.scale=function(U){return arguments.length?(w=U,t&&k.setProperties(),k):w},k.id=function(U){return arguments.length?(C=U,k.setProperties(),k):C},k}function Spe(t,e,n,r,i,s){var A=FF(t,e,n,r,i,s);function o(g,w,C,I){var k=Ou().domain([0,I]).range([-Math.PI/6,Math.PI/6]),U=Ou().domain([0,C]).range([w,0]),H=DF().innerRadius(U(g.r+1)).outerRadius(U(g.r)).startAngle(k(g.c)).endAngle(k(g.c+1));return H()}return A.setProperties=function(){var g=A.data(),w=A.size(),C=A.scale(),I=A.id(),k=A.x(),U=A.y();A.el&&(A.svgGroup||(A.svgGroup=A.el.append("g")),A.svgGroup.attr("transform","translate("+k+","+U+")"),A.svgGroup.selectAll("g").data(g).enter().append("g").selectAll("path").data(function(H,q){return H.map(function(se){return{r:q,v:se}})}).enter().append("path").datum(function(H,q){return H.c=q,H}),A.svgGroup.selectAll("g").selectAll("path").attr("transform","translate("+w/2+","+w+")").attr("d",function(H){return o(H,w,g.length,g[H.r].length)}).attr("fill",function(H){return C(H.v)}),I&&A.svgGroup.attr("id",I))},A}function Mpe(t,e,n){var r=e||epe,i=n||function(g,w){var C=w!=null?{v:g,u:w}:{v:g.v,u:g.u};return C},s=t;function A(g,w){var C=Gg(df(g)),I=Gg(df(w));return Math.sqrt(Math.pow(C.l-I.l,2)+Math.pow(C.a-I.a,2)+Math.pow(C.b-I.b,2))}function o(g,w){var C=i(g,w),I=[0,1],k=[0,1];i.uncertaintyDomain&&(I=i.uncertaintyDomain()),i.valueDomain&&(k=i.valueDomain());var U=Ou().domain(I).range([0,1]),H=Ou().domain(k).range([0,1]),q=r(H(C.v));switch(s){case"usl":default:q=zfe(q,"#fff")(U(C.u));break;case"us":q=nE(q);var se=Ou().domain([0,1]).range([q.s,0]);q.s=se(U(C.u));break;case"ul":q=nE(q);var X=Ou().domain([0,1]).range([q.l,1]);q.l=X(U(C.u));break}return q}return o.colorList=function(){return this.quantize().range().map(function(g){return o(g)})},o.colorDists=function(){for(var g=this.colorList(),w=new Array(g.length),C,I=new Array(2),k,U=0;U<w.length;U++){w[U]=new Array(g.length);for(var H=0;H<w[U].length;H++)k=A(g[U],g[H]),w[U][H]=k,U!=H&&(U==0&&H==1||k<C)&&(C=k,I=[g[U],g[H]])}return w.minDist=C,w.minPair=I,w},o.mode=function(g){return arguments.length?(s=g,o):s},o.range=function(g){return arguments.length?(r=g,o):r},o.quantize=function(g){return arguments.length?(i=g,o):i},o}function Cpe(t,e,n,r,i,s,A){var o=null,g=i,w=t||null,C=e||200,I=n||30,k=r||null,U=s||0,H=A||0;function q(se){o=se,q.setProperties()}return q.setProperties=function(){if(o){var se=w.domain?w.domain():[0,1],X=C/w.range().length,te=(se[1]-se[0])/w.range().length,ie=Ng(se[0],se[1]+te,te),fe=J_().range([0,C]).domain(ie).round(!0);o.attr("class","legend").attr("transform","translate("+U+","+H+")");var me=o.selectAll("rect").data(w.range());me.enter().append("rect").merge(me).attr("x",function(Qe,Ke){return Ke*X}).attr("y",0).attr("height",I).attr("width",X).attr("fill",function(Qe){return Qe});var Se=o.select("g.legend > g");Se.empty()&&(Se=o.append("g")),Se.attr("transform","translate(0, "+I+")").call($ce(fe).tickFormat(gd(k||"")));var He=o.select("g.legend > text");He.empty()&&(He=o.append("text")),He.style("text-anchor","middle").style("font-size",13).attr("transform","translate("+C/2+", "+(I+30)+")").text(g)}},q.title=function(se){return arguments.length?(g=se,q.setProperties(),q):g},q.scale=function(se){return arguments.length?(w=se,q.setProperties(),q):w},q.size=function(se){return arguments.length?(C=se,q.setProperties(),q):C},q.height=function(se){return arguments.length?(I=se,q.setProperties(),q):I},q.format=function(se){return arguments.length?(k=se,q.setProperties(),q):k},q.x=function(se){return arguments.length?(U=se,q.setProperties(),q):U},q.y=function(se){return arguments.length?(H=se,q.setProperties(),q):H},q}function Ppe(t,e,n,r,i,s,A){var o=null,g=r||"Uncertainty",w=i||"Value",C=t||null,I=e||200,k=n||null,U=s||0,H=A||0,q=null,se=FF(),X=function(te){o=te,X.setProperties(),o.call(se)};return X.setProperties=function(){if(o){var te=q;te||(te=C.quantize().data());for(var ie=[],fe=0;fe<te.length;fe++)ie[fe]=te[te.length-fe-1];se.y(1),se.data(ie),se.scale(C),se.size(I),o.attr("class","legend").attr("transform","translate("+U+","+H+")");var me=C&&C.quantize?C.quantize().uncertaintyDomain():[0,1],Se=(me[1]-me[0])/ie.length,He=Ng(me[0],me[1]+Se,Se),Qe=C&&C.quantize?C.quantize().valueDomain():[0,1],Ke=(Qe[1]-Qe[0])/ie.length,nt=Ng(Qe[0],Qe[1]+Ke,Ke),Ne=J_().range([0,I]).domain(nt);o.append("g").call(Gce(Ne).tickFormat(gd(k||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+I/2+", -25)").text(w);var rt=J_().range([0,I]).domain(He);o.append("g").attr("transform","translate("+I+", 0)").call(VO(rt).tickFormat(gd(k||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(I+40)+", "+I/2+")rotate(90)").text(g)}},X.data=function(te){return arguments.length?(q=te,X.setProperties(),X):q},X.scale=function(te){return arguments.length?(C=te,X.setProperties(),X):C},X.size=function(te){return arguments.length?(I=te,X.setProperties(),X):I},X.format=function(te){return arguments.length?(k=te,X.setProperties(),X):k},X.x=function(te){return arguments.length?(U=te,X.setProperties(),X):U},X.y=function(te){return arguments.length?(H=te,X.setProperties(),X):H},X.utitle=function(te){return arguments.length?(g=te,X.setProperties(),X):g},X.vtitle=function(te){return arguments.length?(w=te,X.setProperties(),X):w},X}function Ipe(t,e,n,r,i,s,A){var o=null,g=r||"Uncertainty",w=i||"Value",C=t||null,I=e||200,k=n||null,U=s||0,H=A||0,q=null,se=Spe(),X=function(te){o=te,X.setProperties(),o.call(se)};return X.setProperties=function(){if(o){var te=q;te||(te=C.quantize().data());for(var ie=[],fe=0;fe<te.length;fe++)ie[fe]=te[te.length-fe-1];se.data(ie),se.scale(C),se.size(I),o.attr("class","legend").attr("transform","translate("+U+","+H+")");var me=C&&C.quantize?C.quantize().uncertaintyDomain():[0,1],Se=(me[1]-me[0])/ie.length,He=Ng(me[0],me[1]+Se,Se),Qe=J_().range([0,I]).domain(He),Ke=I/180;o.append("g").attr("transform","translate("+(I+6*Ke)+","+28*Ke+")rotate(30)").call(VO(Qe).tickFormat(gd(k||""))),o.append("text").style("text-anchor","middle").style("font-size",13).attr("transform","translate("+(I+10*Ke)+","+(40*Ke+I/2)+")rotate(-60)").text(g);var nt=C&&C.quantize?C.quantize().valueDomain():[0,1],Ne=(nt[1]-nt[0])/ie[0].length,rt=Ng(nt[0],nt[1]+Ne,Ne),Ze=Ou().range([0,I]).domain(nt),mt=k?gd(k):Ze.tickFormat(rt.length),Kt=Ou().domain(nt).range([-30,30]),Tt=3*Ke,dn=DF().innerRadius(I+Tt).outerRadius(I+Tt+1).startAngle(-Math.PI/6).endAngle(Math.PI/6),_t=o.append("g").attr("transform","translate("+I/2+","+(I-Tt)+")");_t.append("path").attr("fill","black").attr("stroke","transparent").attr("d",dn);var Et=_t.selectAll(".arc-label").data(rt).enter().append("g").attr("class","arc-label").attr("transform",function(Jt){return"rotate("+Kt(Jt)+")translate(0,"+(-I-Tt)+")"});Et.append("text").style("font-size","11").style("text-anchor","middle").attr("y",-10).text(mt),Et.append("line").attr("x1",.5).attr("x2",.5).attr("y1",-6).attr("y2",0).attr("stroke","#000"),o.append("text").style("text-anchor","middle").style("font-size",13).attr("x",I/2).attr("y",-30).text(w)}},X.data=function(te){return arguments.length?(q=te,X.setProperties(),X):q},X.scale=function(te){return arguments.length?(C=te,X.setProperties(),X):C},X.size=function(te){return arguments.length?(I=te,X.setProperties(),X):I},X.format=function(te){return arguments.length?(k=te,X.setProperties(),X):k},X.x=function(te){return arguments.length?(U=te,X.setProperties(),X):U},X.y=function(te){return arguments.length?(H=te,X.setProperties(),X):H},X.utitle=function(te){return arguments.length?(g=te,X.setProperties(),X):g},X.vtitle=function(te){return arguments.length?(w=te,X.setProperties(),X):w},X}const kpe=Object.freeze(Object.defineProperty({__proto__:null,arcmapLegend:Ipe,heatmapLegend:Ppe,simpleLegend:Cpe},Symbol.toStringTag,{value:"Module"}));var $A=kpe;function a2(t,e){return t+e}function Zl(t,e=1,n=1){if(typeof t=="function")return A=>Zl(t(A),e,n);Array.isArray(t)&&(t=kg(...t).toString());const{l:r,c:i,h:s}=CI(t);return CI(r+18*n,i+18*e,s).toString()}function NF(t,e,n){let r={};return n||(n=[]),Object.keys(t).forEach(i=>{if(n.includes(i))return;let s=t[i],A={};Object.keys(s).forEach(o=>{e(s[o])&&(A[o]=s[o])}),r[i]=A}),r}function UF(t,e){return t.reduce(function(n,r){return n[e(r)]=r,n},{})}const pv=t=>!!(t.properties||{}).id,yd=t=>!pv(t),l2=t=>t.toLocaleString("default",{month:"long"})+" "+t.toLocaleString("default",{year:"numeric"}),q0=t=>zpe[t.properties.LandUse.constructor===Array?t.properties.LandUse[0]:t.properties.LandUse],Lpe=1e-9;function Dpe(t,e){let n=t||2,r=e||2;const i=ms(),s=ms();let A=g();function o(w,C){var I=C??w.u,k=C!=null?w:w.v;let U=0;for(;U<A.length-1&&i(I)<1-(U+1)/r-Lpe;)U++;const H=A[U].length>1?(A[U][1].v-A[U][0].v)/2:0;let q=0;for(;q<A[U].length-1&&k>A[U][q].v+H;)q++;return A[U][q]}function g(){const w=[];let C;s.nice(Math.pow(n,r-1)),i.nice(r),w[0]=[],w[0].push({u:i.invert((r-1)/r),v:s.invert(.5)});for(let I=1;I<=r;I++){w[I-1]=[],C=2*Math.pow(n,I);for(let k=1;k<C;k+=2)w[I-1].push({u:i.invert(1-I/r),v:s.invert(k/C)})}return w}return o.range=()=>[].concat.apply([],A),o.tree=()=>A,o.data=o.tree,o.branching=function(w){return arguments.length?(n=Math.max(1,w),A=g(),o):n},o.layers=function(w){return arguments.length?(r=Math.max(1,w),A=g(),o):r},o.uncertaintyDomain=function(w){return arguments.length?(i.domain(w),A=g(),o):i.domain()},o.valueDomain=function(w){return arguments.length?(s.domain(w),A=g(),o):s.domain()},o}const Xw=t=>t.replace(/[^\d,]/g,"").split(",").map(e=>Number(e)),Dc=10,Kw=(t,e=0,n=1/Dc)=>Math.abs(t-e)<n?0:1,WS=(t,e,n=!0)=>{const r=Object.keys(t);for(const i of r){const s=t[i],A=s.value.range||[0,1],o=s.variance.range||[1,0],g=s.value.color||tk,w=s.variance.color||tk;if(typeof s.value.domain=="function")if(n){const k=Object.values(e).slice(-1)[0];s.value.domain=M1(Object.values(k).map(s.value.domain))}else s.value.domain=M1(e.features.map(s.value.domain));if(typeof s.value.domain=="string")if(n){const k=Object.values(e).slice(-1)[0];s.value.domain=M1(Object.values(k).map(U=>U[s.value.domain]))}else s.value.domain=M1(e.features.map(k=>k.properties[s.value.domain]));const C=ms().domain(s.value.domain).range(A),I=ms().domain(s.variance.domain).range(o);s.scaleLinear=C.copy().clamp(!0),s.scaleStepped=ea().domain(s.value.domain).range(k3(A[0],A[1],Dc)),s.scaleLinearVar=I.copy().clamp(!0),s.scaleSteppedVar=ea().domain(s.variance.domain).range(k3(o[0],o[1],Dc)),s.colorsLinear=k=>g(C(k)),s.colorsStepped=ea().domain(s.value.domain).range(II(k=>g(ms([0,1]).range(A)(k)),Dc)),s.colorsLinearVar=k=>w(I(k)),s.colorsSteppedVar=ea().domain(s.variance.domain).range(II(k=>w(ms([0,1]).range(o)(k)),Dc)),s.vsup=Mpe().quantize(Dpe().branching(2).layers(3).valueDomain(s.value.domain).uncertaintyDomain(s.variance.domain)).range(g),s.interpColor=(k,U=!1,H=!0,q=1/Dc)=>[...Xw((H?s.colorsStepped:s.colorsLinear)(k)),...U?[Kw(s.scaleStepped(k),s.value.zero||0,q)*255]:[]],s.interpColorVar=(k,U=!1,H=!0,q=1/Dc)=>[...Xw((H?s.colorsSteppedVar:s.colorsLinearVar)(k)),...U?[Kw(s.scaleSteppedVar(k),s.variance.zero||0,q)*255]:[]],s.interpVsup=(k,U,H=!1,q=1/Dc)=>[...Xw(s.vsup(k,U)),...H?[Kw(s.scaleStepped(k),s.value.zero||0,q)*255]:[]]}return t},VF=(t,e,n,r)=>{const i=Math.sqrt(3)/2,s=n,A=t,o=e,g=[[s+A,0+o],[s/2+A,s*i+o],[-s/2+A,s*i+o],[-s+A,0+o],[-s/2+A,-s*i+o],[s/2+A,-s*i+o]];return function(w){w.selectAll("path.area").data([g]).enter().append("path").attr("d",sO()).attr("fill",r)}},A2=[[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[.33,-.58,-1]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[-.33,-.58,-1],[0,0,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[.33,.58,-1],[0,.33,0],[0,-.33,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,.58,-1],[-.33,-.33,0],[.33,-.33,0],[0,.29,0]],[[0,0,-1],[-.67,0,-1],[.67,0,-1],[-.33,-.33,0],[.33,-.33,0],[-.33,.33,0],[.33,.33,0]],[[0,0,-1],[-.67,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[0,.58,0]],[[0,0,-1],[-.33,-.67,0],[.33,-.67,0],[-.33,0,0],[.33,0,0],[-.33,.67,0],[.33,.67,0]],[[0,0,0],[-.67,0,0],[.67,0,0],[-.33,.58,0],[.33,.58,0],[-.33,-.58,0],[.33,-.58,0]]],u2={longitude:-121.046040643251,latitude:37.53320315272563,zoom:7.3252675985610685,minZoom:7,maxZoom:15,pitch:50.85,bearing:32.58};new Sd;new Sd;new Sd;new Sd;new Sd;new Sd;const Rpe=new dB({color:[255,255,255],intensity:1.7}),Bpe=new YK({timestamp:Date.UTC(2019,6,1,22),color:[255,255,255],intensity:.8}),zpe={0:"Settlement",1:"Exchange",2:"Project",3:"Non-Project"},kr={0:"bl_h000",1:"CS3_ALT3_2022med_L2020ADV",2:"LTO_BA_EXP1_2022MED"},c2={0:"Scenario 1",1:"Scenario 2",2:"Scenario 3"},ph=new KT({ambientLight:Rpe,dirLight:Bpe}),Ope={longitude:-119.99582643167989,latitude:37.88453894208306,zoom:10.364947995424346,pitch:49.903969287830776,bearing:28.126875},Fpe={party:{value:{domain:[-100,100],color:Zl(kz(["red","purple","blue"]),-.8,.2)},variance:{domain:[400,0]}},votes:{value:{domain:[0,42508]},variance:{domain:[0,1]}},population:{value:{domain:[0,500],color:ule},variance:{domain:[100,0]}},poc:{value:{domain:[10,50],color:Zl(ole,.5,-.3)},variance:{domain:[0,200]}}},Npe={power:{value:{domain:[0,300]},variance:{domain:[0,100],range:[0,1]}},personnel:{value:{domain:[0,100]},variance:{domain:[0,1]}}},Upe={groundwater:{value:{domain:[-300,700],color:Zl(t=>lle(ms([.75,1])(t)),-.5,.5)},variance:{domain:[0,1e4]}},demand:{value:{domain:[0,150],color:Zl(nk,1,1)},variance:{domain:[0,650]}},unmetDemand:{value:{domain:[-150,0],range:[1,0],color:Zl(nk,0,0)},variance:{domain:[0,650]}},difference:{value:{domain:[-30,30],color:Zl(ile,0,0),zero:.5},variance:{domain:[0,650]}}},h2=NF(await(await fetch("./assets/hex_5_6.json")).json(),t=>t.DemandBaseline),Vpe=NF(await(await fetch("./assets/square_5_6.json")).json(),t=>t.DemandBaseline),Jw=await(await fetch("./assets/averages.json")).json(),jA=await(await fetch("./assets/demand_geo.json")).json(),f2=await(await fetch("./assets/election_hex_3_4.json")).json(),Gpe=await(await fetch("./assets/election_square_3_4.json")).json(),gv=await(await fetch("./assets/precinct_geo.json")).json(),QS=await(await fetch("./assets/groundwater_geo.json")).json(),$pe=await(await fetch("./assets/fire_hex_7_9.json")).json(),GF=await(await fetch("./assets/precinct_geo.json")).json(),vE=await(await fetch("./assets/county_geo.json")).json();function qS(){const[t,e]=je.useState(1027),[n,r]=je.useState(!1),[i,s]=je.useState(1);return je.useEffect(()=>{if(n){let A=setTimeout(()=>e(o=>o%1199+1),33.333333333333336);return function(){clearTimeout(A)}}},[t,n]),{speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r,curOption:i,setCurOption:s}}function jpe(t,e){var n,r,i,s,A,o,g,w,C,I,k=0,U=t.type==="FeatureCollection",H=t.type==="Feature",q=U?t.features.length:1;for(n=0;n<q;n++){for(o=U?t.features[n].geometry:H?t.geometry:t,w=U?t.features[n].properties:H?t.properties:{},C=U?t.features[n].bbox:H?t.bbox:void 0,I=U?t.features[n].id:H?t.id:void 0,g=o?o.type==="GeometryCollection":!1,A=g?o.geometries.length:1,i=0;i<A;i++){if(s=g?o.geometries[i]:o,s===null){if(e(null,k,w,C,I)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,k,w,C,I)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(e(s.geometries[r],k,w,C,I)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}k++}}function Hpe(t,e,n){var r=n;return jpe(t,function(i,s,A,o,g){s===0&&n===void 0?r=i:r=e(r,i,s,A,o,g)}),r}var V6=6378137;function d2(t){return Hpe(t,function(e,n){return e+Wpe(n)},0)}function Wpe(t){var e=0,n;switch(t.type){case"Polygon":return G6(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)e+=G6(t.coordinates[n]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function G6(t){var e=0;if(t&&t.length>0){e+=Math.abs($6(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs($6(t[n]))}return e}function $6(t){var e,n,r,i,s,A,o,g=0,w=t.length;if(w>2){for(o=0;o<w;o++)o===w-2?(i=w-2,s=w-1,A=0):o===w-1?(i=w-1,s=0,A=1):(i=o,s=o+1,A=o+2),e=t[i],n=t[s],r=t[A],g+=(eb(r[0])-eb(e[0]))*Math.sin(eb(n[1]));g=g*V6*V6/2}return g}function eb(t){return t*Math.PI/180}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Qpe(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,A;return A={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function o(w){return function(C){return g([w,C])}}function g(w){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(s=w[0]&2?i.return:w[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,w[1])).done)return s;switch(i=0,s&&(w=[w[0]&2,s.value]),w[0]){case 0:case 1:s=w;break;case 4:return n.label++,{value:w[1],done:!1};case 5:n.label++,i=w[1],w=[0];continue;case 7:w=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(w[0]===6||w[0]===2)){n=0;continue}if(w[0]===3&&(!s||w[1]>s[0]&&w[1]<s[3])){n.label=w[1];break}if(w[0]===6&&n.label<s[1]){n.label=s[1],s=w;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(w);break}s[2]&&n.ops.pop(),n.trys.pop();continue}w=e.call(t,n)}catch(C){w=[6,C],i=0}finally{r=s=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}}var Ah=function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t}();function qpe(t,e){return t>e?1:t<e?-1:0}function Nc(t,e,n){for(var r=new Ah(null,null),i=r,s=r;;){var A=n(t,e.key);if(A<0){if(e.left===null)break;if(n(t,e.left.key)<0){var o=e.left;if(e.left=o.right,o.right=e,e=o,e.left===null)break}s.left=e,s=e,e=e.left}else if(A>0){if(e.right===null)break;if(n(t,e.right.key)>0){var o=e.right;if(e.right=o.left,o.left=e,e=o,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function tb(t,e,n,r){var i=new Ah(t,e);if(n===null)return i.left=i.right=null,i;n=Nc(t,n,r);var s=r(t,n.key);return s<0?(i.left=n.left,i.right=n,n.left=null):s>=0&&(i.right=n.right,i.left=n,n.right=null),i}function j6(t,e,n){var r=null,i=null;if(e){e=Nc(t,e,n);var s=n(e.key,t);s===0?(r=e.left,i=e.right):s<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function Zpe(t,e,n){return e===null?t:(t===null||(e=Nc(t.key,e,n),e.left=t),e)}function xE(t,e,n,r,i){if(t){r(""+e+(n?" ":" ")+i(t)+`
`);var s=e+(n?"    ":"   ");t.left&&xE(t.left,s,!1,r,i),t.right&&xE(t.right,s,!0,r,i)}}var ZS=function(){function t(e){e===void 0&&(e=qpe),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=tb(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var r=new Ah(e,n);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,s=Nc(e,this._root,i),A=i(e,s.key);return A===0?this._root=s:(A<0?(r.left=s.left,r.right=s,s.left=null):A>0&&(r.right=s.right,r.left=s,s.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,r){var i;if(n===null)return null;n=Nc(e,n,r);var s=r(e,n.key);return s===0?(n.left===null?i=n.right:(i=Nc(e,n.left,r),i.right=n.right),this._size--,i):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Nc(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return n;i<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=Nc(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return!0;i<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var r=this._root,i=[],s=!1;!s;)r!==null?(i.push(r),r=r.left):i.length!==0?(r=i.pop(),e.call(n,r),r=r.right):s=!0;return this},t.prototype.range=function(e,n,r,i){for(var s=[],A=this._comparator,o=this._root,g;s.length!==0||o;)if(o)s.push(o),o=o.left;else{if(o=s.pop(),g=A(o.key,n),g>0)break;if(A(o.key,e)>=0&&r.call(i,o))return this;o=o.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var r=n.key;return e.push(r)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var r=n.data;return e.push(r)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,r=!1,i=0,s=[];!r;)if(n)s.push(n),n=n.left;else if(s.length>0){if(n=s.pop(),i===e)return n;i++,n=n.right}else r=!0;return null},t.prototype.next=function(e){var n=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?(r=n,n=n.left):n=n.right}return r},t.prototype.prev=function(e){var n=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var i=this._comparator;n;){var s=i(e.key,n.key);if(s===0)break;s<0?n=n.left:(r=n,n=n.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return Xpe(this._root)},t.prototype.load=function(e,n,r){n===void 0&&(n=[]),r===void 0&&(r=!1);var i=e.length,s=this._comparator;if(r&&EE(e,n,0,i-1,s),this._root===null)this._root=wE(e,n,0,i),this._size=i;else{var A=Kpe(this.toList(),Ype(e,n),s);i=this._size+i,this._root=bE({head:A},0,i)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var n=[];return xE(this._root,"",!0,function(r){return n.push(r)},e),n.join("")},t.prototype.update=function(e,n,r){var i=this._comparator,s=j6(e,this._root,i),A=s.left,o=s.right;i(e,n)<0?o=tb(n,r,o,i):A=tb(n,r,A,i),this._root=Zpe(A,o,i)},t.prototype.split=function(e){return j6(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e,n,r;return Qpe(this,function(i){switch(i.label){case 0:e=this._root,n=[],r=!1,i.label=1;case 1:return r?[3,6]:e===null?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return n.length===0?[3,4]:(e=n.pop(),[4,e]);case 3:return i.sent(),e=e.right,[3,5];case 4:r=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},t}();function wE(t,e,n,r){var i=r-n;if(i>0){var s=n+Math.floor(i/2),A=t[s],o=e[s],g=new Ah(A,o);return g.left=wE(t,e,n,s),g.right=wE(t,e,s+1,r),g}return null}function Ype(t,e){for(var n=new Ah(null,null),r=n,i=0;i<t.length;i++)r=r.next=new Ah(t[i],e[i]);return r.next=null,n.next}function Xpe(t){for(var e=t,n=[],r=!1,i=new Ah(null,null),s=i;!r;)e?(n.push(e),e=e.left):n.length>0?(e=s=s.next=n.pop(),e=e.right):r=!0;return s.next=null,i.next}function bE(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),s=bE(t,e,i),A=t.head;return A.left=s,t.head=t.head.next,A.right=bE(t,i+1,n),A}return null}function Kpe(t,e,n){for(var r=new Ah(null,null),i=r,s=t,A=e;s!==null&&A!==null;)n(s.key,A.key)<0?(i.next=s,s=s.next):(i.next=A,A=A.next),i=i.next;return s!==null?i.next=s:A!==null&&(i.next=A),r.next}function EE(t,e,n,r,i){if(!(n>=r)){for(var s=t[n+r>>1],A=n-1,o=r+1;;){do A++;while(i(t[A],s)<0);do o--;while(i(t[o],s)>0);if(A>=o)break;var g=t[A];t[A]=t[o],t[o]=g,g=e[A],e[A]=e[o],e[o]=g}EE(t,e,n,o,i),EE(t,e,o+1,r,i)}}const Ep=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,TE=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x,i=t.ll.y<e.ll.y?e.ll.y:t.ll.y,s=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:n,y:i},ur:{x:r,y:s}}};let Wc=Number.EPSILON;Wc===void 0&&(Wc=Math.pow(2,-52));const Jpe=Wc*Wc,H6=(t,e)=>{if(-Wc<t&&t<Wc&&-Wc<e&&e<Wc)return 0;const n=t-e;return n*n<Jpe*t*e?0:t<e?-1:1};class ege{constructor(){this.reset()}reset(){this.xRounder=new W6,this.yRounder=new W6}round(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}class W6{constructor(){this.tree=new ZS,this.round(0)}round(e){const n=this.tree.add(e),r=this.tree.prev(n);if(r!==null&&H6(n.key,r.key)===0)return this.tree.remove(e),r.key;const i=this.tree.next(n);return i!==null&&H6(n.key,i.key)===0?(this.tree.remove(e),i.key):e}}const Zg=new ege,By=(t,e)=>t.x*e.y-t.y*e.x,$F=(t,e)=>t.x*e.x+t.y*e.y,Q6=(t,e,n)=>{const r=yoe(t.x,t.y,e.x,e.y,n.x,n.y);return r>0?-1:r<0?1:0},p2=t=>Math.sqrt($F(t,t)),tge=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return By(i,r)/p2(i)/p2(r)},nge=(t,e,n)=>{const r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return $F(i,r)/p2(i)/p2(r)},q6=(t,e,n)=>e.y===0?null:{x:t.x+e.x/e.y*(n-t.y),y:n},Z6=(t,e,n)=>e.x===0?null:{x:n,y:t.y+e.y/e.x*(n-t.x)},rge=(t,e,n,r)=>{if(e.x===0)return Z6(n,r,t.x);if(r.x===0)return Z6(t,e,n.x);if(e.y===0)return q6(n,r,t.y);if(r.y===0)return q6(t,e,n.y);const i=By(e,r);if(i==0)return null;const s={x:n.x-t.x,y:n.y-t.y},A=By(s,e)/i,o=By(s,r)/i,g=t.x+o*e.x,w=n.x+A*r.x,C=t.y+o*e.y,I=n.y+A*r.y,k=(g+w)/2,U=(C+I)/2;return{x:k,y:U}};class il{static compare(e,n){const r=il.comparePoints(e.point,n.point);return r!==0?r:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:ih.compare(e.segment,n.segment))}static comparePoints(e,n){return e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0}constructor(e,n){e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const n=e.point.events;for(let r=0,i=n.length;r<i;r++){const s=n[r];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let n=0;n<e;n++){const r=this.point.events[n];if(r.segment.consumedBy===void 0)for(let i=n+1;i<e;i++){const s=this.point.events[i];s.consumedBy===void 0&&r.otherSE.point.events===s.otherSE.point.events&&r.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const e=[];for(let n=0,r=this.point.events.length;n<r;n++){const i=this.point.events[n];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&e.push(i)}return e}getLeftmostComparator(e){const n=new Map,r=i=>{const s=i.otherSE;n.set(i,{sine:tge(this.point,e.point,s.point),cosine:nge(this.point,e.point,s.point)})};return(i,s)=>{n.has(i)||r(i),n.has(s)||r(s);const{sine:A,cosine:o}=n.get(i),{sine:g,cosine:w}=n.get(s);return A>=0&&g>=0?o<w?1:o>w?-1:0:A<0&&g<0?o<w?-1:o>w?1:0:g<A?-1:g>A?1:0}}}let ige=0;class ih{static compare(e,n){const r=e.leftSE.point.x,i=n.leftSE.point.x,s=e.rightSE.point.x,A=n.rightSE.point.x;if(A<r)return 1;if(s<i)return-1;const o=e.leftSE.point.y,g=n.leftSE.point.y,w=e.rightSE.point.y,C=n.rightSE.point.y;if(r<i){if(g<o&&g<w)return 1;if(g>o&&g>w)return-1;const I=e.comparePoint(n.leftSE.point);if(I<0)return 1;if(I>0)return-1;const k=n.comparePoint(e.rightSE.point);return k!==0?k:-1}if(r>i){if(o<g&&o<C)return-1;if(o>g&&o>C)return 1;const I=n.comparePoint(e.leftSE.point);if(I!==0)return I;const k=e.comparePoint(n.rightSE.point);return k<0?1:k>0?-1:1}if(o<g)return-1;if(o>g)return 1;if(s<A){const I=n.comparePoint(e.rightSE.point);if(I!==0)return I}if(s>A){const I=e.comparePoint(n.rightSE.point);if(I<0)return 1;if(I>0)return-1}if(s!==A){const I=w-o,k=s-r,U=C-g,H=A-i;if(I>k&&U<H)return 1;if(I<k&&U>H)return-1}return s>A?1:s<A||w<C?-1:w>C?1:e.id<n.id?-1:e.id>n.id?1:0}constructor(e,n,r,i){this.id=++ige,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=i}static fromRing(e,n,r){let i,s,A;const o=il.comparePoints(e,n);if(o<0)i=e,s=n,A=1;else if(o>0)i=n,s=e,A=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const g=new il(i,!0),w=new il(s,!1);return new ih(g,w,[r],[A])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<n?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}comparePoint(e){if(this.isAnEndpoint(e))return 0;const n=this.leftSE.point,r=this.rightSE.point,i=this.vector();if(n.x===r.x)return e.x===n.x?0:e.x<n.x?1:-1;const s=(e.y-n.y)/i.y,A=n.x+s*i.x;if(e.x===A)return 0;const o=(e.x-n.x)/i.x,g=n.y+o*i.y;return e.y===g?0:e.y<g?-1:1}getIntersection(e){const n=this.bbox(),r=e.bbox(),i=TE(n,r);if(i===null)return null;const s=this.leftSE.point,A=this.rightSE.point,o=e.leftSE.point,g=e.rightSE.point,w=Ep(n,o)&&this.comparePoint(o)===0,C=Ep(r,s)&&e.comparePoint(s)===0,I=Ep(n,g)&&this.comparePoint(g)===0,k=Ep(r,A)&&e.comparePoint(A)===0;if(C&&w)return k&&!I?A:!k&&I?g:null;if(C)return I&&s.x===g.x&&s.y===g.y?null:s;if(w)return k&&A.x===o.x&&A.y===o.y?null:o;if(k&&I)return null;if(k)return A;if(I)return g;const U=rge(s,this.vector(),o,e.vector());return U===null||!Ep(i,U)?null:Zg.round(U.x,U.y)}split(e){const n=[],r=e.events!==void 0,i=new il(e,!0),s=new il(e,!1),A=this.rightSE;this.replaceRightSE(s),n.push(s),n.push(i);const o=new ih(i,A,this.rings.slice(),this.windings.slice());return il.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),il.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),s.checkForConsuming()),n}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let n=0,r=this.windings.length;n<r;n++)this.windings[n]*=-1}consume(e){let n=this,r=e;for(;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=ih.compare(n,r);if(i!==0){if(i>0){const s=n;n=r,r=s}if(n.prev===r){const s=n;n=r,r=s}for(let s=0,A=r.rings.length;s<A;s++){const o=r.rings[s],g=r.windings[s],w=n.rings.indexOf(o);w===-1?(n.rings.push(o),n.windings.push(g)):n.windings[w]+=g}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const n=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let o=0,g=this.rings.length;o<g;o++){const w=this.rings[o],C=this.windings[o],I=n.indexOf(w);I===-1?(n.push(w),r.push(C)):r[I]+=C}const s=[],A=[];for(let o=0,g=n.length;o<g;o++){if(r[o]===0)continue;const w=n[o],C=w.poly;if(A.indexOf(C)===-1)if(w.isExterior)s.push(C);else{A.indexOf(C)===-1&&A.push(C);const I=s.indexOf(w.poly);I!==-1&&s.splice(I,1)}}for(let o=0,g=s.length;o<g;o++){const w=s[o].multiPoly;i.indexOf(w)===-1&&i.push(w)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(Yl.type){case"union":{const r=e.length===0,i=n.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;e.length<n.length?(r=e.length,i=n.length):(r=n.length,i=e.length),this._isInResult=i===Yl.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(e.length-n.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(e)!==r(n);break}default:throw new Error(`Unrecognized operation type found ${Yl.type}`)}return this._isInResult}}class Y6{constructor(e,n,r){if(!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=Zg.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let s=i;for(let A=1,o=e.length;A<o;A++){if(typeof e[A][0]!="number"||typeof e[A][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let g=Zg.round(e[A][0],e[A][1]);g.x===s.x&&g.y===s.y||(this.segments.push(ih.fromRing(s,g,this)),g.x<this.bbox.ll.x&&(this.bbox.ll.x=g.x),g.y<this.bbox.ll.y&&(this.bbox.ll.y=g.y),g.x>this.bbox.ur.x&&(this.bbox.ur.x=g.x),g.y>this.bbox.ur.y&&(this.bbox.ur.y=g.y),s=g)}(i.x!==s.x||i.y!==s.y)&&this.segments.push(ih.fromRing(s,i,this))}getSweepEvents(){const e=[];for(let n=0,r=this.segments.length;n<r;n++){const i=this.segments[n];e.push(i.leftSE),e.push(i.rightSE)}return e}}class sge{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Y6(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,i=e.length;r<i;r++){const s=new Y6(e[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}getSweepEvents(){const e=this.exteriorRing.getSweepEvents();for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getSweepEvents();for(let s=0,A=i.length;s<A;s++)e.push(i[s])}return e}}class X6{constructor(e,n){if(!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let r=0,i=e.length;r<i;r++){const s=new sge(e[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}getSweepEvents(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getSweepEvents();for(let s=0,A=i.length;s<A;s++)e.push(i[s])}return e}}class g2{static factory(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.isInResult()||s.ringOut)continue;let A=null,o=s.leftSE,g=s.rightSE;const w=[o],C=o.point,I=[];for(;A=o,o=g,w.push(o),o.point!==C;)for(;;){const k=o.getAvailableLinkedEvents();if(k.length===0){const q=w[0].point,se=w[w.length-1].point;throw new Error(`Unable to complete output ring starting at [${q.x}, ${q.y}]. Last matching segment found ends at [${se.x}, ${se.y}].`)}if(k.length===1){g=k[0].otherSE;break}let U=null;for(let q=0,se=I.length;q<se;q++)if(I[q].point===o.point){U=q;break}if(U!==null){const q=I.splice(U)[0],se=w.splice(q.index);se.unshift(se[0].otherSE),n.push(new g2(se.reverse()));continue}I.push({index:w.length,point:o.point});const H=o.getLeftmostComparator(A);g=k.sort(H)[0].otherSE;break}n.push(new g2(w))}return n}constructor(e){this.events=e;for(let n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}getGeom(){let e=this.events[0].point;const n=[e];for(let w=1,C=this.events.length-1;w<C;w++){const I=this.events[w].point,k=this.events[w+1].point;Q6(I,e,k)!==0&&(n.push(I),e=I)}if(n.length===1)return null;const r=n[0],i=n[1];Q6(r,e,i)===0&&n.shift(),n.push(n[0]);const s=this.isExteriorRing()?1:-1,A=this.isExteriorRing()?0:n.length-1,o=this.isExteriorRing()?n.length:-1,g=[];for(let w=A;w!=o;w+=s)g.push([n[w].x,n[w].y]);return g}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let e=this.events[0];for(let i=1,s=this.events.length;i<s;i++){const A=this.events[i];il.compare(e,A)>0&&(e=A)}let n=e.segment.prevInResult(),r=n?n.prevInResult():null;for(;;){if(!n)return null;if(!r)return n.ringOut;if(r.ringOut!==n.ringOut)return r.ringOut.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut.enclosingRing();n=r.prevInResult(),r=n?n.prevInResult():null}}}class K6{constructor(e){this.exteriorRing=e,e.poly=this,this.interiorRings=[]}addInterior(e){this.interiorRings.push(e),e.poly=this}getGeom(){const e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(let n=0,r=this.interiorRings.length;n<r;n++){const i=this.interiorRings[n].getGeom();i!==null&&e.push(i)}return e}}class oge{constructor(e){this.rings=e,this.polys=this._composePolys(e)}getGeom(){const e=[];for(let n=0,r=this.polys.length;n<r;n++){const i=this.polys[n].getGeom();i!==null&&e.push(i)}return e}_composePolys(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];if(!s.poly)if(s.isExteriorRing())n.push(new K6(s));else{const A=s.enclosingRing();A.poly||n.push(new K6(A)),A.poly.addInterior(s)}}return n}}class age{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ih.compare;this.queue=e,this.tree=new ZS(n),this.segments=[]}process(e){const n=e.segment,r=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),r;const i=e.isLeft?this.tree.add(n):this.tree.find(n);if(!i)throw new Error(`Unable to find segment #${n.id} [${n.leftSE.point.x}, ${n.leftSE.point.y}] -> [${n.rightSE.point.x}, ${n.rightSE.point.y}] in SweepLine tree.`);let s=i,A=i,o,g;for(;o===void 0;)s=this.tree.prev(s),s===null?o=null:s.key.consumedBy===void 0&&(o=s.key);for(;g===void 0;)A=this.tree.next(A),A===null?g=null:A.key.consumedBy===void 0&&(g=A.key);if(e.isLeft){let w=null;if(o){const I=o.getIntersection(n);if(I!==null&&(n.isAnEndpoint(I)||(w=I),!o.isAnEndpoint(I))){const k=this._splitSafely(o,I);for(let U=0,H=k.length;U<H;U++)r.push(k[U])}}let C=null;if(g){const I=g.getIntersection(n);if(I!==null&&(n.isAnEndpoint(I)||(C=I),!g.isAnEndpoint(I))){const k=this._splitSafely(g,I);for(let U=0,H=k.length;U<H;U++)r.push(k[U])}}if(w!==null||C!==null){let I=null;w===null?I=C:C===null?I=w:I=il.comparePoints(w,C)<=0?w:C,this.queue.remove(n.rightSE),r.push(n.rightSE);const k=n.split(I);for(let U=0,H=k.length;U<H;U++)r.push(k[U])}r.length>0?(this.tree.remove(n),r.push(e)):(this.segments.push(n),n.prev=o)}else{if(o&&g){const w=o.getIntersection(g);if(w!==null){if(!o.isAnEndpoint(w)){const C=this._splitSafely(o,w);for(let I=0,k=C.length;I<k;I++)r.push(C[I])}if(!g.isAnEndpoint(w)){const C=this._splitSafely(g,w);for(let I=0,k=C.length;I<k;I++)r.push(C[I])}}}this.tree.remove(n)}return r}_splitSafely(e,n){this.tree.remove(e);const r=e.rightSE;this.queue.remove(r);const i=e.split(n);return i.push(r),e.consumedBy===void 0&&this.tree.add(e),i}}const J6=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,lge=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Age{run(e,n,r){Yl.type=e,Zg.reset();const i=[new X6(n,!0)];for(let I=0,k=r.length;I<k;I++)i.push(new X6(r[I],!1));if(Yl.numMultiPolys=i.length,Yl.type==="difference"){const I=i[0];let k=1;for(;k<i.length;)TE(i[k].bbox,I.bbox)!==null?k++:i.splice(k,1)}if(Yl.type==="intersection")for(let I=0,k=i.length;I<k;I++){const U=i[I];for(let H=I+1,q=i.length;H<q;H++)if(TE(U.bbox,i[H].bbox)===null)return[]}const s=new ZS(il.compare);for(let I=0,k=i.length;I<k;I++){const U=i[I].getSweepEvents();for(let H=0,q=U.length;H<q;H++)if(s.insert(U[H]),s.size>J6)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const A=new age(s);let o=s.size,g=s.pop();for(;g;){const I=g.key;if(s.size===o){const U=I.segment;throw new Error(`Unable to pop() ${I.isLeft?"left":"right"} SweepEvent [${I.point.x}, ${I.point.y}] from segment #${U.id} [${U.leftSE.point.x}, ${U.leftSE.point.y}] -> [${U.rightSE.point.x}, ${U.rightSE.point.y}] from queue.`)}if(s.size>J6)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(A.segments.length>lge)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const k=A.process(I);for(let U=0,H=k.length;U<H;U++){const q=k[U];q.consumedBy===void 0&&s.insert(q)}o=s.size,g=s.pop()}Zg.reset();const w=g2.factory(A.segments);return new oge(w).getGeom()}}const Yl=new Age,uge=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yl.run("union",t,n)},cge=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yl.run("intersection",t,n)},hge=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yl.run("xor",t,n)},fge=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yl.run("difference",t,n)};var dge={union:uge,intersection:cge,xor:hge,difference:fge};function jF(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function pge(t,e,n){n===void 0&&(n={});for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var A=0;A<s[s.length-1].length;A++)if(s[s.length-1][A]!==s[0][A])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:t};return jF(o,e,n)}function gge(t,e,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:t};return jF(r,e,n)}function e8(t){return t.type==="Feature"?t.geometry:t}function m2(t,e,n){n===void 0&&(n={});var r=e8(t),i=e8(e),s=dge.intersection(r.coordinates,i.coordinates);return s.length===0?null:s.length===1?pge(s[0],n.properties):gge(s,n.properties)}var It=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(K){return e.locateFile?e.locateFile(K,i):i+K}var A;document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",A=function(W,ee,he){var a=new XMLHttpRequest;a.open("GET",W,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status==200||a.status==0&&a.response){ee(a.response);return}var Le=Cr(W);if(Le){ee(Le.buffer);return}he()},a.onerror=he,a.send(null)};var o=e.print||console.log.bind(console),g=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var w=0,C=function(K){w=K},I=function(){return w},k=8;function U(K,W,ee,he){switch(ee=ee||"i8",ee.charAt(ee.length-1)==="*"&&(ee="i32"),ee){case"i1":rt[K>>0]=W;break;case"i8":rt[K>>0]=W;break;case"i16":mt[K>>1]=W;break;case"i32":Kt[K>>2]=W;break;case"i64":Mi=[W>>>0,(Fr=W,+er(Fr)>=1?Fr>0?(or(+mr(Fr/4294967296),4294967295)|0)>>>0:~~+Hn((Fr-+(~~Fr>>>0))/4294967296)>>>0:0)],Kt[K>>2]=Mi[0],Kt[K+4>>2]=Mi[1];break;case"float":Tt[K>>2]=W;break;case"double":dn[K>>3]=W;break;default:Rr("invalid type for setValue: "+ee)}}function H(K,W,ee){switch(W=W||"i8",W.charAt(W.length-1)==="*"&&(W="i32"),W){case"i1":return rt[K>>0];case"i8":return rt[K>>0];case"i16":return mt[K>>1];case"i32":return Kt[K>>2];case"i64":return Kt[K>>2];case"float":return Tt[K>>2];case"double":return dn[K>>3];default:Rr("invalid type for getValue: "+W)}return null}var q=!1;function se(K,W){K||Rr("Assertion failed: "+W)}function X(K){var W=e["_"+K];return se(W,"Cannot call unknown function "+K+", make sure it is exported"),W}function te(K,W,ee,he,a){var G={string:function(ft){var Dt=0;if(ft!=null&&ft!==0){var Rt=(ft.length<<2)+1;Dt=zs(Rt),Qe(ft,Dt,Rt)}return Dt},array:function(ft){var Dt=zs(ft.length);return Ke(ft,Dt),Dt}};function Le(ft){return W==="string"?Se(ft):W==="boolean"?!!ft:ft}var Ie=X(K),Pe=[],ke=0;if(he)for(var qe=0;qe<he.length;qe++){var lt=G[ee[qe]];lt?(ke===0&&(ke=oi()),Pe[qe]=lt(he[qe])):Pe[qe]=he[qe]}var We=Ie.apply(null,Pe);return We=Le(We),ke!==0&&Dr(ke),We}function ie(K,W,ee,he){ee=ee||[];var a=ee.every(function(Le){return Le==="number"}),G=W!=="string";return G&&a&&!he?X(K):function(){return te(K,W,ee,arguments)}}var fe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function me(K,W,ee){for(var he=W+ee,a=W;K[a]&&!(a>=he);)++a;if(a-W>16&&K.subarray&&fe)return fe.decode(K.subarray(W,a));for(var G="";W<a;){var Le=K[W++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var Ie=K[W++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|Ie);continue}var Pe=K[W++]&63;if((Le&240)==224?Le=(Le&15)<<12|Ie<<6|Pe:Le=(Le&7)<<18|Ie<<12|Pe<<6|K[W++]&63,Le<65536)G+=String.fromCharCode(Le);else{var ke=Le-65536;G+=String.fromCharCode(55296|ke>>10,56320|ke&1023)}}return G}function Se(K,W){return K?me(Ze,K,W):""}function He(K,W,ee,he){if(!(he>0))return 0;for(var a=ee,G=ee+he-1,Le=0;Le<K.length;++Le){var Ie=K.charCodeAt(Le);if(Ie>=55296&&Ie<=57343){var Pe=K.charCodeAt(++Le);Ie=65536+((Ie&1023)<<10)|Pe&1023}if(Ie<=127){if(ee>=G)break;W[ee++]=Ie}else if(Ie<=2047){if(ee+1>=G)break;W[ee++]=192|Ie>>6,W[ee++]=128|Ie&63}else if(Ie<=65535){if(ee+2>=G)break;W[ee++]=224|Ie>>12,W[ee++]=128|Ie>>6&63,W[ee++]=128|Ie&63}else{if(ee+3>=G)break;W[ee++]=240|Ie>>18,W[ee++]=128|Ie>>12&63,W[ee++]=128|Ie>>6&63,W[ee++]=128|Ie&63}}return W[ee]=0,ee-a}function Qe(K,W,ee){return He(K,Ze,W,ee)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Ke(K,W){rt.set(K,W)}function nt(K,W){return K%W>0&&(K+=W-K%W),K}var Ne,rt,Ze,mt,Kt,Tt,dn;function _t(K){Ne=K,e.HEAP8=rt=new Int8Array(K),e.HEAP16=mt=new Int16Array(K),e.HEAP32=Kt=new Int32Array(K),e.HEAPU8=Ze=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Tt=new Float32Array(K),e.HEAPF64=dn=new Float64Array(K)}var Et=5266928,Jt=24016,kn=e.TOTAL_MEMORY||33554432;e.buffer?Ne=e.buffer:Ne=new ArrayBuffer(kn),kn=Ne.byteLength,_t(Ne),Kt[Jt>>2]=Et;function Tn(K){for(;K.length>0;){var W=K.shift();if(typeof W=="function"){W();continue}var ee=W.func;typeof ee=="number"?W.arg===void 0?e.dynCall_v(ee):e.dynCall_vi(ee,W.arg):ee(W.arg===void 0?null:W.arg)}}var Tr=[],Jn=[],ir=[],ur=[];function Un(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Cn(e.preRun.shift());Tn(Tr)}function wr(){Tn(Jn)}function wt(){Tn(ir)}function rn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)xt(e.postRun.shift());Tn(ur)}function Cn(K){Tr.unshift(K)}function xt(K){ur.unshift(K)}var er=Math.abs,Hn=Math.ceil,mr=Math.floor,or=Math.min,tr=0,Kr=null;function Vn(K){tr++,e.monitorRunDependencies&&e.monitorRunDependencies(tr)}function Si(K){if(tr--,e.monitorRunDependencies&&e.monitorRunDependencies(tr),tr==0&&Kr){var W=Kr;Kr=null,W()}}e.preloadedImages={},e.preloadedAudios={};var Wn=null,Fi="data:application/octet-stream;base64,";function fo(K){return String.prototype.startsWith?K.startsWith(Fi):K.indexOf(Fi)===0}var Fr,Mi;Wn="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Oo=24032;function is(K){return K}function ct(K){var W=/\b__Z[\w\d_]+/g;return K.replace(W,function(ee){var he=ee;return ee===he?ee:he+" ["+ee+"]"})}function kt(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(W){K=W}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Bs(){var K=kt();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ct(K)}function yi(K,W,ee,he){Rr("Assertion failed: "+Se(K)+", at: "+[W?Se(W):"unknown filename",ee,he?Se(he):"unknown function"])}function Bn(){return rt.length}function Ni(K,W,ee){Ze.set(Ze.subarray(W,W+ee),K)}function Ci(K){return e.___errno_location&&(Kt[e.___errno_location()>>2]=K),K}function Pi(K){Rr("OOM")}function ss(K){try{var W=new ArrayBuffer(K);return W.byteLength!=K?void 0:(new Int8Array(W).set(rt),jr(W),_t(W),1)}catch{}}function Lt(K){var W=Bn(),ee=16777216,he=2147483648-ee;if(K>he)return!1;for(var a=16777216,G=Math.max(W,a);G<K;)G<=536870912?G=nt(2*G,ee):G=Math.min(nt((3*G+2147483648)/4,ee),he);var Le=ss(G);return!!Le}var Sn=typeof atob=="function"?atob:function(K){var W="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ee="",he,a,G,Le,Ie,Pe,ke,qe=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=W.indexOf(K.charAt(qe++)),Ie=W.indexOf(K.charAt(qe++)),Pe=W.indexOf(K.charAt(qe++)),ke=W.indexOf(K.charAt(qe++)),he=Le<<2|Ie>>4,a=(Ie&15)<<4|Pe>>2,G=(Pe&3)<<6|ke,ee=ee+String.fromCharCode(he),Pe!==64&&(ee=ee+String.fromCharCode(a)),ke!==64&&(ee=ee+String.fromCharCode(G));while(qe<K.length);return ee};function bn(K){try{for(var W=Sn(K),ee=new Uint8Array(W.length),he=0;he<W.length;++he)ee[he]=W.charCodeAt(he);return ee}catch{throw new Error("Converting base64 string to bytes failed.")}}function Cr(K){if(fo(K))return bn(K.slice(Fi.length))}var xs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},yn={a:Rr,b:C,c:I,d:yi,e:Ci,f:Bn,g:Ni,h:Lt,i:Pi,j:is,k:ct,l:ss,m:kt,n:Bs,o:Oo,p:Jt},Ye=function(K,W,ee){"almost asm";var he=new K.Int8Array(ee),a=new K.Int32Array(ee);new K.Uint8Array(ee),new K.Float32Array(ee);var G=new K.Float64Array(ee),Le=W.p|0,Ie=K.Math.floor,Pe=K.Math.abs,ke=K.Math.sqrt,qe=K.Math.pow,lt=K.Math.cos,We=K.Math.sin,ft=K.Math.tan,Dt=K.Math.acos,Rt=K.Math.asin,sn=K.Math.atan,jt=K.Math.atan2,pn=K.Math.ceil,qt=K.Math.imul,an=K.Math.min,xn=K.Math.clz32,Ft=W.b,Oe=W.c,Ct=W.d,Me=W.e,un=W.f,ai=W.g,nr=W.h,aa=W.i,De=24048;function za(l){return he=new Int8Array(l),a=new Int32Array(l),G=new Float64Array(l),ee=l,!0}function we(l){l=l|0;var h=0;return h=De,De=De+l|0,De=De+15&-16,h|0}function Fo(){return De|0}function ws(l){l=l|0,De=l}function Oa(l,h){l=l|0,De=l}function Fa(l){return l=l|0,(qt(l*3|0,l+1|0)|0)+1|0}function la(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;Aa(l,h,d,x,0)|0&&(S=(qt(d*3|0,d+1|0)|0)+1|0,L(x|0,0,S<<3|0)|0,b=Yi(S,4)|0,b&&(Jr(l,h,d,x,b,S,0),hn(b)))}function gl(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0;if(Aa(l,h,d,x,b)|0){if(S=(qt(d*3|0,d+1|0)|0)+1|0,L(x|0,0,S<<3|0)|0,b|0){L(b|0,0,S<<2|0)|0,Jr(l,h,d,x,b,S,0);return}b=Yi(S,4)|0,b&&(Jr(l,h,d,x,b,S,0),hn(b))}}function Aa(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0;if(ue=De,De=De+16|0,ne=ue,S=x,a[S>>2]=l,a[S+4>>2]=h,S=(b|0)!=0,S&&(a[b>>2]=0),Ir(l,h)|0)return ne=1,De=ue,ne|0;a[ne>>2]=0;e:do if((d|0)>=1)if(S)for(j=0,Y=1,ae=1,M=0,S=l;;){if(!(M|j)){if(S=ge(S,h,4,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(Ir(S,h)|0){S=1;break e}}if(S=ge(S,h,a[16+(j<<2)>>2]|0,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(l=x+(ae<<3)|0,a[l>>2]=S,a[l+4>>2]=h,a[b+(ae<<2)>>2]=Y,M=M+1|0,l=(M|0)==(Y|0),B=j+1|0,V=(B|0)==6,Ir(S,h)|0){S=1;break e}if(Y=Y+(V&l&1)|0,(Y|0)>(d|0)){S=0;break}else j=l?V?0:B:j,ae=ae+1|0,M=l?0:M}else for(j=0,Y=1,ae=1,M=0,S=l;;){if(!(M|j)){if(S=ge(S,h,4,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(Ir(S,h)|0){S=1;break e}}if(S=ge(S,h,a[16+(j<<2)>>2]|0,ne)|0,h=Oe()|0,(S|0)==0&(h|0)==0){S=2;break e}if(l=x+(ae<<3)|0,a[l>>2]=S,a[l+4>>2]=h,M=M+1|0,l=(M|0)==(Y|0),B=j+1|0,V=(B|0)==6,Ir(S,h)|0){S=1;break e}if(Y=Y+(V&l&1)|0,(Y|0)>(d|0)){S=0;break}else j=l?V?0:B:j,ae=ae+1|0,M=l?0:M}else S=0;while(0);return ne=S,De=ue,ne|0}function Jr(l,h,d,x,b,S,M){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0,S=S|0,M=M|0;var B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0;if(ae=De,De=De+16|0,Y=ae,(l|0)==0&(h|0)==0){De=ae;return}if(B=Hs(l|0,h|0,S|0,((S|0)<0)<<31>>31|0)|0,Oe()|0,V=x+(B<<3)|0,ne=V,ue=a[ne>>2]|0,ne=a[ne+4>>2]|0,j=(ue|0)==(l|0)&(ne|0)==(h|0),!((ue|0)==0&(ne|0)==0|j))do B=(B+1|0)%(S|0)|0,V=x+(B<<3)|0,ue=V,ne=a[ue>>2]|0,ue=a[ue+4>>2]|0,j=(ne|0)==(l|0)&(ue|0)==(h|0);while(!((ne|0)==0&(ue|0)==0|j));if(B=b+(B<<2)|0,j&&(a[B>>2]|0)<=(M|0)){De=ae;return}if(ue=V,a[ue>>2]=l,a[ue+4>>2]=h,a[B>>2]=M,(M|0)>=(d|0)){De=ae;return}ue=M+1|0,a[Y>>2]=0,ne=ge(l,h,2,Y)|0,Jr(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(l,h,3,Y)|0,Jr(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(l,h,1,Y)|0,Jr(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(l,h,5,Y)|0,Jr(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(l,h,4,Y)|0,Jr(ne,Oe()|0,d,x,b,S,ue),a[Y>>2]=0,ne=ge(l,h,6,Y)|0,Jr(ne,Oe()|0,d,x,b,S,ue),De=ae}function ge(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0;if((a[x>>2]|0)>0){b=0;do d=Gi(d)|0,b=b+1|0;while((b|0)<(a[x>>2]|0))}B=Mt(l|0,h|0,45)|0,Oe()|0,V=B&127,S=li(l,h)|0,b=Mt(l|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)M=6;else for(;;){if(ae=(15-b|0)*3|0,ne=Mt(l|0,h|0,ae|0)|0,Oe()|0,ne=ne&7,ue=(hi(b)|0)==0,b=b+-1|0,Y=Pt(7,0,ae|0)|0,h=h&~(Oe()|0),ae=Pt(a[(ue?464:48)+(ne*28|0)+(d<<2)>>2]|0,0,ae|0)|0,j=Oe()|0,d=a[(ue?672:256)+(ne*28|0)+(d<<2)>>2]|0,l=ae|l&~Y,h=j|h,!d){d=0;break e}if(!b){M=6;break}}while(0);(M|0)==6&&(ue=a[880+(V*28|0)+(d<<2)>>2]|0,ne=Pt(ue|0,0,45)|0,l=ne|l,h=Oe()|0|h&-1040385,d=a[4304+(V*28|0)+(d<<2)>>2]|0,(ue&127|0)==127&&(ue=Pt(a[880+(V*28|0)+20>>2]|0,0,45)|0,h=Oe()|0|h&-1040385,d=a[4304+(V*28|0)+20>>2]|0,l=ls(ue|l,h)|0,h=Oe()|0,a[x>>2]=(a[x>>2]|0)+1)),M=Mt(l|0,h|0,45)|0,Oe()|0,M=M&127;e:do if(en(M)|0){t:do if((li(l,h)|0)==1){if((V|0)!=(M|0))if(QA(M,a[7728+(V*28|0)>>2]|0)|0){l=qi(l,h)|0,S=1,h=Oe()|0;break}else{l=ls(l,h)|0,S=1,h=Oe()|0;break}switch(S|0){case 5:{l=qi(l,h)|0,h=Oe()|0,a[x>>2]=(a[x>>2]|0)+5,S=0;break t}case 3:{l=ls(l,h)|0,h=Oe()|0,a[x>>2]=(a[x>>2]|0)+1,S=0;break t}default:return ne=0,ue=0,Ft(ne|0),ue|0}}else S=0;while(0);if((d|0)>0){b=0;do l=_i(l,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}if((V|0)!=(M|0)){if(!(Pr(M)|0)){if((S|0)!=0|(li(l,h)|0)!=5)break;a[x>>2]=(a[x>>2]|0)+1;break}switch(B&127){case 8:case 118:break e}(li(l,h)|0)!=3&&(a[x>>2]=(a[x>>2]|0)+1)}}else if((d|0)>0){b=0;do l=ls(l,h)|0,h=Oe()|0,b=b+1|0;while((b|0)!=(d|0))}while(0);return a[x>>2]=((a[x>>2]|0)+d|0)%6|0,ne=h,ue=l,Ft(ne|0),ue|0}function Ee(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0;if(ae=De,De=De+16|0,Y=ae,!d)return Y=x,a[Y>>2]=l,a[Y+4>>2]=h,Y=0,De=ae,Y|0;a[Y>>2]=0;e:do if(Ir(l,h)|0)l=1;else{if(S=(d|0)>0,S){b=0,j=l;do{if(j=ge(j,h,4,Y)|0,h=Oe()|0,(j|0)==0&(h|0)==0){l=2;break e}if(b=b+1|0,Ir(j,h)|0){l=1;break e}}while((b|0)<(d|0));if(V=x,a[V>>2]=j,a[V+4>>2]=h,V=d+-1|0,S){S=0,M=1,b=j,l=h;do{if(b=ge(b,l,2,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(M<<3)|0,a[B>>2]=b,a[B+4>>2]=l,M=M+1|0,Ir(b,l)|0){l=1;break e}S=S+1|0}while((S|0)<(d|0));B=0,S=M;do{if(b=ge(b,l,3,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(M=x+(S<<3)|0,a[M>>2]=b,a[M+4>>2]=l,S=S+1|0,Ir(b,l)|0){l=1;break e}B=B+1|0}while((B|0)<(d|0));M=0;do{if(b=ge(b,l,1,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=l,S=S+1|0,Ir(b,l)|0){l=1;break e}M=M+1|0}while((M|0)<(d|0));M=0;do{if(b=ge(b,l,5,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=l,S=S+1|0,Ir(b,l)|0){l=1;break e}M=M+1|0}while((M|0)<(d|0));M=0;do{if(b=ge(b,l,4,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if(B=x+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=l,S=S+1|0,Ir(b,l)|0){l=1;break e}M=M+1|0}while((M|0)<(d|0));for(M=0;;){if(b=ge(b,l,6,Y)|0,l=Oe()|0,(b|0)==0&(l|0)==0){l=2;break e}if((M|0)!=(V|0))if(B=x+(S<<3)|0,a[B>>2]=b,a[B+4>>2]=l,!(Ir(b,l)|0))S=S+1|0;else{l=1;break e}if(M=M+1|0,(M|0)>=(d|0)){M=j,S=h;break}}}else M=j,b=j,S=h,l=h}else M=x,a[M>>2]=l,a[M+4>>2]=h,M=l,b=l,S=h,l=h;l=((M|0)!=(b|0)|(S|0)!=(l|0))&1}while(0);return Y=l,De=ae,Y|0}function Fe(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;if(S=De,De=De+48|0,b=S+8|0,x=S,B=l,M=a[B+4>>2]|0,d=x,a[d>>2]=a[B>>2],a[d+4>>2]=M,qa(x,b),b=Yn(b,h)|0,h=a[x>>2]|0,x=a[l+8>>2]|0,(x|0)<=0)return B=h,M=(b|0)<(B|0),B=M?B:b,B=B+12|0,De=S,B|0;d=a[l+12>>2]|0,l=0;do h=(a[d+(l<<3)>>2]|0)+h|0,l=l+1|0;while((l|0)<(x|0));return B=(b|0)<(h|0),B=B?h:b,B=B+12|0,De=S,B|0}function at(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;if(B=De,De=De+48|0,x=B+8|0,b=B,!(bt(l,h,d)|0)){De=B;return}if(V=l,S=a[V+4>>2]|0,M=b,a[M>>2]=a[V>>2],a[M+4>>2]=S,qa(b,x),M=Yn(x,h)|0,h=a[b>>2]|0,S=a[l+8>>2]|0,(S|0)>0){b=a[l+12>>2]|0,x=0;do h=(a[b+(x<<3)>>2]|0)+h|0,x=x+1|0;while((x|0)!=(S|0))}if(h=(M|0)<(h|0)?h:M,(h|0)<=-12){De=B;return}V=h+11|0,L(d|0,0,(((V|0)>0?V:0)<<3)+8|0)|0,De=B}function bt(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,y=0,m=0,v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0;if(de=De,De=De+112|0,N=de+80|0,V=de+72|0,Q=de,J=de+56|0,j=l+8|0,le=Xt((a[j>>2]<<5)+32|0)|0,le||Ct(22848,22448,800,22456),Gs(l,le),S=l,x=a[S+4>>2]|0,B=V,a[B>>2]=a[S>>2],a[B+4>>2]=x,qa(V,N),B=Yn(N,h)|0,x=a[V>>2]|0,S=a[j>>2]|0,(S|0)>0){M=a[l+12>>2]|0,b=0;do x=(a[M+(b<<3)>>2]|0)+x|0,b=b+1|0;while((b|0)!=(S|0))}if(B=(B|0)<(x|0)?x:B,O=B+12|0,b=Yi(O,8)|0,Y=Yi(O,8)|0,a[N>>2]=0,P=l,R=a[P+4>>2]|0,x=V,a[x>>2]=a[P>>2],a[x+4>>2]=R,x=Qt(V,O,h,N,b,Y)|0,x|0)return hn(b),hn(Y),hn(le),le=x,De=de,le|0;e:do if((a[j>>2]|0)>0){for(S=l+12|0,x=0;M=Qt((a[S>>2]|0)+(x<<3)|0,O,h,N,b,Y)|0,x=x+1|0,!(M|0);)if((x|0)>=(a[j>>2]|0))break e;return hn(b),hn(Y),hn(le),le=M,De=de,le|0}while(0);(B|0)>-12&&L(Y|0,0,((O|0)>1?O:1)<<3|0)|0;e:do if((a[N>>2]|0)>0){R=((O|0)<0)<<31>>31,xe=b,y=Y,m=b,v=b,E=Y,P=b,x=b,ve=b,Ge=Y,Te=Y,Ve=Y,b=Y;t:for(;;){for(Ce=a[N>>2]|0,ue=0,be=0,S=0;;){M=Q,B=M+56|0;do a[M>>2]=0,M=M+4|0;while((M|0)<(B|0));if(h=xe+(ue<<3)|0,V=a[h>>2]|0,h=a[h+4>>2]|0,Aa(V,h,1,Q,0)|0){M=Q,B=M+56|0;do a[M>>2]=0,M=M+4|0;while((M|0)<(B|0));M=Yi(7,4)|0,M|0&&(Jr(V,h,1,Q,M,7,0),hn(M))}ne=0;do{ae=Q+(ne<<3)|0,Y=a[ae>>2]|0,ae=a[ae+4>>2]|0;n:do if(!((Y|0)==0&(ae|0)==0)){if(V=Hs(Y|0,ae|0,O|0,R|0)|0,Oe()|0,M=d+(V<<3)|0,B=M,h=a[B>>2]|0,B=a[B+4>>2]|0,!((h|0)==0&(B|0)==0))for(j=0;;){if((j|0)>(O|0))break t;if((h|0)==(Y|0)&(B|0)==(ae|0))break n;if(V=(V+1|0)%(O|0)|0,M=d+(V<<3)|0,B=M,h=a[B>>2]|0,B=a[B+4>>2]|0,(h|0)==0&(B|0)==0)break;j=j+1|0}(Y|0)==0&(ae|0)==0||(Vs(Y,ae,J),au(l,le,J)|0&&(j=M,a[j>>2]=Y,a[j+4>>2]=ae,j=y+(S<<3)|0,a[j>>2]=Y,a[j+4>>2]=ae,S=S+1|0))}while(0);ne=ne+1|0}while(ne>>>0<7);if(be=be+1|0,(be|0)>=(Ce|0))break;ue=ue+1|0}if((Ce|0)>0&&L(m|0,0,Ce<<3|0)|0,a[N>>2]=S,(S|0)>0)Y=b,ae=Ve,ne=P,ue=Te,be=Ge,Ce=y,b=ve,Ve=x,Te=v,Ge=m,ve=Y,x=ae,P=E,E=ne,v=ue,m=be,y=xe,xe=Ce;else break e}return hn(v),hn(E),hn(le),le=-1,De=de,le|0}else x=Y;while(0);return hn(le),hn(b),hn(x),le=0,De=de,le|0}function Qt(l,h,d,x,b,S){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0,S=S|0;var M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,y=0,m=0,v=0,E=0,P=0,R=0,O=0,N=0;if(R=De,De=De+48|0,m=R+32|0,v=R+16|0,E=R,M=a[l>>2]|0,(M|0)<=0)return P=0,De=R,P|0;Ge=l+4|0,Te=m+8|0,Ve=v+8|0,xe=E+8|0,y=((h|0)<0)<<31>>31,ve=0;e:for(;;){B=a[Ge>>2]|0,be=B+(ve<<4)|0,a[m>>2]=a[be>>2],a[m+4>>2]=a[be+4>>2],a[m+8>>2]=a[be+8>>2],a[m+12>>2]=a[be+12>>2],(ve|0)==(M+-1|0)?(a[v>>2]=a[B>>2],a[v+4>>2]=a[B+4>>2],a[v+8>>2]=a[B+8>>2],a[v+12>>2]=a[B+12>>2]):(be=B+(ve+1<<4)|0,a[v>>2]=a[be>>2],a[v+4>>2]=a[be+4>>2],a[v+8>>2]=a[be+8>>2],a[v+12>>2]=a[be+12>>2]),be=ZA(m,v,d)|0;t:do if((be|0)>0){Ce=+(be|0),ue=0;n:for(;;){N=+(be-ue|0),O=+(ue|0),G[E>>3]=+G[m>>3]*N/Ce+ +G[v>>3]*O/Ce,G[xe>>3]=+G[Te>>3]*N/Ce+ +G[Ve>>3]*O/Ce,ae=$a(E,d)|0,ne=Oe()|0,B=Hs(ae|0,ne|0,h|0,y|0)|0,Oe()|0,M=S+(B<<3)|0,V=M,j=a[V>>2]|0,V=a[V+4>>2]|0;r:do if((j|0)==0&(V|0)==0)P=14;else for(Y=0;;){if((Y|0)>(h|0)){M=1;break r}if((j|0)==(ae|0)&(V|0)==(ne|0)){M=7;break r}if(B=(B+1|0)%(h|0)|0,M=S+(B<<3)|0,V=M,j=a[V>>2]|0,V=a[V+4>>2]|0,(j|0)==0&(V|0)==0){P=14;break}else Y=Y+1|0}while(0);switch((P|0)==14&&(P=0,(ae|0)==0&(ne|0)==0?M=7:(a[M>>2]=ae,a[M+4>>2]=ne,M=a[x>>2]|0,Y=b+(M<<3)|0,a[Y>>2]=ae,a[Y+4>>2]=ne,a[x>>2]=M+1,M=0)),M&7){case 7:case 0:break;default:break n}if(ue=ue+1|0,(be|0)<=(ue|0)){P=8;break t}}if(M|0){M=-1,P=20;break e}}else P=8;while(0);if((P|0)==8&&(P=0),ve=ve+1|0,M=a[l>>2]|0,(ve|0)>=(M|0)){M=0,P=20;break}}return(P|0)==20?(De=R,M|0):0}function Ln(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(j=De,De=De+176|0,V=j,(h|0)<1){br(d,0,0),De=j;return}M=l,M=Mt(a[M>>2]|0,a[M+4>>2]|0,52)|0,Oe()|0,br(d,(h|0)>6?h:6,M&15),M=0;do{if(x=l+(M<<3)|0,As(a[x>>2]|0,a[x+4>>2]|0,V),x=a[V>>2]|0,(x|0)>0){B=0;do S=V+8+(B<<4)|0,B=B+1|0,x=V+8+(((B|0)%(x|0)|0)<<4)|0,b=fu(d,x,S)|0,b?hu(d,b)|0:yc(d,S,x)|0,x=a[V>>2]|0;while((B|0)<(x|0))}M=M+1|0}while((M|0)!=(h|0));De=j}function Mr(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(S=De,De=De+32|0,x=S,b=S+16|0,Ln(l,h,b),a[d>>2]=0,a[d+4>>2]=0,a[d+8>>2]=0,l=Dl(b)|0,!l){ga(d)|0,Za(b),De=S;return}do{h=gh(d)|0;do mh(h,l)|0,M=l+16|0,a[x>>2]=a[M>>2],a[x+4>>2]=a[M+4>>2],a[x+8>>2]=a[M+8>>2],a[x+12>>2]=a[M+12>>2],hu(b,l)|0,l=_c(b,x)|0;while(l|0);l=Dl(b)|0}while(l|0);ga(d)|0,Za(b),De=S}function en(l){return l=l|0,a[7728+(l*28|0)+16>>2]|0}function Pr(l){return l=l|0,(l|0)==4|(l|0)==117|0}function Gn(l){return l=l|0,a[11152+((a[l>>2]|0)*216|0)+((a[l+4>>2]|0)*72|0)+((a[l+8>>2]|0)*24|0)+(a[l+12>>2]<<3)>>2]|0}function lA(l){return l=l|0,a[11152+((a[l>>2]|0)*216|0)+((a[l+4>>2]|0)*72|0)+((a[l+8>>2]|0)*24|0)+(a[l+12>>2]<<3)+4>>2]|0}function AA(l,h){l=l|0,h=h|0,l=7728+(l*28|0)|0,a[h>>2]=a[l>>2],a[h+4>>2]=a[l+4>>2],a[h+8>>2]=a[l+8>>2],a[h+12>>2]=a[l+12>>2]}function uA(l,h){l=l|0,h=h|0;var d=0,x=0;if(h>>>0>20)return h=-1,h|0;do if((a[11152+(h*216|0)>>2]|0)!=(l|0))if((a[11152+(h*216|0)+8>>2]|0)!=(l|0))if((a[11152+(h*216|0)+16>>2]|0)!=(l|0))if((a[11152+(h*216|0)+24>>2]|0)!=(l|0))if((a[11152+(h*216|0)+32>>2]|0)!=(l|0))if((a[11152+(h*216|0)+40>>2]|0)!=(l|0))if((a[11152+(h*216|0)+48>>2]|0)!=(l|0))if((a[11152+(h*216|0)+56>>2]|0)!=(l|0))if((a[11152+(h*216|0)+64>>2]|0)!=(l|0))if((a[11152+(h*216|0)+72>>2]|0)!=(l|0))if((a[11152+(h*216|0)+80>>2]|0)!=(l|0))if((a[11152+(h*216|0)+88>>2]|0)!=(l|0))if((a[11152+(h*216|0)+96>>2]|0)!=(l|0))if((a[11152+(h*216|0)+104>>2]|0)!=(l|0))if((a[11152+(h*216|0)+112>>2]|0)!=(l|0))if((a[11152+(h*216|0)+120>>2]|0)!=(l|0))if((a[11152+(h*216|0)+128>>2]|0)!=(l|0))if((a[11152+(h*216|0)+136>>2]|0)==(l|0))l=2,d=1,x=2;else{if((a[11152+(h*216|0)+144>>2]|0)==(l|0)){l=0,d=2,x=0;break}if((a[11152+(h*216|0)+152>>2]|0)==(l|0)){l=0,d=2,x=1;break}if((a[11152+(h*216|0)+160>>2]|0)==(l|0)){l=0,d=2,x=2;break}if((a[11152+(h*216|0)+168>>2]|0)==(l|0)){l=1,d=2,x=0;break}if((a[11152+(h*216|0)+176>>2]|0)==(l|0)){l=1,d=2,x=1;break}if((a[11152+(h*216|0)+184>>2]|0)==(l|0)){l=1,d=2,x=2;break}if((a[11152+(h*216|0)+192>>2]|0)==(l|0)){l=2,d=2,x=0;break}if((a[11152+(h*216|0)+200>>2]|0)==(l|0)){l=2,d=2,x=1;break}if((a[11152+(h*216|0)+208>>2]|0)==(l|0)){l=2,d=2,x=2;break}else l=-1;return l|0}else l=2,d=1,x=1;else l=2,d=1,x=0;else l=1,d=1,x=2;else l=1,d=1,x=1;else l=1,d=1,x=0;else l=0,d=1,x=2;else l=0,d=1,x=1;else l=0,d=1,x=0;else l=2,d=0,x=2;else l=2,d=0,x=1;else l=2,d=0,x=0;else l=1,d=0,x=2;else l=1,d=0,x=1;else l=1,d=0,x=0;else l=0,d=0,x=2;else l=0,d=0,x=1;else l=0,d=0,x=0;while(0);return h=a[11152+(h*216|0)+(d*72|0)+(l*24|0)+(x<<3)+4>>2]|0,h|0}function QA(l,h){return l=l|0,h=h|0,(a[7728+(l*28|0)+20>>2]|0)==(h|0)?(h=1,h|0):(h=(a[7728+(l*28|0)+24>>2]|0)==(h|0),h|0)}function qA(l,h){return l=l|0,h=h|0,a[880+(l*28|0)+(h<<2)>>2]|0}function cA(l,h){return l=l|0,h=h|0,(a[880+(l*28|0)>>2]|0)==(h|0)?(h=0,h|0):(a[880+(l*28|0)+4>>2]|0)==(h|0)?(h=1,h|0):(a[880+(l*28|0)+8>>2]|0)==(h|0)?(h=2,h|0):(a[880+(l*28|0)+12>>2]|0)==(h|0)?(h=3,h|0):(a[880+(l*28|0)+16>>2]|0)==(h|0)?(h=4,h|0):(a[880+(l*28|0)+20>>2]|0)==(h|0)?(h=5,h|0):((a[880+(l*28|0)+24>>2]|0)==(h|0)?6:7)|0}function ml(){return 122}function yl(l){l=l|0;var h=0,d=0,x=0;h=0;do Pt(h|0,0,45)|0,x=Oe()|0|134225919,d=l+(h<<3)|0,a[d>>2]=-1,a[d+4>>2]=x,h=h+1|0;while((h|0)!=122)}function hA(l){return l=l|0,+G[l+16>>3]<+G[l+24>>3]|0}function fA(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;return d=+G[h>>3],!(d>=+G[l+8>>3])||!(d<=+G[l>>3])?(h=0,h|0):(x=+G[l+16>>3],d=+G[l+24>>3],b=+G[h+8>>3],h=b>=d,l=b<=x&1,x<d?h&&(l=1):h||(l=0),h=(l|0)!=0,h|0)}function Yn(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;M=De,De=De+288|0,d=M+264|0,x=M+96|0,b=M,S=b,B=S+96|0;do a[S>>2]=0,S=S+4|0;while((S|0)<(B|0));return ni(h,b),S=b,B=a[S>>2]|0,S=a[S+4>>2]|0,Vs(B,S,d),As(B,S,x),V=+Qn(d,x+8|0),G[d>>3]=+G[l>>3],S=d+8|0,G[S>>3]=+G[l+16>>3],G[x>>3]=+G[l+8>>3],B=x+8|0,G[B>>3]=+G[l+24>>3],j=+Qn(d,x),B=~~+pn(+(j*j/+Ur(+ +Pe(+((+G[S>>3]-+G[B>>3])/(+G[d>>3]-+G[x>>3]))),3)/(V*(V*2.59807621135)*.8))),De=M,(B|0?B:1)|0}function ZA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0;B=De,De=De+288|0,x=B+264|0,b=B+96|0,S=B,M=S,V=M+96|0;do a[M>>2]=0,M=M+4|0;while((M|0)<(V|0));return ni(d,S),V=S,M=a[V>>2]|0,V=a[V+4>>2]|0,Vs(M,V,x),As(M,V,b),j=+Qn(x,b+8|0),V=~~+pn(+(+Qn(l,h)/(j*2))),De=B,(V|0?V:1)|0}function lc(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0,a[l>>2]=h,a[l+4>>2]=d,a[l+8>>2]=x}function _l(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0;ae=h+8|0,a[ae>>2]=0,V=+G[l>>3],M=+Pe(+V),j=+G[l+8>>3],B=+Pe(+j)/.8660254037844386,M=M+B*.5,d=~~M,l=~~B,M=M-+(d|0),B=B-+(l|0);do if(M<.5)if(M<.3333333333333333)if(a[h>>2]=d,B<(M+1)*.5){a[h+4>>2]=l;break}else{l=l+1|0,a[h+4>>2]=l;break}else if(ne=1-M,l=(!(B<ne)&1)+l|0,a[h+4>>2]=l,ne<=B&B<M*2){d=d+1|0,a[h>>2]=d;break}else{a[h>>2]=d;break}else{if(!(M<.6666666666666666))if(d=d+1|0,a[h>>2]=d,B<M*.5){a[h+4>>2]=l;break}else{l=l+1|0,a[h+4>>2]=l;break}if(B<1-M){if(a[h+4>>2]=l,M*2+-1<B){a[h>>2]=d;break}}else l=l+1|0,a[h+4>>2]=l;d=d+1|0,a[h>>2]=d}while(0);do if(V<0)if(l&1){Y=(l+1|0)/2|0,Y=Nr(d|0,((d|0)<0)<<31>>31|0,Y|0,((Y|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-((+(Y>>>0)+4294967296*+(Oe()|0))*2+1)),a[h>>2]=d;break}else{Y=(l|0)/2|0,Y=Nr(d|0,((d|0)<0)<<31>>31|0,Y|0,((Y|0)<0)<<31>>31|0)|0,d=~~(+(d|0)-(+(Y>>>0)+4294967296*+(Oe()|0))*2),a[h>>2]=d;break}while(0);Y=h+4|0,j<0&&(d=d-((l<<1|1|0)/2|0)|0,a[h>>2]=d,l=0-l|0,a[Y>>2]=l),x=l-d|0,(d|0)<0?(b=0-d|0,a[Y>>2]=x,a[ae>>2]=b,a[h>>2]=0,l=x,d=0):b=0,(l|0)<0&&(d=d-l|0,a[h>>2]=d,b=b-l|0,a[ae>>2]=b,a[Y>>2]=0,l=0),S=d-b|0,x=l-b|0,(b|0)<0&&(a[h>>2]=S,a[Y>>2]=x,a[ae>>2]=0,l=x,d=S,b=0),x=(l|0)<(d|0)?l:d,x=(b|0)<(x|0)?b:x,!((x|0)<=0)&&(a[h>>2]=d-x,a[Y>>2]=l-x,a[ae>>2]=b-x)}function Hr(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0;h=a[l>>2]|0,M=l+4|0,d=a[M>>2]|0,(h|0)<0&&(d=d-h|0,a[M>>2]=d,S=l+8|0,a[S>>2]=(a[S>>2]|0)-h,a[l>>2]=0,h=0),(d|0)<0?(h=h-d|0,a[l>>2]=h,S=l+8|0,b=(a[S>>2]|0)-d|0,a[S>>2]=b,a[M>>2]=0,d=0):(b=l+8|0,S=b,b=a[b>>2]|0),(b|0)<0&&(h=h-b|0,a[l>>2]=h,d=d-b|0,a[M>>2]=d,a[S>>2]=0,b=0),x=(d|0)<(h|0)?d:h,x=(b|0)<(x|0)?b:x,!((x|0)<=0)&&(a[l>>2]=h-x,a[M>>2]=d-x,a[S>>2]=b-x)}function No(l,h){l=l|0,h=h|0;var d=0,x=0;x=a[l+8>>2]|0,d=+((a[l+4>>2]|0)-x|0),G[h>>3]=+((a[l>>2]|0)-x|0)-d*.5,G[h+8>>3]=d*.8660254037844386}function zn(l,h,d){l=l|0,h=h|0,d=d|0,a[d>>2]=(a[h>>2]|0)+(a[l>>2]|0),a[d+4>>2]=(a[h+4>>2]|0)+(a[l+4>>2]|0),a[d+8>>2]=(a[h+8>>2]|0)+(a[l+8>>2]|0)}function bs(l,h,d){l=l|0,h=h|0,d=d|0,a[d>>2]=(a[l>>2]|0)-(a[h>>2]|0),a[d+4>>2]=(a[l+4>>2]|0)-(a[h+4>>2]|0),a[d+8>>2]=(a[l+8>>2]|0)-(a[h+8>>2]|0)}function ei(l,h){l=l|0,h=h|0;var d=0,x=0;d=qt(a[l>>2]|0,h)|0,a[l>>2]=d,d=l+4|0,x=qt(a[d>>2]|0,h)|0,a[d>>2]=x,l=l+8|0,h=qt(a[l>>2]|0,h)|0,a[l>>2]=h}function po(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=a[l>>2]|0,B=(M|0)<0,x=(a[l+4>>2]|0)-(B?M:0)|0,S=(x|0)<0,b=(S?0-x|0:0)+((a[l+8>>2]|0)-(B?M:0))|0,d=(b|0)<0,l=d?0:b,h=(S?0:x)-(d?b:0)|0,b=(B?0:M)-(S?x:0)-(d?b:0)|0,d=(h|0)<(b|0)?h:b,d=(l|0)<(d|0)?l:d,x=(d|0)>0,l=l-(x?d:0)|0,h=h-(x?d:0)|0;e:do switch(b-(x?d:0)|0){case 0:switch(h|0){case 0:return B=l|0?(l|0)==1?1:7:0,B|0;case 1:return B=l|0?(l|0)==1?3:7:2,B|0;default:break e}case 1:switch(h|0){case 0:return B=l|0?(l|0)==1?5:7:4,B|0;case 1:{if(!l)l=6;else break e;return l|0}default:break e}}while(0);return B=7,B|0}function vl(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=l+8|0,d=a[M>>2]|0,h=(a[l>>2]|0)-d|0,B=l+4|0,d=(a[B>>2]|0)-d|0,x=Yt(+((h*3|0)-d|0)/7)|0,a[l>>2]=x,h=Yt(+((d<<1)+h|0)/7)|0,a[B>>2]=h,a[M>>2]=0,d=h-x|0,(x|0)<0?(S=0-x|0,a[B>>2]=d,a[M>>2]=S,a[l>>2]=0,h=d,x=0,d=S):d=0,(h|0)<0&&(x=x-h|0,a[l>>2]=x,d=d-h|0,a[M>>2]=d,a[B>>2]=0,h=0),S=x-d|0,b=h-d|0,(d|0)<0?(a[l>>2]=S,a[B>>2]=b,a[M>>2]=0,h=b,b=S,d=0):b=x,x=(h|0)<(b|0)?h:b,x=(d|0)<(x|0)?d:x,!((x|0)<=0)&&(a[l>>2]=b-x,a[B>>2]=h-x,a[M>>2]=d-x)}function Uo(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;M=l+8|0,d=a[M>>2]|0,h=(a[l>>2]|0)-d|0,B=l+4|0,d=(a[B>>2]|0)-d|0,x=Yt(+((h<<1)+d|0)/7)|0,a[l>>2]=x,h=Yt(+((d*3|0)-h|0)/7)|0,a[B>>2]=h,a[M>>2]=0,d=h-x|0,(x|0)<0?(S=0-x|0,a[B>>2]=d,a[M>>2]=S,a[l>>2]=0,h=d,x=0,d=S):d=0,(h|0)<0&&(x=x-h|0,a[l>>2]=x,d=d-h|0,a[M>>2]=d,a[B>>2]=0,h=0),S=x-d|0,b=h-d|0,(d|0)<0?(a[l>>2]=S,a[B>>2]=b,a[M>>2]=0,h=b,b=S,d=0):b=x,x=(h|0)<(b|0)?h:b,x=(d|0)<(x|0)?d:x,!((x|0)<=0)&&(a[l>>2]=b-x,a[B>>2]=h-x,a[M>>2]=d-x)}function ua(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=a[l>>2]|0,M=l+4|0,d=a[M>>2]|0,B=l+8|0,x=a[B>>2]|0,b=d+(h*3|0)|0,a[l>>2]=b,d=x+(d*3|0)|0,a[M>>2]=d,h=(x*3|0)+h|0,a[B>>2]=h,x=d-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=x,a[B>>2]=h,a[l>>2]=0,d=x,x=0):x=b,(d|0)<0&&(x=x-d|0,a[l>>2]=x,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[l>>2]=S,a[M>>2]=b,a[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[l>>2]=x-d,a[M>>2]=b-d,a[B>>2]=h-d)}function go(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=a[l>>2]|0,M=l+4|0,h=a[M>>2]|0,B=l+8|0,d=a[B>>2]|0,x=(h*3|0)+b|0,b=d+(b*3|0)|0,a[l>>2]=b,a[M>>2]=x,h=(d*3|0)+h|0,a[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=d,a[B>>2]=h,a[l>>2]=0,b=0):d=x,(d|0)<0&&(b=b-d|0,a[l>>2]=b,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=b-h|0,x=d-h|0,(h|0)<0?(a[l>>2]=S,a[M>>2]=x,a[B>>2]=0,b=S,h=0):x=d,d=(x|0)<(b|0)?x:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[l>>2]=b-d,a[M>>2]=x-d,a[B>>2]=h-d)}function dA(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;(h+-1|0)>>>0>=6||(b=(a[15472+(h*12|0)>>2]|0)+(a[l>>2]|0)|0,a[l>>2]=b,B=l+4|0,x=(a[15472+(h*12|0)+4>>2]|0)+(a[B>>2]|0)|0,a[B>>2]=x,M=l+8|0,h=(a[15472+(h*12|0)+8>>2]|0)+(a[M>>2]|0)|0,a[M>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[B>>2]=d,a[M>>2]=h,a[l>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,a[l>>2]=x,h=h-d|0,a[M>>2]=h,a[B>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[l>>2]=S,a[B>>2]=b,a[M>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[l>>2]=x-d,a[B>>2]=b-d,a[M>>2]=h-d))}function Na(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=a[l>>2]|0,M=l+4|0,h=a[M>>2]|0,B=l+8|0,d=a[B>>2]|0,x=h+b|0,b=d+b|0,a[l>>2]=b,a[M>>2]=x,h=d+h|0,a[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=d,a[B>>2]=h,a[l>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,a[l>>2]=x,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[l>>2]=S,a[M>>2]=b,a[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[l>>2]=x-d,a[M>>2]=b-d,a[B>>2]=h-d)}function Vo(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=a[l>>2]|0,M=l+4|0,x=a[M>>2]|0,B=l+8|0,d=a[B>>2]|0,b=x+h|0,a[l>>2]=b,x=d+x|0,a[M>>2]=x,h=d+h|0,a[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=d,a[B>>2]=h,a[l>>2]=0,x=0):(d=x,x=b),(d|0)<0&&(x=x-d|0,a[l>>2]=x,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[l>>2]=S,a[M>>2]=b,a[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[l>>2]=x-d,a[M>>2]=b-d,a[B>>2]=h-d)}function Gi(l){switch(l=l|0,l|0){case 1:{l=5;break}case 5:{l=4;break}case 4:{l=6;break}case 6:{l=2;break}case 2:{l=3;break}case 3:{l=1;break}}return l|0}function $i(l){switch(l=l|0,l|0){case 1:{l=3;break}case 3:{l=2;break}case 2:{l=6;break}case 6:{l=4;break}case 4:{l=5;break}case 5:{l=1;break}}return l|0}function YA(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;h=a[l>>2]|0,M=l+4|0,d=a[M>>2]|0,B=l+8|0,x=a[B>>2]|0,b=d+(h<<1)|0,a[l>>2]=b,d=x+(d<<1)|0,a[M>>2]=d,h=(x<<1)+h|0,a[B>>2]=h,x=d-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=x,a[B>>2]=h,a[l>>2]=0,d=x,x=0):x=b,(d|0)<0&&(x=x-d|0,a[l>>2]=x,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=x-h|0,b=d-h|0,(h|0)<0?(a[l>>2]=S,a[M>>2]=b,a[B>>2]=0,x=S,h=0):b=d,d=(b|0)<(x|0)?b:x,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[l>>2]=x-d,a[M>>2]=b-d,a[B>>2]=h-d)}function xl(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=a[l>>2]|0,M=l+4|0,h=a[M>>2]|0,B=l+8|0,d=a[B>>2]|0,x=(h<<1)+b|0,b=d+(b<<1)|0,a[l>>2]=b,a[M>>2]=x,h=(d<<1)+h|0,a[B>>2]=h,d=x-b|0,(b|0)<0?(h=h-b|0,a[M>>2]=d,a[B>>2]=h,a[l>>2]=0,b=0):d=x,(d|0)<0&&(b=b-d|0,a[l>>2]=b,h=h-d|0,a[B>>2]=h,a[M>>2]=0,d=0),S=b-h|0,x=d-h|0,(h|0)<0?(a[l>>2]=S,a[M>>2]=x,a[B>>2]=0,b=S,h=0):x=d,d=(x|0)<(b|0)?x:b,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(a[l>>2]=b-d,a[M>>2]=x-d,a[B>>2]=h-d)}function mo(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;return M=(a[l>>2]|0)-(a[h>>2]|0)|0,B=(M|0)<0,x=(a[l+4>>2]|0)-(a[h+4>>2]|0)-(B?M:0)|0,S=(x|0)<0,b=(B?0-M|0:0)+(a[l+8>>2]|0)-(a[h+8>>2]|0)+(S?0-x|0:0)|0,l=(b|0)<0,h=l?0:b,d=(S?0:x)-(l?b:0)|0,b=(B?0:M)-(S?x:0)-(l?b:0)|0,l=(d|0)<(b|0)?d:b,l=(h|0)<(l|0)?h:l,x=(l|0)>0,h=h-(x?l:0)|0,d=d-(x?l:0)|0,l=b-(x?l:0)|0,l=(l|0)>-1?l:0-l|0,d=(d|0)>-1?d:0-d|0,h=(h|0)>-1?h:0-h|0,h=(d|0)>(h|0)?d:h,((l|0)>(h|0)?l:h)|0}function Go(l,h){l=l|0,h=h|0;var d=0;d=a[l+8>>2]|0,a[h>>2]=(a[l>>2]|0)-d,a[h+4>>2]=(a[l+4>>2]|0)-d}function Ac(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;x=a[l>>2]|0,a[h>>2]=x,l=a[l+4>>2]|0,M=h+4|0,a[M>>2]=l,B=h+8|0,a[B>>2]=0,d=l-x|0,(x|0)<0?(l=0-x|0,a[M>>2]=d,a[B>>2]=l,a[h>>2]=0,x=0):(d=l,l=0),(d|0)<0&&(x=x-d|0,a[h>>2]=x,l=l-d|0,a[B>>2]=l,a[M>>2]=0,d=0),S=x-l|0,b=d-l|0,(l|0)<0?(a[h>>2]=S,a[M>>2]=b,a[B>>2]=0,d=b,b=S,l=0):b=x,x=(d|0)<(b|0)?d:b,x=(l|0)<(x|0)?l:x,!((x|0)<=0)&&(a[h>>2]=b-x,a[M>>2]=d-x,a[B>>2]=l-x)}function XA(l){l=l|0;var h=0,d=0,x=0,b=0;h=l+8|0,b=a[h>>2]|0,d=b-(a[l>>2]|0)|0,a[l>>2]=d,x=l+4|0,l=(a[x>>2]|0)-b|0,a[x>>2]=l,a[h>>2]=0-(l+d)}function wl(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;d=a[l>>2]|0,h=0-d|0,a[l>>2]=h,M=l+8|0,a[M>>2]=0,B=l+4|0,x=a[B>>2]|0,b=x+d|0,(d|0)>0?(a[B>>2]=b,a[M>>2]=d,a[l>>2]=0,h=0,x=b):d=0,(x|0)<0?(S=h-x|0,a[l>>2]=S,d=d-x|0,a[M>>2]=d,a[B>>2]=0,b=S-d|0,h=0-d|0,(d|0)<0?(a[l>>2]=b,a[B>>2]=h,a[M>>2]=0,x=h,d=0):(x=0,b=S)):b=h,h=(x|0)<(b|0)?x:b,h=(d|0)<(h|0)?d:h,!((h|0)<=0)&&(a[l>>2]=b-h,a[B>>2]=x-h,a[M>>2]=d-h)}function pA(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,KA(l,h,d,b),_l(b,d+4|0),De=x}function KA(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0;if(V=De,De=De+32|0,S=V,Ll(l,S),a[d>>2]=0,b=+Br(15888,S),M=+Br(15912,S),M<b&&(a[d>>2]=1,b=M),M=+Br(15936,S),M<b&&(a[d>>2]=2,b=M),M=+Br(15960,S),M<b&&(a[d>>2]=3,b=M),M=+Br(15984,S),M<b&&(a[d>>2]=4,b=M),M=+Br(16008,S),M<b&&(a[d>>2]=5,b=M),M=+Br(16032,S),M<b&&(a[d>>2]=6,b=M),M=+Br(16056,S),M<b&&(a[d>>2]=7,b=M),M=+Br(16080,S),M<b&&(a[d>>2]=8,b=M),M=+Br(16104,S),M<b&&(a[d>>2]=9,b=M),M=+Br(16128,S),M<b&&(a[d>>2]=10,b=M),M=+Br(16152,S),M<b&&(a[d>>2]=11,b=M),M=+Br(16176,S),M<b&&(a[d>>2]=12,b=M),M=+Br(16200,S),M<b&&(a[d>>2]=13,b=M),M=+Br(16224,S),M<b&&(a[d>>2]=14,b=M),M=+Br(16248,S),M<b&&(a[d>>2]=15,b=M),M=+Br(16272,S),M<b&&(a[d>>2]=16,b=M),M=+Br(16296,S),M<b&&(a[d>>2]=17,b=M),M=+Br(16320,S),M<b&&(a[d>>2]=18,b=M),M=+Br(16344,S),M<b&&(a[d>>2]=19,b=M),M=+Dt(+(1-b*.5)),M<1e-16){a[x>>2]=0,a[x+4>>2]=0,a[x+8>>2]=0,a[x+12>>2]=0,De=V;return}if(d=a[d>>2]|0,b=+G[16368+(d*24|0)>>3],b=+cr(b-+cr(+fr(15568+(d<<4)|0,l))),hi(h)|0?B=+cr(b+-.3334731722518321):B=b,b=+ft(+M)/.381966011250105,(h|0)>0){S=0;do b=b*2.6457513110645907,S=S+1|0;while((S|0)!=(h|0))}M=+lt(+B)*b,G[x>>3]=M,B=+We(+B)*b,G[x+8>>3]=B,De=V}function $o(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0;if(S=+xo(l),S<1e-16){h=15568+(h<<4)|0,a[b>>2]=a[h>>2],a[b+4>>2]=a[h+4>>2],a[b+8>>2]=a[h+8>>2],a[b+12>>2]=a[h+12>>2];return}if(M=+jt(+ +G[l+8>>3],+ +G[l>>3]),(d|0)>0){l=0;do S=S/2.6457513110645907,l=l+1|0;while((l|0)!=(d|0))}x?(S=S/3,d=(hi(d)|0)==0,S=+sn(+((d?S:S/2.6457513110645907)*.381966011250105))):(S=+sn(+(S*.381966011250105)),hi(d)|0&&(M=+cr(M+.3334731722518321))),bl(15568+(h<<4)|0,+cr(+G[16368+(h*24|0)>>3]-M),S,b)}function Ua(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,No(l+4|0,b),$o(b,a[l>>2]|0,h,0,d),De=x}function JA(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,y=0,m=0,v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0;if(J=De,De=De+272|0,S=J+256|0,Te=J+240|0,O=J,N=J+224|0,Q=J+208|0,Ve=J+176|0,xe=J+160|0,y=J+192|0,m=J+144|0,v=J+128|0,E=J+112|0,P=J+96|0,R=J+80|0,a[S>>2]=h,a[Te>>2]=a[l>>2],a[Te+4>>2]=a[l+4>>2],a[Te+8>>2]=a[l+8>>2],a[Te+12>>2]=a[l+12>>2],eu(Te,S,O),a[b>>2]=0,Te=x+d+((x|0)==5&1)|0,(Te|0)<=(d|0)){De=J;return}V=a[S>>2]|0,j=N+4|0,Y=Ve+4|0,ae=d+5|0,ne=16848+(V<<2)|0,ue=16928+(V<<2)|0,be=v+8|0,Ce=E+8|0,ve=P+8|0,Ge=Q+4|0,B=d;e:for(;;){M=O+(((B|0)%5|0)<<4)|0,a[Q>>2]=a[M>>2],a[Q+4>>2]=a[M+4>>2],a[Q+8>>2]=a[M+8>>2],a[Q+12>>2]=a[M+12>>2];do;while((yo(Q,V,0,1)|0)==2);if((B|0)>(d|0)&(hi(h)|0)!=0){if(a[Ve>>2]=a[Q>>2],a[Ve+4>>2]=a[Q+4>>2],a[Ve+8>>2]=a[Q+8>>2],a[Ve+12>>2]=a[Q+12>>2],No(j,xe),x=a[Ve>>2]|0,S=a[17008+(x*80|0)+(a[N>>2]<<2)>>2]|0,a[Ve>>2]=a[18608+(x*80|0)+(S*20|0)>>2],M=a[18608+(x*80|0)+(S*20|0)+16>>2]|0,(M|0)>0){l=0;do Na(Y),l=l+1|0;while((l|0)<(M|0))}switch(M=18608+(x*80|0)+(S*20|0)+4|0,a[y>>2]=a[M>>2],a[y+4>>2]=a[M+4>>2],a[y+8>>2]=a[M+8>>2],ei(y,(a[ne>>2]|0)*3|0),zn(Y,y,Y),Hr(Y),No(Y,m),le=+(a[ue>>2]|0),G[v>>3]=le*3,G[be>>3]=0,de=le*-1.5,G[E>>3]=de,G[Ce>>3]=le*2.598076211353316,G[P>>3]=de,G[ve>>3]=le*-2.598076211353316,a[17008+((a[Ve>>2]|0)*80|0)+(a[Q>>2]<<2)>>2]|0){case 1:{l=E,x=v;break}case 3:{l=P,x=E;break}case 2:{l=v,x=P;break}default:{l=12;break e}}cu(xe,m,x,l,R),$o(R,a[Ve>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1}if((B|0)<(ae|0)&&(No(Ge,Ve),$o(Ve,a[Q>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1),a[N>>2]=a[Q>>2],a[N+4>>2]=a[Q+4>>2],a[N+8>>2]=a[Q+8>>2],a[N+12>>2]=a[Q+12>>2],B=B+1|0,(B|0)>=(Te|0)){l=3;break}}if((l|0)==3){De=J;return}else(l|0)==12&&Ct(22474,22521,581,22531)}function eu(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;V=De,De=De+128|0,x=V+64|0,b=V,S=x,M=20208,B=S+60|0;do a[S>>2]=a[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));S=b,M=20272,B=S+60|0;do a[S>>2]=a[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));B=(hi(a[h>>2]|0)|0)==0,x=B?x:b,b=l+4|0,YA(b),xl(b),hi(a[h>>2]|0)|0&&(go(b),a[h>>2]=(a[h>>2]|0)+1),a[d>>2]=a[l>>2],h=d+4|0,zn(b,x,h),Hr(h),a[d+16>>2]=a[l>>2],h=d+20|0,zn(b,x+12|0,h),Hr(h),a[d+32>>2]=a[l>>2],h=d+36|0,zn(b,x+24|0,h),Hr(h),a[d+48>>2]=a[l>>2],h=d+52|0,zn(b,x+36|0,h),Hr(h),a[d+64>>2]=a[l>>2],d=d+68|0,zn(b,x+48|0,d),Hr(d),De=V}function yo(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0;if(be=De,De=De+32|0,ne=be+12|0,B=be,ue=l+4|0,ae=a[16928+(h<<2)>>2]|0,Y=(x|0)!=0,ae=Y?ae*3|0:ae,b=a[ue>>2]|0,j=l+8|0,M=a[j>>2]|0,Y){if(S=l+12|0,x=a[S>>2]|0,b=M+b+x|0,(b|0)==(ae|0))return ue=1,De=be,ue|0;V=S}else V=l+12|0,x=a[V>>2]|0,b=M+b+x|0;if((b|0)<=(ae|0))return ue=0,De=be,ue|0;do if((x|0)>0){if(x=a[l>>2]|0,(M|0)>0){S=18608+(x*80|0)+60|0,x=l;break}x=18608+(x*80|0)+40|0,d?(lc(ne,ae,0,0),bs(ue,ne,B),Vo(B),zn(B,ne,ue),S=x,x=l):(S=x,x=l)}else S=18608+((a[l>>2]|0)*80|0)+20|0,x=l;while(0);if(a[x>>2]=a[S>>2],b=S+16|0,(a[b>>2]|0)>0){x=0;do Na(ue),x=x+1|0;while((x|0)<(a[b>>2]|0))}return l=S+4|0,a[ne>>2]=a[l>>2],a[ne+4>>2]=a[l+4>>2],a[ne+8>>2]=a[l+8>>2],h=a[16848+(h<<2)>>2]|0,ei(ne,Y?h*3|0:h),zn(ue,ne,ue),Hr(ue),Y?x=((a[j>>2]|0)+(a[ue>>2]|0)+(a[V>>2]|0)|0)==(ae|0)?1:2:x=2,ue=x,De=be,ue|0}function ca(l,h){l=l|0,h=h|0;var d=0;do d=yo(l,h,0,1)|0;while((d|0)==2);return d|0}function tu(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,y=0,m=0,v=0,E=0,P=0,R=0,O=0;if(P=De,De=De+240|0,S=P+224|0,y=P+208|0,m=P,v=P+192|0,E=P+176|0,ve=P+160|0,Ge=P+144|0,Te=P+128|0,Ve=P+112|0,xe=P+96|0,a[S>>2]=h,a[y>>2]=a[l>>2],a[y+4>>2]=a[l+4>>2],a[y+8>>2]=a[l+8>>2],a[y+12>>2]=a[l+12>>2],ha(y,S,m),a[b>>2]=0,Ce=x+d+((x|0)==6&1)|0,(Ce|0)<=(d|0)){De=P;return}V=a[S>>2]|0,j=d+6|0,Y=16928+(V<<2)|0,ae=Ge+8|0,ne=Te+8|0,ue=Ve+8|0,be=v+4|0,M=0,B=d,x=-1;e:for(;;){if(S=(B|0)%6|0,l=m+(S<<4)|0,a[v>>2]=a[l>>2],a[v+4>>2]=a[l+4>>2],a[v+8>>2]=a[l+8>>2],a[v+12>>2]=a[l+12>>2],l=M,M=yo(v,V,0,1)|0,(B|0)>(d|0)&(hi(h)|0)!=0&&(l|0)!=1&&(a[v>>2]|0)!=(x|0)){switch(No(m+(((S+5|0)%6|0)<<4)+4|0,E),No(m+(S<<4)+4|0,ve),R=+(a[Y>>2]|0),G[Ge>>3]=R*3,G[ae>>3]=0,O=R*-1.5,G[Te>>3]=O,G[ne>>3]=R*2.598076211353316,G[Ve>>3]=O,G[ue>>3]=R*-2.598076211353316,S=a[y>>2]|0,a[17008+(S*80|0)+(((x|0)==(S|0)?a[v>>2]|0:x)<<2)>>2]|0){case 1:{l=Te,x=Ge;break}case 3:{l=Ve,x=Te;break}case 2:{l=Ge,x=Ve;break}default:{l=8;break e}}cu(E,ve,x,l,xe),!(ya(E,xe)|0)&&!(ya(ve,xe)|0)&&($o(xe,a[y>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1)}if((B|0)<(j|0)&&(No(be,E),$o(E,a[v>>2]|0,V,1,b+8+(a[b>>2]<<4)|0),a[b>>2]=(a[b>>2]|0)+1),B=B+1|0,(B|0)>=(Ce|0)){l=3;break}else x=a[v>>2]|0}if((l|0)==3){De=P;return}else(l|0)==8&&Ct(22557,22521,746,22602)}function ha(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0;V=De,De=De+160|0,x=V+80|0,b=V,S=x,M=20336,B=S+72|0;do a[S>>2]=a[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));S=b,M=20416,B=S+72|0;do a[S>>2]=a[M>>2],S=S+4|0,M=M+4|0;while((S|0)<(B|0));B=(hi(a[h>>2]|0)|0)==0,x=B?x:b,b=l+4|0,YA(b),xl(b),hi(a[h>>2]|0)|0&&(go(b),a[h>>2]=(a[h>>2]|0)+1),a[d>>2]=a[l>>2],h=d+4|0,zn(b,x,h),Hr(h),a[d+16>>2]=a[l>>2],h=d+20|0,zn(b,x+12|0,h),Hr(h),a[d+32>>2]=a[l>>2],h=d+36|0,zn(b,x+24|0,h),Hr(h),a[d+48>>2]=a[l>>2],h=d+52|0,zn(b,x+36|0,h),Hr(h),a[d+64>>2]=a[l>>2],h=d+68|0,zn(b,x+48|0,h),Hr(h),a[d+80>>2]=a[l>>2],d=d+84|0,zn(b,x+60|0,d),Hr(d),De=V}function cr(l){l=+l;var h=0;return h=l<0?l+6.283185307179586:l,+(l>=6.283185307179586?h+-6.283185307179586:h)}function Fs(l,h){return l=l|0,h=h|0,+Pe(+(+G[l>>3]-+G[h>>3]))<17453292519943298e-27?(h=+Pe(+(+G[l+8>>3]-+G[h+8>>3]))<17453292519943298e-27,h|0):(h=0,h|0)}function $n(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[l>>3],S=+We(+((b-x)*.5)),d=+We(+((+G[h+8>>3]-+G[l+8>>3])*.5)),d=S*S+d*(+lt(+b)*+lt(+x)*d),+(+jt(+ +ke(+d),+ +ke(+(1-d)))*2)}function Qn(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[l>>3],S=+We(+((b-x)*.5)),d=+We(+((+G[h+8>>3]-+G[l+8>>3])*.5)),d=S*S+d*(+lt(+b)*+lt(+x)*d),+(+jt(+ +ke(+d),+ +ke(+(1-d)))*2*6371.007180918475)}function _r(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;return b=+G[h>>3],x=+G[l>>3],S=+We(+((b-x)*.5)),d=+We(+((+G[h+8>>3]-+G[l+8>>3])*.5)),d=S*S+d*(+lt(+b)*+lt(+x)*d),+(+jt(+ +ke(+d),+ +ke(+(1-d)))*2*6371.007180918475*1e3)}function fr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;return S=+G[h>>3],x=+lt(+S),b=+G[h+8>>3]-+G[l+8>>3],M=x*+We(+b),d=+G[l>>3],+ +jt(+M,+(+We(+S)*+lt(+d)-+lt(+b)*(x*+We(+d))))}function bl(l,h,d,x){l=l|0,h=+h,d=+d,x=x|0;var b=0,S=0,M=0,B=0;if(d<1e-16){a[x>>2]=a[l>>2],a[x+4>>2]=a[l+4>>2],a[x+8>>2]=a[l+8>>2],a[x+12>>2]=a[l+12>>2];return}S=h<0?h+6.283185307179586:h,S=h>=6.283185307179586?S+-6.283185307179586:S;do if(S<1e-16)h=+G[l>>3]+d,G[x>>3]=h,b=x;else{if(b=+Pe(+(S+-3.141592653589793))<1e-16,h=+G[l>>3],b){h=h-d,G[x>>3]=h,b=x;break}if(M=+lt(+d),d=+We(+d),h=M*+We(+h)+ +lt(+S)*(d*+lt(+h)),h=h>1?1:h,h=+Rt(+(h<-1?-1:h)),G[x>>3]=h,+Pe(+(h+-1.5707963267948966))<1e-16){G[x>>3]=1.5707963267948966,G[x+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[x>>3]=-1.5707963267948966,G[x+8>>3]=0;return}if(B=+lt(+h),S=d*+We(+S)/B,d=+G[l>>3],h=(M-+We(+h)*+We(+d))/+lt(+d)/B,M=S>1?1:S,h=h>1?1:h,h=+G[l+8>>3]+ +jt(+(M<-1?-1:M),+(h<-1?-1:h)),h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[x+8>>3]=h;return}while(0);if(+Pe(+(h+-1.5707963267948966))<1e-16){G[b>>3]=1.5707963267948966,G[x+8>>3]=0;return}if(+Pe(+(h+1.5707963267948966))<1e-16){G[b>>3]=-1.5707963267948966,G[x+8>>3]=0;return}if(h=+G[l+8>>3],h>3.141592653589793)do h=h+-6.283185307179586;while(h>3.141592653589793);if(h<-3.141592653589793)do h=h+6.283185307179586;while(h<-3.141592653589793);G[x+8>>3]=h}function jo(l){return l=l|0,+ +G[20496+(l<<3)>>3]}function uc(l){return l=l|0,+ +G[20624+(l<<3)>>3]}function Va(l){return l=l|0,+ +G[20752+(l<<3)>>3]}function cc(l){return l=l|0,+ +G[20880+(l<<3)>>3]}function nu(l){l=l|0;var h=0;return h=21008+(l<<3)|0,l=a[h>>2]|0,Ft(a[h+4>>2]|0),l|0}function Ns(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0;return ne=+G[h>>3],Y=+G[l>>3],V=+We(+((ne-Y)*.5)),S=+G[h+8>>3],j=+G[l+8>>3],M=+We(+((S-j)*.5)),B=+lt(+Y),ae=+lt(+ne),M=V*V+M*(ae*B*M),M=+jt(+ +ke(+M),+ +ke(+(1-M)))*2,V=+G[d>>3],ne=+We(+((V-ne)*.5)),x=+G[d+8>>3],S=+We(+((x-S)*.5)),b=+lt(+V),S=ne*ne+S*(ae*b*S),S=+jt(+ +ke(+S),+ +ke(+(1-S)))*2,V=+We(+((Y-V)*.5)),x=+We(+((j-x)*.5)),x=V*V+x*(B*b*x),x=+jt(+ +ke(+x),+ +ke(+(1-x)))*2,b=(M+S+x)*.5,+(+sn(+ +ke(+(+ft(+(b*.5))*+ft(+((b-M)*.5))*+ft(+((b-S)*.5))*+ft(+((b-x)*.5)))))*4)}function El(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,Vs(l,h,x),As(l,h,b),h=a[b>>2]|0,(h|0)<=0)return d=0,De=S,+d;if(d=+Ns(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)==1)return De=S,+d;l=1;do M=l,l=l+1|0,d=d+ +Ns(b+8+(M<<4)|0,b+8+(((l|0)%(h|0)|0)<<4)|0,x);while((l|0)<(h|0));return De=S,+d}function Ga(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,Vs(l,h,x),As(l,h,b),h=a[b>>2]|0,(h|0)>0){if(d=+Ns(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)!=1){l=1;do M=l,l=l+1|0,d=d+ +Ns(b+8+(M<<4)|0,b+8+(((l|0)%(h|0)|0)<<4)|0,x);while((l|0)<(h|0))}}else d=0;return De=S,+(d*6371.007180918475*6371.007180918475)}function fa(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(S=De,De=De+192|0,x=S+168|0,b=S,Vs(l,h,x),As(l,h,b),h=a[b>>2]|0,(h|0)>0){if(d=+Ns(b+8|0,b+8+(((h|0)!=1&1)<<4)|0,x)+0,(h|0)!=1){l=1;do M=l,l=l+1|0,d=d+ +Ns(b+8+(M<<4)|0,b+8+(((l|0)%(h|0)|0)<<4)|0,x);while((l|0)<(h|0))}}else d=0;return De=S,+(d*6371.007180918475*6371.007180918475*1e3*1e3)}function Tl(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(M=De,De=De+176|0,S=M,Wa(l,h,S),l=a[S>>2]|0,(l|0)<=1)return b=0,De=M,+b;h=l+-1|0,l=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do l=l+1|0,V=x,x=+G[S+8+(l<<4)>>3],j=+We(+((x-V)*.5)),B=b,b=+G[S+8+(l<<4)+8>>3],B=+We(+((b-B)*.5)),B=j*j+B*(+lt(+x)*+lt(+V)*B),d=d+ +jt(+ +ke(+B),+ +ke(+(1-B)))*2;while((l|0)<(h|0));return De=M,+d}function Sl(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(M=De,De=De+176|0,S=M,Wa(l,h,S),l=a[S>>2]|0,(l|0)<=1)return b=0,De=M,+b;h=l+-1|0,l=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do l=l+1|0,V=x,x=+G[S+8+(l<<4)>>3],j=+We(+((x-V)*.5)),B=b,b=+G[S+8+(l<<4)+8>>3],B=+We(+((b-B)*.5)),B=j*j+B*(+lt(+V)*+lt(+x)*B),d=d+ +jt(+ +ke(+B),+ +ke(+(1-B)))*2;while((l|0)!=(h|0));return j=d*6371.007180918475,De=M,+j}function dr(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(M=De,De=De+176|0,S=M,Wa(l,h,S),l=a[S>>2]|0,(l|0)<=1)return b=0,De=M,+b;h=l+-1|0,l=0,d=0,x=+G[S+8>>3],b=+G[S+16>>3];do l=l+1|0,V=x,x=+G[S+8+(l<<4)>>3],j=+We(+((x-V)*.5)),B=b,b=+G[S+8+(l<<4)+8>>3],B=+We(+((b-B)*.5)),B=j*j+B*(+lt(+V)*+lt(+x)*B),d=d+ +jt(+ +ke(+B),+ +ke(+(1-B)))*2;while((l|0)!=(h|0));return j=d*6371.007180918475*1e3,De=M,+j}function gA(l,h){return l=l|0,h=h|0,h=Mt(l|0,h|0,52)|0,Oe()|0,h&15|0}function as(l,h){return l=l|0,h=h|0,h=Mt(l|0,h|0,45)|0,Oe()|0,h&127|0}function ru(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0;if(!(!0&(h&-16777216|0)==134217728)||(M=Mt(l|0,h|0,45)|0,Oe()|0,M=M&127,M>>>0>121))return h=0,h|0;d=Mt(l|0,h|0,52)|0,Oe()|0,d=d&15;do if(d|0){for(b=1,x=0;;){if(S=Mt(l|0,h|0,(15-b|0)*3|0)|0,Oe()|0,S=S&7,(S|0)!=0&(x^1))if((S|0)==1&(en(M)|0)!=0){B=0,x=13;break}else x=1;if((S|0)==7){B=0,x=13;break}if(b>>>0<d>>>0)b=b+1|0;else{x=9;break}}if((x|0)==9){if((d|0)==15)B=1;else break;return B|0}else if((x|0)==13)return B|0}while(0);for(;;){if(B=Mt(l|0,h|0,(14-d|0)*3|0)|0,Oe()|0,!((B&7|0)==7&!0)){B=0,x=13;break}if(d>>>0<14)d=d+1|0;else{B=1,x=13;break}}return(x|0)==13?B|0:0}function Ml(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;if(x=Mt(l|0,h|0,52)|0,Oe()|0,x=x&15,(x|0)>=(d|0)){if((x|0)!=(d|0))if(d>>>0<=15){if(b=Pt(d|0,0,52)|0,l=b|l,h=Oe()|0|h&-15728641,(x|0)>(d|0))do b=Pt(7,0,(14-d|0)*3|0)|0,d=d+1|0,l=b|l,h=Oe()|0|h;while((d|0)<(x|0))}else h=0,l=0}else h=0,l=0;return Ft(h|0),l|0}function hc(l,h,d){return l=l|0,h=h|0,d=d|0,l=Mt(l|0,h|0,52)|0,Oe()|0,l=l&15,(d|0)<16&(l|0)<=(d|0)?(d=kl(7,d-l|0)|0,d|0):(d=0,d|0)}function Wr(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0;if(M=Mt(l|0,h|0,52)|0,Oe()|0,M=M&15,!!((d|0)<16&(M|0)<=(d|0))){if((M|0)==(d|0)){d=x,a[d>>2]=l,a[d+4>>2]=h;return}if(V=kl(7,d-M|0)|0,j=(V|0)/7|0,B=Mt(l|0,h|0,45)|0,Oe()|0,!(en(B&127)|0))S=0;else{e:do if(!M)b=0;else for(S=1;;){if(b=Mt(l|0,h|0,(15-S|0)*3|0)|0,Oe()|0,b=b&7,b|0)break e;if(S>>>0<M>>>0)S=S+1|0;else{b=0;break}}while(0);S=(b|0)==0}if(Y=Pt(M+1|0,0,52)|0,b=Oe()|0|h&-15728641,B=(14-M|0)*3|0,h=Pt(7,0,B|0)|0,h=(Y|l)&~h,M=b&~(Oe()|0),Wr(h,M,d,x),b=x+(j<<3)|0,!S){Y=Pt(1,0,B|0)|0,Wr(Y|h,Oe()|0|M,d,b),Y=b+(j<<3)|0,V=Pt(2,0,B|0)|0,Wr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(3,0,B|0)|0,Wr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(4,0,B|0)|0,Wr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(5,0,B|0)|0,Wr(V|h,Oe()|0|M,d,Y),V=Pt(6,0,B|0)|0,Wr(V|h,Oe()|0|M,d,Y+(j<<3)|0);return}S=b+(j<<3)|0,(V|0)>6&&(V=b+8|0,Y=(S>>>0>V>>>0?S:V)+-1+(0-b)|0,L(b|0,0,Y+8&-8|0)|0,b=V+(Y>>>3<<3)|0),Y=Pt(2,0,B|0)|0,Wr(Y|h,Oe()|0|M,d,b),Y=b+(j<<3)|0,V=Pt(3,0,B|0)|0,Wr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(4,0,B|0)|0,Wr(V|h,Oe()|0|M,d,Y),Y=Y+(j<<3)|0,V=Pt(5,0,B|0)|0,Wr(V|h,Oe()|0|M,d,Y),V=Pt(6,0,B|0)|0,Wr(V|h,Oe()|0|M,d,Y+(j<<3)|0)}}function Ir(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;if(b=Mt(l|0,h|0,45)|0,Oe()|0,!(en(b&127)|0))return b=0,b|0;b=Mt(l|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!b)d=0;else for(x=1;;){if(d=Mt(l|0,h|0,(15-x|0)*3|0)|0,Oe()|0,d=d&7,d|0)break e;if(x>>>0<b>>>0)x=x+1|0;else{d=0;break}}while(0);return b=(d|0)==0&1,b|0}function ti(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;if(x=Mt(l|0,h|0,52)|0,Oe()|0,x=x&15,(d|0)<16&(x|0)<=(d|0)){if((x|0)!=(d|0)&&(b=Pt(d|0,0,52)|0,l=b|l,h=Oe()|0|h&-15728641,(x|0)<(d|0)))do b=Pt(7,0,(14-x|0)*3|0)|0,x=x+1|0,l=l&~b,h=h&~(Oe()|0);while((x|0)<(d|0))}else h=0,l=0;return Ft(h|0),l|0}function iu(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,y=0,m=0,v=0,E=0;if(!d)return v=0,v|0;if(b=l,x=a[b>>2]|0,b=a[b+4>>2]|0,!0&(b&15728640|0)==0){if((d|0)<=0||(v=h,a[v>>2]=x,a[v+4>>2]=b,(d|0)==1))return v=0,v|0;x=1;do y=l+(x<<3)|0,m=a[y+4>>2]|0,v=h+(x<<3)|0,a[v>>2]=a[y>>2],a[v+4>>2]=m,x=x+1|0;while((x|0)!=(d|0));return x=0,x|0}if(y=d<<3,m=Xt(y)|0,!m)return v=-3,v|0;if(Ws(m|0,l|0,y|0)|0,xe=Yi(d,8)|0,!xe)return hn(m),v=-3,v|0;x=d;e:for(;;){M=m,Y=a[M>>2]|0,M=a[M+4>>2]|0,Te=Mt(Y|0,M|0,52)|0,Oe()|0,Te=Te&15,Ve=Te+-1|0,Ge=(x|0)>0;t:do if(Ge){if(ve=((x|0)<0)<<31>>31,be=Pt(Ve|0,0,52)|0,Ce=Oe()|0,Ve>>>0>15)for(b=0,l=Y,d=M;;){if(!((l|0)==0&(d|0)==0)){if(S=Mt(l|0,d|0,52)|0,Oe()|0,S=S&15,B=(S|0)<(Ve|0),S=(S|0)==(Ve|0),j=B?0:S?l:0,l=B?0:S?d:0,d=Hs(j|0,l|0,x|0,ve|0)|0,Oe()|0,S=xe+(d<<3)|0,B=S,V=a[B>>2]|0,B=a[B+4>>2]|0,(V|0)==0&(B|0)==0)d=j;else for(be=0,ue=d,ne=B,d=j;;){if((be|0)>(x|0)){v=41;break e}if((V|0)==(d|0)&(ne&-117440513|0)==(l|0)){j=Mt(V|0,ne|0,56)|0,Oe()|0,j=j&7,ae=j+1|0,Ce=Mt(V|0,ne|0,45)|0,Oe()|0;n:do if(!(en(Ce&127)|0))B=7;else{if(V=Mt(V|0,ne|0,52)|0,Oe()|0,V=V&15,!V){B=6;break}for(B=1;;){if(Ce=Pt(7,0,(15-B|0)*3|0)|0,!((Ce&d|0)==0&((Oe()|0)&l|0)==0)){B=7;break n}if(B>>>0<V>>>0)B=B+1|0;else{B=6;break}}}while(0);if((j+2|0)>>>0>B>>>0){v=51;break e}Ce=Pt(ae|0,0,56)|0,l=Oe()|0|l&-117440513,B=S,a[B>>2]=0,a[B+4>>2]=0,B=ue,d=Ce|d}else B=(ue+1|0)%(x|0)|0;if(S=xe+(B<<3)|0,ne=S,V=a[ne>>2]|0,ne=a[ne+4>>2]|0,(V|0)==0&(ne|0)==0)break;be=be+1|0,ue=B}Ce=S,a[Ce>>2]=d,a[Ce+4>>2]=l}if(b=b+1|0,(b|0)>=(x|0))break t;d=m+(b<<3)|0,l=a[d>>2]|0,d=a[d+4>>2]|0}for(b=0,l=Y,d=M;;){if(!((l|0)==0&(d|0)==0)){if(B=Mt(l|0,d|0,52)|0,Oe()|0,B=B&15,(B|0)>=(Ve|0)){if((B|0)!=(Ve|0)&&(l=l|be,d=d&-15728641|Ce,B>>>0>=Te>>>0)){S=Ve;do ue=Pt(7,0,(14-S|0)*3|0)|0,S=S+1|0,l=ue|l,d=Oe()|0|d;while(S>>>0<B>>>0)}}else l=0,d=0;if(B=Hs(l|0,d|0,x|0,ve|0)|0,Oe()|0,S=xe+(B<<3)|0,V=S,j=a[V>>2]|0,V=a[V+4>>2]|0,!((j|0)==0&(V|0)==0))for(ue=0;;){if((ue|0)>(x|0)){v=41;break e}if((j|0)==(l|0)&(V&-117440513|0)==(d|0)){ae=Mt(j|0,V|0,56)|0,Oe()|0,ae=ae&7,ne=ae+1|0,E=Mt(j|0,V|0,45)|0,Oe()|0;n:do if(!(en(E&127)|0))V=7;else{if(j=Mt(j|0,V|0,52)|0,Oe()|0,j=j&15,!j){V=6;break}for(V=1;;){if(E=Pt(7,0,(15-V|0)*3|0)|0,!((E&l|0)==0&((Oe()|0)&d|0)==0)){V=7;break n}if(V>>>0<j>>>0)V=V+1|0;else{V=6;break}}}while(0);if((ae+2|0)>>>0>V>>>0){v=51;break e}E=Pt(ne|0,0,56)|0,d=Oe()|0|d&-117440513,ne=S,a[ne>>2]=0,a[ne+4>>2]=0,l=E|l}else B=(B+1|0)%(x|0)|0;if(S=xe+(B<<3)|0,V=S,j=a[V>>2]|0,V=a[V+4>>2]|0,(j|0)==0&(V|0)==0)break;ue=ue+1|0}E=S,a[E>>2]=l,a[E+4>>2]=d}if(b=b+1|0,(b|0)>=(x|0))break t;d=m+(b<<3)|0,l=a[d>>2]|0,d=a[d+4>>2]|0}}while(0);if((x+5|0)>>>0<11){v=99;break}if(Ce=Yi((x|0)/6|0,8)|0,!Ce){v=58;break}t:do if(Ge){ue=0,ne=0;do{if(B=xe+(ue<<3)|0,l=B,b=a[l>>2]|0,l=a[l+4>>2]|0,!((b|0)==0&(l|0)==0)){V=Mt(b|0,l|0,56)|0,Oe()|0,V=V&7,d=V+1|0,j=l&-117440513,E=Mt(b|0,l|0,45)|0,Oe()|0;n:do if(en(E&127)|0){if(ae=Mt(b|0,l|0,52)|0,Oe()|0,ae=ae&15,ae|0)for(S=1;;){if(E=Pt(7,0,(15-S|0)*3|0)|0,!((b&E|0)==0&(j&(Oe()|0)|0)==0))break n;if(S>>>0<ae>>>0)S=S+1|0;else break}l=Pt(d|0,0,56)|0,b=l|b,l=Oe()|0|j,d=B,a[d>>2]=b,a[d+4>>2]=l,d=V+2|0}while(0);(d|0)==7&&(E=Ce+(ne<<3)|0,a[E>>2]=b,a[E+4>>2]=l&-117440513,ne=ne+1|0)}ue=ue+1|0}while((ue|0)!=(x|0));if(Ge){if(be=((x|0)<0)<<31>>31,ae=Pt(Ve|0,0,52)|0,ue=Oe()|0,Ve>>>0>15)for(l=0,b=0;;){do if(!((Y|0)==0&(M|0)==0)){for(V=Mt(Y|0,M|0,52)|0,Oe()|0,V=V&15,S=(V|0)<(Ve|0),V=(V|0)==(Ve|0),B=S?0:V?Y:0,V=S?0:V?M:0,S=Hs(B|0,V|0,x|0,be|0)|0,Oe()|0,d=0;;){if((d|0)>(x|0)){v=98;break e}if(E=xe+(S<<3)|0,j=a[E+4>>2]|0,(j&-117440513|0)==(V|0)&&(a[E>>2]|0)==(B|0)){v=70;break}if(S=(S+1|0)%(x|0)|0,E=xe+(S<<3)|0,(a[E>>2]|0)==(B|0)&&(a[E+4>>2]|0)==(V|0))break;d=d+1|0}if((v|0)==70&&(v=0,!0&(j&117440512|0)==100663296))break;E=h+(b<<3)|0,a[E>>2]=Y,a[E+4>>2]=M,b=b+1|0}while(0);if(l=l+1|0,(l|0)>=(x|0)){x=ne;break t}M=m+(l<<3)|0,Y=a[M>>2]|0,M=a[M+4>>2]|0}for(l=0,b=0;;){do if(!((Y|0)==0&(M|0)==0)){if(V=Mt(Y|0,M|0,52)|0,Oe()|0,V=V&15,(V|0)>=(Ve|0))if((V|0)!=(Ve|0))if(d=Y|ae,S=M&-15728641|ue,V>>>0<Te>>>0)V=S;else{B=Ve;do E=Pt(7,0,(14-B|0)*3|0)|0,B=B+1|0,d=E|d,S=Oe()|0|S;while(B>>>0<V>>>0);V=S}else d=Y,V=M;else d=0,V=0;for(B=Hs(d|0,V|0,x|0,be|0)|0,Oe()|0,S=0;;){if((S|0)>(x|0)){v=98;break e}if(E=xe+(B<<3)|0,j=a[E+4>>2]|0,(j&-117440513|0)==(V|0)&&(a[E>>2]|0)==(d|0)){v=93;break}if(B=(B+1|0)%(x|0)|0,E=xe+(B<<3)|0,(a[E>>2]|0)==(d|0)&&(a[E+4>>2]|0)==(V|0))break;S=S+1|0}if((v|0)==93&&(v=0,!0&(j&117440512|0)==100663296))break;E=h+(b<<3)|0,a[E>>2]=Y,a[E+4>>2]=M,b=b+1|0}while(0);if(l=l+1|0,(l|0)>=(x|0)){x=ne;break t}M=m+(l<<3)|0,Y=a[M>>2]|0,M=a[M+4>>2]|0}}else b=0,x=ne}else b=0,x=0;while(0);if(L(xe|0,0,y|0)|0,Ws(m|0,Ce|0,x<<3|0)|0,hn(Ce),x)h=h+(b<<3)|0;else break}return(v|0)==41?(hn(m),hn(xe),E=-1,E|0):(v|0)==51?(hn(m),hn(xe),E=-2,E|0):(v|0)==58?(hn(m),hn(xe),E=-3,E|0):(v|0)==98?(hn(Ce),hn(m),hn(xe),E=-1,E|0):((v|0)==99&&Ws(h|0,m|0,x<<3|0)|0,hn(m),hn(xe),E=0,E|0)}function Us(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0;if((h|0)<=0)return b=0,b|0;if((b|0)>=16){for(S=0;;){if(Y=l+(S<<3)|0,!((a[Y>>2]|0)==0&(a[Y+4>>2]|0)==0)){S=14;break}if(S=S+1|0,(S|0)>=(h|0)){M=0,S=16;break}}if((S|0)==14)return((x|0)>0?-2:-1)|0;if((S|0)==16)return M|0}S=0,Y=0;e:for(;;){j=l+(Y<<3)|0,B=j,M=a[B>>2]|0,B=a[B+4>>2]|0;do if(!((M|0)==0&(B|0)==0)){if((S|0)>=(x|0)){M=-1,S=16;break e}if(V=Mt(M|0,B|0,52)|0,Oe()|0,V=V&15,(V|0)>(b|0)){M=-2,S=16;break e}if((V|0)==(b|0)){j=d+(S<<3)|0,a[j>>2]=M,a[j+4>>2]=B,S=S+1|0;break}if(M=(kl(7,b-V|0)|0)+S|0,(M|0)>(x|0)){M=-1,S=16;break e}Wr(a[j>>2]|0,a[j+4>>2]|0,b,d+(S<<3)|0),S=M}while(0);if(Y=Y+1|0,(Y|0)>=(h|0)){M=0,S=16;break}}return(S|0)==16?M|0:0}function fc(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if((h|0)<=0)return d=0,d|0;if((d|0)>=16){for(x=0;;){if(M=l+(x<<3)|0,!((a[M>>2]|0)==0&(a[M+4>>2]|0)==0)){x=-1,b=13;break}if(x=x+1|0,(x|0)>=(h|0)){x=0,b=13;break}}if((b|0)==13)return x|0}x=0,M=0;e:for(;;){b=l+(M<<3)|0,S=a[b>>2]|0,b=a[b+4>>2]|0;do if(!((S|0)==0&(b|0)==0)){if(b=Mt(S|0,b|0,52)|0,Oe()|0,b=b&15,(b|0)>(d|0)){x=-1,b=13;break e}if((b|0)==(d|0)){x=x+1|0;break}else{x=(kl(7,d-b|0)|0)+x|0;break}}while(0);if(M=M+1|0,(M|0)>=(h|0)){b=13;break}}return(b|0)==13?x|0:0}function mA(l,h){return l=l|0,h=h|0,h=Mt(l|0,h|0,52)|0,Oe()|0,h&1|0}function li(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;if(b=Mt(l|0,h|0,52)|0,Oe()|0,b=b&15,!b)return b=0,b|0;for(x=1;;){if(d=Mt(l|0,h|0,(15-x|0)*3|0)|0,Oe()|0,d=d&7,d|0){x=5;break}if(x>>>0<b>>>0)x=x+1|0;else{d=0,x=5;break}}return(x|0)==5?d|0:0}function _i(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(V=Mt(l|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=l,Ft(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,x=Pt(7,0,S|0)|0,b=Oe()|0,M=Mt(l|0,h|0,S|0)|0,Oe()|0,S=Pt(Gi(M&7)|0,0,S|0)|0,M=Oe()|0,l=S|l&~x,h=M|h&~b;e:do if(!d)if((S&x|0)==0&(M&b|0)==0)d=0;else if(x=Mt(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)d=1;else{d=1;t:for(;;){switch(M=Mt(l|0,h|0,(15-d|0)*3|0)|0,Oe()|0,M&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<x>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(M=(15-d|0)*3|0,b=Mt(l|0,h|0,M|0)|0,Oe()|0,S=Pt(7,0,M|0)|0,h=h&~(Oe()|0),M=Pt(Gi(b&7)|0,0,M|0)|0,l=l&~S|M,h=h|(Oe()|0),d>>>0<x>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ft(h|0),l|0}function ls(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(x=Mt(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)return d=h,x=l,Ft(d|0),x|0;for(d=1;S=(15-d|0)*3|0,M=Mt(l|0,h|0,S|0)|0,Oe()|0,b=Pt(7,0,S|0)|0,h=h&~(Oe()|0),S=Pt(Gi(M&7)|0,0,S|0)|0,l=S|l&~b,h=Oe()|0|h,d>>>0<x>>>0;)d=d+1|0;return Ft(h|0),l|0}function da(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(V=Mt(l|0,h|0,52)|0,Oe()|0,V=V&15,!V)return B=h,V=l,Ft(B|0),V|0;for(B=1,d=0;;){S=(15-B|0)*3|0,x=Pt(7,0,S|0)|0,b=Oe()|0,M=Mt(l|0,h|0,S|0)|0,Oe()|0,S=Pt($i(M&7)|0,0,S|0)|0,M=Oe()|0,l=S|l&~x,h=M|h&~b;e:do if(!d)if((S&x|0)==0&(M&b|0)==0)d=0;else if(x=Mt(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)d=1;else{d=1;t:for(;;){switch(M=Mt(l|0,h|0,(15-d|0)*3|0)|0,Oe()|0,M&7){case 1:break t;case 0:break;default:{d=1;break e}}if(d>>>0<x>>>0)d=d+1|0;else{d=1;break e}}for(d=1;;)if(b=(15-d|0)*3|0,S=Pt(7,0,b|0)|0,M=h&~(Oe()|0),h=Mt(l|0,h|0,b|0)|0,Oe()|0,h=Pt($i(h&7)|0,0,b|0)|0,l=l&~S|h,h=M|(Oe()|0),d>>>0<x>>>0)d=d+1|0;else{d=1;break}}while(0);if(B>>>0<V>>>0)B=B+1|0;else break}return Ft(h|0),l|0}function qi(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0;if(x=Mt(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)return d=h,x=l,Ft(d|0),x|0;for(d=1;M=(15-d|0)*3|0,S=Pt(7,0,M|0)|0,b=h&~(Oe()|0),h=Mt(l|0,h|0,M|0)|0,Oe()|0,h=Pt($i(h&7)|0,0,M|0)|0,l=h|l&~S,h=Oe()|0|b,d>>>0<x>>>0;)d=d+1|0;return Ft(h|0),l|0}function _o(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0;if(V=De,De=De+64|0,B=V+40|0,x=V+24|0,b=V+12|0,S=V,Pt(h|0,0,52)|0,d=Oe()|0|134225919,!h)return(a[l+4>>2]|0)>2||(a[l+8>>2]|0)>2||(a[l+12>>2]|0)>2?(M=0,B=0,Ft(M|0),De=V,B|0):(Pt(Gn(l)|0,0,45)|0,M=Oe()|0|d,B=-1,Ft(M|0),De=V,B|0);if(a[B>>2]=a[l>>2],a[B+4>>2]=a[l+4>>2],a[B+8>>2]=a[l+8>>2],a[B+12>>2]=a[l+12>>2],M=B+4|0,(h|0)>0)for(l=-1;a[x>>2]=a[M>>2],a[x+4>>2]=a[M+4>>2],a[x+8>>2]=a[M+8>>2],h&1?(vl(M),a[b>>2]=a[M>>2],a[b+4>>2]=a[M+4>>2],a[b+8>>2]=a[M+8>>2],ua(b)):(Uo(M),a[b>>2]=a[M>>2],a[b+4>>2]=a[M+4>>2],a[b+8>>2]=a[M+8>>2],go(b)),bs(x,b,S),Hr(S),Y=(15-h|0)*3|0,j=Pt(7,0,Y|0)|0,d=d&~(Oe()|0),Y=Pt(po(S)|0,0,Y|0)|0,l=Y|l&~j,d=Oe()|0|d,(h|0)>1;)h=h+-1|0;else l=-1;e:do if((a[M>>2]|0)<=2&&(a[B+8>>2]|0)<=2&&(a[B+12>>2]|0)<=2){if(x=Gn(B)|0,h=Pt(x|0,0,45)|0,h=h|l,l=Oe()|0|d&-1040385,S=lA(B)|0,!(en(x)|0)){if((S|0)<=0)break;for(b=0;;){if(x=Mt(h|0,l|0,52)|0,Oe()|0,x=x&15,x)for(d=1;Y=(15-d|0)*3|0,B=Mt(h|0,l|0,Y|0)|0,Oe()|0,j=Pt(7,0,Y|0)|0,l=l&~(Oe()|0),Y=Pt(Gi(B&7)|0,0,Y|0)|0,h=h&~j|Y,l=l|(Oe()|0),d>>>0<x>>>0;)d=d+1|0;if(b=b+1|0,(b|0)==(S|0))break e}}b=Mt(h|0,l|0,52)|0,Oe()|0,b=b&15;t:do if(b){d=1;n:for(;;){switch(Y=Mt(h|0,l|0,(15-d|0)*3|0)|0,Oe()|0,Y&7){case 1:break n;case 0:break;default:break t}if(d>>>0<b>>>0)d=d+1|0;else break t}if(QA(x,a[B>>2]|0)|0)for(d=1;B=(15-d|0)*3|0,j=Pt(7,0,B|0)|0,Y=l&~(Oe()|0),l=Mt(h|0,l|0,B|0)|0,Oe()|0,l=Pt($i(l&7)|0,0,B|0)|0,h=h&~j|l,l=Y|(Oe()|0),d>>>0<b>>>0;)d=d+1|0;else for(d=1;Y=(15-d|0)*3|0,B=Mt(h|0,l|0,Y|0)|0,Oe()|0,j=Pt(7,0,Y|0)|0,l=l&~(Oe()|0),Y=Pt(Gi(B&7)|0,0,Y|0)|0,h=h&~j|Y,l=l|(Oe()|0),d>>>0<b>>>0;)d=d+1|0}while(0);if((S|0)>0){d=0;do h=_i(h,l)|0,l=Oe()|0,d=d+1|0;while((d|0)!=(S|0))}}else h=0,l=0;while(0);return j=l,Y=h,Ft(j|0),De=V,Y|0}function hi(l){return l=l|0,(l|0)%2|0|0}function $a(l,h){l=l|0,h=h|0;var d=0,x=0;return x=De,De=De+16|0,d=x,h>>>0<=15&&(a[l+4>>2]&2146435072|0)!=2146435072&&(a[l+8+4>>2]&2146435072|0)!=2146435072?(pA(l,h,d),h=_o(d,h)|0,l=Oe()|0):(l=0,h=0),Ft(l|0),De=x,h|0}function Cl(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(b=d+4|0,S=Mt(l|0,h|0,52)|0,Oe()|0,S=S&15,M=Mt(l|0,h|0,45)|0,Oe()|0,x=(S|0)==0,en(M&127)|0){if(x)return M=1,M|0;x=1}else{if(x)return M=0,M|0;!(a[b>>2]|0)&&!(a[d+8>>2]|0)?x=(a[d+12>>2]|0)!=0&1:x=1}for(d=1;d&1?ua(b):go(b),M=Mt(l|0,h|0,(15-d|0)*3|0)|0,Oe()|0,dA(b,M&7),d>>>0<S>>>0;)d=d+1|0;return x|0}function ja(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0;Y=De,De=De+16|0,V=Y,j=Mt(l|0,h|0,45)|0,Oe()|0,j=j&127;e:do if(en(j)|0&&(S=Mt(l|0,h|0,52)|0,Oe()|0,S=S&15,(S|0)!=0)){x=1;t:for(;;){switch(B=Mt(l|0,h|0,(15-x|0)*3|0)|0,Oe()|0,B&7){case 5:break t;case 0:break;default:{x=h;break e}}if(x>>>0<S>>>0)x=x+1|0;else{x=h;break e}}for(b=1,x=h;h=(15-b|0)*3|0,M=Pt(7,0,h|0)|0,B=x&~(Oe()|0),x=Mt(l|0,x|0,h|0)|0,Oe()|0,x=Pt($i(x&7)|0,0,h|0)|0,l=l&~M|x,x=B|(Oe()|0),b>>>0<S>>>0;)b=b+1|0}else x=h;while(0);if(B=7728+(j*28|0)|0,a[d>>2]=a[B>>2],a[d+4>>2]=a[B+4>>2],a[d+8>>2]=a[B+8>>2],a[d+12>>2]=a[B+12>>2],!(Cl(l,x,d)|0)){De=Y;return}if(M=d+4|0,a[V>>2]=a[M>>2],a[V+4>>2]=a[M+4>>2],a[V+8>>2]=a[M+8>>2],S=Mt(l|0,x|0,52)|0,Oe()|0,B=S&15,S&1?(go(M),S=B+1|0):S=B,!(en(j)|0))x=0;else{e:do if(!B)x=0;else for(h=1;;){if(b=Mt(l|0,x|0,(15-h|0)*3|0)|0,Oe()|0,b=b&7,b|0){x=b;break e}if(h>>>0<B>>>0)h=h+1|0;else{x=0;break}}while(0);x=(x|0)==4&1}if(!(yo(d,S,x,0)|0))(S|0)!=(B|0)&&(a[M>>2]=a[V>>2],a[M+4>>2]=a[V+4>>2],a[M+8>>2]=a[V+8>>2]);else{if(en(j)|0)do;while(yo(d,S,0,0)|0);(S|0)!=(B|0)&&Uo(M)}De=Y}function Vs(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;x=De,De=De+16|0,b=x,ja(l,h,b),h=Mt(l|0,h|0,52)|0,Oe()|0,Ua(b,h&15,d),De=x}function As(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;M=De,De=De+16|0,S=M,ja(l,h,S),x=Mt(l|0,h|0,45)|0,Oe()|0,x=(en(x&127)|0)==0,b=Mt(l|0,h|0,52)|0,Oe()|0,b=b&15;e:do if(!x){if(b|0)for(x=1;;){if(B=Pt(7,0,(15-x|0)*3|0)|0,!((B&l|0)==0&((Oe()|0)&h|0)==0))break e;if(x>>>0<b>>>0)x=x+1|0;else break}JA(S,b,0,5,d),De=M;return}while(0);tu(S,b,0,6,d),De=M}function dc(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;if(x=Mt(l|0,h|0,45)|0,Oe()|0,!(en(x&127)|0))return x=2,x|0;if(x=Mt(l|0,h|0,52)|0,Oe()|0,x=x&15,!x)return x=5,x|0;for(d=1;;){if(b=Pt(7,0,(15-d|0)*3|0)|0,!((b&l|0)==0&((Oe()|0)&h|0)==0)){d=2,l=6;break}if(d>>>0<x>>>0)d=d+1|0;else{d=5,l=6;break}}return(l|0)==6?d|0:0}function pa(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0;ae=De,De=De+128|0,j=ae+112|0,S=ae+96|0,Y=ae,b=Mt(l|0,h|0,52)|0,Oe()|0,B=b&15,a[j>>2]=B,M=Mt(l|0,h|0,45)|0,Oe()|0,M=M&127;e:do if(en(M)|0){if(B|0)for(x=1;;){if(V=Pt(7,0,(15-x|0)*3|0)|0,!((V&l|0)==0&((Oe()|0)&h|0)==0)){b=0;break e}if(x>>>0<B>>>0)x=x+1|0;else break}if(b&1)b=1;else{V=Pt(B+1|0,0,52)|0,Y=Oe()|0|h&-15728641,j=Pt(7,0,(14-B|0)*3|0)|0,pa((V|l)&~j,Y&~(Oe()|0),d),De=ae;return}}else b=0;while(0);ja(l,h,S),b?(eu(S,j,Y),V=5):(ha(S,j,Y),V=6);e:do if(en(M)|0)if(!B)x=20;else for(x=1;;){if(M=Pt(7,0,(15-x|0)*3|0)|0,!((M&l|0)==0&((Oe()|0)&h|0)==0)){x=8;break e}if(x>>>0<B>>>0)x=x+1|0;else{x=20;break}}else x=8;while(0);if(L(d|0,-1,x|0)|0,b){b=0;do{for(S=Y+(b<<4)|0,ca(S,a[j>>2]|0)|0,S=a[S>>2]|0,x=0;M=d+(x<<2)|0,B=a[M>>2]|0,!((B|0)==-1|(B|0)==(S|0));)x=x+1|0;a[M>>2]=S,b=b+1|0}while((b|0)!=(V|0))}else{b=0;do{for(S=Y+(b<<4)|0,yo(S,a[j>>2]|0,0,1)|0,S=a[S>>2]|0,x=0;M=d+(x<<2)|0,B=a[M>>2]|0,!((B|0)==-1|(B|0)==(S|0));)x=x+1|0;a[M>>2]=S,b=b+1|0}while((b|0)!=(V|0))}De=ae}function Ha(){return 12}function ni(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(Pt(l|0,0,52)|0,B=Oe()|0|134225919,(l|0)<1){x=0,d=0;do en(x)|0&&(Pt(x|0,0,45)|0,M=B|(Oe()|0),l=h+(d<<3)|0,a[l>>2]=-1,a[l+4>>2]=M,d=d+1|0),x=x+1|0;while((x|0)!=122);return}M=0,d=0;do{if(en(M)|0){for(Pt(M|0,0,45)|0,x=1,b=-1,S=B|(Oe()|0);V=Pt(7,0,(15-x|0)*3|0)|0,b=b&~V,S=S&~(Oe()|0),(x|0)!=(l|0);)x=x+1|0;V=h+(d<<3)|0,a[V>>2]=b,a[V+4>>2]=S,d=d+1|0}M=M+1|0}while((M|0)!=122)}function Es(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0;if(B=De,De=De+64|0,M=B,(l|0)==(d|0)&(h|0)==(x|0)|(!1|(h&2013265920|0)!=134217728|(!1|(x&2013265920|0)!=134217728))||(b=Mt(l|0,h|0,52)|0,Oe()|0,b=b&15,S=Mt(d|0,x|0,52)|0,Oe()|0,(b|0)!=(S&15|0)))return M=0,De=B,M|0;if(S=b+-1|0,b>>>0>1&&(j=Ml(l,h,S)|0,V=Oe()|0,S=Ml(d,x,S)|0,(j|0)==(S|0)&(V|0)==(Oe()|0))&&(S=(b^15)*3|0,b=Mt(l|0,h|0,S|0)|0,Oe()|0,b=b&7,S=Mt(d|0,x|0,S|0)|0,Oe()|0,S=S&7,(b|0)==0|(S|0)==0||(a[21136+(b<<2)>>2]|0)==(S|0)||(a[21168+(b<<2)>>2]|0)==(S|0)))return j=1,De=B,j|0;b=M,S=b+56|0;do a[b>>2]=0,b=b+4|0;while((b|0)<(S|0));return la(l,h,1,M),j=M,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0))&&(j=M+8|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))&&(j=M+16|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))&&(j=M+24|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))&&(j=M+32|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))&&(j=M+40|0,!((a[j>>2]|0)==(d|0)&&(a[j+4>>2]|0)==(x|0)))?(b=M+48|0,b=((a[b>>2]|0)==(d|0)?(a[b+4>>2]|0)==(x|0):0)&1):b=1,j=b,De=B,j|0}function Zi(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0;if(j=De,De=De+16|0,M=j,!(Es(l,h,d,x)|0))return B=0,V=0,Ft(B|0),De=j,V|0;for(B=h&-2130706433,b=(Ir(l,h)|0)==0,b=b?1:2;a[M>>2]=0,Y=ge(l,h,b,M)|0,S=b+1|0,!((Y|0)==(d|0)&(Oe()|0)==(x|0));)if(S>>>0<7)b=S;else{b=0,l=0,V=6;break}return(V|0)==6?(Ft(b|0),De=j,l|0):(Y=Pt(b|0,0,56)|0,V=B|(Oe()|0)|268435456,Y=l|Y,Ft(V|0),De=j,Y|0)}function Pl(l,h){l=l|0,h=h|0;var d=0;return d=!0&(h&2013265920|0)==268435456,Ft((d?h&-2130706433|134217728:0)|0),(d?l:0)|0}function Ho(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;return x=De,De=De+16|0,d=x,!0&(h&2013265920|0)==268435456?(b=Mt(l|0,h|0,56)|0,Oe()|0,a[d>>2]=0,d=ge(l,h&-2130706433|134217728,b&7,d)|0,h=Oe()|0,Ft(h|0),De=x,d|0):(h=0,d=0,Ft(h|0),De=x,d|0)}function pc(l,h){l=l|0,h=h|0;var d=0;if(!(!0&(h&2013265920|0)==268435456))return d=0,d|0;switch(d=Mt(l|0,h|0,56)|0,Oe()|0,d&7){case 0:case 7:return d=0,d|0}return d=h&-2130706433|134217728,!0&(h&117440512|0)==16777216&(Ir(l,d)|0)!=0?(d=0,d|0):(d=ru(l,d)|0,d|0)}function vo(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;S=De,De=De+16|0,x=S,M=!0&(h&2013265920|0)==268435456,b=h&-2130706433|134217728,B=d,a[B>>2]=M?l:0,a[B+4>>2]=M?b:0,M?(h=Mt(l|0,h|0,56)|0,Oe()|0,a[x>>2]=0,l=ge(l,b,h&7,x)|0,h=Oe()|0):(l=0,h=0),B=d+8|0,a[B>>2]=l,a[B+4>>2]=h,De=S}function Il(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;b=(Ir(l,h)|0)==0,h=h&-2130706433,x=d,a[x>>2]=b?l:0,a[x+4>>2]=b?h|285212672:0,x=d+8|0,a[x>>2]=l,a[x+4>>2]=h|301989888,x=d+16|0,a[x>>2]=l,a[x+4>>2]=h|318767104,x=d+24|0,a[x>>2]=l,a[x+4>>2]=h|335544320,x=d+32|0,a[x>>2]=l,a[x+4>>2]=h|352321536,d=d+40|0,a[d>>2]=l,a[d+4>>2]=h|369098752}function Wa(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0;if(M=De,De=De+16|0,S=M,x=Mt(l|0,h|0,56)|0,Oe()|0,B=!0&(h&2013265920|0)==268435456,b=B?l:0,l=B?h&-2130706433|134217728:0,h=cs(b,l,x&7)|0,(h|0)==-1){a[d>>2]=0,De=M;return}ja(b,l,S),x=Mt(b|0,l|0,52)|0,Oe()|0,x=x&15,Ir(b,l)|0?JA(S,x,h,2,d):tu(S,x,h,2,d),De=M}function gh(l){l=l|0;var h=0,d=0,x=0;return h=Yi(1,12)|0,h||Ct(22691,22646,49,22704),d=l+4|0,x=a[d>>2]|0,x|0?(x=x+8|0,a[x>>2]=h,a[d>>2]=h,h|0):(a[l>>2]|0&&Ct(22721,22646,61,22744),x=l,a[x>>2]=h,a[d>>2]=h,h|0)}function mh(l,h){l=l|0,h=h|0;var d=0,x=0;return x=Xt(24)|0,x||Ct(22758,22646,78,22772),a[x>>2]=a[h>>2],a[x+4>>2]=a[h+4>>2],a[x+8>>2]=a[h+8>>2],a[x+12>>2]=a[h+12>>2],a[x+16>>2]=0,h=l+4|0,d=a[h>>2]|0,d|0?(a[d+16>>2]=x,a[h>>2]=x,x|0):(a[l>>2]|0&&Ct(22787,22646,82,22772),a[l>>2]=x,a[h>>2]=x,x|0)}function Qa(l){l=l|0;var h=0,d=0,x=0,b=0;if(l)for(x=1;;){if(h=a[l>>2]|0,h|0)do{if(d=a[h>>2]|0,d|0)do b=d,d=a[d+16>>2]|0,hn(b);while(d|0);b=h,h=a[h+8>>2]|0,hn(b)}while(h|0);if(h=l,l=a[l+8>>2]|0,x||hn(h),l)x=0;else break}}function ga(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,y=0,m=0,v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0;if(b=l+8|0,a[b>>2]|0)return de=1,de|0;if(x=a[l>>2]|0,!x)return de=0,de|0;h=x,d=0;do d=d+1|0,h=a[h+8>>2]|0;while(h|0);if(d>>>0<2)return de=0,de|0;J=Xt(d<<2)|0,J||Ct(22807,22646,317,22826),Q=Xt(d<<5)|0,Q||Ct(22848,22646,321,22826),a[l>>2]=0,m=l+4|0,a[m>>2]=0,a[b>>2]=0,d=0,N=0,y=0,ae=0;e:for(;;){if(Y=a[x>>2]|0,Y){S=0,M=Y;do{if(V=+G[M+8>>3],h=M,M=a[M+16>>2]|0,j=(M|0)==0,b=j?Y:M,B=+G[b+8>>3],+Pe(+(V-B))>3.141592653589793){de=14;break}S=S+(B-V)*(+G[h>>3]+ +G[b>>3])}while(!j);if((de|0)==14){de=0,S=0,h=Y;do xe=+G[h+8>>3],O=h+16|0,R=a[O>>2]|0,R=R|0?R:Y,Ve=+G[R+8>>3],S=S+(+G[h>>3]+ +G[R>>3])*((Ve<0?Ve+6.283185307179586:Ve)-(xe<0?xe+6.283185307179586:xe)),h=a[(h|0?O:x)>>2]|0;while(h|0)}S>0?(a[J+(N<<2)>>2]=x,N=N+1|0,b=y,h=ae):de=19}else de=19;if((de|0)==19){de=0;do if(d){if(h=d+8|0,a[h>>2]|0){de=21;break e}if(d=Yi(1,12)|0,!d){de=23;break e}a[h>>2]=d,b=d+4|0,M=d,h=ae}else if(ae){b=m,M=ae+8|0,h=x,d=l;break}else if(a[l>>2]|0){de=27;break e}else{b=m,M=l,h=x,d=l;break}while(0);if(a[M>>2]=x,a[b>>2]=x,M=Q+(y<<5)|0,j=a[x>>2]|0,j){for(Y=Q+(y<<5)+8|0,G[Y>>3]=17976931348623157e292,ae=Q+(y<<5)+24|0,G[ae>>3]=17976931348623157e292,G[M>>3]=-17976931348623157e292,ne=Q+(y<<5)+16|0,G[ne>>3]=-17976931348623157e292,Ge=17976931348623157e292,Te=-17976931348623157e292,b=0,ue=j,V=17976931348623157e292,Ce=17976931348623157e292,ve=-17976931348623157e292,B=-17976931348623157e292;S=+G[ue>>3],xe=+G[ue+8>>3],ue=a[ue+16>>2]|0,be=(ue|0)==0,Ve=+G[(be?j:ue)+8>>3],S<V&&(G[Y>>3]=S,V=S),xe<Ce&&(G[ae>>3]=xe,Ce=xe),S>ve?G[M>>3]=S:S=ve,xe>B&&(G[ne>>3]=xe,B=xe),Ge=xe>0&xe<Ge?xe:Ge,Te=xe<0&xe>Te?xe:Te,b=b|+Pe(+(xe-Ve))>3.141592653589793,!be;)ve=S;b&&(G[ne>>3]=Te,G[ae>>3]=Ge)}else a[M>>2]=0,a[M+4>>2]=0,a[M+8>>2]=0,a[M+12>>2]=0,a[M+16>>2]=0,a[M+20>>2]=0,a[M+24>>2]=0,a[M+28>>2]=0;b=y+1|0}if(O=x+8|0,x=a[O>>2]|0,a[O>>2]=0,x)y=b,ae=h;else{de=45;break}}if((de|0)==21)Ct(22624,22646,35,22658);else if((de|0)==23)Ct(22678,22646,37,22658);else if((de|0)==27)Ct(22721,22646,61,22744);else if((de|0)==45){e:do if((N|0)>0){for(O=(b|0)==0,P=b<<2,R=(l|0)==0,E=0,h=0;;){if(v=a[J+(E<<2)>>2]|0,O)de=73;else{if(y=Xt(P)|0,!y){de=50;break}if(m=Xt(P)|0,!m){de=52;break}t:do if(R)d=0;else{for(b=0,d=0,M=l;x=Q+(b<<5)|0,us(a[M>>2]|0,x,a[v>>2]|0)|0?(a[y+(d<<2)>>2]=M,a[m+(d<<2)>>2]=x,be=d+1|0):be=d,M=a[M+8>>2]|0,M;)b=b+1|0,d=be;if((be|0)>0)if(x=a[y>>2]|0,(be|0)==1)d=x;else for(ne=0,ue=-1,d=x,ae=x;;){for(j=a[ae>>2]|0,x=0,M=0;b=a[a[y+(M<<2)>>2]>>2]|0,(b|0)==(j|0)?Y=x:Y=x+((us(b,a[m+(M<<2)>>2]|0,a[j>>2]|0)|0)&1)|0,M=M+1|0,(M|0)!=(be|0);)x=Y;if(b=(Y|0)>(ue|0),d=b?ae:d,x=ne+1|0,(x|0)==(be|0))break t;ne=x,ue=b?Y:ue,ae=a[y+(x<<2)>>2]|0}else d=0}while(0);if(hn(y),hn(m),d){if(b=d+4|0,x=a[b>>2]|0,x)d=x+8|0;else if(a[d>>2]|0){de=70;break}a[d>>2]=v,a[b>>2]=v}else de=73}if((de|0)==73){if(de=0,h=a[v>>2]|0,h|0)do m=h,h=a[h+16>>2]|0,hn(m);while(h|0);hn(v),h=2}if(E=E+1|0,(E|0)>=(N|0)){le=h;break e}}(de|0)==50?Ct(22863,22646,249,22882):(de|0)==52?Ct(22901,22646,252,22882):(de|0)==70&&Ct(22721,22646,61,22744)}else le=0;while(0);return hn(J),hn(Q),de=le,de|0}return 0}function us(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0;if(!(fA(h,d)|0)||(h=hA(h)|0,j=+G[d>>3],x=+G[d+8>>3],x=h&x<0?x+6.283185307179586:x,l=a[l>>2]|0,!l))return l=0,l|0;if(h){h=0,d=l;e:for(;;){for(;M=+G[d>>3],V=+G[d+8>>3],d=d+16|0,Y=a[d>>2]|0,Y=Y|0?Y:l,S=+G[Y>>3],b=+G[Y+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(j<S|j>B);)if(d=a[d>>2]|0,!d){d=22;break e}if(V=b<0?b+6.283185307179586:b,M=M<0?M+6.283185307179586:M,x=M==x|V==x?x+-2220446049250313e-31:x,V=V+(j-S)/(B-S)*(M-V),(V<0?V+6.283185307179586:V)>x&&(h=h^1),d=a[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}else{h=0,d=l;e:for(;;){for(;M=+G[d>>3],V=+G[d+8>>3],d=d+16|0,Y=a[d>>2]|0,Y=Y|0?Y:l,S=+G[Y>>3],b=+G[Y+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(j<S|j>B);)if(d=a[d>>2]|0,!d){d=22;break e}if(x=M==x|b==x?x+-2220446049250313e-31:x,b+(j-S)/(B-S)*(M-b)>x&&(h=h^1),d=a[d>>2]|0,!d){d=22;break}}if((d|0)==22)return h|0}return 0}function Nt(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0;if(Te=De,De=De+32|0,Ge=Te+16|0,ve=Te,S=Mt(l|0,h|0,52)|0,Oe()|0,S=S&15,ue=Mt(d|0,x|0,52)|0,Oe()|0,(S|0)!=(ue&15|0))return Ge=1,De=Te,Ge|0;if(j=Mt(l|0,h|0,45)|0,Oe()|0,j=j&127,Y=Mt(d|0,x|0,45)|0,Oe()|0,Y=Y&127,ue=(j|0)!=(Y|0),ue){if(B=cA(j,Y)|0,(B|0)==7)return Ge=2,De=Te,Ge|0;V=cA(Y,j)|0,(V|0)==7?Ct(22925,22949,151,22959):(be=B,M=V)}else be=0,M=0;ae=en(j)|0,ne=en(Y)|0,a[Ge>>2]=0,a[Ge+4>>2]=0,a[Ge+8>>2]=0,a[Ge+12>>2]=0;do if(be){if(Y=a[4304+(j*28|0)+(be<<2)>>2]|0,B=(Y|0)>0,ne)if(B){j=0,V=d,B=x;do V=da(V,B)|0,B=Oe()|0,M=$i(M)|0,(M|0)==1&&(M=$i(1)|0),j=j+1|0;while((j|0)!=(Y|0));Y=M,j=V,V=B}else Y=M,j=d,V=x;else if(B){j=0,V=d,B=x;do V=qi(V,B)|0,B=Oe()|0,M=$i(M)|0,j=j+1|0;while((j|0)!=(Y|0));Y=M,j=V,V=B}else Y=M,j=d,V=x;if(Cl(j,V,Ge)|0,ue||Ct(22972,22949,181,22959),B=(ae|0)!=0,M=(ne|0)!=0,B&M&&Ct(22999,22949,182,22959),B){if(M=li(l,h)|0,he[22032+(M*7|0)+be>>0]|0){S=3;break}V=a[21200+(M*28|0)+(be<<2)>>2]|0,j=V,Ce=26}else if(M){if(M=li(j,V)|0,he[22032+(M*7|0)+Y>>0]|0){S=4;break}j=0,V=a[21200+(Y*28|0)+(M<<2)>>2]|0,Ce=26}else M=0;if((Ce|0)==26)if((V|0)<=-1&&Ct(23030,22949,212,22959),(j|0)<=-1&&Ct(23053,22949,213,22959),(V|0)>0){B=Ge+4|0,M=0;do Vo(B),M=M+1|0;while((M|0)!=(V|0));M=j}else M=j;if(a[ve>>2]=0,a[ve+4>>2]=0,a[ve+8>>2]=0,dA(ve,be),S|0)for(;hi(S)|0?ua(ve):go(ve),(S|0)>1;)S=S+-1|0;if((M|0)>0){S=0;do Vo(ve),S=S+1|0;while((S|0)!=(M|0))}Ce=Ge+4|0,zn(Ce,ve,Ce),Hr(Ce),Ce=50}else if(Cl(d,x,Ge)|0,(ae|0)!=0&(ne|0)!=0)if((Y|0)!=(j|0)&&Ct(23077,22949,243,22959),M=li(l,h)|0,S=li(d,x)|0,he[22032+(M*7|0)+S>>0]|0)S=5;else if(M=a[21200+(M*28|0)+(S<<2)>>2]|0,(M|0)>0){B=Ge+4|0,S=0;do Vo(B),S=S+1|0;while((S|0)!=(M|0));Ce=50}else Ce=50;else Ce=50;while(0);return(Ce|0)==50&&(S=Ge+4|0,a[b>>2]=a[S>>2],a[b+4>>2]=a[S+4>>2],a[b+8>>2]=a[S+8>>2],S=0),Ge=S,De=Te,Ge|0}function su(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0;if(be=De,De=De+48|0,M=be+36|0,B=be+24|0,V=be+12|0,j=be,S=Mt(l|0,h|0,52)|0,Oe()|0,S=S&15,ne=Mt(l|0,h|0,45)|0,Oe()|0,ne=ne&127,Y=en(ne)|0,Pt(S|0,0,52)|0,ve=Oe()|0|134225919,Ce=x,a[Ce>>2]=-1,a[Ce+4>>2]=ve,!S)return(a[d>>2]|0)>1||(a[d+4>>2]|0)>1||(a[d+8>>2]|0)>1||(b=qA(ne,po(d)|0)|0,(b|0)==127)?(ve=1,De=be,ve|0):(ue=Pt(b|0,0,45)|0,Ce=Oe()|0,ne=x,Ce=a[ne+4>>2]&-1040385|Ce,ve=x,a[ve>>2]=a[ne>>2]|ue,a[ve+4>>2]=Ce,ve=0,De=be,ve|0);for(a[M>>2]=a[d>>2],a[M+4>>2]=a[d+4>>2],a[M+8>>2]=a[d+8>>2];a[B>>2]=a[M>>2],a[B+4>>2]=a[M+4>>2],a[B+8>>2]=a[M+8>>2],hi(S)|0?(vl(M),a[V>>2]=a[M>>2],a[V+4>>2]=a[M+4>>2],a[V+8>>2]=a[M+8>>2],ua(V)):(Uo(M),a[V>>2]=a[M>>2],a[V+4>>2]=a[M+4>>2],a[V+8>>2]=a[M+8>>2],go(V)),bs(B,V,j),Hr(j),Ce=x,Ge=a[Ce>>2]|0,Ce=a[Ce+4>>2]|0,Te=(15-S|0)*3|0,d=Pt(7,0,Te|0)|0,Ce=Ce&~(Oe()|0),Te=Pt(po(j)|0,0,Te|0)|0,Ce=Oe()|0|Ce,ve=x,a[ve>>2]=Te|Ge&~d,a[ve+4>>2]=Ce,(S|0)>1;)S=S+-1|0;e:do if((a[M>>2]|0)<=1&&(a[M+4>>2]|0)<=1&&(a[M+8>>2]|0)<=1){S=po(M)|0,B=qA(ne,S)|0,(B|0)==127?j=0:j=en(B)|0;t:do if(S){if(Y){if(M=21408+((li(l,h)|0)*28|0)+(S<<2)|0,M=a[M>>2]|0,(M|0)>0){d=0;do S=Gi(S)|0,d=d+1|0;while((d|0)!=(M|0))}if((S|0)==1){b=3;break e}d=qA(ne,S)|0,(d|0)==127&&Ct(23104,22949,376,23134),en(d)|0?Ct(23147,22949,377,23134):(ue=M,ae=S,b=d)}else ue=0,ae=S,b=B;if(V=a[4304+(ne*28|0)+(ae<<2)>>2]|0,(V|0)<=-1&&Ct(23178,22949,384,23134),!j){if((ue|0)<=-1&&Ct(23030,22949,417,23134),ue|0){M=x,S=0,d=a[M>>2]|0,M=a[M+4>>2]|0;do d=ls(d,M)|0,M=Oe()|0,Te=x,a[Te>>2]=d,a[Te+4>>2]=M,S=S+1|0;while((S|0)<(ue|0))}if((V|0)<=0){S=54;break}for(M=x,S=0,d=a[M>>2]|0,M=a[M+4>>2]|0;;)if(d=ls(d,M)|0,M=Oe()|0,Te=x,a[Te>>2]=d,a[Te+4>>2]=M,S=S+1|0,(S|0)==(V|0)){S=54;break t}}if(B=cA(b,ne)|0,(B|0)==7&&Ct(22925,22949,393,23134),S=x,d=a[S>>2]|0,S=a[S+4>>2]|0,(V|0)>0){M=0;do d=ls(d,S)|0,S=Oe()|0,Te=x,a[Te>>2]=d,a[Te+4>>2]=S,M=M+1|0;while((M|0)!=(V|0))}if(d=li(d,S)|0,Te=Pr(b)|0,d=a[(Te?21824:21616)+(B*28|0)+(d<<2)>>2]|0,(d|0)<=-1&&Ct(23030,22949,412,23134),!d)S=54;else{B=x,S=0,M=a[B>>2]|0,B=a[B+4>>2]|0;do M=_i(M,B)|0,B=Oe()|0,Te=x,a[Te>>2]=M,a[Te+4>>2]=B,S=S+1|0;while((S|0)<(d|0));S=54}}else if((Y|0)!=0&(j|0)!=0)if(Te=li(l,h)|0,S=x,S=21408+(Te*28|0)+((li(a[S>>2]|0,a[S+4>>2]|0)|0)<<2)|0,S=a[S>>2]|0,(S|0)<=-1&&Ct(23201,22949,433,23134),!S)b=B,S=55;else{M=x,b=0,d=a[M>>2]|0,M=a[M+4>>2]|0;do d=ls(d,M)|0,M=Oe()|0,Te=x,a[Te>>2]=d,a[Te+4>>2]=M,b=b+1|0;while((b|0)<(S|0));b=B,S=54}else b=B,S=54;while(0);if((S|0)==54&&j&&(S=55),(S|0)==55&&(Te=x,(li(a[Te>>2]|0,a[Te+4>>2]|0)|0)==1)){b=4;break}Te=x,ve=a[Te>>2]|0,Te=a[Te+4>>2]&-1040385,Ge=Pt(b|0,0,45)|0,Te=Te|(Oe()|0),b=x,a[b>>2]=ve|Ge,a[b+4>>2]=Te,b=0}else b=2;while(0);return Te=b,De=be,Te|0}function ma(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0;return M=De,De=De+16|0,S=M,l=Nt(l,h,d,x,S)|0,l||(Go(S,b),l=0),De=M,l|0}function Wo(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;return b=De,De=De+16|0,S=b,Ac(d,S),x=su(l,h,S,x)|0,De=b,x|0}function ou(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0;return M=De,De=De+32|0,b=M+12|0,S=M,!(Nt(l,h,l,h,b)|0)&&!(Nt(l,h,d,x,S)|0)?l=mo(b,S)|0:l=-1,De=M,l|0}function Vt(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0,M=0;return M=De,De=De+32|0,b=M+12|0,S=M,!(Nt(l,h,l,h,b)|0)&&!(Nt(l,h,d,x,S)|0)?l=mo(b,S)|0:l=-1,De=M,(l>>>31^1)+l|0}function yA(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,y=0,m=0;if(y=De,De=De+48|0,S=y+24|0,M=y+12|0,xe=y,!(Nt(l,h,l,h,S)|0)&&!(Nt(l,h,d,x,M)|0)){if(Ve=mo(S,M)|0,(Ve|0)<0)return xe=Ve,De=y,xe|0;for(a[S>>2]=0,a[S+4>>2]=0,a[S+8>>2]=0,a[M>>2]=0,a[M+4>>2]=0,a[M+8>>2]=0,Nt(l,h,l,h,S)|0,Nt(l,h,d,x,M)|0,XA(S),XA(M),Ve?(Y=a[S>>2]|0,ue=+(Ve|0),ve=S+4|0,ae=a[ve>>2]|0,Ge=S+8|0,ne=a[Ge>>2]|0,Te=S,d=Y,x=ae,S=ne,be=+((a[M>>2]|0)-Y|0)/ue,Ce=+((a[M+4>>2]|0)-ae|0)/ue,ue=+((a[M+8>>2]|0)-ne|0)/ue):(x=S+4|0,ne=S+8|0,ve=x,Ge=ne,Te=S,d=a[S>>2]|0,x=a[x>>2]|0,S=a[ne>>2]|0,be=0,Ce=0,ue=0),a[xe>>2]=d,ne=xe+4|0,a[ne>>2]=x,ae=xe+8|0,a[ae>>2]=S,Y=0;;){V=+(Y|0),m=be*V+ +(d|0),B=Ce*V+ +(a[ve>>2]|0),V=ue*V+ +(a[Ge>>2]|0),x=~~+Ya(+m),M=~~+Ya(+B),d=~~+Ya(+V),m=+Pe(+(+(x|0)-m)),B=+Pe(+(+(M|0)-B)),V=+Pe(+(+(d|0)-V));do if(m>B&m>V)x=0-(M+d)|0,S=M;else if(j=0-x|0,B>V){S=j-d|0;break}else{S=M,d=j-M|0;break}while(0);if(a[xe>>2]=x,a[ne>>2]=S,a[ae>>2]=d,wl(xe),su(l,h,xe,b+(Y<<3)|0)|0,(Y|0)==(Ve|0))break;Y=Y+1|0,d=a[Te>>2]|0}return xe=0,De=y,xe|0}return xe=-1,De=y,xe|0}function kl(l,h){l=l|0,h=h|0;var d=0;if(!h)return d=1,d|0;d=l,l=1;do l=qt(h&1|0?d:1,l)|0,h=h>>1,d=qt(d,d)|0;while(h|0);return l|0}function _A(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0;if(!(fA(h,d)|0)||(h=hA(h)|0,ne=+G[d>>3],x=+G[d+8>>3],x=h&x<0?x+6.283185307179586:x,ae=a[l>>2]|0,(ae|0)<=0))return ae=0,ae|0;if(Y=a[l+4>>2]|0,h){h=0,d=-1,l=0;e:for(;;){for(j=l;M=+G[Y+(j<<4)>>3],V=+G[Y+(j<<4)+8>>3],l=(d+2|0)%(ae|0)|0,S=+G[Y+(l<<4)>>3],b=+G[Y+(l<<4)+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(ne<S|ne>B);)if(d=j+1|0,(d|0)<(ae|0))l=j,j=d,d=l;else{d=22;break e}if(V=b<0?b+6.283185307179586:b,M=M<0?M+6.283185307179586:M,x=M==x|V==x?x+-2220446049250313e-31:x,V=V+(ne-S)/(B-S)*(M-V),(V<0?V+6.283185307179586:V)>x&&(h=h^1),l=j+1|0,(l|0)>=(ae|0)){d=22;break}else d=j}if((d|0)==22)return h|0}else{h=0,d=-1,l=0;e:for(;;){for(j=l;M=+G[Y+(j<<4)>>3],V=+G[Y+(j<<4)+8>>3],l=(d+2|0)%(ae|0)|0,S=+G[Y+(l<<4)>>3],b=+G[Y+(l<<4)+8>>3],M>S?(B=M,M=V):(B=S,S=M,M=b,b=V),!!(ne<S|ne>B);)if(d=j+1|0,(d|0)<(ae|0))l=j,j=d,d=l;else{d=22;break e}if(x=M==x|b==x?x+-2220446049250313e-31:x,b+(ne-S)/(B-S)*(M-b)>x&&(h=h^1),l=j+1|0,(l|0)>=(ae|0)){d=22;break}else d=j}if((d|0)==22)return h|0}return 0}function qa(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0;if(be=a[l>>2]|0,!be){a[h>>2]=0,a[h+4>>2]=0,a[h+8>>2]=0,a[h+12>>2]=0,a[h+16>>2]=0,a[h+20>>2]=0,a[h+24>>2]=0,a[h+28>>2]=0;return}if(Ce=h+8|0,G[Ce>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,Ge=h+16|0,G[Ge>>3]=-17976931348623157e292,!((be|0)<=0)){for(ne=a[l+4>>2]|0,j=17976931348623157e292,Y=-17976931348623157e292,ae=0,l=-1,S=17976931348623157e292,M=17976931348623157e292,V=-17976931348623157e292,x=-17976931348623157e292,ue=0;d=+G[ne+(ue<<4)>>3],B=+G[ne+(ue<<4)+8>>3],l=l+2|0,b=+G[ne+(((l|0)==(be|0)?0:l)<<4)+8>>3],d<S&&(G[Ce>>3]=d,S=d),B<M&&(G[ve>>3]=B,M=B),d>V?G[h>>3]=d:d=V,B>x&&(G[Ge>>3]=B,x=B),j=B>0&B<j?B:j,Y=B<0&B>Y?B:Y,ae=ae|+Pe(+(B-b))>3.141592653589793,l=ue+1|0,(l|0)!=(be|0);)Te=ue,V=d,ue=l,l=Te;ae&&(G[Ge>>3]=Y,G[ve>>3]=j)}}function Gs(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,y=0,m=0,v=0;if(be=a[l>>2]|0,be){if(Ce=h+8|0,G[Ce>>3]=17976931348623157e292,ve=h+24|0,G[ve>>3]=17976931348623157e292,G[h>>3]=-17976931348623157e292,Ge=h+16|0,G[Ge>>3]=-17976931348623157e292,(be|0)>0){for(b=a[l+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,x=0,d=-1,V=17976931348623157e292,j=17976931348623157e292,ae=-17976931348623157e292,M=-17976931348623157e292,Te=0;S=+G[b+(Te<<4)>>3],Y=+G[b+(Te<<4)+8>>3],m=d+2|0,B=+G[b+(((m|0)==(be|0)?0:m)<<4)+8>>3],S<V&&(G[Ce>>3]=S,V=S),Y<j&&(G[ve>>3]=Y,j=Y),S>ae?G[h>>3]=S:S=ae,Y>M&&(G[Ge>>3]=Y,M=Y),ne=Y>0&Y<ne?Y:ne,ue=Y<0&Y>ue?Y:ue,x=x|+Pe(+(Y-B))>3.141592653589793,d=Te+1|0,(d|0)!=(be|0);)m=Te,ae=S,Te=d,d=m;x&&(G[Ge>>3]=ue,G[ve>>3]=ne)}}else a[h>>2]=0,a[h+4>>2]=0,a[h+8>>2]=0,a[h+12>>2]=0,a[h+16>>2]=0,a[h+20>>2]=0,a[h+24>>2]=0,a[h+28>>2]=0;if(m=l+8|0,d=a[m>>2]|0,!((d|0)<=0)){y=l+12|0,xe=0;do if(b=a[y>>2]|0,x=xe,xe=xe+1|0,ve=h+(xe<<5)|0,Ge=a[b+(x<<3)>>2]|0,Ge){if(Te=h+(xe<<5)+8|0,G[Te>>3]=17976931348623157e292,l=h+(xe<<5)+24|0,G[l>>3]=17976931348623157e292,G[ve>>3]=-17976931348623157e292,Ve=h+(xe<<5)+16|0,G[Ve>>3]=-17976931348623157e292,(Ge|0)>0){for(be=a[b+(x<<3)+4>>2]|0,ne=17976931348623157e292,ue=-17976931348623157e292,b=0,x=-1,Ce=0,V=17976931348623157e292,j=17976931348623157e292,Y=-17976931348623157e292,M=-17976931348623157e292;S=+G[be+(Ce<<4)>>3],ae=+G[be+(Ce<<4)+8>>3],x=x+2|0,B=+G[be+(((x|0)==(Ge|0)?0:x)<<4)+8>>3],S<V&&(G[Te>>3]=S,V=S),ae<j&&(G[l>>3]=ae,j=ae),S>Y?G[ve>>3]=S:S=Y,ae>M&&(G[Ve>>3]=ae,M=ae),ne=ae>0&ae<ne?ae:ne,ue=ae<0&ae>ue?ae:ue,b=b|+Pe(+(ae-B))>3.141592653589793,x=Ce+1|0,(x|0)!=(Ge|0);)v=Ce,Ce=x,Y=S,x=v;b&&(G[Ve>>3]=ue,G[l>>3]=ne)}}else a[ve>>2]=0,a[ve+4>>2]=0,a[ve+8>>2]=0,a[ve+12>>2]=0,a[ve+16>>2]=0,a[ve+20>>2]=0,a[ve+24>>2]=0,a[ve+28>>2]=0,d=a[m>>2]|0;while((xe|0)<(d|0))}}function au(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0;if(!(_A(l,h,d)|0))return b=0,b|0;if(b=l+8|0,(a[b>>2]|0)<=0)return b=1,b|0;for(x=l+12|0,l=0;;){if(S=l,l=l+1|0,_A((a[x>>2]|0)+(S<<3)|0,h+(l<<5)|0,d)|0){l=0,x=6;break}if((l|0)>=(a[b>>2]|0)){l=1,x=6;break}}return(x|0)==6?l|0:0}function yh(){return 8}function gc(){return 16}function lu(){return 168}function Au(){return 8}function uu(){return 16}function $s(){return 12}function ki(){return 8}function xo(l){l=l|0;var h=0,d=0;return d=+G[l>>3],h=+G[l+8>>3],+ +ke(+(d*d+h*h))}function cu(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0;j=+G[l>>3],V=+G[h>>3]-j,B=+G[l+8>>3],M=+G[h+8>>3]-B,ae=+G[d>>3],S=+G[x>>3]-ae,ne=+G[d+8>>3],Y=+G[x+8>>3]-ne,S=(S*(B-ne)-(j-ae)*Y)/(V*Y-M*S),G[b>>3]=j+V*S,G[b+8>>3]=B+M*S}function ya(l,h){return l=l|0,h=h|0,+G[l>>3]!=+G[h>>3]?(h=0,h|0):(h=+G[l+8>>3]==+G[h+8>>3],h|0)}function Br(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;return b=+G[l>>3]-+G[h>>3],x=+G[l+8>>3]-+G[h+8>>3],d=+G[l+16>>3]-+G[h+16>>3],+(b*b+x*x+d*d)}function Ll(l,h){l=l|0,h=h|0;var d=0,x=0,b=0;d=+G[l>>3],x=+lt(+d),d=+We(+d),G[h+16>>3]=d,d=+G[l+8>>3],b=x*+lt(+d),G[h>>3]=b,d=x*+We(+d),G[h+8>>3]=d}function mc(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0;if(j=De,De=De+32|0,b=j+16|0,S=j,ja(l,h,b),M=as(l,h)|0,V=li(l,h)|0,AA(M,S),h=uA(M,a[b>>2]|0)|0,!(en(M)|0))return V=h,De=j,V|0;do switch(M|0){case 4:{l=0,d=14;break}case 14:{l=1,d=14;break}case 24:{l=2,d=14;break}case 38:{l=3,d=14;break}case 49:{l=4,d=14;break}case 58:{l=5,d=14;break}case 63:{l=6,d=14;break}case 72:{l=7,d=14;break}case 83:{l=8,d=14;break}case 97:{l=9,d=14;break}case 107:{l=10,d=14;break}case 117:{l=11,d=14;break}default:B=0,x=0}while(0);return(d|0)==14&&(B=a[22096+(l*24|0)+8>>2]|0,x=a[22096+(l*24|0)+16>>2]|0),l=a[b>>2]|0,(l|0)!=(a[S>>2]|0)&&(M=Pr(M)|0,l=a[b>>2]|0,M|(l|0)==(x|0)&&(h=(h+1|0)%6|0)),(V|0)==3&(l|0)==(x|0)?(V=(h+5|0)%6|0,De=j,V|0):(V|0)==5&(l|0)==(B|0)?(V=(h+1|0)%6|0,De=j,V|0):(V=h,De=j,V|0)}function cs(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;return x=Ir(l,h)|0,(d+-1|0)>>>0>5||(b=(x|0)!=0,(d|0)==1&b)?(d=-1,d|0):(x=mc(l,h)|0,b?(d=(5-x+(a[22384+(d<<2)>>2]|0)|0)%5|0,d|0):(d=(6-x+(a[22416+(d<<2)>>2]|0)|0)%6|0,d|0))}function br(l,h,d){l=l|0,h=h|0,d=d|0;var x=0;(h|0)>0?(x=Yi(h,4)|0,a[l>>2]=x,x||Ct(23230,23253,40,23267)):a[l>>2]=0,a[l+4>>2]=h,a[l+8>>2]=0,a[l+12>>2]=d}function Za(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0;b=l+4|0,S=l+12|0,M=l+8|0;e:for(;;){for(d=a[b>>2]|0,h=0;;){if((h|0)>=(d|0))break e;if(x=a[l>>2]|0,B=a[x+(h<<2)>>2]|0,!B)h=h+1|0;else break}h=x+(~~(+Pe(+(+qe(10,+ +(15-(a[S>>2]|0)|0))*(+G[B>>3]+ +G[B+8>>3])))%+(d|0))>>>0<<2)|0,d=a[h>>2]|0;t:do if(d|0){if(x=B+32|0,(d|0)==(B|0))a[h>>2]=a[x>>2];else{if(d=d+32|0,h=a[d>>2]|0,!h)break;for(;(h|0)!=(B|0);)if(d=h+32|0,h=a[d>>2]|0,!h)break t;a[d>>2]=a[x>>2]}hn(B),a[M>>2]=(a[M>>2]|0)+-1}while(0)}hn(a[l>>2]|0)}function Dl(l){l=l|0;var h=0,d=0,x=0;for(x=a[l+4>>2]|0,d=0;;){if((d|0)>=(x|0)){h=0,d=4;break}if(h=a[(a[l>>2]|0)+(d<<2)>>2]|0,!h)d=d+1|0;else{d=4;break}}return(d|0)==4?h|0:0}function hu(l,h){l=l|0,h=h|0;var d=0,x=0,b=0,S=0;if(d=~~(+Pe(+(+qe(10,+ +(15-(a[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[l+4>>2]|0))>>>0,d=(a[l>>2]|0)+(d<<2)|0,x=a[d>>2]|0,!x)return S=1,S|0;S=h+32|0;do if((x|0)!=(h|0)){if(d=a[x+32>>2]|0,!d)return S=1,S|0;for(b=d;;){if((b|0)==(h|0)){b=8;break}if(d=a[b+32>>2]|0,d)x=b,b=d;else{d=1,b=10;break}}if((b|0)==8){a[x+32>>2]=a[S>>2];break}else if((b|0)==10)return d|0}else a[d>>2]=a[S>>2];while(0);return hn(h),S=l+8|0,a[S>>2]=(a[S>>2]|0)+-1,S=0,S|0}function yc(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;S=Xt(40)|0,S||Ct(23283,23253,98,23296),a[S>>2]=a[h>>2],a[S+4>>2]=a[h+4>>2],a[S+8>>2]=a[h+8>>2],a[S+12>>2]=a[h+12>>2],b=S+16|0,a[b>>2]=a[d>>2],a[b+4>>2]=a[d+4>>2],a[b+8>>2]=a[d+8>>2],a[b+12>>2]=a[d+12>>2],a[S+32>>2]=0,b=~~(+Pe(+(+qe(10,+ +(15-(a[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[l+4>>2]|0))>>>0,b=(a[l>>2]|0)+(b<<2)|0,x=a[b>>2]|0;do if(!x)a[b>>2]=S;else{for(;!(Fs(x,h)|0&&Fs(x+16|0,d)|0);)if(b=a[x+32>>2]|0,x=b|0?b:x,!(a[x+32>>2]|0)){M=10;break}if((M|0)==10){a[x+32>>2]=S;break}return hn(S),M=x,M|0}while(0);return M=l+8|0,a[M>>2]=(a[M>>2]|0)+1,M=S,M|0}function fu(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0;if(b=~~(+Pe(+(+qe(10,+ +(15-(a[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[l+4>>2]|0))>>>0,b=a[(a[l>>2]|0)+(b<<2)>>2]|0,!b)return d=0,d|0;if(!d){for(l=b;;){if(Fs(l,h)|0){x=10;break}if(l=a[l+32>>2]|0,!l){l=0,x=10;break}}if((x|0)==10)return l|0}for(l=b;;){if(Fs(l,h)|0&&Fs(l+16|0,d)|0){x=10;break}if(l=a[l+32>>2]|0,!l){l=0,x=10;break}}return(x|0)==10?l|0:0}function _c(l,h){l=l|0,h=h|0;var d=0;if(d=~~(+Pe(+(+qe(10,+ +(15-(a[l+12>>2]|0)|0))*(+G[h>>3]+ +G[h+8>>3])))%+(a[l+4>>2]|0))>>>0,l=a[(a[l>>2]|0)+(d<<2)>>2]|0,!l)return d=0,d|0;for(;;){if(Fs(l,h)|0){h=5;break}if(l=a[l+32>>2]|0,!l){l=0,h=5;break}}return(h|0)==5?l|0:0}function pr(){return 23312}function Rl(l){return l=+l,+ +c(+l)}function Yt(l){return l=+l,~~+Rl(l)|0}function Xt(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0,Ce=0,ve=0,Ge=0,Te=0,Ve=0,xe=0,y=0;y=De,De=De+16|0,ne=y;do if(l>>>0<245){if(j=l>>>0<11?16:l+11&-8,l=j>>>3,ae=a[5829]|0,d=ae>>>l,d&3|0)return h=(d&1^1)+l|0,l=23356+(h<<1<<2)|0,d=l+8|0,x=a[d>>2]|0,b=x+8|0,S=a[b>>2]|0,(S|0)==(l|0)?a[5829]=ae&~(1<<h):(a[S+12>>2]=l,a[d>>2]=S),xe=h<<3,a[x+4>>2]=xe|3,xe=x+xe+4|0,a[xe>>2]=a[xe>>2]|1,xe=b,De=y,xe|0;if(Y=a[5831]|0,j>>>0>Y>>>0){if(d|0)return h=2<<l,h=d<<l&(h|0-h),h=(h&0-h)+-1|0,B=h>>>12&16,h=h>>>B,d=h>>>5&8,h=h>>>d,S=h>>>2&4,h=h>>>S,l=h>>>1&2,h=h>>>l,x=h>>>1&1,x=(d|B|S|l|x)+(h>>>x)|0,h=23356+(x<<1<<2)|0,l=h+8|0,S=a[l>>2]|0,B=S+8|0,d=a[B>>2]|0,(d|0)==(h|0)?(l=ae&~(1<<x),a[5829]=l):(a[d+12>>2]=h,a[l>>2]=d,l=ae),xe=x<<3,M=xe-j|0,a[S+4>>2]=j|3,b=S+j|0,a[b+4>>2]=M|1,a[S+xe>>2]=M,Y|0&&(x=a[5834]|0,h=Y>>>3,d=23356+(h<<1<<2)|0,h=1<<h,l&h?(l=d+8|0,h=a[l>>2]|0):(a[5829]=l|h,h=d,l=d+8|0),a[l>>2]=x,a[h+12>>2]=x,a[x+8>>2]=h,a[x+12>>2]=d),a[5831]=M,a[5834]=b,xe=B,De=y,xe|0;if(S=a[5830]|0,S){for(d=(S&0-S)+-1|0,b=d>>>12&16,d=d>>>b,x=d>>>5&8,d=d>>>x,M=d>>>2&4,d=d>>>M,B=d>>>1&2,d=d>>>B,V=d>>>1&1,V=a[23620+((x|b|M|B|V)+(d>>>V)<<2)>>2]|0,d=V,B=V,V=(a[V+4>>2]&-8)-j|0;l=a[d+16>>2]|0,!(!l&&(l=a[d+20>>2]|0,!l));)M=(a[l+4>>2]&-8)-j|0,b=M>>>0<V>>>0,d=l,B=b?l:B,V=b?M:V;if(M=B+j|0,M>>>0>B>>>0){b=a[B+24>>2]|0,h=a[B+12>>2]|0;do if((h|0)==(B|0)){if(l=B+20|0,h=a[l>>2]|0,!h&&(l=B+16|0,h=a[l>>2]|0,!h)){d=0;break}for(;;)if(x=h+20|0,d=a[x>>2]|0,d)h=d,l=x;else if(x=h+16|0,d=a[x>>2]|0,d)h=d,l=x;else break;a[l>>2]=0,d=h}else d=a[B+8>>2]|0,a[d+12>>2]=h,a[h+8>>2]=d,d=h;while(0);do if(b|0){if(h=a[B+28>>2]|0,l=23620+(h<<2)|0,(B|0)==(a[l>>2]|0)){if(a[l>>2]=d,!d){a[5830]=S&~(1<<h);break}}else if(xe=b+16|0,a[((a[xe>>2]|0)==(B|0)?xe:b+20|0)>>2]=d,!d)break;a[d+24>>2]=b,h=a[B+16>>2]|0,h|0&&(a[d+16>>2]=h,a[h+24>>2]=d),h=a[B+20>>2]|0,h|0&&(a[d+20>>2]=h,a[h+24>>2]=d)}while(0);return V>>>0<16?(xe=V+j|0,a[B+4>>2]=xe|3,xe=B+xe+4|0,a[xe>>2]=a[xe>>2]|1):(a[B+4>>2]=j|3,a[M+4>>2]=V|1,a[M+V>>2]=V,Y|0&&(x=a[5834]|0,h=Y>>>3,d=23356+(h<<1<<2)|0,h=1<<h,h&ae?(l=d+8|0,h=a[l>>2]|0):(a[5829]=h|ae,h=d,l=d+8|0),a[l>>2]=x,a[h+12>>2]=x,a[x+8>>2]=h,a[x+12>>2]=d),a[5831]=V,a[5834]=M),xe=B+8|0,De=y,xe|0}else ae=j}else ae=j}else ae=j}else if(l>>>0<=4294967231)if(l=l+11|0,j=l&-8,x=a[5830]|0,x){b=0-j|0,l=l>>>8,l?j>>>0>16777215?V=31:(ae=(l+1048320|0)>>>16&8,Ce=l<<ae,B=(Ce+520192|0)>>>16&4,Ce=Ce<<B,V=(Ce+245760|0)>>>16&2,V=14-(B|ae|V)+(Ce<<V>>>15)|0,V=j>>>(V+7|0)&1|V<<1):V=0,d=a[23620+(V<<2)>>2]|0;e:do if(!d)d=0,l=0,Ce=61;else for(l=0,B=j<<((V|0)==31?0:25-(V>>>1)|0),S=0;;){if(M=(a[d+4>>2]&-8)-j|0,M>>>0<b>>>0)if(M)l=d,b=M;else{l=d,b=0,Ce=65;break e}if(Ce=a[d+20>>2]|0,d=a[d+16+(B>>>31<<2)>>2]|0,S=(Ce|0)==0|(Ce|0)==(d|0)?S:Ce,d)B=B<<1;else{d=S,Ce=61;break}}while(0);if((Ce|0)==61){if((d|0)==0&(l|0)==0){if(l=2<<V,l=(l|0-l)&x,!l){ae=j;break}ae=(l&0-l)+-1|0,M=ae>>>12&16,ae=ae>>>M,S=ae>>>5&8,ae=ae>>>S,B=ae>>>2&4,ae=ae>>>B,V=ae>>>1&2,ae=ae>>>V,d=ae>>>1&1,l=0,d=a[23620+((S|M|B|V|d)+(ae>>>d)<<2)>>2]|0}d?Ce=65:(B=l,M=b)}if((Ce|0)==65)for(S=d;;)if(ae=(a[S+4>>2]&-8)-j|0,d=ae>>>0<b>>>0,b=d?ae:b,l=d?S:l,d=a[S+16>>2]|0,d||(d=a[S+20>>2]|0),d)S=d;else{B=l,M=b;break}if(B|0&&M>>>0<((a[5831]|0)-j|0)>>>0&&(Y=B+j|0,Y>>>0>B>>>0)){S=a[B+24>>2]|0,h=a[B+12>>2]|0;do if((h|0)==(B|0)){if(l=B+20|0,h=a[l>>2]|0,!h&&(l=B+16|0,h=a[l>>2]|0,!h)){h=0;break}for(;;)if(b=h+20|0,d=a[b>>2]|0,d)h=d,l=b;else if(b=h+16|0,d=a[b>>2]|0,d)h=d,l=b;else break;a[l>>2]=0}else xe=a[B+8>>2]|0,a[xe+12>>2]=h,a[h+8>>2]=xe;while(0);do if(S){if(l=a[B+28>>2]|0,d=23620+(l<<2)|0,(B|0)==(a[d>>2]|0)){if(a[d>>2]=h,!h){x=x&~(1<<l),a[5830]=x;break}}else if(xe=S+16|0,a[((a[xe>>2]|0)==(B|0)?xe:S+20|0)>>2]=h,!h)break;a[h+24>>2]=S,l=a[B+16>>2]|0,l|0&&(a[h+16>>2]=l,a[l+24>>2]=h),l=a[B+20>>2]|0,l&&(a[h+20>>2]=l,a[l+24>>2]=h)}while(0);e:do if(M>>>0<16)xe=M+j|0,a[B+4>>2]=xe|3,xe=B+xe+4|0,a[xe>>2]=a[xe>>2]|1;else{if(a[B+4>>2]=j|3,a[Y+4>>2]=M|1,a[Y+M>>2]=M,h=M>>>3,M>>>0<256){d=23356+(h<<1<<2)|0,l=a[5829]|0,h=1<<h,l&h?(l=d+8|0,h=a[l>>2]|0):(a[5829]=l|h,h=d,l=d+8|0),a[l>>2]=Y,a[h+12>>2]=Y,a[Y+8>>2]=h,a[Y+12>>2]=d;break}if(h=M>>>8,h?M>>>0>16777215?d=31:(Ve=(h+1048320|0)>>>16&8,xe=h<<Ve,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,d=(xe+245760|0)>>>16&2,d=14-(Te|Ve|d)+(xe<<d>>>15)|0,d=M>>>(d+7|0)&1|d<<1):d=0,h=23620+(d<<2)|0,a[Y+28>>2]=d,l=Y+16|0,a[l+4>>2]=0,a[l>>2]=0,l=1<<d,!(x&l)){a[5830]=x|l,a[h>>2]=Y,a[Y+24>>2]=h,a[Y+12>>2]=Y,a[Y+8>>2]=Y;break}h=a[h>>2]|0;t:do if((a[h+4>>2]&-8|0)!=(M|0)){for(x=M<<((d|0)==31?0:25-(d>>>1)|0);d=h+16+(x>>>31<<2)|0,l=a[d>>2]|0,!!l;)if((a[l+4>>2]&-8|0)==(M|0)){h=l;break t}else x=x<<1,h=l;a[d>>2]=Y,a[Y+24>>2]=h,a[Y+12>>2]=Y,a[Y+8>>2]=Y;break e}while(0);Ve=h+8|0,xe=a[Ve>>2]|0,a[xe+12>>2]=Y,a[Ve>>2]=Y,a[Y+8>>2]=xe,a[Y+12>>2]=h,a[Y+24>>2]=0}while(0);return xe=B+8|0,De=y,xe|0}else ae=j}else ae=j;else ae=-1;while(0);if(d=a[5831]|0,d>>>0>=ae>>>0)return h=d-ae|0,l=a[5834]|0,h>>>0>15?(xe=l+ae|0,a[5834]=xe,a[5831]=h,a[xe+4>>2]=h|1,a[l+d>>2]=h,a[l+4>>2]=ae|3):(a[5831]=0,a[5834]=0,a[l+4>>2]=d|3,xe=l+d+4|0,a[xe>>2]=a[xe>>2]|1),xe=l+8|0,De=y,xe|0;if(M=a[5832]|0,M>>>0>ae>>>0)return Te=M-ae|0,a[5832]=Te,xe=a[5835]|0,Ve=xe+ae|0,a[5835]=Ve,a[Ve+4>>2]=Te|1,a[xe+4>>2]=ae|3,xe=xe+8|0,De=y,xe|0;if(a[5947]|0?l=a[5949]|0:(a[5949]=4096,a[5948]=4096,a[5950]=-1,a[5951]=-1,a[5952]=0,a[5940]=0,a[5947]=ne&-16^1431655768,l=4096),B=ae+48|0,V=ae+47|0,S=l+V|0,b=0-l|0,j=S&b,j>>>0<=ae>>>0||(l=a[5939]|0,l|0&&(Y=a[5937]|0,ne=Y+j|0,ne>>>0<=Y>>>0|ne>>>0>l>>>0)))return xe=0,De=y,xe|0;e:do if(a[5940]&4)h=0,Ce=143;else{d=a[5835]|0;t:do if(d){for(x=23764;ne=a[x>>2]|0,!(ne>>>0<=d>>>0&&(ne+(a[x+4>>2]|0)|0)>>>0>d>>>0);)if(l=a[x+8>>2]|0,l)x=l;else{Ce=128;break t}if(h=S-M&b,h>>>0<2147483647)if(l=_(h|0)|0,(l|0)==((a[x>>2]|0)+(a[x+4>>2]|0)|0)){if((l|0)!=-1){M=h,S=l,Ce=145;break e}}else x=l,Ce=136;else h=0}else Ce=128;while(0);do if((Ce|0)==128)if(d=_(0)|0,(d|0)!=-1&&(h=d,ue=a[5948]|0,be=ue+-1|0,h=(be&h|0?(be+h&0-ue)-h|0:0)+j|0,ue=a[5937]|0,be=h+ue|0,h>>>0>ae>>>0&h>>>0<2147483647)){if(ne=a[5939]|0,ne|0&&be>>>0<=ue>>>0|be>>>0>ne>>>0){h=0;break}if(l=_(h|0)|0,(l|0)==(d|0)){M=h,S=d,Ce=145;break e}else x=l,Ce=136}else h=0;while(0);do if((Ce|0)==136){if(d=0-h|0,!(B>>>0>h>>>0&(h>>>0<2147483647&(x|0)!=-1)))if((x|0)==-1){h=0;break}else{M=h,S=x,Ce=145;break e}if(l=a[5949]|0,l=V-h+l&0-l,l>>>0>=2147483647){M=h,S=x,Ce=145;break e}if((_(l|0)|0)==-1){_(d|0)|0,h=0;break}else{M=l+h|0,S=x,Ce=145;break e}}while(0);a[5940]=a[5940]|4,Ce=143}while(0);if((Ce|0)==143&&j>>>0<2147483647&&(Te=_(j|0)|0,be=_(0)|0,ve=be-Te|0,Ge=ve>>>0>(ae+40|0)>>>0,!((Te|0)==-1|Ge^1|Te>>>0<be>>>0&((Te|0)!=-1&(be|0)!=-1)^1))&&(M=Ge?ve:h,S=Te,Ce=145),(Ce|0)==145){h=(a[5937]|0)+M|0,a[5937]=h,h>>>0>(a[5938]|0)>>>0&&(a[5938]=h),V=a[5835]|0;e:do if(V){for(h=23764;;){if(l=a[h>>2]|0,d=a[h+4>>2]|0,(S|0)==(l+d|0)){Ce=154;break}if(x=a[h+8>>2]|0,x)h=x;else break}if((Ce|0)==154&&(Ve=h+4|0,(a[h+12>>2]&8|0)==0)&&S>>>0>V>>>0&l>>>0<=V>>>0){a[Ve>>2]=d+M,xe=(a[5832]|0)+M|0,Te=V+8|0,Te=Te&7|0?0-Te&7:0,Ve=V+Te|0,Te=xe-Te|0,a[5835]=Ve,a[5832]=Te,a[Ve+4>>2]=Te|1,a[V+xe+4>>2]=40,a[5836]=a[5951];break}for(S>>>0<(a[5833]|0)>>>0&&(a[5833]=S),d=S+M|0,h=23764;;){if((a[h>>2]|0)==(d|0)){Ce=162;break}if(l=a[h+8>>2]|0,l)h=l;else break}if((Ce|0)==162&&!(a[h+12>>2]&8|0)){a[h>>2]=S,Y=h+4|0,a[Y>>2]=(a[Y>>2]|0)+M,Y=S+8|0,Y=S+(Y&7|0?0-Y&7:0)|0,h=d+8|0,h=d+(h&7|0?0-h&7:0)|0,j=Y+ae|0,B=h-Y-ae|0,a[Y+4>>2]=ae|3;t:do if((V|0)==(h|0))xe=(a[5832]|0)+B|0,a[5832]=xe,a[5835]=j,a[j+4>>2]=xe|1;else{if((a[5834]|0)==(h|0)){xe=(a[5831]|0)+B|0,a[5831]=xe,a[5834]=j,a[j+4>>2]=xe|1,a[j+xe>>2]=xe;break}if(l=a[h+4>>2]|0,(l&3|0)==1){M=l&-8,x=l>>>3;n:do if(l>>>0<256)if(l=a[h+8>>2]|0,d=a[h+12>>2]|0,(d|0)==(l|0)){a[5829]=a[5829]&~(1<<x);break}else{a[l+12>>2]=d,a[d+8>>2]=l;break}else{S=a[h+24>>2]|0,l=a[h+12>>2]|0;do if((l|0)==(h|0)){if(d=h+16|0,x=d+4|0,l=a[x>>2]|0,l)d=x;else if(l=a[d>>2]|0,!l){l=0;break}for(;;)if(b=l+20|0,x=a[b>>2]|0,x)l=x,d=b;else if(b=l+16|0,x=a[b>>2]|0,x)l=x,d=b;else break;a[d>>2]=0}else xe=a[h+8>>2]|0,a[xe+12>>2]=l,a[l+8>>2]=xe;while(0);if(!S)break;d=a[h+28>>2]|0,x=23620+(d<<2)|0;do if((a[x>>2]|0)!=(h|0)){if(xe=S+16|0,a[((a[xe>>2]|0)==(h|0)?xe:S+20|0)>>2]=l,!l)break n}else{if(a[x>>2]=l,l|0)break;a[5830]=a[5830]&~(1<<d);break n}while(0);if(a[l+24>>2]=S,d=h+16|0,x=a[d>>2]|0,x|0&&(a[l+16>>2]=x,a[x+24>>2]=l),d=a[d+4>>2]|0,!d)break;a[l+20>>2]=d,a[d+24>>2]=l}while(0);h=h+M|0,b=M+B|0}else b=B;if(h=h+4|0,a[h>>2]=a[h>>2]&-2,a[j+4>>2]=b|1,a[j+b>>2]=b,h=b>>>3,b>>>0<256){d=23356+(h<<1<<2)|0,l=a[5829]|0,h=1<<h,l&h?(l=d+8|0,h=a[l>>2]|0):(a[5829]=l|h,h=d,l=d+8|0),a[l>>2]=j,a[h+12>>2]=j,a[j+8>>2]=h,a[j+12>>2]=d;break}h=b>>>8;do if(!h)x=0;else{if(b>>>0>16777215){x=31;break}Ve=(h+1048320|0)>>>16&8,xe=h<<Ve,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,x=(xe+245760|0)>>>16&2,x=14-(Te|Ve|x)+(xe<<x>>>15)|0,x=b>>>(x+7|0)&1|x<<1}while(0);if(h=23620+(x<<2)|0,a[j+28>>2]=x,l=j+16|0,a[l+4>>2]=0,a[l>>2]=0,l=a[5830]|0,d=1<<x,!(l&d)){a[5830]=l|d,a[h>>2]=j,a[j+24>>2]=h,a[j+12>>2]=j,a[j+8>>2]=j;break}h=a[h>>2]|0;n:do if((a[h+4>>2]&-8|0)!=(b|0)){for(x=b<<((x|0)==31?0:25-(x>>>1)|0);d=h+16+(x>>>31<<2)|0,l=a[d>>2]|0,!!l;)if((a[l+4>>2]&-8|0)==(b|0)){h=l;break n}else x=x<<1,h=l;a[d>>2]=j,a[j+24>>2]=h,a[j+12>>2]=j,a[j+8>>2]=j;break t}while(0);Ve=h+8|0,xe=a[Ve>>2]|0,a[xe+12>>2]=j,a[Ve>>2]=j,a[j+8>>2]=xe,a[j+12>>2]=h,a[j+24>>2]=0}while(0);return xe=Y+8|0,De=y,xe|0}for(h=23764;l=a[h>>2]|0,!(l>>>0<=V>>>0&&(xe=l+(a[h+4>>2]|0)|0,xe>>>0>V>>>0));)h=a[h+8>>2]|0;b=xe+-47|0,l=b+8|0,l=b+(l&7|0?0-l&7:0)|0,b=V+16|0,l=l>>>0<b>>>0?V:l,h=l+8|0,d=M+-40|0,Te=S+8|0,Te=Te&7|0?0-Te&7:0,Ve=S+Te|0,Te=d-Te|0,a[5835]=Ve,a[5832]=Te,a[Ve+4>>2]=Te|1,a[S+d+4>>2]=40,a[5836]=a[5951],d=l+4|0,a[d>>2]=27,a[h>>2]=a[5941],a[h+4>>2]=a[5942],a[h+8>>2]=a[5943],a[h+12>>2]=a[5944],a[5941]=S,a[5942]=M,a[5944]=0,a[5943]=h,h=l+24|0;do Ve=h,h=h+4|0,a[h>>2]=7;while((Ve+8|0)>>>0<xe>>>0);if((l|0)!=(V|0)){if(S=l-V|0,a[d>>2]=a[d>>2]&-2,a[V+4>>2]=S|1,a[l>>2]=S,h=S>>>3,S>>>0<256){d=23356+(h<<1<<2)|0,l=a[5829]|0,h=1<<h,l&h?(l=d+8|0,h=a[l>>2]|0):(a[5829]=l|h,h=d,l=d+8|0),a[l>>2]=V,a[h+12>>2]=V,a[V+8>>2]=h,a[V+12>>2]=d;break}if(h=S>>>8,h?S>>>0>16777215?x=31:(Ve=(h+1048320|0)>>>16&8,xe=h<<Ve,Te=(xe+520192|0)>>>16&4,xe=xe<<Te,x=(xe+245760|0)>>>16&2,x=14-(Te|Ve|x)+(xe<<x>>>15)|0,x=S>>>(x+7|0)&1|x<<1):x=0,d=23620+(x<<2)|0,a[V+28>>2]=x,a[V+20>>2]=0,a[b>>2]=0,h=a[5830]|0,l=1<<x,!(h&l)){a[5830]=h|l,a[d>>2]=V,a[V+24>>2]=d,a[V+12>>2]=V,a[V+8>>2]=V;break}h=a[d>>2]|0;t:do if((a[h+4>>2]&-8|0)!=(S|0)){for(x=S<<((x|0)==31?0:25-(x>>>1)|0);d=h+16+(x>>>31<<2)|0,l=a[d>>2]|0,!!l;)if((a[l+4>>2]&-8|0)==(S|0)){h=l;break t}else x=x<<1,h=l;a[d>>2]=V,a[V+24>>2]=h,a[V+12>>2]=V,a[V+8>>2]=V;break e}while(0);Ve=h+8|0,xe=a[Ve>>2]|0,a[xe+12>>2]=V,a[Ve>>2]=V,a[V+8>>2]=xe,a[V+12>>2]=h,a[V+24>>2]=0}}else xe=a[5833]|0,(xe|0)==0|S>>>0<xe>>>0&&(a[5833]=S),a[5941]=S,a[5942]=M,a[5944]=0,a[5838]=a[5947],a[5837]=-1,a[5842]=23356,a[5841]=23356,a[5844]=23364,a[5843]=23364,a[5846]=23372,a[5845]=23372,a[5848]=23380,a[5847]=23380,a[5850]=23388,a[5849]=23388,a[5852]=23396,a[5851]=23396,a[5854]=23404,a[5853]=23404,a[5856]=23412,a[5855]=23412,a[5858]=23420,a[5857]=23420,a[5860]=23428,a[5859]=23428,a[5862]=23436,a[5861]=23436,a[5864]=23444,a[5863]=23444,a[5866]=23452,a[5865]=23452,a[5868]=23460,a[5867]=23460,a[5870]=23468,a[5869]=23468,a[5872]=23476,a[5871]=23476,a[5874]=23484,a[5873]=23484,a[5876]=23492,a[5875]=23492,a[5878]=23500,a[5877]=23500,a[5880]=23508,a[5879]=23508,a[5882]=23516,a[5881]=23516,a[5884]=23524,a[5883]=23524,a[5886]=23532,a[5885]=23532,a[5888]=23540,a[5887]=23540,a[5890]=23548,a[5889]=23548,a[5892]=23556,a[5891]=23556,a[5894]=23564,a[5893]=23564,a[5896]=23572,a[5895]=23572,a[5898]=23580,a[5897]=23580,a[5900]=23588,a[5899]=23588,a[5902]=23596,a[5901]=23596,a[5904]=23604,a[5903]=23604,xe=M+-40|0,Te=S+8|0,Te=Te&7|0?0-Te&7:0,Ve=S+Te|0,Te=xe-Te|0,a[5835]=Ve,a[5832]=Te,a[Ve+4>>2]=Te|1,a[S+xe+4>>2]=40,a[5836]=a[5951];while(0);if(h=a[5832]|0,h>>>0>ae>>>0)return Te=h-ae|0,a[5832]=Te,xe=a[5835]|0,Ve=xe+ae|0,a[5835]=Ve,a[Ve+4>>2]=Te|1,a[xe+4>>2]=ae|3,xe=xe+8|0,De=y,xe|0}return xe=pr()|0,a[xe>>2]=12,xe=0,De=y,xe|0}function hn(l){l=l|0;var h=0,d=0,x=0,b=0,S=0,M=0,B=0,V=0;if(l){d=l+-8|0,b=a[5833]|0,l=a[l+-4>>2]|0,h=l&-8,V=d+h|0;do if(l&1)B=d,M=d;else{if(x=a[d>>2]|0,!(l&3)||(M=d+(0-x)|0,S=x+h|0,M>>>0<b>>>0))return;if((a[5834]|0)==(M|0)){if(l=V+4|0,h=a[l>>2]|0,(h&3|0)!=3){B=M,h=S;break}a[5831]=S,a[l>>2]=h&-2,a[M+4>>2]=S|1,a[M+S>>2]=S;return}if(d=x>>>3,x>>>0<256)if(l=a[M+8>>2]|0,h=a[M+12>>2]|0,(h|0)==(l|0)){a[5829]=a[5829]&~(1<<d),B=M,h=S;break}else{a[l+12>>2]=h,a[h+8>>2]=l,B=M,h=S;break}b=a[M+24>>2]|0,l=a[M+12>>2]|0;do if((l|0)==(M|0)){if(h=M+16|0,d=h+4|0,l=a[d>>2]|0,l)h=d;else if(l=a[h>>2]|0,!l){l=0;break}for(;;)if(x=l+20|0,d=a[x>>2]|0,d)l=d,h=x;else if(x=l+16|0,d=a[x>>2]|0,d)l=d,h=x;else break;a[h>>2]=0}else B=a[M+8>>2]|0,a[B+12>>2]=l,a[l+8>>2]=B;while(0);if(b){if(h=a[M+28>>2]|0,d=23620+(h<<2)|0,(a[d>>2]|0)==(M|0)){if(a[d>>2]=l,!l){a[5830]=a[5830]&~(1<<h),B=M,h=S;break}}else if(B=b+16|0,a[((a[B>>2]|0)==(M|0)?B:b+20|0)>>2]=l,!l){B=M,h=S;break}a[l+24>>2]=b,h=M+16|0,d=a[h>>2]|0,d|0&&(a[l+16>>2]=d,a[d+24>>2]=l),h=a[h+4>>2]|0,h?(a[l+20>>2]=h,a[h+24>>2]=l,B=M,h=S):(B=M,h=S)}else B=M,h=S}while(0);if(!(M>>>0>=V>>>0)&&(l=V+4|0,x=a[l>>2]|0,!!(x&1))){if(x&2)a[l>>2]=x&-2,a[B+4>>2]=h|1,a[M+h>>2]=h,b=h;else{if((a[5835]|0)==(V|0)){if(V=(a[5832]|0)+h|0,a[5832]=V,a[5835]=B,a[B+4>>2]=V|1,(B|0)!=(a[5834]|0))return;a[5834]=0,a[5831]=0;return}if((a[5834]|0)==(V|0)){V=(a[5831]|0)+h|0,a[5831]=V,a[5834]=M,a[B+4>>2]=V|1,a[M+V>>2]=V;return}b=(x&-8)+h|0,d=x>>>3;do if(x>>>0<256)if(h=a[V+8>>2]|0,l=a[V+12>>2]|0,(l|0)==(h|0)){a[5829]=a[5829]&~(1<<d);break}else{a[h+12>>2]=l,a[l+8>>2]=h;break}else{S=a[V+24>>2]|0,l=a[V+12>>2]|0;do if((l|0)==(V|0)){if(h=V+16|0,d=h+4|0,l=a[d>>2]|0,l)h=d;else if(l=a[h>>2]|0,!l){d=0;break}for(;;)if(x=l+20|0,d=a[x>>2]|0,d)l=d,h=x;else if(x=l+16|0,d=a[x>>2]|0,d)l=d,h=x;else break;a[h>>2]=0,d=l}else d=a[V+8>>2]|0,a[d+12>>2]=l,a[l+8>>2]=d,d=l;while(0);if(S|0){if(l=a[V+28>>2]|0,h=23620+(l<<2)|0,(a[h>>2]|0)==(V|0)){if(a[h>>2]=d,!d){a[5830]=a[5830]&~(1<<l);break}}else if(x=S+16|0,a[((a[x>>2]|0)==(V|0)?x:S+20|0)>>2]=d,!d)break;a[d+24>>2]=S,l=V+16|0,h=a[l>>2]|0,h|0&&(a[d+16>>2]=h,a[h+24>>2]=d),l=a[l+4>>2]|0,l|0&&(a[d+20>>2]=l,a[l+24>>2]=d)}}while(0);if(a[B+4>>2]=b|1,a[M+b>>2]=b,(B|0)==(a[5834]|0)){a[5831]=b;return}}if(l=b>>>3,b>>>0<256){d=23356+(l<<1<<2)|0,h=a[5829]|0,l=1<<l,h&l?(h=d+8|0,l=a[h>>2]|0):(a[5829]=h|l,l=d,h=d+8|0),a[h>>2]=B,a[l+12>>2]=B,a[B+8>>2]=l,a[B+12>>2]=d;return}l=b>>>8,l?b>>>0>16777215?x=31:(M=(l+1048320|0)>>>16&8,V=l<<M,S=(V+520192|0)>>>16&4,V=V<<S,x=(V+245760|0)>>>16&2,x=14-(S|M|x)+(V<<x>>>15)|0,x=b>>>(x+7|0)&1|x<<1):x=0,l=23620+(x<<2)|0,a[B+28>>2]=x,a[B+20>>2]=0,a[B+16>>2]=0,h=a[5830]|0,d=1<<x;e:do if(!(h&d))a[5830]=h|d,a[l>>2]=B,a[B+24>>2]=l,a[B+12>>2]=B,a[B+8>>2]=B;else{l=a[l>>2]|0;t:do if((a[l+4>>2]&-8|0)!=(b|0)){for(x=b<<((x|0)==31?0:25-(x>>>1)|0);d=l+16+(x>>>31<<2)|0,h=a[d>>2]|0,!!h;)if((a[h+4>>2]&-8|0)==(b|0)){l=h;break t}else x=x<<1,l=h;a[d>>2]=B,a[B+24>>2]=l,a[B+12>>2]=B,a[B+8>>2]=B;break e}while(0);M=l+8|0,V=a[M>>2]|0,a[V+12>>2]=B,a[M>>2]=B,a[B+8>>2]=V,a[B+12>>2]=l,a[B+24>>2]=0}while(0);if(V=(a[5837]|0)+-1|0,a[5837]=V,!(V|0)){for(l=23772;l=a[l>>2]|0,l;)l=l+8|0;a[5837]=-1}}}}function Yi(l,h){l=l|0,h=h|0;var d=0;return l?(d=qt(h,l)|0,(h|l)>>>0>65535&&(d=((d>>>0)/(l>>>0)|0|0)==(h|0)?d:-1)):d=0,l=Xt(d)|0,!l||!(a[l+-4>>2]&3)||L(l|0,0,d|0)|0,l|0}function Qo(l,h,d,x){return l=l|0,h=h|0,d=d|0,x=x|0,d=l+d>>>0,Ft(h+x+(d>>>0<l>>>0|0)>>>0|0),d|0|0}function Nr(l,h,d,x){return l=l|0,h=h|0,d=d|0,x=x|0,x=h-x-(d>>>0>l>>>0|0)>>>0,Ft(x|0),l-d>>>0|0|0}function js(l){return l=l|0,(l?31-(xn(l^l-1)|0)|0:32)|0}function Ts(l,h,d,x,b){l=l|0,h=h|0,d=d|0,x=x|0,b=b|0;var S=0,M=0,B=0,V=0,j=0,Y=0,ae=0,ne=0,ue=0,be=0;if(Y=l,V=h,j=V,M=d,ne=x,B=ne,!j)return S=(b|0)!=0,B?S?(a[b>>2]=l|0,a[b+4>>2]=h&0,ne=0,b=0,Ft(ne|0),b|0):(ne=0,b=0,Ft(ne|0),b|0):(S&&(a[b>>2]=(Y>>>0)%(M>>>0),a[b+4>>2]=0),ne=0,b=(Y>>>0)/(M>>>0)>>>0,Ft(ne|0),b|0);S=(B|0)==0;do if(M){if(!S){if(S=(xn(B|0)|0)-(xn(j|0)|0)|0,S>>>0<=31){ae=S+1|0,B=31-S|0,h=S-31>>31,M=ae,l=Y>>>(ae>>>0)&h|j<<B,h=j>>>(ae>>>0)&h,S=0,B=Y<<B;break}return b?(a[b>>2]=l|0,a[b+4>>2]=V|h&0,ne=0,b=0,Ft(ne|0),b|0):(ne=0,b=0,Ft(ne|0),b|0)}if(S=M-1|0,S&M|0){B=(xn(M|0)|0)+33-(xn(j|0)|0)|0,be=64-B|0,ae=32-B|0,V=ae>>31,ue=B-32|0,h=ue>>31,M=B,l=ae-1>>31&j>>>(ue>>>0)|(j<<ae|Y>>>(B>>>0))&h,h=h&j>>>(B>>>0),S=Y<<be&V,B=(j<<be|Y>>>(ue>>>0))&V|Y<<ae&B-33>>31;break}return b|0&&(a[b>>2]=S&Y,a[b+4>>2]=0),(M|0)==1?(ue=V|h&0,be=l|0|0,Ft(ue|0),be|0):(be=js(M|0)|0,ue=j>>>(be>>>0)|0,be=j<<32-be|Y>>>(be>>>0)|0,Ft(ue|0),be|0)}else{if(S)return b|0&&(a[b>>2]=(j>>>0)%(M>>>0),a[b+4>>2]=0),ue=0,be=(j>>>0)/(M>>>0)>>>0,Ft(ue|0),be|0;if(!Y)return b|0&&(a[b>>2]=0,a[b+4>>2]=(j>>>0)%(B>>>0)),ue=0,be=(j>>>0)/(B>>>0)>>>0,Ft(ue|0),be|0;if(S=B-1|0,!(S&B))return b|0&&(a[b>>2]=l|0,a[b+4>>2]=S&j|h&0),ue=0,be=j>>>((js(B|0)|0)>>>0),Ft(ue|0),be|0;if(S=(xn(B|0)|0)-(xn(j|0)|0)|0,S>>>0<=30){h=S+1|0,B=31-S|0,M=h,l=j<<B|Y>>>(h>>>0),h=j>>>(h>>>0),S=0,B=Y<<B;break}return b?(a[b>>2]=l|0,a[b+4>>2]=V|h&0,ue=0,be=0,Ft(ue|0),be|0):(ue=0,be=0,Ft(ue|0),be|0)}while(0);if(!M)j=B,V=0,B=0;else{ae=d|0|0,Y=ne|x&0,j=Qo(ae|0,Y|0,-1,-1)|0,d=Oe()|0,V=B,B=0;do x=V,V=S>>>31|V<<1,S=B|S<<1,x=l<<1|x>>>31|0,ne=l>>>31|h<<1|0,Nr(j|0,d|0,x|0,ne|0)|0,be=Oe()|0,ue=be>>31|((be|0)<0?-1:0)<<1,B=ue&1,l=Nr(x|0,ne|0,ue&ae|0,(((be|0)<0?-1:0)>>31|((be|0)<0?-1:0)<<1)&Y|0)|0,h=Oe()|0,M=M-1|0;while(M|0);j=V,V=0}return M=0,b|0&&(a[b>>2]=l,a[b+4>>2]=h),ue=(S|0)>>>31|(j|M)<<1|(M<<1|S>>>31)&0|V,be=(S<<1|0)&-2|B,Ft(ue|0),be|0}function Hs(l,h,d,x){l=l|0,h=h|0,d=d|0,x=x|0;var b=0,S=0;return S=De,De=De+16|0,b=S|0,Ts(l,h,d,x,b)|0,De=S,Ft(a[b+4>>2]|0),a[b>>2]|0|0}function Mt(l,h,d){return l=l|0,h=h|0,d=d|0,(d|0)<32?(Ft(h>>>d|0),l>>>d|(h&(1<<d)-1)<<32-d):(Ft(0),h>>>d-32|0)}function Pt(l,h,d){return l=l|0,h=h|0,d=d|0,(d|0)<32?(Ft(h<<d|(l&(1<<d)-1<<32-d)>>>32-d|0),l<<d):(Ft(l<<d-32|0),0)}function Ur(l,h){return l=+l,h=+h,l!=l?+h:h!=h?+l:+an(+l,+h)}function Ya(l){return l=+l,l>=0?+Ie(l+.5):+pn(l-.5)}function Ws(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0;if((d|0)>=8192)return ai(l|0,h|0,d|0)|0,l|0;if(S=l|0,b=l+d|0,(l&3)==(h&3)){for(;l&3;){if(!d)return S|0;he[l>>0]=he[h>>0]|0,l=l+1|0,h=h+1|0,d=d-1|0}for(d=b&-4|0,x=d-64|0;(l|0)<=(x|0);)a[l>>2]=a[h>>2],a[l+4>>2]=a[h+4>>2],a[l+8>>2]=a[h+8>>2],a[l+12>>2]=a[h+12>>2],a[l+16>>2]=a[h+16>>2],a[l+20>>2]=a[h+20>>2],a[l+24>>2]=a[h+24>>2],a[l+28>>2]=a[h+28>>2],a[l+32>>2]=a[h+32>>2],a[l+36>>2]=a[h+36>>2],a[l+40>>2]=a[h+40>>2],a[l+44>>2]=a[h+44>>2],a[l+48>>2]=a[h+48>>2],a[l+52>>2]=a[h+52>>2],a[l+56>>2]=a[h+56>>2],a[l+60>>2]=a[h+60>>2],l=l+64|0,h=h+64|0;for(;(l|0)<(d|0);)a[l>>2]=a[h>>2],l=l+4|0,h=h+4|0}else for(d=b-4|0;(l|0)<(d|0);)he[l>>0]=he[h>>0]|0,he[l+1>>0]=he[h+1>>0]|0,he[l+2>>0]=he[h+2>>0]|0,he[l+3>>0]=he[h+3>>0]|0,l=l+4|0,h=h+4|0;for(;(l|0)<(b|0);)he[l>>0]=he[h>>0]|0,l=l+1|0,h=h+1|0;return S|0}function L(l,h,d){l=l|0,h=h|0,d=d|0;var x=0,b=0,S=0,M=0;if(S=l+d|0,h=h&255,(d|0)>=67){for(;l&3;)he[l>>0]=h,l=l+1|0;for(x=S&-4|0,M=h|h<<8|h<<16|h<<24,b=x-64|0;(l|0)<=(b|0);)a[l>>2]=M,a[l+4>>2]=M,a[l+8>>2]=M,a[l+12>>2]=M,a[l+16>>2]=M,a[l+20>>2]=M,a[l+24>>2]=M,a[l+28>>2]=M,a[l+32>>2]=M,a[l+36>>2]=M,a[l+40>>2]=M,a[l+44>>2]=M,a[l+48>>2]=M,a[l+52>>2]=M,a[l+56>>2]=M,a[l+60>>2]=M,l=l+64|0;for(;(l|0)<(x|0);)a[l>>2]=M,l=l+4|0}for(;(l|0)<(S|0);)he[l>>0]=h,l=l+1|0;return S-d|0}function c(l){return l=+l,l>=0?+Ie(l+.5):+pn(l-.5)}function _(l){l=l|0;var h=0,d=0,x=0;return x=un()|0,d=a[Le>>2]|0,h=d+l|0,(l|0)>0&(h|0)<(d|0)|(h|0)<0?(aa(h|0)|0,Me(12),-1):(h|0)>(x|0)&&!(nr(h|0)|0)?(Me(12),-1):(a[Le>>2]=h,d|0)}return{___uremdi3:Hs,_bitshift64Lshr:Mt,_bitshift64Shl:Pt,_calloc:Yi,_cellAreaKm2:Ga,_cellAreaM2:fa,_cellAreaRads2:El,_compact:iu,_destroyLinkedPolygon:Qa,_edgeLengthKm:Va,_edgeLengthM:cc,_emscripten_replace_memory:za,_exactEdgeLengthKm:Sl,_exactEdgeLengthM:dr,_exactEdgeLengthRads:Tl,_experimentalH3ToLocalIj:ma,_experimentalLocalIjToH3:Wo,_free:hn,_geoToH3:$a,_getDestinationH3IndexFromUnidirectionalEdge:Ho,_getH3IndexesFromUnidirectionalEdge:vo,_getH3UnidirectionalEdge:Zi,_getH3UnidirectionalEdgeBoundary:Wa,_getH3UnidirectionalEdgesFromHexagon:Il,_getOriginH3IndexFromUnidirectionalEdge:Pl,_getPentagonIndexes:ni,_getRes0Indexes:yl,_h3Distance:ou,_h3GetBaseCell:as,_h3GetFaces:pa,_h3GetResolution:gA,_h3IndexesAreNeighbors:Es,_h3IsPentagon:Ir,_h3IsResClassIII:mA,_h3IsValid:ru,_h3Line:yA,_h3LineSize:Vt,_h3SetToLinkedGeo:Mr,_h3ToCenterChild:ti,_h3ToChildren:Wr,_h3ToGeo:Vs,_h3ToGeoBoundary:As,_h3ToParent:Ml,_h3UnidirectionalEdgeIsValid:pc,_hexAreaKm2:jo,_hexAreaM2:uc,_hexRing:Ee,_i64Subtract:Nr,_kRing:la,_kRingDistances:gl,_llvm_minnum_f64:Ur,_llvm_round_f64:Ya,_malloc:Xt,_maxFaceCount:dc,_maxH3ToChildrenSize:hc,_maxKringSize:Fa,_maxPolyfillSize:Fe,_maxUncompactSize:fc,_memcpy:Ws,_memset:L,_numHexagons:nu,_pentagonIndexCount:Ha,_pointDistKm:Qn,_pointDistM:_r,_pointDistRads:$n,_polyfill:at,_res0IndexCount:ml,_round:c,_sbrk:_,_sizeOfCoordIJ:ki,_sizeOfGeoBoundary:lu,_sizeOfGeoCoord:gc,_sizeOfGeoPolygon:uu,_sizeOfGeofence:Au,_sizeOfH3Index:yh,_sizeOfLinkedGeoPolygon:$s,_uncompact:Us,establishStackSpace:Oa,stackAlloc:we,stackRestore:ws,stackSave:Fo}}(xs,yn,Ne);e.___uremdi3=Ye.___uremdi3,e._bitshift64Lshr=Ye._bitshift64Lshr,e._bitshift64Shl=Ye._bitshift64Shl,e._calloc=Ye._calloc,e._cellAreaKm2=Ye._cellAreaKm2,e._cellAreaM2=Ye._cellAreaM2,e._cellAreaRads2=Ye._cellAreaRads2,e._compact=Ye._compact,e._destroyLinkedPolygon=Ye._destroyLinkedPolygon,e._edgeLengthKm=Ye._edgeLengthKm,e._edgeLengthM=Ye._edgeLengthM;var jr=e._emscripten_replace_memory=Ye._emscripten_replace_memory;e._exactEdgeLengthKm=Ye._exactEdgeLengthKm,e._exactEdgeLengthM=Ye._exactEdgeLengthM,e._exactEdgeLengthRads=Ye._exactEdgeLengthRads,e._experimentalH3ToLocalIj=Ye._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=Ye._experimentalLocalIjToH3,e._free=Ye._free,e._geoToH3=Ye._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=Ye._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=Ye._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=Ye._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=Ye._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=Ye._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=Ye._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=Ye._getPentagonIndexes,e._getRes0Indexes=Ye._getRes0Indexes,e._h3Distance=Ye._h3Distance,e._h3GetBaseCell=Ye._h3GetBaseCell,e._h3GetFaces=Ye._h3GetFaces,e._h3GetResolution=Ye._h3GetResolution,e._h3IndexesAreNeighbors=Ye._h3IndexesAreNeighbors,e._h3IsPentagon=Ye._h3IsPentagon,e._h3IsResClassIII=Ye._h3IsResClassIII,e._h3IsValid=Ye._h3IsValid,e._h3Line=Ye._h3Line,e._h3LineSize=Ye._h3LineSize,e._h3SetToLinkedGeo=Ye._h3SetToLinkedGeo,e._h3ToCenterChild=Ye._h3ToCenterChild,e._h3ToChildren=Ye._h3ToChildren,e._h3ToGeo=Ye._h3ToGeo,e._h3ToGeoBoundary=Ye._h3ToGeoBoundary,e._h3ToParent=Ye._h3ToParent,e._h3UnidirectionalEdgeIsValid=Ye._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=Ye._hexAreaKm2,e._hexAreaM2=Ye._hexAreaM2,e._hexRing=Ye._hexRing,e._i64Subtract=Ye._i64Subtract,e._kRing=Ye._kRing,e._kRingDistances=Ye._kRingDistances,e._llvm_minnum_f64=Ye._llvm_minnum_f64,e._llvm_round_f64=Ye._llvm_round_f64,e._malloc=Ye._malloc,e._maxFaceCount=Ye._maxFaceCount,e._maxH3ToChildrenSize=Ye._maxH3ToChildrenSize,e._maxKringSize=Ye._maxKringSize,e._maxPolyfillSize=Ye._maxPolyfillSize,e._maxUncompactSize=Ye._maxUncompactSize,e._memcpy=Ye._memcpy,e._memset=Ye._memset,e._numHexagons=Ye._numHexagons,e._pentagonIndexCount=Ye._pentagonIndexCount,e._pointDistKm=Ye._pointDistKm,e._pointDistM=Ye._pointDistM,e._pointDistRads=Ye._pointDistRads,e._polyfill=Ye._polyfill,e._res0IndexCount=Ye._res0IndexCount,e._round=Ye._round,e._sbrk=Ye._sbrk,e._sizeOfCoordIJ=Ye._sizeOfCoordIJ,e._sizeOfGeoBoundary=Ye._sizeOfGeoBoundary,e._sizeOfGeoCoord=Ye._sizeOfGeoCoord,e._sizeOfGeoPolygon=Ye._sizeOfGeoPolygon,e._sizeOfGeofence=Ye._sizeOfGeofence,e._sizeOfH3Index=Ye._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=Ye._sizeOfLinkedGeoPolygon,e._uncompact=Ye._uncompact,e.establishStackSpace=Ye.establishStackSpace;var zs=e.stackAlloc=Ye.stackAlloc,Dr=e.stackRestore=Ye.stackRestore,oi=e.stackSave=Ye.stackSave;if(e.asm=Ye,e.cwrap=ie,e.setValue=U,e.getValue=H,e.getTempRet0=I,Wn){fo(Wn)||(Wn=s(Wn));{Vn();var Zn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ze.set(K,k),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Si()},Os=function(){A(Wn,Zn,function(){throw"could not load memory initializer "+Wn})},Ui=Cr(Wn);if(Ui)Zn(Ui.buffer);else if(e.memoryInitializerRequest){var Vi=function(){var K=e.memoryInitializerRequest,W=K.response;if(K.status!==200&&K.status!==0){var ee=Cr(e.memoryInitializerRequestURL);if(ee)W=ee.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+Wn),Os();return}}Zn(W)};e.memoryInitializerRequest.response?setTimeout(Vi,0):e.memoryInitializerRequest.addEventListener("load",Vi)}else Os()}}var Ii;Kr=function K(){Ii||os(),Ii||(Kr=K)};function os(K){if(tr>0||(Un(),tr>0))return;function W(){Ii||(Ii=!0,!q&&(wr(),wt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),rn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),W()},1)):W()}e.run=os;function Rr(K){throw e.onAbort&&e.onAbort(K),K+="",o(K),g(K),q=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Rr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return os(),t}(typeof It=="object"?It:{}),Mn="number",Tp=Mn,On=Mn,Kn=Mn,Zo=Mn,yr=Mn,mge=[["sizeOfH3Index",Mn],["sizeOfGeoCoord",Mn],["sizeOfGeoBoundary",Mn],["sizeOfGeoPolygon",Mn],["sizeOfGeofence",Mn],["sizeOfLinkedGeoPolygon",Mn],["sizeOfCoordIJ",Mn],["h3IsValid",Tp,[On,Kn]],["geoToH3",On,[Mn,Mn,Zo]],["h3ToGeo",null,[On,Kn,yr]],["h3ToGeoBoundary",null,[On,Kn,yr]],["maxKringSize",Mn,[Mn]],["kRing",null,[On,Kn,Mn,yr]],["kRingDistances",null,[On,Kn,Mn,yr,yr]],["hexRing",null,[On,Kn,Mn,yr]],["maxPolyfillSize",Mn,[yr,Zo]],["polyfill",null,[yr,Zo,yr]],["h3SetToLinkedGeo",null,[yr,Mn,yr]],["destroyLinkedPolygon",null,[yr]],["compact",Mn,[yr,yr,Mn]],["uncompact",Mn,[yr,Mn,yr,Mn,Zo]],["maxUncompactSize",Mn,[yr,Mn,Zo]],["h3IsPentagon",Tp,[On,Kn]],["h3IsResClassIII",Tp,[On,Kn]],["h3GetBaseCell",Mn,[On,Kn]],["h3GetResolution",Mn,[On,Kn]],["maxFaceCount",Mn,[On,Kn]],["h3GetFaces",null,[On,Kn,yr]],["h3ToParent",On,[On,Kn,Zo]],["h3ToChildren",null,[On,Kn,Zo,yr]],["h3ToCenterChild",On,[On,Kn,Zo]],["maxH3ToChildrenSize",Mn,[On,Kn,Zo]],["h3IndexesAreNeighbors",Tp,[On,Kn,On,Kn]],["getH3UnidirectionalEdge",On,[On,Kn,On,Kn]],["getOriginH3IndexFromUnidirectionalEdge",On,[On,Kn]],["getDestinationH3IndexFromUnidirectionalEdge",On,[On,Kn]],["h3UnidirectionalEdgeIsValid",Tp,[On,Kn]],["getH3IndexesFromUnidirectionalEdge",null,[On,Kn,yr]],["getH3UnidirectionalEdgesFromHexagon",null,[On,Kn,yr]],["getH3UnidirectionalEdgeBoundary",null,[On,Kn,yr]],["h3Distance",Mn,[On,Kn,On,Kn]],["h3Line",Mn,[On,Kn,On,Kn,yr]],["h3LineSize",Mn,[On,Kn,On,Kn]],["experimentalH3ToLocalIj",Mn,[On,Kn,On,Kn,yr]],["experimentalLocalIjToH3",Mn,[On,Kn,yr,yr]],["hexAreaM2",Mn,[Zo]],["hexAreaKm2",Mn,[Zo]],["edgeLengthM",Mn,[Zo]],["edgeLengthKm",Mn,[Zo]],["pointDistM",Mn,[yr,yr]],["pointDistKm",Mn,[yr,yr]],["pointDistRads",Mn,[yr,yr]],["cellAreaM2",Mn,[On,Kn]],["cellAreaKm2",Mn,[On,Kn]],["cellAreaRads2",Mn,[On,Kn]],["exactEdgeLengthM",Mn,[On,Kn]],["exactEdgeLengthKm",Mn,[On,Kn]],["exactEdgeLengthRads",Mn,[On,Kn]],["numHexagons",Mn,[Zo]],["getRes0Indexes",null,[yr]],["res0IndexCount",Mn],["getPentagonIndexes",null,[Mn,yr]],["pentagonIndexCount",Mn]],on={};mge.forEach(function(e){on[e[0]]=It.cwrap.apply(It,e)});var I0=16,Lo=4,t8=4,uh=8,ho=on.sizeOfH3Index(),mv=on.sizeOfGeoCoord(),HF=on.sizeOfGeoBoundary(),yge=on.sizeOfGeoPolygon(),ig=on.sizeOfGeofence(),_ge=on.sizeOfLinkedGeoPolygon(),WF=on.sizeOfCoordIJ(),sa={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Ld(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var vge=/[^0-9a-fA-F]/;function gr(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||vge.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),I0),n=parseInt(t.substring(t.length-8),I0);return[n,e]}function n8(t){if(t>=0)return t.toString(I0);t=t&2147483647;var e=QF(8,t.toString(I0)),n=(parseInt(e[0],I0)+8).toString(I0);return e=n+e.substring(1),e}function yv(t,e){return n8(e)+QF(8,n8(t))}function QF(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function r8(t,e,n){for(var r=t.length,i=It._calloc(r,mv),s=n?1:0,A=n?0:1,o=0;o<r*2;o+=2)It.HEAPF64.set([t[o/2][s],t[o/2][A]].map(_v),i/uh+o);return It.HEAPU32.set([r,i],e/Lo),e}function xge(t,e){var n=t.length-1,r=It._calloc(yge),i=0,s=i+ig,A=s+Lo;r8(t[0],r+i,e);var o;if(n>0){o=It._calloc(n,ig);for(var g=0;g<n;g++)r8(t[g+1],o+ig*g,e)}return It.setValue(r+s,n,"i32"),It.setValue(r+A,o,"i32"),r}function wge(t){var e=0,n=e+ig,r=n+Lo,i=Lo;It._free(It.getValue(t+e+i,"i8*"));var s=It.getValue(t+n,"i32");if(s>0){for(var A=It.getValue(t+r,"i32"),o=0;o<s;o++)It._free(It.getValue(A+ig*o+i,"i8*"));It._free(A)}It._free(t)}function qF(t){var e=It.getTempRet0();return[t,e]}function Dd(t){var e=qF(t),n=e[0],r=e[1];return r?yv(n,r):null}function ZF(t,e){e===void 0&&(e=0);var n=It.getValue(t+Lo*e*2,"i32"),r=It.getValue(t+Lo*(e*2+1),"i32");return r?yv(n,r):null}function bge(t,e,n){It.HEAPU32.set(gr(t),e/Lo+2*n)}function aA(t,e){for(var n=[],r=0;r<e;r++){var i=ZF(t,r);i!==null&&n.push(i)}return n}function YS(t,e){for(var n=e.length,r=0;r<n;r++)bge(e[r],t,r)}function i8(t,e){var n=It._calloc(1,mv);return It.HEAPF64.set([t,e].map(_v),n/uh),n}function y2(t){return JF(It.getValue(t,"double"))}function XS(t){return[y2(t),y2(t+uh)]}function YF(t){return[y2(t+uh),y2(t)]}function XF(t,e,n){for(var r=It.getValue(t,"i32"),i=t+uh,s=[],A=e?YF:XS,o=0;o<r*2;o+=2)s.push(A(i+uh*o));return n&&s.push(s[0]),s}function Ege(t,e){for(var n=[],r=e?YF:XS,i,s,A,o;t;){for(n.push(i=[]),s=It.getValue(t,"i8*");s;){for(i.push(A=[]),o=It.getValue(s,"i8*");o;)A.push(r(o)),o=It.getValue(o+uh*2,"i8*");e&&A.push(A[0]),s=It.getValue(s+t8*2,"i8*")}t=It.getValue(t+t8*2,"i8*")}return n}function Tge(t){return{i:It.getValue(t,"i32"),j:It.getValue(t+Lo,"i32")}}function Sge(t,e){var n=e.i,r=e.j;It.setValue(t,n,"i32"),It.setValue(t+Lo,r,"i32")}function Mge(t,e){for(var n=[],r=0;r<e;r++){var i=It.getValue(t+Lo*r,"i32");i>=0&&n.push(i)}return n}function KF(t){var e=gr(t),n=e[0],r=e[1];return!!on.h3IsValid(n,r)}function Cge(t){var e=gr(t),n=e[0],r=e[1];return!!on.h3IsPentagon(n,r)}function Pge(t){var e=gr(t),n=e[0],r=e[1];return!!on.h3IsResClassIII(n,r)}function Ige(t){var e=gr(t),n=e[0],r=e[1];return on.h3GetBaseCell(n,r)}function kge(t){var e=gr(t),n=e[0],r=e[1],i=on.maxFaceCount(n,r),s=It._malloc(Lo*i);on.h3GetFaces(n,r,s);var A=Mge(s,i);return It._free(s),A}function Lge(t){var e=gr(t),n=e[0],r=e[1];return on.h3IsValid(n,r)?on.h3GetResolution(n,r):-1}function Dge(t,e,n){var r=It._malloc(mv);It.HEAPF64.set([t,e].map(_v),r/uh);var i=Dd(on.geoToH3(r,n));return It._free(r),i}function Rge(t){var e=It._malloc(mv),n=gr(t),r=n[0],i=n[1];on.h3ToGeo(r,i,e);var s=XS(e);return It._free(e),s}function Bge(t,e){var n=It._malloc(HF),r=gr(t),i=r[0],s=r[1];on.h3ToGeoBoundary(i,s,n);var A=XF(n,e,e);return It._free(n),A}function zge(t,e){var n=gr(t),r=n[0],i=n[1];return Dd(on.h3ToParent(r,i,e))}function Oge(t,e){if(!KF(t))return[];var n=gr(t),r=n[0],i=n[1],s=on.maxH3ToChildrenSize(r,i,e),A=It._calloc(s,ho);on.h3ToChildren(r,i,e,A);var o=aA(A,s);return It._free(A),o}function Fge(t,e){var n=gr(t),r=n[0],i=n[1];return Dd(on.h3ToCenterChild(r,i,e))}function Nge(t,e){var n=gr(t),r=n[0],i=n[1],s=on.maxKringSize(e),A=It._calloc(s,ho);on.kRing(r,i,e,A);var o=aA(A,s);return It._free(A),o}function Uge(t,e){var n=gr(t),r=n[0],i=n[1],s=on.maxKringSize(e),A=It._calloc(s,ho),o=It._calloc(s,Lo);on.kRingDistances(r,i,e,A,o);for(var g=[],w=0;w<e+1;w++)g.push([]);for(var C=0;C<s*2;C+=2){var I=It.getValue(A+Lo*C,"i32"),k=It.getValue(A+Lo*(C+1),"i32"),U=It.getValue(o+Lo*(C/2),"i32");(I!==0||k!==0)&&g[U].push(yv(I,k))}return It._free(A),It._free(o),g}function Vge(t,e){var n=e===0?1:6*e,r=It._calloc(n,ho),i=on.hexRing.apply(on,gr(t).concat([e],[r]));if(i!==0)throw It._free(r),new Error("Failed to get hexRing (encountered a pentagon?)");var s=aA(r,n);return It._free(r),s}function Gge(t,e,n){if(Ld(e),n=!!n,t.length===0||t[0].length===0)return[];typeof t[0][0]=="number"&&(t=[t]);var r=xge(t,n),i=on.maxPolyfillSize(r,e),s=It._calloc(i,ho);on.polyfill(r,e,s);var A=aA(s,i);return It._free(s),wge(r),A}function $ge(t,e){if(!t||!t.length)return[];var n=t.length,r=It._calloc(n,ho);YS(r,t);var i=It._calloc(_ge),s=i;on.h3SetToLinkedGeo(r,n,i);var A=Ege(i,e);return on.destroyLinkedPolygon(s),It._free(s),It._free(r),A}function jge(t){if(!t||!t.length)return[];var e=t.length,n=It._calloc(e,ho);YS(n,t);var r=It._calloc(e,ho),i=on.compact(n,r,e);if(i!==0)throw It._free(n),It._free(r),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var s=aA(r,e);return It._free(n),It._free(r),s}function Hge(t,e){if(Ld(e),!t||!t.length)return[];var n=t.length,r=It._calloc(n,ho);YS(r,t);var i=on.maxUncompactSize(r,n,e),s=It._calloc(i,ho),A=on.uncompact(r,n,s,i,e);if(A!==0)throw It._free(r),It._free(s),new Error("Failed to uncompact (bad resolution?)");var o=aA(s,i);return It._free(r),It._free(s),o}function Wge(t,e){var n=gr(t),r=n[0],i=n[1],s=gr(e),A=s[0],o=s[1];return!!on.h3IndexesAreNeighbors(r,i,A,o)}function Qge(t,e){var n=gr(t),r=n[0],i=n[1],s=gr(e),A=s[0],o=s[1];return Dd(on.getH3UnidirectionalEdge(r,i,A,o))}function qge(t){var e=gr(t),n=e[0],r=e[1];return Dd(on.getOriginH3IndexFromUnidirectionalEdge(n,r))}function Zge(t){var e=gr(t),n=e[0],r=e[1];return Dd(on.getDestinationH3IndexFromUnidirectionalEdge(n,r))}function Yge(t){var e=gr(t),n=e[0],r=e[1];return!!on.h3UnidirectionalEdgeIsValid(n,r)}function Xge(t){var e=gr(t),n=e[0],r=e[1],i=2,s=It._calloc(i,ho);on.getH3IndexesFromUnidirectionalEdge(n,r,s);var A=aA(s,i);return It._free(s),A}function Kge(t){var e=gr(t),n=e[0],r=e[1],i=6,s=It._calloc(i,ho);on.getH3UnidirectionalEdgesFromHexagon(n,r,s);var A=aA(s,i);return It._free(s),A}function Jge(t,e){var n=It._malloc(HF),r=gr(t),i=r[0],s=r[1];on.getH3UnidirectionalEdgeBoundary(i,s,n);var A=XF(n,e);return It._free(n),A}function eme(t,e){var n=gr(t),r=n[0],i=n[1],s=gr(e),A=s[0],o=s[1];return on.h3Distance(r,i,A,o)}function tme(t,e){var n=gr(t),r=n[0],i=n[1],s=gr(e),A=s[0],o=s[1],g=on.h3LineSize(r,i,A,o);if(g<0)throw new Error("Line cannot be calculated");var w=It._calloc(g,ho);on.h3Line(r,i,A,o,w);var C=aA(w,g);return It._free(w),C}function nme(t,e){var n=It._malloc(WF),r=on.experimentalH3ToLocalIj.apply(on,gr(t).concat(gr(e),[n])),i=Tge(n);switch(It._free(n),r){case 0:return i;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function rme(t,e){if(!e||typeof e.i!="number"||typeof e.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=It._malloc(WF),r=It._malloc(ho);Sge(n,e);var i=on.experimentalLocalIjToH3.apply(on,gr(t).concat([n],[r])),s=ZF(r);if(It._free(n),It._free(r),i!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return s}function ime(t,e,n){var r=i8(t[0],t[1]),i=i8(e[0],e[1]),s;switch(n){case sa.m:s=on.pointDistM(r,i);break;case sa.km:s=on.pointDistKm(r,i);break;case sa.rads:s=on.pointDistRads(r,i);break;default:s=null}if(It._free(r),It._free(i),s===null)throw new Error("Unknown unit: "+n);return s}function sme(t,e){var n=gr(t),r=n[0],i=n[1];switch(e){case sa.m2:return on.cellAreaM2(r,i);case sa.km2:return on.cellAreaKm2(r,i);case sa.rads2:return on.cellAreaRads2(r,i);default:throw new Error("Unknown unit: "+e)}}function ome(t,e){var n=gr(t),r=n[0],i=n[1];switch(e){case sa.m:return on.exactEdgeLengthM(r,i);case sa.km:return on.exactEdgeLengthKm(r,i);case sa.rads:return on.exactEdgeLengthRads(r,i);default:throw new Error("Unknown unit: "+e)}}function ame(t,e){switch(Ld(t),e){case sa.m2:return on.hexAreaM2(t);case sa.km2:return on.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function lme(t,e){switch(Ld(t),e){case sa.m:return on.edgeLengthM(t);case sa.km:return on.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function Ame(t){Ld(t);var e=qF(on.numHexagons(t)),n=e[0],r=e[1];return r?r*Math.pow(2,32)+n:n}function ume(){var t=on.res0IndexCount(),e=It._malloc(ho*t);on.getRes0Indexes(e);var n=aA(e,t);return It._free(e),n}function cme(t){Ld(t);var e=on.pentagonIndexCount(),n=It._malloc(ho*e);on.getPentagonIndexes(t,n);var r=aA(n,e);return It._free(n),r}function _v(t){return t*Math.PI/180}function JF(t){return t*180/Math.PI}const hme=Object.freeze(Object.defineProperty({__proto__:null,UNITS:sa,cellArea:sme,compact:jge,degsToRads:_v,edgeLength:lme,exactEdgeLength:ome,experimentalH3ToLocalIj:nme,experimentalLocalIjToH3:rme,geoToH3:Dge,getDestinationH3IndexFromUnidirectionalEdge:Zge,getH3IndexesFromUnidirectionalEdge:Xge,getH3UnidirectionalEdge:Qge,getH3UnidirectionalEdgeBoundary:Jge,getH3UnidirectionalEdgesFromHexagon:Kge,getOriginH3IndexFromUnidirectionalEdge:qge,getPentagonIndexes:cme,getRes0Indexes:ume,h3Distance:eme,h3GetBaseCell:Ige,h3GetFaces:kge,h3GetResolution:Lge,h3IndexToSplitLong:gr,h3IndexesAreNeighbors:Wge,h3IsPentagon:Cge,h3IsResClassIII:Pge,h3IsValid:KF,h3Line:tme,h3SetToMultiPolygon:$ge,h3ToCenterChild:Fge,h3ToChildren:Oge,h3ToGeo:Rge,h3ToGeoBoundary:Bge,h3ToParent:zge,h3UnidirectionalEdgeIsValid:Yge,hexArea:ame,hexRing:Vge,kRing:Nge,kRingDistances:Uge,numHexagons:Ame,pointDist:ime,polyfill:Gge,radsToDegs:JF,splitLongToh3Index:yv,uncompact:Hge},Symbol.toStringTag,{value:"Module"})),fme=A9(hme);var Yg=fme,vv="Feature",e7="FeatureCollection",_2="Polygon",KS="MultiPolygon";function t7(t){for(var e=null,n=0;n<t.length;n++)if(e!==null)for(var r=0;r<t[n].length;r++)e.push(t[n][r]);else e=t[n];return Array.from(new Set(e))}function dme(t){for(var e=0,n=0,r=0,i=t[0],s=0;s<i.length;s++)e+=i[s][0],n+=i[s][1],r++;return[e/r,n/r]}function pme(t,e){var n=t.features;if(!n)throw new Error("No features found");return t7(n.map(function(r){return n7(r,e)}))}function n7(t,e,n){n===void 0&&(n={});var r=t.type,i=t.geometry,s=i&&i.type;if(r===e7)return pme(t,e);if(r!==vv)throw new Error("Unhandled type: "+r);if(s!==_2&&s!==KS)throw new Error("Unhandled geometry type: "+s);var A=s===_2?[i.coordinates]:i.coordinates;return t7(A.map(function(o){var g=Yg.polyfill(o,e,!0);if(g.length||!n.ensureOutput)return g;var w=dme(o),C=w[0],I=w[1];return[Yg.geoToH3(I,C,e)]}))}function r7(t,e){e===void 0&&(e={});var n=[Yg.h3ToGeoBoundary(t,!0)];return{type:vv,id:t,properties:e,geometry:{type:_2,coordinates:n}}}function gme(t,e){e===void 0&&(e={});var n=Yg.h3SetToMultiPolygon(t,!0),r=n.length>1,i=r?KS:_2,s=r?n:n[0]||[];return{type:vv,properties:e,geometry:{type:i,coordinates:s}}}function mme(t,e){e===void 0&&(e={});var n=t.map(function(r){return[Yg.h3ToGeoBoundary(r,{geoJson:!0})]});return{type:vv,properties:e,geometry:{type:KS,coordinates:n}}}function yme(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],s=e?e(i):{};n.push(r7(i,s))}return{type:e7,features:n}}var _me={featureToH3Set:n7,h3ToFeature:r7,h3SetToFeature:gme,h3SetToMultiPolygonFeature:mme,h3SetToFeatureCollection:yme},v2=_me;function wm({dataDeag:t,disabled:e=!1,deagKey:n}){const{current:r}=je.useRef(UF(t.features,fe=>fe.properties.id)),[i,s]=je.useState(null),[A,o]=je.useState({}),[g,w]=je.useState([]),[C,I]=je.useState({}),[k,U]=je.useState({type:"FeatureCollection",features:[]}),[H,q]=je.useState({}),[se,X]=je.useState(!1),te=je.useCallback(({object:fe})=>{if(!fe){s(null),o({}),w([]);return}if(!e){if(se)s(null),o({}),w(fe.properties.id);else if(fe.properties[n]){const me=v2.h3ToFeature(fe.hexId),Se={};for(const He of fe.properties[n]){const Qe=r[He],Ke=m2(me,Qe.geometry);Se[Qe.properties.id]=d2(Ke)/d2(me)}o(Se),s(fe.hexId)}return!0}},[C,se,e,n]),ie=je.useCallback(({object:fe},me)=>{if(fe.properties.id==g)return U({type:"FeatureCollection",features:[]}),q({}),I({}),X(!1),!0;if(fe.properties[n]==null)return;if(me.srcEvent.shiftKey)return I(Ke=>({...Ke,[fe.hexId]:fe.properties[n]})),!0;X(!0),s(null),o({}),w(fe.properties.id),I({});const Se={...C,[fe.hexId]:fe.properties[n]};I(Se);const He={},Qe={type:"FeatureCollection",features:[]};for(const Ke in Se)for(const nt of Se[Ke]){const Ne=r[nt],rt=v2.h3ToFeature(Ke),Ze=m2(rt,Ne.geometry);Qe.features.push({...Ze,properties:{...Ne.properties}}),He[Ne.properties.id]={...Ne.properties}}return q(He),U(Qe),!0},[C,g,se,n]);return{hoveredHex:i,clickedHexes:C,hoveredGeos:A,selectedGeoJSON:k,selectedGeos:H,hoveredGeoActive:g,onHover:te,onClick:ie,selectionFinalized:se}}const $r=WS(Upe,h2),zi=WS(Fpe,f2),Sp=WS(Npe,{});ms().domain([9,14]).range([0,1]).clamp(!0);const Qh=nle().domain([new Date("10/31/1921"),new Date("9/30/2021")]).range([0,1199]).invert,Eu=0;function i7({speedyCounter:t,curOption:e}){const n=je.useRef(),r=je.useRef(),i=je.useRef({});je.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=je.useCallback(w=>{const C=w.properties.Demand[kr[Eu]][t],I=-w.properties.UnmetDemand[kr[Eu]][t],k=-I-w.properties.UnmetDemandBaseline[t];n.current.classList.add("active"),r.current.classList.add("active"),r.current.innerHTML=`        <div><b>Region ID</b> ${w.properties.id}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${I}</div>
        <div><b>Difference in Unmet Demand</b> ${k}</div>
        <div><b>Land Holder</b> ${q0(w)}</div>
      `},[t]),A=je.useCallback(w=>{if(r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${l2(Qh(t))}</i></div>
      `,w.properties.Demand){const C=w.properties.Demand[kr[Eu]][t],I=-w.properties.UnmetDemand[kr[Eu]][t],k=-I-w.properties.UnmetDemandBaseline[t];n.current.innerHTML+=`        
          <div><i>${c2[Eu]}</i></div>
          <div><b>Region ID</b> ${w.properties.id}</div>
          <div><b>Scenario Demand</b> ${C}</div>
          <div><b>Scen. Unmet Demand</b> ${I}</div>
          <div><b>Difference in Unmet Demand</b> ${k}</div>
          <div><b>Land Holder</b> ${q0(w)}</div>
        `}else{const C=w.properties.Groundwater[t];n.current.innerHTML+=`     
          <div><b>Elem ID</b> ${w.properties.id}</div>
          <div><b>Groundwater</b> ${C}</div>
      `}},[t]),o=je.useCallback(w=>{const C=w.properties.Demand[kr[Eu]][t],I=-w.properties.UnmetDemand[kr[Eu]][t],k=-I-w.properties.UnmetDemandBaseline[t],U=w.properties.Groundwater[t],H=w.properties.GroundwaterVar[t],q=w.properties.UnmetDemandVar[kr[Eu]][t],se=a2(w.properties.UnmetDemandBaselineVar[t],q),X=w.properties.DURgs.join(", "),te=w.properties.GWRgs.join(", ");r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${l2(Qh(t))}</i></div>
        <div><i>${c2[Eu]}</i></div>
        <div><b>Groundwater</b> ${U}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${I}</div>
        <div><b>Difference in Unmet Demand</b> ${k}</div>
        <div><b>Land Holder</b> ${q0(w)}</div>
        <div><b>Variance (GW)</b> ${H}</div>
        <div><b>Var. (Scen. UnmetDem)</b> ${q}</div>
        <div><b>Var. (Difference)</b> ${se}</div>
        <div><b>Demand Regions</b> ${X}</div>
        <div><b>GW Regions</b> ${te}</div>
      `},[t]);return{getTooltip:je.useCallback(({object:w})=>{if(!w){i.current&&(r.current.classList.remove("active"),yd(i.current)&&n.current.classList.remove("active"),i.current=w),e>1&&(r.current.classList.remove("active"),n.current.classList.remove("active"));return}e<=1&&yd(w)?o(w):e<=1&&pv(w)?s(w):A(w),i.current=w},[t,e])}}let xv=class extends Ar{renderLayers(){return[new ff({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new cf(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};xv.layerName="BaseTerrainLayer";xv.defaultProps={...Ar.defaultProps};const s8=0;let s7=class extends Ar{renderLayers(){const{curOption:e,speedyCounter:n}=this.props;return[new ns({id:"GroundwaterGeo",data:QS,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...$r.groundwater.interpColor(r.properties.Groundwater[n]),255],visible:e==2,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new ns({id:"UDemGeo",data:jA,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...$r.unmetDemand.interpColor(r.properties.UnmetDemand[kr[s8]][n]),255],visible:e==3,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new ns({id:"DemDiffGeo",data:jA,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...$r.difference.interpColor(r.properties.UnmetDemand[kr[s8]][n]-r.properties.UnmetDemandBaseline[n]),255],visible:e==4,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0})]}};s7.layerName="BasicGeoLayer";s7.defaultProps={...Ar.defaultProps,autoHighlight:!0};const o8=Zl("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),a8=Zl("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),l8=Zl("rgb(100, 100, 100)",.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t)),A8=Zl("rgb(100, 100, 100)",.5,-.5).replace(/[^\d,]/g,"").split(",").map(t=>Number(t));function JS({counter:t,displayMonth:e,dataset:n}){const r=(t+9)%12+1,i=je.useRef();je.useEffect(()=>{i.current=Object.groupBy(Jw[n],(w,C)=>Qh(C).toLocaleString("default",{year:"numeric"}))},[n]);const s=ms().domain([0,Rne(Jw[n],w=>w)]).range([40,90]),A=ms().domain([1,12]).range([0,2*Math.PI]),o=ok().radius(w=>s(w)).curve(lk).angle((w,C)=>A((C+9)%12+1)),g=ok().radius(w=>s(w)).curve(lk).angle((w,C)=>A(C%12+1));je.useEffect(()=>(io("#clockContainer").style("visibility","visible"),io("#pieOutline path").attr("d",sk().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*2)).attr("fill","none").attr("stroke",n=="averageGroundwater"?`rgb(${o8})`:`rgba(${l8}, 1)`),io("#demandLine path").data([Jw[n]]).join("path").attr("d",w=>o(w)).attr("stroke",n=="averageGroundwater"?`rgba(${a8}, 0.3)`:`rgba(${A8}, 0.3)`).attr("stroke-width","0.2").attr("fill","none"),function(){io("#clockContainer").style("visibility","hidden"),io("#pie path").attr("d",""),io("#pieOutline path").attr("d",""),io("#demandLine path").attr("d",""),io("#demandLineCur path").attr("d",""),io("#date").text("")}),[n]),je.useEffect(()=>{io("#pie path").attr("d",sk().innerRadius(40).outerRadius(90).startAngle(0).endAngle(Math.PI*r/12*2)).attr("fill",n=="averageGroundwater"?`rgb(${o8})`:`rgba(${l8}, 1)`);let w=Qh(t);e?io("#date").html("<b>"+w.toLocaleString("default",{year:"numeric"})+"</b><br/>"+w.toLocaleString("default",{month:"long"})):io("#date").html("<b>"+w.toLocaleString("default",{year:"numeric"})+"</b>"),gie("#demandLineCur path").data([i.current[Qh(t).toLocaleString("default",{year:"numeric"})]]).join("path").attr("d",C=>g(C)).attr("stroke",n=="averageGroundwater"?`rgba(${a8}, 1)`:`rgba(${A8}, 1)`).attr("stroke-width","2").attr("fill","none")},[n,t])}var Oi=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function s(K){return e.locateFile?e.locateFile(K,i):i+K}var A;typeof document<"u"&&document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",A=function(W,ee,he){var a=new XMLHttpRequest;a.open("GET",W,!0),a.responseType="arraybuffer",a.onload=function(){if(a.status==200||a.status==0&&a.response){ee(a.response);return}var Le=Cr(W);if(Le){ee(Le.buffer);return}he()},a.onerror=he,a.send(null)};var o=e.print||console.log.bind(console),g=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var w=0,C=function(K){w=K},I=function(){return w},k=8;function U(K,W,ee,he){switch(ee=ee||"i8",ee.charAt(ee.length-1)==="*"&&(ee="i32"),ee){case"i1":rt[K>>0]=W;break;case"i8":rt[K>>0]=W;break;case"i16":mt[K>>1]=W;break;case"i32":Kt[K>>2]=W;break;case"i64":Mi=[W>>>0,(Fr=W,+er(Fr)>=1?Fr>0?(or(+mr(Fr/4294967296),4294967295)|0)>>>0:~~+Hn((Fr-+(~~Fr>>>0))/4294967296)>>>0:0)],Kt[K>>2]=Mi[0],Kt[K+4>>2]=Mi[1];break;case"float":Tt[K>>2]=W;break;case"double":dn[K>>3]=W;break;default:Rr("invalid type for setValue: "+ee)}}function H(K,W,ee){switch(W=W||"i8",W.charAt(W.length-1)==="*"&&(W="i32"),W){case"i1":return rt[K>>0];case"i8":return rt[K>>0];case"i16":return mt[K>>1];case"i32":return Kt[K>>2];case"i64":return Kt[K>>2];case"float":return Tt[K>>2];case"double":return dn[K>>3];default:Rr("invalid type for getValue: "+W)}return null}var q=!1;function se(K,W){K||Rr("Assertion failed: "+W)}function X(K){var W=e["_"+K];return se(W,"Cannot call unknown function "+K+", make sure it is exported"),W}function te(K,W,ee,he,a){var G={string:function(ft){var Dt=0;if(ft!=null&&ft!==0){var Rt=(ft.length<<2)+1;Dt=zs(Rt),Qe(ft,Dt,Rt)}return Dt},array:function(ft){var Dt=zs(ft.length);return Ke(ft,Dt),Dt}};function Le(ft){return W==="string"?Se(ft):W==="boolean"?!!ft:ft}var Ie=X(K),Pe=[],ke=0;if(he)for(var qe=0;qe<he.length;qe++){var lt=G[ee[qe]];lt?(ke===0&&(ke=oi()),Pe[qe]=lt(he[qe])):Pe[qe]=he[qe]}var We=Ie.apply(null,Pe);return We=Le(We),ke!==0&&Dr(ke),We}function ie(K,W,ee,he){ee=ee||[];var a=ee.every(function(Le){return Le==="number"}),G=W!=="string";return G&&a&&!he?X(K):function(){return te(K,W,ee,arguments)}}var fe=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function me(K,W,ee){for(var he=W+ee,a=W;K[a]&&!(a>=he);)++a;if(a-W>16&&K.subarray&&fe)return fe.decode(K.subarray(W,a));for(var G="";W<a;){var Le=K[W++];if(!(Le&128)){G+=String.fromCharCode(Le);continue}var Ie=K[W++]&63;if((Le&224)==192){G+=String.fromCharCode((Le&31)<<6|Ie);continue}var Pe=K[W++]&63;if((Le&240)==224?Le=(Le&15)<<12|Ie<<6|Pe:Le=(Le&7)<<18|Ie<<12|Pe<<6|K[W++]&63,Le<65536)G+=String.fromCharCode(Le);else{var ke=Le-65536;G+=String.fromCharCode(55296|ke>>10,56320|ke&1023)}}return G}function Se(K,W){return K?me(Ze,K,W):""}function He(K,W,ee,he){if(!(he>0))return 0;for(var a=ee,G=ee+he-1,Le=0;Le<K.length;++Le){var Ie=K.charCodeAt(Le);if(Ie>=55296&&Ie<=57343){var Pe=K.charCodeAt(++Le);Ie=65536+((Ie&1023)<<10)|Pe&1023}if(Ie<=127){if(ee>=G)break;W[ee++]=Ie}else if(Ie<=2047){if(ee+1>=G)break;W[ee++]=192|Ie>>6,W[ee++]=128|Ie&63}else if(Ie<=65535){if(ee+2>=G)break;W[ee++]=224|Ie>>12,W[ee++]=128|Ie>>6&63,W[ee++]=128|Ie&63}else{if(ee+3>=G)break;W[ee++]=240|Ie>>18,W[ee++]=128|Ie>>12&63,W[ee++]=128|Ie>>6&63,W[ee++]=128|Ie&63}}return W[ee]=0,ee-a}function Qe(K,W,ee){return He(K,Ze,W,ee)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function Ke(K,W){rt.set(K,W)}function nt(K,W){return K%W>0&&(K+=W-K%W),K}var Ne,rt,Ze,mt,Kt,Tt,dn;function _t(K){Ne=K,e.HEAP8=rt=new Int8Array(K),e.HEAP16=mt=new Int16Array(K),e.HEAP32=Kt=new Int32Array(K),e.HEAPU8=Ze=new Uint8Array(K),e.HEAPU16=new Uint16Array(K),e.HEAPU32=new Uint32Array(K),e.HEAPF32=Tt=new Float32Array(K),e.HEAPF64=dn=new Float64Array(K)}var Et=5267040,Jt=24128,kn=e.TOTAL_MEMORY||33554432;e.buffer?Ne=e.buffer:Ne=new ArrayBuffer(kn),kn=Ne.byteLength,_t(Ne),Kt[Jt>>2]=Et;function Tn(K){for(;K.length>0;){var W=K.shift();if(typeof W=="function"){W();continue}var ee=W.func;typeof ee=="number"?W.arg===void 0?e.dynCall_v(ee):e.dynCall_vi(ee,W.arg):ee(W.arg===void 0?null:W.arg)}}var Tr=[],Jn=[],ir=[],ur=[];function Un(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)Cn(e.preRun.shift());Tn(Tr)}function wr(){Tn(Jn)}function wt(){Tn(ir)}function rn(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)xt(e.postRun.shift());Tn(ur)}function Cn(K){Tr.unshift(K)}function xt(K){ur.unshift(K)}var er=Math.abs,Hn=Math.ceil,mr=Math.floor,or=Math.min,tr=0,Kr=null;function Vn(K){tr++,e.monitorRunDependencies&&e.monitorRunDependencies(tr)}function Si(K){if(tr--,e.monitorRunDependencies&&e.monitorRunDependencies(tr),tr==0&&Kr){var W=Kr;Kr=null,W()}}e.preloadedImages={},e.preloadedAudios={};var Wn=null,Fi="data:application/octet-stream;base64,";function fo(K){return String.prototype.startsWith?K.startsWith(Fi):K.indexOf(Fi)===0}var Fr,Mi;Wn="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Oo=24144;function is(K){return K}function ct(K){var W=/\b__Z[\w\d_]+/g;return K.replace(W,function(ee){var he=ee;return ee===he?ee:he+" ["+ee+"]"})}function kt(){var K=new Error;if(!K.stack){try{throw new Error(0)}catch(W){K=W}if(!K.stack)return"(no stack trace available)"}return K.stack.toString()}function Bs(){var K=kt();return e.extraStackTrace&&(K+=`
`+e.extraStackTrace()),ct(K)}function yi(K,W,ee,he){Rr("Assertion failed: "+Se(K)+", at: "+[W?Se(W):"unknown filename",ee,he?Se(he):"unknown function"])}function Bn(){return rt.length}function Ni(K,W,ee){Ze.set(Ze.subarray(W,W+ee),K)}function Ci(K){return e.___errno_location&&(Kt[e.___errno_location()>>2]=K),K}function Pi(K){Rr("OOM")}function ss(K){try{var W=new ArrayBuffer(K);return W.byteLength!=K?void 0:(new Int8Array(W).set(rt),jr(W),_t(W),1)}catch{}}function Lt(K){var W=Bn(),ee=16777216,he=2147483648-ee;if(K>he)return!1;for(var a=16777216,G=Math.max(W,a);G<K;)G<=536870912?G=nt(2*G,ee):G=Math.min(nt((3*G+2147483648)/4,ee),he);var Le=ss(G);return!!Le}var Sn=typeof atob=="function"?atob:function(K){var W="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ee="",he,a,G,Le,Ie,Pe,ke,qe=0;K=K.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Le=W.indexOf(K.charAt(qe++)),Ie=W.indexOf(K.charAt(qe++)),Pe=W.indexOf(K.charAt(qe++)),ke=W.indexOf(K.charAt(qe++)),he=Le<<2|Ie>>4,a=(Ie&15)<<4|Pe>>2,G=(Pe&3)<<6|ke,ee=ee+String.fromCharCode(he),Pe!==64&&(ee=ee+String.fromCharCode(a)),ke!==64&&(ee=ee+String.fromCharCode(G));while(qe<K.length);return ee};function bn(K){try{for(var W=Sn(K),ee=new Uint8Array(W.length),he=0;he<W.length;++he)ee[he]=W.charCodeAt(he);return ee}catch{throw new Error("Converting base64 string to bytes failed.")}}function Cr(K){if(fo(K))return bn(K.slice(Fi.length))}var xs={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},yn={a:Rr,b:C,c:I,d:yi,e:Ci,f:Bn,g:Ni,h:Lt,i:Pi,j:is,k:ct,l:ss,m:kt,n:Bs,o:Oo,p:Jt},Ye=function(K,W,ee){"almost asm";var he=new K.Int8Array(ee),a=new K.Int32Array(ee);new K.Uint8Array(ee),new K.Float32Array(ee);var G=new K.Float64Array(ee),Le=W.o|0,Ie=W.p|0,Pe=K.Math.floor,ke=K.Math.abs,qe=K.Math.sqrt,lt=K.Math.pow,We=K.Math.cos,ft=K.Math.sin,Dt=K.Math.tan,Rt=K.Math.acos,sn=K.Math.asin,jt=K.Math.atan,pn=K.Math.atan2,qt=K.Math.ceil,an=K.Math.imul,xn=K.Math.min,Ft=K.Math.max,Oe=K.Math.clz32,Ct=W.b,Me=W.c,un=W.d,ai=W.e,nr=W.f,aa=W.g,De=W.h,za=W.i,we=24160;function Fo(y){return he=new Int8Array(y),a=new Int32Array(y),G=new Float64Array(y),ee=y,!0}function ws(y){y=y|0;var m=0;return m=we,we=we+y|0,we=we+15&-16,m|0}function Oa(){return we|0}function Fa(y){y=y|0,we=y}function la(y,m){y=y|0,we=y}function gl(y,m){y=y|0,m=m|0;var v=0,E=0,P=0;return(y|0)<0?(m=2,m|0):(y|0)>13780509?(m=Qa(15,m)|0,m|0):(v=((y|0)<0)<<31>>31,P=V(y|0,v|0,3,0)|0,E=Me()|0,v=d(y|0,v|0,1,0)|0,v=V(P|0,E|0,v|0,Me()|0)|0,v=d(v|0,Me()|0,1,0)|0,y=Me()|0,a[m>>2]=v,a[m+4>>2]=y,m=0,m|0)}function Aa(y,m,v,E){return y=y|0,m=m|0,v=v|0,E=E|0,Jr(y,m,v,E,0)|0}function Jr(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0;if(Q=we,we=we+16|0,O=Q,!(ge(y,m,v,E,P)|0))return E=0,we=Q,E|0;do if((v|0)>=0){if((v|0)>13780509){if(R=Qa(15,O)|0,R|0)break;N=O,O=a[N>>2]|0,N=a[N+4>>2]|0}else R=((v|0)<0)<<31>>31,J=V(v|0,R|0,3,0)|0,N=Me()|0,R=d(v|0,R|0,1,0)|0,R=V(J|0,N|0,R|0,Me()|0)|0,R=d(R|0,Me()|0,1,0)|0,N=Me()|0,a[O>>2]=R,a[O+4>>2]=N,O=R;if(Te(E|0,0,O<<3|0)|0,P|0){Te(P|0,0,O<<2|0)|0,R=Ee(y,m,v,E,P,O,N,0)|0;break}R=h(O,4)|0,R?(J=Ee(y,m,v,E,R,O,N,0)|0,l(R),R=J):R=13}else R=2;while(0);return J=R,we=Q,J|0}function ge(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0;if(Xe=we,we=we+16|0,$e=Xe,Be=Xe+8|0,Re=$e,a[Re>>2]=y,a[Re+4>>2]=m,(v|0)<0)return Be=2,we=Xe,Be|0;if(R=E,a[R>>2]=y,a[R+4>>2]=m,R=(P|0)!=0,R&&(a[P>>2]=0),dr(y,m)|0)return Be=9,we=Xe,Be|0;a[Be>>2]=0;e:do if((v|0)>=1)if(R)for(le=1,J=0,de=0,Re=1,R=y;;){if(!(J|de)){if(R=Fe(R,m,4,Be,$e)|0,R|0)break e;if(m=$e,R=a[m>>2]|0,m=a[m+4>>2]|0,dr(R,m)|0){R=9;break e}}if(R=Fe(R,m,a[22384+(de<<2)>>2]|0,Be,$e)|0,R|0)break e;if(m=$e,R=a[m>>2]|0,m=a[m+4>>2]|0,y=E+(le<<3)|0,a[y>>2]=R,a[y+4>>2]=m,a[P+(le<<2)>>2]=Re,y=J+1|0,O=(y|0)==(Re|0),N=de+1|0,Q=(N|0)==6,dr(R,m)|0){R=9;break e}if(Re=Re+(Q&O&1)|0,(Re|0)>(v|0)){R=0;break}else le=le+1|0,J=O?0:y,de=O?Q?0:N:de}else for(le=1,J=0,de=0,Re=1,R=y;;){if(!(J|de)){if(R=Fe(R,m,4,Be,$e)|0,R|0)break e;if(m=$e,R=a[m>>2]|0,m=a[m+4>>2]|0,dr(R,m)|0){R=9;break e}}if(R=Fe(R,m,a[22384+(de<<2)>>2]|0,Be,$e)|0,R|0)break e;if(m=$e,R=a[m>>2]|0,m=a[m+4>>2]|0,y=E+(le<<3)|0,a[y>>2]=R,a[y+4>>2]=m,y=J+1|0,O=(y|0)==(Re|0),N=de+1|0,Q=(N|0)==6,dr(R,m)|0){R=9;break e}if(Re=Re+(Q&O&1)|0,(Re|0)>(v|0)){R=0;break}else le=le+1|0,J=O?0:y,de=O?Q?0:N:de}else R=0;while(0);return Be=R,we=Xe,Be|0}function Ee(y,m,v,E,P,R,O,N){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0,R=R|0,O=O|0,N=N|0;var Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0;if(Xe=we,we=we+16|0,$e=Xe+8|0,Be=Xe,Q=Y(y|0,m|0,R|0,O|0)|0,le=Me()|0,de=E+(Q<<3)|0,ht=de,ut=a[ht>>2]|0,ht=a[ht+4>>2]|0,J=(ut|0)==(y|0)&(ht|0)==(m|0),!((ut|0)==0&(ht|0)==0|J))do Q=d(Q|0,le|0,1,0)|0,Q=j(Q|0,Me()|0,R|0,O|0)|0,le=Me()|0,de=E+(Q<<3)|0,ut=de,ht=a[ut>>2]|0,ut=a[ut+4>>2]|0,J=(ht|0)==(y|0)&(ut|0)==(m|0);while(!((ht|0)==0&(ut|0)==0|J));if(Q=P+(Q<<2)|0,J&&(a[Q>>2]|0)<=(N|0)||(ut=de,a[ut>>2]=y,a[ut+4>>2]=m,a[Q>>2]=N,(N|0)>=(v|0)))return ut=0,we=Xe,ut|0;switch(J=N+1|0,a[$e>>2]=0,Q=Fe(y,m,2,$e,Be)|0,Q|0){case 9:{Re=9;break}case 0:{Q=Be,Q=Ee(a[Q>>2]|0,a[Q+4>>2]|0,v,E,P,R,O,J)|0,Q||(Re=9);break}}e:do if((Re|0)==9){switch(a[$e>>2]=0,Q=Fe(y,m,3,$e,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(a[Q>>2]|0,a[Q+4>>2]|0,v,E,P,R,O,J)|0,Q|0)break e;break}default:break e}switch(a[$e>>2]=0,Q=Fe(y,m,1,$e,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(a[Q>>2]|0,a[Q+4>>2]|0,v,E,P,R,O,J)|0,Q|0)break e;break}default:break e}switch(a[$e>>2]=0,Q=Fe(y,m,5,$e,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(a[Q>>2]|0,a[Q+4>>2]|0,v,E,P,R,O,J)|0,Q|0)break e;break}default:break e}switch(a[$e>>2]=0,Q=Fe(y,m,4,$e,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(a[Q>>2]|0,a[Q+4>>2]|0,v,E,P,R,O,J)|0,Q|0)break e;break}default:break e}switch(a[$e>>2]=0,Q=Fe(y,m,6,$e,Be)|0,Q|0){case 9:break;case 0:{if(Q=Be,Q=Ee(a[Q>>2]|0,a[Q+4>>2]|0,v,E,P,R,O,J)|0,Q|0)break e;break}default:break e}return ut=0,we=Xe,ut|0}while(0);return ut=Q,we=Xe,ut|0}function Fe(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0;if(v>>>0>6)return P=1,P|0;if(de=(a[E>>2]|0)%6|0,a[E>>2]=de,(de|0)>0){R=0;do v=mo(v)|0,R=R+1|0;while((R|0)<(a[E>>2]|0))}if(de=ne(y|0,m|0,45)|0,Me()|0,le=de&127,le>>>0>121)return P=5,P|0;Q=ti(y,m)|0,R=ne(y|0,m|0,52)|0,Me()|0,R=R&15;e:do if(!R)J=8;else{for(;;){if(O=(15-R|0)*3|0,N=ne(y|0,m|0,O|0)|0,Me()|0,N=N&7,(N|0)==7){m=5;break}if(Be=(_i(R)|0)==0,R=R+-1|0,Re=ue(7,0,O|0)|0,m=m&~(Me()|0),$e=ue(a[(Be?432:16)+(N*28|0)+(v<<2)>>2]|0,0,O|0)|0,O=Me()|0,v=a[(Be?640:224)+(N*28|0)+(v<<2)>>2]|0,y=$e|y&~Re,m=O|m,!v){v=0;break e}if(!R){J=8;break e}}return m|0}while(0);(J|0)==8&&(Be=a[848+(le*28|0)+(v<<2)>>2]|0,$e=ue(Be|0,0,45)|0,y=$e|y,m=Me()|0|m&-1040385,v=a[4272+(le*28|0)+(v<<2)>>2]|0,(Be&127|0)==127&&(Be=ue(a[848+(le*28|0)+20>>2]|0,0,45)|0,m=Me()|0|m&-1040385,v=a[4272+(le*28|0)+20>>2]|0,y=Us(Be|y,m)|0,m=Me()|0,a[E>>2]=(a[E>>2]|0)+1)),N=ne(y|0,m|0,45)|0,Me()|0,N=N&127;e:do if(Gn(N)|0){t:do if((ti(y,m)|0)==1){if((le|0)!=(N|0))if(cA(N,a[7696+(le*28|0)>>2]|0)|0){y=mA(y,m)|0,O=1,m=Me()|0;break}else un(23313,22416,436,22424);switch(Q|0){case 3:{y=Us(y,m)|0,m=Me()|0,a[E>>2]=(a[E>>2]|0)+1,O=0;break t}case 5:{y=mA(y,m)|0,m=Me()|0,a[E>>2]=(a[E>>2]|0)+5,O=0;break t}case 0:return Be=9,Be|0;default:return Be=1,Be|0}}else O=0;while(0);if((v|0)>0){R=0;do y=iu(y,m)|0,m=Me()|0,R=R+1|0;while((R|0)!=(v|0))}if((le|0)!=(N|0)){if(!(lA(N)|0)){if((O|0)!=0|(ti(y,m)|0)!=5)break;a[E>>2]=(a[E>>2]|0)+1;break}switch(de&127){case 8:case 118:break e}(ti(y,m)|0)!=3&&(a[E>>2]=(a[E>>2]|0)+1)}}else if((v|0)>0){R=0;do y=Us(y,m)|0,m=Me()|0,R=R+1|0;while((R|0)!=(v|0))}while(0);return a[E>>2]=((a[E>>2]|0)+v|0)%6|0,Be=P,a[Be>>2]=y,a[Be+4>>2]=m,Be=0,Be|0}function at(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0;for(N=we,we=we+16|0,R=N,O=N+8|0,P=(dr(y,m)|0)==0,P=P?1:2;;){if(a[O>>2]=0,J=(Fe(y,m,P,O,R)|0)==0,Q=R,J&((a[Q>>2]|0)==(v|0)?(a[Q+4>>2]|0)==(E|0):0)){y=4;break}if(P=P+1|0,P>>>0>=7){P=7,y=4;break}}return(y|0)==4?(we=N,P|0):0}function bt(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0;if(Be=we,we=we+16|0,Re=Be,$e=Be+8|0,de=Re,a[de>>2]=y,a[de+4>>2]=m,!v)return $e=E,a[$e>>2]=y,a[$e+4>>2]=m,$e=0,we=Be,$e|0;a[$e>>2]=0;e:do if(dr(y,m)|0)y=9;else{if(R=(v|0)>0,R){P=0,de=y;do{if(y=Fe(de,m,4,$e,Re)|0,y|0)break e;if(m=Re,de=a[m>>2]|0,m=a[m+4>>2]|0,P=P+1|0,dr(de,m)|0){y=9;break e}}while((P|0)<(v|0));if(le=E,a[le>>2]=de,a[le+4>>2]=m,le=v+-1|0,R){J=0,y=1;do{if(P=22384+(J<<2)|0,(J|0)==5)for(O=a[P>>2]|0,R=0,P=y;;){if(y=Re,y=Fe(a[y>>2]|0,a[y+4>>2]|0,O,$e,Re)|0,y|0)break e;if((R|0)!=(le|0))if(Q=Re,N=a[Q>>2]|0,Q=a[Q+4>>2]|0,y=E+(P<<3)|0,a[y>>2]=N,a[y+4>>2]=Q,!(dr(N,Q)|0))y=P+1|0;else{y=9;break e}else y=P;if(R=R+1|0,(R|0)>=(v|0))break;P=y}else for(O=Re,Q=a[P>>2]|0,N=0,P=y,R=a[O>>2]|0,O=a[O+4>>2]|0;;){if(y=Fe(R,O,Q,$e,Re)|0,y|0)break e;if(O=Re,R=a[O>>2]|0,O=a[O+4>>2]|0,y=E+(P<<3)|0,a[y>>2]=R,a[y+4>>2]=O,y=P+1|0,dr(R,O)|0){y=9;break e}if(N=N+1|0,(N|0)>=(v|0))break;P=y}J=J+1|0}while(J>>>0<6);y=Re,O=de,P=a[y>>2]|0,R=m,y=a[y+4>>2]|0}else O=de,P=de,R=m,y=m}else O=E,a[O>>2]=y,a[O+4>>2]=m,O=y,P=y,R=m,y=m;y=(O|0)==(P|0)&(R|0)==(y|0)?0:9}while(0);return $e=y,we=Be,$e|0}function Qt(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0;if(N=we,we=we+48|0,P=N+16|0,R=N+8|0,O=N,v|0)return O=15,we=N,O|0;if(J=y,Q=a[J+4>>2]|0,v=R,a[v>>2]=a[J>>2],a[v+4>>2]=Q,xo(R,P),m=lc(P,m,O)|0,!m){if(v=a[R>>2]|0,R=a[y+8>>2]|0,(R|0)>0){P=a[y+12>>2]|0,m=0;do v=(a[P+(m<<3)>>2]|0)+v|0,m=m+1|0;while((m|0)<(R|0))}m=O,P=a[m>>2]|0,m=a[m+4>>2]|0,R=((v|0)<0)<<31>>31,(m|0)<(R|0)|(m|0)==(R|0)&P>>>0<v>>>0?(m=O,a[m>>2]=v,a[m+4>>2]=R,m=R):v=P,Q=d(v|0,m|0,12,0)|0,J=Me()|0,m=O,a[m>>2]=Q,a[m+4>>2]=J,m=E,a[m>>2]=Q,a[m+4>>2]=J,m=0}return J=m,we=N,J|0}function Ln(y,m,v,E,P,R,O){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0,R=R|0,O=O|0;var N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0,Je=0,Gt=0,zt=0,dt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,sr=0,In=0,vr=0,Qr=0,Xa=0;if(sr=we,we=we+64|0,mn=sr+48|0,_n=sr+32|0,En=sr+24|0,Gt=sr+8|0,zt=sr,Q=a[y>>2]|0,(Q|0)<=0)return Dn=0,we=sr,Dn|0;for(dt=y+4|0,vt=mn+8|0,Pn=_n+8|0,wn=Gt+8|0,N=0,st=0;;){J=a[dt>>2]|0,it=J+(st<<4)|0,a[mn>>2]=a[it>>2],a[mn+4>>2]=a[it+4>>2],a[mn+8>>2]=a[it+8>>2],a[mn+12>>2]=a[it+12>>2],(st|0)==(Q+-1|0)?(a[_n>>2]=a[J>>2],a[_n+4>>2]=a[J+4>>2],a[_n+8>>2]=a[J+8>>2],a[_n+12>>2]=a[J+12>>2]):(it=J+(st+1<<4)|0,a[_n>>2]=a[it>>2],a[_n+4>>2]=a[it+4>>2],a[_n+8>>2]=a[it+8>>2],a[_n+12>>2]=a[it+12>>2]),Q=_l(mn,_n,E,En)|0;e:do if(Q)J=0,N=Q;else if(J=En,Q=a[J>>2]|0,J=a[J+4>>2]|0,(J|0)>0|(J|0)==0&Q>>>0>0){ut=0,it=0;t:for(;;){if(Xa=+G[mn>>3],ht=x(Q|0,J|0,ut|0,it|0)|0,Qr=+(ht>>>0)+4294967296*+(Me()|0),In=+(Q>>>0)+4294967296*+(J|0),vr=+(ut>>>0)+4294967296*+(it|0),G[Gt>>3]=Xa*Qr/In+ +G[_n>>3]*vr/In,G[wn>>3]=+G[vt>>3]*Qr/In+ +G[Pn>>3]*vr/In,Q=ls(Gt,E,zt)|0,Q|0){N=Q;break}ht=zt,Xe=a[ht>>2]|0,ht=a[ht+4>>2]|0,Re=Y(Xe|0,ht|0,m|0,v|0)|0,le=Me()|0,Q=O+(Re<<3)|0,de=Q,J=a[de>>2]|0,de=a[de+4>>2]|0;n:do if((J|0)==0&(de|0)==0)Je=Q,Dn=16;else for($e=0,Be=0;;){if(($e|0)>(v|0)|($e|0)==(v|0)&Be>>>0>m>>>0){N=1;break t}if((J|0)==(Xe|0)&(de|0)==(ht|0))break n;if(Q=d(Re|0,le|0,1,0)|0,Re=j(Q|0,Me()|0,m|0,v|0)|0,le=Me()|0,Be=d(Be|0,$e|0,1,0)|0,$e=Me()|0,Q=O+(Re<<3)|0,de=Q,J=a[de>>2]|0,de=a[de+4>>2]|0,(J|0)==0&(de|0)==0){Je=Q,Dn=16;break}}while(0);if((Dn|0)==16&&(Dn=0,!((Xe|0)==0&(ht|0)==0))&&(Be=Je,a[Be>>2]=Xe,a[Be+4>>2]=ht,Be=R+(a[P>>2]<<3)|0,a[Be>>2]=Xe,a[Be+4>>2]=ht,Be=P,Be=d(a[Be>>2]|0,a[Be+4>>2]|0,1,0)|0,Xe=Me()|0,ht=P,a[ht>>2]=Be,a[ht+4>>2]=Xe),ut=d(ut|0,it|0,1,0)|0,it=Me()|0,J=En,Q=a[J>>2]|0,J=a[J+4>>2]|0,!((J|0)>(it|0)|(J|0)==(it|0)&Q>>>0>ut>>>0)){J=1;break e}}J=0}else J=1;while(0);if(st=st+1|0,!J){Dn=21;break}if(Q=a[y>>2]|0,(st|0)>=(Q|0)){N=0,Dn=21;break}}return(Dn|0)==21?(we=sr,N|0):0}function Mr(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0,Je=0,Gt=0,zt=0,dt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,sr=0,In=0,vr=0,Qr=0;if(Qr=we,we=we+112|0,Dn=Qr+80|0,Q=Qr+72|0,sr=Qr,In=Qr+56|0,v|0)return vr=15,we=Qr,vr|0;if(J=y+8|0,vr=_((a[J>>2]<<5)+32|0)|0,!vr)return vr=13,we=Qr,vr|0;if(cu(y,vr),_n=y,En=a[_n+4>>2]|0,v=Q,a[v>>2]=a[_n>>2],a[v+4>>2]=En,xo(Q,Dn),v=lc(Dn,m,sr)|0,v)_n=0,En=0;else{if(v=a[Q>>2]|0,R=a[J>>2]|0,(R|0)>0){O=a[y+12>>2]|0,P=0;do v=(a[O+(P<<3)>>2]|0)+v|0,P=P+1|0;while((P|0)!=(R|0));P=v}else P=v;v=sr,R=a[v>>2]|0,v=a[v+4>>2]|0,O=((P|0)<0)<<31>>31,(v|0)<(O|0)|(v|0)==(O|0)&R>>>0<P>>>0?(v=sr,a[v>>2]=P,a[v+4>>2]=O,v=O):P=R,_n=d(P|0,v|0,12,0)|0,En=Me()|0,v=sr,a[v>>2]=_n,a[v+4>>2]=En,v=0}if(v|0)return l(vr),vr=v,we=Qr,vr|0;if(P=h(_n,8)|0,!P)return l(vr),vr=13,we=Qr,vr|0;if(N=h(_n,8)|0,!N)return l(vr),l(P),vr=13,we=Qr,vr|0;wn=Dn,a[wn>>2]=0,a[wn+4>>2]=0,wn=y,mn=a[wn+4>>2]|0,v=Q,a[v>>2]=a[wn>>2],a[v+4>>2]=mn,v=Ln(Q,_n,En,m,Dn,P,N)|0;e:do if(v)l(P),l(N),l(vr);else{t:do if((a[J>>2]|0)>0){for(O=y+12|0,R=0;v=Ln((a[O>>2]|0)+(R<<3)|0,_n,En,m,Dn,P,N)|0,R=R+1|0,!(v|0);)if((R|0)>=(a[J>>2]|0))break t;l(P),l(N),l(vr);break e}while(0);(En|0)>0|(En|0)==0&_n>>>0>0&&Te(N|0,0,_n<<3|0)|0,mn=Dn,wn=a[mn+4>>2]|0;t:do if((wn|0)>0|(wn|0)==0&(a[mn>>2]|0)>>>0>0){dt=P,vt=N,Pn=P,wn=N,mn=P,v=P,Je=P,Gt=N,zt=N,P=N;n:for(;;){for(ht=0,ut=0,it=0,st=0,R=0,O=0;;){N=sr,Q=N+56|0;do a[N>>2]=0,N=N+4|0;while((N|0)<(Q|0));if(m=dt+(ht<<3)|0,J=a[m>>2]|0,m=a[m+4>>2]|0,ge(J,m,1,sr,0)|0){N=sr,Q=N+56|0;do a[N>>2]=0,N=N+4|0;while((N|0)<(Q|0));N=h(7,4)|0,N|0&&(Ee(J,m,1,sr,N,7,0,0)|0,l(N))}for(Xe=0;;){Be=sr+(Xe<<3)|0,$e=a[Be>>2]|0,Be=a[Be+4>>2]|0;r:do if(($e|0)==0&(Be|0)==0)N=R,Q=O;else{if(le=Y($e|0,Be|0,_n|0,En|0)|0,J=Me()|0,N=E+(le<<3)|0,m=N,Q=a[m>>2]|0,m=a[m+4>>2]|0,!((Q|0)==0&(m|0)==0)){de=0,Re=0;do{if((de|0)>(En|0)|(de|0)==(En|0)&Re>>>0>_n>>>0)break n;if((Q|0)==($e|0)&(m|0)==(Be|0)){N=R,Q=O;break r}N=d(le|0,J|0,1,0)|0,le=j(N|0,Me()|0,_n|0,En|0)|0,J=Me()|0,Re=d(Re|0,de|0,1,0)|0,de=Me()|0,N=E+(le<<3)|0,m=N,Q=a[m>>2]|0,m=a[m+4>>2]|0}while(!((Q|0)==0&(m|0)==0))}($e|0)==0&(Be|0)==0?(N=R,Q=O):(_o($e,Be,In)|0,ya(y,vr,In)|0&&(Re=d(R|0,O|0,1,0)|0,O=Me()|0,de=N,a[de>>2]=$e,a[de+4>>2]=Be,R=vt+(R<<3)|0,a[R>>2]=$e,a[R+4>>2]=Be,R=Re),N=R,Q=O)}while(0);if(Xe=Xe+1|0,Xe>>>0>=7)break;R=N,O=Q}if(ht=d(ht|0,ut|0,1,0)|0,ut=Me()|0,it=d(it|0,st|0,1,0)|0,st=Me()|0,O=Dn,R=a[O>>2]|0,O=a[O+4>>2]|0,(st|0)<(O|0)|(st|0)==(O|0)&it>>>0<R>>>0)R=N,O=Q;else break}if((O|0)>0|(O|0)==0&R>>>0>0){R=0,O=0;do st=dt+(R<<3)|0,a[st>>2]=0,a[st+4>>2]=0,R=d(R|0,O|0,1,0)|0,O=Me()|0,st=Dn,it=a[st+4>>2]|0;while((O|0)<(it|0)|((O|0)==(it|0)?R>>>0<(a[st>>2]|0)>>>0:0))}if(st=Dn,a[st>>2]=N,a[st+4>>2]=Q,(Q|0)>0|(Q|0)==0&N>>>0>0)Xe=P,ht=zt,ut=mn,it=Gt,st=vt,P=Je,zt=v,Gt=Pn,Je=Xe,v=ht,mn=wn,wn=ut,Pn=it,vt=dt,dt=st;else break t}l(Pn),l(wn),l(vr),v=1;break e}else v=N;while(0);l(vr),l(P),l(v),v=0}while(0);return vr=v,we=Qr,vr|0}function en(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(le=we,we=we+176|0,Q=le,(m|0)<1)return js(v,0,0),J=0,we=le,J|0;for(N=y,N=ne(a[N>>2]|0,a[N+4>>2]|0,52)|0,Me()|0,js(v,(m|0)>6?m:6,N&15),N=0;E=y+(N<<3)|0,E=hi(a[E>>2]|0,a[E+4>>2]|0,Q)|0,!(E|0);){if(E=a[Q>>2]|0,(E|0)>0){O=0;do R=Q+8+(O<<4)|0,O=O+1|0,E=Q+8+(((O|0)%(E|0)|0)<<4)|0,P=Ur(v,E,R)|0,P?Mt(v,P)|0:Pt(v,R,E)|0,E=a[Q>>2]|0;while((O|0)<(E|0))}if(N=N+1|0,(N|0)>=(m|0)){E=0,J=13;break}}return(J|0)==13?(we=le,E|0):(Ts(v),J=E,we=le,J|0)}function Pr(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0;if(R=we,we=we+32|0,E=R,P=R+16|0,y=en(y,m,P)|0,y|0)return v=y,we=R,v|0;if(a[v>>2]=0,a[v+4>>2]=0,a[v+8>>2]=0,y=Hs(P)|0,y|0)do{m=Vt(v)|0;do yA(m,y)|0,O=y+16|0,a[E>>2]=a[O>>2],a[E+4>>2]=a[O+4>>2],a[E+8>>2]=a[O+8>>2],a[E+12>>2]=a[O+12>>2],Mt(P,y)|0,y=Ya(P,E)|0;while(y|0);y=Hs(P)|0}while(y|0);return Ts(P),y=_A(v)|0,y?(kl(v),O=y,we=R,O|0):(O=0,we=R,O|0)}function Gn(y){return y=y|0,y>>>0>121?(y=0,y|0):(y=a[7696+(y*28|0)+16>>2]|0,y|0)}function lA(y){return y=y|0,(y|0)==4|(y|0)==117|0}function AA(y){return y=y|0,a[11120+((a[y>>2]|0)*216|0)+((a[y+4>>2]|0)*72|0)+((a[y+8>>2]|0)*24|0)+(a[y+12>>2]<<3)>>2]|0}function uA(y){return y=y|0,a[11120+((a[y>>2]|0)*216|0)+((a[y+4>>2]|0)*72|0)+((a[y+8>>2]|0)*24|0)+(a[y+12>>2]<<3)+4>>2]|0}function QA(y,m){y=y|0,m=m|0,y=7696+(y*28|0)|0,a[m>>2]=a[y>>2],a[m+4>>2]=a[y+4>>2],a[m+8>>2]=a[y+8>>2],a[m+12>>2]=a[y+12>>2]}function qA(y,m){y=y|0,m=m|0;var v=0,E=0;if(m>>>0>20)return m=-1,m|0;do if((a[11120+(m*216|0)>>2]|0)!=(y|0))if((a[11120+(m*216|0)+8>>2]|0)!=(y|0))if((a[11120+(m*216|0)+16>>2]|0)!=(y|0))if((a[11120+(m*216|0)+24>>2]|0)!=(y|0))if((a[11120+(m*216|0)+32>>2]|0)!=(y|0))if((a[11120+(m*216|0)+40>>2]|0)!=(y|0))if((a[11120+(m*216|0)+48>>2]|0)!=(y|0))if((a[11120+(m*216|0)+56>>2]|0)!=(y|0))if((a[11120+(m*216|0)+64>>2]|0)!=(y|0))if((a[11120+(m*216|0)+72>>2]|0)!=(y|0))if((a[11120+(m*216|0)+80>>2]|0)!=(y|0))if((a[11120+(m*216|0)+88>>2]|0)!=(y|0))if((a[11120+(m*216|0)+96>>2]|0)!=(y|0))if((a[11120+(m*216|0)+104>>2]|0)!=(y|0))if((a[11120+(m*216|0)+112>>2]|0)!=(y|0))if((a[11120+(m*216|0)+120>>2]|0)!=(y|0))if((a[11120+(m*216|0)+128>>2]|0)!=(y|0))if((a[11120+(m*216|0)+136>>2]|0)==(y|0))y=2,v=1,E=2;else{if((a[11120+(m*216|0)+144>>2]|0)==(y|0)){y=0,v=2,E=0;break}if((a[11120+(m*216|0)+152>>2]|0)==(y|0)){y=0,v=2,E=1;break}if((a[11120+(m*216|0)+160>>2]|0)==(y|0)){y=0,v=2,E=2;break}if((a[11120+(m*216|0)+168>>2]|0)==(y|0)){y=1,v=2,E=0;break}if((a[11120+(m*216|0)+176>>2]|0)==(y|0)){y=1,v=2,E=1;break}if((a[11120+(m*216|0)+184>>2]|0)==(y|0)){y=1,v=2,E=2;break}if((a[11120+(m*216|0)+192>>2]|0)==(y|0)){y=2,v=2,E=0;break}if((a[11120+(m*216|0)+200>>2]|0)==(y|0)){y=2,v=2,E=1;break}if((a[11120+(m*216|0)+208>>2]|0)==(y|0)){y=2,v=2,E=2;break}else y=-1;return y|0}else y=2,v=1,E=1;else y=2,v=1,E=0;else y=1,v=1,E=2;else y=1,v=1,E=1;else y=1,v=1,E=0;else y=0,v=1,E=2;else y=0,v=1,E=1;else y=0,v=1,E=0;else y=2,v=0,E=2;else y=2,v=0,E=1;else y=2,v=0,E=0;else y=1,v=0,E=2;else y=1,v=0,E=1;else y=1,v=0,E=0;else y=0,v=0,E=2;else y=0,v=0,E=1;else y=0,v=0,E=0;while(0);return m=a[11120+(m*216|0)+(v*72|0)+(y*24|0)+(E<<3)+4>>2]|0,m|0}function cA(y,m){return y=y|0,m=m|0,(a[7696+(y*28|0)+20>>2]|0)==(m|0)?(m=1,m|0):(m=(a[7696+(y*28|0)+24>>2]|0)==(m|0),m|0)}function ml(y,m){return y=y|0,m=m|0,a[848+(y*28|0)+(m<<2)>>2]|0}function yl(y,m){return y=y|0,m=m|0,(a[848+(y*28|0)>>2]|0)==(m|0)?(m=0,m|0):(a[848+(y*28|0)+4>>2]|0)==(m|0)?(m=1,m|0):(a[848+(y*28|0)+8>>2]|0)==(m|0)?(m=2,m|0):(a[848+(y*28|0)+12>>2]|0)==(m|0)?(m=3,m|0):(a[848+(y*28|0)+16>>2]|0)==(m|0)?(m=4,m|0):(a[848+(y*28|0)+20>>2]|0)==(m|0)?(m=5,m|0):((a[848+(y*28|0)+24>>2]|0)==(m|0)?6:7)|0}function hA(){return 122}function fA(y){y=y|0;var m=0,v=0,E=0;m=0;do ue(m|0,0,45)|0,E=Me()|0|134225919,v=y+(m<<3)|0,a[v>>2]=-1,a[v+4>>2]=E,m=m+1|0;while((m|0)!=122);return 0}function Yn(y){return y=y|0,+G[y+16>>3]<+G[y+24>>3]|0}function ZA(y,m){y=y|0,m=m|0;var v=0,E=0,P=0;return v=+G[m>>3],!(v>=+G[y+8>>3])||!(v<=+G[y>>3])?(m=0,m|0):(E=+G[y+16>>3],v=+G[y+24>>3],P=+G[m+8>>3],m=P>=v,y=P<=E&1,E<v?m&&(y=1):m||(y=0),m=(y|0)!=0,m|0)}function lc(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0;Be=we,we=we+288|0,le=Be+264|0,de=Be+96|0,J=Be,N=J,Q=N+96|0;do a[N>>2]=0,N=N+4|0;while((N|0)<(Q|0));return m=Vs(m,J)|0,m|0?($e=m,we=Be,$e|0):(Q=J,J=a[Q>>2]|0,Q=a[Q+4>>2]|0,_o(J,Q,le)|0,hi(J,Q,de)|0,O=+Pl(le,de+8|0),G[le>>3]=+G[y>>3],Q=le+8|0,G[Q>>3]=+G[y+16>>3],G[de>>3]=+G[y+8>>3],J=de+8|0,G[J>>3]=+G[y+24>>3],P=+Pl(le,de),ht=+G[Q>>3]-+G[J>>3],R=+ke(+ht),Xe=+G[le>>3]-+G[de>>3],E=+ke(+Xe),!(ht==0|Xe==0)&&(ht=+be(+R,+E),ht=+qt(+(P*P/+Ce(+(ht/+Ce(+R,+E)),3)/(O*(O*2.59807621135)*.8))),G[Le>>3]=ht,Re=~~ht>>>0,$e=+ke(ht)>=1?ht>0?~~+xn(+Pe(ht/4294967296),4294967295)>>>0:~~+qt((ht-+(~~ht>>>0))/4294967296)>>>0:0,(a[Le+4>>2]&2146435072|0)!=2146435072)?(de=(Re|0)==0&($e|0)==0,m=v,a[m>>2]=de?1:Re,a[m+4>>2]=de?0:$e,m=0):m=1,$e=m,we=Be,$e|0)}function _l(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0,le=0;J=we,we=we+288|0,O=J+264|0,N=J+96|0,Q=J,P=Q,R=P+96|0;do a[P>>2]=0,P=P+4|0;while((P|0)<(R|0));return v=Vs(v,Q)|0,v|0?(E=v,we=J,E|0):(v=Q,P=a[v>>2]|0,v=a[v+4>>2]|0,_o(P,v,O)|0,hi(P,v,N)|0,le=+Pl(O,N+8|0),le=+qt(+(+Pl(y,m)/(le*2))),G[Le>>3]=le,v=~~le>>>0,P=+ke(le)>=1?le>0?~~+xn(+Pe(le/4294967296),4294967295)>>>0:~~+qt((le-+(~~le>>>0))/4294967296)>>>0:0,(a[Le+4>>2]&2146435072|0)==2146435072?(E=1,we=J,E|0):(Q=(v|0)==0&(P|0)==0,a[E>>2]=Q?1:v,a[E+4>>2]=Q?0:P,E=0,we=J,E|0))}function Hr(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0,a[y>>2]=m,a[y+4>>2]=v,a[y+8>>2]=E}function No(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;de=m+8|0,a[de>>2]=0,Q=+G[y>>3],O=+ke(+Q),J=+G[y+8>>3],N=+ke(+J)/.8660254037844386,O=O+N*.5,v=~~O,y=~~N,O=O-+(v|0),N=N-+(y|0);do if(O<.5)if(O<.3333333333333333)if(a[m>>2]=v,N<(O+1)*.5){a[m+4>>2]=y;break}else{y=y+1|0,a[m+4>>2]=y;break}else if(Re=1-O,y=(!(N<Re)&1)+y|0,a[m+4>>2]=y,Re<=N&N<O*2){v=v+1|0,a[m>>2]=v;break}else{a[m>>2]=v;break}else{if(!(O<.6666666666666666))if(v=v+1|0,a[m>>2]=v,N<O*.5){a[m+4>>2]=y;break}else{y=y+1|0,a[m+4>>2]=y;break}if(N<1-O){if(a[m+4>>2]=y,O*2+-1<N){a[m>>2]=v;break}}else y=y+1|0,a[m+4>>2]=y;v=v+1|0,a[m>>2]=v}while(0);do if(Q<0)if(y&1){le=(y+1|0)/2|0,le=x(v|0,((v|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-((+(le>>>0)+4294967296*+(Me()|0))*2+1)),a[m>>2]=v;break}else{le=(y|0)/2|0,le=x(v|0,((v|0)<0)<<31>>31|0,le|0,((le|0)<0)<<31>>31|0)|0,v=~~(+(v|0)-(+(le>>>0)+4294967296*+(Me()|0))*2),a[m>>2]=v;break}while(0);le=m+4|0,J<0&&(v=v-((y<<1|1|0)/2|0)|0,a[m>>2]=v,y=0-y|0,a[le>>2]=y),E=y-v|0,(v|0)<0?(P=0-v|0,a[le>>2]=E,a[de>>2]=P,a[m>>2]=0,y=E,v=0):P=0,(y|0)<0&&(v=v-y|0,a[m>>2]=v,P=P-y|0,a[de>>2]=P,a[le>>2]=0,y=0),R=v-P|0,E=y-P|0,(P|0)<0&&(a[m>>2]=R,a[le>>2]=E,a[de>>2]=0,y=E,v=R,P=0),E=(y|0)<(v|0)?y:v,E=(P|0)<(E|0)?P:E,!((E|0)<=0)&&(a[m>>2]=v-E,a[le>>2]=y-E,a[de>>2]=P-E)}function zn(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0;m=a[y>>2]|0,O=y+4|0,v=a[O>>2]|0,(m|0)<0&&(v=v-m|0,a[O>>2]=v,R=y+8|0,a[R>>2]=(a[R>>2]|0)-m,a[y>>2]=0,m=0),(v|0)<0?(m=m-v|0,a[y>>2]=m,R=y+8|0,P=(a[R>>2]|0)-v|0,a[R>>2]=P,a[O>>2]=0,v=0):(P=y+8|0,R=P,P=a[P>>2]|0),(P|0)<0&&(m=m-P|0,a[y>>2]=m,v=v-P|0,a[O>>2]=v,a[R>>2]=0,P=0),E=(v|0)<(m|0)?v:m,E=(P|0)<(E|0)?P:E,!((E|0)<=0)&&(a[y>>2]=m-E,a[O>>2]=v-E,a[R>>2]=P-E)}function bs(y,m){y=y|0,m=m|0;var v=0,E=0;E=a[y+8>>2]|0,v=+((a[y+4>>2]|0)-E|0),G[m>>3]=+((a[y>>2]|0)-E|0)-v*.5,G[m+8>>3]=v*.8660254037844386}function ei(y,m,v){y=y|0,m=m|0,v=v|0,a[v>>2]=(a[m>>2]|0)+(a[y>>2]|0),a[v+4>>2]=(a[m+4>>2]|0)+(a[y+4>>2]|0),a[v+8>>2]=(a[m+8>>2]|0)+(a[y+8>>2]|0)}function po(y,m,v){y=y|0,m=m|0,v=v|0,a[v>>2]=(a[y>>2]|0)-(a[m>>2]|0),a[v+4>>2]=(a[y+4>>2]|0)-(a[m+4>>2]|0),a[v+8>>2]=(a[y+8>>2]|0)-(a[m+8>>2]|0)}function vl(y,m){y=y|0,m=m|0;var v=0,E=0;v=an(a[y>>2]|0,m)|0,a[y>>2]=v,v=y+4|0,E=an(a[v>>2]|0,m)|0,a[v>>2]=E,y=y+8|0,m=an(a[y>>2]|0,m)|0,a[y>>2]=m}function Uo(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;O=a[y>>2]|0,N=(O|0)<0,E=(a[y+4>>2]|0)-(N?O:0)|0,R=(E|0)<0,P=(R?0-E|0:0)+((a[y+8>>2]|0)-(N?O:0))|0,v=(P|0)<0,y=v?0:P,m=(R?0:E)-(v?P:0)|0,P=(N?0:O)-(R?E:0)-(v?P:0)|0,v=(m|0)<(P|0)?m:P,v=(y|0)<(v|0)?y:v,E=(v|0)>0,y=y-(E?v:0)|0,m=m-(E?v:0)|0;e:do switch(P-(E?v:0)|0){case 0:switch(m|0){case 0:return N=y|0?(y|0)==1?1:7:0,N|0;case 1:return N=y|0?(y|0)==1?3:7:2,N|0;default:break e}case 1:switch(m|0){case 0:return N=y|0?(y|0)==1?5:7:4,N|0;case 1:{if(!y)y=6;else break e;return y|0}default:break e}}while(0);return N=7,N|0}function ua(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;O=y+8|0,P=a[O>>2]|0,R=(a[y>>2]|0)-P|0,N=y+4|0,P=(a[N>>2]|0)-P|0;do if(R>>>0>715827881|P>>>0>715827881){if(v=(R|0)>0,v){if((2147483647-R|0)<(R|0)||(2147483647-(R<<1)|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0)||(-2147483648-(R<<1)|0)>(R|0))return N=1,N|0;if(m=R*3|0,(P|0)>0){if((2147483647-P|0)<(P|0))return N=1,N|0}else if((-2147483648-P|0)>(P|0))return N=1,N|0;if(E=P<<1,(R|0)>-1){if((m|-2147483648|0)>=(P|0))return N=1,N|0}else if((m^-2147483648|0)<(P|0))return N=1,N|0;if(v){if((2147483647-R|0)<(E|0))m=1;else{v=E;break}return m|0}else{if((-2147483648-R|0)>(E|0))m=1;else{v=E;break}return m|0}}else v=P<<1,m=R*3|0;while(0);E=c(+(m-P|0)/7)|0,a[y>>2]=E,P=c(+(v+R|0)/7)|0,a[N>>2]=P,a[O>>2]=0,v=(P|0)<(E|0),m=v?E:P,v=v?P:E;do if((v|0)<0){if((m|0)>0){if((m|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-m|0)>=(v|0)))break;un(23313,22444,355,22455)}if((v|0)==-2147483648|(-2147483648-m|0)>(v|0)&&un(23313,22444,355,22455),(m|0)>-1){if((m|-2147483648|0)<(v|0))break;un(23313,22444,355,22455)}else{if((m^-2147483648|0)>=(v|0))break;un(23313,22444,355,22455)}}while(0);return m=P-E|0,(E|0)<0?(v=0-E|0,a[N>>2]=m,a[O>>2]=v,a[y>>2]=0,E=0):(m=P,v=0),(m|0)<0&&(E=E-m|0,a[y>>2]=E,v=v-m|0,a[O>>2]=v,a[N>>2]=0,m=0),R=E-v|0,P=m-v|0,(v|0)<0?(a[y>>2]=R,a[N>>2]=P,a[O>>2]=0,m=P,P=R,v=0):P=E,E=(m|0)<(P|0)?m:P,E=(v|0)<(E|0)?v:E,(E|0)<=0?(N=0,N|0):(a[y>>2]=P-E,a[N>>2]=m-E,a[O>>2]=v-E,N=0,N|0)}function go(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;O=y+8|0,P=a[O>>2]|0,R=(a[y>>2]|0)-P|0,N=y+4|0,P=(a[N>>2]|0)-P|0;do if(R>>>0>715827881|P>>>0>715827881){if(v=(R|0)>0,v){if((2147483647-R|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0))return N=1,N|0;if(m=R<<1,(P|0)>0){if((2147483647-P|0)<(P|0)||(2147483647-(P<<1)|0)<(P|0))return N=1,N|0}else if((-2147483648-P|0)>(P|0)||(-2147483648-(P<<1)|0)>(P|0))return N=1,N|0;if(E=P*3|0,v){if((2147483647-m|0)<(P|0))return N=1,N|0}else if((-2147483648-m|0)>(P|0))return N=1,N|0;if((P|0)>-1){if((E|-2147483648|0)<(R|0)){v=E;break}else m=1;return m|0}else{if((E^-2147483648|0)<(R|0))m=1;else{v=E;break}return m|0}}else v=P*3|0,m=R<<1;while(0);E=c(+(m+P|0)/7)|0,a[y>>2]=E,P=c(+(v-R|0)/7)|0,a[N>>2]=P,a[O>>2]=0,v=(P|0)<(E|0),m=v?E:P,v=v?P:E;do if((v|0)<0){if((m|0)>0){if((m|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-m|0)>=(v|0)))break;un(23313,22444,404,22469)}if((v|0)==-2147483648|(-2147483648-m|0)>(v|0)&&un(23313,22444,404,22469),(m|0)>-1){if((m|-2147483648|0)<(v|0))break;un(23313,22444,404,22469)}else{if((m^-2147483648|0)>=(v|0))break;un(23313,22444,404,22469)}}while(0);return m=P-E|0,(E|0)<0?(v=0-E|0,a[N>>2]=m,a[O>>2]=v,a[y>>2]=0,E=0):(m=P,v=0),(m|0)<0&&(E=E-m|0,a[y>>2]=E,v=v-m|0,a[O>>2]=v,a[N>>2]=0,m=0),R=E-v|0,P=m-v|0,(v|0)<0?(a[y>>2]=R,a[N>>2]=P,a[O>>2]=0,m=P,P=R,v=0):P=E,E=(m|0)<(P|0)?m:P,E=(v|0)<(E|0)?v:E,(E|0)<=0?(N=0,N|0):(a[y>>2]=P-E,a[N>>2]=m-E,a[O>>2]=v-E,N=0,N|0)}function dA(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;O=y+8|0,v=a[O>>2]|0,m=(a[y>>2]|0)-v|0,N=y+4|0,v=(a[N>>2]|0)-v|0,E=c(+((m*3|0)-v|0)/7)|0,a[y>>2]=E,m=c(+((v<<1)+m|0)/7)|0,a[N>>2]=m,a[O>>2]=0,v=m-E|0,(E|0)<0?(R=0-E|0,a[N>>2]=v,a[O>>2]=R,a[y>>2]=0,m=v,E=0,v=R):v=0,(m|0)<0&&(E=E-m|0,a[y>>2]=E,v=v-m|0,a[O>>2]=v,a[N>>2]=0,m=0),R=E-v|0,P=m-v|0,(v|0)<0?(a[y>>2]=R,a[N>>2]=P,a[O>>2]=0,m=P,P=R,v=0):P=E,E=(m|0)<(P|0)?m:P,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(a[y>>2]=P-E,a[N>>2]=m-E,a[O>>2]=v-E)}function Na(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;O=y+8|0,v=a[O>>2]|0,m=(a[y>>2]|0)-v|0,N=y+4|0,v=(a[N>>2]|0)-v|0,E=c(+((m<<1)+v|0)/7)|0,a[y>>2]=E,m=c(+((v*3|0)-m|0)/7)|0,a[N>>2]=m,a[O>>2]=0,v=m-E|0,(E|0)<0?(R=0-E|0,a[N>>2]=v,a[O>>2]=R,a[y>>2]=0,m=v,E=0,v=R):v=0,(m|0)<0&&(E=E-m|0,a[y>>2]=E,v=v-m|0,a[O>>2]=v,a[N>>2]=0,m=0),R=E-v|0,P=m-v|0,(v|0)<0?(a[y>>2]=R,a[N>>2]=P,a[O>>2]=0,m=P,P=R,v=0):P=E,E=(m|0)<(P|0)?m:P,E=(v|0)<(E|0)?v:E,!((E|0)<=0)&&(a[y>>2]=P-E,a[N>>2]=m-E,a[O>>2]=v-E)}function Vo(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;m=a[y>>2]|0,O=y+4|0,v=a[O>>2]|0,N=y+8|0,E=a[N>>2]|0,P=v+(m*3|0)|0,a[y>>2]=P,v=E+(v*3|0)|0,a[O>>2]=v,m=(E*3|0)+m|0,a[N>>2]=m,E=v-P|0,(P|0)<0?(m=m-P|0,a[O>>2]=E,a[N>>2]=m,a[y>>2]=0,v=E,E=0):E=P,(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=E-m|0,P=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=P,a[N>>2]=0,E=R,m=0):P=v,v=(P|0)<(E|0)?P:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[O>>2]=P-v,a[N>>2]=m-v)}function Gi(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;P=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,N=y+8|0,v=a[N>>2]|0,E=(m*3|0)+P|0,P=v+(P*3|0)|0,a[y>>2]=P,a[O>>2]=E,m=(v*3|0)+m|0,a[N>>2]=m,v=E-P|0,(P|0)<0?(m=m-P|0,a[O>>2]=v,a[N>>2]=m,a[y>>2]=0,P=0):v=E,(v|0)<0&&(P=P-v|0,a[y>>2]=P,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=P-m|0,E=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=E,a[N>>2]=0,P=R,m=0):E=v,v=(E|0)<(P|0)?E:P,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=P-v,a[O>>2]=E-v,a[N>>2]=m-v)}function $i(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0;(m+-1|0)>>>0>=6||(P=(a[15440+(m*12|0)>>2]|0)+(a[y>>2]|0)|0,a[y>>2]=P,N=y+4|0,E=(a[15440+(m*12|0)+4>>2]|0)+(a[N>>2]|0)|0,a[N>>2]=E,O=y+8|0,m=(a[15440+(m*12|0)+8>>2]|0)+(a[O>>2]|0)|0,a[O>>2]=m,v=E-P|0,(P|0)<0?(m=m-P|0,a[N>>2]=v,a[O>>2]=m,a[y>>2]=0,E=0):(v=E,E=P),(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[O>>2]=m,a[N>>2]=0,v=0),R=E-m|0,P=v-m|0,(m|0)<0?(a[y>>2]=R,a[N>>2]=P,a[O>>2]=0,E=R,m=0):P=v,v=(P|0)<(E|0)?P:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[N>>2]=P-v,a[O>>2]=m-v))}function YA(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;P=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,N=y+8|0,v=a[N>>2]|0,E=m+P|0,P=v+P|0,a[y>>2]=P,a[O>>2]=E,m=v+m|0,a[N>>2]=m,v=E-P|0,(P|0)<0?(m=m-P|0,a[O>>2]=v,a[N>>2]=m,a[y>>2]=0,E=0):(v=E,E=P),(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=E-m|0,P=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=P,a[N>>2]=0,E=R,m=0):P=v,v=(P|0)<(E|0)?P:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[O>>2]=P-v,a[N>>2]=m-v)}function xl(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;m=a[y>>2]|0,O=y+4|0,E=a[O>>2]|0,N=y+8|0,v=a[N>>2]|0,P=E+m|0,a[y>>2]=P,E=v+E|0,a[O>>2]=E,m=v+m|0,a[N>>2]=m,v=E-P|0,(P|0)<0?(m=m-P|0,a[O>>2]=v,a[N>>2]=m,a[y>>2]=0,E=0):(v=E,E=P),(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=E-m|0,P=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=P,a[N>>2]=0,E=R,m=0):P=v,v=(P|0)<(E|0)?P:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[O>>2]=P-v,a[N>>2]=m-v)}function mo(y){switch(y=y|0,y|0){case 1:{y=5;break}case 5:{y=4;break}case 4:{y=6;break}case 6:{y=2;break}case 2:{y=3;break}case 3:{y=1;break}}return y|0}function Go(y){switch(y=y|0,y|0){case 1:{y=3;break}case 3:{y=2;break}case 2:{y=6;break}case 6:{y=4;break}case 4:{y=5;break}case 5:{y=1;break}}return y|0}function Ac(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;m=a[y>>2]|0,O=y+4|0,v=a[O>>2]|0,N=y+8|0,E=a[N>>2]|0,P=v+(m<<1)|0,a[y>>2]=P,v=E+(v<<1)|0,a[O>>2]=v,m=(E<<1)+m|0,a[N>>2]=m,E=v-P|0,(P|0)<0?(m=m-P|0,a[O>>2]=E,a[N>>2]=m,a[y>>2]=0,v=E,E=0):E=P,(v|0)<0&&(E=E-v|0,a[y>>2]=E,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=E-m|0,P=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=P,a[N>>2]=0,E=R,m=0):P=v,v=(P|0)<(E|0)?P:E,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=E-v,a[O>>2]=P-v,a[N>>2]=m-v)}function XA(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;P=a[y>>2]|0,O=y+4|0,m=a[O>>2]|0,N=y+8|0,v=a[N>>2]|0,E=(m<<1)+P|0,P=v+(P<<1)|0,a[y>>2]=P,a[O>>2]=E,m=(v<<1)+m|0,a[N>>2]=m,v=E-P|0,(P|0)<0?(m=m-P|0,a[O>>2]=v,a[N>>2]=m,a[y>>2]=0,P=0):v=E,(v|0)<0&&(P=P-v|0,a[y>>2]=P,m=m-v|0,a[N>>2]=m,a[O>>2]=0,v=0),R=P-m|0,E=v-m|0,(m|0)<0?(a[y>>2]=R,a[O>>2]=E,a[N>>2]=0,P=R,m=0):E=v,v=(E|0)<(P|0)?E:P,v=(m|0)<(v|0)?m:v,!((v|0)<=0)&&(a[y>>2]=P-v,a[O>>2]=E-v,a[N>>2]=m-v)}function wl(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0;return O=(a[y>>2]|0)-(a[m>>2]|0)|0,N=(O|0)<0,E=(a[y+4>>2]|0)-(a[m+4>>2]|0)-(N?O:0)|0,R=(E|0)<0,P=(N?0-O|0:0)+(a[y+8>>2]|0)-(a[m+8>>2]|0)+(R?0-E|0:0)|0,y=(P|0)<0,m=y?0:P,v=(R?0:E)-(y?P:0)|0,P=(N?0:O)-(R?E:0)-(y?P:0)|0,y=(v|0)<(P|0)?v:P,y=(m|0)<(y|0)?m:y,E=(y|0)>0,m=m-(E?y:0)|0,v=v-(E?y:0)|0,y=P-(E?y:0)|0,y=(y|0)>-1?y:0-y|0,v=(v|0)>-1?v:0-v|0,m=(m|0)>-1?m:0-m|0,m=(v|0)>(m|0)?v:m,((y|0)>(m|0)?y:m)|0}function pA(y,m){y=y|0,m=m|0;var v=0;v=a[y+8>>2]|0,a[m>>2]=(a[y>>2]|0)-v,a[m+4>>2]=(a[y+4>>2]|0)-v}function KA(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0;E=a[y>>2]|0,a[m>>2]=E,P=a[y+4>>2]|0,O=m+4|0,a[O>>2]=P,N=m+8|0,a[N>>2]=0,v=(P|0)<(E|0),y=v?E:P,v=v?P:E;do if((v|0)<0){if((y|0)>0){if((y|-2147483648|0)<(v|0)&((v|0)!=-2147483648&(2147483647-y|0)>=(v|0)))break;return y=1,y|0}if((v|0)==-2147483648|(-2147483648-y|0)>(v|0))return m=1,m|0;if((y|0)>-1){if((y|-2147483648|0)<(v|0))break;return y=1,y|0}else{if((y^-2147483648|0)<(v|0))y=1;else break;return y|0}}while(0);return y=P-E|0,(E|0)<0?(v=0-E|0,a[O>>2]=y,a[N>>2]=v,a[m>>2]=0,E=0):(y=P,v=0),(y|0)<0&&(E=E-y|0,a[m>>2]=E,v=v-y|0,a[N>>2]=v,a[O>>2]=0,y=0),R=E-v|0,P=y-v|0,(v|0)<0?(a[m>>2]=R,a[O>>2]=P,a[N>>2]=0,y=P,P=R,v=0):P=E,E=(y|0)<(P|0)?y:P,E=(v|0)<(E|0)?v:E,(E|0)<=0?(m=0,m|0):(a[m>>2]=P-E,a[O>>2]=y-E,a[N>>2]=v-E,m=0,m|0)}function $o(y){y=y|0;var m=0,v=0,E=0,P=0;m=y+8|0,P=a[m>>2]|0,v=P-(a[y>>2]|0)|0,a[y>>2]=v,E=y+4|0,y=(a[E>>2]|0)-P|0,a[E>>2]=y,a[m>>2]=0-(y+v)}function Ua(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;v=a[y>>2]|0,m=0-v|0,a[y>>2]=m,O=y+8|0,a[O>>2]=0,N=y+4|0,E=a[N>>2]|0,P=E+v|0,(v|0)>0?(a[N>>2]=P,a[O>>2]=v,a[y>>2]=0,m=0,E=P):v=0,(E|0)<0?(R=m-E|0,a[y>>2]=R,v=v-E|0,a[O>>2]=v,a[N>>2]=0,P=R-v|0,m=0-v|0,(v|0)<0?(a[y>>2]=P,a[N>>2]=m,a[O>>2]=0,E=m,v=0):(E=0,P=R)):P=m,m=(E|0)<(P|0)?E:P,m=(v|0)<(m|0)?v:m,!((m|0)<=0)&&(a[y>>2]=P-m,a[N>>2]=E-m,a[O>>2]=v-m)}function JA(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0;if(de=we,we=we+64|0,le=de,N=de+56|0,!(!0&(m&2013265920|0)==134217728&(!0&(E&2013265920|0)==134217728)))return P=5,we=de,P|0;if((y|0)==(v|0)&(m|0)==(E|0))return a[P>>2]=0,P=0,we=de,P|0;if(O=ne(y|0,m|0,52)|0,Me()|0,O=O&15,J=ne(v|0,E|0,52)|0,Me()|0,(O|0)!=(J&15|0))return P=12,we=de,P|0;if(R=O+-1|0,O>>>0>1){Tl(y,m,R,le)|0,Tl(v,E,R,N)|0,J=le,Q=a[J>>2]|0,J=a[J+4>>2]|0;e:do if((Q|0)==(a[N>>2]|0)&&(J|0)==(a[N+4>>2]|0)){O=(O^15)*3|0,R=ne(y|0,m|0,O|0)|0,Me()|0,R=R&7,O=ne(v|0,E|0,O|0)|0,Me()|0,O=O&7;do if((R|0)==0|(O|0)==0)a[P>>2]=1,R=0;else if((R|0)==7)R=5;else{if((R|0)==1|(O|0)==1&&dr(Q,J)|0){R=5;break}if((a[15536+(R<<2)>>2]|0)!=(O|0)&&(a[15568+(R<<2)>>2]|0)!=(O|0))break e;a[P>>2]=1,R=0}while(0);return P=R,we=de,P|0}while(0)}R=le,O=R+56|0;do a[R>>2]=0,R=R+4|0;while((R|0)<(O|0));return Aa(y,m,1,le)|0,m=le,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0))&&(m=le+8|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+16|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+24|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+32|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))&&(m=le+40|0,!((a[m>>2]|0)==(v|0)&&(a[m+4>>2]|0)==(E|0)))?(R=le+48|0,R=((a[R>>2]|0)==(v|0)?(a[R+4>>2]|0)==(E|0):0)&1):R=1,a[P>>2]=R,P=0,we=de,P|0}function eu(y,m,v,E,P){return y=y|0,m=m|0,v=v|0,E=E|0,P=P|0,v=at(y,m,v,E)|0,(v|0)==7?(P=11,P|0):(E=ue(v|0,0,56)|0,m=m&-2130706433|(Me()|0)|268435456,a[P>>2]=y|E,a[P+4>>2]=m,P=0,P|0)}function yo(y,m,v){return y=y|0,m=m|0,v=v|0,!0&(m&2013265920|0)==268435456?(a[v>>2]=y,a[v+4>>2]=m&-2130706433|134217728,v=0,v|0):(v=6,v|0)}function ca(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0;return P=we,we=we+16|0,E=P,a[E>>2]=0,!0&(m&2013265920|0)==268435456?(R=ne(y|0,m|0,56)|0,Me()|0,E=Fe(y,m&-2130706433|134217728,R&7,E,v)|0,we=P,E|0):(E=6,we=P,E|0)}function tu(y,m){y=y|0,m=m|0;var v=0;switch(v=ne(y|0,m|0,56)|0,Me()|0,v&7){case 0:case 7:return v=0,v|0}return v=m&-2130706433|134217728,!(!0&(m&2013265920|0)==268435456)||!0&(m&117440512|0)==16777216&(dr(y,v)|0)!=0?(v=0,v|0):(v=fa(y,v)|0,v|0)}function ha(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0;return P=we,we=we+16|0,E=P,!0&(m&2013265920|0)==268435456?(R=m&-2130706433|134217728,O=v,a[O>>2]=y,a[O+4>>2]=R,a[E>>2]=0,m=ne(y|0,m|0,56)|0,Me()|0,E=Fe(y,R,m&7,E,v+8|0)|0,we=P,E|0):(E=6,we=P,E|0)}function cr(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0;return P=(dr(y,m)|0)==0,m=m&-2130706433,E=v,a[E>>2]=P?y:0,a[E+4>>2]=P?m|285212672:0,E=v+8|0,a[E>>2]=y,a[E+4>>2]=m|301989888,E=v+16|0,a[E>>2]=y,a[E+4>>2]=m|318767104,E=v+24|0,a[E>>2]=y,a[E+4>>2]=m|335544320,E=v+32|0,a[E>>2]=y,a[E+4>>2]=m|352321536,v=v+40|0,a[v>>2]=y,a[v+4>>2]=m|369098752,0}function Fs(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0;return O=we,we=we+16|0,P=O,R=m&-2130706433|134217728,!0&(m&2013265920|0)==268435456?(E=ne(y|0,m|0,56)|0,Me()|0,E=Yt(y,R,E&7)|0,(E|0)==-1?(a[v>>2]=0,R=6,we=O,R|0):(qi(y,R,P)|0&&un(23313,22484,282,22499),m=ne(y|0,m|0,52)|0,Me()|0,m=m&15,dr(y,R)|0?jo(P,m,E,2,v):nu(P,m,E,2,v),R=0,we=O,R|0)):(R=6,we=O,R|0)}function $n(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0;E=we,we=we+16|0,P=E,Qn(y,m,v,P),No(P,v+4|0),we=E}function Qn(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0;if(N=we,we=we+16|0,Q=N,_r(y,v,Q),R=+Rt(+(1-+G[Q>>3]*.5)),R<1e-16){a[E>>2]=0,a[E+4>>2]=0,a[E+8>>2]=0,a[E+12>>2]=0,we=N;return}if(Q=a[v>>2]|0,P=+G[15920+(Q*24|0)>>3],P=+ni(P-+ni(+pc(15600+(Q<<4)|0,y))),_i(m)|0?O=+ni(P+-.3334731722518321):O=P,P=+Dt(+R)/.381966011250105,(m|0)>0){y=0;do P=P*2.6457513110645907,y=y+1|0;while((y|0)!=(m|0))}R=+We(+O)*P,G[E>>3]=R,O=+ft(+O)*P,G[E+8>>3]=O,we=N}function _r(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0;if(R=we,we=we+32|0,P=R,Rl(y,P),a[m>>2]=0,G[v>>3]=5,E=+pr(16400,P),E<+G[v>>3]&&(a[m>>2]=0,G[v>>3]=E),E=+pr(16424,P),E<+G[v>>3]&&(a[m>>2]=1,G[v>>3]=E),E=+pr(16448,P),E<+G[v>>3]&&(a[m>>2]=2,G[v>>3]=E),E=+pr(16472,P),E<+G[v>>3]&&(a[m>>2]=3,G[v>>3]=E),E=+pr(16496,P),E<+G[v>>3]&&(a[m>>2]=4,G[v>>3]=E),E=+pr(16520,P),E<+G[v>>3]&&(a[m>>2]=5,G[v>>3]=E),E=+pr(16544,P),E<+G[v>>3]&&(a[m>>2]=6,G[v>>3]=E),E=+pr(16568,P),E<+G[v>>3]&&(a[m>>2]=7,G[v>>3]=E),E=+pr(16592,P),E<+G[v>>3]&&(a[m>>2]=8,G[v>>3]=E),E=+pr(16616,P),E<+G[v>>3]&&(a[m>>2]=9,G[v>>3]=E),E=+pr(16640,P),E<+G[v>>3]&&(a[m>>2]=10,G[v>>3]=E),E=+pr(16664,P),E<+G[v>>3]&&(a[m>>2]=11,G[v>>3]=E),E=+pr(16688,P),E<+G[v>>3]&&(a[m>>2]=12,G[v>>3]=E),E=+pr(16712,P),E<+G[v>>3]&&(a[m>>2]=13,G[v>>3]=E),E=+pr(16736,P),E<+G[v>>3]&&(a[m>>2]=14,G[v>>3]=E),E=+pr(16760,P),E<+G[v>>3]&&(a[m>>2]=15,G[v>>3]=E),E=+pr(16784,P),E<+G[v>>3]&&(a[m>>2]=16,G[v>>3]=E),E=+pr(16808,P),E<+G[v>>3]&&(a[m>>2]=17,G[v>>3]=E),E=+pr(16832,P),E<+G[v>>3]&&(a[m>>2]=18,G[v>>3]=E),E=+pr(16856,P),!(E<+G[v>>3])){we=R;return}a[m>>2]=19,G[v>>3]=E,we=R}function fr(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0;if(R=+yc(y),R<1e-16){m=15600+(m<<4)|0,a[P>>2]=a[m>>2],a[P+4>>2]=a[m+4>>2],a[P+8>>2]=a[m+8>>2],a[P+12>>2]=a[m+12>>2];return}if(O=+pn(+ +G[y+8>>3],+ +G[y>>3]),(v|0)>0){y=0;do R=R/2.6457513110645907,y=y+1|0;while((y|0)!=(v|0))}E?(R=R/3,v=(_i(v)|0)==0,R=+jt(+((v?R:R/2.6457513110645907)*.381966011250105))):(R=+jt(+(R*.381966011250105)),_i(v)|0&&(O=+ni(O+.3334731722518321))),vo(15600+(m<<4)|0,+ni(+G[15920+(m*24|0)>>3]-O),R,P)}function bl(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0;E=we,we=we+16|0,P=E,bs(y+4|0,P),fr(P,a[y>>2]|0,m,0,v),we=E}function jo(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0,Je=0,Gt=0,zt=0,dt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,sr=0,In=0;if(Dn=we,we=we+272|0,R=Dn+256|0,it=Dn+240|0,mn=Dn,_n=Dn+224|0,En=Dn+208|0,st=Dn+176|0,Je=Dn+160|0,Gt=Dn+192|0,zt=Dn+144|0,dt=Dn+128|0,vt=Dn+112|0,Pn=Dn+96|0,wn=Dn+80|0,a[R>>2]=m,a[it>>2]=a[y>>2],a[it+4>>2]=a[y+4>>2],a[it+8>>2]=a[y+8>>2],a[it+12>>2]=a[y+12>>2],uc(it,R,mn),a[P>>2]=0,it=E+v+((E|0)==5&1)|0,(it|0)<=(v|0)){we=Dn;return}Q=a[R>>2]|0,J=_n+4|0,le=st+4|0,de=v+5|0,Re=16880+(Q<<2)|0,$e=16960+(Q<<2)|0,Be=dt+8|0,Xe=vt+8|0,ht=Pn+8|0,ut=En+4|0,N=v;e:for(;;){O=mn+(((N|0)%5|0)<<4)|0,a[En>>2]=a[O>>2],a[En+4>>2]=a[O+4>>2],a[En+8>>2]=a[O+8>>2],a[En+12>>2]=a[O+12>>2];do;while((Va(En,Q,0,1)|0)==2);if((N|0)>(v|0)&(_i(m)|0)!=0){if(a[st>>2]=a[En>>2],a[st+4>>2]=a[En+4>>2],a[st+8>>2]=a[En+8>>2],a[st+12>>2]=a[En+12>>2],bs(J,Je),E=a[st>>2]|0,R=a[17040+(E*80|0)+(a[_n>>2]<<2)>>2]|0,a[st>>2]=a[18640+(E*80|0)+(R*20|0)>>2],O=a[18640+(E*80|0)+(R*20|0)+16>>2]|0,(O|0)>0){y=0;do YA(le),y=y+1|0;while((y|0)<(O|0))}switch(O=18640+(E*80|0)+(R*20|0)+4|0,a[Gt>>2]=a[O>>2],a[Gt+4>>2]=a[O+4>>2],a[Gt+8>>2]=a[O+8>>2],vl(Gt,(a[Re>>2]|0)*3|0),ei(le,Gt,le),zn(le),bs(le,zt),sr=+(a[$e>>2]|0),G[dt>>3]=sr*3,G[Be>>3]=0,In=sr*-1.5,G[vt>>3]=In,G[Xe>>3]=sr*2.598076211353316,G[Pn>>3]=In,G[ht>>3]=sr*-2.598076211353316,a[17040+((a[st>>2]|0)*80|0)+(a[En>>2]<<2)>>2]|0){case 1:{y=vt,E=dt;break}case 3:{y=Pn,E=vt;break}case 2:{y=dt,E=Pn;break}default:{y=12;break e}}fu(Je,zt,E,y,wn),fr(wn,a[st>>2]|0,Q,1,P+8+(a[P>>2]<<4)|0),a[P>>2]=(a[P>>2]|0)+1}if((N|0)<(de|0)&&(bs(ut,st),fr(st,a[En>>2]|0,Q,1,P+8+(a[P>>2]<<4)|0),a[P>>2]=(a[P>>2]|0)+1),a[_n>>2]=a[En>>2],a[_n+4>>2]=a[En+4>>2],a[_n+8>>2]=a[En+8>>2],a[_n+12>>2]=a[En+12>>2],N=N+1|0,(N|0)>=(it|0)){y=3;break}}if((y|0)==3){we=Dn;return}else(y|0)==12&&un(22522,22569,571,22579)}function uc(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0;Q=we,we=we+128|0,E=Q+64|0,P=Q,R=E,O=20240,N=R+60|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=P,O=20304,N=R+60|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(_i(a[m>>2]|0)|0)==0,E=N?E:P,P=y+4|0,Ac(P),XA(P),_i(a[m>>2]|0)|0&&(Gi(P),a[m>>2]=(a[m>>2]|0)+1),a[v>>2]=a[y>>2],m=v+4|0,ei(P,E,m),zn(m),a[v+16>>2]=a[y>>2],m=v+20|0,ei(P,E+12|0,m),zn(m),a[v+32>>2]=a[y>>2],m=v+36|0,ei(P,E+24|0,m),zn(m),a[v+48>>2]=a[y>>2],m=v+52|0,ei(P,E+36|0,m),zn(m),a[v+64>>2]=a[y>>2],v=v+68|0,ei(P,E+48|0,v),zn(v),we=Q}function Va(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0;if(Be=we,we=we+32|0,Re=Be+12|0,N=Be,$e=y+4|0,de=a[16960+(m<<2)>>2]|0,le=(E|0)!=0,de=le?de*3|0:de,P=a[$e>>2]|0,J=y+8|0,O=a[J>>2]|0,le){if(R=y+12|0,E=a[R>>2]|0,P=O+P+E|0,(P|0)==(de|0))return $e=1,we=Be,$e|0;Q=R}else Q=y+12|0,E=a[Q>>2]|0,P=O+P+E|0;if((P|0)<=(de|0))return $e=0,we=Be,$e|0;do if((E|0)>0){if(E=a[y>>2]|0,(O|0)>0){R=18640+(E*80|0)+60|0,E=y;break}E=18640+(E*80|0)+40|0,v?(Hr(Re,de,0,0),po($e,Re,N),xl(N),ei(N,Re,$e),R=E,E=y):(R=E,E=y)}else R=18640+((a[y>>2]|0)*80|0)+20|0,E=y;while(0);if(a[E>>2]=a[R>>2],P=R+16|0,(a[P>>2]|0)>0){E=0;do YA($e),E=E+1|0;while((E|0)<(a[P>>2]|0))}return y=R+4|0,a[Re>>2]=a[y>>2],a[Re+4>>2]=a[y+4>>2],a[Re+8>>2]=a[y+8>>2],m=a[16880+(m<<2)>>2]|0,vl(Re,le?m*3|0:m),ei($e,Re,$e),zn($e),le?E=((a[J>>2]|0)+(a[$e>>2]|0)+(a[Q>>2]|0)|0)==(de|0)?1:2:E=2,$e=E,we=Be,$e|0}function cc(y,m){y=y|0,m=m|0;var v=0;do v=Va(y,m,0,1)|0;while((v|0)==2);return v|0}function nu(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0,Je=0,Gt=0,zt=0,dt=0,vt=0,Pn=0,wn=0,mn=0;if(Pn=we,we=we+240|0,R=Pn+224|0,Gt=Pn+208|0,zt=Pn,dt=Pn+192|0,vt=Pn+176|0,ht=Pn+160|0,ut=Pn+144|0,it=Pn+128|0,st=Pn+112|0,Je=Pn+96|0,a[R>>2]=m,a[Gt>>2]=a[y>>2],a[Gt+4>>2]=a[y+4>>2],a[Gt+8>>2]=a[y+8>>2],a[Gt+12>>2]=a[y+12>>2],Ns(Gt,R,zt),a[P>>2]=0,Xe=E+v+((E|0)==6&1)|0,(Xe|0)<=(v|0)){we=Pn;return}Q=a[R>>2]|0,J=v+6|0,le=16960+(Q<<2)|0,de=ut+8|0,Re=it+8|0,$e=st+8|0,Be=dt+4|0,O=0,N=v,E=-1;e:for(;;){if(R=(N|0)%6|0,y=zt+(R<<4)|0,a[dt>>2]=a[y>>2],a[dt+4>>2]=a[y+4>>2],a[dt+8>>2]=a[y+8>>2],a[dt+12>>2]=a[y+12>>2],y=O,O=Va(dt,Q,0,1)|0,(N|0)>(v|0)&(_i(m)|0)!=0&&(y|0)!=1&&(a[dt>>2]|0)!=(E|0)){switch(bs(zt+(((R+5|0)%6|0)<<4)+4|0,vt),bs(zt+(R<<4)+4|0,ht),wn=+(a[le>>2]|0),G[ut>>3]=wn*3,G[de>>3]=0,mn=wn*-1.5,G[it>>3]=mn,G[Re>>3]=wn*2.598076211353316,G[st>>3]=mn,G[$e>>3]=wn*-2.598076211353316,R=a[Gt>>2]|0,a[17040+(R*80|0)+(((E|0)==(R|0)?a[dt>>2]|0:E)<<2)>>2]|0){case 1:{y=it,E=ut;break}case 3:{y=st,E=it;break}case 2:{y=ut,E=st;break}default:{y=8;break e}}fu(vt,ht,E,y,Je),!(_c(vt,Je)|0)&&!(_c(ht,Je)|0)&&(fr(Je,a[Gt>>2]|0,Q,1,P+8+(a[P>>2]<<4)|0),a[P>>2]=(a[P>>2]|0)+1)}if((N|0)<(J|0)&&(bs(Be,vt),fr(vt,a[dt>>2]|0,Q,1,P+8+(a[P>>2]<<4)|0),a[P>>2]=(a[P>>2]|0)+1),N=N+1|0,(N|0)>=(Xe|0)){y=3;break}else E=a[dt>>2]|0}if((y|0)==3){we=Pn;return}else(y|0)==8&&un(22606,22569,736,22651)}function Ns(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0;Q=we,we=we+160|0,E=Q+80|0,P=Q,R=E,O=20368,N=R+72|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=P,O=20448,N=R+72|0;do a[R>>2]=a[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(_i(a[m>>2]|0)|0)==0,E=N?E:P,P=y+4|0,Ac(P),XA(P),_i(a[m>>2]|0)|0&&(Gi(P),a[m>>2]=(a[m>>2]|0)+1),a[v>>2]=a[y>>2],m=v+4|0,ei(P,E,m),zn(m),a[v+16>>2]=a[y>>2],m=v+20|0,ei(P,E+12|0,m),zn(m),a[v+32>>2]=a[y>>2],m=v+36|0,ei(P,E+24|0,m),zn(m),a[v+48>>2]=a[y>>2],m=v+52|0,ei(P,E+36|0,m),zn(m),a[v+64>>2]=a[y>>2],m=v+68|0,ei(P,E+48|0,m),zn(m),a[v+80>>2]=a[y>>2],v=v+84|0,ei(P,E+60|0,v),zn(v),we=Q}function El(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,52)|0,Me()|0,m&15|0}function Ga(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,45)|0,Me()|0,m&127|0}function fa(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0;if(!(!0&(m&-16777216|0)==134217728)||(O=ne(y|0,m|0,45)|0,Me()|0,O=O&127,O>>>0>121))return m=0,m|0;v=ne(y|0,m|0,52)|0,Me()|0,v=v&15;do if(v|0){for(P=1,E=0;;){if(R=ne(y|0,m|0,(15-P|0)*3|0)|0,Me()|0,R=R&7,(R|0)!=0&(E^1))if((R|0)==1&(Gn(O)|0)!=0){N=0,E=13;break}else E=1;if((R|0)==7){N=0,E=13;break}if(P>>>0<v>>>0)P=P+1|0;else{E=9;break}}if((E|0)==9){if((v|0)==15)N=1;else break;return N|0}else if((E|0)==13)return N|0}while(0);for(;;){if(N=ne(y|0,m|0,(14-v|0)*3|0)|0,Me()|0,!((N&7|0)==7&!0)){N=0,E=13;break}if(v>>>0<14)v=v+1|0;else{N=1,E=13;break}}return(E|0)==13?N|0:0}function Tl(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0;if(R=ne(y|0,m|0,52)|0,Me()|0,R=R&15,v>>>0>15)return E=4,E|0;if((R|0)<(v|0))return E=12,E|0;if((R|0)==(v|0))return a[E>>2]=y,a[E+4>>2]=m,E=0,E|0;if(P=ue(v|0,0,52)|0,P=P|y,y=Me()|0|m&-15728641,(R|0)>(v|0))do m=ue(7,0,(14-v|0)*3|0)|0,v=v+1|0,P=m|P,y=Me()|0|y;while((v|0)<(R|0));return a[E>>2]=P,a[E+4>>2]=y,E=0,E|0}function Sl(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0;if(R=ne(y|0,m|0,52)|0,Me()|0,R=R&15,!((v|0)<16&(R|0)<=(v|0)))return E=4,E|0;P=v-R|0,v=ne(y|0,m|0,45)|0,Me()|0;e:do if(!(Gn(v&127)|0))v=$s(7,0,P,((P|0)<0)<<31>>31)|0,P=Me()|0;else{t:do if(R|0){for(v=1;O=ue(7,0,(15-v|0)*3|0)|0,!!((O&y|0)==0&((Me()|0)&m|0)==0);)if(v>>>0<R>>>0)v=v+1|0;else break t;v=$s(7,0,P,((P|0)<0)<<31>>31)|0,P=Me()|0;break e}while(0);v=$s(7,0,P,((P|0)<0)<<31>>31)|0,v=V(v|0,Me()|0,5,0)|0,v=d(v|0,Me()|0,-5,-1)|0,v=M(v|0,Me()|0,6,0)|0,v=d(v|0,Me()|0,1,0)|0,P=Me()|0}while(0);return O=E,a[O>>2]=v,a[O+4>>2]=P,O=0,O|0}function dr(y,m){y=y|0,m=m|0;var v=0,E=0,P=0;if(P=ne(y|0,m|0,45)|0,Me()|0,!(Gn(P&127)|0))return P=0,P|0;P=ne(y|0,m|0,52)|0,Me()|0,P=P&15;e:do if(!P)v=0;else for(E=1;;){if(v=ne(y|0,m|0,(15-E|0)*3|0)|0,Me()|0,v=v&7,v|0)break e;if(E>>>0<P>>>0)E=E+1|0;else{v=0;break}}while(0);return P=(v|0)==0&1,P|0}function gA(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0;if(O=we,we=we+16|0,R=O,pa(R,y,m,v),m=R,y=a[m>>2]|0,m=a[m+4>>2]|0,(y|0)==0&(m|0)==0)return we=O,0;P=0,v=0;do N=E+(P<<3)|0,a[N>>2]=y,a[N+4>>2]=m,P=d(P|0,v|0,1,0)|0,v=Me()|0,Ha(R),N=R,y=a[N>>2]|0,m=a[N+4>>2]|0;while(!((y|0)==0&(m|0)==0));return we=O,0}function as(y,m,v,E){return y=y|0,m=m|0,v=v|0,E=E|0,(E|0)<(v|0)?(v=m,E=y,Ct(v|0),E|0):(v=ue(-1,-1,((E-v|0)*3|0)+3|0)|0,E=ue(~v|0,~(Me()|0)|0,(15-E|0)*3|0)|0,v=~(Me()|0)&m,E=~E&y,Ct(v|0),E|0)}function ru(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0;return P=ne(y|0,m|0,52)|0,Me()|0,P=P&15,(v|0)<16&(P|0)<=(v|0)?((P|0)<(v|0)&&(P=ue(-1,-1,((v+-1-P|0)*3|0)+3|0)|0,P=ue(~P|0,~(Me()|0)|0,(15-v|0)*3|0)|0,m=~(Me()|0)&m,y=~P&y),P=ue(v|0,0,52)|0,v=m&-15728641|(Me()|0),a[E>>2]=y|P,a[E+4>>2]=v,E=0,E|0):(E=4,E|0)}function Ml(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0,Je=0,Gt=0,zt=0,dt=0,vt=0;if((v|0)==0&(E|0)==0)return dt=0,dt|0;if(P=y,R=a[P>>2]|0,P=a[P+4>>2]|0,!0&(P&15728640|0)==0){if(!((E|0)>0|(E|0)==0&v>>>0>0)||(dt=m,a[dt>>2]=R,a[dt+4>>2]=P,(v|0)==1&(E|0)==0))return dt=0,dt|0;P=1;do Gt=y+(P<<3)|0,zt=a[Gt+4>>2]|0,dt=m+(P<<3)|0,a[dt>>2]=a[Gt>>2],a[dt+4>>2]=zt,P=P+1|0;while(0<(E|0)|(E|0)==0&P>>>0<v>>>0);return P=0,P|0}if(Je=v<<3,zt=_(Je)|0,!zt)return dt=13,dt|0;if(Ge(zt|0,y|0,Je|0)|0,Gt=h(v,8)|0,!Gt)return l(zt),dt=13,dt|0;e:do if(v|0){t:for(;;){P=zt,ut=a[P>>2]|0,P=a[P+4>>2]|0,it=ne(ut|0,P|0,52)|0,Me()|0,it=it&15,st=it+-1|0,ht=(v|0)>0;n:do if((it|0)!=0&ht){if($e=((v|0)<0)<<31>>31,Be=ue(st|0,0,52)|0,Xe=Me()|0,st>>>0>15){if(!((ut|0)==0&(P|0)==0)){dt=17;break t}for(R=0;;){if(R=R+1|0,(R|0)>=(v|0))break n;if(E=zt+(R<<3)|0,Xe=a[E>>2]|0,E=a[E+4>>2]|0,!((Xe|0)==0&(E|0)==0)){P=E,dt=17;break t}}}for(R=0,y=ut,E=P;;){if(!((y|0)==0&(E|0)==0)){if(!(!0&(E&117440512|0)==0)){dt=22;break t}if(N=ne(y|0,E|0,52)|0,Me()|0,N=N&15,(N|0)<(st|0)){P=12,dt=28;break t}if((N|0)!=(st|0)&&(y=y|Be,E=E&-15728641|Xe,N>>>0>=it>>>0)){O=st;do Re=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,y=Re|y,E=Me()|0|E;while(O>>>0<N>>>0)}if(O=Y(y|0,E|0,v|0,$e|0)|0,Me()|0,J=Gt+(O<<3)|0,N=J,Q=a[N>>2]|0,N=a[N+4>>2]|0,(Q|0)==0&(N|0)==0)O=J;else for(Re=0;;){if((Re|0)>(v|0)){dt=32;break t}if((Q|0)==(y|0)&(N&-117440513|0)==(E|0)){le=ne(Q|0,N|0,56)|0,Me()|0,le=le&7,de=le+1|0,vt=ne(Q|0,N|0,45)|0,Me()|0;r:do if(!(Gn(vt&127)|0))N=7;else{if(Q=ne(Q|0,N|0,52)|0,Me()|0,Q=Q&15,!Q){N=6;break}for(N=1;;){if(vt=ue(7,0,(15-N|0)*3|0)|0,!((vt&y|0)==0&((Me()|0)&E|0)==0)){N=7;break r}if(N>>>0<Q>>>0)N=N+1|0;else{N=6;break}}}while(0);if((le+2|0)>>>0>N>>>0){dt=42;break t}vt=ue(de|0,0,56)|0,E=Me()|0|E&-117440513,de=J,a[de>>2]=0,a[de+4>>2]=0,y=vt|y}else O=(O+1|0)%(v|0)|0;if(J=Gt+(O<<3)|0,N=J,Q=a[N>>2]|0,N=a[N+4>>2]|0,(Q|0)==0&(N|0)==0){O=J;break}else Re=Re+1|0}vt=O,a[vt>>2]=y,a[vt+4>>2]=E}if(R=R+1|0,(R|0)>=(v|0))break n;E=zt+(R<<3)|0,y=a[E>>2]|0,E=a[E+4>>2]|0}}while(0);if((v+5|0)>>>0<11){dt=85;break}if(Xe=h((v|0)/6|0,8)|0,!Xe){dt=49;break}n:do if(ht){Re=0,de=0;do{if(N=Gt+(Re<<3)|0,E=N,R=a[E>>2]|0,E=a[E+4>>2]|0,!((R|0)==0&(E|0)==0)){Q=ne(R|0,E|0,56)|0,Me()|0,Q=Q&7,y=Q+1|0,J=E&-117440513,vt=ne(R|0,E|0,45)|0,Me()|0;r:do if(Gn(vt&127)|0){if(le=ne(R|0,E|0,52)|0,Me()|0,le=le&15,le|0)for(O=1;;){if(vt=ue(7,0,(15-O|0)*3|0)|0,!((R&vt|0)==0&(J&(Me()|0)|0)==0))break r;if(O>>>0<le>>>0)O=O+1|0;else break}E=ue(y|0,0,56)|0,R=E|R,E=Me()|0|J,y=N,a[y>>2]=R,a[y+4>>2]=E,y=Q+2|0}while(0);(y|0)==7&&(vt=Xe+(de<<3)|0,a[vt>>2]=R,a[vt+4>>2]=E&-117440513,de=de+1|0)}Re=Re+1|0}while((Re|0)!=(v|0));if(ht){if(Re=((v|0)<0)<<31>>31,$e=ue(st|0,0,52)|0,Be=Me()|0,st>>>0>15){if(!((ut|0)==0&(P|0)==0)){P=4,dt=84;break t}for(P=0;;){if(P=P+1|0,(P|0)>=(v|0)){R=0,P=de;break n}if(vt=zt+(P<<3)|0,!((a[vt>>2]|0)==0&(a[vt+4>>2]|0)==0)){P=4,dt=84;break t}}}for(le=0,R=0,J=ut;;){do if(!((J|0)==0&(P|0)==0)){if(N=ne(J|0,P|0,52)|0,Me()|0,N=N&15,(N|0)<(st|0)){P=12,dt=84;break t}do if((N|0)==(st|0))E=J,N=P;else{if(E=J|$e,y=P&-15728641|Be,N>>>0<it>>>0){N=y;break}O=st;do vt=ue(7,0,(14-O|0)*3|0)|0,O=O+1|0,E=vt|E,y=Me()|0|y;while(O>>>0<N>>>0);N=y}while(0);for(O=Y(E|0,N|0,v|0,Re|0)|0,Me()|0,y=0;;){if((y|0)>(v|0)){dt=77;break t}if(vt=Gt+(O<<3)|0,Q=a[vt+4>>2]|0,(Q&-117440513|0)==(N|0)&&(a[vt>>2]|0)==(E|0)){dt=79;break}if(O=(O+1|0)%(v|0)|0,vt=Gt+(O<<3)|0,(a[vt>>2]|0)==(E|0)&&(a[vt+4>>2]|0)==(N|0))break;y=y+1|0}if((dt|0)==79&&(dt=0,!0&(Q&117440512|0)==100663296))break;vt=m+(R<<3)|0,a[vt>>2]=J,a[vt+4>>2]=P,R=R+1|0}while(0);if(P=le+1|0,(P|0)>=(v|0)){P=de;break n}vt=zt+(P<<3)|0,le=P,J=a[vt>>2]|0,P=a[vt+4>>2]|0}}else R=0,P=de}else R=0,P=0;while(0);if(Te(Gt|0,0,Je|0)|0,Ge(zt|0,Xe|0,P<<3|0)|0,l(Xe),P)m=m+(R<<3)|0,v=P;else break e}if((dt|0)==17)!0&(P&117440512|0)==0?(P=4,dt=28):dt=22;else if((dt|0)==32)un(23313,22674,362,22684);else{if((dt|0)==42)return l(zt),l(Gt),vt=10,vt|0;if((dt|0)==49)return l(zt),l(Gt),vt=13,vt|0;if((dt|0)==77)un(23313,22674,462,22684);else{if((dt|0)==84)return l(Xe),l(zt),l(Gt),vt=P,vt|0;if((dt|0)==85){Ge(m|0,zt|0,v<<3|0)|0;break}}}if((dt|0)==22)return l(zt),l(Gt),vt=5,vt|0;if((dt|0)==28)return l(zt),l(Gt),vt=P,vt|0}while(0);return l(zt),l(Gt),vt=0,vt|0}function hc(y,m,v,E,P,R,O){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0,R=R|0,O=O|0;var N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0;if(Xe=we,we=we+16|0,Be=Xe,!((v|0)>0|(v|0)==0&m>>>0>0))return Be=0,we=Xe,Be|0;if((O|0)>=16)return Be=12,we=Xe,Be|0;Re=0,$e=0,de=0,N=0;e:for(;;){if(J=y+(Re<<3)|0,Q=a[J>>2]|0,J=a[J+4>>2]|0,le=ne(Q|0,J|0,52)|0,Me()|0,(le&15|0)>(O|0)){N=12,Q=11;break}if(pa(Be,Q,J,O),le=Be,J=a[le>>2]|0,le=a[le+4>>2]|0,(J|0)==0&(le|0)==0)Q=de;else{Q=de;do{if(!((N|0)<(R|0)|(N|0)==(R|0)&Q>>>0<P>>>0)){Q=10;break e}de=E+(Q<<3)|0,a[de>>2]=J,a[de+4>>2]=le,Q=d(Q|0,N|0,1,0)|0,N=Me()|0,Ha(Be),de=Be,J=a[de>>2]|0,le=a[de+4>>2]|0}while(!((J|0)==0&(le|0)==0))}if(Re=d(Re|0,$e|0,1,0)|0,$e=Me()|0,($e|0)<(v|0)|($e|0)==(v|0)&Re>>>0<m>>>0)de=Q;else{N=0,Q=11;break}}return(Q|0)==10?(Be=14,we=Xe,Be|0):(Q|0)==11?(we=Xe,N|0):0}function Wr(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;Re=we,we=we+16|0,de=Re;e:do if((v|0)>0|(v|0)==0&m>>>0>0){for(J=0,O=0,R=0,le=0;;){if(Q=y+(J<<3)|0,N=a[Q>>2]|0,Q=a[Q+4>>2]|0,!((N|0)==0&(Q|0)==0)&&(Q=(Sl(N,Q,E,de)|0)==0,N=de,O=d(a[N>>2]|0,a[N+4>>2]|0,O|0,R|0)|0,R=Me()|0,!Q)){R=12;break}if(J=d(J|0,le|0,1,0)|0,le=Me()|0,!((le|0)<(v|0)|(le|0)==(v|0)&J>>>0<m>>>0))break e}return we=Re,R|0}else O=0,R=0;while(0);return a[P>>2]=O,a[P+4>>2]=R,P=0,we=Re,P|0}function Ir(y,m){return y=y|0,m=m|0,m=ne(y|0,m|0,52)|0,Me()|0,m&1|0}function ti(y,m){y=y|0,m=m|0;var v=0,E=0,P=0;if(P=ne(y|0,m|0,52)|0,Me()|0,P=P&15,!P)return P=0,P|0;for(E=1;;){if(v=ne(y|0,m|0,(15-E|0)*3|0)|0,Me()|0,v=v&7,v|0){E=5;break}if(E>>>0<P>>>0)E=E+1|0;else{v=0,E=5;break}}return(E|0)==5?v|0:0}function iu(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0,Q=0;if(Q=ne(y|0,m|0,52)|0,Me()|0,Q=Q&15,!Q)return N=m,Q=y,Ct(N|0),Q|0;for(N=1,v=0;;){R=(15-N|0)*3|0,E=ue(7,0,R|0)|0,P=Me()|0,O=ne(y|0,m|0,R|0)|0,Me()|0,R=ue(mo(O&7)|0,0,R|0)|0,O=Me()|0,y=R|y&~E,m=O|m&~P;e:do if(!v)if((R&E|0)==0&(O&P|0)==0)v=0;else if(E=ne(y|0,m|0,52)|0,Me()|0,E=E&15,!E)v=1;else{v=1;t:for(;;){switch(O=ne(y|0,m|0,(15-v|0)*3|0)|0,Me()|0,O&7){case 1:break t;case 0:break;default:{v=1;break e}}if(v>>>0<E>>>0)v=v+1|0;else{v=1;break e}}for(v=1;;)if(O=(15-v|0)*3|0,P=ne(y|0,m|0,O|0)|0,Me()|0,R=ue(7,0,O|0)|0,m=m&~(Me()|0),O=ue(mo(P&7)|0,0,O|0)|0,y=y&~R|O,m=m|(Me()|0),v>>>0<E>>>0)v=v+1|0;else{v=1;break}}while(0);if(N>>>0<Q>>>0)N=N+1|0;else break}return Ct(m|0),y|0}function Us(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0;if(E=ne(y|0,m|0,52)|0,Me()|0,E=E&15,!E)return v=m,E=y,Ct(v|0),E|0;for(v=1;R=(15-v|0)*3|0,O=ne(y|0,m|0,R|0)|0,Me()|0,P=ue(7,0,R|0)|0,m=m&~(Me()|0),R=ue(mo(O&7)|0,0,R|0)|0,y=R|y&~P,m=Me()|0|m,v>>>0<E>>>0;)v=v+1|0;return Ct(m|0),y|0}function fc(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0,Q=0;if(Q=ne(y|0,m|0,52)|0,Me()|0,Q=Q&15,!Q)return N=m,Q=y,Ct(N|0),Q|0;for(N=1,v=0;;){R=(15-N|0)*3|0,E=ue(7,0,R|0)|0,P=Me()|0,O=ne(y|0,m|0,R|0)|0,Me()|0,R=ue(Go(O&7)|0,0,R|0)|0,O=Me()|0,y=R|y&~E,m=O|m&~P;e:do if(!v)if((R&E|0)==0&(O&P|0)==0)v=0;else if(E=ne(y|0,m|0,52)|0,Me()|0,E=E&15,!E)v=1;else{v=1;t:for(;;){switch(O=ne(y|0,m|0,(15-v|0)*3|0)|0,Me()|0,O&7){case 1:break t;case 0:break;default:{v=1;break e}}if(v>>>0<E>>>0)v=v+1|0;else{v=1;break e}}for(v=1;;)if(P=(15-v|0)*3|0,R=ue(7,0,P|0)|0,O=m&~(Me()|0),m=ne(y|0,m|0,P|0)|0,Me()|0,m=ue(Go(m&7)|0,0,P|0)|0,y=y&~R|m,m=O|(Me()|0),v>>>0<E>>>0)v=v+1|0;else{v=1;break}}while(0);if(N>>>0<Q>>>0)N=N+1|0;else break}return Ct(m|0),y|0}function mA(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0;if(E=ne(y|0,m|0,52)|0,Me()|0,E=E&15,!E)return v=m,E=y,Ct(v|0),E|0;for(v=1;O=(15-v|0)*3|0,R=ue(7,0,O|0)|0,P=m&~(Me()|0),m=ne(y|0,m|0,O|0)|0,Me()|0,m=ue(Go(m&7)|0,0,O|0)|0,y=m|y&~R,m=Me()|0|P,v>>>0<E>>>0;)v=v+1|0;return Ct(m|0),y|0}function li(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(Q=we,we=we+64|0,N=Q+40|0,E=Q+24|0,P=Q+12|0,R=Q,ue(m|0,0,52)|0,v=Me()|0|134225919,!m)return(a[y+4>>2]|0)>2||(a[y+8>>2]|0)>2||(a[y+12>>2]|0)>2?(O=0,N=0,Ct(O|0),we=Q,N|0):(ue(AA(y)|0,0,45)|0,O=Me()|0|v,N=-1,Ct(O|0),we=Q,N|0);if(a[N>>2]=a[y>>2],a[N+4>>2]=a[y+4>>2],a[N+8>>2]=a[y+8>>2],a[N+12>>2]=a[y+12>>2],O=N+4|0,(m|0)>0)for(y=-1;a[E>>2]=a[O>>2],a[E+4>>2]=a[O+4>>2],a[E+8>>2]=a[O+8>>2],m&1?(dA(O),a[P>>2]=a[O>>2],a[P+4>>2]=a[O+4>>2],a[P+8>>2]=a[O+8>>2],Vo(P)):(Na(O),a[P>>2]=a[O>>2],a[P+4>>2]=a[O+4>>2],a[P+8>>2]=a[O+8>>2],Gi(P)),po(E,P,R),zn(R),le=(15-m|0)*3|0,J=ue(7,0,le|0)|0,v=v&~(Me()|0),le=ue(Uo(R)|0,0,le|0)|0,y=le|y&~J,v=Me()|0|v,(m|0)>1;)m=m+-1|0;else y=-1;e:do if((a[O>>2]|0)<=2&&(a[N+8>>2]|0)<=2&&(a[N+12>>2]|0)<=2){if(E=AA(N)|0,m=ue(E|0,0,45)|0,m=m|y,y=Me()|0|v&-1040385,R=uA(N)|0,!(Gn(E)|0)){if((R|0)<=0)break;for(P=0;;){if(E=ne(m|0,y|0,52)|0,Me()|0,E=E&15,E)for(v=1;le=(15-v|0)*3|0,N=ne(m|0,y|0,le|0)|0,Me()|0,J=ue(7,0,le|0)|0,y=y&~(Me()|0),le=ue(mo(N&7)|0,0,le|0)|0,m=m&~J|le,y=y|(Me()|0),v>>>0<E>>>0;)v=v+1|0;if(P=P+1|0,(P|0)==(R|0))break e}}P=ne(m|0,y|0,52)|0,Me()|0,P=P&15;t:do if(P){v=1;n:for(;;){switch(le=ne(m|0,y|0,(15-v|0)*3|0)|0,Me()|0,le&7){case 1:break n;case 0:break;default:break t}if(v>>>0<P>>>0)v=v+1|0;else break t}if(cA(E,a[N>>2]|0)|0)for(v=1;N=(15-v|0)*3|0,J=ue(7,0,N|0)|0,le=y&~(Me()|0),y=ne(m|0,y|0,N|0)|0,Me()|0,y=ue(Go(y&7)|0,0,N|0)|0,m=m&~J|y,y=le|(Me()|0),v>>>0<P>>>0;)v=v+1|0;else for(v=1;le=(15-v|0)*3|0,N=ne(m|0,y|0,le|0)|0,Me()|0,J=ue(7,0,le|0)|0,y=y&~(Me()|0),le=ue(mo(N&7)|0,0,le|0)|0,m=m&~J|le,y=y|(Me()|0),v>>>0<P>>>0;)v=v+1|0}while(0);if((R|0)>0){v=0;do m=iu(m,y)|0,y=Me()|0,v=v+1|0;while((v|0)!=(R|0))}}else m=0,y=0;while(0);return J=y,le=m,Ct(J|0),we=Q,le|0}function _i(y){return y=y|0,(y|0)%2|0|0}function ls(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0;return P=we,we=we+16|0,E=P,m>>>0>15?(E=4,we=P,E|0):(a[y+4>>2]&2146435072|0)==2146435072||(a[y+8+4>>2]&2146435072|0)==2146435072?(E=3,we=P,E|0):($n(y,m,E),m=li(E,m)|0,E=Me()|0,a[v>>2]=m,a[v+4>>2]=E,(m|0)==0&(E|0)==0&&un(23313,22674,786,22697),E=0,we=P,E|0)}function da(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0;if(P=v+4|0,R=ne(y|0,m|0,52)|0,Me()|0,R=R&15,O=ne(y|0,m|0,45)|0,Me()|0,E=(R|0)==0,Gn(O&127)|0){if(E)return O=1,O|0;E=1}else{if(E)return O=0,O|0;!(a[P>>2]|0)&&!(a[v+8>>2]|0)?E=(a[v+12>>2]|0)!=0&1:E=1}for(v=1;v&1?Vo(P):Gi(P),O=ne(y|0,m|0,(15-v|0)*3|0)|0,Me()|0,$i(P,O&7),v>>>0<R>>>0;)v=v+1|0;return E|0}function qi(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(le=we,we=we+16|0,Q=le,J=ne(y|0,m|0,45)|0,Me()|0,J=J&127,J>>>0>121)return a[v>>2]=0,a[v+4>>2]=0,a[v+8>>2]=0,a[v+12>>2]=0,J=5,we=le,J|0;e:do if(Gn(J)|0&&(R=ne(y|0,m|0,52)|0,Me()|0,R=R&15,(R|0)!=0)){E=1;t:for(;;){switch(N=ne(y|0,m|0,(15-E|0)*3|0)|0,Me()|0,N&7){case 5:break t;case 0:break;default:{E=m;break e}}if(E>>>0<R>>>0)E=E+1|0;else{E=m;break e}}for(P=1,E=m;m=(15-P|0)*3|0,O=ue(7,0,m|0)|0,N=E&~(Me()|0),E=ne(y|0,E|0,m|0)|0,Me()|0,E=ue(Go(E&7)|0,0,m|0)|0,y=y&~O|E,E=N|(Me()|0),P>>>0<R>>>0;)P=P+1|0}else E=m;while(0);if(N=7696+(J*28|0)|0,a[v>>2]=a[N>>2],a[v+4>>2]=a[N+4>>2],a[v+8>>2]=a[N+8>>2],a[v+12>>2]=a[N+12>>2],!(da(y,E,v)|0))return J=0,we=le,J|0;if(O=v+4|0,a[Q>>2]=a[O>>2],a[Q+4>>2]=a[O+4>>2],a[Q+8>>2]=a[O+8>>2],R=ne(y|0,E|0,52)|0,Me()|0,N=R&15,R&1?(Gi(O),R=N+1|0):R=N,!(Gn(J)|0))E=0;else{e:do if(!N)E=0;else for(m=1;;){if(P=ne(y|0,E|0,(15-m|0)*3|0)|0,Me()|0,P=P&7,P|0){E=P;break e}if(m>>>0<N>>>0)m=m+1|0;else{E=0;break}}while(0);E=(E|0)==4&1}if(!(Va(v,R,E,0)|0))(R|0)!=(N|0)&&(a[O>>2]=a[Q>>2],a[O+4>>2]=a[Q+4>>2],a[O+8>>2]=a[Q+8>>2]);else{if(Gn(J)|0)do;while(Va(v,R,0,0)|0);(R|0)!=(N|0)&&Na(O)}return J=0,we=le,J|0}function _o(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0;return R=we,we=we+16|0,E=R,P=qi(y,m,E)|0,P|0?(we=R,P|0):(P=ne(y|0,m|0,52)|0,Me()|0,bl(E,P&15,v),P=0,we=R,P|0)}function hi(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0;if(O=we,we=we+16|0,R=O,E=qi(y,m,R)|0,E|0)return R=E,we=O,R|0;E=ne(y|0,m|0,45)|0,Me()|0,E=(Gn(E&127)|0)==0,P=ne(y|0,m|0,52)|0,Me()|0,P=P&15;e:do if(!E){if(P|0)for(E=1;;){if(N=ue(7,0,(15-E|0)*3|0)|0,!((N&y|0)==0&((Me()|0)&m|0)==0))break e;if(E>>>0<P>>>0)E=E+1|0;else break}return jo(R,P,0,5,v),N=0,we=O,N|0}while(0);return nu(R,P,0,6,v),N=0,we=O,N|0}function $a(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0;if(P=ne(y|0,m|0,45)|0,Me()|0,!(Gn(P&127)|0))return P=2,a[v>>2]=P,0;if(P=ne(y|0,m|0,52)|0,Me()|0,P=P&15,!P)return P=5,a[v>>2]=P,0;for(E=1;;){if(R=ue(7,0,(15-E|0)*3|0)|0,!((R&y|0)==0&((Me()|0)&m|0)==0)){E=2,y=6;break}if(E>>>0<P>>>0)E=E+1|0;else{E=5,y=6;break}}return(y|0)==6&&(a[v>>2]=E),0}function Cl(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0;de=we,we=we+128|0,J=de+112|0,R=de+96|0,le=de,P=ne(y|0,m|0,52)|0,Me()|0,N=P&15,a[J>>2]=N,O=ne(y|0,m|0,45)|0,Me()|0,O=O&127;e:do if(Gn(O)|0){if(N|0)for(E=1;;){if(Q=ue(7,0,(15-E|0)*3|0)|0,!((Q&y|0)==0&((Me()|0)&m|0)==0)){P=0;break e}if(E>>>0<N>>>0)E=E+1|0;else break}if(P&1)P=1;else return Q=ue(N+1|0,0,52)|0,le=Me()|0|m&-15728641,J=ue(7,0,(14-N|0)*3|0)|0,le=Cl((Q|y)&~J,le&~(Me()|0),v)|0,we=de,le|0}else P=0;while(0);if(E=qi(y,m,R)|0,!E){P?(uc(R,J,le),Q=5):(Ns(R,J,le),Q=6);e:do if(Gn(O)|0)if(!N)y=5;else for(E=1;;){if(O=ue(7,0,(15-E|0)*3|0)|0,!((O&y|0)==0&((Me()|0)&m|0)==0)){y=2;break e}if(E>>>0<N>>>0)E=E+1|0;else{y=5;break}}else y=2;while(0);Te(v|0,-1,y<<2|0)|0;e:do if(P)for(R=0;;){if(O=le+(R<<4)|0,cc(O,a[J>>2]|0)|0,O=a[O>>2]|0,N=a[v>>2]|0,(N|0)==-1|(N|0)==(O|0))E=v;else{P=0;do{if(P=P+1|0,P>>>0>=y>>>0){E=1;break e}E=v+(P<<2)|0,N=a[E>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(a[E>>2]=O,R=R+1|0,R>>>0>=Q>>>0){E=0;break}}else for(R=0;;){if(O=le+(R<<4)|0,Va(O,a[J>>2]|0,0,1)|0,O=a[O>>2]|0,N=a[v>>2]|0,(N|0)==-1|(N|0)==(O|0))E=v;else{P=0;do{if(P=P+1|0,P>>>0>=y>>>0){E=1;break e}E=v+(P<<2)|0,N=a[E>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(a[E>>2]=O,R=R+1|0,R>>>0>=Q>>>0){E=0;break}}while(0)}return le=E,we=de,le|0}function ja(){return 12}function Vs(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0,Q=0;if(y>>>0>15)return N=4,N|0;if(ue(y|0,0,52)|0,N=Me()|0|134225919,!y){v=0,E=0;do Gn(E)|0&&(ue(E|0,0,45)|0,O=N|(Me()|0),y=m+(v<<3)|0,a[y>>2]=-1,a[y+4>>2]=O,v=v+1|0),E=E+1|0;while((E|0)!=122);return v=0,v|0}v=0,O=0;do{if(Gn(O)|0){for(ue(O|0,0,45)|0,E=1,P=-1,R=N|(Me()|0);Q=ue(7,0,(15-E|0)*3|0)|0,P=P&~Q,R=R&~(Me()|0),(E|0)!=(y|0);)E=E+1|0;Q=m+(v<<3)|0,a[Q>>2]=P,a[Q+4>>2]=R,v=v+1|0}O=O+1|0}while((O|0)!=122);return v=0,v|0}function As(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0;if(it=we,we=we+16|0,ht=it,ut=ne(y|0,m|0,52)|0,Me()|0,ut=ut&15,v>>>0>15)return ut=4,we=it,ut|0;if((ut|0)<(v|0))return ut=12,we=it,ut|0;if((ut|0)!=(v|0))if(R=ue(v|0,0,52)|0,R=R|y,N=Me()|0|m&-15728641,(ut|0)>(v|0)){Q=v;do Xe=ue(7,0,(14-Q|0)*3|0)|0,Q=Q+1|0,R=Xe|R,N=Me()|0|N;while((Q|0)<(ut|0));Xe=R}else Xe=R;else Xe=y,N=m;Be=ne(Xe|0,N|0,45)|0,Me()|0;e:do if(Gn(Be&127)|0){if(Q=ne(Xe|0,N|0,52)|0,Me()|0,Q=Q&15,Q|0)for(R=1;;){if(Be=ue(7,0,(15-R|0)*3|0)|0,!((Be&Xe|0)==0&((Me()|0)&N|0)==0)){J=33;break e}if(R>>>0<Q>>>0)R=R+1|0;else break}if(Be=E,a[Be>>2]=0,a[Be+4>>2]=0,(ut|0)>(v|0)){for(Be=m&-15728641,$e=ut;;){if(Re=$e,$e=$e+-1|0,$e>>>0>15|(ut|0)<($e|0)){J=19;break}if((ut|0)!=($e|0))if(R=ue($e|0,0,52)|0,R=R|y,Q=Me()|0|Be,(ut|0)<(Re|0))de=R;else{J=$e;do de=ue(7,0,(14-J|0)*3|0)|0,J=J+1|0,R=de|R,Q=Me()|0|Q;while((J|0)<(ut|0));de=R}else de=y,Q=m;if(le=ne(de|0,Q|0,45)|0,Me()|0,!(Gn(le&127)|0))R=0;else{le=ne(de|0,Q|0,52)|0,Me()|0,le=le&15;t:do if(!le)R=0;else for(J=1;;){if(R=ne(de|0,Q|0,(15-J|0)*3|0)|0,Me()|0,R=R&7,R|0)break t;if(J>>>0<le>>>0)J=J+1|0;else{R=0;break}}while(0);R=(R|0)==0&1}if(Q=ne(y|0,m|0,(15-Re|0)*3|0)|0,Me()|0,Q=Q&7,(Q|0)==7){P=5,J=42;break}if(R=(R|0)!=0,(Q|0)==1&R){P=5,J=42;break}if(de=Q+(((Q|0)!=0&R)<<31>>31)|0,de|0&&(J=ut-Re|0,J=$s(7,0,J,((J|0)<0)<<31>>31)|0,le=Me()|0,R?(R=V(J|0,le|0,5,0)|0,R=d(R|0,Me()|0,-5,-1)|0,R=M(R|0,Me()|0,6,0)|0,R=d(R|0,Me()|0,1,0)|0,Q=Me()|0):(R=J,Q=le),Re=de+-1|0,Re=V(J|0,le|0,Re|0,((Re|0)<0)<<31>>31|0)|0,Re=d(R|0,Q|0,Re|0,Me()|0)|0,de=Me()|0,le=E,le=d(Re|0,de|0,a[le>>2]|0,a[le+4>>2]|0)|0,de=Me()|0,Re=E,a[Re>>2]=le,a[Re+4>>2]=de),($e|0)<=(v|0)){J=37;break}}if((J|0)==19)un(23313,22674,1099,22710);else if((J|0)==37){O=E,P=a[O+4>>2]|0,O=a[O>>2]|0;break}else if((J|0)==42)return we=it,P|0}else P=0,O=0}else J=33;while(0);e:do if((J|0)==33)if(Be=E,a[Be>>2]=0,a[Be+4>>2]=0,(ut|0)>(v|0)){for(R=ut;;){if(P=ne(y|0,m|0,(15-R|0)*3|0)|0,Me()|0,P=P&7,(P|0)==7){P=5;break}if(O=ut-R|0,O=$s(7,0,O,((O|0)<0)<<31>>31)|0,P=V(O|0,Me()|0,P|0,0)|0,O=Me()|0,Be=E,O=d(a[Be>>2]|0,a[Be+4>>2]|0,P|0,O|0)|0,P=Me()|0,Be=E,a[Be>>2]=O,a[Be+4>>2]=P,R=R+-1|0,(R|0)<=(v|0))break e}return we=it,P|0}else P=0,O=0;while(0);return Sl(Xe,N,ut,ht)|0&&un(23313,22674,1063,22725),ut=ht,ht=a[ut+4>>2]|0,((P|0)>-1|(P|0)==-1&O>>>0>4294967295)&((ht|0)>(P|0)|((ht|0)==(P|0)?(a[ut>>2]|0)>>>0>O>>>0:0))?(ut=0,we=it,ut|0):(un(23313,22674,1139,22710),0)}function dc(y,m,v,E,P,R){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0,R=R|0;var O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0;if(de=we,we=we+16|0,O=de,P>>>0>15)return R=4,we=de,R|0;if(N=ne(v|0,E|0,52)|0,Me()|0,N=N&15,(N|0)>(P|0))return R=12,we=de,R|0;if(Sl(v,E,P,O)|0&&un(23313,22674,1063,22725),le=O,J=a[le+4>>2]|0,!(((m|0)>-1|(m|0)==-1&y>>>0>4294967295)&((J|0)>(m|0)|((J|0)==(m|0)?(a[le>>2]|0)>>>0>y>>>0:0))))return R=2,we=de,R|0;le=P-N|0,P=ue(P|0,0,52)|0,Q=Me()|0|E&-15728641,J=R,a[J>>2]=P|v,a[J+4>>2]=Q,J=ne(v|0,E|0,45)|0,Me()|0;e:do if(Gn(J&127)|0){if(N|0)for(O=1;;){if(J=ue(7,0,(15-O|0)*3|0)|0,!((J&v|0)==0&((Me()|0)&E|0)==0))break e;if(O>>>0<N>>>0)O=O+1|0;else break}if((le|0)<1)return R=0,we=de,R|0;for(J=N^15,E=-1,Q=1,O=1;;){N=le-Q|0,N=$s(7,0,N,((N|0)<0)<<31>>31)|0,v=Me()|0;do if(O)if(O=V(N|0,v|0,5,0)|0,O=d(O|0,Me()|0,-5,-1)|0,O=M(O|0,Me()|0,6,0)|0,P=Me()|0,(m|0)>(P|0)|(m|0)==(P|0)&y>>>0>O>>>0){m=d(y|0,m|0,-1,-1)|0,m=x(m|0,Me()|0,O|0,P|0)|0,O=Me()|0,Re=R,Be=a[Re>>2]|0,Re=a[Re+4>>2]|0,Xe=(J+E|0)*3|0,$e=ue(7,0,Xe|0)|0,Re=Re&~(Me()|0),E=M(m|0,O|0,N|0,v|0)|0,y=Me()|0,P=d(E|0,y|0,2,0)|0,Xe=ue(P|0,Me()|0,Xe|0)|0,Re=Me()|0|Re,P=R,a[P>>2]=Xe|Be&~$e,a[P+4>>2]=Re,y=V(E|0,y|0,N|0,v|0)|0,y=x(m|0,O|0,y|0,Me()|0)|0,O=0,m=Me()|0;break}else{Xe=R,$e=a[Xe>>2]|0,Xe=a[Xe+4>>2]|0,Be=ue(7,0,(J+E|0)*3|0)|0,Xe=Xe&~(Me()|0),O=R,a[O>>2]=$e&~Be,a[O+4>>2]=Xe,O=1;break}else $e=R,P=a[$e>>2]|0,$e=a[$e+4>>2]|0,E=(J+E|0)*3|0,Re=ue(7,0,E|0)|0,$e=$e&~(Me()|0),Xe=M(y|0,m|0,N|0,v|0)|0,O=Me()|0,E=ue(Xe|0,O|0,E|0)|0,$e=Me()|0|$e,Be=R,a[Be>>2]=E|P&~Re,a[Be+4>>2]=$e,O=V(Xe|0,O|0,N|0,v|0)|0,y=x(y|0,m|0,O|0,Me()|0)|0,O=0,m=Me()|0;while(0);if((le|0)>(Q|0))E=~Q,Q=Q+1|0;else{m=0;break}}return we=de,m|0}while(0);if((le|0)<1)return Xe=0,we=de,Xe|0;for(P=N^15,O=1;;)if(Be=le-O|0,Be=$s(7,0,Be,((Be|0)<0)<<31>>31)|0,Xe=Me()|0,Q=R,v=a[Q>>2]|0,Q=a[Q+4>>2]|0,N=(P-O|0)*3|0,E=ue(7,0,N|0)|0,Q=Q&~(Me()|0),Re=M(y|0,m|0,Be|0,Xe|0)|0,$e=Me()|0,N=ue(Re|0,$e|0,N|0)|0,Q=Me()|0|Q,J=R,a[J>>2]=N|v&~E,a[J+4>>2]=Q,Xe=V(Re|0,$e|0,Be|0,Xe|0)|0,y=x(y|0,m|0,Xe|0,Me()|0)|0,m=Me()|0,(le|0)<=(O|0)){m=0;break}else O=O+1|0;return we=de,m|0}function pa(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0;P=ne(m|0,v|0,52)|0,Me()|0,P=P&15,(m|0)==0&(v|0)==0|((E|0)>15|(P|0)>(E|0))?(E=-1,P=-1,m=0,v=0):(R=as(m,v,P+1|0,E)|0,v=(Me()|0)&-15728641,m=ue(E|0,0,52)|0,m=R|m,v=v|(Me()|0),R=(dr(m,v)|0)==0,E=R?-1:E),R=y,a[R>>2]=m,a[R+4>>2]=v,a[y+8>>2]=P,a[y+12>>2]=E}function Ha(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0;if(v=y,m=a[v>>2]|0,v=a[v+4>>2]|0,!((m|0)==0&(v|0)==0)&&(E=ne(m|0,v|0,52)|0,Me()|0,E=E&15,N=ue(1,0,(E^15)*3|0)|0,m=d(N|0,Me()|0,m|0,v|0)|0,v=Me()|0,N=y,a[N>>2]=m,a[N+4>>2]=v,N=y+8|0,O=a[N>>2]|0,!((E|0)<(O|0)))){for(Q=y+12|0,R=E;;){if((R|0)==(O|0)){E=5;break}if(J=(R|0)==(a[Q>>2]|0),P=(15-R|0)*3|0,E=ne(m|0,v|0,P|0)|0,Me()|0,E=E&7,J&((E|0)==1&!0)){E=7;break}if(!((E|0)==7&!0)){E=10;break}if(J=ue(1,0,P|0)|0,m=d(m|0,v|0,J|0,Me()|0)|0,v=Me()|0,J=y,a[J>>2]=m,a[J+4>>2]=v,(R|0)>(O|0))R=R+-1|0;else{E=10;break}}if((E|0)==5){J=y,a[J>>2]=0,a[J+4>>2]=0,a[N>>2]=-1,a[Q>>2]=-1;return}else if((E|0)==7){O=ue(1,0,P|0)|0,O=d(m|0,v|0,O|0,Me()|0)|0,N=Me()|0,J=y,a[J>>2]=O,a[J+4>>2]=N,a[Q>>2]=R+-1;return}else if((E|0)==10)return}}function ni(y){y=+y;var m=0;return m=y<0?y+6.283185307179586:y,+(y>=6.283185307179586?m+-6.283185307179586:m)}function Es(y,m){return y=y|0,m=m|0,+ke(+(+G[y>>3]-+G[m>>3]))<17453292519943298e-27?(m=+ke(+(+G[y+8>>3]-+G[m+8>>3]))<17453292519943298e-27,m|0):(m=0,m|0)}function Zi(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0;return P=+G[m>>3],E=+G[y>>3],R=+ft(+((P-E)*.5)),v=+ft(+((+G[m+8>>3]-+G[y+8>>3])*.5)),v=R*R+v*(+We(+P)*+We(+E)*v),+(+pn(+ +qe(+v),+ +qe(+(1-v)))*2)}function Pl(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0;return P=+G[m>>3],E=+G[y>>3],R=+ft(+((P-E)*.5)),v=+ft(+((+G[m+8>>3]-+G[y+8>>3])*.5)),v=R*R+v*(+We(+P)*+We(+E)*v),+(+pn(+ +qe(+v),+ +qe(+(1-v)))*2*6371.007180918475)}function Ho(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0;return P=+G[m>>3],E=+G[y>>3],R=+ft(+((P-E)*.5)),v=+ft(+((+G[m+8>>3]-+G[y+8>>3])*.5)),v=R*R+v*(+We(+P)*+We(+E)*v),+(+pn(+ +qe(+v),+ +qe(+(1-v)))*2*6371.007180918475*1e3)}function pc(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0;return R=+G[m>>3],E=+We(+R),P=+G[m+8>>3]-+G[y+8>>3],O=E*+ft(+P),v=+G[y>>3],+ +pn(+O,+(+ft(+R)*+We(+v)-+We(+P)*(E*+ft(+v))))}function vo(y,m,v,E){y=y|0,m=+m,v=+v,E=E|0;var P=0,R=0,O=0,N=0;if(v<1e-16){a[E>>2]=a[y>>2],a[E+4>>2]=a[y+4>>2],a[E+8>>2]=a[y+8>>2],a[E+12>>2]=a[y+12>>2];return}R=m<0?m+6.283185307179586:m,R=m>=6.283185307179586?R+-6.283185307179586:R;do if(R<1e-16)m=+G[y>>3]+v,G[E>>3]=m,P=E;else{if(P=+ke(+(R+-3.141592653589793))<1e-16,m=+G[y>>3],P){m=m-v,G[E>>3]=m,P=E;break}if(O=+We(+v),v=+ft(+v),m=O*+ft(+m)+ +We(+R)*(v*+We(+m)),m=m>1?1:m,m=+sn(+(m<-1?-1:m)),G[E>>3]=m,+ke(+(m+-1.5707963267948966))<1e-16){G[E>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+ke(+(m+1.5707963267948966))<1e-16){G[E>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(N=+We(+m),R=v*+ft(+R)/N,v=+G[y>>3],m=(O-+ft(+m)*+ft(+v))/+We(+v)/N,O=R>1?1:R,m=m>1?1:m,m=+G[y+8>>3]+ +pn(+(O<-1?-1:O),+(m<-1?-1:m)),m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);G[E+8>>3]=m;return}while(0);if(+ke(+(m+-1.5707963267948966))<1e-16){G[P>>3]=1.5707963267948966,G[E+8>>3]=0;return}if(+ke(+(m+1.5707963267948966))<1e-16){G[P>>3]=-1.5707963267948966,G[E+8>>3]=0;return}if(m=+G[y+8>>3],m>3.141592653589793)do m=m+-6.283185307179586;while(m>3.141592653589793);if(m<-3.141592653589793)do m=m+6.283185307179586;while(m<-3.141592653589793);G[E+8>>3]=m}function Il(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20528+(y<<3)>>3],m=0,m|0)}function Wa(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20656+(y<<3)>>3],m=0,m|0)}function gh(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20784+(y<<3)>>3],m=0,m|0)}function mh(y,m){return y=y|0,m=m|0,y>>>0>15?(m=4,m|0):(G[m>>3]=+G[20912+(y<<3)>>3],m=0,m|0)}function Qa(y,m){y=y|0,m=m|0;var v=0;return y>>>0>15?(m=4,m|0):(v=$s(7,0,y,((y|0)<0)<<31>>31)|0,v=V(v|0,Me()|0,120,0)|0,y=Me()|0,a[m>>2]=v|2,a[m+4>>2]=y,m=0,m|0)}function ga(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;return Re=+G[m>>3],le=+G[y>>3],Q=+ft(+((Re-le)*.5)),R=+G[m+8>>3],J=+G[y+8>>3],O=+ft(+((R-J)*.5)),N=+We(+le),de=+We(+Re),O=Q*Q+O*(de*N*O),O=+pn(+ +qe(+O),+ +qe(+(1-O)))*2,Q=+G[v>>3],Re=+ft(+((Q-Re)*.5)),E=+G[v+8>>3],R=+ft(+((E-R)*.5)),P=+We(+Q),R=Re*Re+R*(de*P*R),R=+pn(+ +qe(+R),+ +qe(+(1-R)))*2,Q=+ft(+((le-Q)*.5)),E=+ft(+((J-E)*.5)),E=Q*Q+E*(N*P*E),E=+pn(+ +qe(+E),+ +qe(+(1-E)))*2,P=(O+R+E)*.5,+(+jt(+ +qe(+(+Dt(+(P*.5))*+Dt(+((P-O)*.5))*+Dt(+((P-R)*.5))*+Dt(+((P-E)*.5)))))*4)}function us(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0;if(N=we,we=we+192|0,R=N+168|0,O=N,P=_o(y,m,R)|0,P|0)return v=P,we=N,v|0;if(hi(y,m,O)|0&&un(23313,22742,386,22751),m=a[O>>2]|0,(m|0)>0){if(E=+ga(O+8|0,O+8+(((m|0)!=1&1)<<4)|0,R)+0,(m|0)!=1){y=1;do P=y,y=y+1|0,E=E+ +ga(O+8+(P<<4)|0,O+8+(((y|0)%(m|0)|0)<<4)|0,R);while((y|0)<(m|0))}}else E=0;return G[v>>3]=E,v=0,we=N,v|0}function Nt(y,m,v){return y=y|0,m=m|0,v=v|0,y=us(y,m,v)|0,y|0||(G[v>>3]=+G[v>>3]*6371.007180918475*6371.007180918475),y|0}function su(y,m,v){return y=y|0,m=m|0,v=v|0,y=us(y,m,v)|0,y|0||(G[v>>3]=+G[v>>3]*6371.007180918475*6371.007180918475*1e3*1e3),y|0}function ma(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(N=we,we=we+176|0,O=N,y=Fs(y,m,O)|0,y|0)return O=y,we=N,O|0;if(G[v>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,we=N,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],P=+G[O+16>>3],R=0;do y=y+1|0,J=E,E=+G[O+8+(y<<4)>>3],le=+ft(+((E-J)*.5)),Q=P,P=+G[O+8+(y<<4)+8>>3],Q=+ft(+((P-Q)*.5)),Q=le*le+Q*(+We(+E)*+We(+J)*Q),R=R+ +pn(+ +qe(+Q),+ +qe(+(1-Q)))*2;while((y|0)<(m|0));return G[v>>3]=R,O=0,we=N,O|0}function Wo(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(N=we,we=we+176|0,O=N,y=Fs(y,m,O)|0,y|0)return O=y,R=+G[v>>3],R=R*6371.007180918475,G[v>>3]=R,we=N,O|0;if(G[v>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,R=0,R=R*6371.007180918475,G[v>>3]=R,we=N,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],P=+G[O+16>>3],R=0;do y=y+1|0,J=E,E=+G[O+8+(y<<4)>>3],le=+ft(+((E-J)*.5)),Q=P,P=+G[O+8+(y<<4)+8>>3],Q=+ft(+((P-Q)*.5)),Q=le*le+Q*(+We(+J)*+We(+E)*Q),R=R+ +pn(+ +qe(+Q),+ +qe(+(1-Q)))*2;while((y|0)!=(m|0));return G[v>>3]=R,O=0,le=R,le=le*6371.007180918475,G[v>>3]=le,we=N,O|0}function ou(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(N=we,we=we+176|0,O=N,y=Fs(y,m,O)|0,y|0)return O=y,R=+G[v>>3],R=R*6371.007180918475,R=R*1e3,G[v>>3]=R,we=N,O|0;if(G[v>>3]=0,y=a[O>>2]|0,(y|0)<=1)return O=0,R=0,R=R*6371.007180918475,R=R*1e3,G[v>>3]=R,we=N,O|0;m=y+-1|0,y=0,E=+G[O+8>>3],P=+G[O+16>>3],R=0;do y=y+1|0,J=E,E=+G[O+8+(y<<4)>>3],le=+ft(+((E-J)*.5)),Q=P,P=+G[O+8+(y<<4)+8>>3],Q=+ft(+((P-Q)*.5)),Q=le*le+Q*(+We(+J)*+We(+E)*Q),R=R+ +pn(+ +qe(+Q),+ +qe(+(1-Q)))*2;while((y|0)!=(m|0));return G[v>>3]=R,O=0,le=R,le=le*6371.007180918475,le=le*1e3,G[v>>3]=le,we=N,O|0}function Vt(y){y=y|0;var m=0,v=0,E=0;return m=h(1,12)|0,m||un(22832,22787,49,22845),v=y+4|0,E=a[v>>2]|0,E|0?(E=E+8|0,a[E>>2]=m,a[v>>2]=m,m|0):(a[y>>2]|0&&un(22862,22787,61,22885),E=y,a[E>>2]=m,a[v>>2]=m,m|0)}function yA(y,m){y=y|0,m=m|0;var v=0,E=0;return E=_(24)|0,E||un(22899,22787,78,22913),a[E>>2]=a[m>>2],a[E+4>>2]=a[m+4>>2],a[E+8>>2]=a[m+8>>2],a[E+12>>2]=a[m+12>>2],a[E+16>>2]=0,m=y+4|0,v=a[m>>2]|0,v|0?(a[v+16>>2]=E,a[m>>2]=E,E|0):(a[y>>2]|0&&un(22928,22787,82,22913),a[y>>2]=E,a[m>>2]=E,E|0)}function kl(y){y=y|0;var m=0,v=0,E=0,P=0;if(y)for(E=1;;){if(m=a[y>>2]|0,m|0)do{if(v=a[m>>2]|0,v|0)do P=v,v=a[v+16>>2]|0,l(P);while(v|0);P=m,m=a[m+8>>2]|0,l(P)}while(m|0);if(m=y,y=a[y+8>>2]|0,E||l(m),y)E=0;else break}}function _A(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0,Je=0,Gt=0,zt=0,dt=0,vt=0,Pn=0,wn=0,mn=0,_n=0,En=0,Dn=0,sr=0,In=0;if(P=y+8|0,a[P>>2]|0)return In=1,In|0;if(E=a[y>>2]|0,!E)return In=0,In|0;m=E,v=0;do v=v+1|0,m=a[m+8>>2]|0;while(m|0);if(v>>>0<2)return In=0,In|0;Dn=_(v<<2)|0,Dn||un(22948,22787,317,22967),En=_(v<<5)|0,En||un(22989,22787,321,22967),a[y>>2]=0,zt=y+4|0,a[zt>>2]=0,a[P>>2]=0,v=0,_n=0,Gt=0,de=0;e:for(;;){if(le=a[E>>2]|0,le){R=0,O=le;do{if(Q=+G[O+8>>3],m=O,O=a[O+16>>2]|0,J=(O|0)==0,P=J?le:O,N=+G[P+8>>3],+ke(+(Q-N))>3.141592653589793){In=14;break}R=R+(N-Q)*(+G[m>>3]+ +G[P>>3])}while(!J);if((In|0)==14){In=0,R=0,m=le;do Je=+G[m+8>>3],mn=m+16|0,wn=a[mn>>2]|0,wn=wn|0?wn:le,st=+G[wn+8>>3],R=R+(+G[m>>3]+ +G[wn>>3])*((st<0?st+6.283185307179586:st)-(Je<0?Je+6.283185307179586:Je)),m=a[(m|0?mn:E)>>2]|0;while(m|0)}R>0?(a[Dn+(_n<<2)>>2]=E,_n=_n+1|0,P=Gt,m=de):In=19}else In=19;if((In|0)==19){In=0;do if(v){if(m=v+8|0,a[m>>2]|0){In=21;break e}if(v=h(1,12)|0,!v){In=23;break e}a[m>>2]=v,P=v+4|0,O=v,m=de}else if(de){P=zt,O=de+8|0,m=E,v=y;break}else if(a[y>>2]|0){In=27;break e}else{P=zt,O=y,m=E,v=y;break}while(0);if(a[O>>2]=E,a[P>>2]=E,O=En+(Gt<<5)|0,J=a[E>>2]|0,J){for(le=En+(Gt<<5)+8|0,G[le>>3]=17976931348623157e292,de=En+(Gt<<5)+24|0,G[de>>3]=17976931348623157e292,G[O>>3]=-17976931348623157e292,Re=En+(Gt<<5)+16|0,G[Re>>3]=-17976931348623157e292,ut=17976931348623157e292,it=-17976931348623157e292,P=0,$e=J,Q=17976931348623157e292,Xe=17976931348623157e292,ht=-17976931348623157e292,N=-17976931348623157e292;R=+G[$e>>3],Je=+G[$e+8>>3],$e=a[$e+16>>2]|0,Be=($e|0)==0,st=+G[(Be?J:$e)+8>>3],R<Q&&(G[le>>3]=R,Q=R),Je<Xe&&(G[de>>3]=Je,Xe=Je),R>ht?G[O>>3]=R:R=ht,Je>N&&(G[Re>>3]=Je,N=Je),ut=Je>0&Je<ut?Je:ut,it=Je<0&Je>it?Je:it,P=P|+ke(+(Je-st))>3.141592653589793,!Be;)ht=R;P&&(G[Re>>3]=it,G[de>>3]=ut)}else a[O>>2]=0,a[O+4>>2]=0,a[O+8>>2]=0,a[O+12>>2]=0,a[O+16>>2]=0,a[O+20>>2]=0,a[O+24>>2]=0,a[O+28>>2]=0;P=Gt+1|0}if(mn=E+8|0,E=a[mn>>2]|0,a[mn>>2]=0,E)Gt=P,de=m;else{In=45;break}}if((In|0)==21)un(22765,22787,35,22799);else if((In|0)==23)un(22819,22787,37,22799);else if((In|0)==27)un(22862,22787,61,22885);else if((In|0)==45){e:do if((_n|0)>0){for(mn=(P|0)==0,Pn=P<<2,wn=(y|0)==0,vt=0,m=0;;){if(dt=a[Dn+(vt<<2)>>2]|0,mn)In=73;else{if(Gt=_(Pn)|0,!Gt){In=50;break}if(zt=_(Pn)|0,!zt){In=52;break}t:do if(wn)v=0;else{for(P=0,v=0,O=y;E=En+(P<<5)|0,qa(a[O>>2]|0,E,a[dt>>2]|0)|0?(a[Gt+(v<<2)>>2]=O,a[zt+(v<<2)>>2]=E,Be=v+1|0):Be=v,O=a[O+8>>2]|0,O;)P=P+1|0,v=Be;if((Be|0)>0)if(E=a[Gt>>2]|0,(Be|0)==1)v=E;else for(Re=0,$e=-1,v=E,de=E;;){for(J=a[de>>2]|0,E=0,O=0;P=a[a[Gt+(O<<2)>>2]>>2]|0,(P|0)==(J|0)?le=E:le=E+((qa(P,a[zt+(O<<2)>>2]|0,a[J>>2]|0)|0)&1)|0,O=O+1|0,(O|0)!=(Be|0);)E=le;if(P=(le|0)>($e|0),v=P?de:v,E=Re+1|0,(E|0)==(Be|0))break t;Re=E,$e=P?le:$e,de=a[Gt+(E<<2)>>2]|0}else v=0}while(0);if(l(Gt),l(zt),v){if(P=v+4|0,E=a[P>>2]|0,E)v=E+8|0;else if(a[v>>2]|0){In=70;break}a[v>>2]=dt,a[P>>2]=dt}else In=73}if((In|0)==73){if(In=0,m=a[dt>>2]|0,m|0)do zt=m,m=a[m+16>>2]|0,l(zt);while(m|0);l(dt),m=1}if(vt=vt+1|0,(vt|0)>=(_n|0)){sr=m;break e}}(In|0)==50?un(23004,22787,249,23023):(In|0)==52?un(23042,22787,252,23023):(In|0)==70&&un(22862,22787,61,22885)}else sr=0;while(0);return l(Dn),l(En),In=sr,In|0}return 0}function qa(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0;if(!(ZA(m,v)|0)||(m=Yn(m)|0,E=+G[v>>3],P=+G[v+8>>3],P=m&P<0?P+6.283185307179586:P,y=a[y>>2]|0,!y))return y=0,y|0;if(m){m=0,J=P,v=y;e:for(;;){for(;O=+G[v>>3],P=+G[v+8>>3],v=v+16|0,le=a[v>>2]|0,le=le|0?le:y,R=+G[le>>3],N=+G[le+8>>3],O>R?(Q=O,O=N):(Q=R,R=O,O=P,P=N),E=E==R|E==Q?E+2220446049250313e-31:E,!!(E<R|E>Q);)if(v=a[v>>2]|0,!v){v=22;break e}if(N=O<0?O+6.283185307179586:O,O=P<0?P+6.283185307179586:P,J=N==J|O==J?J+-2220446049250313e-31:J,Q=N+(O-N)*((E-R)/(Q-R)),(Q<0?Q+6.283185307179586:Q)>J&&(m=m^1),v=a[v>>2]|0,!v){v=22;break}}if((v|0)==22)return m|0}else{m=0,J=P,v=y;e:for(;;){for(;O=+G[v>>3],P=+G[v+8>>3],v=v+16|0,le=a[v>>2]|0,le=le|0?le:y,R=+G[le>>3],N=+G[le+8>>3],O>R?(Q=O,O=N):(Q=R,R=O,O=P,P=N),E=E==R|E==Q?E+2220446049250313e-31:E,!!(E<R|E>Q);)if(v=a[v>>2]|0,!v){v=22;break e}if(J=O==J|P==J?J+-2220446049250313e-31:J,O+(P-O)*((E-R)/(Q-R))>J&&(m=m^1),v=a[v>>2]|0,!v){v=22;break}}if((v|0)==22)return m|0}return 0}function Gs(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0;if(it=we,we=we+32|0,ut=it+16|0,ht=it,R=ne(y|0,m|0,52)|0,Me()|0,R=R&15,$e=ne(v|0,E|0,52)|0,Me()|0,(R|0)!=($e&15|0))return ut=12,we=it,ut|0;if(J=ne(y|0,m|0,45)|0,Me()|0,J=J&127,le=ne(v|0,E|0,45)|0,Me()|0,le=le&127,J>>>0>121|le>>>0>121)return ut=5,we=it,ut|0;if($e=(J|0)!=(le|0),$e){if(N=yl(J,le)|0,(N|0)==7)return ut=1,we=it,ut|0;Q=yl(le,J)|0,(Q|0)==7?un(23066,23090,161,23100):(Be=N,O=Q)}else Be=0,O=0;de=Gn(J)|0,Re=Gn(le)|0,a[ut>>2]=0,a[ut+4>>2]=0,a[ut+8>>2]=0,a[ut+12>>2]=0;do if(Be){if(le=a[4272+(J*28|0)+(Be<<2)>>2]|0,N=(le|0)>0,Re)if(N){J=0,Q=v,N=E;do Q=fc(Q,N)|0,N=Me()|0,O=Go(O)|0,(O|0)==1&&(O=Go(1)|0),J=J+1|0;while((J|0)!=(le|0));le=O,J=Q,Q=N}else le=O,J=v,Q=E;else if(N){J=0,Q=v,N=E;do Q=mA(Q,N)|0,N=Me()|0,O=Go(O)|0,J=J+1|0;while((J|0)!=(le|0));le=O,J=Q,Q=N}else le=O,J=v,Q=E;if(da(J,Q,ut)|0,$e||un(23115,23090,191,23100),N=(de|0)!=0,O=(Re|0)!=0,N&O&&un(23142,23090,192,23100),N){if(O=ti(y,m)|0,(O|0)==7){R=5;break}if(he[21872+(O*7|0)+Be>>0]|0){R=1;break}Q=a[21040+(O*28|0)+(Be<<2)>>2]|0,J=Q}else if(O){if(O=ti(J,Q)|0,(O|0)==7){R=5;break}if(he[21872+(O*7|0)+le>>0]|0){R=1;break}J=0,Q=a[21040+(le*28|0)+(O<<2)>>2]|0}else J=0,Q=0;if((J|Q|0)<0)R=5;else{if((Q|0)>0){N=ut+4|0,O=0;do xl(N),O=O+1|0;while((O|0)!=(Q|0))}if(a[ht>>2]=0,a[ht+4>>2]=0,a[ht+8>>2]=0,$i(ht,Be),R|0)for(;_i(R)|0?Vo(ht):Gi(ht),(R|0)>1;)R=R+-1|0;if((J|0)>0){R=0;do xl(ht),R=R+1|0;while((R|0)!=(J|0))}Xe=ut+4|0,ei(Xe,ht,Xe),zn(Xe),Xe=51}}else if(da(v,E,ut)|0,(de|0)!=0&(Re|0)!=0)if((le|0)!=(J|0)&&un(23173,23090,261,23100),O=ti(y,m)|0,R=ti(v,E)|0,(O|0)==7|(R|0)==7)R=5;else if(he[21872+(O*7|0)+R>>0]|0)R=1;else if(O=a[21040+(O*28|0)+(R<<2)>>2]|0,(O|0)>0){N=ut+4|0,R=0;do xl(N),R=R+1|0;while((R|0)!=(O|0));Xe=51}else Xe=51;else Xe=51;while(0);return(Xe|0)==51&&(R=ut+4|0,a[P>>2]=a[R>>2],a[P+4>>2]=a[R+4>>2],a[P+8>>2]=a[R+8>>2],R=0),ut=R,we=it,ut|0}function au(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0;if(Xe=we,we=we+48|0,J=Xe+36|0,O=Xe+24|0,N=Xe+12|0,Q=Xe,P=ne(y|0,m|0,52)|0,Me()|0,P=P&15,Re=ne(y|0,m|0,45)|0,Me()|0,Re=Re&127,Re>>>0>121)return E=5,we=Xe,E|0;if(le=Gn(Re)|0,ue(P|0,0,52)|0,ht=Me()|0|134225919,R=E,a[R>>2]=-1,a[R+4>>2]=ht,!P)return P=Uo(v)|0,(P|0)==7||(P=ml(Re,P)|0,(P|0)==127)?(ht=1,we=Xe,ht|0):($e=ue(P|0,0,45)|0,Be=Me()|0,Re=E,Be=a[Re+4>>2]&-1040385|Be,ht=E,a[ht>>2]=a[Re>>2]|$e,a[ht+4>>2]=Be,ht=0,we=Xe,ht|0);for(a[J>>2]=a[v>>2],a[J+4>>2]=a[v+4>>2],a[J+8>>2]=a[v+8>>2],v=P;;){if(R=v,v=v+-1|0,a[O>>2]=a[J>>2],a[O+4>>2]=a[J+4>>2],a[O+8>>2]=a[J+8>>2],_i(R)|0){if(P=ua(J)|0,P|0){v=13;break}a[N>>2]=a[J>>2],a[N+4>>2]=a[J+4>>2],a[N+8>>2]=a[J+8>>2],Vo(N)}else{if(P=go(J)|0,P|0){v=13;break}a[N>>2]=a[J>>2],a[N+4>>2]=a[J+4>>2],a[N+8>>2]=a[J+8>>2],Gi(N)}if(po(O,N,Q),zn(Q),P=E,it=a[P>>2]|0,P=a[P+4>>2]|0,st=(15-R|0)*3|0,ut=ue(7,0,st|0)|0,P=P&~(Me()|0),st=ue(Uo(Q)|0,0,st|0)|0,P=Me()|0|P,ht=E,a[ht>>2]=st|it&~ut,a[ht+4>>2]=P,(R|0)<=1){v=14;break}}e:do if((v|0)!=13&&(v|0)==14)if((a[J>>2]|0)<=1&&(a[J+4>>2]|0)<=1&&(a[J+8>>2]|0)<=1){v=Uo(J)|0,P=ml(Re,v)|0,(P|0)==127?Q=0:Q=Gn(P)|0;t:do if(v){if(le){if(P=ti(y,m)|0,(P|0)==7){P=5;break e}if(R=a[21248+(P*28|0)+(v<<2)>>2]|0,(R|0)>0){P=v,v=0;do P=mo(P)|0,v=v+1|0;while((v|0)!=(R|0))}else P=v;if((P|0)==1){P=9;break e}v=ml(Re,P)|0,(v|0)==127&&un(23200,23090,411,23230),Gn(v)|0?un(23245,23090,412,23230):(Be=v,$e=R,de=P)}else Be=P,$e=0,de=v;if(N=a[4272+(Re*28|0)+(de<<2)>>2]|0,(N|0)<=-1&&un(23276,23090,419,23230),!Q){if(($e|0)<0){P=5;break e}if($e|0){R=E,P=0,v=a[R>>2]|0,R=a[R+4>>2]|0;do v=Us(v,R)|0,R=Me()|0,st=E,a[st>>2]=v,a[st+4>>2]=R,P=P+1|0;while((P|0)<($e|0))}if((N|0)<=0){P=Be,v=58;break}for(R=E,P=0,v=a[R>>2]|0,R=a[R+4>>2]|0;;)if(v=Us(v,R)|0,R=Me()|0,st=E,a[st>>2]=v,a[st+4>>2]=R,P=P+1|0,(P|0)==(N|0)){P=Be,v=58;break t}}if(O=yl(Be,Re)|0,(O|0)==7&&un(23066,23090,428,23230),P=E,v=a[P>>2]|0,P=a[P+4>>2]|0,(N|0)>0){R=0;do v=Us(v,P)|0,P=Me()|0,st=E,a[st>>2]=v,a[st+4>>2]=P,R=R+1|0;while((R|0)!=(N|0))}if(P=ti(v,P)|0,(P|0)==7&&un(23313,23090,440,23230),v=lA(Be)|0,v=a[(v?21664:21456)+(O*28|0)+(P<<2)>>2]|0,(v|0)<0&&un(23313,23090,454,23230),!v)P=Be,v=58;else{O=E,P=0,R=a[O>>2]|0,O=a[O+4>>2]|0;do R=iu(R,O)|0,O=Me()|0,st=E,a[st>>2]=R,a[st+4>>2]=O,P=P+1|0;while((P|0)<(v|0));P=Be,v=58}}else if((le|0)!=0&(Q|0)!=0){if(v=ti(y,m)|0,R=E,R=ti(a[R>>2]|0,a[R+4>>2]|0)|0,(v|0)==7|(R|0)==7){P=5;break e}if(R=a[21248+(v*28|0)+(R<<2)>>2]|0,(R|0)<0){P=5;break e}if(!R)v=59;else{N=E,v=0,O=a[N>>2]|0,N=a[N+4>>2]|0;do O=Us(O,N)|0,N=Me()|0,st=E,a[st>>2]=O,a[st+4>>2]=N,v=v+1|0;while((v|0)<(R|0));v=58}}else v=58;while(0);if((v|0)==58&&Q&&(v=59),(v|0)==59&&(st=E,(ti(a[st>>2]|0,a[st+4>>2]|0)|0)==1)){P=9;break}st=E,ut=a[st>>2]|0,st=a[st+4>>2]&-1040385,it=ue(P|0,0,45)|0,st=st|(Me()|0),P=E,a[P>>2]=ut|it,a[P+4>>2]=st,P=0}else P=1;while(0);return st=P,we=Xe,st|0}function yh(y,m,v,E,P,R){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0,R=R|0;var O=0,N=0;return N=we,we=we+16|0,O=N,P?y=15:(y=Gs(y,m,v,E,O)|0,y||(pA(O,R),y=0)),we=N,y|0}function gc(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0;return O=we,we=we+16|0,R=O,E?v=15:(v=KA(v,R)|0,v||(v=au(y,m,R,P)|0)),we=O,v|0}function lu(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0;return Q=we,we=we+32|0,O=Q+12|0,N=Q,R=Gs(y,m,y,m,O)|0,R|0?(N=R,we=Q,N|0):(y=Gs(y,m,v,E,N)|0,y|0?(N=y,we=Q,N|0):(O=wl(O,N)|0,N=P,a[N>>2]=O,a[N+4>>2]=((O|0)<0)<<31>>31,N=0,we=Q,N|0))}function Au(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0;return Q=we,we=we+32|0,O=Q+12|0,N=Q,R=Gs(y,m,y,m,O)|0,!R&&(R=Gs(y,m,v,E,N)|0,!R)?(E=wl(O,N)|0,E=d(E|0,((E|0)<0)<<31>>31|0,1,0)|0,O=Me()|0,N=P,a[N>>2]=E,a[N+4>>2]=O,N=0,we=Q,N|0):(N=R,we=Q,N|0)}function uu(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0,Je=0,Gt=0,zt=0,dt=0,vt=0;if(dt=we,we=we+48|0,O=dt+24|0,N=dt+12|0,zt=dt,R=Gs(y,m,y,m,O)|0,!R&&(R=Gs(y,m,v,E,N)|0,!R)){Je=wl(O,N)|0,Gt=((Je|0)<0)<<31>>31,a[O>>2]=0,a[O+4>>2]=0,a[O+8>>2]=0,a[N>>2]=0,a[N+4>>2]=0,a[N+8>>2]=0,Gs(y,m,y,m,O)|0&&un(23313,23090,691,23299),Gs(y,m,v,E,N)|0&&un(23313,23090,696,23299),$o(O),$o(N),Je?(de=a[O>>2]|0,Be=+(Je|0),ut=O+4|0,Re=a[ut>>2]|0,it=O+8|0,$e=a[it>>2]|0,st=O,E=de,R=Re,v=$e,Xe=+((a[N>>2]|0)-de|0)/Be,ht=+((a[N+4>>2]|0)-Re|0)/Be,Be=+((a[N+8>>2]|0)-$e|0)/Be):(R=O+4|0,v=O+8|0,ut=R,it=v,st=O,E=a[O>>2]|0,R=a[R>>2]|0,v=a[v>>2]|0,Xe=0,ht=0,Be=0),a[zt>>2]=E,$e=zt+4|0,a[$e>>2]=R,Re=zt+8|0,a[Re>>2]=v;e:do if((Je|0)<0)R=0;else for(le=0,de=0,R=E;;){J=+(de>>>0)+4294967296*+(le|0),vt=Xe*J+ +(R|0),Q=ht*J+ +(a[ut>>2]|0),J=Be*J+ +(a[it>>2]|0),v=~~+ve(+vt),O=~~+ve(+Q),R=~~+ve(+J),vt=+ke(+(+(v|0)-vt)),Q=+ke(+(+(O|0)-Q)),J=+ke(+(+(R|0)-J));do if(vt>Q&vt>J)v=0-(O+R)|0,E=O;else if(N=0-v|0,Q>J){E=N-R|0;break}else{E=O,R=N-O|0;break}while(0);if(a[zt>>2]=v,a[$e>>2]=E,a[Re>>2]=R,Ua(zt),R=au(y,m,zt,P+(de<<3)|0)|0,R|0)break e;if(!((le|0)<(Gt|0)|(le|0)==(Gt|0)&de>>>0<Je>>>0)){R=0;break e}R=d(de|0,le|0,1,0)|0,N=Me()|0,le=N,de=R,R=a[st>>2]|0}while(0);return zt=R,we=dt,zt|0}return zt=R,we=dt,zt|0}function $s(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0;if((v|0)==0&(E|0)==0)return P=0,R=1,Ct(P|0),R|0;R=y,P=m,y=1,m=0;do O=(v&1|0)==0&!0,y=V((O?1:R)|0,(O?0:P)|0,y|0,m|0)|0,m=Me()|0,v=ae(v|0,E|0,1)|0,E=Me()|0,R=V(R|0,P|0,R|0,P|0)|0,P=Me()|0;while(!((v|0)==0&(E|0)==0));return Ct(m|0),y|0}function ki(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;if(!(ZA(m,v)|0)||(m=Yn(m)|0,E=+G[v>>3],P=+G[v+8>>3],P=m&P<0?P+6.283185307179586:P,Re=a[y>>2]|0,(Re|0)<=0))return Re=0,Re|0;if(de=a[y+4>>2]|0,m){m=0,le=P,v=-1,y=0;e:for(;;){for(J=y;O=+G[de+(J<<4)>>3],P=+G[de+(J<<4)+8>>3],y=(v+2|0)%(Re|0)|0,R=+G[de+(y<<4)>>3],N=+G[de+(y<<4)+8>>3],O>R?(Q=O,O=N):(Q=R,R=O,O=P,P=N),E=E==R|E==Q?E+2220446049250313e-31:E,!!(E<R|E>Q);)if(v=J+1|0,(v|0)>=(Re|0)){v=22;break e}else y=J,J=v,v=y;if(N=O<0?O+6.283185307179586:O,O=P<0?P+6.283185307179586:P,le=N==le|O==le?le+-2220446049250313e-31:le,Q=N+(O-N)*((E-R)/(Q-R)),(Q<0?Q+6.283185307179586:Q)>le&&(m=m^1),y=J+1|0,(y|0)>=(Re|0)){v=22;break}else v=J}if((v|0)==22)return m|0}else{m=0,le=P,v=-1,y=0;e:for(;;){for(J=y;O=+G[de+(J<<4)>>3],P=+G[de+(J<<4)+8>>3],y=(v+2|0)%(Re|0)|0,R=+G[de+(y<<4)>>3],N=+G[de+(y<<4)+8>>3],O>R?(Q=O,O=N):(Q=R,R=O,O=P,P=N),E=E==R|E==Q?E+2220446049250313e-31:E,!!(E<R|E>Q);)if(v=J+1|0,(v|0)>=(Re|0)){v=22;break e}else y=J,J=v,v=y;if(le=O==le|P==le?le+-2220446049250313e-31:le,O+(P-O)*((E-R)/(Q-R))>le&&(m=m^1),y=J+1|0,(y|0)>=(Re|0)){v=22;break}else v=J}if((v|0)==22)return m|0}return 0}function xo(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0;if(Be=a[y>>2]|0,!Be){a[m>>2]=0,a[m+4>>2]=0,a[m+8>>2]=0,a[m+12>>2]=0,a[m+16>>2]=0,a[m+20>>2]=0,a[m+24>>2]=0,a[m+28>>2]=0;return}if(Xe=m+8|0,G[Xe>>3]=17976931348623157e292,ht=m+24|0,G[ht>>3]=17976931348623157e292,G[m>>3]=-17976931348623157e292,ut=m+16|0,G[ut>>3]=-17976931348623157e292,!((Be|0)<=0)){for(Re=a[y+4>>2]|0,J=17976931348623157e292,le=-17976931348623157e292,de=0,y=-1,R=17976931348623157e292,O=17976931348623157e292,Q=-17976931348623157e292,E=-17976931348623157e292,$e=0;v=+G[Re+($e<<4)>>3],N=+G[Re+($e<<4)+8>>3],y=y+2|0,P=+G[Re+(((y|0)==(Be|0)?0:y)<<4)+8>>3],v<R&&(G[Xe>>3]=v,R=v),N<O&&(G[ht>>3]=N,O=N),v>Q?G[m>>3]=v:v=Q,N>E&&(G[ut>>3]=N,E=N),J=N>0&N<J?N:J,le=N<0&N>le?N:le,de=de|+ke(+(N-P))>3.141592653589793,y=$e+1|0,(y|0)!=(Be|0);)it=$e,Q=v,$e=y,y=it;de&&(G[ut>>3]=le,G[ht>>3]=J)}}function cu(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0,Je=0,Gt=0,zt=0,dt=0;if(Be=a[y>>2]|0,Be){if(Xe=m+8|0,G[Xe>>3]=17976931348623157e292,ht=m+24|0,G[ht>>3]=17976931348623157e292,G[m>>3]=-17976931348623157e292,ut=m+16|0,G[ut>>3]=-17976931348623157e292,(Be|0)>0){for(P=a[y+4>>2]|0,Re=17976931348623157e292,$e=-17976931348623157e292,E=0,v=-1,Q=17976931348623157e292,J=17976931348623157e292,de=-17976931348623157e292,O=-17976931348623157e292,it=0;R=+G[P+(it<<4)>>3],le=+G[P+(it<<4)+8>>3],zt=v+2|0,N=+G[P+(((zt|0)==(Be|0)?0:zt)<<4)+8>>3],R<Q&&(G[Xe>>3]=R,Q=R),le<J&&(G[ht>>3]=le,J=le),R>de?G[m>>3]=R:R=de,le>O&&(G[ut>>3]=le,O=le),Re=le>0&le<Re?le:Re,$e=le<0&le>$e?le:$e,E=E|+ke(+(le-N))>3.141592653589793,v=it+1|0,(v|0)!=(Be|0);)zt=it,de=R,it=v,v=zt;E&&(G[ut>>3]=$e,G[ht>>3]=Re)}}else a[m>>2]=0,a[m+4>>2]=0,a[m+8>>2]=0,a[m+12>>2]=0,a[m+16>>2]=0,a[m+20>>2]=0,a[m+24>>2]=0,a[m+28>>2]=0;if(zt=y+8|0,v=a[zt>>2]|0,!((v|0)<=0)){Gt=y+12|0,Je=0;do if(P=a[Gt>>2]|0,E=Je,Je=Je+1|0,ht=m+(Je<<5)|0,ut=a[P+(E<<3)>>2]|0,ut){if(it=m+(Je<<5)+8|0,G[it>>3]=17976931348623157e292,y=m+(Je<<5)+24|0,G[y>>3]=17976931348623157e292,G[ht>>3]=-17976931348623157e292,st=m+(Je<<5)+16|0,G[st>>3]=-17976931348623157e292,(ut|0)>0){for(Be=a[P+(E<<3)+4>>2]|0,Re=17976931348623157e292,$e=-17976931348623157e292,P=0,E=-1,Xe=0,Q=17976931348623157e292,J=17976931348623157e292,le=-17976931348623157e292,O=-17976931348623157e292;R=+G[Be+(Xe<<4)>>3],de=+G[Be+(Xe<<4)+8>>3],E=E+2|0,N=+G[Be+(((E|0)==(ut|0)?0:E)<<4)+8>>3],R<Q&&(G[it>>3]=R,Q=R),de<J&&(G[y>>3]=de,J=de),R>le?G[ht>>3]=R:R=le,de>O&&(G[st>>3]=de,O=de),Re=de>0&de<Re?de:Re,$e=de<0&de>$e?de:$e,P=P|+ke(+(de-N))>3.141592653589793,E=Xe+1|0,(E|0)!=(ut|0);)dt=Xe,Xe=E,le=R,E=dt;P&&(G[st>>3]=$e,G[y>>3]=Re)}}else a[ht>>2]=0,a[ht+4>>2]=0,a[ht+8>>2]=0,a[ht+12>>2]=0,a[ht+16>>2]=0,a[ht+20>>2]=0,a[ht+24>>2]=0,a[ht+28>>2]=0,v=a[zt>>2]|0;while((Je|0)<(v|0))}}function ya(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0;if(!(ki(y,m,v)|0))return P=0,P|0;if(P=y+8|0,(a[P>>2]|0)<=0)return P=1,P|0;for(E=y+12|0,y=0;;){if(R=y,y=y+1|0,ki((a[E>>2]|0)+(R<<3)|0,m+(y<<5)|0,v)|0){y=0,E=6;break}if((y|0)>=(a[P>>2]|0)){y=1,E=6;break}}return(E|0)==6?y|0:0}function Br(){return 8}function Ll(){return 16}function mc(){return 168}function cs(){return 8}function br(){return 16}function Za(){return 12}function Dl(){return 8}function hu(y){return y=y|0,+(+((a[y>>2]|0)>>>0)+4294967296*+(a[y+4>>2]|0))}function yc(y){y=y|0;var m=0,v=0;return v=+G[y>>3],m=+G[y+8>>3],+ +qe(+(v*v+m*m))}function fu(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0;J=+G[y>>3],Q=+G[m>>3]-J,N=+G[y+8>>3],O=+G[m+8>>3]-N,de=+G[v>>3],R=+G[E>>3]-de,Re=+G[v+8>>3],le=+G[E+8>>3]-Re,R=(R*(N-Re)-(J-de)*le)/(Q*le-O*R),G[P>>3]=J+Q*R,G[P+8>>3]=N+O*R}function _c(y,m){return y=y|0,m=m|0,+ke(+(+G[y>>3]-+G[m>>3]))<11920928955078125e-23?(m=+ke(+(+G[y+8>>3]-+G[m+8>>3]))<11920928955078125e-23,m|0):(m=0,m|0)}function pr(y,m){y=y|0,m=m|0;var v=0,E=0,P=0;return P=+G[y>>3]-+G[m>>3],E=+G[y+8>>3]-+G[m+8>>3],v=+G[y+16>>3]-+G[m+16>>3],+(P*P+E*E+v*v)}function Rl(y,m){y=y|0,m=m|0;var v=0,E=0,P=0;v=+G[y>>3],E=+We(+v),v=+ft(+v),G[m+16>>3]=v,v=+G[y+8>>3],P=E*+We(+v),G[m>>3]=P,v=E*+ft(+v),G[m+8>>3]=v}function Yt(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0;if(R=we,we=we+16|0,P=R,E=dr(y,m)|0,(v+-1|0)>>>0>5||(E=(E|0)!=0,(v|0)==1&E))return P=-1,we=R,P|0;do if(Xt(y,m,P)|0)E=-1;else if(E){E=((a[21936+(v<<2)>>2]|0)+5-(a[P>>2]|0)|0)%5|0;break}else{E=((a[21968+(v<<2)>>2]|0)+6-(a[P>>2]|0)|0)%6|0;break}while(0);return P=E,we=R,P|0}function Xt(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0,J=0;if(J=we,we=we+32|0,O=J+16|0,N=J,E=qi(y,m,O)|0,E|0)return v=E,we=J,v|0;R=Ga(y,m)|0,Q=ti(y,m)|0,QA(R,N),E=qA(R,a[O>>2]|0)|0;e:do if(Gn(R)|0){do switch(R|0){case 4:{y=0;break}case 14:{y=1;break}case 24:{y=2;break}case 38:{y=3;break}case 49:{y=4;break}case 58:{y=5;break}case 63:{y=6;break}case 72:{y=7;break}case 83:{y=8;break}case 97:{y=9;break}case 107:{y=10;break}case 117:{y=11;break}default:{E=1;break e}}while(0);if(P=a[22e3+(y*24|0)+8>>2]|0,m=a[22e3+(y*24|0)+16>>2]|0,y=a[O>>2]|0,(y|0)!=(a[N>>2]|0)&&(N=lA(R)|0,y=a[O>>2]|0,N|(y|0)==(m|0)&&(E=(E+1|0)%6|0)),(Q|0)==3&(y|0)==(m|0)){E=(E+5|0)%6|0,P=22;break}(Q|0)==5&(y|0)==(P|0)&&(E=(E+1|0)%6|0),P=22}else P=22;while(0);return(P|0)==22&&(a[v>>2]=E,E=0),v=E,we=J,v|0}function hn(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0;if(st=we,we=we+32|0,it=st+24|0,ht=st+20|0,Be=st+8|0,$e=st+16|0,Re=st,Q=(dr(y,m)|0)==0,Q=Q?6:5,le=ne(y|0,m|0,52)|0,Me()|0,le=le&15,Q>>>0<=v>>>0)return E=2,we=st,E|0;de=(le|0)==0,!de&&(Xe=ue(7,0,(le^15)*3|0)|0,(Xe&y|0)==0&((Me()|0)&m|0)==0)?P=v:R=4;e:do if((R|0)==4){if(P=(dr(y,m)|0)!=0,((P?4:5)|0)<(v|0)||Xt(y,m,it)|0||(R=(a[it>>2]|0)+v|0,P?P=22288+(((R|0)%5|0)<<2)|0:P=22320+(((R|0)%6|0)<<2)|0,Xe=a[P>>2]|0,(Xe|0)==7))return E=1,we=st,E|0;a[ht>>2]=0,P=Fe(y,m,Xe,ht,Be)|0;do if(!P){if(N=Be,J=a[N>>2]|0,N=a[N+4>>2]|0,O=N>>>0<m>>>0|(N|0)==(m|0)&J>>>0<y>>>0,R=O?J:y,O=O?N:m,!de&&(de=ue(7,0,(le^15)*3|0)|0,(J&de|0)==0&(N&(Me()|0)|0)==0))P=v;else{if(N=(v+-1+Q|0)%(Q|0)|0,P=dr(y,m)|0,(N|0)<0&&un(23313,23315,245,23324),Q=(P|0)!=0,((Q?4:5)|0)<(N|0)&&un(23313,23315,245,23324),Xt(y,m,it)|0&&un(23313,23315,245,23324),P=(a[it>>2]|0)+N|0,Q?P=22288+(((P|0)%5|0)<<2)|0:P=22320+(((P|0)%6|0)<<2)|0,N=a[P>>2]|0,(N|0)==7&&un(23313,23315,245,23324),a[$e>>2]=0,P=Fe(y,m,N,$e,Re)|0,P|0)break;J=Re,Q=a[J>>2]|0,J=a[J+4>>2]|0;do if(J>>>0<O>>>0|(J|0)==(O|0)&Q>>>0<R>>>0){if(dr(Q,J)|0?R=at(Q,J,y,m)|0:R=a[22384+((((a[$e>>2]|0)+(a[22352+(N<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,P=dr(Q,J)|0,(R+-1|0)>>>0>5){P=-1,R=Q,O=J;break}if(P=(P|0)!=0,(R|0)==1&P){P=-1,R=Q,O=J;break}do if(Xt(Q,J,it)|0)P=-1;else if(P){P=((a[21936+(R<<2)>>2]|0)+5-(a[it>>2]|0)|0)%5|0;break}else{P=((a[21968+(R<<2)>>2]|0)+6-(a[it>>2]|0)|0)%6|0;break}while(0);R=Q,O=J}else P=v;while(0);N=Be,J=a[N>>2]|0,N=a[N+4>>2]|0}if((R|0)==(J|0)&(O|0)==(N|0)){if(Q=(dr(J,N)|0)!=0,Q?y=at(J,N,y,m)|0:y=a[22384+((((a[ht>>2]|0)+(a[22352+(Xe<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,P=dr(J,N)|0,(y+-1|0)>>>0<=5&&(ut=(P|0)!=0,!((y|0)==1&ut)))do if(Xt(J,N,it)|0)P=-1;else if(ut){P=((a[21936+(y<<2)>>2]|0)+5-(a[it>>2]|0)|0)%5|0;break}else{P=((a[21968+(y<<2)>>2]|0)+6-(a[it>>2]|0)|0)%6|0;break}while(0);else P=-1;P=P+1|0,P=(P|0)==6|Q&(P|0)==5?0:P}m=O,y=R;break e}while(0);return E=P,we=st,E|0}while(0);return ut=ue(P|0,0,56)|0,it=Me()|0|m&-2130706433|536870912,a[E>>2]=ut|y,a[E+4>>2]=it,E=0,we=st,E|0}function Yi(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0;return R=(dr(y,m)|0)==0,E=hn(y,m,0,v)|0,P=(E|0)==0,R?!P||(E=hn(y,m,1,v+8|0)|0,E|0)||(E=hn(y,m,2,v+16|0)|0,E|0)||(E=hn(y,m,3,v+24|0)|0,E|0)||(E=hn(y,m,4,v+32|0)|0,E)?(R=E,R|0):hn(y,m,5,v+40|0)|0:!P||(E=hn(y,m,1,v+8|0)|0,E|0)||(E=hn(y,m,2,v+16|0)|0,E|0)||(E=hn(y,m,3,v+24|0)|0,E|0)||(E=hn(y,m,4,v+32|0)|0,E|0)?(R=E,R|0):(R=v+40|0,a[R>>2]=0,a[R+4>>2]=0,R=0,R|0)}function Qo(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0,N=0,Q=0;return Q=we,we=we+192|0,P=Q,R=Q+168|0,O=ne(y|0,m|0,56)|0,Me()|0,O=O&7,N=m&-2130706433|134217728,E=qi(y,N,R)|0,E|0?(N=E,we=Q,N|0):(m=ne(y|0,m|0,52)|0,Me()|0,m=m&15,dr(y,N)|0?jo(R,m,O,1,P):nu(R,m,O,1,P),N=P+8|0,a[v>>2]=a[N>>2],a[v+4>>2]=a[N+4>>2],a[v+8>>2]=a[N+8>>2],a[v+12>>2]=a[N+12>>2],N=0,we=Q,N|0)}function Nr(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0;return P=we,we=we+16|0,v=P,!(!0&(m&2013265920|0)==536870912)||(E=m&-2130706433|134217728,!(fa(y,E)|0))?(E=0,we=P,E|0):(R=ne(y|0,m|0,56)|0,Me()|0,R=(hn(y,E,R&7,v)|0)==0,E=v,E=R&((a[E>>2]|0)==(y|0)?(a[E+4>>2]|0)==(m|0):0)&1,we=P,E|0)}function js(y,m,v){y=y|0,m=m|0,v=v|0;var E=0;(m|0)>0?(E=h(m,4)|0,a[y>>2]=E,E||un(23337,23360,40,23374)):a[y>>2]=0,a[y+4>>2]=m,a[y+8>>2]=0,a[y+12>>2]=v}function Ts(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0;P=y+4|0,R=y+12|0,O=y+8|0;e:for(;;){for(v=a[P>>2]|0,m=0;;){if((m|0)>=(v|0))break e;if(E=a[y>>2]|0,N=a[E+(m<<2)>>2]|0,!N)m=m+1|0;else break}m=E+(~~(+ke(+(+lt(10,+ +(15-(a[R>>2]|0)|0))*(+G[N>>3]+ +G[N+8>>3])))%+(v|0))>>>0<<2)|0,v=a[m>>2]|0;t:do if(v|0){if(E=N+32|0,(v|0)==(N|0))a[m>>2]=a[E>>2];else{if(v=v+32|0,m=a[v>>2]|0,!m)break;for(;(m|0)!=(N|0);)if(v=m+32|0,m=a[v>>2]|0,!m)break t;a[v>>2]=a[E>>2]}l(N),a[O>>2]=(a[O>>2]|0)+-1}while(0)}l(a[y>>2]|0)}function Hs(y){y=y|0;var m=0,v=0,E=0;for(E=a[y+4>>2]|0,v=0;;){if((v|0)>=(E|0)){m=0,v=4;break}if(m=a[(a[y>>2]|0)+(v<<2)>>2]|0,!m)v=v+1|0;else{v=4;break}}return(v|0)==4?m|0:0}function Mt(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0;if(v=~~(+ke(+(+lt(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,v=(a[y>>2]|0)+(v<<2)|0,E=a[v>>2]|0,!E)return R=1,R|0;R=m+32|0;do if((E|0)!=(m|0)){if(v=a[E+32>>2]|0,!v)return R=1,R|0;for(P=v;;){if((P|0)==(m|0)){P=8;break}if(v=a[P+32>>2]|0,v)E=P,P=v;else{v=1,P=10;break}}if((P|0)==8){a[E+32>>2]=a[R>>2];break}else if((P|0)==10)return v|0}else a[v>>2]=a[R>>2];while(0);return l(m),R=y+8|0,a[R>>2]=(a[R>>2]|0)+-1,R=0,R|0}function Pt(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0;R=_(40)|0,R||un(23390,23360,98,23403),a[R>>2]=a[m>>2],a[R+4>>2]=a[m+4>>2],a[R+8>>2]=a[m+8>>2],a[R+12>>2]=a[m+12>>2],P=R+16|0,a[P>>2]=a[v>>2],a[P+4>>2]=a[v+4>>2],a[P+8>>2]=a[v+8>>2],a[P+12>>2]=a[v+12>>2],a[R+32>>2]=0,P=~~(+ke(+(+lt(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,P=(a[y>>2]|0)+(P<<2)|0,E=a[P>>2]|0;do if(!E)a[P>>2]=R;else{for(;!(Es(E,m)|0&&Es(E+16|0,v)|0);)if(P=a[E+32>>2]|0,E=P|0?P:E,!(a[E+32>>2]|0)){O=10;break}if((O|0)==10){a[E+32>>2]=R;break}return l(R),O=E,O|0}while(0);return O=y+8|0,a[O>>2]=(a[O>>2]|0)+1,O=R,O|0}function Ur(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0;if(P=~~(+ke(+(+lt(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,P=a[(a[y>>2]|0)+(P<<2)>>2]|0,!P)return v=0,v|0;if(!v){for(y=P;;){if(Es(y,m)|0){E=10;break}if(y=a[y+32>>2]|0,!y){y=0,E=10;break}}if((E|0)==10)return y|0}for(y=P;;){if(Es(y,m)|0&&Es(y+16|0,v)|0){E=10;break}if(y=a[y+32>>2]|0,!y){y=0,E=10;break}}return(E|0)==10?y|0:0}function Ya(y,m){y=y|0,m=m|0;var v=0;if(v=~~(+ke(+(+lt(10,+ +(15-(a[y+12>>2]|0)|0))*(+G[m>>3]+ +G[m+8>>3])))%+(a[y+4>>2]|0))>>>0,y=a[(a[y>>2]|0)+(v<<2)>>2]|0,!y)return v=0,v|0;for(;;){if(Es(y,m)|0){m=5;break}if(y=a[y+32>>2]|0,!y){y=0,m=5;break}}return(m|0)==5?y|0:0}function Ws(){return 23424}function L(y){return y=+y,+ +Ve(+y)}function c(y){return y=+y,~~+L(y)|0}function _(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0,Xe=0,ht=0,ut=0,it=0,st=0,Je=0,Gt=0;Gt=we,we=we+16|0,Re=Gt;do if(y>>>0<245){if(J=y>>>0<11?16:y+11&-8,y=J>>>3,de=a[5857]|0,v=de>>>y,v&3|0)return m=(v&1^1)+y|0,y=23468+(m<<1<<2)|0,v=y+8|0,E=a[v>>2]|0,P=E+8|0,R=a[P>>2]|0,(R|0)==(y|0)?a[5857]=de&~(1<<m):(a[R+12>>2]=y,a[v>>2]=R),Je=m<<3,a[E+4>>2]=Je|3,Je=E+Je+4|0,a[Je>>2]=a[Je>>2]|1,Je=P,we=Gt,Je|0;if(le=a[5859]|0,J>>>0>le>>>0){if(v|0)return m=2<<y,m=v<<y&(m|0-m),m=(m&0-m)+-1|0,N=m>>>12&16,m=m>>>N,v=m>>>5&8,m=m>>>v,R=m>>>2&4,m=m>>>R,y=m>>>1&2,m=m>>>y,E=m>>>1&1,E=(v|N|R|y|E)+(m>>>E)|0,m=23468+(E<<1<<2)|0,y=m+8|0,R=a[y>>2]|0,N=R+8|0,v=a[N>>2]|0,(v|0)==(m|0)?(y=de&~(1<<E),a[5857]=y):(a[v+12>>2]=m,a[y>>2]=v,y=de),Je=E<<3,O=Je-J|0,a[R+4>>2]=J|3,P=R+J|0,a[P+4>>2]=O|1,a[R+Je>>2]=O,le|0&&(E=a[5862]|0,m=le>>>3,v=23468+(m<<1<<2)|0,m=1<<m,y&m?(y=v+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=v,y=v+8|0),a[y>>2]=E,a[m+12>>2]=E,a[E+8>>2]=m,a[E+12>>2]=v),a[5859]=O,a[5862]=P,Je=N,we=Gt,Je|0;if(R=a[5858]|0,R){for(v=(R&0-R)+-1|0,P=v>>>12&16,v=v>>>P,E=v>>>5&8,v=v>>>E,O=v>>>2&4,v=v>>>O,N=v>>>1&2,v=v>>>N,Q=v>>>1&1,Q=a[23732+((E|P|O|N|Q)+(v>>>Q)<<2)>>2]|0,v=Q,N=Q,Q=(a[Q+4>>2]&-8)-J|0;y=a[v+16>>2]|0,!(!y&&(y=a[v+20>>2]|0,!y));)O=(a[y+4>>2]&-8)-J|0,P=O>>>0<Q>>>0,v=y,N=P?y:N,Q=P?O:Q;if(O=N+J|0,O>>>0>N>>>0){P=a[N+24>>2]|0,m=a[N+12>>2]|0;do if((m|0)==(N|0)){if(y=N+20|0,m=a[y>>2]|0,!m&&(y=N+16|0,m=a[y>>2]|0,!m)){v=0;break}for(;;)if(E=m+20|0,v=a[E>>2]|0,v)m=v,y=E;else if(E=m+16|0,v=a[E>>2]|0,v)m=v,y=E;else break;a[y>>2]=0,v=m}else v=a[N+8>>2]|0,a[v+12>>2]=m,a[m+8>>2]=v,v=m;while(0);do if(P|0){if(m=a[N+28>>2]|0,y=23732+(m<<2)|0,(N|0)==(a[y>>2]|0)){if(a[y>>2]=v,!v){a[5858]=R&~(1<<m);break}}else if(Je=P+16|0,a[((a[Je>>2]|0)==(N|0)?Je:P+20|0)>>2]=v,!v)break;a[v+24>>2]=P,m=a[N+16>>2]|0,m|0&&(a[v+16>>2]=m,a[m+24>>2]=v),m=a[N+20>>2]|0,m|0&&(a[v+20>>2]=m,a[m+24>>2]=v)}while(0);return Q>>>0<16?(Je=Q+J|0,a[N+4>>2]=Je|3,Je=N+Je+4|0,a[Je>>2]=a[Je>>2]|1):(a[N+4>>2]=J|3,a[O+4>>2]=Q|1,a[O+Q>>2]=Q,le|0&&(E=a[5862]|0,m=le>>>3,v=23468+(m<<1<<2)|0,m=1<<m,m&de?(y=v+8|0,m=a[y>>2]|0):(a[5857]=m|de,m=v,y=v+8|0),a[y>>2]=E,a[m+12>>2]=E,a[E+8>>2]=m,a[E+12>>2]=v),a[5859]=Q,a[5862]=O),Je=N+8|0,we=Gt,Je|0}else de=J}else de=J}else de=J}else if(y>>>0<=4294967231)if(y=y+11|0,J=y&-8,E=a[5858]|0,E){P=0-J|0,y=y>>>8,y?J>>>0>16777215?Q=31:(de=(y+1048320|0)>>>16&8,Xe=y<<de,N=(Xe+520192|0)>>>16&4,Xe=Xe<<N,Q=(Xe+245760|0)>>>16&2,Q=14-(N|de|Q)+(Xe<<Q>>>15)|0,Q=J>>>(Q+7|0)&1|Q<<1):Q=0,v=a[23732+(Q<<2)>>2]|0;e:do if(!v)v=0,y=0,Xe=61;else for(y=0,N=J<<((Q|0)==31?0:25-(Q>>>1)|0),R=0;;){if(O=(a[v+4>>2]&-8)-J|0,O>>>0<P>>>0)if(O)y=v,P=O;else{y=v,P=0,Xe=65;break e}if(Xe=a[v+20>>2]|0,v=a[v+16+(N>>>31<<2)>>2]|0,R=(Xe|0)==0|(Xe|0)==(v|0)?R:Xe,v)N=N<<1;else{v=R,Xe=61;break}}while(0);if((Xe|0)==61){if((v|0)==0&(y|0)==0){if(y=2<<Q,y=(y|0-y)&E,!y){de=J;break}de=(y&0-y)+-1|0,O=de>>>12&16,de=de>>>O,R=de>>>5&8,de=de>>>R,N=de>>>2&4,de=de>>>N,Q=de>>>1&2,de=de>>>Q,v=de>>>1&1,y=0,v=a[23732+((R|O|N|Q|v)+(de>>>v)<<2)>>2]|0}v?Xe=65:(N=y,O=P)}if((Xe|0)==65)for(R=v;;)if(de=(a[R+4>>2]&-8)-J|0,v=de>>>0<P>>>0,P=v?de:P,y=v?R:y,v=a[R+16>>2]|0,v||(v=a[R+20>>2]|0),v)R=v;else{N=y,O=P;break}if(N|0&&O>>>0<((a[5859]|0)-J|0)>>>0&&(le=N+J|0,le>>>0>N>>>0)){R=a[N+24>>2]|0,m=a[N+12>>2]|0;do if((m|0)==(N|0)){if(y=N+20|0,m=a[y>>2]|0,!m&&(y=N+16|0,m=a[y>>2]|0,!m)){m=0;break}for(;;)if(P=m+20|0,v=a[P>>2]|0,v)m=v,y=P;else if(P=m+16|0,v=a[P>>2]|0,v)m=v,y=P;else break;a[y>>2]=0}else Je=a[N+8>>2]|0,a[Je+12>>2]=m,a[m+8>>2]=Je;while(0);do if(R){if(y=a[N+28>>2]|0,v=23732+(y<<2)|0,(N|0)==(a[v>>2]|0)){if(a[v>>2]=m,!m){E=E&~(1<<y),a[5858]=E;break}}else if(Je=R+16|0,a[((a[Je>>2]|0)==(N|0)?Je:R+20|0)>>2]=m,!m)break;a[m+24>>2]=R,y=a[N+16>>2]|0,y|0&&(a[m+16>>2]=y,a[y+24>>2]=m),y=a[N+20>>2]|0,y&&(a[m+20>>2]=y,a[y+24>>2]=m)}while(0);e:do if(O>>>0<16)Je=O+J|0,a[N+4>>2]=Je|3,Je=N+Je+4|0,a[Je>>2]=a[Je>>2]|1;else{if(a[N+4>>2]=J|3,a[le+4>>2]=O|1,a[le+O>>2]=O,m=O>>>3,O>>>0<256){v=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=v+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=v,y=v+8|0),a[y>>2]=le,a[m+12>>2]=le,a[le+8>>2]=m,a[le+12>>2]=v;break}if(m=O>>>8,m?O>>>0>16777215?v=31:(st=(m+1048320|0)>>>16&8,Je=m<<st,it=(Je+520192|0)>>>16&4,Je=Je<<it,v=(Je+245760|0)>>>16&2,v=14-(it|st|v)+(Je<<v>>>15)|0,v=O>>>(v+7|0)&1|v<<1):v=0,m=23732+(v<<2)|0,a[le+28>>2]=v,y=le+16|0,a[y+4>>2]=0,a[y>>2]=0,y=1<<v,!(E&y)){a[5858]=E|y,a[m>>2]=le,a[le+24>>2]=m,a[le+12>>2]=le,a[le+8>>2]=le;break}m=a[m>>2]|0;t:do if((a[m+4>>2]&-8|0)!=(O|0)){for(E=O<<((v|0)==31?0:25-(v>>>1)|0);v=m+16+(E>>>31<<2)|0,y=a[v>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(O|0)){m=y;break t}else E=E<<1,m=y;a[v>>2]=le,a[le+24>>2]=m,a[le+12>>2]=le,a[le+8>>2]=le;break e}while(0);st=m+8|0,Je=a[st>>2]|0,a[Je+12>>2]=le,a[st>>2]=le,a[le+8>>2]=Je,a[le+12>>2]=m,a[le+24>>2]=0}while(0);return Je=N+8|0,we=Gt,Je|0}else de=J}else de=J;else de=-1;while(0);if(v=a[5859]|0,v>>>0>=de>>>0)return m=v-de|0,y=a[5862]|0,m>>>0>15?(Je=y+de|0,a[5862]=Je,a[5859]=m,a[Je+4>>2]=m|1,a[y+v>>2]=m,a[y+4>>2]=de|3):(a[5859]=0,a[5862]=0,a[y+4>>2]=v|3,Je=y+v+4|0,a[Je>>2]=a[Je>>2]|1),Je=y+8|0,we=Gt,Je|0;if(O=a[5860]|0,O>>>0>de>>>0)return it=O-de|0,a[5860]=it,Je=a[5863]|0,st=Je+de|0,a[5863]=st,a[st+4>>2]=it|1,a[Je+4>>2]=de|3,Je=Je+8|0,we=Gt,Je|0;if(a[5975]|0?y=a[5977]|0:(a[5977]=4096,a[5976]=4096,a[5978]=-1,a[5979]=-1,a[5980]=0,a[5968]=0,a[5975]=Re&-16^1431655768,y=4096),N=de+48|0,Q=de+47|0,R=y+Q|0,P=0-y|0,J=R&P,J>>>0<=de>>>0||(y=a[5967]|0,y|0&&(le=a[5965]|0,Re=le+J|0,Re>>>0<=le>>>0|Re>>>0>y>>>0)))return Je=0,we=Gt,Je|0;e:do if(a[5968]&4)m=0,Xe=143;else{v=a[5863]|0;t:do if(v){for(E=23876;Re=a[E>>2]|0,!(Re>>>0<=v>>>0&&(Re+(a[E+4>>2]|0)|0)>>>0>v>>>0);)if(y=a[E+8>>2]|0,y)E=y;else{Xe=128;break t}if(m=R-O&P,m>>>0<2147483647)if(y=xe(m|0)|0,(y|0)==((a[E>>2]|0)+(a[E+4>>2]|0)|0)){if((y|0)!=-1){O=m,R=y,Xe=145;break e}}else E=y,Xe=136;else m=0}else Xe=128;while(0);do if((Xe|0)==128)if(v=xe(0)|0,(v|0)!=-1&&(m=v,$e=a[5976]|0,Be=$e+-1|0,m=(Be&m|0?(Be+m&0-$e)-m|0:0)+J|0,$e=a[5965]|0,Be=m+$e|0,m>>>0>de>>>0&m>>>0<2147483647)){if(Re=a[5967]|0,Re|0&&Be>>>0<=$e>>>0|Be>>>0>Re>>>0){m=0;break}if(y=xe(m|0)|0,(y|0)==(v|0)){O=m,R=v,Xe=145;break e}else E=y,Xe=136}else m=0;while(0);do if((Xe|0)==136){if(v=0-m|0,!(N>>>0>m>>>0&(m>>>0<2147483647&(E|0)!=-1)))if((E|0)==-1){m=0;break}else{O=m,R=E,Xe=145;break e}if(y=a[5977]|0,y=Q-m+y&0-y,y>>>0>=2147483647){O=m,R=E,Xe=145;break e}if((xe(y|0)|0)==-1){xe(v|0)|0,m=0;break}else{O=y+m|0,R=E,Xe=145;break e}}while(0);a[5968]=a[5968]|4,Xe=143}while(0);if((Xe|0)==143&&J>>>0<2147483647&&(it=xe(J|0)|0,Be=xe(0)|0,ht=Be-it|0,ut=ht>>>0>(de+40|0)>>>0,!((it|0)==-1|ut^1|it>>>0<Be>>>0&((it|0)!=-1&(Be|0)!=-1)^1))&&(O=ut?ht:m,R=it,Xe=145),(Xe|0)==145){m=(a[5965]|0)+O|0,a[5965]=m,m>>>0>(a[5966]|0)>>>0&&(a[5966]=m),Q=a[5863]|0;e:do if(Q){for(m=23876;;){if(y=a[m>>2]|0,v=a[m+4>>2]|0,(R|0)==(y+v|0)){Xe=154;break}if(E=a[m+8>>2]|0,E)m=E;else break}if((Xe|0)==154&&(st=m+4|0,(a[m+12>>2]&8|0)==0)&&R>>>0>Q>>>0&y>>>0<=Q>>>0){a[st>>2]=v+O,Je=(a[5860]|0)+O|0,it=Q+8|0,it=it&7|0?0-it&7:0,st=Q+it|0,it=Je-it|0,a[5863]=st,a[5860]=it,a[st+4>>2]=it|1,a[Q+Je+4>>2]=40,a[5864]=a[5979];break}for(R>>>0<(a[5861]|0)>>>0&&(a[5861]=R),v=R+O|0,m=23876;;){if((a[m>>2]|0)==(v|0)){Xe=162;break}if(y=a[m+8>>2]|0,y)m=y;else break}if((Xe|0)==162&&!(a[m+12>>2]&8|0)){a[m>>2]=R,le=m+4|0,a[le>>2]=(a[le>>2]|0)+O,le=R+8|0,le=R+(le&7|0?0-le&7:0)|0,m=v+8|0,m=v+(m&7|0?0-m&7:0)|0,J=le+de|0,N=m-le-de|0,a[le+4>>2]=de|3;t:do if((Q|0)==(m|0))Je=(a[5860]|0)+N|0,a[5860]=Je,a[5863]=J,a[J+4>>2]=Je|1;else{if((a[5862]|0)==(m|0)){Je=(a[5859]|0)+N|0,a[5859]=Je,a[5862]=J,a[J+4>>2]=Je|1,a[J+Je>>2]=Je;break}if(y=a[m+4>>2]|0,(y&3|0)==1){O=y&-8,E=y>>>3;n:do if(y>>>0<256)if(y=a[m+8>>2]|0,v=a[m+12>>2]|0,(v|0)==(y|0)){a[5857]=a[5857]&~(1<<E);break}else{a[y+12>>2]=v,a[v+8>>2]=y;break}else{R=a[m+24>>2]|0,y=a[m+12>>2]|0;do if((y|0)==(m|0)){if(v=m+16|0,E=v+4|0,y=a[E>>2]|0,y)v=E;else if(y=a[v>>2]|0,!y){y=0;break}for(;;)if(P=y+20|0,E=a[P>>2]|0,E)y=E,v=P;else if(P=y+16|0,E=a[P>>2]|0,E)y=E,v=P;else break;a[v>>2]=0}else Je=a[m+8>>2]|0,a[Je+12>>2]=y,a[y+8>>2]=Je;while(0);if(!R)break;v=a[m+28>>2]|0,E=23732+(v<<2)|0;do if((a[E>>2]|0)!=(m|0)){if(Je=R+16|0,a[((a[Je>>2]|0)==(m|0)?Je:R+20|0)>>2]=y,!y)break n}else{if(a[E>>2]=y,y|0)break;a[5858]=a[5858]&~(1<<v);break n}while(0);if(a[y+24>>2]=R,v=m+16|0,E=a[v>>2]|0,E|0&&(a[y+16>>2]=E,a[E+24>>2]=y),v=a[v+4>>2]|0,!v)break;a[y+20>>2]=v,a[v+24>>2]=y}while(0);m=m+O|0,P=O+N|0}else P=N;if(m=m+4|0,a[m>>2]=a[m>>2]&-2,a[J+4>>2]=P|1,a[J+P>>2]=P,m=P>>>3,P>>>0<256){v=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=v+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=v,y=v+8|0),a[y>>2]=J,a[m+12>>2]=J,a[J+8>>2]=m,a[J+12>>2]=v;break}m=P>>>8;do if(!m)E=0;else{if(P>>>0>16777215){E=31;break}st=(m+1048320|0)>>>16&8,Je=m<<st,it=(Je+520192|0)>>>16&4,Je=Je<<it,E=(Je+245760|0)>>>16&2,E=14-(it|st|E)+(Je<<E>>>15)|0,E=P>>>(E+7|0)&1|E<<1}while(0);if(m=23732+(E<<2)|0,a[J+28>>2]=E,y=J+16|0,a[y+4>>2]=0,a[y>>2]=0,y=a[5858]|0,v=1<<E,!(y&v)){a[5858]=y|v,a[m>>2]=J,a[J+24>>2]=m,a[J+12>>2]=J,a[J+8>>2]=J;break}m=a[m>>2]|0;n:do if((a[m+4>>2]&-8|0)!=(P|0)){for(E=P<<((E|0)==31?0:25-(E>>>1)|0);v=m+16+(E>>>31<<2)|0,y=a[v>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(P|0)){m=y;break n}else E=E<<1,m=y;a[v>>2]=J,a[J+24>>2]=m,a[J+12>>2]=J,a[J+8>>2]=J;break t}while(0);st=m+8|0,Je=a[st>>2]|0,a[Je+12>>2]=J,a[st>>2]=J,a[J+8>>2]=Je,a[J+12>>2]=m,a[J+24>>2]=0}while(0);return Je=le+8|0,we=Gt,Je|0}for(m=23876;y=a[m>>2]|0,!(y>>>0<=Q>>>0&&(Je=y+(a[m+4>>2]|0)|0,Je>>>0>Q>>>0));)m=a[m+8>>2]|0;P=Je+-47|0,y=P+8|0,y=P+(y&7|0?0-y&7:0)|0,P=Q+16|0,y=y>>>0<P>>>0?Q:y,m=y+8|0,v=O+-40|0,it=R+8|0,it=it&7|0?0-it&7:0,st=R+it|0,it=v-it|0,a[5863]=st,a[5860]=it,a[st+4>>2]=it|1,a[R+v+4>>2]=40,a[5864]=a[5979],v=y+4|0,a[v>>2]=27,a[m>>2]=a[5969],a[m+4>>2]=a[5970],a[m+8>>2]=a[5971],a[m+12>>2]=a[5972],a[5969]=R,a[5970]=O,a[5972]=0,a[5971]=m,m=y+24|0;do st=m,m=m+4|0,a[m>>2]=7;while((st+8|0)>>>0<Je>>>0);if((y|0)!=(Q|0)){if(R=y-Q|0,a[v>>2]=a[v>>2]&-2,a[Q+4>>2]=R|1,a[y>>2]=R,m=R>>>3,R>>>0<256){v=23468+(m<<1<<2)|0,y=a[5857]|0,m=1<<m,y&m?(y=v+8|0,m=a[y>>2]|0):(a[5857]=y|m,m=v,y=v+8|0),a[y>>2]=Q,a[m+12>>2]=Q,a[Q+8>>2]=m,a[Q+12>>2]=v;break}if(m=R>>>8,m?R>>>0>16777215?E=31:(st=(m+1048320|0)>>>16&8,Je=m<<st,it=(Je+520192|0)>>>16&4,Je=Je<<it,E=(Je+245760|0)>>>16&2,E=14-(it|st|E)+(Je<<E>>>15)|0,E=R>>>(E+7|0)&1|E<<1):E=0,v=23732+(E<<2)|0,a[Q+28>>2]=E,a[Q+20>>2]=0,a[P>>2]=0,m=a[5858]|0,y=1<<E,!(m&y)){a[5858]=m|y,a[v>>2]=Q,a[Q+24>>2]=v,a[Q+12>>2]=Q,a[Q+8>>2]=Q;break}m=a[v>>2]|0;t:do if((a[m+4>>2]&-8|0)!=(R|0)){for(E=R<<((E|0)==31?0:25-(E>>>1)|0);v=m+16+(E>>>31<<2)|0,y=a[v>>2]|0,!!y;)if((a[y+4>>2]&-8|0)==(R|0)){m=y;break t}else E=E<<1,m=y;a[v>>2]=Q,a[Q+24>>2]=m,a[Q+12>>2]=Q,a[Q+8>>2]=Q;break e}while(0);st=m+8|0,Je=a[st>>2]|0,a[Je+12>>2]=Q,a[st>>2]=Q,a[Q+8>>2]=Je,a[Q+12>>2]=m,a[Q+24>>2]=0}}else Je=a[5861]|0,(Je|0)==0|R>>>0<Je>>>0&&(a[5861]=R),a[5969]=R,a[5970]=O,a[5972]=0,a[5866]=a[5975],a[5865]=-1,a[5870]=23468,a[5869]=23468,a[5872]=23476,a[5871]=23476,a[5874]=23484,a[5873]=23484,a[5876]=23492,a[5875]=23492,a[5878]=23500,a[5877]=23500,a[5880]=23508,a[5879]=23508,a[5882]=23516,a[5881]=23516,a[5884]=23524,a[5883]=23524,a[5886]=23532,a[5885]=23532,a[5888]=23540,a[5887]=23540,a[5890]=23548,a[5889]=23548,a[5892]=23556,a[5891]=23556,a[5894]=23564,a[5893]=23564,a[5896]=23572,a[5895]=23572,a[5898]=23580,a[5897]=23580,a[5900]=23588,a[5899]=23588,a[5902]=23596,a[5901]=23596,a[5904]=23604,a[5903]=23604,a[5906]=23612,a[5905]=23612,a[5908]=23620,a[5907]=23620,a[5910]=23628,a[5909]=23628,a[5912]=23636,a[5911]=23636,a[5914]=23644,a[5913]=23644,a[5916]=23652,a[5915]=23652,a[5918]=23660,a[5917]=23660,a[5920]=23668,a[5919]=23668,a[5922]=23676,a[5921]=23676,a[5924]=23684,a[5923]=23684,a[5926]=23692,a[5925]=23692,a[5928]=23700,a[5927]=23700,a[5930]=23708,a[5929]=23708,a[5932]=23716,a[5931]=23716,Je=O+-40|0,it=R+8|0,it=it&7|0?0-it&7:0,st=R+it|0,it=Je-it|0,a[5863]=st,a[5860]=it,a[st+4>>2]=it|1,a[R+Je+4>>2]=40,a[5864]=a[5979];while(0);if(m=a[5860]|0,m>>>0>de>>>0)return it=m-de|0,a[5860]=it,Je=a[5863]|0,st=Je+de|0,a[5863]=st,a[st+4>>2]=it|1,a[Je+4>>2]=de|3,Je=Je+8|0,we=Gt,Je|0}return Je=Ws()|0,a[Je>>2]=12,Je=0,we=Gt,Je|0}function l(y){y=y|0;var m=0,v=0,E=0,P=0,R=0,O=0,N=0,Q=0;if(y){v=y+-8|0,P=a[5861]|0,y=a[y+-4>>2]|0,m=y&-8,Q=v+m|0;do if(y&1)N=v,O=v;else{if(E=a[v>>2]|0,!(y&3)||(O=v+(0-E)|0,R=E+m|0,O>>>0<P>>>0))return;if((a[5862]|0)==(O|0)){if(y=Q+4|0,m=a[y>>2]|0,(m&3|0)!=3){N=O,m=R;break}a[5859]=R,a[y>>2]=m&-2,a[O+4>>2]=R|1,a[O+R>>2]=R;return}if(v=E>>>3,E>>>0<256)if(y=a[O+8>>2]|0,m=a[O+12>>2]|0,(m|0)==(y|0)){a[5857]=a[5857]&~(1<<v),N=O,m=R;break}else{a[y+12>>2]=m,a[m+8>>2]=y,N=O,m=R;break}P=a[O+24>>2]|0,y=a[O+12>>2]|0;do if((y|0)==(O|0)){if(m=O+16|0,v=m+4|0,y=a[v>>2]|0,y)m=v;else if(y=a[m>>2]|0,!y){y=0;break}for(;;)if(E=y+20|0,v=a[E>>2]|0,v)y=v,m=E;else if(E=y+16|0,v=a[E>>2]|0,v)y=v,m=E;else break;a[m>>2]=0}else N=a[O+8>>2]|0,a[N+12>>2]=y,a[y+8>>2]=N;while(0);if(P){if(m=a[O+28>>2]|0,v=23732+(m<<2)|0,(a[v>>2]|0)==(O|0)){if(a[v>>2]=y,!y){a[5858]=a[5858]&~(1<<m),N=O,m=R;break}}else if(N=P+16|0,a[((a[N>>2]|0)==(O|0)?N:P+20|0)>>2]=y,!y){N=O,m=R;break}a[y+24>>2]=P,m=O+16|0,v=a[m>>2]|0,v|0&&(a[y+16>>2]=v,a[v+24>>2]=y),m=a[m+4>>2]|0,m?(a[y+20>>2]=m,a[m+24>>2]=y,N=O,m=R):(N=O,m=R)}else N=O,m=R}while(0);if(!(O>>>0>=Q>>>0)&&(y=Q+4|0,E=a[y>>2]|0,!!(E&1))){if(E&2)a[y>>2]=E&-2,a[N+4>>2]=m|1,a[O+m>>2]=m,P=m;else{if((a[5863]|0)==(Q|0)){if(Q=(a[5860]|0)+m|0,a[5860]=Q,a[5863]=N,a[N+4>>2]=Q|1,(N|0)!=(a[5862]|0))return;a[5862]=0,a[5859]=0;return}if((a[5862]|0)==(Q|0)){Q=(a[5859]|0)+m|0,a[5859]=Q,a[5862]=O,a[N+4>>2]=Q|1,a[O+Q>>2]=Q;return}P=(E&-8)+m|0,v=E>>>3;do if(E>>>0<256)if(m=a[Q+8>>2]|0,y=a[Q+12>>2]|0,(y|0)==(m|0)){a[5857]=a[5857]&~(1<<v);break}else{a[m+12>>2]=y,a[y+8>>2]=m;break}else{R=a[Q+24>>2]|0,y=a[Q+12>>2]|0;do if((y|0)==(Q|0)){if(m=Q+16|0,v=m+4|0,y=a[v>>2]|0,y)m=v;else if(y=a[m>>2]|0,!y){v=0;break}for(;;)if(E=y+20|0,v=a[E>>2]|0,v)y=v,m=E;else if(E=y+16|0,v=a[E>>2]|0,v)y=v,m=E;else break;a[m>>2]=0,v=y}else v=a[Q+8>>2]|0,a[v+12>>2]=y,a[y+8>>2]=v,v=y;while(0);if(R|0){if(y=a[Q+28>>2]|0,m=23732+(y<<2)|0,(a[m>>2]|0)==(Q|0)){if(a[m>>2]=v,!v){a[5858]=a[5858]&~(1<<y);break}}else if(E=R+16|0,a[((a[E>>2]|0)==(Q|0)?E:R+20|0)>>2]=v,!v)break;a[v+24>>2]=R,y=Q+16|0,m=a[y>>2]|0,m|0&&(a[v+16>>2]=m,a[m+24>>2]=v),y=a[y+4>>2]|0,y|0&&(a[v+20>>2]=y,a[y+24>>2]=v)}}while(0);if(a[N+4>>2]=P|1,a[O+P>>2]=P,(N|0)==(a[5862]|0)){a[5859]=P;return}}if(y=P>>>3,P>>>0<256){v=23468+(y<<1<<2)|0,m=a[5857]|0,y=1<<y,m&y?(m=v+8|0,y=a[m>>2]|0):(a[5857]=m|y,y=v,m=v+8|0),a[m>>2]=N,a[y+12>>2]=N,a[N+8>>2]=y,a[N+12>>2]=v;return}y=P>>>8,y?P>>>0>16777215?E=31:(O=(y+1048320|0)>>>16&8,Q=y<<O,R=(Q+520192|0)>>>16&4,Q=Q<<R,E=(Q+245760|0)>>>16&2,E=14-(R|O|E)+(Q<<E>>>15)|0,E=P>>>(E+7|0)&1|E<<1):E=0,y=23732+(E<<2)|0,a[N+28>>2]=E,a[N+20>>2]=0,a[N+16>>2]=0,m=a[5858]|0,v=1<<E;e:do if(!(m&v))a[5858]=m|v,a[y>>2]=N,a[N+24>>2]=y,a[N+12>>2]=N,a[N+8>>2]=N;else{y=a[y>>2]|0;t:do if((a[y+4>>2]&-8|0)!=(P|0)){for(E=P<<((E|0)==31?0:25-(E>>>1)|0);v=y+16+(E>>>31<<2)|0,m=a[v>>2]|0,!!m;)if((a[m+4>>2]&-8|0)==(P|0)){y=m;break t}else E=E<<1,y=m;a[v>>2]=N,a[N+24>>2]=y,a[N+12>>2]=N,a[N+8>>2]=N;break e}while(0);O=y+8|0,Q=a[O>>2]|0,a[Q+12>>2]=N,a[O>>2]=N,a[N+8>>2]=Q,a[N+12>>2]=y,a[N+24>>2]=0}while(0);if(Q=(a[5865]|0)+-1|0,a[5865]=Q,!(Q|0)){for(y=23884;y=a[y>>2]|0,y;)y=y+8|0;a[5865]=-1}}}}function h(y,m){y=y|0,m=m|0;var v=0;return y?(v=an(m,y)|0,(m|y)>>>0>65535&&(v=((v>>>0)/(y>>>0)|0|0)==(m|0)?v:-1)):v=0,y=_(v)|0,!y||!(a[y+-4>>2]&3)||Te(y|0,0,v|0)|0,y|0}function d(y,m,v,E){return y=y|0,m=m|0,v=v|0,E=E|0,v=y+v>>>0,Ct(m+E+(v>>>0<y>>>0|0)>>>0|0),v|0|0}function x(y,m,v,E){return y=y|0,m=m|0,v=v|0,E=E|0,E=m-E-(v>>>0>y>>>0|0)>>>0,Ct(E|0),y-v>>>0|0|0}function b(y){return y=y|0,(y?31-(Oe(y^y-1)|0)|0:32)|0}function S(y,m,v,E,P){y=y|0,m=m|0,v=v|0,E=E|0,P=P|0;var R=0,O=0,N=0,Q=0,J=0,le=0,de=0,Re=0,$e=0,Be=0;if(le=y,Q=m,J=Q,O=v,Re=E,N=Re,!J)return R=(P|0)!=0,N?R?(a[P>>2]=y|0,a[P+4>>2]=m&0,Re=0,P=0,Ct(Re|0),P|0):(Re=0,P=0,Ct(Re|0),P|0):(R&&(a[P>>2]=(le>>>0)%(O>>>0),a[P+4>>2]=0),Re=0,P=(le>>>0)/(O>>>0)>>>0,Ct(Re|0),P|0);R=(N|0)==0;do if(O){if(!R){if(R=(Oe(N|0)|0)-(Oe(J|0)|0)|0,R>>>0<=31){de=R+1|0,N=31-R|0,m=R-31>>31,O=de,y=le>>>(de>>>0)&m|J<<N,m=J>>>(de>>>0)&m,R=0,N=le<<N;break}return P?(a[P>>2]=y|0,a[P+4>>2]=Q|m&0,Re=0,P=0,Ct(Re|0),P|0):(Re=0,P=0,Ct(Re|0),P|0)}if(R=O-1|0,R&O|0){N=(Oe(O|0)|0)+33-(Oe(J|0)|0)|0,Be=64-N|0,de=32-N|0,Q=de>>31,$e=N-32|0,m=$e>>31,O=N,y=de-1>>31&J>>>($e>>>0)|(J<<de|le>>>(N>>>0))&m,m=m&J>>>(N>>>0),R=le<<Be&Q,N=(J<<Be|le>>>($e>>>0))&Q|le<<de&N-33>>31;break}return P|0&&(a[P>>2]=R&le,a[P+4>>2]=0),(O|0)==1?($e=Q|m&0,Be=y|0|0,Ct($e|0),Be|0):(Be=b(O|0)|0,$e=J>>>(Be>>>0)|0,Be=J<<32-Be|le>>>(Be>>>0)|0,Ct($e|0),Be|0)}else{if(R)return P|0&&(a[P>>2]=(J>>>0)%(O>>>0),a[P+4>>2]=0),$e=0,Be=(J>>>0)/(O>>>0)>>>0,Ct($e|0),Be|0;if(!le)return P|0&&(a[P>>2]=0,a[P+4>>2]=(J>>>0)%(N>>>0)),$e=0,Be=(J>>>0)/(N>>>0)>>>0,Ct($e|0),Be|0;if(R=N-1|0,!(R&N))return P|0&&(a[P>>2]=y|0,a[P+4>>2]=R&J|m&0),$e=0,Be=J>>>((b(N|0)|0)>>>0),Ct($e|0),Be|0;if(R=(Oe(N|0)|0)-(Oe(J|0)|0)|0,R>>>0<=30){m=R+1|0,N=31-R|0,O=m,y=J<<N|le>>>(m>>>0),m=J>>>(m>>>0),R=0,N=le<<N;break}return P?(a[P>>2]=y|0,a[P+4>>2]=Q|m&0,$e=0,Be=0,Ct($e|0),Be|0):($e=0,Be=0,Ct($e|0),Be|0)}while(0);if(!O)J=N,Q=0,N=0;else{de=v|0|0,le=Re|E&0,J=d(de|0,le|0,-1,-1)|0,v=Me()|0,Q=N,N=0;do E=Q,Q=R>>>31|Q<<1,R=N|R<<1,E=y<<1|E>>>31|0,Re=y>>>31|m<<1|0,x(J|0,v|0,E|0,Re|0)|0,Be=Me()|0,$e=Be>>31|((Be|0)<0?-1:0)<<1,N=$e&1,y=x(E|0,Re|0,$e&de|0,(((Be|0)<0?-1:0)>>31|((Be|0)<0?-1:0)<<1)&le|0)|0,m=Me()|0,O=O-1|0;while(O|0);J=Q,Q=0}return O=0,P|0&&(a[P>>2]=y,a[P+4>>2]=m),$e=(R|0)>>>31|(J|O)<<1|(O<<1|R>>>31)&0|Q,Be=(R<<1|0)&-2|N,Ct($e|0),Be|0}function M(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0;return J=m>>31|((m|0)<0?-1:0)<<1,Q=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,R=E>>31|((E|0)<0?-1:0)<<1,P=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,N=x(J^y|0,Q^m|0,J|0,Q|0)|0,O=Me()|0,y=R^J,m=P^Q,x((S(N,O,x(R^v|0,P^E|0,R|0,P|0)|0,Me()|0,0)|0)^y|0,(Me()|0)^m|0,y|0,m|0)|0}function B(y,m){y=y|0,m=m|0;var v=0,E=0,P=0,R=0;return R=y&65535,P=m&65535,v=an(P,R)|0,E=y>>>16,y=(v>>>16)+(an(P,E)|0)|0,P=m>>>16,m=an(P,R)|0,Ct((y>>>16)+(an(P,E)|0)+(((y&65535)+m|0)>>>16)|0),y+m<<16|v&65535|0|0}function V(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0;return P=y,R=v,v=B(P,R)|0,y=Me()|0,Ct((an(m,R)|0)+(an(E,P)|0)+y|y&0|0),v|0|0|0}function j(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0,O=0,N=0,Q=0,J=0;return P=we,we=we+16|0,N=P|0,O=m>>31|((m|0)<0?-1:0)<<1,R=((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1,J=E>>31|((E|0)<0?-1:0)<<1,Q=((E|0)<0?-1:0)>>31|((E|0)<0?-1:0)<<1,y=x(O^y|0,R^m|0,O|0,R|0)|0,m=Me()|0,S(y,m,x(J^v|0,Q^E|0,J|0,Q|0)|0,Me()|0,N)|0,E=x(a[N>>2]^O|0,a[N+4>>2]^R|0,O|0,R|0)|0,v=Me()|0,we=P,Ct(v|0),E|0}function Y(y,m,v,E){y=y|0,m=m|0,v=v|0,E=E|0;var P=0,R=0;return R=we,we=we+16|0,P=R|0,S(y,m,v,E,P)|0,we=R,Ct(a[P+4>>2]|0),a[P>>2]|0|0}function ae(y,m,v){return y=y|0,m=m|0,v=v|0,(v|0)<32?(Ct(m>>v|0),y>>>v|(m&(1<<v)-1)<<32-v):(Ct(((m|0)<0?-1:0)|0),m>>v-32|0)}function ne(y,m,v){return y=y|0,m=m|0,v=v|0,(v|0)<32?(Ct(m>>>v|0),y>>>v|(m&(1<<v)-1)<<32-v):(Ct(0),m>>>v-32|0)}function ue(y,m,v){return y=y|0,m=m|0,v=v|0,(v|0)<32?(Ct(m<<v|(y&(1<<v)-1<<32-v)>>>32-v|0),y<<v):(Ct(y<<v-32|0),0)}function be(y,m){return y=+y,m=+m,y!=y?+m:m!=m?+y:+Ft(+y,+m)}function Ce(y,m){return y=+y,m=+m,y!=y?+m:m!=m?+y:+xn(+y,+m)}function ve(y){return y=+y,y>=0?+Pe(y+.5):+qt(y-.5)}function Ge(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0;if((v|0)>=8192)return aa(y|0,m|0,v|0)|0,y|0;if(R=y|0,P=y+v|0,(y&3)==(m&3)){for(;y&3;){if(!v)return R|0;he[y>>0]=he[m>>0]|0,y=y+1|0,m=m+1|0,v=v-1|0}for(v=P&-4|0,E=v-64|0;(y|0)<=(E|0);)a[y>>2]=a[m>>2],a[y+4>>2]=a[m+4>>2],a[y+8>>2]=a[m+8>>2],a[y+12>>2]=a[m+12>>2],a[y+16>>2]=a[m+16>>2],a[y+20>>2]=a[m+20>>2],a[y+24>>2]=a[m+24>>2],a[y+28>>2]=a[m+28>>2],a[y+32>>2]=a[m+32>>2],a[y+36>>2]=a[m+36>>2],a[y+40>>2]=a[m+40>>2],a[y+44>>2]=a[m+44>>2],a[y+48>>2]=a[m+48>>2],a[y+52>>2]=a[m+52>>2],a[y+56>>2]=a[m+56>>2],a[y+60>>2]=a[m+60>>2],y=y+64|0,m=m+64|0;for(;(y|0)<(v|0);)a[y>>2]=a[m>>2],y=y+4|0,m=m+4|0}else for(v=P-4|0;(y|0)<(v|0);)he[y>>0]=he[m>>0]|0,he[y+1>>0]=he[m+1>>0]|0,he[y+2>>0]=he[m+2>>0]|0,he[y+3>>0]=he[m+3>>0]|0,y=y+4|0,m=m+4|0;for(;(y|0)<(P|0);)he[y>>0]=he[m>>0]|0,y=y+1|0,m=m+1|0;return R|0}function Te(y,m,v){y=y|0,m=m|0,v=v|0;var E=0,P=0,R=0,O=0;if(R=y+v|0,m=m&255,(v|0)>=67){for(;y&3;)he[y>>0]=m,y=y+1|0;for(E=R&-4|0,O=m|m<<8|m<<16|m<<24,P=E-64|0;(y|0)<=(P|0);)a[y>>2]=O,a[y+4>>2]=O,a[y+8>>2]=O,a[y+12>>2]=O,a[y+16>>2]=O,a[y+20>>2]=O,a[y+24>>2]=O,a[y+28>>2]=O,a[y+32>>2]=O,a[y+36>>2]=O,a[y+40>>2]=O,a[y+44>>2]=O,a[y+48>>2]=O,a[y+52>>2]=O,a[y+56>>2]=O,a[y+60>>2]=O,y=y+64|0;for(;(y|0)<(E|0);)a[y>>2]=O,y=y+4|0}for(;(y|0)<(R|0);)he[y>>0]=m,y=y+1|0;return R-v|0}function Ve(y){return y=+y,y>=0?+Pe(y+.5):+qt(y-.5)}function xe(y){y=y|0;var m=0,v=0,E=0;return E=nr()|0,v=a[Ie>>2]|0,m=v+y|0,(y|0)>0&(m|0)<(v|0)|(m|0)<0?(za(m|0)|0,ai(12),-1):(m|0)>(E|0)&&!(De(m|0)|0)?(ai(12),-1):(a[Ie>>2]=m,v|0)}return{___divdi3:M,___muldi3:V,___remdi3:j,___uremdi3:Y,_areNeighborCells:JA,_bitshift64Ashr:ae,_bitshift64Lshr:ne,_bitshift64Shl:ue,_calloc:h,_cellAreaKm2:Nt,_cellAreaM2:su,_cellAreaRads2:us,_cellToBoundary:hi,_cellToCenterChild:ru,_cellToChildPos:As,_cellToChildren:gA,_cellToChildrenSize:Sl,_cellToLatLng:_o,_cellToLocalIj:yh,_cellToParent:Tl,_cellToVertex:hn,_cellToVertexes:Yi,_cellsToDirectedEdge:eu,_cellsToLinkedMultiPolygon:Pr,_childPosToCell:dc,_compactCells:Ml,_destroyLinkedMultiPolygon:kl,_directedEdgeToBoundary:Fs,_directedEdgeToCells:ha,_edgeLengthKm:Wo,_edgeLengthM:ou,_edgeLengthRads:ma,_emscripten_replace_memory:Fo,_free:l,_getBaseCellNumber:Ga,_getDirectedEdgeDestination:ca,_getDirectedEdgeOrigin:yo,_getHexagonAreaAvgKm2:Il,_getHexagonAreaAvgM2:Wa,_getHexagonEdgeLengthAvgKm:gh,_getHexagonEdgeLengthAvgM:mh,_getIcosahedronFaces:Cl,_getNumCells:Qa,_getPentagons:Vs,_getRes0Cells:fA,_getResolution:El,_greatCircleDistanceKm:Pl,_greatCircleDistanceM:Ho,_greatCircleDistanceRads:Zi,_gridDisk:Aa,_gridDiskDistances:Jr,_gridDistance:lu,_gridPathCells:uu,_gridPathCellsSize:Au,_gridRingUnsafe:bt,_i64Add:d,_i64Subtract:x,_isPentagon:dr,_isResClassIII:Ir,_isValidCell:fa,_isValidDirectedEdge:tu,_isValidVertex:Nr,_latLngToCell:ls,_llvm_maxnum_f64:be,_llvm_minnum_f64:Ce,_llvm_round_f64:ve,_localIjToCell:gc,_malloc:_,_maxFaceCount:$a,_maxGridDiskSize:gl,_maxPolygonToCellsSize:Qt,_memcpy:Ge,_memset:Te,_originToDirectedEdges:cr,_pentagonCount:ja,_polygonToCells:Mr,_readInt64AsDoubleFromPointer:hu,_res0CellCount:hA,_round:Ve,_sbrk:xe,_sizeOfCellBoundary:mc,_sizeOfCoordIJ:Dl,_sizeOfGeoLoop:cs,_sizeOfGeoPolygon:br,_sizeOfH3Index:Br,_sizeOfLatLng:Ll,_sizeOfLinkedGeoPolygon:Za,_uncompactCells:hc,_uncompactCellsSize:Wr,_vertexToLatLng:Qo,establishStackSpace:la,stackAlloc:ws,stackRestore:Fa,stackSave:Oa}}(xs,yn,Ne);e.___divdi3=Ye.___divdi3,e.___muldi3=Ye.___muldi3,e.___remdi3=Ye.___remdi3,e.___uremdi3=Ye.___uremdi3,e._areNeighborCells=Ye._areNeighborCells,e._bitshift64Ashr=Ye._bitshift64Ashr,e._bitshift64Lshr=Ye._bitshift64Lshr,e._bitshift64Shl=Ye._bitshift64Shl,e._calloc=Ye._calloc,e._cellAreaKm2=Ye._cellAreaKm2,e._cellAreaM2=Ye._cellAreaM2,e._cellAreaRads2=Ye._cellAreaRads2,e._cellToBoundary=Ye._cellToBoundary,e._cellToCenterChild=Ye._cellToCenterChild,e._cellToChildPos=Ye._cellToChildPos,e._cellToChildren=Ye._cellToChildren,e._cellToChildrenSize=Ye._cellToChildrenSize,e._cellToLatLng=Ye._cellToLatLng,e._cellToLocalIj=Ye._cellToLocalIj,e._cellToParent=Ye._cellToParent,e._cellToVertex=Ye._cellToVertex,e._cellToVertexes=Ye._cellToVertexes,e._cellsToDirectedEdge=Ye._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=Ye._cellsToLinkedMultiPolygon,e._childPosToCell=Ye._childPosToCell,e._compactCells=Ye._compactCells,e._destroyLinkedMultiPolygon=Ye._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=Ye._directedEdgeToBoundary,e._directedEdgeToCells=Ye._directedEdgeToCells,e._edgeLengthKm=Ye._edgeLengthKm,e._edgeLengthM=Ye._edgeLengthM,e._edgeLengthRads=Ye._edgeLengthRads;var jr=e._emscripten_replace_memory=Ye._emscripten_replace_memory;e._free=Ye._free,e._getBaseCellNumber=Ye._getBaseCellNumber,e._getDirectedEdgeDestination=Ye._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=Ye._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=Ye._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=Ye._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=Ye._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=Ye._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=Ye._getIcosahedronFaces,e._getNumCells=Ye._getNumCells,e._getPentagons=Ye._getPentagons,e._getRes0Cells=Ye._getRes0Cells,e._getResolution=Ye._getResolution,e._greatCircleDistanceKm=Ye._greatCircleDistanceKm,e._greatCircleDistanceM=Ye._greatCircleDistanceM,e._greatCircleDistanceRads=Ye._greatCircleDistanceRads,e._gridDisk=Ye._gridDisk,e._gridDiskDistances=Ye._gridDiskDistances,e._gridDistance=Ye._gridDistance,e._gridPathCells=Ye._gridPathCells,e._gridPathCellsSize=Ye._gridPathCellsSize,e._gridRingUnsafe=Ye._gridRingUnsafe,e._i64Add=Ye._i64Add,e._i64Subtract=Ye._i64Subtract,e._isPentagon=Ye._isPentagon,e._isResClassIII=Ye._isResClassIII,e._isValidCell=Ye._isValidCell,e._isValidDirectedEdge=Ye._isValidDirectedEdge,e._isValidVertex=Ye._isValidVertex,e._latLngToCell=Ye._latLngToCell,e._llvm_maxnum_f64=Ye._llvm_maxnum_f64,e._llvm_minnum_f64=Ye._llvm_minnum_f64,e._llvm_round_f64=Ye._llvm_round_f64,e._localIjToCell=Ye._localIjToCell,e._malloc=Ye._malloc,e._maxFaceCount=Ye._maxFaceCount,e._maxGridDiskSize=Ye._maxGridDiskSize,e._maxPolygonToCellsSize=Ye._maxPolygonToCellsSize,e._memcpy=Ye._memcpy,e._memset=Ye._memset,e._originToDirectedEdges=Ye._originToDirectedEdges,e._pentagonCount=Ye._pentagonCount,e._polygonToCells=Ye._polygonToCells,e._readInt64AsDoubleFromPointer=Ye._readInt64AsDoubleFromPointer,e._res0CellCount=Ye._res0CellCount,e._round=Ye._round,e._sbrk=Ye._sbrk,e._sizeOfCellBoundary=Ye._sizeOfCellBoundary,e._sizeOfCoordIJ=Ye._sizeOfCoordIJ,e._sizeOfGeoLoop=Ye._sizeOfGeoLoop,e._sizeOfGeoPolygon=Ye._sizeOfGeoPolygon,e._sizeOfH3Index=Ye._sizeOfH3Index,e._sizeOfLatLng=Ye._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=Ye._sizeOfLinkedGeoPolygon,e._uncompactCells=Ye._uncompactCells,e._uncompactCellsSize=Ye._uncompactCellsSize,e._vertexToLatLng=Ye._vertexToLatLng,e.establishStackSpace=Ye.establishStackSpace;var zs=e.stackAlloc=Ye.stackAlloc,Dr=e.stackRestore=Ye.stackRestore,oi=e.stackSave=Ye.stackSave;if(e.asm=Ye,e.cwrap=ie,e.setValue=U,e.getValue=H,Wn){fo(Wn)||(Wn=s(Wn));{Vn();var Zn=function(K){K.byteLength&&(K=new Uint8Array(K)),Ze.set(K,k),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Si()},Os=function(){A(Wn,Zn,function(){throw"could not load memory initializer "+Wn})},Ui=Cr(Wn);if(Ui)Zn(Ui.buffer);else if(e.memoryInitializerRequest){var Vi=function(){var K=e.memoryInitializerRequest,W=K.response;if(K.status!==200&&K.status!==0){var ee=Cr(e.memoryInitializerRequestURL);if(ee)W=ee.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+K.status+", retrying "+Wn),Os();return}}Zn(W)};e.memoryInitializerRequest.response?setTimeout(Vi,0):e.memoryInitializerRequest.addEventListener("load",Vi)}else Os()}}var Ii;Kr=function K(){Ii||os(),Ii||(Kr=K)};function os(K){if(tr>0||(Un(),tr>0))return;function W(){Ii||(Ii=!0,!q&&(wr(),wt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),rn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),W()},1)):W()}e.run=os;function Rr(K){throw e.onAbort&&e.onAbort(K),K+="",o(K),g(K),q=!0,"abort("+K+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=Rr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return os(),t}(typeof Oi=="object"?Oi:{}),qn="number",Rn=qn,Mp=qn,Fn=qn,Nn=qn,no=qn,fn=qn,vme=[["sizeOfH3Index",qn],["sizeOfLatLng",qn],["sizeOfCellBoundary",qn],["sizeOfGeoLoop",qn],["sizeOfGeoPolygon",qn],["sizeOfLinkedGeoPolygon",qn],["sizeOfCoordIJ",qn],["readInt64AsDoubleFromPointer",qn],["isValidCell",Mp,[Fn,Nn]],["latLngToCell",Rn,[qn,qn,no,fn]],["cellToLatLng",Rn,[Fn,Nn,fn]],["cellToBoundary",Rn,[Fn,Nn,fn]],["maxGridDiskSize",Rn,[qn,fn]],["gridDisk",Rn,[Fn,Nn,qn,fn]],["gridDiskDistances",Rn,[Fn,Nn,qn,fn,fn]],["gridRingUnsafe",Rn,[Fn,Nn,qn,fn]],["maxPolygonToCellsSize",Rn,[fn,no,qn,fn]],["polygonToCells",Rn,[fn,no,qn,fn]],["cellsToLinkedMultiPolygon",Rn,[fn,qn,fn]],["destroyLinkedMultiPolygon",null,[fn]],["compactCells",Rn,[fn,fn,qn,qn]],["uncompactCells",Rn,[fn,qn,qn,fn,qn,no]],["uncompactCellsSize",Rn,[fn,qn,qn,no,fn]],["isPentagon",Mp,[Fn,Nn]],["isResClassIII",Mp,[Fn,Nn]],["getBaseCellNumber",qn,[Fn,Nn]],["getResolution",qn,[Fn,Nn]],["maxFaceCount",Rn,[Fn,Nn,fn]],["getIcosahedronFaces",Rn,[Fn,Nn,fn]],["cellToParent",Rn,[Fn,Nn,no,fn]],["cellToChildren",Rn,[Fn,Nn,no,fn]],["cellToCenterChild",Rn,[Fn,Nn,no,fn]],["cellToChildrenSize",Rn,[Fn,Nn,no,fn]],["cellToChildPos",Rn,[Fn,Nn,no,fn]],["childPosToCell",Rn,[qn,qn,Fn,Nn,no,fn]],["areNeighborCells",Rn,[Fn,Nn,Fn,Nn,fn]],["cellsToDirectedEdge",Rn,[Fn,Nn,Fn,Nn,fn]],["getDirectedEdgeOrigin",Rn,[Fn,Nn,fn]],["getDirectedEdgeDestination",Rn,[Fn,Nn,fn]],["isValidDirectedEdge",Mp,[Fn,Nn]],["directedEdgeToCells",Rn,[Fn,Nn,fn]],["originToDirectedEdges",Rn,[Fn,Nn,fn]],["directedEdgeToBoundary",Rn,[Fn,Nn,fn]],["gridDistance",Rn,[Fn,Nn,Fn,Nn,fn]],["gridPathCells",Rn,[Fn,Nn,Fn,Nn,fn]],["gridPathCellsSize",Rn,[Fn,Nn,Fn,Nn,fn]],["cellToLocalIj",Rn,[Fn,Nn,Fn,Nn,qn,fn]],["localIjToCell",Rn,[Fn,Nn,fn,qn,fn]],["getHexagonAreaAvgM2",Rn,[no,fn]],["getHexagonAreaAvgKm2",Rn,[no,fn]],["getHexagonEdgeLengthAvgM",Rn,[no,fn]],["getHexagonEdgeLengthAvgKm",Rn,[no,fn]],["greatCircleDistanceM",qn,[fn,fn]],["greatCircleDistanceKm",qn,[fn,fn]],["greatCircleDistanceRads",qn,[fn,fn]],["cellAreaM2",Rn,[Fn,Nn,fn]],["cellAreaKm2",Rn,[Fn,Nn,fn]],["cellAreaRads2",Rn,[Fn,Nn,fn]],["edgeLengthM",Rn,[Fn,Nn,fn]],["edgeLengthKm",Rn,[Fn,Nn,fn]],["edgeLengthRads",Rn,[Fn,Nn,fn]],["getNumCells",Rn,[no,fn]],["getRes0Cells",Rn,[fn]],["res0CellCount",qn],["getPentagons",Rn,[qn,fn]],["pentagonCount",qn],["cellToVertex",Rn,[Fn,Nn,qn,fn]],["cellToVertexes",Rn,[Fn,Nn,fn]],["vertexToLatLng",Rn,[Fn,Nn,fn]],["isValidVertex",Mp,[Fn,Nn]]],xme=0,wme=1,bme=2,Eme=3,o7=4,Tme=5,Sme=6,Mme=7,Cme=8,Pme=9,Ime=10,kme=11,Lme=12,Dme=13,Rme=14,Bme=15,Rs={};Rs[xme]="Success";Rs[wme]="The operation failed but a more specific error is not available";Rs[bme]="Argument was outside of acceptable range";Rs[Eme]="Latitude or longitude arguments were outside of acceptable range";Rs[o7]="Resolution argument was outside of acceptable range";Rs[Tme]="Cell argument was not valid";Rs[Sme]="Directed edge argument was not valid";Rs[Mme]="Undirected edge argument was not valid";Rs[Cme]="Vertex argument was not valid";Rs[Pme]="Pentagon distortion was encountered";Rs[Ime]="Duplicate input";Rs[kme]="Cell arguments were not neighbors";Rs[Lme]="Cell arguments had incompatible resolutions";Rs[Dme]="Memory allocation failed";Rs[Rme]="Bounds of provided memory were insufficient";Rs[Bme]="Mode or flags argument was not valid";var wv=1e3,zme=1001,Ome=1002,bv={};bv[wv]="Unknown unit";bv[zme]="Array length out of bounds";bv[Ome]="Got unexpected null value for H3 index";var Fme="Unknown error";function a7(t,e,n){var r=n&&"value"in n,i=new Error((t[e]||Fme)+" (code: "+e+(r?", value: "+n.value:"")+")");return i.code=e,i}function l7(t,e){var n=arguments.length===2?{value:e}:{};return a7(Rs,t,n)}function e4(t,e){var n=arguments.length===2?{value:e}:{};return a7(bv,t,n)}function HA(t){if(t!==0)throw l7(t)}var _s={};vme.forEach(function(e){_s[e[0]]=Oi.cwrap.apply(Oi,e)});var k0=16,Nme=4,ch=8,SE=_s.sizeOfH3Index(),Ume=_s.sizeOfLatLng(),Vme=_s.sizeOfCellBoundary();_s.sizeOfGeoPolygon();_s.sizeOfGeoLoop();_s.sizeOfLinkedGeoPolygon();_s.sizeOfCoordIJ();var Ti={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function A7(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw l7(o7,t);return t}var Gme=/[^0-9a-fA-F]/;function Ev(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||Gme.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),k0),n=parseInt(t.substring(t.length-8),k0);return[n,e]}function u8(t){if(t>=0)return t.toString(k0);t=t&2147483647;var e=u7(8,t.toString(k0)),n=(parseInt(e[0],k0)+8).toString(k0);return e=n+e.substring(1),e}function $me(t,e){return u8(e)+u7(8,u8(t))}function u7(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function jme(t,e){e===void 0&&(e=0);var n=Oi.getValue(t+SE*e,"i32"),r=Oi.getValue(t+SE*e+Nme,"i32");return r?$me(n,r):null}function t4(t,e){return e===void 0&&(e=0),Oi.getValue(t+ch*e,"double")}function Hme(t,e){for(var n=[],r=0;r<e;r++){var i=jme(t,r);i!==null&&n.push(i)}return n}function x2(t){return Zme(Oi.getValue(t,"double"))}function c7(t){return[x2(t),x2(t+ch)]}function Wme(t){return[x2(t+ch),x2(t)]}function Qme(t,e,n){for(var r=Oi.getValue(t,"i32"),i=t+ch,s=[],A=e?Wme:c7,o=0;o<r*2;o+=2)s.push(A(i+ch*o));return n&&s.push(s[0]),s}function h7(t){var e=Oi._malloc(Ume),n=Ev(t),r=n[0],i=n[1];try{return HA(_s.cellToLatLng(r,i,e)),c7(e)}finally{Oi._free(e)}}function qme(t,e){var n=Oi._malloc(Vme),r=Ev(t),i=r[0],s=r[1];try{return HA(_s.cellToBoundary(i,s,n)),Qme(n,e,e)}finally{Oi._free(n)}}function c8(t){var e=Ev(t),n=e[0],r=e[1],i=6,s=Oi._calloc(i,SE);try{return HA(_s.originToDirectedEdges(n,r,s)),Hme(s,i)}finally{Oi._free(s)}}function h8(t,e){var n=Ev(t),r=n[0],i=n[1],s=Oi._malloc(ch);try{switch(e){case Ti.m:HA(_s.edgeLengthM(r,i,s));break;case Ti.km:HA(_s.edgeLengthKm(r,i,s));break;case Ti.rads:HA(_s.edgeLengthRads(r,i,s));break;default:throw e4(wv,e)}return t4(s)}finally{Oi._free(s)}}function w2(t,e){A7(t);var n=Oi._malloc(ch);try{switch(e){case Ti.m2:HA(_s.getHexagonAreaAvgM2(t,n));break;case Ti.km2:HA(_s.getHexagonAreaAvgKm2(t,n));break;default:throw e4(wv,e)}return t4(n)}finally{Oi._free(n)}}function Fu(t,e){A7(t);var n=Oi._malloc(ch);try{switch(e){case Ti.m:HA(_s.getHexagonEdgeLengthAvgM(t,n));break;case Ti.km:HA(_s.getHexagonEdgeLengthAvgKm(t,n));break;default:throw e4(wv,e)}return t4(n)}finally{Oi._free(n)}}function Zme(t){return t*180/Math.PI}function Yme({res:t}){const e=je.useRef(),n=je.useRef();return je.useLayoutEffect(()=>{io(e.current).attr("width",400).attr("height",500).call(function(s){s.append("g").call($A.arcmapLegend().vtitle("Groundwater").utitle("Variance").scale($r.groundwater.vsup).size(150).x(400-180).y(500-450))}).call(function(s){s.append("g").call($A.simpleLegend().title("Difference w/ Baseline").size(250).height(20).scale($r.difference.colorsStepped).x(400-280).y(500-250))}).call(function(s){s.append("g").call(VF(400-100,500-100,70,"rgba(146, 146, 146, 0.5)")).call(function(A){n.current=[A.append("text").attr("x",400-100).attr("y",500-92).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${Math.round(w2(t,Ti.km2))} km`),A.append("text").attr("x",400-100).attr("y",500-50).attr("text-anchor","middle").style("font-size","11px").text(` ${Math.round(Fu(t,Ti.km))} km ;`)]})})},[]),je.useEffect(()=>{let[r,i]=n.current;r.text(`${Math.round(w2(t,Ti.km2))} km`),i.text(` ${Math.round(Fu(t,Ti.km))} km ;`)},[t]),yt.createElement("svg",{className:"legend-area",ref:e})}function Xme({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s,res:A}){return yt.createElement(yt.Fragment,null,yt.createElement(JS,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),yt.createElement(Yme,{res:A}),yt.createElement("div",{className:"styled-input"},yt.createElement("button",{onClick:()=>{s(o=>!o)}},i?"Pause":"Play"),yt.createElement("div",null,yt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(o){r(parseInt(o.target.value))}}),yt.createElement("input",{onChange:function(o){s(!1),r(parseInt(o.target.value))},onInput:function(o){r(parseInt(o.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}const Kme=/^[og]\s*(.+)?/,Jme=/^mtllib /,e1e=/^usemtl /;class n4{constructor(e){let{index:n,name:r="",mtllib:i,smooth:s,groupStart:A}=e;this.index=n,this.name=r,this.mtllib=i,this.smooth=s,this.groupStart=A,this.groupEnd=-1,this.groupCount=-1,this.inherited=!1}clone(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.index;return new n4({index:e,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0})}}class t1e{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this.name=e,this.geometry={vertices:[],normals:[],colors:[],uvs:[]},this.materials=[],this.smooth=!0,this.fromDeclaration=null}startMaterial(e,n){const r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);const i=new n4({index:this.materials.length,name:e,mtllib:Array.isArray(n)&&n.length>0?n[n.length-1]:"",smooth:r!==void 0?r.smooth:this.smooth,groupStart:r!==void 0?r.groupEnd:0});return this.materials.push(i),i}currentMaterial(){if(this.materials.length>0)return this.materials[this.materials.length-1]}_finalize(e){const n=this.currentMaterial();if(n&&n.groupEnd===-1&&(n.groupEnd=this.geometry.vertices.length/3,n.groupCount=n.groupEnd-n.groupStart,n.inherited=!1),e&&this.materials.length>1)for(let r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),n}}class n1e{constructor(){this.objects=[],this.object=null,this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.materialLibraries=[],this.startObject("",!1)}startObject(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.object&&!this.object.fromDeclaration){this.object.name=e,this.object.fromDeclaration=n;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object=new t1e(e),this.object.fromDeclaration=n,r&&r.name&&typeof r.clone=="function"){const i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)}finalize(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)}parseVertexIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseNormalIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/3)*3}parseUVIndex(e,n){const r=parseInt(e);return(r>=0?r-1:r+n/2)*2}addVertex(e,n,r){const i=this.vertices,s=this.object.geometry.vertices;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addVertexPoint(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addVertexLine(e){const n=this.vertices;this.object.geometry.vertices.push(n[e+0],n[e+1],n[e+2])}addNormal(e,n,r){const i=this.normals,s=this.object.geometry.normals;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addColor(e,n,r){const i=this.colors,s=this.object.geometry.colors;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[n+0],i[n+1],i[n+2]),s.push(i[r+0],i[r+1],i[r+2])}addUV(e,n,r){const i=this.uvs,s=this.object.geometry.uvs;s.push(i[e+0],i[e+1]),s.push(i[n+0],i[n+1]),s.push(i[r+0],i[r+1])}addUVLine(e){const n=this.uvs;this.object.geometry.uvs.push(n[e+0],n[e+1])}addFace(e,n,r,i,s,A,o,g,w){const C=this.vertices.length;let I=this.parseVertexIndex(e,C),k=this.parseVertexIndex(n,C),U=this.parseVertexIndex(r,C);if(this.addVertex(I,k,U),i!==void 0&&i!==""){const H=this.uvs.length;I=this.parseUVIndex(i,H),k=this.parseUVIndex(s,H),U=this.parseUVIndex(A,H),this.addUV(I,k,U)}if(o!==void 0&&o!==""){const H=this.normals.length;I=this.parseNormalIndex(o,H),k=o===g?I:this.parseNormalIndex(g,H),U=o===w?I:this.parseNormalIndex(w,H),this.addNormal(I,k,U)}this.colors.length>0&&this.addColor(I,k,U)}addPointGeometry(e){this.object.geometry.type="Points";const n=this.vertices.length;for(const r of e)this.addVertexPoint(this.parseVertexIndex(r,n))}addLineGeometry(e,n){this.object.geometry.type="Line";const r=this.vertices.length,i=this.uvs.length;for(const s of e)this.addVertexLine(this.parseVertexIndex(s,r));for(const s of n)this.addUVLine(this.parseUVIndex(s,i))}}function r1e(t){const e=new n1e;t.indexOf(`\r
`)!==-1&&(t=t.replace(/\r\n/g,`
`)),t.indexOf(`\\
`)!==-1&&(t=t.replace(/\\\n/g,""));const n=t.split(`
`);let r="",i="",s=0,A=[];const o=typeof"".trimLeft=="function";for(let C=0,I=n.length;C<I;C++)if(r=n[C],r=o?r.trimLeft():r.trim(),s=r.length,s!==0&&(i=r.charAt(0),i!=="#"))if(i==="v"){const k=r.split(/\s+/);switch(k[0]){case"v":e.vertices.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3])),k.length>=7&&e.colors.push(parseFloat(k[4]),parseFloat(k[5]),parseFloat(k[6]));break;case"vn":e.normals.push(parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]));break;case"vt":e.uvs.push(parseFloat(k[1]),parseFloat(k[2]));break}}else if(i==="f"){const U=r.substr(1).trim().split(/\s+/),H=[];for(let se=0,X=U.length;se<X;se++){const te=U[se];if(te.length>0){const ie=te.split("/");H.push(ie)}}const q=H[0];for(let se=1,X=H.length-1;se<X;se++){const te=H[se],ie=H[se+1];e.addFace(q[0],te[0],ie[0],q[1],te[1],ie[1],q[2],te[2],ie[2])}}else if(i==="l"){const k=r.substring(1).trim().split(" ");let U;const H=[];if(r.indexOf("/")===-1)U=k;else{U=[];for(let q=0,se=k.length;q<se;q++){const X=k[q].split("/");X[0]!==""&&U.push(X[0]),X[1]!==""&&H.push(X[1])}}e.addLineGeometry(U,H)}else if(i==="p"){const U=r.substr(1).trim().split(" ");e.addPointGeometry(U)}else if((A=Kme.exec(r))!==null){const k=(" "+A[0].substr(1).trim()).substr(1);e.startObject(k)}else if(e1e.test(r))e.object.startMaterial(r.substring(7).trim(),e.materialLibraries);else if(Jme.test(r))e.materialLibraries.push(r.substring(7).trim());else if(i==="s"){if(A=r.split(" "),A.length>1){const U=A[1].trim().toLowerCase();e.object.smooth=U!=="0"&&U!=="off"}else e.object.smooth=!0;const k=e.object.currentMaterial();k&&(k.smooth=e.object.smooth)}else{if(r==="\0")continue;throw new Error('Unexpected line: "'.concat(r,'"'))}e.finalize();const g=[],w=[];for(const C of e.objects){const{geometry:I}=C;if(I.vertices.length===0)continue;const k={header:{vertexCount:I.vertices.length/3},attributes:{}};switch(I.type){case"Points":k.mode=0;break;case"Line":k.mode=1;break;default:k.mode=4;break}k.attributes.POSITION={value:new Float32Array(I.vertices),size:3},I.normals.length>0&&(k.attributes.NORMAL={value:new Float32Array(I.normals),size:3}),I.colors.length>0&&(k.attributes.COLOR_0={value:new Float32Array(I.colors),size:3}),I.uvs.length>0&&(k.attributes.TEXCOORD_0={value:new Float32Array(I.uvs),size:2}),k.materials=[];for(const U of C.materials){const H={name:U.name,flatShading:!U.smooth};k.materials.push(H),w.push(H)}k.name=C.name,g.push(k)}return{meshes:g,materials:w}}function i1e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;for(const i in e)n=n||new Map,i!=="value"&&n.set(i,JSON.stringify(e[i]));const r=[];for(const i in t){const s=t[i],A=s1e(i,s);r.push(A)}return new T0(r,n)}function s1e(t,e){const n=new Map;for(const s in e)s!=="value"&&n.set(s,JSON.stringify(e[s]));const r=Cce(e.value);return!("size"in e)||e.size===1?new rg(t,r,!1,n):new rg(t,new Mce(e.size,new rg("value",r)),!1,n)}function f8(t,e){const{meshes:n}=r1e(t),r=n.reduce((o,g)=>o+g.header.vertexCount,0),i=o1e(n,r),s={vertexCount:r,boundingBox:RO(i)},A=i1e(i,{mode:4,boundingBox:s.boundingBox});return{loaderData:{header:{}},schema:A,header:s,mode:4,attributes:i}}function o1e(t,e){const n=new Float32Array(e*3);let r,i,s,A=0;for(const g of t){const{POSITION:w,NORMAL:C,COLOR_0:I,TEXCOORD_0:k}=g.attributes;n.set(w.value,A*3),C&&(r=r||new Float32Array(e*3),r.set(C.value,A*3)),I&&(i=i||new Float32Array(e*3),i.set(I.value,A*3)),k&&(s=s||new Float32Array(e*2),s.set(k.value,A*2)),A+=w.value.length/3}const o={};return o.POSITION={value:n,size:3},r&&(o.NORMAL={value:r,size:3}),i&&(o.COLOR_0={value:i,size:3}),s&&(o.TEXCOORD_0={value:s,size:2}),o}const a1e="3.4.14",l1e={name:"OBJ",id:"obj",module:"obj",version:a1e,worker:!0,extensions:["obj"],mimeTypes:["text/plain"],testText:A1e,options:{obj:{}}};function A1e(t){return t[0]==="v"}const r4={...l1e,parse:async(t,e)=>f8(new TextDecoder().decode(t)),parseTextSync:(t,e)=>f8(t)},u1e=ea().domain([0,1]).range(Bne(0,A2.length)),c1e=A2[0];class bm extends Ar{initializeState(){super.initializeState();const{zoom:e}=this.context.viewport,n=Object.keys(this.props.data).map(s=>parseInt(s)),r=ms().domain(this.props.zoomRange).range([0,1]).clamp(!0),i=ea().domain([0,1]).range(n)(r(e));this.setState({hextiles:this.props.data,resRange:n,lastResolution:i,valueInterpResolution:r}),this.createPolygons()}createPolygons(){const{hextiles:e,lastResolution:n}=this.state,r=[],i=e[n],[s,A]=this.props.offset;Object.keys(i).forEach(o=>{const g=i[o],w=h8(c8(o)[0],Ti.km)*.48,[C,I]=h7(o);let k=0;const U=Fu(n,Ti.km)/Fu(5,Ti.km);for(let[H,q,se]of this.props.getValue?c1e:[[0,0,0]])r.push({position:[I+(H+s)*w/(111.32*Math.cos(C*Math.PI/180)),C+(q+A)*w/110.574,(typeof this.props.getElevation=="function"?this.props.getElevation({properties:g}):this.props.getElevation)+se*1e5*U],properties:g,polyIdx:k++,hexID:o})}),this.setState({...this.state,polygons:r})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:A,changeFlags:o,context:g}=e;if(s.getElevation!=A.getElevation||o.viewportChanged){const w=ea().domain([0,1]).range(n)(i(g.viewport.zoom));(w!=r||s.getElevation!=A.getElevation)&&(this.setState({...this.state,lastResolution:w}),this.createPolygons())}}renderLayers(){const{polygons:e,lastResolution:n,resRange:r}=this.state,i=Fu(n,Ti.km)/Fu(5,Ti.km);return[new sv(this.getSubLayerProps({data:this.props.data,mesh:this.props.mesh,texture:this.props.texture,textureParameters:this.props.textureParameters,getPosition:this.props.getPosition,getColor:this.props.getColor,getOrientation:this.props.getOrientation,getScale:this.props.getScale,getTranslation:this.props.getTranslation,getTransformMatrix:this.props.getTransformMatrix,sizeScale:this.props.sizeScale,_useMeshColors:this.props._useMeshColors,_instanced:this.props._instanced,wireframe:this.props.wireframe,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"IconHexTileLayer",data:e,getPosition:s=>s.position,sizeScale:this.props.sizeScale*i,getTranslation:this.props.getValue===null?[0,0,0]:s=>{const A=A2[u1e(this.props.getValue(s))][s.polyIdx],o=A2[0][s.polyIdx],g=h8(c8(s.hexID)[0],Ti.m)*.5;return[(A[0]-o[0])*g,(A[1]-o[1])*g,(A[2]-o[2])*1e5*i]}}))]}}bm.layerName="IconHexTileLayer";bm.defaultProps={...Ar.defaultProps,...sv.defaultProps,thicknessRange:[.7,.9],getValue:null,getElevation:()=>0,offset:[0,0],zoomRange:[7,9]};function d8(t,e,n=1){const r=n,[i,s]=h7(t);return e.map(o=>{let g=ul(s,o[0],r),w=ul(i,o[1],r);return[g,w]})}function h1e(t,[e,n]){let r=qme(t).map(A=>[A[1],A[0]]),i=d8(t,r,n),s=d8(t,r,e);return[i,s]}class ic extends Ar{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=ms().domain(this.props.zoomRange).range([0,1]).clamp(!0),r=ea().domain([0,1]).range(e)(n(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:r,valueInterpResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],r=this.props.data[e];Object.keys(r).forEach((i,s)=>{let A=r[i];const o=this.props.getValue?ms().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:A})):this.props.thicknessRange[0];let g=h1e(i,[o,this.props.thicknessRange[1]]);this.props.raised?n.push({polygon:g.map(w=>w.map(([C,I])=>[C,I,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:i,properties:A}):this.props.getElevation])),hexId:i,properties:A}):n.push({hexId:i,polygon:g,properties:A})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:A,changeFlags:o,context:g}=e;if(s.getElevation!=A.getElevation||s.getValue!=A.getValue||o.viewportChanged){const w=ea().domain([0,1]).range(n)(i(g.viewport.zoom));(w!=r||s.getValue!=A.getValue||s.getElevation!=A.getElevation)&&(this.setState({...this.state,lastResolution:w}),this.createPolygons())}}renderLayers(){return[new kf(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,extruded:this.props.extruded,wireframe:this.props.wireframe,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"SolidHexTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}ic.layerName="SolidHexTileLayer";ic.defaultProps={...Ar.defaultProps,...kf.defaultProps,thicknessRange:[.7,.9],getValue:void 0,raised:!1,zoomRange:[7,9]};class Tv extends Ar{renderLayers(){const{data:e,deagData:n,curOption:r,hoveredHex:i,visible:s,clickedHexes:A,hoveredGeoActive:o,hoveredGeos:g,selectedGeoJSON:w,selectedGeos:C,selectionFinalized:I,zoomRange:k,getFillColor:U}=this.props;return[new ns({id:"GeoJsonGray",data:n,opacity:.3,stroked:!1,getFillColor:H=>!I&&H.properties.id in g?[100,100,100,205*g[H.properties.id]+50]:[0,0,0,0],visible:s&&!I,updateTriggers:{getFillColor:[i,I]}}),new ns({id:"GeoJsonColor",data:n,opacity:1,pickable:!0,visible:s,getLineWidth:H=>H.properties.id in C?H.properties.id==o?100:20:0,getFillColor:H=>{if(H.properties.id in C){if(H.properties.id==o){const q=[0,0,.5019607843137255,.5019607843137255],se=[...U({properties:C[H.properties.id]}),255];return[(q[0]*q[3]+se[0]/255*(1-q[3]))*255,(q[1]*q[3]+se[1]/255*(1-q[3]))*255,(q[2]*q[3]+se[2]/255*(1-q[3]))*255,(q[3]*q[3]+se[3]/255*(1-q[3]))*255]}return[...U({properties:C[H.properties.id]}),255]}return[0,0,0,0]},getLineColor:[0,0,0],updateTriggers:{getFillColor:[...this.props.updateTriggers.getFillColor||[],o,r,I],getLineWidth:[o,r,I]}}),new ic({id:"HoveringTiles",data:e,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!I,autoHighlight:!I,visible:s,zoomRange:k})]}}Tv.layerName="DeaggregatedLayer";Tv.defaultProps={...Ar.defaultProps,autoHighlight:!0};const Lh=0;let i4=class extends Ar{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:A,zoomRange:o}=this.props;return[new ic({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:g=>$r.groundwater.interpVsup(g.properties.Groundwater[r],g.properties.GroundwaterVar[r]),opacity:1,visible:A,updateTriggers:{getFillColor:[r]},zoomRange:o}),new ic({id:"DiffRings",data:e,thicknessRange:[.4,.65],getFillColor:g=>n==0?$r.difference.interpVsup(g.properties.UnmetDemand[kr[Lh]][r]-g.properties.UnmetDemandBaseline[r],a2(g.properties.UnmetDemandBaselineVar[r],g.properties.UnmetDemandVar[kr[Lh]][r]),!0):$r.difference.interpColor(g.properties.UnmetDemand[kr[Lh]][r]-g.properties.UnmetDemandBaseline[r],!0),getValue:g=>n==0?1:$r.difference.scaleLinearVar(a2(g.properties.UnmetDemandBaselineVar[r],g.properties.UnmetDemandVar[kr[Lh]][r]))*.8+.2,raised:!0,visible:A,getElevation:g=>g.hexId in i?5e3:0,getLineWidth:g=>g.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new ov({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new bm({id:"ScenarioUnmet",data:e,loaders:[r4],mesh:"./assets/drop.obj",raised:!0,getColor:g=>[255,130,35,$r.unmetDemand.scaleLinearVar(g.properties.UnmetDemandVar[kr[Lh]][r])*200+55],getValue:g=>$r.unmetDemand.scaleLinear(g.properties.UnmetDemand[kr[Lh]][r]),visible:A,sizeScale:3e3,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new Tv({...this.props,id:"DeagLayer",data:e,deagData:jA,getFillColor:g=>$r.unmetDemand.interpColor(g.properties.UnmetDemand[kr[Lh]][r],!1,!1),updateTriggers:{getFillColor:[r]}})]}};i4.layerName="MultivariableHextileLayer";i4.defaultProps={...Ar.defaultProps,autoHighlight:!0};function f1e(){const{current:t}=je.useRef(Object.keys(h2).map(o=>parseInt(o))),[e,n]=je.useState(u2.zoom),r=qS(),i=wm({disabled:r.curOption>1,dataDeag:jA,deagKey:"DURgs"}),{getTooltip:s}=i7(r),A={data:h2,...r,...i};return yt.createElement(yt.Fragment,null,yt.createElement(Md,{controller:!0,effects:[ph],initialViewState:u2,getTooltip:s,onViewStateChange:({viewState:o})=>{n(o.zoom)}},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA}),yt.createElement(xv,{id:"slide-terrain",...A}),yt.createElement(i4,{id:"slide-waters",...A,zoomRange:[7,9],visible:!0})),yt.createElement(Xme,{...A,res:ea().domain([0,1]).range(t)(ms().domain([7,9]).range([0,1]).clamp(!0)(e))}))}function d1e(){const[t,e]=je.useState(1027),[n,r]=je.useState(!1),[i,s]=je.useState(1);return je.useEffect(()=>{if(n){let A=setTimeout(()=>e(o=>o%1199+1),33.333333333333336);return function(){clearTimeout(A)}}},[t,n]),{speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r,curOption:i,setCurOption:s}}function p1e({dataDeag:t,disabled:e=!1,deagKey:n}){const{current:r}=je.useRef(UF(t.features,fe=>fe.properties.id)),[i,s]=je.useState(null),[A,o]=je.useState({}),[g,w]=je.useState([]),[C,I]=je.useState({}),[k,U]=je.useState({type:"FeatureCollection",features:[]}),[H,q]=je.useState({}),[se,X]=je.useState(!1),te=je.useCallback(({object:fe})=>{if(!fe){s(null),o({}),w([]);return}if(!e){if(se)s(null),o({}),w(fe.properties.id);else if(fe.properties[n]){const me=v2.h3ToFeature(fe.hexId),Se={};for(const He of fe.properties[n]){const Qe=r[He],Ke=m2(me,Qe.geometry);Se[Qe.properties.id]=d2(Ke)/d2(me)}o(Se),s(fe.hexId)}return!0}},[C,se,e,n]),ie=je.useCallback(({object:fe},me)=>{if(fe.properties.id==g)return U({type:"FeatureCollection",features:[]}),q({}),I({}),X(!1),!0;if(fe.properties[n]==null)return;if(me.srcEvent.shiftKey)return I(Ke=>({...Ke,[fe.hexId]:fe.properties[n]})),!0;X(!0),s(null),o({}),w(fe.properties.id),I({});const Se={...C,[fe.hexId]:fe.properties[n]};I(Se);const He={},Qe={type:"FeatureCollection",features:[]};for(const Ke in Se)for(const nt of Se[Ke]){const Ne=r[nt],rt=v2.h3ToFeature(Ke),Ze=m2(rt,Ne.geometry);Qe.features.push({...Ze,properties:{...Ne.properties}}),He[Ne.properties.id]={...Ne.properties}}return q(He),U(Qe),!0},[C,g,se,n]);return{hoveredHex:i,clickedHexes:C,hoveredGeos:A,selectedGeoJSON:k,selectedGeos:H,hoveredGeoActive:g,onHover:te,onClick:ie,selectionFinalized:se}}const Tu=0;function g1e({speedyCounter:t,curOption:e}){const n=je.useRef(),r=je.useRef(),i=je.useRef({});je.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=je.useCallback(w=>{const C=w.properties.Demand[kr[Tu]][t],I=-w.properties.UnmetDemand[kr[Tu]][t],k=-I-w.properties.UnmetDemandBaseline[t];n.current.classList.add("active"),r.current.classList.add("active"),r.current.innerHTML=`        <div><b>Region ID</b> ${w.properties.id}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${I}</div>
        <div><b>Difference in Unmet Demand</b> ${k}</div>
        <div><b>Land Holder</b> ${q0(w)}</div>
      `},[t]),A=je.useCallback(w=>{if(r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${l2(Qh(t))}</i></div>
      `,w.properties.Demand){const C=w.properties.Demand[kr[Tu]][t],I=-w.properties.UnmetDemand[kr[Tu]][t],k=-I-w.properties.UnmetDemandBaseline[t];n.current.innerHTML+=`        
          <div><i>${c2[Tu]}</i></div>
          <div><b>Region ID</b> ${w.properties.id}</div>
          <div><b>Scenario Demand</b> ${C}</div>
          <div><b>Scen. Unmet Demand</b> ${I}</div>
          <div><b>Difference in Unmet Demand</b> ${k}</div>
          <div><b>Land Holder</b> ${q0(w)}</div>
        `}else{const C=w.properties.Groundwater[t];n.current.innerHTML+=`     
          <div><b>Elem ID</b> ${w.properties.id}</div>
          <div><b>Groundwater</b> ${C}</div>
      `}},[t]),o=je.useCallback(w=>{const C=w.properties.Demand[kr[Tu]][t],I=-w.properties.UnmetDemand[kr[Tu]][t],k=-I-w.properties.UnmetDemandBaseline[t],U=w.properties.Groundwater[t],H=w.properties.GroundwaterVar[t],q=w.properties.UnmetDemandVar[kr[Tu]][t],se=a2(w.properties.UnmetDemandBaselineVar[t],q),X=w.properties.DURgs.join(", "),te=w.properties.GWRgs.join(", ");r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`        <div><i>${l2(Qh(t))}</i></div>
        <div><i>${c2[Tu]}</i></div>
        <div><b>Groundwater</b> ${U}</div>
        <div><b>Scenario Demand</b> ${C}</div>
        <div><b>Scen. Unmet Demand</b> ${I}</div>
        <div><b>Difference in Unmet Demand</b> ${k}</div>
        <div><b>Land Holder</b> ${q0(w)}</div>
        <div><b>Variance (GW)</b> ${H}</div>
        <div><b>Var. (Scen. UnmetDem)</b> ${q}</div>
        <div><b>Var. (Difference)</b> ${se}</div>
        <div><b>Demand Regions</b> ${X}</div>
        <div><b>GW Regions</b> ${te}</div>
      `},[t]);return{getTooltip:je.useCallback(({object:w})=>{if(!w){i.current&&(r.current.classList.remove("active"),yd(i.current)&&n.current.classList.remove("active"),i.current=w),e>1&&(r.current.classList.remove("active"),n.current.classList.remove("active"));return}e<=1&&yd(w)?o(w):e<=1&&pv(w)?s(w):A(w),i.current=w},[t,e])}}let s4=class extends Ar{renderLayers(){return[new ff({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new cf(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}};s4.layerName="BaseTerrainLayer";s4.defaultProps={...Ar.defaultProps};const p8=0;let o4=class extends Ar{renderLayers(){const{curOption:e,speedyCounter:n}=this.props;return[new ns({id:"GroundwaterGeo",data:QS,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...$r.groundwater.interpColor(r.properties.Groundwater[n]),255],visible:e==2,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new ns({id:"UDemGeo",data:jA,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...$r.unmetDemand.interpColor(r.properties.UnmetDemand[kr[p8]][n]),255],visible:e==3,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0}),new ns({id:"DemDiffGeo",data:jA,opacity:1,stroked:!1,filled:!0,getFillColor:r=>[...$r.difference.interpColor(r.properties.UnmetDemand[kr[p8]][n]-r.properties.UnmetDemandBaseline[n]),255],visible:e==4,updateTriggers:{getFillColor:[n]},pickable:!0,autoHighlight:!0})]}};o4.layerName="BasicGeoLayer";o4.defaultProps={...Ar.defaultProps,autoHighlight:!0};function m1e({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return yt.createElement(yt.Fragment,null,yt.createElement(JS,{counter:n,displayMonth:!1,dataset:"averageDemandBaseline"}),yt.createElement("div",{className:"styled-input"},yt.createElement("button",{onClick:()=>{s(A=>!A)}},i?"Pause":"Play"),yt.createElement("div",null,yt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:n,onChange:function(A){r(parseInt(A.target.value))}}),yt.createElement("input",{onChange:function(A){s(!1),r(parseInt(A.target.value))},onInput:function(A){r(parseInt(A.target.value))},value:n,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}function f7(t){const[e,n,r]=t.split("/"),i=a4(r);return[parseFloat(e)+i/2,parseFloat(n)+i/2]}function y1e(t,e,n=1,r){const i=n,[s,A]=f7(t),o=d7(t),g=a4(o)/4*i;return e.map(C=>{let I=ul(A,C[0],i),k=ul(s,C[1],i);return[I+g*r[0],k+g*r[1]]})}function d7(t){const[e,n,r]=t.split("/");return parseInt(r)}function _1e(t){const[e,n]=f7(t),r=d7(t),i=a4(r)/4;return[[e+i,n-i],[e+i,n+i],[e-i,n+i],[e-i,n-i]]}function v1e(t){return t/111.1}function x1e(t){return Fu(parseInt(t),Ti.km)*2}function a4(t){return v1e(x1e(t))}function w1e(t,[e,n],r){let i=_1e(t).map(A=>[A[1],A[0]]);return[y1e(t,i,1-e,r)]}class sh extends Ar{initializeState(){super.initializeState();const e=Object.keys(this.props.data).map(i=>parseInt(i)),n=ms().domain(this.props.zoomRange).range([0,1]).clamp(!0),r=ea().domain([0,1]).range(e)(n(this.context.viewport.zoom));this.setState({...this.state,resRange:e,lastResolution:r,valueInterpResolution:n}),this.createPolygons()}createPolygons(){const{lastResolution:e}=this.state,n=[],r=this.props.data[e];Object.keys(r).forEach((i,s)=>{let A=r[i];const o=this.props.getValue?ms().domain([0,1]).range([this.props.thicknessRange[1],this.props.thicknessRange[0]])(this.props.getValue({properties:A})):this.props.thicknessRange[0];let g=w1e(i,[o,this.props.thicknessRange[1]],this.props.offset);this.props.raised?n.push({polygon:g.map(w=>w.map(([C,I])=>[C,I,typeof this.props.getElevation=="function"?this.props.getElevation({hexId:i,properties:A}):this.props.getElevation])),hexId:i,properties:A}):n.push({hexId:i,polygon:g,properties:A})}),this.setState({...this.state,polygons:n})}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){const{resRange:n,lastResolution:r,valueInterpResolution:i}=this.state,{props:s,oldProps:A,changeFlags:o,context:g}=e;if(s.getElevation!=A.getElevation||s.getValue!=A.getValue||o.viewportChanged){const w=ea().domain([0,1]).range(n)(i(g.viewport.zoom));(w!=r||s.getValue!=A.getValue||s.getElevation!=A.getElevation)&&(this.setState({...this.state,lastResolution:w}),this.createPolygons())}}renderLayers(){return[new kf(this.getSubLayerProps({data:this.props.data,filled:this.props.filled,stroked:this.props.stroked,extruded:this.props.extruded,wireframe:this.props.wireframe,_normalize:this.props._normalize,_windingOrder:this.props._windingOrder,_full3d:this.props._full3d,elevationScale:this.props.elevationScale,getPolygon:this.props.getPolygon,getElevation:this.props.getElevation,getFillColor:this.props.getFillColor,getLineColor:this.props.getLineColor,getLineWidth:this.props.getLineWidth,material:this.props.material,transitions:this.props.transitions,updateTriggers:this.props.updateTriggers,id:"SolidHexTileLayer",data:this.state.polygons,getPolygon:e=>e.polygon,pickable:this.props.pickable,autoHighlight:this.props.autoHighlight,extensions:this.props.extensions,getOffset:this.props.getOffset,lineJointRounded:this.props.lineJointRounded}))]}}sh.layerName="SolidHexTileLayer";sh.defaultProps={...Ar.defaultProps,...kf.defaultProps,thicknessRange:[0,1],getValue:void 0,raised:!1,zoomRange:[7,9],offset:[0,0]};const g8=0;let l4=class extends Ar{renderLayers(){const{data:e,curOption:n,speedyCounter:r,clickedHexes:i,selectionFinalized:s,visible:A,zoomRange:o}=this.props;return[new sh({id:"Groundwater",data:e,thicknessRange:[0,1],getFillColor:g=>$r.groundwater.interpColor(450),getValue:g=>$r.groundwater.scaleLinear(g.properties.Groundwater[r]),opacity:1,visible:A,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[1,1]}),new sh({id:"Difference",data:e,thicknessRange:[0,1],getFillColor:g=>$r.difference.interpColor(18,!1),getValue:g=>$r.difference.scaleLinear(g.properties.UnmetDemand[kr[g8]][r]-g.properties.UnmetDemandBaseline[r]),opacity:1,visible:A,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[1,-1]}),new sh({id:"UnmetDemand",data:e,thicknessRange:[0,1],getFillColor:g=>$r.difference.interpColor(-18,!1),getValue:g=>$r.unmetDemand.scaleLinear(g.properties.UnmetDemand[kr[g8]][r]),opacity:1,visible:A,updateTriggers:{getFillColor:[r]},zoomRange:o,offset:[-1,-1]})]}};l4.layerName="MultivariableHextileLayer";l4.defaultProps={...Ar.defaultProps,autoHighlight:!0};function b1e(){const t=d1e(),e=p1e({disabled:t.curOption>1,dataDeag:jA,deagKey:"DURgs"}),{getTooltip:n}=g1e(t),r={data:Vpe,...t,...e};return yt.createElement(yt.Fragment,null,yt.createElement(Md,{controller:!0,effects:[ph],initialViewState:u2,getTooltip:n},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA}),yt.createElement(s4,{id:"slide-terrain",...r}),yt.createElement(l4,{id:"slide-waters",...r,zoomRange:[7,9],visible:!0}),yt.createElement(o4,{id:"slide-basic",...r})),yt.createElement(m1e,{...r}))}const nb=512,E1e=Math.PI/180;function p7({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n?.props._customRender,i=n?.props.onLoad,s=m7({...n?.props,_customRender:()=>{t.triggerRepaint(),r?.("")}});let A;return(!n||n.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:Xg(t)}),n!=null&&n.isInitialized?m8(n,t):s.onLoad=()=>{i?.(),m8(A,t)}),n?(A=n,n.setProps(s),n.userData.isExternal=!0):(A=new af(s),t.on("remove",()=>{g7(t)})),A.userData.mapboxLayers=new Set,t.__deck=A,t.on("render",()=>{A.isInitialized&&I1e(A,t)}),A}function m8(t,e){const n=()=>{t.isInitialized?k1e(t,e):e.off("move",n)};e.on("move",n)}function g7(t){var e;(e=t.__deck)===null||e===void 0||e.finalize(),t.__deck=null}function m7(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new Gu({id:"mapbox"})]}}function T1e(t,e){t.userData.mapboxLayers.add(e),A4(t)}function S1e(t,e){t.userData.mapboxLayers.delete(e),A4(t)}function M1e(t,e){A4(t)}function C1e(t,e,n){let{currentViewport:r}=t.userData,i=!1;r||(r=y7(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:s})=>n.id===s.id||s.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function Xg(t){var e;const{lng:n,lat:r}=t.getCenter(),i={longitude:(n+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(e=t.getTerrain)!==null&&e!==void 0&&e.call(t)&&P1e(t,i),i}function P1e(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:i,latitude:s,pitch:A}=e,o=n.x*nb,g=(1-n.y)*nb,w=n.z*nb,C=nA([i,s]),I=o-C[0],k=g-C[1],U=Math.sqrt(I*I+k*k),H=A*E1e,q=1.5*r,se=H<.001?q*Math.cos(H)/w:q*Math.sin(H)/U;e.zoom=Math.log2(se);const X=q*Math.cos(H)/se,te=w-X;e.position=[0,0,te/my(s)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function y7(t,e,n=!0){return new Ku({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...Xg(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function I1e(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const i=Array.from(n,C=>C.id),A=of(t.props.layers,Boolean).some(C=>C&&!i.includes(C.id));let o=t.getViewports();const g=o.findIndex(C=>C.id==="mapbox"),w=o.length>1||g<0;(A||w)&&(g>=0&&(o=o.slice(),o[g]=y7(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:o,layerFilter:C=>(!t.props.layerFilter||t.props.layerFilter(C))&&(C.viewport.id!=="mapbox"||!i.includes(C.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function k1e(t,e){t.setProps({viewState:Xg(e)}),t.needsRedraw({clearRedrawFlags:!0})}function A4(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);e.push(i)}),t.setProps({layers:e})}class L1e{constructor(e){if(oe(this,"id",void 0),oe(this,"type",void 0),oe(this,"renderingMode",void 0),oe(this,"map",void 0),oe(this,"deck",void 0),oe(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=p7({map:e,gl:n,deck:this.props.deck}),T1e(this.deck,this)}onRemove(){this.deck&&S1e(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&M1e(this.deck)}render(){C1e(this.deck,this.map,this)}}const rb="__UNDEFINED__";function X1(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const i=of(r,Boolean);if(n!==r){const o=of(n,Boolean),g=new Set(o.map(w=>w.id));for(const w of i)g.delete(w.id);for(const w of g)t.getLayer(w)&&t.removeLayer(w)}for(const o of i){const g=t.getLayer(o.id);g?g.implementation.setProps(o.props):t.addLayer(new L1e({id:o.id,deck:e}),o.props.beforeId)}const s=t.style._order,A={};for(const o of i){let{beforeId:g}=o.props;(!g||!s.includes(g))&&(g=rb),A[g]=A[g]||[],A[g].push(o.id)}for(const o in A){const g=A[o];let w=o===rb?s.length:s.indexOf(o),C=o===rb?void 0:o;for(let I=g.length-1;I>=0;I--){const k=g[I],U=s.indexOf(k);U!==w-1&&(t.moveLayer(k,C),U>w&&w++),w--,C=k}}}class D1e{constructor(e){oe(this,"_props",void 0),oe(this,"_deck",void 0),oe(this,"_map",void 0),oe(this,"_container",void 0),oe(this,"_interleaved",void 0),oe(this,"_lastMouseDownPoint",void 0),oe(this,"_handleStyleChange",()=>{X1(this._map,this._deck,this._props.layers,this._props.layers)}),oe(this,"_updateContainerSize",()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:s}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(i,"px"),height:"".concat(s,"px")})}}),oe(this,"_updateViewState",()=>{const i=this._deck;i&&(i.setProps({viewState:Xg(this._map)}),i.isInitialized&&i.redraw())}),oe(this,"_handleMouseEvent",i=>{const s=this._deck;if(!s||!s.isInitialized)return;const A={type:i.type,offsetCenter:i.point,srcEvent:i},o=this._lastMouseDownPoint;switch(!i.point&&o&&(A.deltaX=i.originalEvent.clientX-o.clientX,A.deltaY=i.originalEvent.clientY-o.clientY,A.offsetCenter={x:o.x+A.deltaX,y:o.y+A.deltaY}),A.type){case"mousedown":s._onPointerDown(A),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":A.type="panstart",s._onEvent(A);break;case"drag":A.type="panmove",s._onEvent(A);break;case"dragend":A.type="panend",s._onEvent(A);break;case"click":A.tapCount=1,s._onEvent(A);break;case"dblclick":A.type="click",A.tapCount=2,s._onEvent(A);break;case"mousemove":A.type="pointermove",s._onPointerMove(A);break;case"mouseout":A.type="pointerleave",s._onPointerMove(A);break;default:return}});const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&X1(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?m7(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,pointerEvents:"none"}),this._container=n,this._deck=new af({...this._props,parent:n,viewState:Xg(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){return this._deck=p7({map:e,gl:e.painter.context.gl,deck:new af({...this._props,gl:e.painter.context.gl})}),e.on("styledata",this._handleStyleChange),X1(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)===null||n===void 0||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),X1(e,this._deck,this._props.layers,[]),g7(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Bi(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Bi(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Bi(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const R1e=rz(()=>Promise.resolve().then(()=>Hte),void 0),B1e=(()=>je.forwardRef(function(e,n){return sz(e,n,R1e)}))();function z1e(){const t=qS(),{getTooltip:e}=F1e(t);return yt.createElement(B1e,{getTooltip:e,id:"mymap",style:{width:1200,height:800},effects:[ph],light:{anchor:"viewport",color:"yellow",intensity:1},antialias:!0,interleaved:!0,initialViewState:Ope,mapLib:fl,mapStyle:"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",preventStyleDiffing:!0},yt.createElement(O1e,{curInput:t}))}function O1e({curInput:t}){const{current:e}=pne();je.useEffect(()=>{if(!e)return;const n={data:$pe,...t};e.on("load",()=>{const r=new D1e({interleaved:!0,effects:[ph],layers:[new ff({id:"carto",data:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:i=>{const{bbox:{west:s,south:A,east:o,north:g}}=i.tile;return new cf(i,{data:null,image:i.data,bounds:[s,A,o,g]})},beforeId:"waterway"}),new ff({id:"supply",data:"http://infovis.cs.ucdavis.edu/mapProxy/wmts/fbfm40/webmercator/{z}/{x}/{y}.png",minZoom:7,maxZoom:11,tileSize:256,renderSubLayers:i=>{const{bbox:{west:s,south:A,east:o,north:g}}=i.tile;if(-(s- -119.94742725262628)<g-37.90192590898632)return new cf(i,{data:null,image:i.data,bounds:[s,A,o,g]})},beforeId:"waterway"}),new kf({id:"ground",data:[[[-120.99582643167989,36.88453894208306],[-120.99582643167989,38.88453894208306],[-118.99582643167989,38.88453894208306],[-118.99582643167989,36.88453894208306]]],stroked:!1,getPolygon:i=>i,getFillColor:[0,0,0,0],getPolygonOffset:({layerIndex:i})=>[0,i*1e3],beforeId:"background"}),new u4({id:"slide-fire",...n,zoomRange:[9,14]})]});e.getMap().addControl(r).setLight({anchor:"viewport",color:"yellow",intensity:1})})},[])}class u4 extends Ar{renderLayers(){const{data:e,visible:n,zoomRange:r}=this.props;return[new ic({id:"DiffRings",data:e,thicknessRange:[0,1],getFillColor:i=>Sp.power.interpColor(i.properties.power,!1,!1),extruded:!0,getElevation:i=>3e3*Math.pow(Sp.power.scaleLinearVar(i.properties.confidence),4),stroked:!1,getValue:i=>Sp.power.scaleLinearVar(i.properties.confidence),visible:n,zoomRange:r}),new bm({id:"ScenarioUnmet",raised:!0,getElevation:i=>3e3*Math.pow(Sp.power.scaleLinearVar(i.properties.confidence),4),data:e,loaders:[r4],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",getColor:[0,188,242],getValue:i=>Sp.personnel.scaleLinear(i.properties.personnel),visible:n,sizeScale:400,zoomRange:r}),new c4({...this.props,id:"DeagLayer",data:e})]}}u4.layerName="WildfireLayer";u4.defaultProps={...Ar.defaultProps,autoHighlight:!0};class c4 extends Ar{renderLayers(){const{data:e,visible:n,zoomRange:r,selectionFinalized:i=!1}=this.props;return[new ic({id:"HoveringTiles",data:e,stroked:!1,thicknessRange:[0,1],getFillColor:[0,0,0,0],pickable:!i,autoHighlight:!i,visible:n,zoomRange:r})]}}c4.layerName="DeaggregatedLayer";c4.defaultProps={...Ar.defaultProps,autoHighlight:!0};function F1e({speedyCounter:t,curOption:e}){const n=je.useRef(),r=je.useRef(),i=je.useRef({});je.useEffect(()=>{n.current=document.querySelector("#main-tooltip"),r.current=document.querySelector("#secondary-tooltip")},[]);const s=je.useCallback(o=>{const g=o.properties.power,w=o.properties.confidence,C=o.properties.personnel;r.current.classList.remove("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>Power</b> ${g}</div>
      <div><b>Confidence</b> ${w}</div>
      <div><b>Personnel</b> ${C}</div>
      `},[t]);return{getTooltip:je.useCallback(({object:o})=>{if(!o){r.current.classList.remove("active"),n.current.classList.remove("active");return}s(o),i.current=o},[t,e])}}function h4(){const[t,e]=je.useState(1);return{curOption:t,setCurOption:e}}function f4({curOption:t}){const e=je.useRef(),n=je.useRef(),r=je.useRef({});je.useEffect(()=>{e.current=document.querySelector("#main-tooltip"),n.current=document.querySelector("#secondary-tooltip")},[]);const i=je.useCallback(g=>{e.current.classList.add("active"),n.current.classList.add("active"),n.current.innerHTML=`      <div><b>GEOID</b> ${g.properties.GEOID}</div>
      <div><b>Votes / Km2</b> ${g.properties.votes_per_sqkm}</div>
      <div><b>Percent Dem. Lead</b> ${g.properties.pct_dem_lead}</div>
    `},[]),s=je.useCallback(g=>{n.current.classList.remove("active"),e.current.classList.add("active"),g.properties.pct_dem_lead?e.current.innerHTML=`        <div><b>GEOID</b> ${g.properties.GEOID}</div>
        <div><b>Votes / Km2</b> ${g.properties.votes_per_sqkm}</div>
        <div><b>% Dem. Lead</b> ${g.properties.pct_dem_lead}</div>
      `:e.current.innerHTML=`        <div><b>County Subdiv.</b> ${g.properties["county_subdivision_dec_Geographic Area Name"]}</div>
        <div><b>GEOID</b> ${g.properties.GEOID}</div>
        <div><b>% PoC</b> ${100-g.properties["county_subdivision_dec_Percent White"]}</div>
        <div><b>Pop. / Km2</b> ${g.properties["Population per Sqkm"]}</div>
      `},[]),A=je.useCallback(g=>{n.current.classList.remove("active"),e.current.classList.add("active"),e.current.innerHTML=`      <div><b>% PoC</b> ${100-g.properties.PercWhite}</div>
      <div><b>Pop. / Km2</b> ${g.properties.PopSqKm}</div>
      <div><b>Votes / Km2</b> ${g.properties.VotesPerSqKm}</div>
      <div><b>% Turnout / Km2</b> ${g.properties.TurnoutPerSqKm}</div>
      <div><b>% Dem. Lead</b> ${g.properties.DemLead}</div>
      <div><b>Num. of County Subdivs</b> ${g.properties.CountyRgs.length}</div>
      <div><b>Num. of Precincts</b> ${g.properties.PrecinctRgs.length}</div>
      `},[]);return{getTooltip:je.useCallback(({object:g})=>{if(!g){r.current&&(n.current.classList.remove("active"),yd(r.current)&&e.current.classList.remove("active"),r.current=g),t>1&&(n.current.classList.remove("active"),e.current.classList.remove("active"));return}t<=1&&yd(g)?A(g):t<=1&&pv(g)?i(g):s(g),r.current=g},[t])}}class Em extends Ar{renderLayers(){return[new ff({data:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",minZoom:2,maxZoom:11,tileSize:256,renderSubLayers:e=>{const{bbox:{west:n,south:r,east:i,north:s}}=e.tile;return new cf(e,{data:null,image:e.data,bounds:[n,r,i,s]})}})]}}Em.layerName="BaseTerrainLayer";Em.defaultProps={...Ar.defaultProps};class d4 extends Ar{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:A,zoomRange:o}=this.props;return[new ic({id:"Party",data:e,thicknessRange:[0,1],getFillColor:g=>zi.party.interpVsup(g.properties.DemLead||0,g.properties.VotesPerSqKm||0),opacity:1,visible:A,updateTriggers:{getFillColor:[r]},zoomRange:o}),new ic({id:"White",data:e,thicknessRange:[.4,.65],getFillColor:g=>zi.poc.interpColor(100-g.properties.PercWhite,!0,!0),getValue:g=>zi.poc.scaleLinearVar(g.properties.PercWhiteVar)*.8+.2,raised:!0,visible:A,getElevation:g=>g.hexId in i?5e3:0,getLineWidth:g=>g.hexId in i?100:0,stroked:!0,extruded:!1,lineJointRounded:!0,getLineColor:[255,255,255,200],getOffset:-.5,extensions:[new ov({offset:!0})],opacity:1,updateTriggers:{getFillColor:[n,r],getValue:[n,r],getElevation:[s],getLineWidth:[s]},zoomRange:o}),new bm({id:"Population",data:e,loaders:[r4],mesh:"https://raw.githubusercontent.com/visgl/deck.gl-data/master/website/humanoid_quad.obj",raised:!0,getColor:g=>[255,255,7,zi.population.scaleLinearVar(g.properties.TurnoutPerSqKm)*200+55],getValue:g=>zi.population.scaleLinear(g.properties.PopSqKm),visible:A,sizeScale:400,opacity:1,updateTriggers:{getTranslation:[r]},zoomRange:o}),new Tv({...this.props,id:"DeagLayer",data:e,deagData:gv,getFillColor:g=>zi.party.interpColor(g.properties.pct_dem_lead,!1,!1)})]}}d4.layerName="MultivariableHextileLayer";d4.defaultProps={...Ar.defaultProps,autoHighlight:!0};function N1e({res:t}){const e=je.useRef(),n=je.useRef();return je.useLayoutEffect(()=>{const r=window.innerHeight,i=400,s=io(e.current).attr("width",i).attr("height",r);s.append("g").call($A.arcmapLegend().vtitle("Percent Dem").utitle("Votes / Km2").scale(zi.party.vsup).size(150).x(i-180).y(r-500)),s.append("g").call($A.simpleLegend().title("Percent PoC").size(250).height(20).scale(zi.poc.colorsStepped).x(i-280).y(r-300)),s.append("g").call(VF(i-100,r-100,70,"rgba(146, 146, 146, 0.5)")).call(function(A){n.current=[A.append("text").attr("x",i-100).attr("y",r-92).attr("text-anchor","middle").style("font-weight","bold").style("blend-mode","multiply").text(`${Math.round(w2(t,Ti.km2))} km`),A.append("text").attr("x",i-100).attr("y",r-50).attr("text-anchor","middle").style("font-size","11px").text(` ${Math.round(Fu(t,Ti.km))} km ;`)]})},[]),je.useEffect(()=>{let[r,i]=n.current;r.text(`${Math.round(w2(t,Ti.km2))} km`),i.text(` ${Math.round(Fu(t,Ti.km))} km ;`)},[t]),yt.createElement("svg",{className:"legend-area",ref:e})}function U1e(){const{current:t}=je.useRef(Object.keys(f2).map(o=>parseInt(o))),[e,n]=je.useState(5),r=h4(),i=wm({disabled:r.curOption>1,dataDeag:gv,deagKey:"PrecinctRgs"}),{getTooltip:s}=f4(r),A={data:f2,...r,...i};return yt.createElement(yt.Fragment,null,yt.createElement(Md,{controller:!0,effects:[ph],initialViewState:{longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58},onViewStateChange:({viewState:o})=>{n(o.zoom)},getTooltip:s},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA}),yt.createElement(Em,{id:"slide-terrain",...A}),yt.createElement(d4,{id:"slide-election",...A,zoomRange:[5,8],visible:r.curOption==1})),yt.createElement(V1e,{res:ea().domain([0,1]).range(t)(ms().domain([5,8]).range([0,1]).clamp(!0)(e))}))}function V1e(t){return yt.createElement(yt.Fragment,null,yt.createElement(N1e,{...t}))}const y8=0;function G1e(){const t=qS(),e=wm({disabled:t.curOption>1,dataDeag:jA,deagKey:"DURgs"}),{getTooltip:n}=i7({...t,curOption:100}),r={data:h2,...t,...e},[i,s]=je.useState(u2),A=je.useCallback(({viewId:o,viewState:g})=>{s({one:g,two:g,three:g})},[]);return yt.createElement(yt.Fragment,null,yt.createElement(Md,{controller:!0,effects:[ph],viewState:i,onViewStateChange:A,getTooltip:n,layerFilter:({layer:o,viewport:g})=>o.id=="slide-terrain"||o.id=="GroundwaterGeo"&&g.id=="one"||o.id=="UDemGeo"&&g.id=="two"||o.id=="DemDiffGeo"&&g.id=="three",views:[new Gu({id:"one",x:"0%",y:"0%",height:"50%",width:"50%",controller:!0}),new Gu({id:"two",x:"50%",y:"0%",height:"50%",width:"50%",controller:!0}),new Gu({id:"three",x:"25%",y:"50%",height:"50%",width:"50%",controller:!0})]},yt.createElement(hl,{id:"one"},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA})),yt.createElement(hl,{id:"two"},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA})),yt.createElement(hl,{id:"three"},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA})),yt.createElement(xv,{id:"slide-terrain",...r}),yt.createElement(ns,{id:"GroundwaterGeo",data:QS,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...$r.groundwater.interpColor(o.properties.Groundwater[t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0}),yt.createElement(ns,{id:"UDemGeo",data:jA,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...$r.unmetDemand.interpColor(o.properties.UnmetDemand[kr[y8]][t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0}),yt.createElement(ns,{id:"DemDiffGeo",data:jA,opacity:1,stroked:!1,filled:!0,getFillColor:o=>[...$r.difference.interpColor(o.properties.UnmetDemand[kr[y8]][t.speedyCounter]-o.properties.UnmetDemandBaseline[t.speedyCounter]),255],updateTriggers:{getFillColor:[t.speedyCounter]},pickable:!0,autoHighlight:!0})),yt.createElement($1e,{...r}))}function $1e({speedyCounter:t,setSpeedyCounter:e,playing:n,setPlaying:r}){return yt.createElement(yt.Fragment,null,yt.createElement(JS,{counter:t,displayMonth:!1,dataset:"averageDemandBaseline"}),yt.createElement(j1e,null),yt.createElement("div",{className:"styled-input"},yt.createElement("button",{onClick:()=>{r(i=>!i)}},n?"Pause":"Play"),yt.createElement("div",null,yt.createElement("input",{style:{width:"10ch",display:"block"},type:"number",value:t,onChange:function(i){e(parseInt(i.target.value))}}),yt.createElement("input",{onChange:function(i){r(!1),e(parseInt(i.target.value))},onInput:function(i){e(parseInt(i.target.value))},value:t,style:{width:"40vw",display:"block"},type:"range",min:"0",max:"1199",id:"myRange"}))))}function j1e({}){const t=je.useRef();return je.useLayoutEffect(()=>{io(t.current).attr("width",400).attr("height",500).call(function(r){r.append("g").call($A.simpleLegend().title("Groundwater").size(250).height(20).scale($r.groundwater.colorsStepped).x(400-280).y(500-240))}).call(function(r){r.append("g").call($A.simpleLegend().title("Scenario Unmet Demand").size(250).height(20).scale($r.unmetDemand.colorsStepped).x(400-280).y(500-170))}).call(function(r){r.append("g").call($A.simpleLegend().title("Difference w/ Baseline").size(250).height(20).scale($r.difference.colorsStepped).x(400-280).y(500-100))})},[]),yt.createElement("svg",{className:"legend-area",ref:t})}class _7 extends Ar{renderLayers(){const{curOption:e,speedyCounter:n=1026}=this.props;return[new ns({id:"Votes",data:GF,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,extruded:!0,getElevation:r=>zi.votes.scaleLinear(r.properties.votes_per_sqkm)*3e5,getFillColor:r=>zi.party.interpColor(r.properties.pct_dem_lead,!1,!1),visible:e==2,pickable:!0,autoHighlight:!0}),new ns({id:"Demog",data:vE,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,extruded:!0,getElevation:r=>zi.population.scaleLinear(r.properties["county_subdivision_dec_Total population"]/(r.properties.area/1e6)||0)*3e4,getFillColor:r=>zi.poc.interpColor(100-(r.properties["county_subdivision_dec_Percent White"]||100),!1,!1),visible:e==3,pickable:!0,autoHighlight:!0})]}}_7.layerName="BasicGeoLayer";_7.defaultProps={...Ar.defaultProps,autoHighlight:!0};function H1e(){const t=h4(),e=wm({disabled:t.curOption>1,dataDeag:gv,deagKey:"PrecinctRgs"}),{getTooltip:n}=f4(t),r={data:Gpe,...t,...e};return yt.createElement(yt.Fragment,null,yt.createElement(Md,{controller:!0,effects:[ph],initialViewState:{longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58},getTooltip:n},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA}),yt.createElement(Em,{id:"slide-terrain",...r}),yt.createElement(p4,{id:"slide-election",...r,zoomRange:[5,8],visible:!0})),yt.createElement(W1e,{...r}))}class p4 extends Ar{renderLayers(){const{data:e,curOption:n,speedyCounter:r=1026,clickedHexes:i,selectionFinalized:s,visible:A,zoomRange:o}=this.props;return[new sh({id:"PoC",data:e,getFillColor:[0,121,42],getValue:g=>zi.poc.scaleLinear(100-g.properties.PercWhite),visible:A,extruded:!1,opacity:1,zoomRange:o,offset:[-1,-1]}),new sh({id:"Dem",data:e,getFillColor:[72,30,197],getValue:g=>zi.party.scaleLinear(g.properties.DemLead),visible:A,extruded:!1,opacity:1,zoomRange:o,offset:[-1,1]}),new sh({id:"Pop",data:e,getFillColor:[156,156,156],getValue:g=>zi.population.scaleLinear(g.properties.PopSqKm),visible:A,extruded:!1,opacity:1,zoomRange:o,offset:[1,1]})]}}p4.layerName="MultivariableSquareTileLayer";p4.defaultProps={...Ar.defaultProps,autoHighlight:!0};function W1e({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return yt.createElement(yt.Fragment,null)}function Q1e(){const t=h4(),e=wm({disabled:t.curOption>1,dataDeag:gv,deagKey:"PrecinctRgs"}),{getTooltip:n}=f4({...t,curOption:100}),r={data:f2,...t,...e},[i,s]=je.useState({longitude:-97.7431,latitude:30.2672,zoom:5,minZoom:3,maxZoom:15,pitch:50.85,bearing:32.58}),A=je.useCallback(({viewId:o,viewState:g})=>{s({one:g,two:g,three:g})},[]);return yt.createElement(yt.Fragment,null,yt.createElement(Md,{controller:!0,effects:[ph],viewState:i,onViewStateChange:A,getTooltip:n,layerFilter:({layer:o,viewport:g})=>o.id=="slide-terrain"||o.id=="Pop"&&g.id=="one"||o.id=="Votes"&&g.id=="two"||o.id=="Demog"&&g.id=="three",views:[new Gu({id:"one",x:"0%",y:"0%",height:"50%",width:"50%",controller:!0}),new Gu({id:"two",x:"50%",y:"0%",height:"50%",width:"50%",controller:!0}),new Gu({id:"three",x:"25%",y:"50%",height:"50%",width:"50%",controller:!0})]},yt.createElement(hl,{id:"one"},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA})),yt.createElement(hl,{id:"two"},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA})),yt.createElement(hl,{id:"three"},yt.createElement(zA,{reuseMaps:!0,preventStyleDiffing:!0,mapLib:fl,mapStyle:OA})),yt.createElement(Em,{id:"slide-terrain",...r}),yt.createElement(ns,{id:"Pop",data:vE,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>zi.population.interpColor(o.properties["Population per Sqkm"],!1,!1),pickable:!0,autoHighlight:!0}),yt.createElement(ns,{id:"Votes",data:GF,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>zi.party.interpColor(o.properties.pct_dem_lead,!1,!1),pickable:!0,autoHighlight:!0}),yt.createElement(ns,{id:"Demog",data:vE,opacity:1,stroked:!0,lineWidthScale:100,filled:!0,getFillColor:o=>zi.poc.interpColor(100-(o.properties["county_subdivision_dec_Percent White"]||100),!1,!1),pickable:!0,autoHighlight:!0})),yt.createElement(q1e,{...r}))}function q1e({curOption:t,setCurOption:e,speedyCounter:n,setSpeedyCounter:r,playing:i,setPlaying:s}){return yt.createElement(yt.Fragment,null,yt.createElement(Z1e,null))}function Z1e({}){const t=je.useRef();return je.useLayoutEffect(()=>{io(t.current).attr("width",400).attr("height",500).call(function(r){r.append("g").call($A.simpleLegend().title("Population / Km2").size(250).height(20).scale(zi.population.colorsStepped).x(400-280).y(500-240))}).call(function(r){r.append("g").call($A.simpleLegend().title("Percent Democrat Lead").size(250).height(20).scale(zi.party.colorsStepped).x(400-280).y(500-170))}).call(function(r){r.append("g").call($A.simpleLegend().title("Percent PoC").size(250).height(20).scale(zi.poc.colorsStepped).x(400-280).y(500-100))})},[]),yt.createElement("svg",{className:"legend-area",ref:t})}function Y1e(t){ID(t).render(yt.createElement(SG,null,yt.createElement(_G,null,yt.createElement(Su,{path:"/",element:yt.createElement(X1e,null)}),yt.createElement(Su,{path:"water/hex",element:yt.createElement(f1e,null)}),yt.createElement(Su,{path:"water/square",element:yt.createElement(b1e,null)}),yt.createElement(Su,{path:"water/mult",element:yt.createElement(G1e,null)}),yt.createElement(Su,{path:"election/hex",element:yt.createElement(U1e,null)}),yt.createElement(Su,{path:"election/square",element:yt.createElement(H1e,null)}),yt.createElement(Su,{path:"election/mult",element:yt.createElement(Q1e,null)}),yt.createElement(Su,{path:"fire",element:yt.createElement(z1e,null)}))))}function X1e(){return yt.createElement(yt.Fragment,null,yt.createElement(Th,{className:"toc-link",to:"water/mult"},"Water Small Multiples"),yt.createElement(Th,{className:"toc-link",to:"water/square"},"Water Square Tiles"),yt.createElement(Th,{className:"toc-link",to:"water/hex"},"Water HexTiles"),yt.createElement(Th,{className:"toc-link",to:"election/mult"},"Election Small Multiples"),yt.createElement(Th,{className:"toc-link",to:"election/square"},"Election Square Tiles"),yt.createElement(Th,{className:"toc-link",to:"election/hex"},"Election HexTiles"),yt.createElement(Th,{className:"toc-link",to:"fire"},"Wildfire"))}Y1e(document.getElementById("app"));
